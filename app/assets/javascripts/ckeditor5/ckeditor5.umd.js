"use strict";var _excluded=["translations"],_excluded2=["rangeJSON"],_excluded3=["translations"],_excluded4=["translations"];function _wrapRegExp(){_wrapRegExp=function _wrapRegExp(e,r){return new BabelRegExp(e,void 0,r);};var e=RegExp.prototype,r=new WeakMap();function BabelRegExp(e,t,p){var o=RegExp(e,t);return r.set(o,p||r.get(e)),_setPrototypeOf(o,BabelRegExp.prototype);}function buildGroups(e,t){var p=r.get(t);return Object.keys(p).reduce(function(r,t){var o=p[t];if("number"==typeof o)r[t]=e[o];else{for(var i=0;void 0===e[o[i]]&&i+1<o.length;)i++;r[t]=e[o[i]];}return r;},Object.create(null));}return _inherits(BabelRegExp,RegExp),BabelRegExp.prototype.exec=function(r){var t=e.exec.call(this,r);if(t){t.groups=buildGroups(t,this);var p=t.indices;p&&(p.groups=buildGroups(p,this));}return t;},BabelRegExp.prototype[Symbol.replace]=function(t,p){if("string"==typeof p){var o=r.get(this);return e[Symbol.replace].call(this,t,p.replace(/\$<([^>]+)>/g,function(e,r){var t=o[r];return"$"+(Array.isArray(t)?t.join("$"):t);}));}if("function"==typeof p){var i=this;return e[Symbol.replace].call(this,t,function(){var e=arguments;return"object"!=_typeof(e[e.length-1])&&(e=[].slice.call(e)).push(buildGroups(e,i)),p.apply(this,e);});}return e[Symbol.replace].call(this,t,p);},_wrapRegExp.apply(this,arguments);}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}function _objectWithoutProperties(e,t){if(null==e)return{};var o,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)o=s[r],t.includes(o)||{}.propertyIsEnumerable.call(e,o)&&(i[o]=e[o]);}return i;}function _objectWithoutPropertiesLoose(r,e){if(null==r)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.includes(n))continue;t[n]=r[n];}return t;}function asyncGeneratorStep(n,t,e,r,o,a,c){try{var i=n[a](c),u=i.value;}catch(n){return void e(n);}i.done?t(u):Promise.resolve(u).then(r,o);}function _asyncToGenerator(n){return function(){var t=this,e=arguments;return new Promise(function(r,o){var a=n.apply(t,e);function _next(n){asyncGeneratorStep(a,r,o,_next,_throw,"next",n);}function _throw(n){asyncGeneratorStep(a,r,o,_next,_throw,"throw",n);}_next(void 0);});};}function _regeneratorRuntime(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function _regeneratorRuntime(){return e;};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value;},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e];}try{define({},"");}catch(t){define=function define(t,e,r){return t[e]=r;};}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a;}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)};}catch(t){return{type:"throw",arg:t};}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,function(){return this;});var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach(function(e){define(t,e,function(t){return this._invoke(e,t);});});}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then(function(t){invoke("next",t,i,a);},function(t){invoke("throw",t,i,a);}):e.resolve(h).then(function(t){u.value=t,i(u);},function(t){return invoke("throw",t,i,a);});}a(c.arg);}var r;o(this,"_invoke",{value:function value(t,n){function callInvokeWithMethodAndArg(){return new e(function(e,r){invoke(t,n,e,r);});}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg();}});}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0};}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u;}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg);}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done};}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg);}};}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator["return"]&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y);}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e);}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e;}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0);}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next;};return i.next=i;}}throw new TypeError(_typeof(e)+" is not iterable");}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name));},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t;},e.awrap=function(t){return{__await:t};},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,function(){return this;}),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(t){return t.done?t.value:a.next();});},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,function(){return this;}),define(g,"toString",function(){return"[object Generator]";}),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next;}return next.done=!0,next;};},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t);},stop:function stop(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval;},dispatchException:function dispatchException(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o;}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc);}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc);}}}},abrupt:function abrupt(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break;}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a);},complete:function complete(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y;},finish:function finish(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y;}},"catch":function _catch(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r);}return o;}}throw Error("illegal catch attempt");},delegateYield:function delegateYield(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y;}},e;}function _superPropGet(t,o,e,r){var p=_get(_getPrototypeOf(1&r?t.prototype:t),o,e);return 2&r&&"function"==typeof p?function(t){return p.apply(e,t);}:p;}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var p=_superPropBase(e,t);if(p){var n=Object.getOwnPropertyDescriptor(p,t);return n.get?n.get.call(arguments.length<3?e:r):n.value;}},_get.apply(null,arguments);}function _superPropBase(t,o){for(;!{}.hasOwnProperty.call(t,o)&&null!==(t=_getPrototypeOf(t)););return t;}function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n344=0,F=function F(){};return{s:F,n:function n(){return _n344>=r.length?{done:!0}:{done:!1,value:r[_n344++]};},e:function e(r){throw r;},f:F};}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}var o,a=!0,u=!1;return{s:function s(){t=t.call(r);},n:function n(){var r=t.next();return a=r.done,r;},e:function e(r){u=!0,o=r;},f:function f(){try{a||null==t["return"]||t["return"]();}finally{if(u)throw o;}}};}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread();}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r);}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r);}function _callSuper(t,o,e){return o=_getPrototypeOf(o),_possibleConstructorReturn(t,_isNativeReflectConstruct()?Reflect.construct(o,e||[],_getPrototypeOf(t).constructor):o.apply(t,e));}function _possibleConstructorReturn(t,e){if(e&&("object"==_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t);}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e;}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e);}function _wrapNativeSuper(t){var r="function"==typeof Map?new Map():void 0;return _wrapNativeSuper=function _wrapNativeSuper(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,Wrapper);}function Wrapper(){return _construct(t,arguments,_getPrototypeOf(this).constructor);}return Wrapper.prototype=Object.create(t.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,t);},_wrapNativeSuper(t);}function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var p=new(t.bind.apply(t,o))();return r&&_setPrototypeOf(p,r.prototype),p;}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));}catch(t){}return(_isNativeReflectConstruct=function _isNativeReflectConstruct(){return!!t;})();}function _isNativeFunction(t){try{return-1!==Function.toString.call(t).indexOf("[native code]");}catch(n){return"function"==typeof t;}}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t;},_setPrototypeOf(t,e);}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t);},_getPrototypeOf(t);}function _slicedToArray(r,e){return _arrayWithHoles(r)||_iterableToArrayLimit(r,e)||_unsupportedIterableToArray(r,e)||_nonIterableRest();}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0;}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n;}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1;}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r;}finally{try{if(!f&&null!=t["return"]&&(u=t["return"](),Object(u)!==u))return;}finally{if(o)throw n;}}return a;}}function _arrayWithHoles(r){if(Array.isArray(r))return r;}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o);}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;}function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function");}function _defineProperty(e,r,t){return(r=_toPropertyKey(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e;}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:i+"";}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.");}return("string"===r?String:Number)(t);}function _typeof(o){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o;}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o;},_typeof(o);}(function(global,factory){(typeof exports==="undefined"?"undefined":_typeof(exports))==='object'&&typeof module!=='undefined'?factory(exports):typeof define==='function'&&define.amd?define(['exports'],factory):(global=typeof globalThis!=='undefined'?globalThis:global||self,factory(global.CKEDITOR={}));})(void 0,function(exports){'use strict';/**
	 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
	 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
	 */var _Df;var _marked=/*#__PURE__*/_regeneratorRuntime().mark(Cd),_marked2=/*#__PURE__*/_regeneratorRuntime().mark(xd),_marked3=/*#__PURE__*/_regeneratorRuntime().mark(Yh),_marked4=/*#__PURE__*/_regeneratorRuntime().mark(U_),_marked5=/*#__PURE__*/_regeneratorRuntime().mark(xA);function e(e,t){return t.forEach(function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(i){if("default"!==i&&!(i in e)){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function get(){return t[i];}});}});}),Object.freeze(e);}var t;try{t={window:window,document:document};}catch(e){t={window:{},document:{}};}var i=t;function n(){try{return navigator.userAgent.toLowerCase();}catch(e){return"";}}var s=n(),o={isMac:r(s),isWindows:a(s),isGecko:l(s),isSafari:c(s),isiOS:d(s),isAndroid:u(s),isBlink:h(s),get isMediaForcedColors(){return!!i.window.matchMedia&&i.window.matchMedia("(forced-colors: active)").matches;},get isMotionReduced(){return!!i.window.matchMedia&&i.window.matchMedia("(prefers-reduced-motion)").matches;},features:{isRegExpUnicodePropertySupported:m()}};function r(e){return e.indexOf("macintosh")>-1;}function a(e){return e.indexOf("windows")>-1;}function l(e){return!!e.match(/gecko\/\d+/);}function c(e){return e.indexOf(" applewebkit/")>-1&&-1===e.indexOf("chrome");}function d(e){return!!e.match(/iphone|ipad/i)||r(e)&&navigator.maxTouchPoints>0;}function u(e){return e.indexOf("android")>-1;}function h(e){return e.indexOf("chrome/")>-1&&e.indexOf("edge/")<0;}function m(){var e=!1;try{e=0==="ć".search(new RegExp("[\\p{L}]","u"));}catch(e){}return e;}function g(e,t,i,n){i=i||function(e,t){return e===t;};var s=Array.isArray(e)?e:Array.prototype.slice.call(e),o=Array.isArray(t)?t:Array.prototype.slice.call(t),r=function(e,t,i){var n=f(e,t,i);if(-1===n)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};var s=p(e,n),o=p(t,n),r=f(s,o,i),a=e.length-r,l=t.length-r;return{firstIndex:n,lastIndexOld:a,lastIndexNew:l};}(s,o,i),a=n?function(e,t){var i=e.firstIndex,n=e.lastIndexOld,s=e.lastIndexNew;if(-1===i)return Array(t).fill("equal");var o=[];i>0&&(o=o.concat(Array(i).fill("equal")));s-i>0&&(o=o.concat(Array(s-i).fill("insert")));n-i>0&&(o=o.concat(Array(n-i).fill("delete")));s<t&&(o=o.concat(Array(t-s).fill("equal")));return o;}(r,o.length):function(e,t){var i=[],n=t.firstIndex,s=t.lastIndexOld,o=t.lastIndexNew;o-n>0&&i.push({index:n,type:"insert",values:e.slice(n,o)});s-n>0&&i.push({index:n+(o-n),type:"delete",howMany:s-n});return i;}(o,r);return a;}function f(e,t,i){for(var _n2=0;_n2<Math.max(e.length,t.length);_n2++)if(void 0===e[_n2]||void 0===t[_n2]||!i(e[_n2],t[_n2]))return _n2;return-1;}function p(e,t){return e.slice(t).reverse();}function b(e,t,i){i=i||function(e,t){return e===t;};var n=e.length,s=t.length;if(n>200||s>200||n+s>300)return b.fastDiff(e,t,i,!0);var o,r;if(s<n){var _i2=e;e=t,t=_i2,o="delete",r="insert";}else o="insert",r="delete";var a=e.length,l=t.length,c=l-a,d={},u={};function h(n){var s=(void 0!==u[n-1]?u[n-1]:-1)+1,c=void 0!==u[n+1]?u[n+1]:-1,h=s>c?-1:1;d[n+h]&&(d[n]=d[n+h].slice(0)),d[n]||(d[n]=[]),d[n].push(s>c?o:r);var m=Math.max(s,c),g=m-n;for(;g<a&&m<l&&i(e[g],t[m]);)g++,m++,d[n].push("equal");return m;}var m,g=0;do{for(m=-g;m<c;m++)u[m]=h(m);for(m=c+g;m>c;m--)u[m]=h(m);u[c]=h(c),g++;}while(u[c]!==l);return d[c].slice(1);}function w(e,t){var i=[];var n=0,s=null;return e.forEach(function(e){"equal"==e?(o(),n++):"insert"==e?(s&&"insert"==s.type?s.values.push(t[n]):(o(),s={type:"insert",index:n,values:[t[n]]}),n++):s&&"delete"==s.type?s.howMany++:(o(),s={type:"delete",index:n,howMany:1});}),o(),i;function o(){s&&(i.push(s),s=null);}}function _(e){for(var _len=arguments.length,t=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){t[_key-1]=arguments[_key];}t.forEach(function(t){var i=Object.getOwnPropertyNames(t),n=Object.getOwnPropertySymbols(t);i.concat(n).forEach(function(i){if(i in e.prototype)return;if("function"==typeof t&&("length"==i||"name"==i||"prototype"==i))return;var n=Object.getOwnPropertyDescriptor(t,i);n.enumerable=!1,Object.defineProperty(e.prototype,i,n);});});}b.fastDiff=g;var v=/*#__PURE__*/_createClass(function v(e,t){_classCallCheck(this,v);_defineProperty(this,"source",void 0);_defineProperty(this,"name",void 0);_defineProperty(this,"path",void 0);_defineProperty(this,"stop",void 0);_defineProperty(this,"off",void 0);_defineProperty(this,"return",void 0);this.source=e,this.name=t,this.path=[],this.stop=function e(){e.called=!0;},this.off=function e(){e.called=!0;};});var y=new Array(256).fill("").map(function(e,t){return("0"+t.toString(16)).slice(-2);});function k(){var _crypto$getRandomValu=crypto.getRandomValues(new Uint32Array(4)),_crypto$getRandomValu2=_slicedToArray(_crypto$getRandomValu,4),e=_crypto$getRandomValu2[0],t=_crypto$getRandomValu2[1],i=_crypto$getRandomValu2[2],n=_crypto$getRandomValu2[3];return"e"+y[255&e]+y[e>>8&255]+y[e>>16&255]+y[e>>24&255]+y[255&t]+y[t>>8&255]+y[t>>16&255]+y[t>>24&255]+y[255&i]+y[i>>8&255]+y[i>>16&255]+y[i>>24&255]+y[255&n]+y[n>>8&255]+y[n>>16&255]+y[n>>24&255];}var C={get:function get(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"normal";return"number"!=typeof e?this[e]||this.normal:e;},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function x(e,t){var i=C.get(t.priority);for(var _n3=0;_n3<e.length;_n3++)if(C.get(e[_n3].priority)<i)return void e.splice(_n3,0,t);e.push(t);}var A=/*#__PURE__*/function(_Error){function A(e,t,i){var _this;_classCallCheck(this,A);_this=_callSuper(this,A,[function(e,t){var i=new WeakSet(),n=function n(e,t){if("object"==_typeof(t)&&null!==t){if(i.has(t))return"[object ".concat(t.constructor.name,"]");i.add(t);}return t;},s=t?" ".concat(JSON.stringify(t,n)):"",o=P(e);return e+s+o;}(e,i)]),_defineProperty(_assertThisInitialized(_this),"context",void 0),_defineProperty(_assertThisInitialized(_this),"data",void 0),_this.name="CKEditorError",_this.context=t,_this.data=i;return _this;}_inherits(A,_Error);return _createClass(A,[{key:"is",value:function is(e){return"CKEditorError"===e;}}],[{key:"rethrowUnexpectedError",value:function rethrowUnexpectedError(e,t){if(e.is&&e.is("CKEditorError"))throw e;var i=new A(e.message,t);throw i.stack=e.stack,i;}}]);}(/*#__PURE__*/_wrapNativeSuper(Error));function E(e,t){var _console;(_console=console).warn.apply(_console,_toConsumableArray(S(e,t)));}function T(e,t){var _console2;(_console2=console).error.apply(_console2,_toConsumableArray(S(e,t)));}function P(e){return"\nRead more: https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html#error-".concat(e);}function S(e,t){var i=P(e);return t?[e,t,i]:[e,i];}var I="43.3.0",V=new Date(2024,9,29);if(globalThis.CKEDITOR_VERSION)throw new A("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=I;var R=Symbol("listeningTo"),O=Symbol("emitterId"),B=Symbol("delegations"),M=L(Object);function L(e){if(!e)return M;return/*#__PURE__*/function(_e2){function _class(){_classCallCheck(this,_class);return _callSuper(this,_class,arguments);}_inherits(_class,_e2);return _createClass(_class,[{key:"on",value:function on(e,t,i){this.listenTo(this,e,t,i);}},{key:"once",value:function once(e,t,i){var _this2=this;var n=!1;this.listenTo(this,e,function(e){for(var _len2=arguments.length,i=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++){i[_key2-1]=arguments[_key2];}n||(n=!0,e.off(),t.call.apply(t,[_this2,e].concat(i)));},i);}},{key:"off",value:function off(e,t){this.stopListening(this,e,t);}},{key:"listenTo",value:function listenTo(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s,o;this[R]||(this[R]={});var r=this[R];N(e)||F(e);var a=N(e);(s=r[a])||(s=r[a]={emitter:e,callbacks:{}}),(o=s.callbacks[t])||(o=s.callbacks[t]=[]),o.push(i),function(e,t,i,n,s){t._addEventListener?t._addEventListener(i,n,s):e._addEventListener.call(t,i,n,s);}(this,e,t,i,n);}},{key:"stopListening",value:function stopListening(e,t,i){var n=this[R];var s=e&&N(e);var o=n&&s?n[s]:void 0,r=o&&t?o.callbacks[t]:void 0;if(!(!n||e&&!o||t&&!r))if(i){U(this,e,t,i);-1!==r.indexOf(i)&&(1===r.length?delete o.callbacks[t]:U(this,e,t,i));}else if(r){for(;i=r.pop();)U(this,e,t,i);delete o.callbacks[t];}else if(o){for(t in o.callbacks)this.stopListening(e,t);delete n[s];}else{for(s in n)this.stopListening(n[s].emitter);delete this[R];}}},{key:"fire",value:function fire(e){try{var _i3=e instanceof v?e:new v(this,e),_n4=_i3.name;var _s2=H(this,_n4);for(var _len3=arguments.length,t=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++){t[_key3-1]=arguments[_key3];}if(_i3.path.push(this),_s2){var _e3=[_i3].concat(t);_s2=Array.from(_s2);for(var _t2=0;_t2<_s2.length&&(_s2[_t2].callback.apply(this,_e3),_i3.off.called&&(delete _i3.off.called,this._removeEventListener(_n4,_s2[_t2].callback)),!_i3.stop.called);_t2++);}var _o2=this[B];if(_o2){var _e4=_o2.get(_n4),_s3=_o2.get("*");_e4&&$(_e4,_i3,t),_s3&&$(_s3,_i3,t);}return _i3["return"];}catch(e){A.rethrowUnexpectedError(e,this);}}},{key:"delegate",value:function delegate(){var _this3=this;for(var _len4=arguments.length,e=new Array(_len4),_key4=0;_key4<_len4;_key4++){e[_key4]=arguments[_key4];}return{to:function to(t,i){_this3[B]||(_this3[B]=new Map()),e.forEach(function(e){var n=_this3[B].get(e);n?n.set(t,i):_this3[B].set(e,new Map([[t,i]]));});}};}},{key:"stopDelegating",value:function stopDelegating(e,t){if(this[B])if(e){if(t){var _i4=this[B].get(e);_i4&&_i4["delete"](t);}else this[B]["delete"](e);}else this[B].clear();}},{key:"_addEventListener",value:function _addEventListener(e,t,i){!function(e,t){var i=D(e);if(i[t])return;var n=t,s=null;var o=[];for(;""!==n&&!i[n];)i[n]={callbacks:[],childEvents:[]},o.push(i[n]),s&&i[n].childEvents.push(s),s=n,n=n.substr(0,n.lastIndexOf(":"));if(""!==n){var _iterator=_createForOfIteratorHelper(o),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _e5=_step.value;_e5.callbacks=i[n].callbacks.slice();}}catch(err){_iterator.e(err);}finally{_iterator.f();}i[n].childEvents.push(s);}}(this,e);var n=z(this,e),s={callback:t,priority:C.get(i.priority)};var _iterator2=_createForOfIteratorHelper(n),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _e6=_step2.value;x(_e6,s);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}},{key:"_removeEventListener",value:function _removeEventListener(e,t){var i=z(this,e);var _iterator3=_createForOfIteratorHelper(i),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _e7=_step3.value;for(var _i5=0;_i5<_e7.length;_i5++)_e7[_i5].callback==t&&(_e7.splice(_i5,1),_i5--);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}}}]);}(e);}function F(e,t){e[O]||(e[O]=t||k());}function N(e){return e[O];}function D(e){return e._events||Object.defineProperty(e,"_events",{value:{}}),e._events;}function z(e,t){var i=D(e)[t];if(!i)return[];var n=[i.callbacks];for(var _t3=0;_t3<i.childEvents.length;_t3++){var _s4=z(e,i.childEvents[_t3]);n=n.concat(_s4);}return n;}function H(e,t){var i;return e._events&&(i=e._events[t])&&i.callbacks.length?i.callbacks:t.indexOf(":")>-1?H(e,t.substr(0,t.lastIndexOf(":"))):null;}function $(e,t,i){var _iterator4=_createForOfIteratorHelper(e),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _step4$value=_slicedToArray(_step4.value,2),_n5=_step4$value[0],_s5=_step4$value[1];_s5?"function"==typeof _s5&&(_s5=_s5(t.name)):_s5=t.name;var _e8=new v(t.source,_s5);_e8.path=_toConsumableArray(t.path),_n5.fire.apply(_n5,[_e8].concat(_toConsumableArray(i)));}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}}function U(e,t,i,n){t._removeEventListener?t._removeEventListener(i,n):e._removeEventListener.call(t,i,n);}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(function(e){L[e]=M.prototype[e];});var W="object"==(typeof global==="undefined"?"undefined":_typeof(global))&&global&&global.Object===Object&&global,j="object"==(typeof self==="undefined"?"undefined":_typeof(self))&&self&&self.Object===Object&&self,q=W||j||Function("return this")(),G=q.Symbol,K=Object.prototype,Z=K.hasOwnProperty,J=K.toString,Q=G?G.toStringTag:void 0;var Y=Object.prototype.toString;var X=G?G.toStringTag:void 0;function ee(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":X&&X in Object(e)?function(e){var t=Z.call(e,Q),i=e[Q];try{e[Q]=void 0;var n=!0;}catch(e){}var s=J.call(e);return n&&(t?e[Q]=i:delete e[Q]),s;}(e):function(e){return Y.call(e);}(e);}function te(e){return null!=e&&"object"==_typeof(e);}function ie(e){return"symbol"==_typeof(e)||te(e)&&"[object Symbol]"==ee(e);}function ne(e,t){for(var i=-1,n=null==e?0:e.length,s=Array(n);++i<n;)s[i]=t(e[i],i,e);return s;}var se=Array.isArray,oe=G?G.prototype:void 0,re=oe?oe.toString:void 0;function ae(e){if("string"==typeof e)return e;if(se(e))return ne(e,ae)+"";if(ie(e))return re?re.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t;}var le=/\s/;var ce=/^\s+/;function de(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&le.test(e.charAt(t)););return t;}(e)+1).replace(ce,""):e;}function ue(e){var t=_typeof(e);return null!=e&&("object"==t||"function"==t);}var he=/^[-+]0x[0-9a-f]+$/i,me=/^0b[01]+$/i,ge=/^0o[0-7]+$/i,fe=parseInt;function pe(e){if("number"==typeof e)return e;if(ie(e))return NaN;if(ue(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ue(t)?t+"":t;}if("string"!=typeof e)return 0===e?e:+e;e=de(e);var i=me.test(e);return i||ge.test(e)?fe(e.slice(2),i?2:8):he.test(e)?NaN:+e;}function be(e){return e;}function we(e){if(!ue(e))return!1;var t=ee(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t;}var _e=q["__core-js_shared__"],ve=function(){var e=/[^.]+$/.exec(_e&&_e.keys&&_e.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:"";}();var ye=Function.prototype.toString;function ke(e){if(null!=e){try{return ye.call(e);}catch(e){}try{return e+"";}catch(e){}}return"";}var Ce=/^\[object .+?Constructor\]$/,xe=Function.prototype,Ae=Object.prototype,Ee=xe.toString,Te=Ae.hasOwnProperty,Pe=RegExp("^"+Ee.call(Te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Se(e){return!(!ue(e)||(t=e,ve&&ve in t))&&(we(e)?Pe:Ce).test(ke(e));var t;}function Ie(e,t){var i=function(e,t){return null==e?void 0:e[t];}(e,t);return Se(i)?i:void 0;}var Ve=Ie(q,"WeakMap"),Re=Object.create,Oe=function(){function e(){}return function(t){if(!ue(t))return{};if(Re)return Re(t);e.prototype=t;var i=new e();return e.prototype=void 0,i;};}();function Be(e,t){var i=-1,n=e.length;for(t||(t=Array(n));++i<n;)t[i]=e[i];return t;}var Me=Date.now;var Le=function(){try{var e=Ie(Object,"defineProperty");return e({},"",{}),e;}catch(e){}}(),Fe=function(e){var t=0,i=0;return function(){var n=Me(),s=16-(n-i);if(i=n,s>0){if(++t>=800)return arguments[0];}else t=0;return e.apply(void 0,arguments);};}(Le?function(e,t){return Le(e,"toString",{configurable:!0,enumerable:!1,value:(i=t,function(){return i;}),writable:!0});var i;}:be);var Ne=/^(?:0|[1-9]\d*)$/;function De(e,t){var i=_typeof(e);return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&Ne.test(e))&&e>-1&&e%1==0&&e<t;}function ze(e,t,i){"__proto__"==t&&Le?Le(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i;}function He(e,t){return e===t||e!=e&&t!=t;}var $e=Object.prototype.hasOwnProperty;function Ue(e,t,i){var n=e[t];$e.call(e,t)&&He(n,i)&&(void 0!==i||t in e)||ze(e,t,i);}function We(e,t,i,n){var s=!i;i||(i={});for(var o=-1,r=t.length;++o<r;){var a=t[o],l=void 0;void 0===l&&(l=e[a]),s?ze(i,a,l):Ue(i,a,l);}return i;}var je=Math.max;function qe(e,t){return Fe(function(e,t,i){return t=je(void 0===t?e.length-1:t,0),function(){for(var n=arguments,s=-1,o=je(n.length-t,0),r=Array(o);++s<o;)r[s]=n[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=n[s];return a[t]=i(r),function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2]);}return e.apply(t,i);}(e,this,a);};}(e,t,be),e+"");}function Ge(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991;}function Ke(e){return null!=e&&Ge(e.length)&&!we(e);}function Ze(e){return qe(function(t,i){var n=-1,s=i.length,o=s>1?i[s-1]:void 0,r=s>2?i[2]:void 0;for(o=e.length>3&&"function"==typeof o?(s--,o):void 0,r&&function(e,t,i){if(!ue(i))return!1;var n=_typeof(t);return!!("number"==n?Ke(i)&&De(t,i.length):"string"==n&&t in i)&&He(i[t],e);}(i[0],i[1],r)&&(o=s<3?void 0:o,s=1),t=Object(t);++n<s;){var a=i[n];a&&e(t,a,n,o);}return t;});}var Je=Object.prototype;function Qe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Je);}function Ye(e){return te(e)&&"[object Arguments]"==ee(e);}var Xe=Object.prototype,et=Xe.hasOwnProperty,tt=Xe.propertyIsEnumerable,it=Ye(function(){return arguments;}())?Ye:function(e){return te(e)&&et.call(e,"callee")&&!tt.call(e,"callee");};var nt="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,st=nt&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))&&module&&!module.nodeType&&module,ot=st&&st.exports===nt?q.Buffer:void 0,rt=(ot?ot.isBuffer:void 0)||function(){return!1;},at={};function lt(e){return function(t){return e(t);};}at["[object Float32Array]"]=at["[object Float64Array]"]=at["[object Int8Array]"]=at["[object Int16Array]"]=at["[object Int32Array]"]=at["[object Uint8Array]"]=at["[object Uint8ClampedArray]"]=at["[object Uint16Array]"]=at["[object Uint32Array]"]=!0,at["[object Arguments]"]=at["[object Array]"]=at["[object ArrayBuffer]"]=at["[object Boolean]"]=at["[object DataView]"]=at["[object Date]"]=at["[object Error]"]=at["[object Function]"]=at["[object Map]"]=at["[object Number]"]=at["[object Object]"]=at["[object RegExp]"]=at["[object Set]"]=at["[object String]"]=at["[object WeakMap]"]=!1;var ct="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,dt=ct&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))&&module&&!module.nodeType&&module,ut=dt&&dt.exports===ct&&W.process,ht=function(){try{var e=dt&&dt.require&&dt.require("util").types;return e||ut&&ut.binding&&ut.binding("util");}catch(e){}}(),mt=ht&&ht.isTypedArray,gt=mt?lt(mt):function(e){return te(e)&&Ge(e.length)&&!!at[ee(e)];},ft=Object.prototype.hasOwnProperty;function pt(e,t){var i=se(e),n=!i&&it(e),s=!i&&!n&&rt(e),o=!i&&!n&&!s&&gt(e),r=i||n||s||o,a=r?function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n;}(e.length,String):[],l=a.length;for(var c in e)!t&&!ft.call(e,c)||r&&("length"==c||s&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||De(c,l))||a.push(c);return a;}function bt(e,t){return function(i){return e(t(i));};}var wt=bt(Object.keys,Object),_t=Object.prototype.hasOwnProperty;function vt(e){return Ke(e)?pt(e):function(e){if(!Qe(e))return wt(e);var t=[];for(var i in Object(e))_t.call(e,i)&&"constructor"!=i&&t.push(i);return t;}(e);}var yt=Object.prototype.hasOwnProperty;function kt(e){if(!ue(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t;}(e);var t=Qe(e),i=[];for(var n in e)("constructor"!=n||!t&&yt.call(e,n))&&i.push(n);return i;}function Ct(e){return Ke(e)?pt(e,!0):kt(e);}var xt=Ze(function(e,t){We(t,Ct(t),e);}),At=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Et=/^\w*$/;function Tt(e,t){if(se(e))return!1;var i=_typeof(e);return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!ie(e))||Et.test(e)||!At.test(e)||null!=t&&e in Object(t);}var Pt=Ie(Object,"create");var St=Object.prototype.hasOwnProperty;var It=Object.prototype.hasOwnProperty;function Vt(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1]);}}function Rt(e,t){for(var i=e.length;i--;)if(He(e[i][0],t))return i;return-1;}Vt.prototype.clear=function(){this.__data__=Pt?Pt(null):{},this.size=0;},Vt.prototype["delete"]=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t;},Vt.prototype.get=function(e){var t=this.__data__;if(Pt){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i;}return St.call(t,e)?t[e]:void 0;},Vt.prototype.has=function(e){var t=this.__data__;return Pt?void 0!==t[e]:It.call(t,e);},Vt.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Pt&&void 0===t?"__lodash_hash_undefined__":t,this;};var Ot=Array.prototype.splice;function Bt(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1]);}}Bt.prototype.clear=function(){this.__data__=[],this.size=0;},Bt.prototype["delete"]=function(e){var t=this.__data__,i=Rt(t,e);return!(i<0)&&(i==t.length-1?t.pop():Ot.call(t,i,1),--this.size,!0);},Bt.prototype.get=function(e){var t=this.__data__,i=Rt(t,e);return i<0?void 0:t[i][1];},Bt.prototype.has=function(e){return Rt(this.__data__,e)>-1;},Bt.prototype.set=function(e,t){var i=this.__data__,n=Rt(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this;};var Mt=Ie(q,"Map");function Lt(e,t){var i,n,s=e.__data__;return("string"==(n=_typeof(i=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==i:null===i)?s["string"==typeof t?"string":"hash"]:s.map;}function Ft(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1]);}}Ft.prototype.clear=function(){this.size=0,this.__data__={hash:new Vt(),map:new(Mt||Bt)(),string:new Vt()};},Ft.prototype["delete"]=function(e){var t=Lt(this,e)["delete"](e);return this.size-=t?1:0,t;},Ft.prototype.get=function(e){return Lt(this,e).get(e);},Ft.prototype.has=function(e){return Lt(this,e).has(e);},Ft.prototype.set=function(e,t){var i=Lt(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this;};function Nt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var _i6=function i(){var n=arguments,s=t?t.apply(this,n):n[0],o=_i6.cache;if(o.has(s))return o.get(s);var r=e.apply(this,n);return _i6.cache=o.set(s,r)||o,r;};return _i6.cache=new(Nt.Cache||Ft)(),_i6;}Nt.Cache=Ft;var Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zt=/\\(\\)?/g,Ht=function(e){var t=Nt(e,function(e){return 500===i.size&&i.clear(),e;}),i=t.cache;return t;}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Dt,function(e,i,n,s){t.push(n?s.replace(zt,"$1"):i||e);}),t;});function $t(e){return null==e?"":ae(e);}function Ut(e,t){return se(e)?e:Tt(e,t)?[e]:Ht($t(e));}function Wt(e){if("string"==typeof e||ie(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t;}function jt(e,t){for(var i=0,n=(t=Ut(t,e)).length;null!=e&&i<n;)e=e[Wt(t[i++])];return i&&i==n?e:void 0;}function qt(e,t,i){var n=null==e?void 0:jt(e,t);return void 0===n?i:n;}function Gt(e,t){for(var i=-1,n=t.length,s=e.length;++i<n;)e[s+i]=t[i];return e;}var Kt=bt(Object.getPrototypeOf,Object),Zt=Function.prototype,Jt=Object.prototype,Qt=Zt.toString,Yt=Jt.hasOwnProperty,Xt=Qt.call(Object);function ei(e){if(!te(e)||"[object Object]"!=ee(e))return!1;var t=Kt(e);if(null===t)return!0;var i=Yt.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Qt.call(i)==Xt;}function ti(e,t,i){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),(i=i>s?s:i)<0&&(i+=s),s=t>i?0:i-t>>>0,t>>>=0;for(var o=Array(s);++n<s;)o[n]=e[n+t];return o;}var ii=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function ni(e){return ii.test(e);}var si="\\ud800-\\udfff",oi="["+si+"]",ri="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ai="\\ud83c[\\udffb-\\udfff]",li="[^"+si+"]",ci="(?:\\ud83c[\\udde6-\\uddff]){2}",di="[\\ud800-\\udbff][\\udc00-\\udfff]",ui="(?:"+ri+"|"+ai+")"+"?",hi="[\\ufe0e\\ufe0f]?",mi=hi+ui+("(?:\\u200d(?:"+[li,ci,di].join("|")+")"+hi+ui+")*"),gi="(?:"+[li+ri+"?",ri,ci,di,oi].join("|")+")",fi=RegExp(ai+"(?="+ai+")|"+gi+mi,"g");function pi(e){return ni(e)?function(e){return e.match(fi)||[];}(e):function(e){return e.split("");}(e);}var bi,wi=(bi="toUpperCase",function(e){var t,i,n,s,o=ni(e=$t(e))?pi(e):void 0,r=o?o[0]:e.charAt(0),a=o?(t=o,i=1,s=t.length,n=void 0===n?s:n,!i&&n>=s?t:ti(t,i,n)).join(""):e.slice(1);return r[bi]()+a;});function _i(e){return function(t){return null==e?void 0:e[t];};}var vi=_i({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),yi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ki=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");var Ci=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var xi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Ai="\\ud800-\\udfff",Ei="\\u2700-\\u27bf",Ti="a-z\\xdf-\\xf6\\xf8-\\xff",Pi="A-Z\\xc0-\\xd6\\xd8-\\xde",Si="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ii="["+Si+"]",Vi="\\d+",Ri="["+Ei+"]",Oi="["+Ti+"]",Bi="[^"+Ai+Si+Vi+Ei+Ti+Pi+"]",Mi="(?:\\ud83c[\\udde6-\\uddff]){2}",Li="[\\ud800-\\udbff][\\udc00-\\udfff]",Fi="["+Pi+"]",Ni="(?:"+Oi+"|"+Bi+")",Di="(?:"+Fi+"|"+Bi+")",zi="(?:['’](?:d|ll|m|re|s|t|ve))?",Hi="(?:['’](?:D|LL|M|RE|S|T|VE))?",$i="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Ui="[\\ufe0e\\ufe0f]?",Wi=Ui+$i+("(?:\\u200d(?:"+["[^"+Ai+"]",Mi,Li].join("|")+")"+Ui+$i+")*"),ji="(?:"+[Ri,Mi,Li].join("|")+")"+Wi,qi=RegExp([Fi+"?"+Oi+"+"+zi+"(?="+[Ii,Fi,"$"].join("|")+")",Di+"+"+Hi+"(?="+[Ii,Fi+Ni,"$"].join("|")+")",Fi+"?"+Ni+"+"+zi,Fi+"+"+Hi,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Vi,ji].join("|"),"g");function Gi(e,t,i){return e=$t(e),void 0===t?function(e){return xi.test(e);}(e)?function(e){return e.match(qi)||[];}(e):function(e){return e.match(Ci)||[];}(e):e.match(t)||[];}var Ki=RegExp("['’]","g");function Zi(e){var t=this.__data__=new Bt(e);this.size=t.size;}Zi.prototype.clear=function(){this.__data__=new Bt(),this.size=0;},Zi.prototype["delete"]=function(e){var t=this.__data__,i=t["delete"](e);return this.size=t.size,i;},Zi.prototype.get=function(e){return this.__data__.get(e);},Zi.prototype.has=function(e){return this.__data__.has(e);},Zi.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Bt){var n=i.__data__;if(!Mt||n.length<199)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new Ft(n);}return i.set(e,t),this.size=i.size,this;};var Ji="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,Qi=Ji&&"object"==(typeof module==="undefined"?"undefined":_typeof(module))&&module&&!module.nodeType&&module,Yi=Qi&&Qi.exports===Ji?q.Buffer:void 0,Xi=Yi?Yi.allocUnsafe:void 0;function en(e,t){if(t)return e.slice();var i=e.length,n=Xi?Xi(i):new e.constructor(i);return e.copy(n),n;}function tn(){return[];}var nn=Object.prototype.propertyIsEnumerable,sn=Object.getOwnPropertySymbols,on=sn?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var i=-1,n=null==e?0:e.length,s=0,o=[];++i<n;){var r=e[i];t(r,i,e)&&(o[s++]=r);}return o;}(sn(e),function(t){return nn.call(e,t);}));}:tn;var rn=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Gt(t,on(e)),e=Kt(e);return t;}:tn;function an(e,t,i){var n=t(e);return se(e)?n:Gt(n,i(e));}function ln(e){return an(e,vt,on);}function cn(e){return an(e,Ct,rn);}var dn=Ie(q,"DataView"),un=Ie(q,"Promise"),hn=Ie(q,"Set"),mn="[object Map]",gn="[object Promise]",fn="[object Set]",pn="[object WeakMap]",bn="[object DataView]",wn=ke(dn),_n=ke(Mt),vn=ke(un),yn=ke(hn),kn=ke(Ve),Cn=ee;(dn&&Cn(new dn(new ArrayBuffer(1)))!=bn||Mt&&Cn(new Mt())!=mn||un&&Cn(un.resolve())!=gn||hn&&Cn(new hn())!=fn||Ve&&Cn(new Ve())!=pn)&&(Cn=function Cn(e){var t=ee(e),i="[object Object]"==t?e.constructor:void 0,n=i?ke(i):"";if(n)switch(n){case wn:return bn;case _n:return mn;case vn:return gn;case yn:return fn;case kn:return pn;}return t;});var xn=Object.prototype.hasOwnProperty;var An=q.Uint8Array;function En(e){var t=new e.constructor(e.byteLength);return new An(t).set(new An(e)),t;}var Tn=/\w*$/;var Pn=G?G.prototype:void 0,Sn=Pn?Pn.valueOf:void 0;function In(e,t){var i=t?En(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length);}function Vn(e,t,i){var n,s,o,r=e.constructor;switch(t){case"[object ArrayBuffer]":return En(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e,t){var i=t?En(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength);}(e,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return In(e,i);case"[object Map]":case"[object Set]":return new r();case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return(o=new(s=e).constructor(s.source,Tn.exec(s))).lastIndex=s.lastIndex,o;case"[object Symbol]":return n=e,Sn?Object(Sn.call(n)):{};}}function Rn(e){return"function"!=typeof e.constructor||Qe(e)?{}:Oe(Kt(e));}var On=ht&&ht.isMap,Bn=On?lt(On):function(e){return te(e)&&"[object Map]"==Cn(e);};var Mn=ht&&ht.isSet,Ln=Mn?lt(Mn):function(e){return te(e)&&"[object Set]"==Cn(e);},Fn="[object Arguments]",Nn="[object Function]",Dn="[object Object]",zn={};function Hn(e,t,i,n,s,o){var r,a=1&t,l=2&t,c=4&t;if(i&&(r=s?i(e,n,s,o):i(e)),void 0!==r)return r;if(!ue(e))return e;var d=se(e);if(d){if(r=function(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&xn.call(e,"index")&&(i.index=e.index,i.input=e.input),i;}(e),!a)return Be(e,r);}else{var u=Cn(e),h=u==Nn||"[object GeneratorFunction]"==u;if(rt(e))return en(e,a);if(u==Dn||u==Fn||h&&!s){if(r=l||h?{}:Rn(e),!a)return l?function(e,t){return We(e,rn(e),t);}(e,function(e,t){return e&&We(t,Ct(t),e);}(r,e)):function(e,t){return We(e,on(e),t);}(e,function(e,t){return e&&We(t,vt(t),e);}(r,e));}else{if(!zn[u])return s?e:{};r=Vn(e,u,a);}}o||(o=new Zi());var m=o.get(e);if(m)return m;o.set(e,r),Ln(e)?e.forEach(function(n){r.add(Hn(n,t,i,n,e,o));}):Bn(e)&&e.forEach(function(n,s){r.set(s,Hn(n,t,i,s,e,o));});var g=d?void 0:(c?l?cn:ln:l?Ct:vt)(e);return function(e,t){for(var i=-1,n=null==e?0:e.length;++i<n&&!1!==t(e[i],i,e););}(g||e,function(n,s){g&&(n=e[s=n]),Ue(r,s,Hn(n,t,i,s,e,o));}),r;}zn[Fn]=zn["[object Array]"]=zn["[object ArrayBuffer]"]=zn["[object DataView]"]=zn["[object Boolean]"]=zn["[object Date]"]=zn["[object Float32Array]"]=zn["[object Float64Array]"]=zn["[object Int8Array]"]=zn["[object Int16Array]"]=zn["[object Int32Array]"]=zn["[object Map]"]=zn["[object Number]"]=zn[Dn]=zn["[object RegExp]"]=zn["[object Set]"]=zn["[object String]"]=zn["[object Symbol]"]=zn["[object Uint8Array]"]=zn["[object Uint8ClampedArray]"]=zn["[object Uint16Array]"]=zn["[object Uint32Array]"]=!0,zn["[object Error]"]=zn[Nn]=zn["[object WeakMap]"]=!1;function $n(e){return Hn(e,4);}function Un(e){return Hn(e,5);}function Wn(e,t){return Hn(e,5,t="function"==typeof t?t:void 0);}function jn(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new Ft();++t<i;)this.add(e[t]);}function qn(e,t){for(var i=-1,n=null==e?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1;}function Gn(e,t){return e.has(t);}jn.prototype.add=jn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this;},jn.prototype.has=function(e){return this.__data__.has(e);};function Kn(e,t,i,n,s,o){var r=1&i,a=e.length,l=t.length;if(a!=l&&!(r&&l>a))return!1;var c=o.get(e),d=o.get(t);if(c&&d)return c==t&&d==e;var u=-1,h=!0,m=2&i?new jn():void 0;for(o.set(e,t),o.set(t,e);++u<a;){var g=e[u],f=t[u];if(n)var p=r?n(f,g,u,t,e,o):n(g,f,u,e,t,o);if(void 0!==p){if(p)continue;h=!1;break;}if(m){if(!qn(t,function(e,t){if(!Gn(m,t)&&(g===e||s(g,e,i,n,o)))return m.push(t);})){h=!1;break;}}else if(g!==f&&!s(g,f,i,n,o)){h=!1;break;}}return o["delete"](e),o["delete"](t),h;}function Zn(e){var t=-1,i=Array(e.size);return e.forEach(function(e,n){i[++t]=[n,e];}),i;}function Jn(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e;}),i;}var Qn=G?G.prototype:void 0,Yn=Qn?Qn.valueOf:void 0;var Xn=Object.prototype.hasOwnProperty;var es="[object Arguments]",ts="[object Array]",is="[object Object]",ns=Object.prototype.hasOwnProperty;function ss(e,t,i,n,s,o){var r=se(e),a=se(t),l=r?ts:Cn(e),c=a?ts:Cn(t),d=(l=l==es?is:l)==is,u=(c=c==es?is:c)==is,h=l==c;if(h&&rt(e)){if(!rt(t))return!1;r=!0,d=!1;}if(h&&!d)return o||(o=new Zi()),r||gt(e)?Kn(e,t,i,n,s,o):function(e,t,i,n,s,o,r){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new An(e),new An(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return He(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=Zn;case"[object Set]":var l=1&n;if(a||(a=Jn),e.size!=t.size&&!l)return!1;var c=r.get(e);if(c)return c==t;n|=2,r.set(e,t);var d=Kn(a(e),a(t),n,s,o,r);return r["delete"](e),d;case"[object Symbol]":if(Yn)return Yn.call(e)==Yn.call(t);}return!1;}(e,t,l,i,n,s,o);if(!(1&i)){var m=d&&ns.call(e,"__wrapped__"),g=u&&ns.call(t,"__wrapped__");if(m||g){var f=m?e.value():e,p=g?t.value():t;return o||(o=new Zi()),s(f,p,i,n,o);}}return!!h&&(o||(o=new Zi()),function(e,t,i,n,s,o){var r=1&i,a=ln(e),l=a.length;if(l!=ln(t).length&&!r)return!1;for(var c=l;c--;){var d=a[c];if(!(r?d in t:Xn.call(t,d)))return!1;}var u=o.get(e),h=o.get(t);if(u&&h)return u==t&&h==e;var m=!0;o.set(e,t),o.set(t,e);for(var g=r;++c<l;){var f=e[d=a[c]],p=t[d];if(n)var b=r?n(p,f,d,t,e,o):n(f,p,d,e,t,o);if(!(void 0===b?f===p||s(f,p,i,n,o):b)){m=!1;break;}g||(g="constructor"==d);}if(m&&!g){var w=e.constructor,_=t.constructor;w==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof w&&w instanceof w&&"function"==typeof _&&_ instanceof _||(m=!1);}return o["delete"](e),o["delete"](t),m;}(e,t,i,n,s,o));}function os(e,t,i,n,s){return e===t||(null==e||null==t||!te(e)&&!te(t)?e!=e&&t!=t:ss(e,t,i,n,os,s));}function rs(e){return e==e&&!ue(e);}function as(e,t){return function(i){return null!=i&&i[e]===t&&(void 0!==t||e in Object(i));};}function ls(e){var t=function(e){for(var t=vt(e),i=t.length;i--;){var n=t[i],s=e[n];t[i]=[n,s,rs(s)];}return t;}(e);return 1==t.length&&t[0][2]?as(t[0][0],t[0][1]):function(i){return i===e||function(e,t,i,n){var s=i.length,o=s;if(null==e)return!o;for(e=Object(e);s--;){var r=i[s];if(r[2]?r[1]!==e[r[0]]:!(r[0]in e))return!1;}for(;++s<o;){var a=(r=i[s])[0],l=e[a],c=r[1];if(r[2]){if(void 0===l&&!(a in e))return!1;}else if(!os(c,l,3,n,new Zi()))return!1;}return!0;}(i,0,t);};}function cs(e,t){return null!=e&&t in Object(e);}function ds(e,t){return null!=e&&function(e,t,i){for(var n=-1,s=(t=Ut(t,e)).length,o=!1;++n<s;){var r=Wt(t[n]);if(!(o=null!=e&&i(e,r)))break;e=e[r];}return o||++n!=s?o:!!(s=null==e?0:e.length)&&Ge(s)&&De(r,s)&&(se(e)||it(e));}(e,t,cs);}function us(e){return Tt(e)?(t=Wt(e),function(e){return null==e?void 0:e[t];}):function(e){return function(t){return jt(t,e);};}(e);var t;}function hs(e){return"function"==typeof e?e:null==e?be:"object"==_typeof(e)?se(e)?(t=e[0],i=e[1],Tt(t)&&rs(i)?as(Wt(t),i):function(e){var n=qt(e,t);return void 0===n&&n===i?ds(e,t):os(i,n,3);}):ls(e):us(e);var t,i;}var ms=function ms(e,t,i){for(var n=-1,s=Object(e),o=i(e),r=o.length;r--;){var a=o[++n];if(!1===t(s[a],a,s))break;}return e;};function gs(e,t){return e&&ms(e,t,vt);}var fs,ps=(fs=gs,function(e,t){if(null==e)return e;if(!Ke(e))return fs(e,t);for(var i=e.length,n=-1,s=Object(e);++n<i&&!1!==t(s[n],n,s););return e;}),bs=function bs(){return q.Date.now();},ws=Math.max,_s=Math.min;function vs(e,t,i){var n,s,o,r,a,l,c=0,d=!1,u=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var i=n,o=s;return n=s=void 0,c=t,r=e.apply(o,i);}function g(e){var i=e-l;return void 0===l||i>=t||i<0||u&&e-c>=o;}function f(){var e=bs();if(g(e))return p(e);a=setTimeout(f,function(e){var i=t-(e-l);return u?_s(i,o-(e-c)):i;}(e));}function p(e){return a=void 0,h&&n?m(e):(n=s=void 0,r);}function b(){var e=bs(),i=g(e);if(n=arguments,s=this,l=e,i){if(void 0===a)return function(e){return c=e,a=setTimeout(f,t),d?m(e):r;}(l);if(u)return clearTimeout(a),a=setTimeout(f,t),m(l);}return void 0===a&&(a=setTimeout(f,t)),r;}return t=pe(t)||0,ue(i)&&(d=!!i.leading,o=(u="maxWait"in i)?ws(pe(i.maxWait)||0,t):o,h="trailing"in i?!!i.trailing:h),b.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=s=a=void 0;},b.flush=function(){return void 0===a?r:p(bs());},b;}function ys(e,t,i){(void 0!==i&&!He(e[t],i)||void 0===i&&!(t in e))&&ze(e,t,i);}function ks(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t];}function Cs(e,t,i,n,s,o,r){var a=ks(e,i),l=ks(t,i),c=r.get(l);if(c)ys(e,i,c);else{var d,u=o?o(a,l,i+"",e,t,r):void 0,h=void 0===u;if(h){var m=se(l),g=!m&&rt(l),f=!m&&!g&&gt(l);u=l,m||g||f?se(a)?u=a:te(d=a)&&Ke(d)?u=Be(a):g?(h=!1,u=en(l,!0)):f?(h=!1,u=In(l,!0)):u=[]:ei(l)||it(l)?(u=a,it(a)?u=function(e){return We(e,Ct(e));}(a):ue(a)&&!we(a)||(u=Rn(l))):h=!1;}h&&(r.set(l,u),s(u,l,n,o,r),r["delete"](l)),ys(e,i,u);}}function xs(e,t,i,n,s){e!==t&&ms(t,function(o,r){if(s||(s=new Zi()),ue(o))Cs(e,t,r,i,xs,n,s);else{var a=n?n(ks(e,r),o,r+"",e,t,s):void 0;void 0===a&&(a=o),ys(e,r,a);}},Ct);}var As=Ze(function(e,t,i,n){xs(e,t,i,n);});var Es=_i({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Ts=/[&<>"']/g,Ps=RegExp(Ts.source);function Ss(e){return(e=$t(e))&&Ps.test(e)?e.replace(Ts,Es):e;}var Is=/[\\^$.*+?()[\]{}|]/g,Vs=RegExp(Is.source);function Rs(e){return(e=$t(e))&&Vs.test(e)?e.replace(Is,"\\$&"):e;}function Os(e,t){var i=-1,n=Ke(e)?Array(e.length):[];return ps(e,function(e,s,o){n[++i]=t(e,s,o);}),n;}function Bs(e){return"string"==typeof e||!se(e)&&te(e)&&"[object String]"==ee(e);}function Ms(e){return te(e)&&1===e.nodeType&&!ei(e);}function Ls(e,t){return os(e,t);}var Fs=Ze(function(e,t,i){xs(e,t,i);});function Ns(e,t){return null==(e=function(e,t){return t.length<2?e:jt(e,ti(t,0,-1));}(e,t=Ut(t,e)))||delete e[Wt((i=t,n=null==i?0:i.length,n?i[n-1]:void 0))];var i,n;}function Ds(e,t,i){return null==e?e:function(e,t,i){if(!ue(e))return e;for(var n=-1,s=(t=Ut(t,e)).length,o=s-1,r=e;null!=r&&++n<s;){var a=Wt(t[n]),l=i;if("__proto__"===a||"constructor"===a||"prototype"===a)return e;if(n!=o){var c=r[a];void 0===(l=void 0)&&(l=ue(c)?c:De(t[n+1])?[]:{});}Ue(r,a,l),r=r[a];}return e;}(e,t,i);}var zs,Hs=(zs=function zs(e,t,i){return e+(i?" ":"")+wi(t);},function(e){return function(e,t,i){for(var n=-1,s=null==e?0:e.length;++n<s;)i=t(i,e[n],n,e);return i;}(Gi(function(e){return(e=$t(e))&&e.replace(yi,vi).replace(ki,"");}(e).replace(Ki,"")),zs,"");});function $s(e,t,i){var n=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ue(i)&&(n="leading"in i?!!i.leading:n,s="trailing"in i?!!i.trailing:s),vs(e,t,{leading:n,maxWait:t,trailing:s});}var Us=Symbol("observableProperties"),Ws=Symbol("boundObservables"),js=Symbol("boundProperties"),qs=Symbol("decoratedMethods"),Gs=Symbol("decoratedOriginal"),Ks=Zs(L());function Zs(e){if(!e)return Ks;return/*#__PURE__*/function(_e9){function _class2(){var _this4;_classCallCheck(this,_class2);for(var _len5=arguments.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++){args[_key5]=arguments[_key5];}_this4=_callSuper(this,_class2,[].concat(args));_defineProperty(_this4,Us,void 0);_defineProperty(_this4,qs,void 0);_defineProperty(_this4,js,void 0);_defineProperty(_this4,Ws,void 0);return _this4;}_inherits(_class2,_e9);return _createClass(_class2,[{key:"set",value:function set(e,t){var _this5=this;if(ue(e))return void Object.keys(e).forEach(function(t){_this5.set(t,e[t]);},this);Js(this);var i=this[Us];if(e in this&&!i.has(e))throw new A("observable-set-cannot-override",this);Object.defineProperty(this,e,{enumerable:!0,configurable:!0,get:function get(){return i.get(e);},set:function set(t){var n=i.get(e);var s=this.fire("set:".concat(e),e,t,n);void 0===s&&(s=t),n===s&&i.has(e)||(i.set(e,s),this.fire("change:".concat(e),e,s,n));}}),this[e]=t;}},{key:"bind",value:function bind(){var _this6=this;for(var _len6=arguments.length,e=new Array(_len6),_key6=0;_key6<_len6;_key6++){e[_key6]=arguments[_key6];}if(!e.length||!Xs(e))throw new A("observable-bind-wrong-properties",this);if(new Set(e).size!==e.length)throw new A("observable-bind-duplicate-properties",this);Js(this);var t=this[js];e.forEach(function(e){if(t.has(e))throw new A("observable-bind-rebind",_this6);});var i=new Map();return e.forEach(function(e){var n={property:e,to:[]};t.set(e,n),i.set(e,n);}),{to:Qs,toMany:Ys,_observable:this,_bindProperties:e,_to:[],_bindings:i};}},{key:"unbind",value:function unbind(){var _this7=this;if(!this[Us])return;var t=this[js],i=this[Ws];for(var _len7=arguments.length,e=new Array(_len7),_key7=0;_key7<_len7;_key7++){e[_key7]=arguments[_key7];}if(e.length){if(!Xs(e))throw new A("observable-unbind-wrong-properties",this);e.forEach(function(e){var n=t.get(e);n&&(n.to.forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),e=_ref2[0],t=_ref2[1];var s=i.get(e),o=s[t];o["delete"](n),o.size||delete s[t],Object.keys(s).length||(i["delete"](e),_this7.stopListening(e,"change"));}),t["delete"](e));});}else i.forEach(function(e,t){_this7.stopListening(t,"change");}),i.clear(),t.clear();}},{key:"decorate",value:function decorate(e){var _this8=this;Js(this);var t=this[e];if(!t)throw new A("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:e});this.on(e,function(e,i){e["return"]=t.apply(_this8,i);}),this[e]=function(){for(var _len8=arguments.length,t=new Array(_len8),_key8=0;_key8<_len8;_key8++){t[_key8]=arguments[_key8];}return this.fire(e,t);},this[e][Gs]=t,this[qs]||(this[qs]=[]),this[qs].push(e);}},{key:"stopListening",value:function stopListening(e,t,i){if(!e&&this[qs]){var _iterator5=_createForOfIteratorHelper(this[qs]),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var _e10=_step5.value;this[_e10]=this[_e10][Gs];}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}delete this[qs];}_superPropGet(_class2,"stopListening",this,3)([e,t,i]);}}]);}(e);}function Js(e){e[Us]||(Object.defineProperty(e,Us,{value:new Map()}),Object.defineProperty(e,Ws,{value:new Map()}),Object.defineProperty(e,js,{value:new Map()}));}function Qs(){var _this9=this;var t=function(){for(var _len9=arguments.length,e=new Array(_len9),_key9=0;_key9<_len9;_key9++){e[_key9]=arguments[_key9];}if(!e.length)throw new A("observable-bind-to-parse-error",null);var t={to:[]};var i;"function"==typeof e[e.length-1]&&(t.callback=e.pop());return e.forEach(function(e){if("string"==typeof e)i.properties.push(e);else{if("object"!=_typeof(e))throw new A("observable-bind-to-parse-error",null);i={observable:e,properties:[]},t.to.push(i);}}),t;}.apply(void 0,arguments),i=Array.from(this._bindings.keys()),n=i.length;if(!t.callback&&t.to.length>1)throw new A("observable-bind-to-no-callback",this);if(n>1&&t.callback)throw new A("observable-bind-to-extra-callback",this);var s;t.to.forEach(function(e){if(e.properties.length&&e.properties.length!==n)throw new A("observable-bind-to-properties-length",_this9);e.properties.length||(e.properties=_this9._bindProperties);}),this._to=t.to,t.callback&&(this._bindings.get(i[0]).callback=t.callback),s=this._observable,this._to.forEach(function(e){var t=s[Ws];var i;t.get(e.observable)||s.listenTo(e.observable,"change",function(n,o){i=t.get(e.observable)[o],i&&i.forEach(function(e){eo(s,e.property);});});}),function(e){var t;e._bindings.forEach(function(i,n){e._to.forEach(function(s){t=s.properties[i.callback?0:e._bindProperties.indexOf(n)],i.to.push([s.observable,t]),function(e,t,i,n){var s=e[Ws],o=s.get(i),r=o||{};r[n]||(r[n]=new Set());r[n].add(t),o||s.set(i,r);}(e._observable,i,s.observable,t);});});}(this),this._bindProperties.forEach(function(e){eo(_this9._observable,e);});}function Ys(e,t,i){if(this._bindings.size>1)throw new A("observable-bind-to-many-not-one-binding",this);this.to.apply(this,_toConsumableArray(function(e,t){var i=e.map(function(e){return[e,t];});return Array.prototype.concat.apply([],i);}(e,t)).concat([i]));}function Xs(e){return e.every(function(e){return"string"==typeof e;});}function eo(e,t){var i=e[js].get(t);var n;i.callback?n=i.callback.apply(e,i.to.map(function(e){return e[0][e[1]];})):(n=i.to[0],n=n[0][n[1]]),Object.prototype.hasOwnProperty.call(e,t)?e[t]=n:e.set(t,n);}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(function(e){Zs[e]=Ks.prototype[e];});var to=/*#__PURE__*/function(){function to(){_classCallCheck(this,to);_defineProperty(this,"_replacedElements",void 0);this._replacedElements=[];}return _createClass(to,[{key:"replace",value:function replace(e,t){this._replacedElements.push({element:e,newElement:t}),e.style.display="none",t&&e.parentNode.insertBefore(t,e.nextSibling);}},{key:"restore",value:function restore(){this._replacedElements.forEach(function(_ref3){var e=_ref3.element,t=_ref3.newElement;e.style.display="",t&&t.remove();}),this._replacedElements=[];}}]);}();function io(e){var t=new AbortController();function i(){for(var _len10=arguments.length,i=new Array(_len10),_key10=0;_key10<_len10;_key10++){i[_key10]=arguments[_key10];}return t.abort(),t=new AbortController(),e.apply(void 0,[t.signal].concat(i));}return i.abort=function(){return t.abort();},i;}function no(e){var t=0;var _iterator6=_createForOfIteratorHelper(e),_step6;try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _i7=_step6.value;t++;}}catch(err){_iterator6.e(err);}finally{_iterator6.f();}return t;}function so(e,t){var i=Math.min(e.length,t.length);for(var _n6=0;_n6<i;_n6++)if(e[_n6]!=t[_n6])return _n6;return e.length==t.length?"same":e.length<t.length?"prefix":"extension";}function oo(e){return!(!e||!e[Symbol.iterator]);}function ro(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:[];var s=i&&i.xmlns,o=s?e.createElementNS(s,t):e.createElement(t);for(var _e11 in i)o.setAttribute(_e11,i[_e11]);!Bs(n)&&oo(n)||(n=[n]);var _iterator7=_createForOfIteratorHelper(n),_step7;try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var _t4=_step7.value;Bs(_t4)&&(_t4=e.createTextNode(_t4)),o.appendChild(_t4);}}catch(err){_iterator7.e(err);}finally{_iterator7.f();}return o;}var ao=/*#__PURE__*/function(){function ao(e,t){_classCallCheck(this,ao);_defineProperty(this,"_config",void 0);this._config=Object.create(null),t&&this.define(lo(t)),e&&this._setObjectToTarget(this._config,e);}return _createClass(ao,[{key:"set",value:function set(e,t){this._setToTarget(this._config,e,t);}},{key:"define",value:function define(e,t){this._setToTarget(this._config,e,t,!0);}},{key:"get",value:function get(e){return this._getFromSource(this._config,e);}},{key:"names",value:/*#__PURE__*/_regeneratorRuntime().mark(function names(){var _i8,_Object$keys,_e12;return _regeneratorRuntime().wrap(function names$(_context){while(1)switch(_context.prev=_context.next){case 0:_i8=0,_Object$keys=Object.keys(this._config);case 1:if(!(_i8<_Object$keys.length)){_context.next=8;break;}_e12=_Object$keys[_i8];_context.next=5;return _e12;case 5:_i8++;_context.next=1;break;case 8:case"end":return _context.stop();}},names,this);})},{key:"_setToTarget",value:function _setToTarget(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;if(ei(t))return void this._setObjectToTarget(e,t,n);var s=t.split(".");t=s.pop();var _iterator8=_createForOfIteratorHelper(s),_step8;try{for(_iterator8.s();!(_step8=_iterator8.n()).done;){var _t5=_step8.value;ei(e[_t5])||(e[_t5]=Object.create(null)),e=e[_t5];}}catch(err){_iterator8.e(err);}finally{_iterator8.f();}if(ei(i))return ei(e[t])||(e[t]=Object.create(null)),e=e[t],void this._setObjectToTarget(e,i,n);n&&void 0!==e[t]||(e[t]=i);}},{key:"_getFromSource",value:function _getFromSource(e,t){var i=t.split(".");t=i.pop();var _iterator9=_createForOfIteratorHelper(i),_step9;try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var _t6=_step9.value;if(!ei(e[_t6])){e=null;break;}e=e[_t6];}}catch(err){_iterator9.e(err);}finally{_iterator9.f();}return e?lo(e[t]):void 0;}},{key:"_setObjectToTarget",value:function _setObjectToTarget(e,t,i){var _this10=this;Object.keys(t).forEach(function(n){_this10._setToTarget(e,n,t[n],i);});}}]);}();function lo(e){return Wn(e,co);}function co(e){return Ms(e)||"function"==typeof e?e:void 0;}function uo(e){if(e){if(e.defaultView)return e instanceof e.defaultView.Document;if(e.ownerDocument&&e.ownerDocument.defaultView)return e instanceof e.ownerDocument.defaultView.Node;}return!1;}function ho(e){var t=Object.prototype.toString.apply(e);return"[object Window]"==t||"[object global]"==t;}var mo=go(L());function go(e){if(!e)return mo;return/*#__PURE__*/function(_e13){function _class3(){_classCallCheck(this,_class3);return _callSuper(this,_class3,arguments);}_inherits(_class3,_e13);return _createClass(_class3,[{key:"listenTo",value:function listenTo(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(uo(e)||ho(e)){var _s6={capture:!!n.useCapture,passive:!!n.usePassive},_o3=this._getProxyEmitter(e,_s6)||new fo(e,_s6);this.listenTo(_o3,t,i,n);}else _superPropGet(_class3,"listenTo",this,3)([e,t,i,n]);}},{key:"stopListening",value:function stopListening(e,t,i){if(uo(e)||ho(e)){var _n7=this._getAllProxyEmitters(e);var _iterator10=_createForOfIteratorHelper(_n7),_step10;try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _e14=_step10.value;this.stopListening(_e14,t,i);}}catch(err){_iterator10.e(err);}finally{_iterator10.f();}}else _superPropGet(_class3,"stopListening",this,3)([e,t,i]);}},{key:"_getProxyEmitter",value:function _getProxyEmitter(e,t){return function(e,t){var i=e[R];return i&&i[t]?i[t].emitter:null;}(this,po(e,t));}},{key:"_getAllProxyEmitters",value:function _getAllProxyEmitters(e){var _this11=this;return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(function(t){return _this11._getProxyEmitter(e,t);}).filter(function(e){return!!e;});}}]);}(e);}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(function(e){go[e]=mo.prototype[e];});var fo=/*#__PURE__*/function(_L2){function fo(e,t){var _this12;_classCallCheck(this,fo);_this12=_callSuper(this,fo),_defineProperty(_assertThisInitialized(_this12),"_domNode",void 0),_defineProperty(_assertThisInitialized(_this12),"_options",void 0),_defineProperty(_assertThisInitialized(_this12),"_domListeners",void 0),F(_assertThisInitialized(_this12),po(e,t)),_this12._domNode=e,_this12._options=t;return _this12;}_inherits(fo,_L2);return _createClass(fo,[{key:"attach",value:function attach(e){if(this._domListeners&&this._domListeners[e])return;var t=this._createDomListener(e);this._domNode.addEventListener(e,t,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=t;}},{key:"detach",value:function detach(e){var t;!this._domListeners[e]||(t=this._events[e])&&t.callbacks.length||this._domListeners[e].removeListener();}},{key:"_addEventListener",value:function _addEventListener(e,t,i){this.attach(e),L().prototype._addEventListener.call(this,e,t,i);}},{key:"_removeEventListener",value:function _removeEventListener(e,t){L().prototype._removeEventListener.call(this,e,t),this.detach(e);}},{key:"_createDomListener",value:function _createDomListener(e){var _this13=this;var t=function t(_t7){_this13.fire(e,_t7);};return t.removeListener=function(){_this13._domNode.removeEventListener(e,t,_this13._options),delete _this13._domListeners[e];},t;}}]);}(L());function po(e,t){var i=function(e){return e["data-ck-expando"]||(e["data-ck-expando"]=k());}(e);var _iterator11=_createForOfIteratorHelper(Object.keys(t).sort()),_step11;try{for(_iterator11.s();!(_step11=_iterator11.n()).done;){var _e15=_step11.value;t[_e15]&&(i+="-"+_e15);}}catch(err){_iterator11.e(err);}finally{_iterator11.f();}return i;}function bo(e){var t=e.parentElement;if(!t)return null;for(;"BODY"!=t.tagName;){var _e16=t.style.overflowY||i.window.getComputedStyle(t).overflowY;if("auto"===_e16||"scroll"===_e16)break;if(t=t.parentElement,!t)return null;}return t;}function wo(e){var t=[];var i=e;for(;i&&i.nodeType!=Node.DOCUMENT_NODE;)t.unshift(i),i=i.parentNode;return t;}function _o(e){return e instanceof HTMLTextAreaElement?e.value:e.innerHTML;}function vo(e){var t=e.ownerDocument.defaultView.getComputedStyle(e);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)};}function yo(e){if(!e.target)return null;var t=e.target.ownerDocument,i=e.clientX,n=e.clientY;var s=null;return t.caretRangeFromPoint&&t.caretRangeFromPoint(i,n)?s=t.caretRangeFromPoint(i,n):e.rangeParent&&(s=t.createRange(),s.setStart(e.rangeParent,e.rangeOffset),s.collapse(!0)),s;}function ko(e){return"[object Text]"==Object.prototype.toString.call(e);}function Co(e){return"[object Range]"==Object.prototype.toString.apply(e);}function xo(e){return e&&e.parentNode?e.offsetParent===i.document.body?null:e.offsetParent:null;}var Ao=["top","right","bottom","left","width","height"];var Eo=/*#__PURE__*/function(){function Eo(e){_classCallCheck(this,Eo);_defineProperty(this,"top",void 0);_defineProperty(this,"right",void 0);_defineProperty(this,"bottom",void 0);_defineProperty(this,"left",void 0);_defineProperty(this,"width",void 0);_defineProperty(this,"height",void 0);_defineProperty(this,"_source",void 0);var t=Co(e);if(Object.defineProperty(this,"_source",{value:e._source||e,writable:!0,enumerable:!1}),So(e)||t){if(t){var _t8=Eo.getDomRangeRects(e);To(this,Eo.getBoundingRect(_t8));}else To(this,e.getBoundingClientRect());}else if(ho(e)){var _t9=e.innerWidth,_i9=e.innerHeight;To(this,{top:0,right:_t9,bottom:_i9,left:0,width:_t9,height:_i9});}else To(this,e);}return _createClass(Eo,[{key:"clone",value:function clone(){return new Eo(this);}},{key:"moveTo",value:function moveTo(e,t){return this.top=t,this.right=e+this.width,this.bottom=t+this.height,this.left=e,this;}},{key:"moveBy",value:function moveBy(e,t){return this.top+=t,this.right+=e,this.left+=e,this.bottom+=t,this;}},{key:"getIntersection",value:function getIntersection(e){var t={top:Math.max(this.top,e.top),right:Math.min(this.right,e.right),bottom:Math.min(this.bottom,e.bottom),left:Math.max(this.left,e.left),width:0,height:0};if(t.width=t.right-t.left,t.height=t.bottom-t.top,t.width<0||t.height<0)return null;{var _e17=new Eo(t);return _e17._source=this._source,_e17;}}},{key:"getIntersectionArea",value:function getIntersectionArea(e){var t=this.getIntersection(e);return t?t.getArea():0;}},{key:"getArea",value:function getArea(){return this.width*this.height;}},{key:"getVisible",value:function getVisible(){var e=this._source;var t=this.clone();if(Po(e))return t;var i,n=e,s=e.parentNode||e.commonAncestorContainer;for(;s&&!Po(s);){var _e18="visible"===((o=s)instanceof HTMLElement?o.ownerDocument.defaultView.getComputedStyle(o).overflow:"visible");n instanceof HTMLElement&&"absolute"===Io(n)&&(i=n);var _r2=Io(s);if(_e18||i&&("relative"===_r2&&_e18||"relative"!==_r2)){n=s,s=s.parentNode;continue;}var _a2=new Eo(s),_l2=t.getIntersection(_a2);if(!_l2)return null;_l2.getArea()<t.getArea()&&(t=_l2),n=s,s=s.parentNode;}var o;return t;}},{key:"isEqual",value:function isEqual(e){for(var _i10=0,_Ao=Ao;_i10<_Ao.length;_i10++){var _t10=_Ao[_i10];if(this[_t10]!==e[_t10])return!1;}return!0;}},{key:"contains",value:function contains(e){var t=this.getIntersection(e);return!(!t||!t.isEqual(e));}},{key:"toAbsoluteRect",value:function toAbsoluteRect(){var _i$window=i.window,e=_i$window.scrollX,t=_i$window.scrollY,n=this.clone().moveBy(e,t);if(So(n._source)){var _e19=xo(n._source);_e19&&function(e,t){var i=new Eo(t),n=vo(t);var s=0,o=0;s-=i.left,o-=i.top,s+=t.scrollLeft,o+=t.scrollTop,s-=n.left,o-=n.top,e.moveBy(s,o);}(n,_e19);}return n;}},{key:"excludeScrollbarsAndBorders",value:function excludeScrollbarsAndBorders(){var e=this._source;var t,i,n;if(ho(e))t=e.innerWidth-e.document.documentElement.clientWidth,i=e.innerHeight-e.document.documentElement.clientHeight,n=e.getComputedStyle(e.document.documentElement).direction;else{var _s7=vo(e);t=e.offsetWidth-e.clientWidth-_s7.left-_s7.right,i=e.offsetHeight-e.clientHeight-_s7.top-_s7.bottom,n=e.ownerDocument.defaultView.getComputedStyle(e).direction,this.left+=_s7.left,this.top+=_s7.top,this.right-=_s7.right,this.bottom-=_s7.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top;}return this.width-=t,"ltr"===n?this.right-=t:this.left+=t,this.height-=i,this.bottom-=i,this;}}],[{key:"getDomRangeRects",value:function getDomRangeRects(e){var t=[],i=Array.from(e.getClientRects());if(i.length){var _iterator12=_createForOfIteratorHelper(i),_step12;try{for(_iterator12.s();!(_step12=_iterator12.n()).done;){var _e20=_step12.value;t.push(new Eo(_e20));}}catch(err){_iterator12.e(err);}finally{_iterator12.f();}}else{var _i11=e.startContainer;ko(_i11)&&(_i11=_i11.parentNode);var _n8=new Eo(_i11.getBoundingClientRect());_n8.right=_n8.left,_n8.width=0,t.push(_n8);}return t;}},{key:"getBoundingRect",value:function getBoundingRect(e){var t={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};var i=0;var _iterator13=_createForOfIteratorHelper(e),_step13;try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){var _n9=_step13.value;i++,t.left=Math.min(t.left,_n9.left),t.top=Math.min(t.top,_n9.top),t.right=Math.max(t.right,_n9.right),t.bottom=Math.max(t.bottom,_n9.bottom);}}catch(err){_iterator13.e(err);}finally{_iterator13.f();}return 0==i?null:(t.width=t.right-t.left,t.height=t.bottom-t.top,new Eo(t));}}]);}();function To(e,t){var _iterator14=_createForOfIteratorHelper(Ao),_step14;try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var _i12=_step14.value;e[_i12]=t[_i12];}}catch(err){_iterator14.e(err);}finally{_iterator14.f();}}function Po(e){return!!So(e)&&e===e.ownerDocument.body;}function So(e){return null!==e&&"object"==_typeof(e)&&1===e.nodeType&&"function"==typeof e.getBoundingClientRect;}function Io(e){return e instanceof HTMLElement?e.ownerDocument.defaultView.getComputedStyle(e).position:"static";}var Vo=/*#__PURE__*/function(){function Vo(e,t){_classCallCheck(this,Vo);_defineProperty(this,"_element",void 0);_defineProperty(this,"_callback",void 0);Vo._observerInstance||Vo._createObserver(),this._element=e,this._callback=t,Vo._addElementCallback(e,t),Vo._observerInstance.observe(e);}return _createClass(Vo,[{key:"element",get:function get(){return this._element;}},{key:"destroy",value:function destroy(){Vo._deleteElementCallback(this._element,this._callback);}}],[{key:"_addElementCallback",value:function _addElementCallback(e,t){Vo._elementCallbacks||(Vo._elementCallbacks=new Map());var i=Vo._elementCallbacks.get(e);i||(i=new Set(),Vo._elementCallbacks.set(e,i)),i.add(t);}},{key:"_deleteElementCallback",value:function _deleteElementCallback(e,t){var i=Vo._getElementCallbacks(e);i&&(i["delete"](t),i.size||(Vo._elementCallbacks["delete"](e),Vo._observerInstance.unobserve(e))),Vo._elementCallbacks&&!Vo._elementCallbacks.size&&(Vo._observerInstance=null,Vo._elementCallbacks=null);}},{key:"_getElementCallbacks",value:function _getElementCallbacks(e){return Vo._elementCallbacks?Vo._elementCallbacks.get(e):null;}},{key:"_createObserver",value:function _createObserver(){Vo._observerInstance=new i.window.ResizeObserver(function(e){var _iterator15=_createForOfIteratorHelper(e),_step15;try{for(_iterator15.s();!(_step15=_iterator15.n()).done;){var _t11=_step15.value;var _e21=Vo._getElementCallbacks(_t11.target);if(_e21){var _iterator16=_createForOfIteratorHelper(_e21),_step16;try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var _i13=_step16.value;_i13(_t11);}}catch(err){_iterator16.e(err);}finally{_iterator16.f();}}}}catch(err){_iterator15.e(err);}finally{_iterator15.f();}});}}]);}();_defineProperty(Vo,"_observerInstance",null);_defineProperty(Vo,"_elementCallbacks",null);function Ro(e,t){e instanceof HTMLTextAreaElement&&(e.value=t),e.innerHTML=t;}function Oo(e){return function(t){return t+e;};}function Bo(e){var t=0;for(;e.previousSibling;)e=e.previousSibling,t++;return t;}function Mo(e,t,i){e.insertBefore(i,e.childNodes[t]||null);}function Lo(e){return e&&e.nodeType===Node.COMMENT_NODE;}function Fo(e){try{i.document.createAttribute(e);}catch(e){return!1;}return!0;}function No(e){return!!e&&(ko(e)?No(e.parentElement):!!e.getClientRects&&!!e.getClientRects().length);}function Do(_ref4){var e=_ref4.element,t=_ref4.target,n=_ref4.positions,s=_ref4.limiter,o=_ref4.fitInViewport,r=_ref4.viewportOffsetConfig;we(t)&&(t=t()),we(s)&&(s=s());var a=xo(e),l=function(e){e=Object.assign({top:0,bottom:0,left:0,right:0},e);var t=new Eo(i.window);return t.top+=e.top,t.height-=e.top,t.bottom-=e.bottom,t.height-=e.bottom,t;}(r),c=new Eo(e),d=zo(t,l);var u;if(!d||!l.getIntersection(d))return null;var h={targetRect:d,elementRect:c,positionedElementAncestor:a,viewportRect:l};if(s||o){if(s){var _e22=zo(s,l);_e22&&(h.limiterRect=_e22);}u=function(e,t){var i=t.elementRect,n=i.getArea(),s=e.map(function(e){return new Ho(e,t);}).filter(function(e){return!!e.name;});var o=0,r=null;var _iterator17=_createForOfIteratorHelper(s),_step17;try{for(_iterator17.s();!(_step17=_iterator17.n()).done;){var _e23=_step17.value;var _t12=_e23.limiterIntersectionArea,_i14=_e23.viewportIntersectionArea;if(_t12===n)return _e23;var _s8=Math.pow(_i14,2)+Math.pow(_t12,2);_s8>o&&(o=_s8,r=_e23);}}catch(err){_iterator17.e(err);}finally{_iterator17.f();}return r;}(n,h);}else u=new Ho(n[0],h);return u;}function zo(e,t){var i=new Eo(e).getVisible();return i?i.getIntersection(t):null;}var Ho=/*#__PURE__*/function(){function Ho(e,t){_classCallCheck(this,Ho);_defineProperty(this,"name",void 0);_defineProperty(this,"config",void 0);_defineProperty(this,"_positioningFunctionCoordinates",void 0);_defineProperty(this,"_options",void 0);_defineProperty(this,"_cachedRect",void 0);_defineProperty(this,"_cachedAbsoluteRect",void 0);var i=e(t.targetRect,t.elementRect,t.viewportRect,t.limiterRect);if(!i)return;var n=i.left,s=i.top,o=i.name,r=i.config;this.name=o,this.config=r,this._positioningFunctionCoordinates={left:n,top:s},this._options=t;}return _createClass(Ho,[{key:"left",get:function get(){return this._absoluteRect.left;}},{key:"top",get:function get(){return this._absoluteRect.top;}},{key:"limiterIntersectionArea",get:function get(){var e=this._options.limiterRect;return e?e.getIntersectionArea(this._rect):0;}},{key:"viewportIntersectionArea",get:function get(){return this._options.viewportRect.getIntersectionArea(this._rect);}},{key:"_rect",get:function get(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top)),this._cachedRect;}},{key:"_absoluteRect",get:function get(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=this._rect.toAbsoluteRect()),this._cachedAbsoluteRect;}}]);}();function $o(e){var t=e.parentNode;t&&t.removeChild(e);}function Uo(_ref5){var e=_ref5.target,_ref5$viewportOffset=_ref5.viewportOffset,t=_ref5$viewportOffset===void 0?0:_ref5$viewportOffset,_ref5$ancestorOffset=_ref5.ancestorOffset,i=_ref5$ancestorOffset===void 0?0:_ref5$ancestorOffset,n=_ref5.alignToTop,s=_ref5.forceScroll;var o=Qo(e);var r=o,a=null;for(t=function(e){if("number"==typeof e)return{top:e,bottom:e,left:e,right:e};return e;}(t);r;){var _l3=void 0;_l3=Yo(r==o?e:a),qo({parent:_l3,getRect:function getRect(){return Xo(e,r);},alignToTop:n,ancestorOffset:i,forceScroll:s});var _c2=Xo(e,r);if(jo({window:r,rect:_c2,viewportOffset:t,alignToTop:n,forceScroll:s}),r.parent!=r){if(a=r.frameElement,r=r.parent,!a)return;}else r=null;}}function Wo(e,t,i){qo({parent:Yo(e),getRect:function getRect(){return new Eo(e);},ancestorOffset:t,limiterElement:i});}function jo(_ref6){var e=_ref6.window,t=_ref6.rect,i=_ref6.alignToTop,n=_ref6.forceScroll,s=_ref6.viewportOffset;var o=t.clone().moveBy(0,s.bottom),r=t.clone().moveBy(0,-s.top),a=new Eo(e).excludeScrollbarsAndBorders(),l=i&&n,c=[r,o].every(function(e){return a.contains(e);});var d=e.scrollX,u=e.scrollY;var h=d,m=u;l?u-=a.top-t.top+s.top:c||(Ko(r,a)?u-=a.top-t.top+s.top:Go(o,a)&&(u+=i?t.top-a.top-s.top:t.bottom-a.bottom+s.bottom)),c||(Zo(t,a)?d-=a.left-t.left+s.left:Jo(t,a)&&(d+=t.right-a.right+s.right)),d==h&&u===m||e.scrollTo(d,u);}function qo(_ref7){var e=_ref7.parent,t=_ref7.getRect,i=_ref7.alignToTop,n=_ref7.forceScroll,_ref7$ancestorOffset=_ref7.ancestorOffset,s=_ref7$ancestorOffset===void 0?0:_ref7$ancestorOffset,o=_ref7.limiterElement;var r=Qo(e),a=i&&n;var l,c,d;var u=o||r.document.body;for(;e!=u;)c=t(),l=new Eo(e).excludeScrollbarsAndBorders(),d=l.contains(c),a?e.scrollTop-=l.top-c.top+s:d||(Ko(c,l)?e.scrollTop-=l.top-c.top+s:Go(c,l)&&(e.scrollTop+=i?c.top-l.top-s:c.bottom-l.bottom+s)),d||(Zo(c,l)?e.scrollLeft-=l.left-c.left+s:Jo(c,l)&&(e.scrollLeft+=c.right-l.right+s)),e=e.parentNode;}function Go(e,t){return e.bottom>t.bottom;}function Ko(e,t){return e.top<t.top;}function Zo(e,t){return e.left<t.left;}function Jo(e,t){return e.right>t.right;}function Qo(e){return Co(e)?e.startContainer.ownerDocument.defaultView:e.ownerDocument.defaultView;}function Yo(e){if(Co(e)){var _t13=e.commonAncestorContainer;return ko(_t13)&&(_t13=_t13.parentNode),_t13;}return e.parentNode;}function Xo(e,t){var i=Qo(e),n=new Eo(e);if(i===t)return n;{var _e24=i;for(;_e24!=t;){var _t14=_e24.frameElement,_i15=new Eo(_t14).excludeScrollbarsAndBorders();n.moveBy(_i15.left,_i15.top),_e24=_e24.parent;}}return n;}var er={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},tr={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},ir={37:"←",38:"↑",39:"→",40:"↓",9:"⇥",33:"Page Up",34:"Page Down"},nr=ur(),sr=Object.fromEntries(Object.entries(nr).map(function(_ref8){var _ref9=_slicedToArray(_ref8,2),e=_ref9[0],t=_ref9[1];var i;return i=t in ir?ir[t]:e.charAt(0).toUpperCase()+e.slice(1),[t,i];}));function or(e){var t;if("string"==typeof e){if(t=nr[e.toLowerCase()],!t)throw new A("keyboard-unknown-key",null,{key:e});}else t=e.keyCode+(e.altKey?nr.alt:0)+(e.ctrlKey?nr.ctrl:0)+(e.shiftKey?nr.shift:0)+(e.metaKey?nr.cmd:0);return t;}function rr(e){return"string"==typeof e&&(e=function(e){return e.split("+").map(function(e){return e.trim();});}(e)),e.map(function(e){return"string"==typeof e?function(e){if(e.endsWith("!"))return or(e.slice(0,-1));var t=or(e);return(o.isMac||o.isiOS)&&t==nr.ctrl?nr.cmd:t;}(e):e;}).reduce(function(e,t){return t+e;},0);}function ar(e){var t=rr(e);return Object.entries(o.isMac||o.isiOS?er:tr).reduce(function(e,_ref10){var _ref11=_slicedToArray(_ref10,2),i=_ref11[0],n=_ref11[1];return t&nr[i]&&(t&=~nr[i],e+=n),e;},"")+(t?sr[t]:"");}function lr(e){return e==nr.arrowright||e==nr.arrowleft||e==nr.arrowup||e==nr.arrowdown;}function cr(e,t){var i="ltr"===t;switch(e){case nr.arrowleft:return i?"left":"right";case nr.arrowright:return i?"right":"left";case nr.arrowup:return"up";case nr.arrowdown:return"down";}}function dr(e,t){var i=cr(e,t);return"down"===i||"right"===i;}function ur(){var e={pageup:33,pagedown:34,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,"delete":46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(var _t15=65;_t15<=90;_t15++){e[String.fromCharCode(_t15).toLowerCase()]=_t15;}for(var _t16=48;_t16<=57;_t16++)e[_t16-48]=_t16;for(var _t17=112;_t17<=123;_t17++)e["f"+(_t17-111)]=_t17;return Object.assign(e,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),e;}var hr=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig"];function mr(e){return hr.includes(e)?"rtl":"ltr";}function gr(e){return Array.isArray(e)?e:[e];}function fr(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;var s=arguments.length>3?arguments[3]:undefined;if("number"!=typeof n)throw new A("translation-service-quantity-not-a-number",null,{quantity:n});var o=s||i.window.CKEDITOR_TRANSLATIONS,r=function(e){return Object.keys(e).length;}(o);1===r&&(e=Object.keys(o)[0]);var a=t.id||t.string;if(0===r||!function(e,t,i){return!!i[e]&&!!i[e].dictionary[t];}(e,a,o))return 1!==n?t.plural:t.string;var l=o[e].dictionary,c=o[e].getPluralForm||function(e){return 1===e?0:1;},d=l[a];if("string"==typeof d)return d;return d[Number(c(n))];}i.window.CKEDITOR_TRANSLATIONS||(i.window.CKEDITOR_TRANSLATIONS={});var pr=/*#__PURE__*/function(){function pr(){var _this14=this;var _ref12=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref12$uiLanguage=_ref12.uiLanguage,e=_ref12$uiLanguage===void 0?"en":_ref12$uiLanguage,t=_ref12.contentLanguage,i=_ref12.translations;_classCallCheck(this,pr);_defineProperty(this,"uiLanguage",void 0);_defineProperty(this,"uiLanguageDirection",void 0);_defineProperty(this,"contentLanguage",void 0);_defineProperty(this,"contentLanguageDirection",void 0);_defineProperty(this,"t",void 0);_defineProperty(this,"translations",void 0);this.uiLanguage=e,this.contentLanguage=t||this.uiLanguage,this.uiLanguageDirection=mr(this.uiLanguage),this.contentLanguageDirection=mr(this.contentLanguage),this.translations=function(e){return Array.isArray(e)?e.reduce(function(e,t){return Fs(e,t);}):e;}(i),this.t=function(e,t){return _this14._t(e,t);};}return _createClass(pr,[{key:"language",get:function get(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage;}},{key:"_t",value:function _t(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];t=gr(t),"string"==typeof e&&(e={string:e});var i=!!e.plural?t[0]:1;return function(e,t){return e.replace(/%(\d+)/g,function(e,i){return i<t.length?t[i]:e;});}(fr(this.uiLanguage,e,i,this.translations),t);}}]);}();var br=/*#__PURE__*/function(_L3){function br(){var _this15;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,br);_this15=_callSuper(this,br);_defineProperty(_this15,"_items",void 0);_defineProperty(_this15,"_itemMap",void 0);_defineProperty(_this15,"_idProperty",void 0);_defineProperty(_this15,"_bindToCollection",void 0);_defineProperty(_this15,"_bindToExternalToInternalMap",void 0);_defineProperty(_this15,"_bindToInternalToExternalMap",void 0);_defineProperty(_this15,"_skippedIndexesFromExternal",void 0);var i=oo(e);if(i||(t=e),_this15._items=[],_this15._itemMap=new Map(),_this15._idProperty=t.idProperty||"id",_this15._bindToExternalToInternalMap=new WeakMap(),_this15._bindToInternalToExternalMap=new WeakMap(),_this15._skippedIndexesFromExternal=[],i){var _iterator18=_createForOfIteratorHelper(e),_step18;try{for(_iterator18.s();!(_step18=_iterator18.n()).done;){var _t18=_step18.value;_this15._items.push(_t18),_this15._itemMap.set(_this15._getItemIdBeforeAdding(_t18),_t18);}}catch(err){_iterator18.e(err);}finally{_iterator18.f();}}return _this15;}_inherits(br,_L3);return _createClass(br,[{key:"length",get:function get(){return this._items.length;}},{key:"first",get:function get(){return this._items[0]||null;}},{key:"last",get:function get(){return this._items[this.length-1]||null;}},{key:"add",value:function add(e,t){return this.addMany([e],t);}},{key:"addMany",value:function addMany(e,t){if(void 0===t)t=this._items.length;else if(t>this._items.length||t<0)throw new A("collection-add-item-invalid-index",this);var i=0;var _iterator19=_createForOfIteratorHelper(e),_step19;try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var _n10=_step19.value;var _e25=this._getItemIdBeforeAdding(_n10),_s9=t+i;this._items.splice(_s9,0,_n10),this._itemMap.set(_e25,_n10),this.fire("add",_n10,_s9),i++;}}catch(err){_iterator19.e(err);}finally{_iterator19.f();}return this.fire("change",{added:e,removed:[],index:t}),this;}},{key:"get",value:function get(e){var t;if("string"==typeof e)t=this._itemMap.get(e);else{if("number"!=typeof e)throw new A("collection-get-invalid-arg",this);t=this._items[e];}return t||null;}},{key:"has",value:function has(e){if("string"==typeof e)return this._itemMap.has(e);{var _t19=e[this._idProperty];return _t19&&this._itemMap.has(_t19);}}},{key:"getIndex",value:function getIndex(e){var t;return t="string"==typeof e?this._itemMap.get(e):e,t?this._items.indexOf(t):-1;}},{key:"remove",value:function remove(e){var _this$_remove=this._remove(e),_this$_remove2=_slicedToArray(_this$_remove,2),t=_this$_remove2[0],i=_this$_remove2[1];return this.fire("change",{added:[],removed:[t],index:i}),t;}},{key:"map",value:function map(e,t){return this._items.map(e,t);}},{key:"forEach",value:function forEach(e,t){this._items.forEach(e,t);}},{key:"find",value:function find(e,t){return this._items.find(e,t);}},{key:"filter",value:function filter(e,t){return this._items.filter(e,t);}},{key:"clear",value:function clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);var e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0});}},{key:"bindTo",value:function bindTo(e){var _this16=this;if(this._bindToCollection)throw new A("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:function as(e){_this16._setUpBindToBinding(function(t){return new e(t);});},using:function using(e){"function"==typeof e?_this16._setUpBindToBinding(e):_this16._setUpBindToBinding(function(t){return t[e];});}};}},{key:"_setUpBindToBinding",value:function _setUpBindToBinding(e){var _this17=this;var t=this._bindToCollection,i=function i(_i17,n,s){var o=t._bindToCollection==_this17,r=t._bindToInternalToExternalMap.get(n);if(o&&r)_this17._bindToExternalToInternalMap.set(n,r),_this17._bindToInternalToExternalMap.set(r,n);else{var _i16=e(n);if(!_i16)return void _this17._skippedIndexesFromExternal.push(s);var _o4=s;var _iterator20=_createForOfIteratorHelper(_this17._skippedIndexesFromExternal),_step20;try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var _e27=_step20.value;s>_e27&&_o4--;}}catch(err){_iterator20.e(err);}finally{_iterator20.f();}var _iterator21=_createForOfIteratorHelper(t._skippedIndexesFromExternal),_step21;try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var _e28=_step21.value;_o4>=_e28&&_o4++;}}catch(err){_iterator21.e(err);}finally{_iterator21.f();}_this17._bindToExternalToInternalMap.set(n,_i16),_this17._bindToInternalToExternalMap.set(_i16,n),_this17.add(_i16,_o4);for(var _e26=0;_e26<t._skippedIndexesFromExternal.length;_e26++)_o4<=t._skippedIndexesFromExternal[_e26]&&t._skippedIndexesFromExternal[_e26]++;}};var _iterator22=_createForOfIteratorHelper(t),_step22;try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var _e29=_step22.value;i(0,_e29,t.getIndex(_e29));}}catch(err){_iterator22.e(err);}finally{_iterator22.f();}this.listenTo(t,"add",i),this.listenTo(t,"remove",function(e,t,i){var n=_this17._bindToExternalToInternalMap.get(t);n&&_this17.remove(n),_this17._skippedIndexesFromExternal=_this17._skippedIndexesFromExternal.reduce(function(e,t){return i<t&&e.push(t-1),i>t&&e.push(t),e;},[]);});}},{key:"_getItemIdBeforeAdding",value:function _getItemIdBeforeAdding(e){var t=this._idProperty;var i;if(t in e){if(i=e[t],"string"!=typeof i)throw new A("collection-add-invalid-id",this);if(this.get(i))throw new A("collection-add-item-already-exists",this);}else e[t]=i=k();return i;}},{key:"_remove",value:function _remove(e){var t,i,n,s=!1;var o=this._idProperty;if("string"==typeof e?(i=e,n=this._itemMap.get(i),s=!n,n&&(t=this._items.indexOf(n))):"number"==typeof e?(t=e,n=this._items[t],s=!n,n&&(i=n[o])):(n=e,i=n[o],t=this._items.indexOf(n),s=-1==t||!this._itemMap.get(i)),s)throw new A("collection-remove-404",this);this._items.splice(t,1),this._itemMap["delete"](i);var r=this._bindToInternalToExternalMap.get(n);return this._bindToInternalToExternalMap["delete"](n),this._bindToExternalToInternalMap["delete"](r),this.fire("remove",n,t),[n,t];}},{key:Symbol.iterator,value:function value(){return this._items[Symbol.iterator]();}}]);}(L());function wr(e){var t=e.next();return t.done?null:t.value;}var _r=/*#__PURE__*/function(_go){function _r(){var _this18;_classCallCheck(this,_r);_this18=_callSuper(this,_r),_defineProperty(_assertThisInitialized(_this18),"_elements",new Set()),_defineProperty(_assertThisInitialized(_this18),"_externalViews",new Set()),_defineProperty(_assertThisInitialized(_this18),"_blurTimeout",null),_this18.set("isFocused",!1),_this18.set("focusedElement",null);return _this18;}_inherits(_r,_go);return _createClass(_r,[{key:"elements",get:function get(){return Array.from(this._elements.values());}},{key:"externalViews",get:function get(){return Array.from(this._externalViews.values());}},{key:"add",value:function add(e){if(yr(e))this._addElement(e);else if(vr(e))this._addView(e);else{if(!e.element)throw new A("focustracker-add-view-missing-element",{focusTracker:this,view:e});this._addElement(e.element);}}},{key:"remove",value:function remove(e){yr(e)?this._removeElement(e):vr(e)?this._removeView(e):this._removeElement(e.element);}},{key:"_addElement",value:function _addElement(e){var _this19=this;if(this._elements.has(e))throw new A("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",function(){var t=_this19.externalViews.find(function(t){return function(e,t){if(kr(e,t))return!0;return!!t.focusTracker.externalViews.find(function(t){return kr(e,t);});}(e,t);});t?_this19._focus(t.element):_this19._focus(e);},{useCapture:!0}),this.listenTo(e,"blur",function(){_this19._blur();},{useCapture:!0}),this._elements.add(e);}},{key:"_removeElement",value:function _removeElement(e){this._elements.has(e)&&(this.stopListening(e),this._elements["delete"](e)),e===this.focusedElement&&this._blur();}},{key:"_addView",value:function _addView(e){var _this20=this;e.element&&this._addElement(e.element),this.listenTo(e.focusTracker,"change:focusedElement",function(){e.focusTracker.focusedElement?e.element&&_this20._focus(e.element):_this20._blur();}),this._externalViews.add(e);}},{key:"_removeView",value:function _removeView(e){e.element&&this._removeElement(e.element),this.stopListening(e.focusTracker),this._externalViews["delete"](e);}},{key:"destroy",value:function destroy(){this.stopListening(),this._elements.clear(),this._externalViews.clear(),this.isFocused=!1,this.focusedElement=null;}},{key:"_focus",value:function _focus(e){this._clearBlurTimeout(),this.focusedElement=e,this.isFocused=!0;}},{key:"_blur",value:function _blur(){var _this21=this;if(this.elements.find(function(e){return e.contains(document.activeElement);}))return;this.externalViews.find(function(e){return e.focusTracker.isFocused&&!e.focusTracker._blurTimeout;})||(this._clearBlurTimeout(),this._blurTimeout=setTimeout(function(){_this21.focusedElement=null,_this21.isFocused=!1;},0));}},{key:"_clearBlurTimeout",value:function _clearBlurTimeout(){clearTimeout(this._blurTimeout),this._blurTimeout=null;}}]);}(go(Zs()));function vr(e){return"focusTracker"in e&&e.focusTracker instanceof _r;}function yr(e){return Ms(e);}function kr(e,t){return!!t.element&&t.element.contains(document.activeElement)&&e.contains(t.element);}var Cr=/*#__PURE__*/function(){function Cr(){_classCallCheck(this,Cr);_defineProperty(this,"_listener",void 0);this._listener=new(go())();}return _createClass(Cr,[{key:"listenTo",value:function listenTo(e){var _this22=this;this._listener.listenTo(e,"keydown",function(e,t){_this22._listener.fire("_keydown:"+or(t),t);});}},{key:"set",value:function set(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=rr(e),s=i.priority;this._listener.listenTo(this._listener,"_keydown:"+n,function(e,n){i.filter&&!i.filter(n)||(t(n,function(){n.preventDefault(),n.stopPropagation(),e.stop();}),e["return"]=!0);},{priority:s});}},{key:"press",value:function press(e){return!!this._listener.fire("_keydown:"+or(e),e);}},{key:"stopListening",value:function stopListening(e){this._listener.stopListening(e);}},{key:"destroy",value:function destroy(){this.stopListening();}}]);}();function xr(e){return oo(e)?new Map(e):function(e){var t=new Map();for(var _i18 in e)t.set(_i18,e[_i18]);return t;}(e);}function Ar(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(i,n){var s=t.signal||new AbortController().signal;s.throwIfAborted();var o=setTimeout(function(){s.removeEventListener("abort",r),i();},e);function r(){clearTimeout(o),n(s.reason);}s.addEventListener("abort",r,{once:!0});});}function Er(_x2){return _Er.apply(this,arguments);}function _Er(){_Er=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee24(e){var t,_t$maxAttempts,i,_t$retryDelay,n,_t$signal,s,_t588,_args64=arguments;return _regeneratorRuntime().wrap(function _callee24$(_context64){while(1)switch(_context64.prev=_context64.next){case 0:t=_args64.length>1&&_args64[1]!==undefined?_args64[1]:{};_t$maxAttempts=t.maxAttempts,i=_t$maxAttempts===void 0?4:_t$maxAttempts,_t$retryDelay=t.retryDelay,n=_t$retryDelay===void 0?Tr():_t$retryDelay,_t$signal=t.signal,s=_t$signal===void 0?new AbortController().signal:_t$signal;s.throwIfAborted();_t588=0;case 4:_context64.prev=4;_context64.next=7;return e();case 7:return _context64.abrupt("return",_context64.sent);case 10:_context64.prev=10;_context64.t0=_context64["catch"](4);if(!(_t588+1>=i)){_context64.next=14;break;}throw _context64.t0;case 14:_context64.next=16;return Ar(n(_t588),{signal:s});case 16:_t588++;_context64.next=4;break;case 19:case"end":return _context64.stop();}},_callee24,null,[[4,10]]);}));return _Er.apply(this,arguments);}function Tr(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _e$delay=e.delay,t=_e$delay===void 0?1e3:_e$delay,_e$factor=e.factor,i=_e$factor===void 0?2:_e$factor,_e$maxDelay=e.maxDelay,n=_e$maxDelay===void 0?1e4:_e$maxDelay;return function(e){return Math.min(Math.pow(i,e)*t,n);};}function Pr(e,t,i,n){if(Math.max(t.length,e.length)>1e4)return e.slice(0,i).concat(t).concat(e.slice(i+n,e.length));{var _s10=Array.from(e);return _s10.splice.apply(_s10,[i,n].concat(_toConsumableArray(t))),_s10;}}function Sr(e,t){var i;function n(){for(var _len11=arguments.length,s=new Array(_len11),_key11=0;_key11<_len11;_key11++){s[_key11]=arguments[_key11];}n.cancel(),i=setTimeout(function(){return e.apply(void 0,s);},t);}return n.cancel=function(){clearTimeout(i);},n;}function Ir(e){function t(e){return e.length>=40&&e.length<=255?"VALID":"INVALID";}if(!e)return"INVALID";var i="";try{i=atob(e);}catch(e){return"INVALID";}var n=i.split("-"),s=n[0],o=n[1];if(!o)return t(e);try{atob(o);}catch(i){try{if(atob(s),!atob(s).length)return t(e);}catch(i){return t(e);}}if(s.length<40||s.length>255)return"INVALID";var r="";try{atob(s),r=atob(o);}catch(e){return"INVALID";}if(8!==r.length)return"INVALID";var a=Number(r.substring(0,4)),l=Number(r.substring(4,6))-1,c=Number(r.substring(6,8)),d=new Date(a,l,c);return d<V||isNaN(Number(d))?"INVALID":"VALID";}function Vr(e){return!!e&&1==e.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(e);}function Rr(e){return!!e&&1==e.length&&/[\ud800-\udbff]/.test(e);}function Or(e){return!!e&&1==e.length&&/[\udc00-\udfff]/.test(e);}function Br(e,t){return Rr(e.charAt(t-1))&&Or(e.charAt(t));}function Mr(e,t){return Vr(e.charAt(t));}var Lr=Nr();function Fr(e,t){var i=String(e).matchAll(Lr);return Array.from(i).some(function(e){return e.index<t&&t<e.index+e[0].length;});}function Nr(){var e=/(?:\uD83C[\uDDE6-\uDDFF]){2}/.source,t="(?:"+[/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])(?:\uDB40[\uDC20-\uDC7E])+(?:\uDB40\uDC7F)/,/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])\uFE0F?\u20E3/,/(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])\uFE0F/,/(?=(?:[\xA6\xA9\xAE\xB0\u0482\u058D\u058E\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u09FA\u0B70\u0BF3-\u0BF8\u0BFA\u0C7F\u0D4F\u0D79\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116\u2117\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u214A\u214C\u214D\u214F\u218A\u218B\u2195-\u2199\u219C-\u219F\u21A1\u21A2\u21A4\u21A5\u21A7-\u21AD\u21AF-\u21CD\u21D0\u21D1\u21D3\u21D5-\u21F3\u2300-\u2307\u230C-\u231F\u2322-\u2328\u232B-\u237B\u237D-\u239A\u23B4-\u23DB\u23E2-\u2429\u2440-\u244A\u249C-\u24E9\u2500-\u25B6\u25B8-\u25C0\u25C2-\u25F7\u2600-\u266E\u2670-\u2767\u2794-\u27BF\u2800-\u28FF\u2B00-\u2B2F\u2B45\u2B46\u2B4D-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u3190\u3191\u3196-\u319F\u31C0-\u31E5\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA828-\uA82B\uA836\uA837\uA839\uAA77-\uAA79\uFD40-\uFD4F\uFDCF\uFDFD-\uFDFF\uFFE4\uFFE8\uFFED\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFDC\uDFE1-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDC00-\uDCEF\uDD00-\uDEB3\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838\uDD4F|\uD83B[\uDCAC\uDD2E]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFA]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0-\uDCBB\uDCC0\uDCC1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFEF]))(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEDC-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDDFF\uDE70-\uDE7C\uDE80-\uDE89\uDE8F-\uDEC6\uDECE-\uDEDC\uDEDF-\uDEE9\uDEF0-\uDEF8])(?:\uD83C[\uDFFB-\uDFFF])*/].map(function(e){return e.source;}).join("|")+")";return new RegExp("".concat(e,"|").concat(t,"(?:\u200D").concat(t,")*"),"ug");}var Dr=/*#__PURE__*/function(_Zs){function Dr(e){var _this23;_classCallCheck(this,Dr);_this23=_callSuper(this,Dr),_defineProperty(_assertThisInitialized(_this23),"editor",void 0),_defineProperty(_assertThisInitialized(_this23),"_disableStack",new Set()),_this23.editor=e,_this23.set("isEnabled",!0);return _this23;}_inherits(Dr,_Zs);return _createClass(Dr,[{key:"forceDisabled",value:function forceDisabled(e){this._disableStack.add(e),1==this._disableStack.size&&(this.on("set:isEnabled",zr,{priority:"highest"}),this.isEnabled=!1);}},{key:"clearForceDisabled",value:function clearForceDisabled(e){this._disableStack["delete"](e),0==this._disableStack.size&&(this.off("set:isEnabled",zr),this.isEnabled=!0);}},{key:"destroy",value:function destroy(){this.stopListening();}}],[{key:"isContextPlugin",get:function get(){return!1;}},{key:"isOfficialPlugin",get:function get(){return!1;}},{key:"isPremiumPlugin",get:function get(){return!1;}}]);}(Zs());function zr(e){e["return"]=!1,e.stop();}var Hr=/*#__PURE__*/function(_Zs2){function Hr(e){var _this24;_classCallCheck(this,Hr);_this24=_callSuper(this,Hr),_defineProperty(_assertThisInitialized(_this24),"editor",void 0),_defineProperty(_assertThisInitialized(_this24),"_isEnabledBasedOnSelection",void 0),_defineProperty(_assertThisInitialized(_this24),"_affectsData",void 0),_defineProperty(_assertThisInitialized(_this24),"_disableStack",void 0),_this24.editor=e,_this24.set("value",void 0),_this24.set("isEnabled",!1),_this24._affectsData=!0,_this24._isEnabledBasedOnSelection=!0,_this24._disableStack=new Set(),_this24.decorate("execute"),_this24.listenTo(_this24.editor.model.document,"change",function(){_this24.refresh();}),_this24.listenTo(e,"change:isReadOnly",function(){_this24.refresh();}),_this24.on("set:isEnabled",function(t){if(!_this24.affectsData)return;var i=e.model.document.selection,n=!("$graveyard"==i.getFirstPosition().root.rootName)&&e.model.canEditAt(i);(e.isReadOnly||_this24._isEnabledBasedOnSelection&&!n)&&(t["return"]=!1,t.stop());},{priority:"highest"}),_this24.on("execute",function(e){_this24.isEnabled||e.stop();},{priority:"high"});return _this24;}_inherits(Hr,_Zs2);return _createClass(Hr,[{key:"affectsData",get:function get(){return this._affectsData;},set:function set(e){this._affectsData=e;}},{key:"refresh",value:function refresh(){this.isEnabled=!0;}},{key:"forceDisabled",value:function forceDisabled(e){this._disableStack.add(e),1==this._disableStack.size&&(this.on("set:isEnabled",$r,{priority:"highest"}),this.isEnabled=!1);}},{key:"clearForceDisabled",value:function clearForceDisabled(e){this._disableStack["delete"](e),0==this._disableStack.size&&(this.off("set:isEnabled",$r),this.refresh());}},{key:"execute",value:function execute(){}},{key:"destroy",value:function destroy(){this.stopListening();}}]);}(Zs());function $r(e){e["return"]=!1,e.stop();}var Ur=/*#__PURE__*/function(_Hr2){function Ur(){var _this25;_classCallCheck(this,Ur);for(var _len12=arguments.length,args=new Array(_len12),_key12=0;_key12<_len12;_key12++){args[_key12]=arguments[_key12];}_this25=_callSuper(this,Ur,[].concat(args));_defineProperty(_this25,"_childCommandsDefinitions",[]);return _this25;}_inherits(Ur,_Hr2);return _createClass(Ur,[{key:"refresh",value:function refresh(){}},{key:"execute",value:function execute(){var t=this._getFirstEnabledCommand();for(var _len13=arguments.length,e=new Array(_len13),_key13=0;_key13<_len13;_key13++){e[_key13]=arguments[_key13];}return!!t&&t.execute(e);}},{key:"registerChildCommand",value:function registerChildCommand(e){var _this26=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};x(this._childCommandsDefinitions,{command:e,priority:t.priority||"normal"}),e.on("change:isEnabled",function(){return _this26._checkEnabled();}),this._checkEnabled();}},{key:"_checkEnabled",value:function _checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand();}},{key:"_getFirstEnabledCommand",value:function _getFirstEnabledCommand(){var e=this._childCommandsDefinitions.find(function(_ref13){var e=_ref13.command;return e.isEnabled;});return e&&e.command;}}]);}(Hr);var Wr=/*#__PURE__*/function(_L4){function Wr(e){var _this27;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];_classCallCheck(this,Wr);_this27=_callSuper(this,Wr),_defineProperty(_assertThisInitialized(_this27),"_context",void 0),_defineProperty(_assertThisInitialized(_this27),"_plugins",new Map()),_defineProperty(_assertThisInitialized(_this27),"_availablePlugins",void 0),_defineProperty(_assertThisInitialized(_this27),"_contextPlugins",void 0),_this27._context=e,_this27._availablePlugins=new Map();var _iterator23=_createForOfIteratorHelper(t),_step23;try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var _e30=_step23.value;_e30.pluginName&&_this27._availablePlugins.set(_e30.pluginName,_e30);}}catch(err){_iterator23.e(err);}finally{_iterator23.f();}_this27._contextPlugins=new Map();var _iterator24=_createForOfIteratorHelper(i),_step24;try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var _step24$value=_slicedToArray(_step24.value,2),_e31=_step24$value[0],_t20=_step24$value[1];_this27._contextPlugins.set(_e31,_t20),_this27._contextPlugins.set(_t20,_e31),_e31.pluginName&&_this27._availablePlugins.set(_e31.pluginName,_e31);}}catch(err){_iterator24.e(err);}finally{_iterator24.f();}return _this27;}_inherits(Wr,_L4);return _createClass(Wr,[{key:Symbol.iterator,value:/*#__PURE__*/_regeneratorRuntime().mark(function value(){var _iterator25,_step25,_e32;return _regeneratorRuntime().wrap(function value$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_iterator25=_createForOfIteratorHelper(this._plugins);_context2.prev=1;_iterator25.s();case 3:if((_step25=_iterator25.n()).done){_context2.next=11;break;}_e32=_step25.value;_context2.t0="function"==typeof _e32[0];if(!_context2.t0){_context2.next=9;break;}_context2.next=9;return _e32;case 9:_context2.next=3;break;case 11:_context2.next=16;break;case 13:_context2.prev=13;_context2.t1=_context2["catch"](1);_iterator25.e(_context2.t1);case 16:_context2.prev=16;_iterator25.f();return _context2.finish(16);case 19:case"end":return _context2.stop();}},value,this,[[1,13,16,19]]);})},{key:"get",value:function get(e){var t=this._plugins.get(e);if(!t){var _t21=e;throw"function"==typeof e&&(_t21=e.pluginName||e.name),new A("plugincollection-plugin-not-loaded",this._context,{plugin:_t21});}return t;}},{key:"has",value:function has(e){return this._plugins.has(e);}},{key:"init",value:function init(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var n=this,s=this._context;!function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Set();t.forEach(function(t){a(t)&&(i.has(t)||(i.add(t),t.pluginName&&!n._availablePlugins.has(t.pluginName)&&n._availablePlugins.set(t.pluginName,t),t.requires&&e(t.requires,i)));});}(e),u(e);var o=_toConsumableArray(function e(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Set();return t.map(function(e){return a(e)?e:n._availablePlugins.get(e);}).reduce(function(t,n){return i.has(n)?t:(i.add(n),n.requires&&(u(n.requires,n),e(n.requires,i).forEach(function(e){return t.add(e);})),t.add(n));},new Set());}(e.filter(function(e){return!c(e,t);})));!function(e,t){var _iterator26=_createForOfIteratorHelper(t),_step26;try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var _i19=_step26.value;if("function"!=typeof _i19)throw new A("plugincollection-replace-plugin-invalid-type",null,{pluginItem:_i19});var _t22=_i19.pluginName;if(!_t22)throw new A("plugincollection-replace-plugin-missing-name",null,{pluginItem:_i19});if(_i19.requires&&_i19.requires.length)throw new A("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:_t22});var _s11=n._availablePlugins.get(_t22);if(!_s11)throw new A("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:_t22});var _o5=e.indexOf(_s11);if(-1===_o5){if(n._contextPlugins.has(_s11))return;throw new A("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:_t22});}if(_s11.requires&&_s11.requires.length)throw new A("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:_t22});e.splice(_o5,1,_i19),n._availablePlugins.set(_t22,_i19);}}catch(err){_iterator26.e(err);}finally{_iterator26.f();}}(o,i);var r=function(e){return e.map(function(e){var t=n._contextPlugins.get(e);return t=t||new e(s),n._add(e,t),t;});}(o);return h(r,"init").then(function(){return h(r,"afterInit");}).then(function(){return r;});function a(e){return"function"==typeof e;}function l(e){return a(e)&&!!e.isContextPlugin;}function c(e,t){return t.some(function(t){return t===e||d(e)===t||d(t)===e;});}function d(e){return a(e)?e.pluginName||e.name:e;}function u(e){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;e.map(function(e){return a(e)?e:n._availablePlugins.get(e)||e;}).forEach(function(e){!function(e,t){if(a(e))return;if(t)throw new A("plugincollection-soft-required",s,{missingPlugin:e,requiredBy:d(t)});throw new A("plugincollection-plugin-not-found",s,{plugin:e});}(e,i),function(e,t){if(!l(t))return;if(l(e))return;throw new A("plugincollection-context-required",s,{plugin:d(e),requiredBy:d(t)});}(e,i),function(e,i){if(!i)return;if(!c(e,t))return;throw new A("plugincollection-required",s,{plugin:d(e),requiredBy:d(i)});}(e,i);});}function h(e,t){return e.reduce(function(e,i){return i[t]?n._contextPlugins.has(i)?e:e.then(i[t].bind(i)):e;},Promise.resolve());}}},{key:"destroy",value:function destroy(){var e=[];var _iterator27=_createForOfIteratorHelper(this),_step27;try{for(_iterator27.s();!(_step27=_iterator27.n()).done;){var _step27$value=_slicedToArray(_step27.value,2),_t23=_step27$value[1];"function"!=typeof _t23.destroy||this._contextPlugins.has(_t23)||e.push(_t23.destroy());}}catch(err){_iterator27.e(err);}finally{_iterator27.f();}return Promise.all(e);}},{key:"_add",value:function _add(e,t){this._plugins.set(e,t);var i=e.pluginName;if(i){if(this._plugins.has(i))throw new A("plugincollection-plugin-name-conflict",null,{pluginName:i,plugin1:this._plugins.get(i).constructor,plugin2:e});this._plugins.set(i,t);}}}]);}(L());var jr=/*#__PURE__*/function(){function jr(e){_classCallCheck(this,jr);_defineProperty(this,"config",void 0);_defineProperty(this,"plugins",void 0);_defineProperty(this,"locale",void 0);_defineProperty(this,"t",void 0);_defineProperty(this,"editors",void 0);_defineProperty(this,"_contextOwner",null);var _ref14=e||{},t=_ref14.translations,i=_objectWithoutProperties(_ref14,_excluded);this.config=new ao(i,this.constructor.defaultConfig);var n=this.constructor.builtinPlugins;this.config.define("plugins",n),this.plugins=new Wr(this,n);var s=this.config.get("language")||{};this.locale=new pr({uiLanguage:"string"==typeof s?s:s.ui,contentLanguage:this.config.get("language.content"),translations:t}),this.t=this.locale.t,this.editors=new br();}return _createClass(jr,[{key:"initPlugins",value:function initPlugins(){var e=this.config.get("plugins")||[],t=this.config.get("substitutePlugins")||[];var _iterator28=_createForOfIteratorHelper(e.concat(t)),_step28;try{for(_iterator28.s();!(_step28=_iterator28.n()).done;){var _i20=_step28.value;if("function"!=typeof _i20)throw new A("context-initplugins-constructor-only",null,{Plugin:_i20});if(!0!==_i20.isContextPlugin)throw new A("context-initplugins-invalid-plugin",null,{Plugin:_i20});}}catch(err){_iterator28.e(err);}finally{_iterator28.f();}return this.plugins.init(e,[],t);}},{key:"destroy",value:function destroy(){var _this28=this;return Promise.all(Array.from(this.editors,function(e){return e.destroy();})).then(function(){return _this28.plugins.destroy();});}},{key:"_addEditor",value:function _addEditor(e,t){if(this._contextOwner)throw new A("context-addeditor-private-context");this.editors.add(e),t&&(this._contextOwner=e);}},{key:"_removeEditor",value:function _removeEditor(e){return this.editors.has(e)&&this.editors.remove(e),this._contextOwner===e?this.destroy():Promise.resolve();}},{key:"_getEditorConfig",value:function _getEditorConfig(){var e={};var _iterator29=_createForOfIteratorHelper(this.config.names()),_step29;try{for(_iterator29.s();!(_step29=_iterator29.n()).done;){var _t24=_step29.value;["plugins","removePlugins","extraPlugins"].includes(_t24)||(e[_t24]=this.config.get(_t24));}}catch(err){_iterator29.e(err);}finally{_iterator29.f();}return e;}}],[{key:"create",value:function create(e){var _this29=this;return new Promise(function(t){var i=new _this29(e);t(i.initPlugins().then(function(){return i;}));});}}]);}();_defineProperty(jr,"defaultConfig",void 0);_defineProperty(jr,"builtinPlugins",void 0);var qr=/*#__PURE__*/function(_Zs3){function qr(e){var _this30;_classCallCheck(this,qr);_this30=_callSuper(this,qr),_defineProperty(_assertThisInitialized(_this30),"context",void 0),_this30.context=e;return _this30;}_inherits(qr,_Zs3);return _createClass(qr,[{key:"destroy",value:function destroy(){this.stopListening();}}],[{key:"isContextPlugin",get:function get(){return!0;}},{key:"isOfficialPlugin",get:function get(){return!1;}},{key:"isPremiumPlugin",get:function get(){return!1;}}]);}(Zs());var Gr=new WeakMap();var Kr=!1;function Zr(_ref15){var e=_ref15.view,t=_ref15.element,i=_ref15.text,_ref15$isDirectHost=_ref15.isDirectHost,n=_ref15$isDirectHost===void 0?!0:_ref15$isDirectHost,_ref15$keepOnFocus=_ref15.keepOnFocus,s=_ref15$keepOnFocus===void 0?!1:_ref15$keepOnFocus;var o=e.document;function r(i){Gr.get(o).set(t,{text:i,isDirectHost:n,keepOnFocus:s,hostElement:n?t:null}),e.change(function(e){return ea(o,e);});}Gr.has(o)||(Gr.set(o,new Map()),o.registerPostFixer(function(e){return ea(o,e);}),o.on("change:isComposing",function(){e.change(function(e){return ea(o,e);});},{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",function(e,t,i){r(i);}),t.placeholder?r(t.placeholder):i&&r(i),i&&function(){Kr||E("enableplaceholder-deprecated-text-option");Kr=!0;}();}function Jr(e,t){var i=t.document;Gr.has(i)&&e.change(function(e){var n=Gr.get(i),s=n.get(t);e.removeAttribute("data-placeholder",s.hostElement),Yr(e,s.hostElement),n["delete"](t);});}function Qr(e,t){return!t.hasClass("ck-placeholder")&&(e.addClass("ck-placeholder",t),!0);}function Yr(e,t){return!!t.hasClass("ck-placeholder")&&(e.removeClass("ck-placeholder",t),!0);}function Xr(e,t){if(!e.isAttached())return!1;var i=Array.from(e.getChildren()).some(function(e){return!e.is("uiElement");});if(i)return!1;var n=e.document,s=n.selection.anchor;return(!n.isComposing||!s||s.parent!==e)&&(!!t||!n.isFocused||!!s&&s.parent!==e);}function ea(e,t){var i=Gr.get(e),n=[];var s=!1;var _iterator30=_createForOfIteratorHelper(i),_step30;try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var _step30$value=_slicedToArray(_step30.value,2),_e33=_step30$value[0],_o6=_step30$value[1];_o6.isDirectHost&&(n.push(_e33),ta(t,_e33,_o6)&&(s=!0));}}catch(err){_iterator30.e(err);}finally{_iterator30.f();}var _iterator31=_createForOfIteratorHelper(i),_step31;try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var _step31$value=_slicedToArray(_step31.value,2),_e34=_step31$value[0],_o7=_step31$value[1];if(_o7.isDirectHost)continue;var _i21=ia(_e34);_i21&&(n.includes(_i21)||(_o7.hostElement=_i21,ta(t,_e34,_o7)&&(s=!0)));}}catch(err){_iterator31.e(err);}finally{_iterator31.f();}return s;}function ta(e,t,i){var n=i.text,s=i.isDirectHost,o=i.hostElement;var r=!1;o.getAttribute("data-placeholder")!==n&&(e.setAttribute("data-placeholder",n,o),r=!0);return(s||1==t.childCount)&&Xr(o,i.keepOnFocus)?Qr(e,o)&&(r=!0):Yr(e,o)&&(r=!0),r;}function ia(e){if(e.childCount){var _t25=e.getChild(0);if(_t25.is("element")&&!_t25.is("uiElement")&&!_t25.is("attributeElement"))return _t25;}return null;}var na=/*#__PURE__*/function(){function na(){_classCallCheck(this,na);}return _createClass(na,[{key:"is",value:function is(){throw new Error("is() method is abstract");}}]);}(),sa=/*#__PURE__*/function(_L5){function sa(e){var _this31;_classCallCheck(this,sa);_this31=_callSuper(this,sa),_defineProperty(_assertThisInitialized(_this31),"document",void 0),_defineProperty(_assertThisInitialized(_this31),"parent",void 0),_this31.document=e,_this31.parent=null;return _this31;}_inherits(sa,_L5);return _createClass(sa,[{key:"index",get:function get(){var e;if(!this.parent)return null;if(-1==(e=this.parent.getChildIndex(this)))throw new A("view-node-not-found-in-parent",this);return e;}},{key:"nextSibling",get:function get(){var e=this.index;return null!==e&&this.parent.getChild(e+1)||null;}},{key:"previousSibling",get:function get(){var e=this.index;return null!==e&&this.parent.getChild(e-1)||null;}},{key:"root",get:function get(){var e=this;for(;e.parent;)e=e.parent;return e;}},{key:"isAttached",value:function isAttached(){return this.root.is("rootElement");}},{key:"getPath",value:function getPath(){var e=[];var t=this;for(;t.parent;)e.unshift(t.index),t=t.parent;return e;}},{key:"getAncestors",value:function getAncestors(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=[];var i=e.includeSelf?this:this.parent;for(;i;)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t;}},{key:"getCommonAncestor",value:function getCommonAncestor(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.getAncestors(t),n=e.getAncestors(t);var s=0;for(;i[s]==n[s]&&i[s];)s++;return 0===s?null:i[s-1];}},{key:"isBefore",value:function isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;var t=this.getPath(),i=e.getPath(),n=so(t,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<i[n];}}},{key:"isAfter",value:function isAfter(e){return this!=e&&this.root===e.root&&!this.isBefore(e);}},{key:"_remove",value:function _remove(){this.parent._removeChildren(this.index);}},{key:"_fireChange",value:function _fireChange(e,t){this.fire("change:".concat(e),t),this.parent&&this.parent._fireChange(e,t);}},{key:"toJSON",value:function toJSON(){var e=$n(this);return delete e.parent,e;}}]);}(L(na));sa.prototype.is=function(e){return"node"===e||"view:node"===e;};var oa=/*#__PURE__*/function(_sa){function e(_e36,t){var _this32;_classCallCheck(this,e);_this32=_callSuper(this,e,[_e36]),_defineProperty(_assertThisInitialized(_this32),"_textData",void 0),_this32._textData=t;return _this32;}_inherits(e,_sa);return _createClass(e,[{key:"data",get:function get(){return this._textData;}},{key:"_data",get:function get(){return this.data;},set:function set(_e37){this._fireChange("text",this),this._textData=_e37;}},{key:"isSimilar",value:function isSimilar(t){return t instanceof e&&(this===t||this.data===t.data);}},{key:"_clone",value:function _clone(){return new e(this.document,this.data);}}]);}(sa);oa.prototype.is=function(e){return"$text"===e||"view:$text"===e||"text"===e||"view:text"===e||"node"===e||"view:node"===e;};var ra=/*#__PURE__*/function(_na){function ra(e,t,i){var _this33;_classCallCheck(this,ra);if(_this33=_callSuper(this,ra),_defineProperty(_assertThisInitialized(_this33),"textNode",void 0),_defineProperty(_assertThisInitialized(_this33),"data",void 0),_defineProperty(_assertThisInitialized(_this33),"offsetInText",void 0),_this33.textNode=e,t<0||t>e.data.length)throw new A("view-textproxy-wrong-offsetintext",_assertThisInitialized(_this33));if(i<0||t+i>e.data.length)throw new A("view-textproxy-wrong-length",_this33);_this33.data=e.data.substring(t,t+i),_this33.offsetInText=t;return _this33;}_inherits(ra,_na);return _createClass(ra,[{key:"offsetSize",get:function get(){return this.data.length;}},{key:"isPartial",get:function get(){return this.data.length!==this.textNode.data.length;}},{key:"parent",get:function get(){return this.textNode.parent;}},{key:"root",get:function get(){return this.textNode.root;}},{key:"document",get:function get(){return this.textNode.document;}},{key:"getAncestors",value:function getAncestors(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=[];var i=e.includeSelf?this.textNode:this.parent;for(;null!==i;)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t;}}]);}(na);ra.prototype.is=function(e){return"$textProxy"===e||"view:$textProxy"===e||"textProxy"===e||"view:textProxy"===e;};var aa=/*#__PURE__*/function(){function aa(){_classCallCheck(this,aa);_defineProperty(this,"_patterns",[]);this.add.apply(this,arguments);}return _createClass(aa,[{key:"add",value:function add(){for(var _len14=arguments.length,e=new Array(_len14),_key14=0;_key14<_len14;_key14++){e[_key14]=arguments[_key14];}for(var _i22=0,_e38=e;_i22<_e38.length;_i22++){var _t26=_e38[_i22];("string"==typeof _t26||_t26 instanceof RegExp)&&(_t26={name:_t26}),this._patterns.push(_t26);}}},{key:"match",value:function match(){for(var _len15=arguments.length,e=new Array(_len15),_key15=0;_key15<_len15;_key15++){e[_key15]=arguments[_key15];}for(var _i23=0,_e39=e;_i23<_e39.length;_i23++){var _t27=_e39[_i23];var _iterator32=_createForOfIteratorHelper(this._patterns),_step32;try{for(_iterator32.s();!(_step32=_iterator32.n()).done;){var _e40=_step32.value;var _i24=la(_t27,_e40);if(_i24)return{element:_t27,pattern:_e40,match:_i24};}}catch(err){_iterator32.e(err);}finally{_iterator32.f();}}return null;}},{key:"matchAll",value:function matchAll(){var t=[];for(var _len16=arguments.length,e=new Array(_len16),_key16=0;_key16<_len16;_key16++){e[_key16]=arguments[_key16];}for(var _i25=0,_e41=e;_i25<_e41.length;_i25++){var _i26=_e41[_i25];var _iterator33=_createForOfIteratorHelper(this._patterns),_step33;try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var _e42=_step33.value;var _n11=la(_i26,_e42);_n11&&t.push({element:_i26,pattern:_e42,match:_n11});}}catch(err){_iterator33.e(err);}finally{_iterator33.f();}}return t.length>0?t:null;}},{key:"getElementName",value:function getElementName(){if(1!==this._patterns.length)return null;var e=this._patterns[0],t=e.name;return"function"==typeof e||!t||t instanceof RegExp?null:t;}}]);}();function la(e,t){if("function"==typeof t)return t(e);var i={};return t.name&&(i.name=function(e,t){if(e instanceof RegExp)return!!t.match(e);return e===t;}(t.name,e.name),!i.name)||t.attributes&&(i.attributes=function(e,t){var i=new Set(t.getAttributeKeys());ei(e)?(void 0!==e.style&&E("matcher-pattern-deprecated-attributes-style-key",e),void 0!==e["class"]&&E("matcher-pattern-deprecated-attributes-class-key",e)):(i["delete"]("style"),i["delete"]("class"));return ca(e,i,function(e){return t.getAttribute(e);});}(t.attributes,e),!i.attributes)||t.classes&&(i.classes=function(e,t){return ca(e,t.getClassNames(),function(){});}(t.classes,e),!i.classes)||t.styles&&(i.styles=function(e,t){return ca(e,t.getStyleNames(!0),function(e){return t.getStyle(e);});}(t.styles,e),!i.styles)?null:i;}function ca(e,t,i){var n=function(e){if(Array.isArray(e))return e.map(function(e){return ei(e)?(void 0!==e.key&&void 0!==e.value||E("matcher-pattern-missing-key-or-value",e),[e.key,e.value]):[e,!0];});if(ei(e))return Object.entries(e);return[[e,!0]];}(e),s=Array.from(t),o=[];if(n.forEach(function(_ref16){var _ref17=_slicedToArray(_ref16,2),e=_ref17[0],t=_ref17[1];s.forEach(function(n){(function(e,t){return!0===e||e===t||e instanceof RegExp&&t.match(e);})(e,n)&&function(e,t,i){if(!0===e)return!0;var n=i(t);return e===n||e instanceof RegExp&&!!String(n).match(e);}(t,n,i)&&o.push(n);});}),n.length&&!(o.length<n.length))return o;}var da=/*#__PURE__*/function(){function da(e){_classCallCheck(this,da);_defineProperty(this,"_styles",void 0);_defineProperty(this,"_styleProcessor",void 0);this._styles={},this._styleProcessor=e;}return _createClass(da,[{key:"isEmpty",get:function get(){return!Object.entries(this._styles).length;}},{key:"size",get:function get(){return this.isEmpty?0:this.getStyleNames().length;}},{key:"setTo",value:function setTo(e){this.clear();var t=function(e){var t=null,i=0,n=0,s=null;var o=new Map();if(""===e)return o;";"!=e.charAt(e.length-1)&&(e+=";");for(var _r4=0;_r4<e.length;_r4++){var _a3=e.charAt(_r4);if(null===t)switch(_a3){case":":s||(s=e.substr(i,_r4-i),n=_r4+1);break;case'"':case"'":t=_a3;break;case";":{var _t28=e.substr(n,_r4-n);s&&o.set(s.trim(),_t28.trim()),s=null,i=_r4+1;break;}}else _a3===t&&(t=null);}return o;}(e);var _iterator34=_createForOfIteratorHelper(t),_step34;try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var _step34$value=_slicedToArray(_step34.value,2),_e43=_step34$value[0],_i27=_step34$value[1];this._styleProcessor.toNormalizedForm(_e43,_i27,this._styles);}}catch(err){_iterator34.e(err);}finally{_iterator34.f();}}},{key:"has",value:function has(e){if(this.isEmpty)return!1;var t=this._styleProcessor.getReducedForm(e,this._styles).find(function(_ref18){var _ref19=_slicedToArray(_ref18,1),t=_ref19[0];return t===e;});return Array.isArray(t);}},{key:"set",value:function set(e,t){if(ue(e))for(var _i28=0,_Object$entries=Object.entries(e);_i28<_Object$entries.length;_i28++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i28],2),_t29=_Object$entries$_i[0],_i29=_Object$entries$_i[1];this._styleProcessor.toNormalizedForm(_t29,_i29,this._styles);}else this._styleProcessor.toNormalizedForm(e,t,this._styles);}},{key:"remove",value:function remove(e){var t=ha(e);!function(e,t){null==e||Ns(e,t);}(this._styles,t),delete this._styles[e],this._cleanEmptyObjectsOnPath(t);}},{key:"getNormalized",value:function getNormalized(e){return this._styleProcessor.getNormalized(e,this._styles);}},{key:"toString",value:function toString(){return this.isEmpty?"":this.getStylesEntries().map(function(e){return e.join(":");}).sort().join(";")+";";}},{key:"getAsString",value:function getAsString(e){if(this.isEmpty)return;if(this._styles[e]&&!ue(this._styles[e]))return this._styles[e];var t=this._styleProcessor.getReducedForm(e,this._styles).find(function(_ref20){var _ref21=_slicedToArray(_ref20,1),t=_ref21[0];return t===e;});return Array.isArray(t)?t[1]:void 0;}},{key:"getStyleNames",value:function getStyleNames(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(this.isEmpty)return[];if(e)return this._styleProcessor.getStyleNames(this._styles);return this.getStylesEntries().map(function(_ref22){var _ref23=_slicedToArray(_ref22,1),e=_ref23[0];return e;});}},{key:"clear",value:function clear(){this._styles={};}},{key:"getStylesEntries",value:function getStylesEntries(){var e=[],t=Object.keys(this._styles);for(var _i30=0,_t30=t;_i30<_t30.length;_i30++){var _i31=_t30[_i30];e.push.apply(e,_toConsumableArray(this._styleProcessor.getReducedForm(_i31,this._styles)));}return e;}},{key:"_cleanEmptyObjectsOnPath",value:function _cleanEmptyObjectsOnPath(e){var t=e.split(".");if(!(t.length>1))return;var i=t.splice(0,t.length-1).join("."),n=qt(this._styles,i);if(!n)return;!Object.keys(n).length&&this.remove(i);}}]);}();var ua=/*#__PURE__*/function(){function ua(){_classCallCheck(this,ua);_defineProperty(this,"_normalizers",void 0);_defineProperty(this,"_extractors",void 0);_defineProperty(this,"_reducers",void 0);_defineProperty(this,"_consumables",void 0);this._normalizers=new Map(),this._extractors=new Map(),this._reducers=new Map(),this._consumables=new Map();}return _createClass(ua,[{key:"toNormalizedForm",value:function toNormalizedForm(e,t,i){if(ue(t))ma(i,ha(e),t);else if(this._normalizers.has(e)){var _n13=this._normalizers.get(e),_n12=_n13(t),_s12=_n12.path,_o8=_n12.value;ma(i,_s12,_o8);}else ma(i,e,t);}},{key:"getNormalized",value:function getNormalized(e,t){if(!e)return Fs({},t);if(void 0!==t[e])return t[e];if(this._extractors.has(e)){var _i32=this._extractors.get(e);if("string"==typeof _i32)return qt(t,_i32);var _n14=_i32(e,t);if(_n14)return _n14;}return qt(t,ha(e));}},{key:"getReducedForm",value:function getReducedForm(e,t){var i=this.getNormalized(e,t);if(void 0===i)return[];if(this._reducers.has(e)){return this._reducers.get(e)(i);}return[[e,i]];}},{key:"getStyleNames",value:function getStyleNames(e){var t=new Set();var _iterator35=_createForOfIteratorHelper(this._consumables.keys()),_step35;try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){var _i35=_step35.value;var _n15=this.getNormalized(_i35,e);_n15&&("object"!=_typeof(_n15)||Object.keys(_n15).length)&&t.add(_i35);}}catch(err){_iterator35.e(err);}finally{_iterator35.f();}for(var _i33=0,_Object$keys2=Object.keys(e);_i33<_Object$keys2.length;_i33++){var _i34=_Object$keys2[_i33];t.add(_i34);}return Array.from(t);}},{key:"getRelatedStyles",value:function getRelatedStyles(e){return this._consumables.get(e)||[];}},{key:"setNormalizer",value:function setNormalizer(e,t){this._normalizers.set(e,t);}},{key:"setExtractor",value:function setExtractor(e,t){this._extractors.set(e,t);}},{key:"setReducer",value:function setReducer(e,t){this._reducers.set(e,t);}},{key:"setStyleRelation",value:function setStyleRelation(e,t){this._mapStyleNames(e,t);var _iterator36=_createForOfIteratorHelper(t),_step36;try{for(_iterator36.s();!(_step36=_iterator36.n()).done;){var _i36=_step36.value;this._mapStyleNames(_i36,[e]);}}catch(err){_iterator36.e(err);}finally{_iterator36.f();}}},{key:"_mapStyleNames",value:function _mapStyleNames(e,t){var _this$_consumables$ge;this._consumables.has(e)||this._consumables.set(e,[]),(_this$_consumables$ge=this._consumables.get(e)).push.apply(_this$_consumables$ge,_toConsumableArray(t));}}]);}();function ha(e){return e.replace("-",".");}function ma(e,t,i){var n=i;ue(i)&&(n=Fs({},qt(e,t),i)),Ds(e,t,n);}var ga=/*#__PURE__*/function(_sa2){function e(_e45,t,i,n){var _this34;_classCallCheck(this,e);if(_this34=_callSuper(this,e,[_e45]),_defineProperty(_assertThisInitialized(_this34),"name",void 0),_defineProperty(_assertThisInitialized(_this34),"_unsafeAttributesToRender",[]),_defineProperty(_assertThisInitialized(_this34),"_attrs",void 0),_defineProperty(_assertThisInitialized(_this34),"_children",void 0),_defineProperty(_assertThisInitialized(_this34),"_classes",void 0),_defineProperty(_assertThisInitialized(_this34),"_styles",void 0),_defineProperty(_assertThisInitialized(_this34),"_customProperties",new Map()),_this34.name=t,_this34._attrs=function(e){var t=xr(e);var _iterator37=_createForOfIteratorHelper(t),_step37;try{for(_iterator37.s();!(_step37=_iterator37.n()).done;){var _step37$value=_slicedToArray(_step37.value,2),_e77=_step37$value[0],_i37=_step37$value[1];null===_i37?t["delete"](_e77):"string"!=typeof _i37&&t.set(_e77,String(_i37));}}catch(err){_iterator37.e(err);}finally{_iterator37.f();}return t;}(i),_this34._children=[],n&&_this34._insertChild(0,n),_this34._classes=new Set(),_this34._attrs.has("class")){var _e46=_this34._attrs.get("class");fa(_this34._classes,_e46),_this34._attrs["delete"]("class");}_this34._styles=new da(_this34.document.stylesProcessor),_this34._attrs.has("style")&&(_this34._styles.setTo(_this34._attrs.get("style")),_this34._attrs["delete"]("style"));return _this34;}_inherits(e,_sa2);return _createClass(e,[{key:"childCount",get:function get(){return this._children.length;}},{key:"isEmpty",get:function get(){return 0===this._children.length;}},{key:"getChild",value:function getChild(_e47){return this._children[_e47];}},{key:"getChildIndex",value:function getChildIndex(_e48){return this._children.indexOf(_e48);}},{key:"getChildren",value:function getChildren(){return this._children[Symbol.iterator]();}},{key:"getAttributeKeys",value:/*#__PURE__*/_regeneratorRuntime().mark(function getAttributeKeys(){return _regeneratorRuntime().wrap(function getAttributeKeys$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.t0=this._classes.size>0;if(!_context3.t0){_context3.next=4;break;}_context3.next=4;return"class";case 4:_context3.t1=this._styles.isEmpty;if(_context3.t1){_context3.next=8;break;}_context3.next=8;return"style";case 8:return _context3.delegateYield(this._attrs.keys(),"t2",9);case 9:case"end":return _context3.stop();}},getAttributeKeys,this);})},{key:"getAttributes",value:/*#__PURE__*/_regeneratorRuntime().mark(function getAttributes(){return _regeneratorRuntime().wrap(function getAttributes$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:return _context4.delegateYield(this._attrs.entries(),"t0",1);case 1:_context4.t1=this._classes.size>0;if(!_context4.t1){_context4.next=5;break;}_context4.next=5;return["class",this.getAttribute("class")];case 5:_context4.t2=this._styles.isEmpty;if(_context4.t2){_context4.next=9;break;}_context4.next=9;return["style",this.getAttribute("style")];case 9:case"end":return _context4.stop();}},getAttributes,this);})},{key:"getAttribute",value:function getAttribute(_e49){if("class"==_e49)return this._classes.size>0?_toConsumableArray(this._classes).join(" "):void 0;if("style"==_e49){var _e50=this._styles.toString();return""==_e50?void 0:_e50;}return this._attrs.get(_e49);}},{key:"hasAttribute",value:function hasAttribute(_e51){return"class"==_e51?this._classes.size>0:"style"==_e51?!this._styles.isEmpty:this._attrs.has(_e51);}},{key:"isSimilar",value:function isSimilar(t){if(!(t instanceof e))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;var _iterator38=_createForOfIteratorHelper(this._attrs),_step38;try{for(_iterator38.s();!(_step38=_iterator38.n()).done;){var _step38$value=_slicedToArray(_step38.value,2),_e52=_step38$value[0],_i38=_step38$value[1];if(!t._attrs.has(_e52)||t._attrs.get(_e52)!==_i38)return!1;}}catch(err){_iterator38.e(err);}finally{_iterator38.f();}var _iterator39=_createForOfIteratorHelper(this._classes),_step39;try{for(_iterator39.s();!(_step39=_iterator39.n()).done;){var _e53=_step39.value;if(!t._classes.has(_e53))return!1;}}catch(err){_iterator39.e(err);}finally{_iterator39.f();}var _iterator40=_createForOfIteratorHelper(this._styles.getStyleNames()),_step40;try{for(_iterator40.s();!(_step40=_iterator40.n()).done;){var _e54=_step40.value;if(!t._styles.has(_e54)||t._styles.getAsString(_e54)!==this._styles.getAsString(_e54))return!1;}}catch(err){_iterator40.e(err);}finally{_iterator40.f();}return!0;}},{key:"hasClass",value:function hasClass(){for(var _len17=arguments.length,_e55=new Array(_len17),_key17=0;_key17<_len17;_key17++){_e55[_key17]=arguments[_key17];}for(var _i39=0,_e78=_e55;_i39<_e78.length;_i39++){var _t31=_e78[_i39];if(!this._classes.has(_t31))return!1;}return!0;}},{key:"getClassNames",value:function getClassNames(){return this._classes.keys();}},{key:"getStyle",value:function getStyle(_e56){return this._styles.getAsString(_e56);}},{key:"getNormalizedStyle",value:function getNormalizedStyle(_e57){return this._styles.getNormalized(_e57);}},{key:"getStyleNames",value:function getStyleNames(_e58){return this._styles.getStyleNames(_e58);}},{key:"hasStyle",value:function hasStyle(){for(var _len18=arguments.length,_e59=new Array(_len18),_key18=0;_key18<_len18;_key18++){_e59[_key18]=arguments[_key18];}for(var _i40=0,_e79=_e59;_i40<_e79.length;_i40++){var _t32=_e79[_i40];if(!this._styles.has(_t32))return!1;}return!0;}},{key:"findAncestor",value:function findAncestor(){for(var _len19=arguments.length,_e60=new Array(_len19),_key19=0;_key19<_len19;_key19++){_e60[_key19]=arguments[_key19];}var t=_construct(aa,_e60);var i=this.parent;for(;i&&!i.is("documentFragment");){if(t.match(i))return i;i=i.parent;}return null;}},{key:"getCustomProperty",value:function getCustomProperty(_e61){return this._customProperties.get(_e61);}},{key:"getCustomProperties",value:/*#__PURE__*/_regeneratorRuntime().mark(function getCustomProperties(){return _regeneratorRuntime().wrap(function getCustomProperties$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:return _context5.delegateYield(this._customProperties.entries(),"t0",1);case 1:case"end":return _context5.stop();}},getCustomProperties,this);})},{key:"getIdentity",value:function getIdentity(){var _e62=Array.from(this._classes).sort().join(","),t=this._styles.toString(),i=Array.from(this._attrs).map(function(_e63){return"".concat(_e63[0],"=\"").concat(_e63[1],"\"");}).sort().join(" ");return this.name+(""==_e62?"":" class=\"".concat(_e62,"\""))+(t?" style=\"".concat(t,"\""):"")+(""==i?"":" ".concat(i));}},{key:"shouldRenderUnsafeAttribute",value:function shouldRenderUnsafeAttribute(_e64){return this._unsafeAttributesToRender.includes(_e64);}},{key:"_clone",value:function _clone(){var _e65=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var t=[];if(_e65){var _iterator41=_createForOfIteratorHelper(this.getChildren()),_step41;try{for(_iterator41.s();!(_step41=_iterator41.n()).done;){var _i41=_step41.value;t.push(_i41._clone(_e65));}}catch(err){_iterator41.e(err);}finally{_iterator41.f();}}var i=new this.constructor(this.document,this.name,this._attrs,t);return i._classes=new Set(this._classes),i._styles.set(this._styles.getNormalized()),i._customProperties=new Map(this._customProperties),i.getFillerOffset=this.getFillerOffset,i._unsafeAttributesToRender=this._unsafeAttributesToRender,i;}},{key:"_appendChild",value:function _appendChild(_e66){return this._insertChild(this.childCount,_e66);}},{key:"_insertChild",value:function _insertChild(_e67,t){this._fireChange("children",this);var i=0;var n=function(e,t){if("string"==typeof t)return[new oa(e,t)];oo(t)||(t=[t]);return Array.from(t).map(function(t){return"string"==typeof t?new oa(e,t):t instanceof ra?new oa(e,t.data):t;});}(this.document,t);var _iterator42=_createForOfIteratorHelper(n),_step42;try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var _t33=_step42.value;null!==_t33.parent&&_t33._remove(),_t33.parent=this,_t33.document=this.document,this._children.splice(_e67,0,_t33),_e67++,i++;}}catch(err){_iterator42.e(err);}finally{_iterator42.f();}return i;}},{key:"_removeChildren",value:function _removeChildren(_e68){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this._fireChange("children",this);for(var _i42=_e68;_i42<_e68+t;_i42++)this._children[_i42].parent=null;return this._children.splice(_e68,t);}},{key:"_setAttribute",value:function _setAttribute(_e69,t){var i=String(t);this._fireChange("attributes",this),"class"==_e69?fa(this._classes,i):"style"==_e69?this._styles.setTo(i):this._attrs.set(_e69,i);}},{key:"_removeAttribute",value:function _removeAttribute(_e70){return this._fireChange("attributes",this),"class"==_e70?this._classes.size>0&&(this._classes.clear(),!0):"style"==_e70?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs["delete"](_e70);}},{key:"_addClass",value:function _addClass(_e71){this._fireChange("attributes",this);var _iterator43=_createForOfIteratorHelper(gr(_e71)),_step43;try{for(_iterator43.s();!(_step43=_iterator43.n()).done;){var _t34=_step43.value;this._classes.add(_t34);}}catch(err){_iterator43.e(err);}finally{_iterator43.f();}}},{key:"_removeClass",value:function _removeClass(_e72){this._fireChange("attributes",this);var _iterator44=_createForOfIteratorHelper(gr(_e72)),_step44;try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var _t35=_step44.value;this._classes["delete"](_t35);}}catch(err){_iterator44.e(err);}finally{_iterator44.f();}}},{key:"_setStyle",value:function _setStyle(_e73,t){this._fireChange("attributes",this),"string"!=typeof _e73?this._styles.set(_e73):this._styles.set(_e73,t);}},{key:"_removeStyle",value:function _removeStyle(_e74){this._fireChange("attributes",this);var _iterator45=_createForOfIteratorHelper(gr(_e74)),_step45;try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var _t36=_step45.value;this._styles.remove(_t36);}}catch(err){_iterator45.e(err);}finally{_iterator45.f();}}},{key:"_setCustomProperty",value:function _setCustomProperty(_e75,t){this._customProperties.set(_e75,t);}},{key:"_removeCustomProperty",value:function _removeCustomProperty(_e76){return this._customProperties["delete"](_e76);}}]);}(sa);function fa(e,t){var i=t.split(/\s+/);e.clear(),i.forEach(function(t){return e.add(t);});}ga.prototype.is=function(e,t){return t?t===this.name&&("element"===e||"view:element"===e):"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var pa=/*#__PURE__*/function(_ga){function pa(e,t,i,n){var _this35;_classCallCheck(this,pa);_this35=_callSuper(this,pa,[e,t,i,n]),_this35.getFillerOffset=ba;return _this35;}_inherits(pa,_ga);return _createClass(pa);}(ga);function ba(){var e=_toConsumableArray(this.getChildren()),t=e[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;var _iterator46=_createForOfIteratorHelper(e),_step46;try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var _t37=_step46.value;if(!_t37.is("uiElement"))return null;}}catch(err){_iterator46.e(err);}finally{_iterator46.f();}return this.childCount;}pa.prototype.is=function(e,t){return t?t===this.name&&("containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var wa=/*#__PURE__*/function(_Zs4){function wa(e,t,i,n){var _this36;_classCallCheck(this,wa);_this36=_callSuper(this,wa,[e,t,i,n]),_this36.set("isReadOnly",!1),_this36.set("isFocused",!1),_this36.set("placeholder",void 0),_this36.bind("isReadOnly").to(e),_this36.bind("isFocused").to(e,"isFocused",function(t){return t&&e.selection.editableElement==_assertThisInitialized(_this36);}),_this36.listenTo(e.selection,"change",function(){_this36.isFocused=e.isFocused&&e.selection.editableElement==_assertThisInitialized(_this36);});return _this36;}_inherits(wa,_Zs4);return _createClass(wa,[{key:"destroy",value:function destroy(){this.stopListening();}}]);}(Zs(pa));wa.prototype.is=function(e,t){return t?t===this.name&&("editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var _a=Symbol("rootName");var va=/*#__PURE__*/function(_wa){function va(e,t){var _this37;_classCallCheck(this,va);_this37=_callSuper(this,va,[e,t]),_this37.rootName="main";return _this37;}_inherits(va,_wa);return _createClass(va,[{key:"rootName",get:function get(){return this.getCustomProperty(_a);},set:function set(e){this._setCustomProperty(_a,e);}},{key:"_name",set:function set(e){this.name=e;}}]);}(wa);va.prototype.is=function(e,t){return t?t===this.name&&("rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e):"rootElement"===e||"view:rootElement"===e||"editableElement"===e||"view:editableElement"===e||"containerElement"===e||"view:containerElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var ya=/*#__PURE__*/function(){function ya(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,ya);_defineProperty(this,"direction",void 0);_defineProperty(this,"boundaries",void 0);_defineProperty(this,"singleCharacters",void 0);_defineProperty(this,"shallow",void 0);_defineProperty(this,"ignoreElementEnd",void 0);_defineProperty(this,"_position",void 0);_defineProperty(this,"_boundaryStartParent",void 0);_defineProperty(this,"_boundaryEndParent",void 0);if(!e.boundaries&&!e.startPosition)throw new A("view-tree-walker-no-start-position",null);if(e.direction&&"forward"!=e.direction&&"backward"!=e.direction)throw new A("view-tree-walker-unknown-direction",e.startPosition,{direction:e.direction});this.boundaries=e.boundaries||null,e.startPosition?this._position=ka._createAt(e.startPosition):this._position=ka._createAt(e.boundaries["backward"==e.direction?"end":"start"]),this.direction=e.direction||"forward",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null;}return _createClass(ya,[{key:Symbol.iterator,value:function value(){return this;}},{key:"position",get:function get(){return this._position;}},{key:"skip",value:function skip(e){var t,i;do{i=this.position,t=this.next();}while(!t.done&&e(t.value));t.done||(this._position=i);}},{key:"next",value:function next(){return"forward"==this.direction?this._next():this._previous();}},{key:"_next",value:function _next(){var e=this.position.clone();var t=this.position,i=e.parent;if(null===i.parent&&e.offset===i.childCount)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};var n;if(i instanceof oa){if(e.isAtEnd)return this._position=ka._createAfter(i),this._next();n=i.data[e.offset];}else n=i.getChild(e.offset);if(n instanceof ga){if(this.shallow){if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++;}else e=new ka(n,0);return this._position=e,this._formatReturnValue("elementStart",n,t,e,1);}if(n instanceof oa){if(this.singleCharacters)return e=new ka(n,0),this._position=e,this._next();var _i43,_s13=n.data.length;return n==this._boundaryEndParent?(_s13=this.boundaries.end.offset,_i43=new ra(n,0,_s13),e=ka._createAfter(_i43)):(_i43=new ra(n,0,n.data.length),e.offset++),this._position=e,this._formatReturnValue("text",_i43,t,e,_s13);}if("string"==typeof n){var _n16;if(this.singleCharacters)_n16=1;else{_n16=(i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length)-e.offset;}var _s14=new ra(i,e.offset,_n16);return e.offset+=_n16,this._position=e,this._formatReturnValue("text",_s14,t,e,_n16);}return e=ka._createAfter(i),this._position=e,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,t,e);}},{key:"_previous",value:function _previous(){var e=this.position.clone();var t=this.position,i=e.parent;if(null===i.parent&&0===e.offset)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};var n;if(i instanceof oa){if(e.isAtStart)return this._position=ka._createBefore(i),this._previous();n=i.data[e.offset-1];}else n=i.getChild(e.offset-1);if(n instanceof ga)return this.shallow?(e.offset--,this._position=e,this._formatReturnValue("elementStart",n,t,e,1)):(e=new ka(n,n.childCount),this._position=e,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",n,t,e));if(n instanceof oa){if(this.singleCharacters)return e=new ka(n,n.data.length),this._position=e,this._previous();var _i44,_s15=n.data.length;if(n==this._boundaryStartParent){var _t38=this.boundaries.start.offset;_i44=new ra(n,_t38,n.data.length-_t38),_s15=_i44.data.length,e=ka._createBefore(_i44);}else _i44=new ra(n,0,n.data.length),e.offset--;return this._position=e,this._formatReturnValue("text",_i44,t,e,_s15);}if("string"==typeof n){var _n17;if(this.singleCharacters)_n17=1;else{var _t39=i===this._boundaryStartParent?this.boundaries.start.offset:0;_n17=e.offset-_t39;}e.offset-=_n17;var _s16=new ra(i,e.offset,_n17);return this._position=e,this._formatReturnValue("text",_s16,t,e,_n17);}return e=ka._createBefore(i),this._position=e,this._formatReturnValue("elementStart",i,t,e,1);}},{key:"_formatReturnValue",value:function _formatReturnValue(e,t,i,n,s){return t instanceof ra&&(t.offsetInText+t.data.length==t.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?i=ka._createAfter(t.textNode):(n=ka._createAfter(t.textNode),this._position=n)),0===t.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?i=ka._createBefore(t.textNode):(n=ka._createBefore(t.textNode),this._position=n))),{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:n,length:s}};}}]);}(),ka=/*#__PURE__*/function(_na2){function e(_e81,t){var _this38;_classCallCheck(this,e);_this38=_callSuper(this,e),_defineProperty(_assertThisInitialized(_this38),"parent",void 0),_defineProperty(_assertThisInitialized(_this38),"offset",void 0),_this38.parent=_e81,_this38.offset=t;return _this38;}_inherits(e,_na2);return _createClass(e,[{key:"nodeAfter",get:function get(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null;}},{key:"nodeBefore",get:function get(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null;}},{key:"isAtStart",get:function get(){return 0===this.offset;}},{key:"isAtEnd",get:function get(){var _e82=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===_e82;}},{key:"root",get:function get(){return this.parent.root;}},{key:"editableElement",get:function get(){var _e83=this.parent;for(;!(_e83 instanceof wa);){if(!_e83.parent)return null;_e83=_e83.parent;}return _e83;}},{key:"getShiftedBy",value:function getShiftedBy(t){var i=e._createAt(this),n=i.offset+t;return i.offset=n<0?0:n,i;}},{key:"getLastMatchingPosition",value:function getLastMatchingPosition(_e84){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};t.startPosition=this;var i=new ya(t);return i.skip(_e84),i.position;}},{key:"getAncestors",value:function getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0});}},{key:"getCommonAncestor",value:function getCommonAncestor(_e85){var t=this.getAncestors(),i=_e85.getAncestors();var n=0;for(;t[n]==i[n]&&t[n];)n++;return 0===n?null:t[n-1];}},{key:"isEqual",value:function isEqual(_e86){return this.parent==_e86.parent&&this.offset==_e86.offset;}},{key:"isBefore",value:function isBefore(_e87){return"before"==this.compareWith(_e87);}},{key:"isAfter",value:function isAfter(_e88){return"after"==this.compareWith(_e88);}},{key:"compareWith",value:function compareWith(_e89){if(this.root!==_e89.root)return"different";if(this.isEqual(_e89))return"same";var t=this.parent.is("node")?this.parent.getPath():[],i=_e89.parent.is("node")?_e89.parent.getPath():[];t.push(this.offset),i.push(_e89.offset);var n=so(t,i);switch(n){case"prefix":return"before";case"extension":return"after";default:return t[n]<i[n]?"before":"after";}}},{key:"getWalker",value:function getWalker(){var _e90=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return _e90.startPosition=this,new ya(_e90);}},{key:"clone",value:function clone(){return new e(this.parent,this.offset);}}],[{key:"_createAt",value:function _createAt(t,i){if(t instanceof e)return new this(t.parent,t.offset);{var _n18=t;if("end"==i)i=_n18.is("$text")?_n18.data.length:_n18.childCount;else{if("before"==i)return this._createBefore(_n18);if("after"==i)return this._createAfter(_n18);if(0!==i&&!i)throw new A("view-createpositionat-offset-required",_n18);}return new e(_n18,i);}}},{key:"_createAfter",value:function _createAfter(t){if(t.is("$textProxy"))return new e(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new A("view-position-after-root",t,{root:t});return new e(t.parent,t.index+1);}},{key:"_createBefore",value:function _createBefore(t){if(t.is("$textProxy"))return new e(t.textNode,t.offsetInText);if(!t.parent)throw new A("view-position-before-root",t,{root:t});return new e(t.parent,t.index);}}]);}(na);ka.prototype.is=function(e){return"position"===e||"view:position"===e;};var Ca=/*#__PURE__*/function(_na3){function e(_e92){var _this39;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;_classCallCheck(this,e);_this39=_callSuper(this,e),_defineProperty(_assertThisInitialized(_this39),"start",void 0),_defineProperty(_assertThisInitialized(_this39),"end",void 0),_this39.start=_e92.clone(),_this39.end=t?t.clone():_e92.clone();return _this39;}_inherits(e,_na3);return _createClass(e,[{key:Symbol.iterator,value:/*#__PURE__*/_regeneratorRuntime().mark(function value(){return _regeneratorRuntime().wrap(function value$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:return _context6.delegateYield(new ya({boundaries:this,ignoreElementEnd:!0}),"t0",1);case 1:case"end":return _context6.stop();}},value,this);})},{key:"isCollapsed",get:function get(){return this.start.isEqual(this.end);}},{key:"isFlat",get:function get(){return this.start.parent===this.end.parent;}},{key:"root",get:function get(){return this.start.root;}},{key:"getEnlarged",value:function getEnlarged(){var t=this.start.getLastMatchingPosition(xa,{direction:"backward"}),i=this.end.getLastMatchingPosition(xa);return t.parent.is("$text")&&t.isAtStart&&(t=ka._createBefore(t.parent)),i.parent.is("$text")&&i.isAtEnd&&(i=ka._createAfter(i.parent)),new e(t,i);}},{key:"getTrimmed",value:function getTrimmed(){var t=this.start.getLastMatchingPosition(xa);if(t.isAfter(this.end)||t.isEqual(this.end))return new e(t,t);var i=this.end.getLastMatchingPosition(xa,{direction:"backward"});var n=t.nodeAfter,s=i.nodeBefore;return n&&n.is("$text")&&(t=new ka(n,0)),s&&s.is("$text")&&(i=new ka(s,s.data.length)),new e(t,i);}},{key:"isEqual",value:function isEqual(_e93){return this==_e93||this.start.isEqual(_e93.start)&&this.end.isEqual(_e93.end);}},{key:"containsPosition",value:function containsPosition(_e94){return _e94.isAfter(this.start)&&_e94.isBefore(this.end);}},{key:"containsRange",value:function containsRange(_e95){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;_e95.isCollapsed&&(t=!1);var i=this.containsPosition(_e95.start)||t&&this.start.isEqual(_e95.start),n=this.containsPosition(_e95.end)||t&&this.end.isEqual(_e95.end);return i&&n;}},{key:"getDifference",value:function getDifference(t){var i=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&i.push(new e(this.start,t.start)),this.containsPosition(t.end)&&i.push(new e(t.end,this.end))):i.push(this.clone()),i;}},{key:"getIntersection",value:function getIntersection(t){if(this.isIntersecting(t)){var _i45=this.start,_n19=this.end;return this.containsPosition(t.start)&&(_i45=t.start),this.containsPosition(t.end)&&(_n19=t.end),new e(_i45,_n19);}return null;}},{key:"getWalker",value:function getWalker(){var _e96=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return _e96.boundaries=this,new ya(_e96);}},{key:"getCommonAncestor",value:function getCommonAncestor(){return this.start.getCommonAncestor(this.end);}},{key:"getContainedElement",value:function getContainedElement(){if(this.isCollapsed)return null;var _e97=this.start.nodeAfter,t=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(_e97=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(t=this.end.parent.previousSibling),_e97&&_e97.is("element")&&_e97===t?_e97:null;}},{key:"clone",value:function clone(){return new e(this.start,this.end);}},{key:"getItems",value:function getItems(){var _this40=this;var _e98=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var t,_iterator47,_step47,_e99;return _regeneratorRuntime().wrap(function _callee$(_context7){while(1)switch(_context7.prev=_context7.next){case 0:_e98.boundaries=_this40,_e98.ignoreElementEnd=!0;t=new ya(_e98);_iterator47=_createForOfIteratorHelper(t);_context7.prev=3;_iterator47.s();case 5:if((_step47=_iterator47.n()).done){_context7.next=11;break;}_e99=_step47.value;_context7.next=9;return _e99.item;case 9:_context7.next=5;break;case 11:_context7.next=16;break;case 13:_context7.prev=13;_context7.t0=_context7["catch"](3);_iterator47.e(_context7.t0);case 16:_context7.prev=16;_iterator47.f();return _context7.finish(16);case 19:case"end":return _context7.stop();}},_callee,null,[[3,13,16,19]]);})();}},{key:"getPositions",value:function getPositions(){var _this41=this;var _e100=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var t,_iterator48,_step48,_e101;return _regeneratorRuntime().wrap(function _callee2$(_context8){while(1)switch(_context8.prev=_context8.next){case 0:_e100.boundaries=_this41;t=new ya(_e100);_context8.next=4;return t.position;case 4:_iterator48=_createForOfIteratorHelper(t);_context8.prev=5;_iterator48.s();case 7:if((_step48=_iterator48.n()).done){_context8.next=13;break;}_e101=_step48.value;_context8.next=11;return _e101.nextPosition;case 11:_context8.next=7;break;case 13:_context8.next=18;break;case 15:_context8.prev=15;_context8.t0=_context8["catch"](5);_iterator48.e(_context8.t0);case 18:_context8.prev=18;_iterator48.f();return _context8.finish(18);case 21:case"end":return _context8.stop();}},_callee2,null,[[5,15,18,21]]);})();}},{key:"isIntersecting",value:function isIntersecting(_e102){return this.start.isBefore(_e102.end)&&this.end.isAfter(_e102.start);}}],[{key:"_createFromParentsAndOffsets",value:function _createFromParentsAndOffsets(_e103,t,i,n){return new this(new ka(_e103,t),new ka(i,n));}},{key:"_createFromPositionAndShift",value:function _createFromPositionAndShift(_e104,t){var i=_e104,n=_e104.getShiftedBy(t);return t>0?new this(i,n):new this(n,i);}},{key:"_createIn",value:function _createIn(_e105){return this._createFromParentsAndOffsets(_e105,0,_e105,_e105.childCount);}},{key:"_createOn",value:function _createOn(_e106){var t=_e106.is("$textProxy")?_e106.offsetSize:1;return this._createFromPositionAndShift(ka._createBefore(_e106),t);}}]);}(na);function xa(e){return!(!e.item.is("attributeElement")&&!e.item.is("uiElement"));}Ca.prototype.is=function(e){return"range"===e||"view:range"===e;};var Aa=/*#__PURE__*/function(_L6){function e(){var _this43;var _this42;_classCallCheck(this,e);_this42=_callSuper(this,e),_defineProperty(_assertThisInitialized(_this42),"_ranges",void 0),_defineProperty(_assertThisInitialized(_this42),"_lastRangeBackward",void 0),_defineProperty(_assertThisInitialized(_this42),"_isFake",void 0),_defineProperty(_assertThisInitialized(_this42),"_fakeSelectionLabel",void 0),_this42._ranges=[],_this42._lastRangeBackward=!1,_this42._isFake=!1,_this42._fakeSelectionLabel="",arguments.length&&(_this43=_this42).setTo.apply(_this43,arguments);return _this42;}_inherits(e,_L6);return _createClass(e,[{key:"isFake",get:function get(){return this._isFake;}},{key:"fakeSelectionLabel",get:function get(){return this._fakeSelectionLabel;}},{key:"anchor",get:function get(){if(!this._ranges.length)return null;var _e109=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?_e109.end:_e109.start).clone();}},{key:"focus",get:function get(){if(!this._ranges.length)return null;var _e110=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?_e110.start:_e110.end).clone();}},{key:"isCollapsed",get:function get(){return 1===this.rangeCount&&this._ranges[0].isCollapsed;}},{key:"rangeCount",get:function get(){return this._ranges.length;}},{key:"isBackward",get:function get(){return!this.isCollapsed&&this._lastRangeBackward;}},{key:"editableElement",get:function get(){return this.anchor?this.anchor.editableElement:null;}},{key:"getRanges",value:/*#__PURE__*/_regeneratorRuntime().mark(function getRanges(){var _iterator49,_step49,_e111;return _regeneratorRuntime().wrap(function getRanges$(_context9){while(1)switch(_context9.prev=_context9.next){case 0:_iterator49=_createForOfIteratorHelper(this._ranges);_context9.prev=1;_iterator49.s();case 3:if((_step49=_iterator49.n()).done){_context9.next=9;break;}_e111=_step49.value;_context9.next=7;return _e111.clone();case 7:_context9.next=3;break;case 9:_context9.next=14;break;case 11:_context9.prev=11;_context9.t0=_context9["catch"](1);_iterator49.e(_context9.t0);case 14:_context9.prev=14;_iterator49.f();return _context9.finish(14);case 17:case"end":return _context9.stop();}},getRanges,this,[[1,11,14,17]]);})},{key:"getFirstRange",value:function getFirstRange(){var _e112=null;var _iterator50=_createForOfIteratorHelper(this._ranges),_step50;try{for(_iterator50.s();!(_step50=_iterator50.n()).done;){var _t40=_step50.value;_e112&&!_t40.start.isBefore(_e112.start)||(_e112=_t40);}}catch(err){_iterator50.e(err);}finally{_iterator50.f();}return _e112?_e112.clone():null;}},{key:"getLastRange",value:function getLastRange(){var _e113=null;var _iterator51=_createForOfIteratorHelper(this._ranges),_step51;try{for(_iterator51.s();!(_step51=_iterator51.n()).done;){var _t41=_step51.value;_e113&&!_t41.end.isAfter(_e113.end)||(_e113=_t41);}}catch(err){_iterator51.e(err);}finally{_iterator51.f();}return _e113?_e113.clone():null;}},{key:"getFirstPosition",value:function getFirstPosition(){var _e114=this.getFirstRange();return _e114?_e114.start.clone():null;}},{key:"getLastPosition",value:function getLastPosition(){var _e115=this.getLastRange();return _e115?_e115.end.clone():null;}},{key:"isEqual",value:function isEqual(_e116){if(this.isFake!=_e116.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=_e116.fakeSelectionLabel)return!1;if(this.rangeCount!=_e116.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(_e116.anchor)||!this.focus.isEqual(_e116.focus))return!1;var _iterator52=_createForOfIteratorHelper(this._ranges),_step52;try{for(_iterator52.s();!(_step52=_iterator52.n()).done;){var _t42=_step52.value;var _i46=!1;var _iterator53=_createForOfIteratorHelper(_e116._ranges),_step53;try{for(_iterator53.s();!(_step53=_iterator53.n()).done;){var _n20=_step53.value;if(_t42.isEqual(_n20)){_i46=!0;break;}}}catch(err){_iterator53.e(err);}finally{_iterator53.f();}if(!_i46)return!1;}}catch(err){_iterator52.e(err);}finally{_iterator52.f();}return!0;}},{key:"isSimilar",value:function isSimilar(_e117){if(this.isBackward!=_e117.isBackward)return!1;var t=no(this.getRanges());if(t!=no(_e117.getRanges()))return!1;if(0==t)return!0;var _iterator54=_createForOfIteratorHelper(this.getRanges()),_step54;try{for(_iterator54.s();!(_step54=_iterator54.n()).done;){var _t43=_step54.value;_t43=_t43.getTrimmed();var _i47=!1;var _iterator55=_createForOfIteratorHelper(_e117.getRanges()),_step55;try{for(_iterator55.s();!(_step55=_iterator55.n()).done;){var _n21=_step55.value;if(_n21=_n21.getTrimmed(),_t43.start.isEqual(_n21.start)&&_t43.end.isEqual(_n21.end)){_i47=!0;break;}}}catch(err){_iterator55.e(err);}finally{_iterator55.f();}if(!_i47)return!1;}}catch(err){_iterator54.e(err);}finally{_iterator54.f();}return!0;}},{key:"getSelectedElement",value:function getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement();}},{key:"setTo",value:function setTo(){for(var _len20=arguments.length,t=new Array(_len20),_key20=0;_key20<_len20;_key20++){t[_key20]=arguments[_key20];}var i=t[0],n=t[1],s=t[2];if("object"==_typeof(n)&&(s=n,n=void 0),null===i)this._setRanges([]),this._setFakeOptions(s);else if(i instanceof e||i instanceof Ea)this._setRanges(i.getRanges(),i.isBackward),this._setFakeOptions({fake:i.isFake,label:i.fakeSelectionLabel});else if(i instanceof Ca)this._setRanges([i],s&&s.backward),this._setFakeOptions(s);else if(i instanceof ka)this._setRanges([new Ca(i)]),this._setFakeOptions(s);else if(i instanceof sa){var _e118=!!s&&!!s.backward;var _t44;if(void 0===n)throw new A("view-selection-setto-required-second-parameter",this);_t44="in"==n?Ca._createIn(i):"on"==n?Ca._createOn(i):new Ca(ka._createAt(i,n)),this._setRanges([_t44],_e118),this._setFakeOptions(s);}else{if(!oo(i))throw new A("view-selection-setto-not-selectable",this);this._setRanges(i,s&&s.backward),this._setFakeOptions(s);}this.fire("change");}},{key:"setFocus",value:function setFocus(_e119,t){if(null===this.anchor)throw new A("view-selection-setfocus-no-ranges",this);var i=ka._createAt(_e119,t);if("same"==i.compareWith(this.focus))return;var n=this.anchor;this._ranges.pop(),"before"==i.compareWith(n)?this._addRange(new Ca(i,n),!0):this._addRange(new Ca(n,i)),this.fire("change");}},{key:"_setRanges",value:function _setRanges(_e120){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;_e120=Array.from(_e120),this._ranges=[];var _iterator56=_createForOfIteratorHelper(_e120),_step56;try{for(_iterator56.s();!(_step56=_iterator56.n()).done;){var _t45=_step56.value;this._addRange(_t45);}}catch(err){_iterator56.e(err);}finally{_iterator56.f();}this._lastRangeBackward=!!t;}},{key:"_setFakeOptions",value:function _setFakeOptions(){var _e121=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._isFake=!!_e121.fake,this._fakeSelectionLabel=_e121.fake&&_e121.label||"";}},{key:"_addRange",value:function _addRange(_e122){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!(_e122 instanceof Ca))throw new A("view-selection-add-range-not-range",this);this._pushRange(_e122),this._lastRangeBackward=!!t;}},{key:"_pushRange",value:function _pushRange(_e123){var _iterator57=_createForOfIteratorHelper(this._ranges),_step57;try{for(_iterator57.s();!(_step57=_iterator57.n()).done;){var _t46=_step57.value;if(_e123.isIntersecting(_t46))throw new A("view-selection-range-intersects",this,{addedRange:_e123,intersectingRange:_t46});}}catch(err){_iterator57.e(err);}finally{_iterator57.f();}this._ranges.push(new Ca(_e123.start,_e123.end));}}]);}(L(na));Aa.prototype.is=function(e){return"selection"===e||"view:selection"===e;};var Ea=/*#__PURE__*/function(_L7){function Ea(){var _this44$_selection;var _this44;_classCallCheck(this,Ea);_this44=_callSuper(this,Ea),_defineProperty(_assertThisInitialized(_this44),"_selection",void 0),_this44._selection=new Aa(),_this44._selection.delegate("change").to(_assertThisInitialized(_this44)),arguments.length&&(_this44$_selection=_this44._selection).setTo.apply(_this44$_selection,arguments);return _this44;}_inherits(Ea,_L7);return _createClass(Ea,[{key:"isFake",get:function get(){return this._selection.isFake;}},{key:"fakeSelectionLabel",get:function get(){return this._selection.fakeSelectionLabel;}},{key:"anchor",get:function get(){return this._selection.anchor;}},{key:"focus",get:function get(){return this._selection.focus;}},{key:"isCollapsed",get:function get(){return this._selection.isCollapsed;}},{key:"rangeCount",get:function get(){return this._selection.rangeCount;}},{key:"isBackward",get:function get(){return this._selection.isBackward;}},{key:"editableElement",get:function get(){return this._selection.editableElement;}},{key:"_ranges",get:function get(){return this._selection._ranges;}},{key:"getRanges",value:/*#__PURE__*/_regeneratorRuntime().mark(function getRanges(){return _regeneratorRuntime().wrap(function getRanges$(_context10){while(1)switch(_context10.prev=_context10.next){case 0:return _context10.delegateYield(this._selection.getRanges(),"t0",1);case 1:case"end":return _context10.stop();}},getRanges,this);})},{key:"getFirstRange",value:function getFirstRange(){return this._selection.getFirstRange();}},{key:"getLastRange",value:function getLastRange(){return this._selection.getLastRange();}},{key:"getFirstPosition",value:function getFirstPosition(){return this._selection.getFirstPosition();}},{key:"getLastPosition",value:function getLastPosition(){return this._selection.getLastPosition();}},{key:"getSelectedElement",value:function getSelectedElement(){return this._selection.getSelectedElement();}},{key:"isEqual",value:function isEqual(e){return this._selection.isEqual(e);}},{key:"isSimilar",value:function isSimilar(e){return this._selection.isSimilar(e);}},{key:"_setTo",value:function _setTo(){var _this$_selection;(_this$_selection=this._selection).setTo.apply(_this$_selection,arguments);}},{key:"_setFocus",value:function _setFocus(e,t){this._selection.setFocus(e,t);}}]);}(L(na));Ea.prototype.is=function(e){return"selection"===e||"documentSelection"==e||"view:selection"==e||"view:documentSelection"==e;};var Ta=/*#__PURE__*/function(_v3){function Ta(e,t,i){var _this45;_classCallCheck(this,Ta);_this45=_callSuper(this,Ta,[e,t]),_defineProperty(_assertThisInitialized(_this45),"startRange",void 0),_defineProperty(_assertThisInitialized(_this45),"_eventPhase",void 0),_defineProperty(_assertThisInitialized(_this45),"_currentTarget",void 0),_this45.startRange=i,_this45._eventPhase="none",_this45._currentTarget=null;return _this45;}_inherits(Ta,_v3);return _createClass(Ta,[{key:"eventPhase",get:function get(){return this._eventPhase;}},{key:"currentTarget",get:function get(){return this._currentTarget;}}]);}(v);var Pa=Symbol("bubbling contexts");function Sa(e){return/*#__PURE__*/function(_e124){function _class4(){_classCallCheck(this,_class4);return _callSuper(this,_class4,arguments);}_inherits(_class4,_e124);return _createClass(_class4,[{key:"fire",value:function fire(e){try{var _i48=e instanceof v?e:new v(this,e),_n22=Oa(this);if(!_n22.size)return;for(var _len21=arguments.length,t=new Array(_len21>1?_len21-1:0),_key21=1;_key21<_len21;_key21++){t[_key21-1]=arguments[_key21];}if(Ia(_i48,"capturing",this),Va.apply(void 0,[_n22,"$capture",_i48].concat(t)))return _i48["return"];var _s17=_i48.startRange||this.selection.getFirstRange(),_o9=_s17?_s17.getContainedElement():null,_r5=!!_o9&&Boolean(Ra(_n22,_o9));var _a4=_o9||function(e){if(!e)return null;var t=e.start.parent,i=e.end.parent,n=t.getPath(),s=i.getPath();return n.length>s.length?t:i;}(_s17);if(Ia(_i48,"atTarget",_a4),!_r5){if(Va.apply(void 0,[_n22,"$text",_i48].concat(t)))return _i48["return"];Ia(_i48,"bubbling",_a4);}for(;_a4;){if(_a4.is("rootElement")){if(Va.apply(void 0,[_n22,"$root",_i48].concat(t)))return _i48["return"];}else if(_a4.is("element")&&Va.apply(void 0,[_n22,_a4.name,_i48].concat(t)))return _i48["return"];if(Va.apply(void 0,[_n22,_a4,_i48].concat(t)))return _i48["return"];_a4=_a4.parent,Ia(_i48,"bubbling",_a4);}return Ia(_i48,"bubbling",this),Va.apply(void 0,[_n22,"$document",_i48].concat(t)),_i48["return"];}catch(e){A.rethrowUnexpectedError(e,this);}}},{key:"_addEventListener",value:function _addEventListener(e,t,i){var n=gr(i.context||"$document"),s=Oa(this);var _iterator58=_createForOfIteratorHelper(n),_step58;try{for(_iterator58.s();!(_step58=_iterator58.n()).done;){var _o10=_step58.value;var _n23=s.get(_o10);_n23||(_n23=new(L())(),s.set(_o10,_n23)),this.listenTo(_n23,e,t,i);}}catch(err){_iterator58.e(err);}finally{_iterator58.f();}}},{key:"_removeEventListener",value:function _removeEventListener(e,t){var i=Oa(this);var _iterator59=_createForOfIteratorHelper(i.values()),_step59;try{for(_iterator59.s();!(_step59=_iterator59.n()).done;){var _n24=_step59.value;this.stopListening(_n24,e,t);}}catch(err){_iterator59.e(err);}finally{_iterator59.f();}}}]);}(e);}{var _e125=Sa(Object);["fire","_addEventListener","_removeEventListener"].forEach(function(t){Sa[t]=_e125.prototype[t];});}function Ia(e,t,i){e instanceof Ta&&(e._eventPhase=t,e._currentTarget=i);}function Va(e,t,i){var s="string"==typeof t?e.get(t):Ra(e,t);for(var _len22=arguments.length,n=new Array(_len22>3?_len22-3:0),_key22=3;_key22<_len22;_key22++){n[_key22-3]=arguments[_key22];}return!!s&&(s.fire.apply(s,[i].concat(n)),i.stop.called);}function Ra(e,t){var _iterator60=_createForOfIteratorHelper(e),_step60;try{for(_iterator60.s();!(_step60=_iterator60.n()).done;){var _step60$value=_slicedToArray(_step60.value,2),_i49=_step60$value[0],_n25=_step60$value[1];if("function"==typeof _i49&&_i49(t))return _n25;}}catch(err){_iterator60.e(err);}finally{_iterator60.f();}return null;}function Oa(e){return e[Pa]||(e[Pa]=new Map()),e[Pa];}var Ba=/*#__PURE__*/function(_Sa){function Ba(e){var _this46;_classCallCheck(this,Ba);_this46=_callSuper(this,Ba),_defineProperty(_assertThisInitialized(_this46),"selection",void 0),_defineProperty(_assertThisInitialized(_this46),"roots",void 0),_defineProperty(_assertThisInitialized(_this46),"stylesProcessor",void 0),_defineProperty(_assertThisInitialized(_this46),"_postFixers",new Set()),_this46.selection=new Ea(),_this46.roots=new br({idProperty:"rootName"}),_this46.stylesProcessor=e,_this46.set("isReadOnly",!1),_this46.set("isFocused",!1),_this46.set("isSelecting",!1),_this46.set("isComposing",!1);return _this46;}_inherits(Ba,_Sa);return _createClass(Ba,[{key:"getRoot",value:function getRoot(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"main";return this.roots.get(e);}},{key:"registerPostFixer",value:function registerPostFixer(e){this._postFixers.add(e);}},{key:"destroy",value:function destroy(){this.roots.forEach(function(e){return e.destroy();}),this.stopListening();}},{key:"_callPostFixers",value:function _callPostFixers(e){var t=!1;do{var _iterator61=_createForOfIteratorHelper(this._postFixers),_step61;try{for(_iterator61.s();!(_step61=_iterator61.n()).done;){var _i50=_step61.value;if(t=_i50(e),t)break;}}catch(err){_iterator61.e(err);}finally{_iterator61.f();}}while(t);}}]);}(Sa(Zs()));var Ma=/*#__PURE__*/function(_ga2){function Ma(e,t,i,n){var _this47;_classCallCheck(this,Ma);_this47=_callSuper(this,Ma,[e,t,i,n]),_defineProperty(_assertThisInitialized(_this47),"_priority",10),_defineProperty(_assertThisInitialized(_this47),"_id",null),_defineProperty(_assertThisInitialized(_this47),"_clonesGroup",null),_this47.getFillerOffset=La;return _this47;}_inherits(Ma,_ga2);return _createClass(Ma,[{key:"priority",get:function get(){return this._priority;}},{key:"id",get:function get(){return this._id;}},{key:"getElementsWithSameId",value:function getElementsWithSameId(){if(null===this.id)throw new A("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup);}},{key:"isSimilar",value:function isSimilar(e){return null!==this.id||null!==e.id?this.id===e.id:_superPropGet(Ma,"isSimilar",this,3)([e])&&this.priority==e.priority;}},{key:"_clone",value:function _clone(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var t=_superPropGet(Ma,"_clone",this,3)([e]);return t._priority=this._priority,t._id=this._id,t;}}]);}(ga);_defineProperty(Ma,"DEFAULT_PRIORITY",10);function La(){if(Fa(this))return null;var e=this.parent;for(;e&&e.is("attributeElement");){if(Fa(e)>1)return null;e=e.parent;}return!e||Fa(e)>1?null:this.childCount;}function Fa(e){return Array.from(e.getChildren()).filter(function(e){return!e.is("uiElement");}).length;}Ma.prototype.is=function(e,t){return t?t===this.name&&("attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e):"attributeElement"===e||"view:attributeElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var Na=/*#__PURE__*/function(_ga3){function Na(e,t,i,n){var _this48;_classCallCheck(this,Na);_this48=_callSuper(this,Na,[e,t,i,n]),_this48.getFillerOffset=Da;return _this48;}_inherits(Na,_ga3);return _createClass(Na,[{key:"_insertChild",value:function _insertChild(e,t){if(t&&(t instanceof sa||Array.from(t).length>0))throw new A("view-emptyelement-cannot-add",[this,t]);return 0;}}]);}(ga);function Da(){return null;}Na.prototype.is=function(e,t){return t?t===this.name&&("emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e):"emptyElement"===e||"view:emptyElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var za=/*#__PURE__*/function(_ga4){function za(e,t,i,n){var _this49;_classCallCheck(this,za);_this49=_callSuper(this,za,[e,t,i,n]),_this49.getFillerOffset=$a;return _this49;}_inherits(za,_ga4);return _createClass(za,[{key:"_insertChild",value:function _insertChild(e,t){if(t&&(t instanceof sa||Array.from(t).length>0))throw new A("view-uielement-cannot-add",[this,t]);return 0;}},{key:"render",value:function render(e,t){return this.toDomElement(e);}},{key:"toDomElement",value:function toDomElement(e){var t=e.createElement(this.name);var _iterator62=_createForOfIteratorHelper(this.getAttributeKeys()),_step62;try{for(_iterator62.s();!(_step62=_iterator62.n()).done;){var _e126=_step62.value;t.setAttribute(_e126,this.getAttribute(_e126));}}catch(err){_iterator62.e(err);}finally{_iterator62.f();}return t;}}]);}(ga);function Ha(e){e.document.on("arrowKey",function(t,i){return function(e,t,i){if(t.keyCode==nr.arrowright){var _e127=t.domTarget.ownerDocument.defaultView.getSelection(),_n26=1==_e127.rangeCount&&_e127.getRangeAt(0).collapsed;if(_n26||t.shiftKey){var _t47=_e127.focusNode,_s18=_e127.focusOffset,_o11=i.domPositionToView(_t47,_s18);if(null===_o11)return;var _r6=!1;var _a5=_o11.getLastMatchingPosition(function(e){return e.item.is("uiElement")&&(_r6=!0),!(!e.item.is("uiElement")&&!e.item.is("attributeElement"));});if(_r6){var _t48=i.viewPositionToDom(_a5);_n26?_e127.collapse(_t48.parent,_t48.offset):_e127.extend(_t48.parent,_t48.offset);}}}}(0,i,e.domConverter);},{priority:"low"});}function $a(){return null;}za.prototype.is=function(e,t){return t?t===this.name&&("uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e):"uiElement"===e||"view:uiElement"===e||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var Ua=/*#__PURE__*/function(_ga5){function Ua(e,t,i,n){var _this50;_classCallCheck(this,Ua);_this50=_callSuper(this,Ua,[e,t,i,n]),_this50.getFillerOffset=Wa;return _this50;}_inherits(Ua,_ga5);return _createClass(Ua,[{key:"_insertChild",value:function _insertChild(e,t){if(t&&(t instanceof sa||Array.from(t).length>0))throw new A("view-rawelement-cannot-add",[this,t]);return 0;}},{key:"render",value:function render(e,t){}}]);}(ga);function Wa(){return null;}Ua.prototype.is=function(e,t){return t?t===this.name&&("rawElement"===e||"view:rawElement"===e||"element"===e||"view:element"===e):"rawElement"===e||"view:rawElement"===e||e===this.name||e==="view:"+this.name||"element"===e||"view:element"===e||"node"===e||"view:node"===e;};var ja=/*#__PURE__*/function(_L8){function ja(e,t){var _this51;_classCallCheck(this,ja);_this51=_callSuper(this,ja),_defineProperty(_assertThisInitialized(_this51),"document",void 0),_defineProperty(_assertThisInitialized(_this51),"_children",[]),_defineProperty(_assertThisInitialized(_this51),"_customProperties",new Map()),_this51.document=e,t&&_this51._insertChild(0,t);return _this51;}_inherits(ja,_L8);return _createClass(ja,[{key:Symbol.iterator,value:function value(){return this._children[Symbol.iterator]();}},{key:"childCount",get:function get(){return this._children.length;}},{key:"isEmpty",get:function get(){return 0===this.childCount;}},{key:"root",get:function get(){return this;}},{key:"parent",get:function get(){return null;}},{key:"name",get:function get(){}},{key:"getFillerOffset",get:function get(){}},{key:"getCustomProperty",value:function getCustomProperty(e){return this._customProperties.get(e);}},{key:"getCustomProperties",value:/*#__PURE__*/_regeneratorRuntime().mark(function getCustomProperties(){return _regeneratorRuntime().wrap(function getCustomProperties$(_context11){while(1)switch(_context11.prev=_context11.next){case 0:return _context11.delegateYield(this._customProperties.entries(),"t0",1);case 1:case"end":return _context11.stop();}},getCustomProperties,this);})},{key:"_appendChild",value:function _appendChild(e){return this._insertChild(this.childCount,e);}},{key:"getChild",value:function getChild(e){return this._children[e];}},{key:"getChildIndex",value:function getChildIndex(e){return this._children.indexOf(e);}},{key:"getChildren",value:function getChildren(){return this._children[Symbol.iterator]();}},{key:"_insertChild",value:function _insertChild(e,t){this._fireChange("children",this);var i=0;var n=function(e,t){if("string"==typeof t)return[new oa(e,t)];oo(t)||(t=[t]);return Array.from(t).map(function(t){return"string"==typeof t?new oa(e,t):t instanceof ra?new oa(e,t.data):t;});}(this.document,t);var _iterator63=_createForOfIteratorHelper(n),_step63;try{for(_iterator63.s();!(_step63=_iterator63.n()).done;){var _t49=_step63.value;null!==_t49.parent&&_t49._remove(),_t49.parent=this,this._children.splice(e,0,_t49),e++,i++;}}catch(err){_iterator63.e(err);}finally{_iterator63.f();}return i;}},{key:"_removeChildren",value:function _removeChildren(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;this._fireChange("children",this);for(var _i51=e;_i51<e+t;_i51++)this._children[_i51].parent=null;return this._children.splice(e,t);}},{key:"_fireChange",value:function _fireChange(e,t){this.fire("change:"+e,t);}},{key:"_setCustomProperty",value:function _setCustomProperty(e,t){this._customProperties.set(e,t);}},{key:"_removeCustomProperty",value:function _removeCustomProperty(e){return this._customProperties["delete"](e);}}]);}(L(na));ja.prototype.is=function(e){return"documentFragment"===e||"view:documentFragment"===e;};var qa=/*#__PURE__*/function(){function qa(e){_classCallCheck(this,qa);_defineProperty(this,"document",void 0);_defineProperty(this,"_cloneGroups",new Map());_defineProperty(this,"_slotFactory",null);this.document=e;}return _createClass(qa,[{key:"setSelection",value:function setSelection(){var _this$document$select;(_this$document$select=this.document.selection)._setTo.apply(_this$document$select,arguments);}},{key:"setSelectionFocus",value:function setSelectionFocus(e,t){this.document.selection._setFocus(e,t);}},{key:"createDocumentFragment",value:function createDocumentFragment(e){return new ja(this.document,e);}},{key:"createText",value:function createText(e){return new oa(this.document,e);}},{key:"createAttributeElement",value:function createAttributeElement(e,t){var _n$_unsafeAttributesT;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=new Ma(this.document,e,t);return"number"==typeof i.priority&&(n._priority=i.priority),i.id&&(n._id=i.id),i.renderUnsafeAttributes&&(_n$_unsafeAttributesT=n._unsafeAttributesToRender).push.apply(_n$_unsafeAttributesT,_toConsumableArray(i.renderUnsafeAttributes)),n;}},{key:"createContainerElement",value:function createContainerElement(e,t){var _o$_unsafeAttributesT;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s=null;ei(i)?n=i:s=i;var o=new pa(this.document,e,t,s);return n.renderUnsafeAttributes&&(_o$_unsafeAttributesT=o._unsafeAttributesToRender).push.apply(_o$_unsafeAttributesT,_toConsumableArray(n.renderUnsafeAttributes)),o;}},{key:"createEditableElement",value:function createEditableElement(e,t){var _n$_unsafeAttributesT2;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=new wa(this.document,e,t);return i.renderUnsafeAttributes&&(_n$_unsafeAttributesT2=n._unsafeAttributesToRender).push.apply(_n$_unsafeAttributesT2,_toConsumableArray(i.renderUnsafeAttributes)),n;}},{key:"createEmptyElement",value:function createEmptyElement(e,t){var _n$_unsafeAttributesT3;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=new Na(this.document,e,t);return i.renderUnsafeAttributes&&(_n$_unsafeAttributesT3=n._unsafeAttributesToRender).push.apply(_n$_unsafeAttributesT3,_toConsumableArray(i.renderUnsafeAttributes)),n;}},{key:"createUIElement",value:function createUIElement(e,t,i){var n=new za(this.document,e,t);return i&&(n.render=i),n;}},{key:"createRawElement",value:function createRawElement(e,t,i){var _s$_unsafeAttributesT;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s=new Ua(this.document,e,t);return i&&(s.render=i),n.renderUnsafeAttributes&&(_s$_unsafeAttributesT=s._unsafeAttributesToRender).push.apply(_s$_unsafeAttributesT,_toConsumableArray(n.renderUnsafeAttributes)),s;}},{key:"setAttribute",value:function setAttribute(e,t,i){i._setAttribute(e,t);}},{key:"removeAttribute",value:function removeAttribute(e,t){t._removeAttribute(e);}},{key:"addClass",value:function addClass(e,t){t._addClass(e);}},{key:"removeClass",value:function removeClass(e,t){t._removeClass(e);}},{key:"setStyle",value:function setStyle(e,t,i){ei(e)&&void 0===i?t._setStyle(e):i._setStyle(e,t);}},{key:"removeStyle",value:function removeStyle(e,t){t._removeStyle(e);}},{key:"setCustomProperty",value:function setCustomProperty(e,t,i){i._setCustomProperty(e,t);}},{key:"removeCustomProperty",value:function removeCustomProperty(e,t){return t._removeCustomProperty(e);}},{key:"breakAttributes",value:function breakAttributes(e){return e instanceof ka?this._breakAttributes(e):this._breakAttributesRange(e);}},{key:"breakContainer",value:function breakContainer(e){var t=e.parent;if(!t.is("containerElement"))throw new A("view-writer-break-non-container-element",this.document);if(!t.parent)throw new A("view-writer-break-root",this.document);if(e.isAtStart)return ka._createBefore(t);if(!e.isAtEnd){var _i52=t._clone(!1);this.insert(ka._createAfter(t),_i52);var _n27=new Ca(e,ka._createAt(t,"end")),_s19=new ka(_i52,0);this.move(_n27,_s19);}return ka._createAfter(t);}},{key:"mergeAttributes",value:function mergeAttributes(e){var t=e.offset,i=e.parent;if(i.is("$text"))return e;if(i.is("attributeElement")&&0===i.childCount){var _e128=i.parent,_t50=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new ka(_e128,_t50));}var n=i.getChild(t-1),s=i.getChild(t);if(!n||!s)return e;if(n.is("$text")&&s.is("$text"))return Qa(n,s);if(n.is("attributeElement")&&s.is("attributeElement")&&n.isSimilar(s)){var _e129=n.childCount;return n._appendChild(s.getChildren()),s._remove(),this._removeFromClonedElementsGroup(s),this.mergeAttributes(new ka(n,_e129));}return e;}},{key:"mergeContainers",value:function mergeContainers(e){var t=e.nodeBefore,i=e.nodeAfter;if(!(t&&i&&t.is("containerElement")&&i.is("containerElement")))throw new A("view-writer-merge-containers-invalid-position",this.document);var n=t.getChild(t.childCount-1),s=n instanceof oa?ka._createAt(n,"end"):ka._createAt(t,"end");return this.move(Ca._createIn(i),ka._createAt(t,"end")),this.remove(Ca._createOn(i)),s;}},{key:"insert",value:function insert(e,t){Xa(t=oo(t)?_toConsumableArray(t):[t],this.document);var i=t.reduce(function(e,t){var i=e[e.length-1],n=!t.is("uiElement");return i&&i.breakAttributes==n?i.nodes.push(t):e.push({breakAttributes:n,nodes:[t]}),e;},[]);var n=null,s=e;var _iterator64=_createForOfIteratorHelper(i),_step64;try{for(_iterator64.s();!(_step64=_iterator64.n()).done;){var _step64$value=_step64.value,_e130=_step64$value.nodes,_t51=_step64$value.breakAttributes;var _i53=this._insertNodes(s,_e130,_t51);n||(n=_i53.start),s=_i53.end;}}catch(err){_iterator64.e(err);}finally{_iterator64.f();}return n?new Ca(n,s):new Ca(e);}},{key:"remove",value:function remove(e){var t=e instanceof Ca?e:Ca._createOn(e);if(tl(t,this.document),t.isCollapsed)return new ja(this.document);var _this$_breakAttribute=this._breakAttributesRange(t,!0),i=_this$_breakAttribute.start,n=_this$_breakAttribute.end,s=i.parent,o=n.offset-i.offset,r=s._removeChildren(i.offset,o);var _iterator65=_createForOfIteratorHelper(r),_step65;try{for(_iterator65.s();!(_step65=_iterator65.n()).done;){var _e131=_step65.value;this._removeFromClonedElementsGroup(_e131);}}catch(err){_iterator65.e(err);}finally{_iterator65.f();}var a=this.mergeAttributes(i);return t.start=a,t.end=a.clone(),new ja(this.document,r);}},{key:"clear",value:function clear(e,t){tl(e,this.document);var i=e.getWalker({direction:"backward",ignoreElementEnd:!0});var _iterator66=_createForOfIteratorHelper(i),_step66;try{for(_iterator66.s();!(_step66=_iterator66.n()).done;){var _n28=_step66.value;var _i54=_n28.item;var _s20=void 0;if(_i54.is("element")&&t.isSimilar(_i54))_s20=Ca._createOn(_i54);else if(!_n28.nextPosition.isAfter(e.start)&&_i54.is("$textProxy")){var _e132=_i54.getAncestors().find(function(e){return e.is("element")&&t.isSimilar(e);});_e132&&(_s20=Ca._createIn(_e132));}_s20&&(_s20.end.isAfter(e.end)&&(_s20.end=e.end),_s20.start.isBefore(e.start)&&(_s20.start=e.start),this.remove(_s20));}}catch(err){_iterator66.e(err);}finally{_iterator66.f();}}},{key:"move",value:function move(e,t){var i;if(t.isAfter(e.end)){var _n29=(t=this._breakAttributes(t,!0)).parent,_s21=_n29.childCount;e=this._breakAttributesRange(e,!0),i=this.remove(e),t.offset+=_n29.childCount-_s21;}else i=this.remove(e);return this.insert(t,i);}},{key:"wrap",value:function wrap(e,t){if(!(t instanceof Ma))throw new A("view-writer-wrap-invalid-attribute",this.document);if(tl(e,this.document),e.isCollapsed){var _i55=e.start;_i55.parent.is("element")&&!function(e){return Array.from(e.getChildren()).some(function(e){return!e.is("uiElement");});}(_i55.parent)&&(_i55=_i55.getLastMatchingPosition(function(e){return e.item.is("uiElement");})),_i55=this._wrapPosition(_i55,t);var _n30=this.document.selection;return _n30.isCollapsed&&_n30.getFirstPosition().isEqual(e.start)&&this.setSelection(_i55),new Ca(_i55);}return this._wrapRange(e,t);}},{key:"unwrap",value:function unwrap(e,t){if(!(t instanceof Ma))throw new A("view-writer-unwrap-invalid-attribute",this.document);if(tl(e,this.document),e.isCollapsed)return e;var _this$_breakAttribute2=this._breakAttributesRange(e,!0),i=_this$_breakAttribute2.start,n=_this$_breakAttribute2.end,s=i.parent,o=this._unwrapChildren(s,i.offset,n.offset,t),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;var a=this.mergeAttributes(o.end);return new Ca(r,a);}},{key:"rename",value:function rename(e,t){var i=new pa(this.document,e,t.getAttributes());return this.insert(ka._createAfter(t),i),this.move(Ca._createIn(t),ka._createAt(i,0)),this.remove(Ca._createOn(t)),i;}},{key:"clearClonedElementsGroup",value:function clearClonedElementsGroup(e){this._cloneGroups["delete"](e);}},{key:"createPositionAt",value:function createPositionAt(e,t){return ka._createAt(e,t);}},{key:"createPositionAfter",value:function createPositionAfter(e){return ka._createAfter(e);}},{key:"createPositionBefore",value:function createPositionBefore(e){return ka._createBefore(e);}},{key:"createRange",value:function createRange(e,t){return new Ca(e,t);}},{key:"createRangeOn",value:function createRangeOn(e){return Ca._createOn(e);}},{key:"createRangeIn",value:function createRangeIn(e){return Ca._createIn(e);}},{key:"createSelection",value:function createSelection(){for(var _len23=arguments.length,e=new Array(_len23),_key23=0;_key23<_len23;_key23++){e[_key23]=arguments[_key23];}return _construct(Aa,e);}},{key:"createSlot",value:function createSlot(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"children";if(!this._slotFactory)throw new A("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,e);}},{key:"_registerSlotFactory",value:function _registerSlotFactory(e){this._slotFactory=e;}},{key:"_clearSlotFactory",value:function _clearSlotFactory(){this._slotFactory=null;}},{key:"_insertNodes",value:function _insertNodes(e,t,i){var n,s;if(n=i?Ga(e):e.parent.is("$text")?e.parent.parent:e.parent,!n)throw new A("view-writer-invalid-position-container",this.document);s=i?this._breakAttributes(e,!0):e.parent.is("$text")?Ja(e):e;var o=n._insertChild(s.offset,t);var _iterator67=_createForOfIteratorHelper(t),_step67;try{for(_iterator67.s();!(_step67=_iterator67.n()).done;){var _e133=_step67.value;this._addToClonedElementsGroup(_e133);}}catch(err){_iterator67.e(err);}finally{_iterator67.f();}var r=s.getShiftedBy(o),a=this.mergeAttributes(s);a.isEqual(s)||r.offset--;var l=this.mergeAttributes(r);return new Ca(a,l);}},{key:"_wrapChildren",value:function _wrapChildren(e,t,i,n){var s=t;var o=[];for(;s<i;){var _t52=e.getChild(s),_i56=_t52.is("$text"),_r7=_t52.is("attributeElement");if(_r7&&this._wrapAttributeElement(n,_t52))o.push(new ka(e,s));else if(_i56||!_r7||Ka(n,_t52)){var _i57=n._clone();_t52._remove(),_i57._appendChild(_t52),e._insertChild(s,_i57),this._addToClonedElementsGroup(_i57),o.push(new ka(e,s));}else this._wrapChildren(_t52,0,_t52.childCount,n);s++;}var r=0;for(var _i58=0,_o12=o;_i58<_o12.length;_i58++){var _e134=_o12[_i58];if(_e134.offset-=r,_e134.offset==t)continue;this.mergeAttributes(_e134).isEqual(_e134)||(r++,i--);}return Ca._createFromParentsAndOffsets(e,t,e,i);}},{key:"_unwrapChildren",value:function _unwrapChildren(e,t,i,n){var s=t;var o=[];for(;s<i;){var _t53=e.getChild(s);if(_t53.is("attributeElement")){if(_t53.isSimilar(n)){var _n31=_t53.getChildren(),_r8=_t53.childCount;_t53._remove(),e._insertChild(s,_n31),this._removeFromClonedElementsGroup(_t53),o.push(new ka(e,s),new ka(e,s+_r8)),s+=_r8,i+=_r8-1;}else this._unwrapAttributeElement(n,_t53)?(o.push(new ka(e,s),new ka(e,s+1)),s++):(this._unwrapChildren(_t53,0,_t53.childCount,n),s++);}else s++;}var r=0;for(var _i59=0,_o13=o;_i59<_o13.length;_i59++){var _e135=_o13[_i59];if(_e135.offset-=r,_e135.offset==t||_e135.offset==i)continue;this.mergeAttributes(_e135).isEqual(_e135)||(r++,i--);}return Ca._createFromParentsAndOffsets(e,t,e,i);}},{key:"_wrapRange",value:function _wrapRange(e,t){var _this$_breakAttribute3=this._breakAttributesRange(e,!0),i=_this$_breakAttribute3.start,n=_this$_breakAttribute3.end,s=i.parent,o=this._wrapChildren(s,i.offset,n.offset,t),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;var a=this.mergeAttributes(o.end);return new Ca(r,a);}},{key:"_wrapPosition",value:function _wrapPosition(e,t){if(t.isSimilar(e.parent))return Za(e.clone());e.parent.is("$text")&&(e=Ja(e));var i=this.createAttributeElement("_wrapPosition-fake-element");i._priority=Number.POSITIVE_INFINITY,i.isSimilar=function(){return!1;},e.parent._insertChild(e.offset,i);var n=new Ca(e,e.getShiftedBy(1));this.wrap(n,t);var s=new ka(i.parent,i.index);i._remove();var o=s.nodeBefore,r=s.nodeAfter;return o instanceof oa&&r instanceof oa?Qa(o,r):Za(s);}},{key:"_wrapAttributeElement",value:function _wrapAttributeElement(e,t){if(!il(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;var _iterator68=_createForOfIteratorHelper(e.getAttributeKeys()),_step68;try{for(_iterator68.s();!(_step68=_iterator68.n()).done;){var _i60=_step68.value;if("class"!==_i60&&"style"!==_i60&&t.hasAttribute(_i60)&&t.getAttribute(_i60)!==e.getAttribute(_i60))return!1;}}catch(err){_iterator68.e(err);}finally{_iterator68.f();}var _iterator69=_createForOfIteratorHelper(e.getStyleNames()),_step69;try{for(_iterator69.s();!(_step69=_iterator69.n()).done;){var _i61=_step69.value;if(t.hasStyle(_i61)&&t.getStyle(_i61)!==e.getStyle(_i61))return!1;}}catch(err){_iterator69.e(err);}finally{_iterator69.f();}var _iterator70=_createForOfIteratorHelper(e.getAttributeKeys()),_step70;try{for(_iterator70.s();!(_step70=_iterator70.n()).done;){var _i62=_step70.value;"class"!==_i62&&"style"!==_i62&&(t.hasAttribute(_i62)||this.setAttribute(_i62,e.getAttribute(_i62),t));}}catch(err){_iterator70.e(err);}finally{_iterator70.f();}var _iterator71=_createForOfIteratorHelper(e.getStyleNames()),_step71;try{for(_iterator71.s();!(_step71=_iterator71.n()).done;){var _i63=_step71.value;t.hasStyle(_i63)||this.setStyle(_i63,e.getStyle(_i63),t);}}catch(err){_iterator71.e(err);}finally{_iterator71.f();}var _iterator72=_createForOfIteratorHelper(e.getClassNames()),_step72;try{for(_iterator72.s();!(_step72=_iterator72.n()).done;){var _i64=_step72.value;t.hasClass(_i64)||this.addClass(_i64,t);}}catch(err){_iterator72.e(err);}finally{_iterator72.f();}return!0;}},{key:"_unwrapAttributeElement",value:function _unwrapAttributeElement(e,t){if(!il(e,t))return!1;if(e.name!==t.name||e.priority!==t.priority)return!1;var _iterator73=_createForOfIteratorHelper(e.getAttributeKeys()),_step73;try{for(_iterator73.s();!(_step73=_iterator73.n()).done;){var _i65=_step73.value;if("class"!==_i65&&"style"!==_i65&&(!t.hasAttribute(_i65)||t.getAttribute(_i65)!==e.getAttribute(_i65)))return!1;}}catch(err){_iterator73.e(err);}finally{_iterator73.f();}if(!t.hasClass.apply(t,_toConsumableArray(e.getClassNames())))return!1;var _iterator74=_createForOfIteratorHelper(e.getStyleNames()),_step74;try{for(_iterator74.s();!(_step74=_iterator74.n()).done;){var _i66=_step74.value;if(!t.hasStyle(_i66)||t.getStyle(_i66)!==e.getStyle(_i66))return!1;}}catch(err){_iterator74.e(err);}finally{_iterator74.f();}var _iterator75=_createForOfIteratorHelper(e.getAttributeKeys()),_step75;try{for(_iterator75.s();!(_step75=_iterator75.n()).done;){var _i67=_step75.value;"class"!==_i67&&"style"!==_i67&&this.removeAttribute(_i67,t);}}catch(err){_iterator75.e(err);}finally{_iterator75.f();}return this.removeClass(Array.from(e.getClassNames()),t),this.removeStyle(Array.from(e.getStyleNames()),t),!0;}},{key:"_breakAttributesRange",value:function _breakAttributesRange(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=e.start,n=e.end;if(tl(e,this.document),e.isCollapsed){var _i68=this._breakAttributes(e.start,t);return new Ca(_i68,_i68);}var s=this._breakAttributes(n,t),o=s.parent.childCount,r=this._breakAttributes(i,t);return s.offset+=s.parent.childCount-o,new Ca(r,s);}},{key:"_breakAttributes",value:function _breakAttributes(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=e.offset,n=e.parent;if(e.parent.is("emptyElement"))throw new A("view-writer-cannot-break-empty-element",this.document);if(e.parent.is("uiElement"))throw new A("view-writer-cannot-break-ui-element",this.document);if(e.parent.is("rawElement"))throw new A("view-writer-cannot-break-raw-element",this.document);if(!t&&n.is("$text")&&el(n.parent))return e.clone();if(el(n))return e.clone();if(n.is("$text"))return this._breakAttributes(Ja(e),t);if(i==n.childCount){var _e136=new ka(n.parent,n.index+1);return this._breakAttributes(_e136,t);}if(0===i){var _e137=new ka(n.parent,n.index);return this._breakAttributes(_e137,t);}{var _e138=n.index+1,_s22=n._clone();n.parent._insertChild(_e138,_s22),this._addToClonedElementsGroup(_s22);var _o14=n.childCount-i,_r9=n._removeChildren(i,_o14);_s22._appendChild(_r9);var _a6=new ka(n.parent,_e138);return this._breakAttributes(_a6,t);}}},{key:"_addToClonedElementsGroup",value:function _addToClonedElementsGroup(e){if(!e.root.is("rootElement"))return;if(e.is("element")){var _iterator76=_createForOfIteratorHelper(e.getChildren()),_step76;try{for(_iterator76.s();!(_step76=_iterator76.n()).done;){var _t54=_step76.value;this._addToClonedElementsGroup(_t54);}}catch(err){_iterator76.e(err);}finally{_iterator76.f();}}var t=e.id;if(!t)return;var i=this._cloneGroups.get(t);i||(i=new Set(),this._cloneGroups.set(t,i)),i.add(e),e._clonesGroup=i;}},{key:"_removeFromClonedElementsGroup",value:function _removeFromClonedElementsGroup(e){if(e.is("element")){var _iterator77=_createForOfIteratorHelper(e.getChildren()),_step77;try{for(_iterator77.s();!(_step77=_iterator77.n()).done;){var _t55=_step77.value;this._removeFromClonedElementsGroup(_t55);}}catch(err){_iterator77.e(err);}finally{_iterator77.f();}}var t=e.id;if(!t)return;var i=this._cloneGroups.get(t);i&&i["delete"](e);}}]);}();function Ga(e){var t=e.parent;for(;!el(t);){if(!t)return;t=t.parent;}return t;}function Ka(e,t){return e.priority<t.priority||!(e.priority>t.priority)&&e.getIdentity()<t.getIdentity();}function Za(e){var t=e.nodeBefore;if(t&&t.is("$text"))return new ka(t,t.data.length);var i=e.nodeAfter;return i&&i.is("$text")?new ka(i,0):e;}function Ja(e){if(e.offset==e.parent.data.length)return new ka(e.parent.parent,e.parent.index+1);if(0===e.offset)return new ka(e.parent.parent,e.parent.index);var t=e.parent.data.slice(e.offset);return e.parent._data=e.parent.data.slice(0,e.offset),e.parent.parent._insertChild(e.parent.index+1,new oa(e.root.document,t)),new ka(e.parent.parent,e.parent.index+1);}function Qa(e,t){var i=e.data.length;return e._data+=t.data,t._remove(),new ka(e,i);}var Ya=[oa,Ma,pa,Na,Ua,za];function Xa(e,t){var _iterator78=_createForOfIteratorHelper(e),_step78;try{var _loop=function _loop(){var i=_step78.value;if(!Ya.some(function(e){return i instanceof e;}))throw new A("view-writer-insert-invalid-node-type",t);i.is("$text")||Xa(i.getChildren(),t);};for(_iterator78.s();!(_step78=_iterator78.n()).done;){_loop();}}catch(err){_iterator78.e(err);}finally{_iterator78.f();}}function el(e){return e&&(e.is("containerElement")||e.is("documentFragment"));}function tl(e,t){var i=Ga(e.start),n=Ga(e.end);if(!i||!n||i!==n)throw new A("view-writer-invalid-range-container",t);}function il(e,t){return null===e.id&&null===t.id;}var nl=function nl(e){return e.createTextNode(" ");},sl=function sl(e){var t=e.createElement("span");return t.dataset.ckeFiller="true",t.innerText=" ",t;},ol=function ol(e){var t=e.createElement("br");return t.dataset.ckeFiller="true",t;},rl="⁠".repeat(7);function al(e){return"string"==typeof e?e.substr(0,7)===rl:ko(e)&&e.data.substr(0,7)===rl;}function ll(e){return 7==e.data.length&&al(e);}function cl(e){var t="string"==typeof e?e:e.data;return al(e)?t.slice(7):t;}function dl(e,t){if(t.keyCode==nr.arrowleft){var _e139=t.domTarget.ownerDocument.defaultView.getSelection();if(1==_e139.rangeCount&&_e139.getRangeAt(0).collapsed){var _t56=_e139.getRangeAt(0).startContainer,_i69=_e139.getRangeAt(0).startOffset;al(_t56)&&_i69<=7&&_e139.collapse(_t56,0);}}}var ul=/*#__PURE__*/function(_Zs5){function ul(e,t){var _this52;_classCallCheck(this,ul);_this52=_callSuper(this,ul),_defineProperty(_assertThisInitialized(_this52),"domDocuments",new Set()),_defineProperty(_assertThisInitialized(_this52),"domConverter",void 0),_defineProperty(_assertThisInitialized(_this52),"markedAttributes",new Set()),_defineProperty(_assertThisInitialized(_this52),"markedChildren",new Set()),_defineProperty(_assertThisInitialized(_this52),"markedTexts",new Set()),_defineProperty(_assertThisInitialized(_this52),"selection",void 0),_defineProperty(_assertThisInitialized(_this52),"_inlineFiller",null),_defineProperty(_assertThisInitialized(_this52),"_fakeSelectionContainer",null),_this52.domConverter=e,_this52.selection=t,_this52.set("isFocused",!1),_this52.set("isSelecting",!1),_this52.set("isComposing",!1),o.isBlink&&!o.isAndroid&&_this52.on("change:isSelecting",function(){_this52.isSelecting||_this52.render();});return _this52;}_inherits(ul,_Zs5);return _createClass(ul,[{key:"markToSync",value:function markToSync(e,t){if("text"===e)this.domConverter.mapViewToDom(t.parent)&&this.markedTexts.add(t);else{if(!this.domConverter.mapViewToDom(t))return;if("attributes"===e)this.markedAttributes.add(t);else{if("children"!==e)throw new A("view-renderer-unknown-type",this);this.markedChildren.add(t);}}}},{key:"render",value:function render(){if(this.isComposing&&!o.isAndroid)return;var e=null;var t=!(o.isBlink&&!o.isAndroid)||!this.isSelecting;var _iterator79=_createForOfIteratorHelper(this.markedChildren),_step79;try{for(_iterator79.s();!(_step79=_iterator79.n()).done;){var _e140=_step79.value;this._updateChildrenMappings(_e140);}}catch(err){_iterator79.e(err);}finally{_iterator79.f();}t?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=ka._createBefore(e.parent)));var _iterator80=_createForOfIteratorHelper(this.markedAttributes),_step80;try{for(_iterator80.s();!(_step80=_iterator80.n()).done;){var _e141=_step80.value;this._updateAttrs(_e141);}}catch(err){_iterator80.e(err);}finally{_iterator80.f();}var _iterator81=_createForOfIteratorHelper(this.markedChildren),_step81;try{for(_iterator81.s();!(_step81=_iterator81.n()).done;){var _t58=_step81.value;this._updateChildren(_t58,{inlineFillerPosition:e});}}catch(err){_iterator81.e(err);}finally{_iterator81.f();}var _iterator82=_createForOfIteratorHelper(this.markedTexts),_step82;try{for(_iterator82.s();!(_step82=_iterator82.n()).done;){var _t59=_step82.value;!this.markedChildren.has(_t59.parent)&&this.domConverter.mapViewToDom(_t59.parent)&&this._updateText(_t59,{inlineFillerPosition:e});}}catch(err){_iterator82.e(err);}finally{_iterator82.f();}if(t)if(e){var _t57=this.domConverter.viewPositionToDom(e),_i70=_t57.parent.ownerDocument;al(_t57.parent)?this._inlineFiller=_t57.parent:this._inlineFiller=hl(_i70,_t57.parent,_t57.offset);}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear();}},{key:"_updateChildrenMappings",value:function _updateChildrenMappings(e){var t=this.domConverter.mapViewToDom(e);if(!t)return;var i=Array.from(t.childNodes),n=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),s=this._diffNodeLists(i,n),o=this._findUpdateActions(s,i,n,ml);if(-1!==o.indexOf("update")){var _t60={equal:0,insert:0,"delete":0};var _iterator83=_createForOfIteratorHelper(o),_step83;try{for(_iterator83.s();!(_step83=_iterator83.n()).done;){var _s23=_step83.value;if("update"===_s23){var _s24=_t60.equal+_t60.insert,_o15=_t60.equal+_t60["delete"],_r10=e.getChild(_s24);!_r10||_r10.is("uiElement")||_r10.is("rawElement")||this._updateElementMappings(_r10,i[_o15]),$o(n[_s24]),_t60.equal++;}else _t60[_s23]++;}}catch(err){_iterator83.e(err);}finally{_iterator83.f();}}}},{key:"_updateElementMappings",value:function _updateElementMappings(e,t){this.domConverter.unbindDomElement(t),this.domConverter.bindElements(t,e),this.markedChildren.add(e),this.markedAttributes.add(e);}},{key:"_getInlineFillerPosition",value:function _getInlineFillerPosition(){var e=this.selection.getFirstPosition();return e.parent.is("$text")?ka._createBefore(e.parent):e;}},{key:"_isSelectionInInlineFiller",value:function _isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;var e=this.selection.getFirstPosition(),t=this.domConverter.viewPositionToDom(e);return!!(t&&ko(t.parent)&&al(t.parent));}},{key:"_removeInlineFiller",value:function _removeInlineFiller(){var e=this._inlineFiller;if(!al(e))throw new A("view-renderer-filler-was-lost",this);ll(e)?e.remove():e.data=e.data.substr(7),this._inlineFiller=null;}},{key:"_needsInlineFillerAtSelection",value:function _needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;var e=this.selection.getFirstPosition(),t=e.parent,i=e.offset;if(!this.domConverter.mapViewToDom(t.root))return!1;if(!t.is("element"))return!1;if(!function(e){if("false"==e.getAttribute("contenteditable"))return!1;var t=e.findAncestor(function(e){return e.hasAttribute("contenteditable");});return!t||"true"==t.getAttribute("contenteditable");}(t))return!1;var n=e.nodeBefore,s=e.nodeAfter;return!(n instanceof oa||s instanceof oa)&&!!(i!==t.getFillerOffset()||n&&n.is("element","br"))&&(!o.isAndroid||!n&&!s);}},{key:"_updateText",value:function _updateText(e,t){var i=this.domConverter.findCorrespondingDomText(e);var n=this.domConverter.viewToDom(e).data;var s=t.inlineFillerPosition;s&&s.parent==e.parent&&s.offset==e.index&&(n=rl+n),this._updateTextNode(i,n);}},{key:"_updateAttrs",value:function _updateAttrs(e){var t=this.domConverter.mapViewToDom(e);if(t){var _iterator84=_createForOfIteratorHelper(t.attributes),_step84;try{for(_iterator84.s();!(_step84=_iterator84.n()).done;){var _i71=_step84.value;var _n32=_i71.name;e.hasAttribute(_n32)||this.domConverter.removeDomElementAttribute(t,_n32);}}catch(err){_iterator84.e(err);}finally{_iterator84.f();}var _iterator85=_createForOfIteratorHelper(e.getAttributeKeys()),_step85;try{for(_iterator85.s();!(_step85=_iterator85.n()).done;){var _i72=_step85.value;this.domConverter.setDomElementAttribute(t,_i72,e.getAttribute(_i72),e);}}catch(err){_iterator85.e(err);}finally{_iterator85.f();}}}},{key:"_updateChildren",value:function _updateChildren(e,t){var i=this.domConverter.mapViewToDom(e);if(!i)return;if(o.isAndroid){var _e142=null;for(var _i73=0,_Array$from=Array.from(i.childNodes);_i73<_Array$from.length;_i73++){var _t61=_Array$from[_i73];if(_e142&&ko(_e142)&&ko(_t61)){i.normalize();break;}_e142=_t61;}}var n=t.inlineFillerPosition,s=i.childNodes,r=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));n&&n.parent===e&&hl(i.ownerDocument,r,n.offset);var a=this._diffNodeLists(s,r),l=this._findUpdateActions(a,s,r,gl);var c=0;var d=new Set();var _iterator86=_createForOfIteratorHelper(l),_step86;try{for(_iterator86.s();!(_step86=_iterator86.n()).done;){var _e143=_step86.value;"delete"===_e143?(d.add(s[c]),$o(s[c])):"equal"!==_e143&&"update"!==_e143||c++;}}catch(err){_iterator86.e(err);}finally{_iterator86.f();}c=0;var _iterator87=_createForOfIteratorHelper(l),_step87;try{for(_iterator87.s();!(_step87=_iterator87.n()).done;){var _e144=_step87.value;"insert"===_e144?(Mo(i,c,r[c]),c++):"update"===_e144?(this._updateTextNode(s[c],r[c].data),c++):"equal"===_e144&&(this._markDescendantTextToSync(this.domConverter.domToView(r[c])),c++);}}catch(err){_iterator87.e(err);}finally{_iterator87.f();}var _iterator88=_createForOfIteratorHelper(d),_step88;try{for(_iterator88.s();!(_step88=_iterator88.n()).done;){var _e145=_step88.value;_e145.parentNode||this.domConverter.unbindDomElement(_e145);}}catch(err){_iterator88.e(err);}finally{_iterator88.f();}}},{key:"_diffNodeLists",value:function _diffNodeLists(e,t){return e=function(e,t){var i=Array.from(e);if(0==i.length||!t)return i;var n=i[i.length-1];n==t&&i.pop();return i;}(e,this._fakeSelectionContainer),b(e,t,fl.bind(null,this.domConverter));}},{key:"_findUpdateActions",value:function _findUpdateActions(e,t,i,n){if(-1===e.indexOf("insert")||-1===e.indexOf("delete"))return e;var s=[],o=[],r=[];var a={equal:0,insert:0,"delete":0};var _iterator89=_createForOfIteratorHelper(e),_step89;try{for(_iterator89.s();!(_step89=_iterator89.n()).done;){var _l4=_step89.value;"insert"===_l4?r.push(i[a.equal+a.insert]):"delete"===_l4?o.push(t[a.equal+a["delete"]]):(s=s.concat(b(o,r,n).map(function(e){return"equal"===e?"update":e;})),s.push("equal"),o=[],r=[]),a[_l4]++;}}catch(err){_iterator89.e(err);}finally{_iterator89.f();}return s.concat(b(o,r,n).map(function(e){return"equal"===e?"update":e;}));}},{key:"_updateTextNode",value:function _updateTextNode(e,t){var i=e.data;i!=t&&(o.isAndroid&&this.isComposing&&i.replace(/\u00A0/g," ")==t.replace(/\u00A0/g," ")||this._updateTextNodeInternal(e,t));}},{key:"_updateTextNodeInternal",value:function _updateTextNodeInternal(e,t){var i=g(e.data,t);var _iterator90=_createForOfIteratorHelper(i),_step90;try{for(_iterator90.s();!(_step90=_iterator90.n()).done;){var _t62=_step90.value;"insert"===_t62.type?e.insertData(_t62.index,_t62.values.join("")):e.deleteData(_t62.index,_t62.howMany);}}catch(err){_iterator90.e(err);}finally{_iterator90.f();}}},{key:"_markDescendantTextToSync",value:function _markDescendantTextToSync(e){if(e)if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element")){var _iterator91=_createForOfIteratorHelper(e.getChildren()),_step91;try{for(_iterator91.s();!(_step91=_iterator91.n()).done;){var _t63=_step91.value;this._markDescendantTextToSync(_t63);}}catch(err){_iterator91.e(err);}finally{_iterator91.f();}}}},{key:"_updateSelection",value:function _updateSelection(){if(o.isBlink&&!o.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();var e=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&e&&(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&o.isAndroid||this._updateDomSelection(e));}},{key:"_updateFakeSelection",value:function _updateFakeSelection(e){var t=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(e){var t=e.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t;}(t));var i=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(i,this.selection),!this._fakeSelectionNeedsUpdate(e))return;i.parentElement&&i.parentElement==e||e.appendChild(i),i.textContent=this.selection.fakeSelectionLabel||" ";var n=t.getSelection(),s=t.createRange();n.removeAllRanges(),s.selectNodeContents(i),n.addRange(s);}},{key:"_updateDomSelection",value:function _updateDomSelection(e){var t=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(t))return;var i=this.domConverter.viewPositionToDom(this.selection.anchor),n=this.domConverter.viewPositionToDom(this.selection.focus);t.setBaseAndExtent(i.parent,i.offset,n.parent,n.offset),o.isGecko&&function(e,t){var i=e.parent,n=e.offset;ko(i)&&ll(i)&&(n=Bo(i)+1,i=i.parentNode);if(i.nodeType!=Node.ELEMENT_NODE||n!=i.childNodes.length-1)return;var s=i.childNodes[n];s&&"BR"==s.tagName&&t.addRange(t.getRangeAt(0));}(n,t);}},{key:"_domSelectionNeedsUpdate",value:function _domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;var t=e&&this.domConverter.domSelectionToView(e);return(!t||!this.selection.isEqual(t))&&!(!this.selection.isCollapsed&&this.selection.isSimilar(t));}},{key:"_fakeSelectionNeedsUpdate",value:function _fakeSelectionNeedsUpdate(e){var t=this._fakeSelectionContainer,i=e.ownerDocument.getSelection();return!t||t.parentElement!==e||i.anchorNode!==t&&!t.contains(i.anchorNode)||t.textContent!==this.selection.fakeSelectionLabel;}},{key:"_removeDomSelection",value:function _removeDomSelection(){var _iterator92=_createForOfIteratorHelper(this.domDocuments),_step92;try{for(_iterator92.s();!(_step92=_iterator92.n()).done;){var _e146=_step92.value;var _t64=_e146.getSelection();if(_t64.rangeCount){var _i74=_e146.activeElement,_n33=this.domConverter.mapDomToView(_i74);_i74&&_n33&&_t64.removeAllRanges();}}}catch(err){_iterator92.e(err);}finally{_iterator92.f();}}},{key:"_removeFakeSelection",value:function _removeFakeSelection(){var e=this._fakeSelectionContainer;e&&e.remove();}},{key:"_updateFocus",value:function _updateFocus(){if(this.isFocused){var _e147=this.selection.editableElement;_e147&&this.domConverter.focus(_e147);}}}]);}(Zs());function hl(e,t,i){var n=t instanceof Array?t:t.childNodes,s=n[i];if(ko(s))return s.data=rl+s.data,s;{var _s25=e.createTextNode(rl);return Array.isArray(t)?n.splice(i,0,_s25):Mo(t,i,_s25),_s25;}}function ml(e,t){return uo(e)&&uo(t)&&!ko(e)&&!ko(t)&&!Lo(e)&&!Lo(t)&&e.tagName.toLowerCase()===t.tagName.toLowerCase();}function gl(e,t){return uo(e)&&uo(t)&&ko(e)&&ko(t);}function fl(e,t,i){return t===i||(ko(t)&&ko(i)?t.data===i.data:!(!e.isBlockFiller(t)||!e.isBlockFiller(i)));}var pl=ol(i.document),bl=nl(i.document),wl=sl(i.document),_l="data-ck-unsafe-attribute-",vl="data-ck-unsafe-element";var yl=/*#__PURE__*/function(){function yl(e){var _ref24=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},t=_ref24.blockFillerMode,_ref24$renderingMode=_ref24.renderingMode,n=_ref24$renderingMode===void 0?"editing":_ref24$renderingMode;_classCallCheck(this,yl);_defineProperty(this,"document",void 0);_defineProperty(this,"renderingMode",void 0);_defineProperty(this,"blockFillerMode",void 0);_defineProperty(this,"preElements",void 0);_defineProperty(this,"blockElements",void 0);_defineProperty(this,"inlineObjectElements",void 0);_defineProperty(this,"unsafeElements",void 0);_defineProperty(this,"_domDocument",void 0);_defineProperty(this,"_domToViewMapping",new WeakMap());_defineProperty(this,"_viewToDomMapping",new WeakMap());_defineProperty(this,"_fakeSelectionMapping",new WeakMap());_defineProperty(this,"_rawContentElementMatcher",new aa());_defineProperty(this,"_inlineObjectElementMatcher",new aa());_defineProperty(this,"_elementsWithTemporaryCustomProperties",new Set());this.document=e,this.renderingMode=n,this.blockFillerMode=t||("editing"===n?"br":"nbsp"),this.preElements=["pre","textarea"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument="editing"===this.renderingMode?i.document:i.document.implementation.createHTMLDocument("");}return _createClass(yl,[{key:"bindFakeSelection",value:function bindFakeSelection(e,t){this._fakeSelectionMapping.set(e,new Aa(t));}},{key:"fakeSelectionToView",value:function fakeSelectionToView(e){return this._fakeSelectionMapping.get(e);}},{key:"bindElements",value:function bindElements(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e);}},{key:"unbindDomElement",value:function unbindDomElement(e){var t=this._domToViewMapping.get(e);if(t){this._domToViewMapping["delete"](e),this._viewToDomMapping["delete"](t);var _iterator93=_createForOfIteratorHelper(e.children),_step93;try{for(_iterator93.s();!(_step93=_iterator93.n()).done;){var _t65=_step93.value;this.unbindDomElement(_t65);}}catch(err){_iterator93.e(err);}finally{_iterator93.f();}}}},{key:"bindDocumentFragments",value:function bindDocumentFragments(e,t){this._domToViewMapping.set(e,t),this._viewToDomMapping.set(t,e);}},{key:"shouldRenderAttribute",value:function shouldRenderAttribute(e,t,i){return"data"===this.renderingMode||!(e=e.toLowerCase()).startsWith("on")&&("srcdoc"!==e||!t.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i))&&("img"===i&&("src"===e||"srcset"===e)||"source"===i&&"srcset"===e||!t.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i));}},{key:"setContentOf",value:function setContentOf(e,t){if("data"===this.renderingMode)return void(e.innerHTML=t);var i=new DOMParser().parseFromString(t,"text/html"),n=i.createDocumentFragment(),s=i.body.childNodes;for(;s.length>0;)n.appendChild(s[0]);var o=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT),r=[];var a;for(;a=o.nextNode();)r.push(a);for(var _i75=0,_r11=r;_i75<_r11.length;_i75++){var _e148=_r11[_i75];var _iterator94=_createForOfIteratorHelper(_e148.getAttributeNames()),_step94;try{for(_iterator94.s();!(_step94=_iterator94.n()).done;){var _t67=_step94.value;this.setDomElementAttribute(_e148,_t67,_e148.getAttribute(_t67));}}catch(err){_iterator94.e(err);}finally{_iterator94.f();}var _t66=_e148.tagName.toLowerCase();this._shouldRenameElement(_t66)&&(xl(_t66),_e148.replaceWith(this._createReplacementDomElement(_t66,_e148)));}for(;e.firstChild;)e.firstChild.remove();e.append(n);}},{key:"viewToDom",value:function viewToDom(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(e.is("$text")){var _t68=this._processDataFromViewText(e);return this._domDocument.createTextNode(_t68);}{var _i76=e;if(this.mapViewToDom(_i76)){if(!_i76.getCustomProperty("editingPipeline:doNotReuseOnce"))return this.mapViewToDom(_i76);this._elementsWithTemporaryCustomProperties.add(_i76);}var _n34;if(_i76.is("documentFragment"))_n34=this._domDocument.createDocumentFragment(),t.bind&&this.bindDocumentFragments(_n34,_i76);else{if(_i76.is("uiElement"))return _n34="$comment"===_i76.name?this._domDocument.createComment(_i76.getCustomProperty("$rawContent")):_i76.render(this._domDocument,this),t.bind&&this.bindElements(_n34,_i76),_n34;this._shouldRenameElement(_i76.name)?(xl(_i76.name),_n34=this._createReplacementDomElement(_i76.name)):_n34=_i76.hasAttribute("xmlns")?this._domDocument.createElementNS(_i76.getAttribute("xmlns"),_i76.name):this._domDocument.createElement(_i76.name),_i76.is("rawElement")&&_i76.render(_n34,this),t.bind&&this.bindElements(_n34,_i76);var _iterator95=_createForOfIteratorHelper(_i76.getAttributeKeys()),_step95;try{for(_iterator95.s();!(_step95=_iterator95.n()).done;){var _e149=_step95.value;this.setDomElementAttribute(_n34,_e149,_i76.getAttribute(_e149),_i76);}}catch(err){_iterator95.e(err);}finally{_iterator95.f();}}if(!1!==t.withChildren){var _iterator96=_createForOfIteratorHelper(this.viewChildrenToDom(_i76,t)),_step96;try{for(_iterator96.s();!(_step96=_iterator96.n()).done;){var _e150=_step96.value;_n34 instanceof HTMLTemplateElement?_n34.content.appendChild(_e150):_n34.appendChild(_e150);}}catch(err){_iterator96.e(err);}finally{_iterator96.f();}}return _n34;}}},{key:"setDomElementAttribute",value:function setDomElementAttribute(e,t,i,n){var s=this.shouldRenderAttribute(t,i,e.tagName.toLowerCase())||n&&n.shouldRenderUnsafeAttribute(t);s||E("domconverter-unsafe-attribute-detected",{domElement:e,key:t,value:i}),Fo(t)?(e.hasAttribute(t)&&!s?e.removeAttribute(t):e.hasAttribute(_l+t)&&s&&e.removeAttribute(_l+t),e.setAttribute(s?t:_l+t,i)):E("domconverter-invalid-attribute-detected",{domElement:e,key:t,value:i});}},{key:"removeDomElementAttribute",value:function removeDomElementAttribute(e,t){t!=vl&&(e.removeAttribute(t),e.removeAttribute(_l+t));}},{key:"viewChildrenToDom",value:function viewChildrenToDom(e){var _this53=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var i,n,_iterator97,_step97,_s26,_e151,_e152;return _regeneratorRuntime().wrap(function _callee3$(_context12){while(1)switch(_context12.prev=_context12.next){case 0:i=e.getFillerOffset&&e.getFillerOffset();n=0;_iterator97=_createForOfIteratorHelper(e.getChildren());_context12.prev=3;_iterator97.s();case 5:if((_step97=_iterator97.n()).done){_context12.next=28;break;}_s26=_step97.value;_context12.t0=i===n;if(!_context12.t0){_context12.next=11;break;}_context12.next=11;return _this53._getBlockFiller();case 11:_e151=_s26.is("element")&&!!_s26.getCustomProperty("dataPipeline:transparentRendering")&&!wr(_s26.getAttributes());if(!(_e151&&"data"==_this53.renderingMode)){_context12.next=22;break;}if(!_s26.is("rawElement")){_context12.next=19;break;}_e152=_this53._domDocument.createElement(_s26.name);_s26.render(_e152,_this53);return _context12.delegateYield(_toConsumableArray(_e152.childNodes),"t1",17);case 17:_context12.next=20;break;case 19:return _context12.delegateYield(_this53.viewChildrenToDom(_s26,t),"t2",20);case 20:_context12.next=25;break;case 22:_e151&&E("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:_s26});_context12.next=25;return _this53.viewToDom(_s26,t);case 25:n++;case 26:_context12.next=5;break;case 28:_context12.next=33;break;case 30:_context12.prev=30;_context12.t3=_context12["catch"](3);_iterator97.e(_context12.t3);case 33:_context12.prev=33;_iterator97.f();return _context12.finish(33);case 36:_context12.t4=i===n;if(!_context12.t4){_context12.next=40;break;}_context12.next=40;return _this53._getBlockFiller();case 40:case"end":return _context12.stop();}},_callee3,null,[[3,30,33,36]]);})();}},{key:"viewRangeToDom",value:function viewRangeToDom(e){var t=this.viewPositionToDom(e.start),i=this.viewPositionToDom(e.end),n=this._domDocument.createRange();return n.setStart(t.parent,t.offset),n.setEnd(i.parent,i.offset),n;}},{key:"viewPositionToDom",value:function viewPositionToDom(e){var t=e.parent;if(t.is("$text")){var _i77=this.findCorrespondingDomText(t);if(!_i77)return null;var _n35=e.offset;return al(_i77)&&(_n35+=7),{parent:_i77,offset:_n35};}{var _i78,_n36,_s27;if(0===e.offset){if(_i78=this.mapViewToDom(t),!_i78)return null;_s27=_i78.childNodes[0];}else{var _t69=e.nodeBefore;if(_n36=_t69.is("$text")?this.findCorrespondingDomText(_t69):this.mapViewToDom(_t69),!_n36)return null;_i78=_n36.parentNode,_s27=_n36.nextSibling;}if(ko(_s27)&&al(_s27))return{parent:_s27,offset:7};return{parent:_i78,offset:_n36?Bo(_n36)+1:0};}}},{key:"domToView",value:function domToView(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=[],n=this._domToView(e,t,i),s=n.next().value;return s?(n.next(),this._processDomInlineNodes(null,i,t),s.is("$text")&&0==s.data.length?null:s):null;}},{key:"domChildrenToView",value:function domChildrenToView(e){var _this54=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];return/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var n,_s28,_o16,_r12,_a7;return _regeneratorRuntime().wrap(function _callee4$(_context13){while(1)switch(_context13.prev=_context13.next){case 0:n=[];n=e instanceof HTMLTemplateElement?_toConsumableArray(e.content.childNodes):_toConsumableArray(e.childNodes);_s28=0;case 3:if(!(_s28<n.length)){_context13.next=14;break;}_o16=n[_s28],_r12=_this54._domToView(_o16,t,i),_a7=_r12.next().value;_context13.t0=null!==_a7;if(!_context13.t0){_context13.next=11;break;}_this54._isBlockViewElement(_a7)&&_this54._processDomInlineNodes(e,i,t);_context13.next=10;return _a7;case 10:_r12.next();case 11:_s28++;_context13.next=3;break;case 14:_this54._processDomInlineNodes(e,i,t);case 15:case"end":return _context13.stop();}},_callee4);})();}},{key:"domSelectionToView",value:function domSelectionToView(e){if(function(e){if(!o.isGecko)return!1;if(!e.rangeCount)return!1;var t=e.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t);}catch(e){return!0;}return!1;}(e))return new Aa([]);if(1===e.rangeCount){var _t70=e.getRangeAt(0).startContainer;ko(_t70)&&(_t70=_t70.parentNode);var _i79=this.fakeSelectionToView(_t70);if(_i79)return _i79;}var t=this.isDomSelectionBackward(e),i=[];for(var _t71=0;_t71<e.rangeCount;_t71++){var _n37=e.getRangeAt(_t71),_s29=this.domRangeToView(_n37);_s29&&i.push(_s29);}return new Aa(i,{backward:t});}},{key:"domRangeToView",value:function domRangeToView(e){var t=this.domPositionToView(e.startContainer,e.startOffset),i=this.domPositionToView(e.endContainer,e.endOffset);return t&&i?new Ca(t,i):null;}},{key:"domPositionToView",value:function domPositionToView(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(this.isBlockFiller(e))return this.domPositionToView(e.parentNode,Bo(e));var i=this.mapDomToView(e);if(i&&(i.is("uiElement")||i.is("rawElement")))return ka._createBefore(i);if(ko(e)){if(ll(e))return this.domPositionToView(e.parentNode,Bo(e));var _i80=this.findCorrespondingViewText(e);var _n38=t;return _i80?(al(e)&&(_n38-=7,_n38=_n38<0?0:_n38),new ka(_i80,_n38)):null;}if(0===t){var _t72=this.mapDomToView(e);if(_t72)return new ka(_t72,0);}else{var _i81=e.childNodes[t-1];if(ko(_i81)&&ll(_i81)||_i81&&this.isBlockFiller(_i81))return this.domPositionToView(_i81.parentNode,Bo(_i81));var _n39=ko(_i81)?this.findCorrespondingViewText(_i81):this.mapDomToView(_i81);if(_n39&&_n39.parent)return new ka(_n39.parent,_n39.index+1);}return null;}},{key:"mapDomToView",value:function mapDomToView(e){return this.getHostViewElement(e)||this._domToViewMapping.get(e);}},{key:"findCorrespondingViewText",value:function findCorrespondingViewText(e){if(ll(e))return null;var t=this.getHostViewElement(e);if(t)return t;var i=e.previousSibling;if(i){if(!this.isElement(i))return null;var _e153=this.mapDomToView(i);if(_e153){var _t73=_e153.nextSibling;return _t73 instanceof oa?_t73:null;}}else{var _t74=this.mapDomToView(e.parentNode);if(_t74){var _e154=_t74.getChild(0);return _e154 instanceof oa?_e154:null;}}return null;}},{key:"mapViewToDom",value:function mapViewToDom(e){return this._viewToDomMapping.get(e);}},{key:"findCorrespondingDomText",value:function findCorrespondingDomText(e){var t=e.previousSibling;return t&&this.mapViewToDom(t)?this.mapViewToDom(t).nextSibling:!t&&e.parent&&this.mapViewToDom(e.parent)?this.mapViewToDom(e.parent).childNodes[0]:null;}},{key:"focus",value:function focus(e){var t=this.mapViewToDom(e);if(t&&t.ownerDocument.activeElement!==t){var _i$window2=i.window,_e155=_i$window2.scrollX,_n40=_i$window2.scrollY,_s30=[];kl(t,function(e){var t=e.scrollLeft,i=e.scrollTop;_s30.push([t,i]);}),t.focus(),kl(t,function(e){var _s30$shift=_s30.shift(),_s30$shift2=_slicedToArray(_s30$shift,2),t=_s30$shift2[0],i=_s30$shift2[1];e.scrollLeft=t,e.scrollTop=i;}),i.window.scrollTo(_e155,_n40);}}},{key:"_clearDomSelection",value:function _clearDomSelection(){var e=this.mapViewToDom(this.document.selection.editableElement);if(!e)return;var t=e.ownerDocument.defaultView.getSelection(),i=this.domSelectionToView(t);i&&i.rangeCount>0&&t.removeAllRanges();}},{key:"isElement",value:function isElement(e){return e&&e.nodeType==Node.ELEMENT_NODE;}},{key:"isDocumentFragment",value:function isDocumentFragment(e){return e&&e.nodeType==Node.DOCUMENT_FRAGMENT_NODE;}},{key:"isBlockFiller",value:function isBlockFiller(e){return"br"==this.blockFillerMode?e.isEqualNode(pl):!("BR"!==e.tagName||!Cl(e,this.blockElements)||1!==e.parentNode.childNodes.length)||e.isEqualNode(wl)||function(e,t){var i=e.isEqualNode(bl);return i&&Cl(e,t)&&1===e.parentNode.childNodes.length;}(e,this.blockElements);}},{key:"isDomSelectionBackward",value:function isDomSelectionBackward(e){if(e.isCollapsed)return!1;var t=this._domDocument.createRange();try{t.setStart(e.anchorNode,e.anchorOffset),t.setEnd(e.focusNode,e.focusOffset);}catch(e){return!1;}var i=t.collapsed;return t.detach(),i;}},{key:"getHostViewElement",value:function getHostViewElement(e){var t=wo(e);for(t.pop();t.length;){var _e156=t.pop(),_i82=this._domToViewMapping.get(_e156);if(_i82&&(_i82.is("uiElement")||_i82.is("rawElement")))return _i82;}return null;}},{key:"isDomSelectionCorrect",value:function isDomSelectionCorrect(e){return this._isDomSelectionPositionCorrect(e.anchorNode,e.anchorOffset)&&this._isDomSelectionPositionCorrect(e.focusNode,e.focusOffset);}},{key:"registerRawContentMatcher",value:function registerRawContentMatcher(e){this._rawContentElementMatcher.add(e);}},{key:"registerInlineObjectMatcher",value:function registerInlineObjectMatcher(e){this._inlineObjectElementMatcher.add(e);}},{key:"_clearTemporaryCustomProperties",value:function _clearTemporaryCustomProperties(){var _iterator98=_createForOfIteratorHelper(this._elementsWithTemporaryCustomProperties),_step98;try{for(_iterator98.s();!(_step98=_iterator98.n()).done;){var _e157=_step98.value;_e157._removeCustomProperty("editingPipeline:doNotReuseOnce");}}catch(err){_iterator98.e(err);}finally{_iterator98.f();}this._elementsWithTemporaryCustomProperties.clear();}},{key:"_getBlockFiller",value:function _getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return nl(this._domDocument);case"markedNbsp":return sl(this._domDocument);case"br":return ol(this._domDocument);}}},{key:"_isDomSelectionPositionCorrect",value:function _isDomSelectionPositionCorrect(e,t){if(ko(e)&&al(e)&&t<7)return!1;if(this.isElement(e)&&al(e.childNodes[t]))return!1;var i=this.mapDomToView(e);return!i||!i.is("uiElement")&&!i.is("rawElement");}},{key:"_domToView",value:/*#__PURE__*/_regeneratorRuntime().mark(function _domToView(e,t,i){var n,_t75,_n41,_n42,_s31,_e158,_t76,_s32,_iterator99,_step99,_i83,_iterator100,_step100,_e159;return _regeneratorRuntime().wrap(function _domToView$(_context14){while(1)switch(_context14.prev=_context14.next){case 0:if(!this.isBlockFiller(e)){_context14.next=2;break;}return _context14.abrupt("return",null);case 2:n=this.getHostViewElement(e);if(!n){_context14.next=5;break;}return _context14.abrupt("return",n);case 5:if(!(Lo(e)&&t.skipComments)){_context14.next=7;break;}return _context14.abrupt("return",null);case 7:if(!ko(e)){_context14.next=15;break;}if(!ll(e)){_context14.next=10;break;}return _context14.abrupt("return",null);case 10:_t75=e.data;if(!(""===_t75)){_context14.next=13;break;}return _context14.abrupt("return",null);case 13:_n41=new oa(this.document,_t75);return _context14.abrupt("return",(i.push(_n41),_n41));case 15:_n42=this.mapDomToView(e);if(!_n42){_context14.next=18;break;}return _context14.abrupt("return",(this._isInlineObjectElement(_n42)&&i.push(_n42),_n42));case 18:if(!this.isDocumentFragment(e)){_context14.next=22;break;}_n42=new ja(this.document),t.bind&&this.bindDocumentFragments(e,_n42);_context14.next=29;break;case 22:_n42=this._createViewElement(e,t),t.bind&&this.bindElements(e,_n42);_s31=e.attributes;if(_s31)for(_e158=_s31.length,_t76=0;_t76<_e158;_t76++)_n42._setAttribute(_s31[_t76].name,_s31[_t76].value);if(!this._isViewElementWithRawContent(_n42,t)){_context14.next=27;break;}return _context14.abrupt("return",(_n42._setCustomProperty("$rawContent",e.innerHTML),this._isBlockViewElement(_n42)||i.push(_n42),_n42));case 27:if(!Lo(e)){_context14.next=29;break;}return _context14.abrupt("return",(_n42._setCustomProperty("$rawContent",e.data),_n42));case 29:_context14.next=31;return _n42;case 31:_s32=[];if(!1!==t.withChildren){_iterator99=_createForOfIteratorHelper(this.domChildrenToView(e,t,_s32));try{for(_iterator99.s();!(_step99=_iterator99.n()).done;){_i83=_step99.value;_n42._appendChild(_i83);}}catch(err){_iterator99.e(err);}finally{_iterator99.f();}}if(this._isInlineObjectElement(_n42))i.push(_n42),this._processDomInlineNodes(null,_s32,t);else{_iterator100=_createForOfIteratorHelper(_s32);try{for(_iterator100.s();!(_step100=_iterator100.n()).done;){_e159=_step100.value;i.push(_e159);}}catch(err){_iterator100.e(err);}finally{_iterator100.f();}}case 34:case"end":return _context14.stop();}},_domToView,this);})},{key:"_processDomInlineNodes",value:function _processDomInlineNodes(e,t,i){if(!t.length)return;if(e&&!this.isDocumentFragment(e)&&!this._isBlockDomElement(e))return;var n=!1;for(var _e160=0;_e160<t.length;_e160++){var _s33=t[_e160];if(!_s33.is("$text")){n=!1;continue;}var _o17=void 0,_r13=!1;if(this._isPreFormatted(_s33))_o17=cl(_s33.data);else{_o17=_s33.data.replace(/[ \n\t\r]{1,}/g," "),_r13=/[^\S\u00A0]/.test(_o17.charAt(_o17.length-1));var _a8=_e160>0?t[_e160-1]:null,_l5=_e160+1<t.length?t[_e160+1]:null,_c3=!_a8||_a8.is("element")&&"br"==_a8.name||n,_d2=!_l5&&!al(_s33.data);!1!==i.withChildren&&(_c3&&(_o17=_o17.replace(/^ /,"")),_d2&&(_o17=_o17.replace(/ $/,""))),_o17=cl(_o17),_o17=_o17.replace(/ \u00A0/g,"  ");var _u2=_l5&&_l5.is("element")&&"br"!=_l5.name,_h2=_l5&&_l5.is("$text")&&" "==_l5.data.charAt(0);(/[ \u00A0]\u00A0$/.test(_o17)||!_l5||_u2||_h2)&&(_o17=_o17.replace(/\u00A0$/," ")),(_c3||_a8&&_a8.is("element")&&"br"!=_a8.name)&&(_o17=_o17.replace(/^\u00A0/," "));}0==_o17.length&&_s33.parent?(_s33._remove(),t.splice(_e160,1),_e160--):(_s33._data=_o17,n=_r13);}t.length=0;}},{key:"_processDataFromViewText",value:function _processDataFromViewText(e){var t=e.data;if(this._isPreFormatted(e))return t;if(" "==t.charAt(0)){var _i84=this._getTouchingInlineViewNode(e,!1);!(_i84&&_i84.is("$textProxy")&&this._nodeEndsWithSpace(_i84))&&_i84||(t=" "+t.substr(1));}if(" "==t.charAt(t.length-1)){var _i85=this._getTouchingInlineViewNode(e,!0),_n43=_i85&&_i85.is("$textProxy")&&" "==_i85.data.charAt(0);" "!=t.charAt(t.length-2)&&_i85&&!_n43||(t=t.substr(0,t.length-1)+" ");}return t.replace(/ {2}/g,"  ");}},{key:"_nodeEndsWithSpace",value:function _nodeEndsWithSpace(e){if(this._isPreFormatted(e))return!1;var t=this._processDataFromViewText(e);return" "==t.charAt(t.length-1);}},{key:"_isPreFormatted",value:function _isPreFormatted(e){if(function(e,t){return e.getAncestors().some(function(e){return e.is("element")&&t.includes(e.name);});}(e,this.preElements))return!0;var _iterator101=_createForOfIteratorHelper(e.getAncestors({parentFirst:!0})),_step101;try{for(_iterator101.s();!(_step101=_iterator101.n()).done;){var _t77=_step101.value;if(_t77.is("element")&&_t77.hasStyle("white-space")&&"inherit"!==_t77.getStyle("white-space"))return["pre","pre-wrap","break-spaces"].includes(_t77.getStyle("white-space"));}}catch(err){_iterator101.e(err);}finally{_iterator101.f();}return!1;}},{key:"_getTouchingInlineViewNode",value:function _getTouchingInlineViewNode(e,t){var i=new ya({startPosition:t?ka._createAfter(e):ka._createBefore(e),direction:t?"forward":"backward"});var _iterator102=_createForOfIteratorHelper(i),_step102;try{for(_iterator102.s();!(_step102=_iterator102.n()).done;){var _e161=_step102.value.item;if(_e161.is("$textProxy"))return _e161;if(!_e161.is("element")||!_e161.getCustomProperty("dataPipeline:transparentRendering")){if(_e161.is("element","br"))return null;if(this._isInlineObjectElement(_e161))return _e161;if(_e161.is("containerElement"))return null;}}}catch(err){_iterator102.e(err);}finally{_iterator102.f();}return null;}},{key:"_isBlockDomElement",value:function _isBlockDomElement(e){return this.isElement(e)&&this.blockElements.includes(e.tagName.toLowerCase());}},{key:"_isBlockViewElement",value:function _isBlockViewElement(e){return e.is("element")&&this.blockElements.includes(e.name);}},{key:"_isInlineObjectElement",value:function _isInlineObjectElement(e){return!!e.is("element")&&("br"==e.name||this.inlineObjectElements.includes(e.name)||!!this._inlineObjectElementMatcher.match(e));}},{key:"_createViewElement",value:function _createViewElement(e,t){if(Lo(e))return new za(this.document,"$comment");var i=t.keepOriginalCase?e.tagName:e.tagName.toLowerCase();return new ga(this.document,i);}},{key:"_isViewElementWithRawContent",value:function _isViewElementWithRawContent(e,t){return!1!==t.withChildren&&e.is("element")&&!!this._rawContentElementMatcher.match(e);}},{key:"_shouldRenameElement",value:function _shouldRenameElement(e){var t=e.toLowerCase();return"editing"===this.renderingMode&&this.unsafeElements.includes(t);}},{key:"_createReplacementDomElement",value:function _createReplacementDomElement(e,t){var i=this._domDocument.createElement("span");if(i.setAttribute(vl,e),t){for(;t.firstChild;)i.appendChild(t.firstChild);var _iterator103=_createForOfIteratorHelper(t.getAttributeNames()),_step103;try{for(_iterator103.s();!(_step103=_iterator103.n()).done;){var _e162=_step103.value;i.setAttribute(_e162,t.getAttribute(_e162));}}catch(err){_iterator103.e(err);}finally{_iterator103.f();}}return i;}}]);}();function kl(e,t){var i=e;for(;i;)t(i),i=i.parentElement;}function Cl(e,t){var i=e.parentNode;return!!i&&!!i.tagName&&t.includes(i.tagName.toLowerCase());}function xl(e){"script"===e&&E("domconverter-unsafe-script-element-detected"),"style"===e&&E("domconverter-unsafe-style-element-detected");}var Al=/*#__PURE__*/function(_go2){function Al(e){var _this55;_classCallCheck(this,Al);_this55=_callSuper(this,Al),_defineProperty(_assertThisInitialized(_this55),"view",void 0),_defineProperty(_assertThisInitialized(_this55),"document",void 0),_defineProperty(_assertThisInitialized(_this55),"_isEnabled",!1),_this55.view=e,_this55.document=e.document;return _this55;}_inherits(Al,_go2);return _createClass(Al,[{key:"isEnabled",get:function get(){return this._isEnabled;}},{key:"enable",value:function enable(){this._isEnabled=!0;}},{key:"disable",value:function disable(){this._isEnabled=!1;}},{key:"destroy",value:function destroy(){this.disable(),this.stopListening();}},{key:"checkShouldIgnoreEventFromTarget",value:function checkShouldIgnoreEventFromTarget(e){return e&&3===e.nodeType&&(e=e.parentNode),!(!e||1!==e.nodeType)&&e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *");}}]);}(go());var El=/*#__PURE__*/function(){function El(e,t,i){_classCallCheck(this,El);_defineProperty(this,"view",void 0);_defineProperty(this,"document",void 0);_defineProperty(this,"domEvent",void 0);_defineProperty(this,"domTarget",void 0);this.view=e,this.document=e.document,this.domEvent=t,this.domTarget=t.target,xt(this,i);}return _createClass(El,[{key:"target",get:function get(){return this.view.domConverter.mapDomToView(this.domTarget);}},{key:"preventDefault",value:function preventDefault(){this.domEvent.preventDefault();}},{key:"stopPropagation",value:function stopPropagation(){this.domEvent.stopPropagation();}}]);}();var Tl=/*#__PURE__*/function(_Al2){function Tl(){var _this56;_classCallCheck(this,Tl);for(var _len24=arguments.length,args=new Array(_len24),_key24=0;_key24<_len24;_key24++){args[_key24]=arguments[_key24];}_this56=_callSuper(this,Tl,[].concat(args));_defineProperty(_this56,"useCapture",!1);_defineProperty(_this56,"usePassive",!1);return _this56;}_inherits(Tl,_Al2);return _createClass(Tl,[{key:"observe",value:function observe(e){var _this57=this;("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(function(t){_this57.listenTo(e,t,function(e,t){_this57.isEnabled&&!_this57.checkShouldIgnoreEventFromTarget(t.target)&&_this57.onDomEvent(t);},{useCapture:_this57.useCapture,usePassive:_this57.usePassive});});}},{key:"stopObserving",value:function stopObserving(e){this.stopListening(e);}},{key:"fire",value:function fire(e,t,i){this.isEnabled&&this.document.fire(e,new El(this.view,t,i));}}]);}(Al);var Pl=/*#__PURE__*/function(_Tl2){function Pl(){var _this58;_classCallCheck(this,Pl);for(var _len25=arguments.length,args=new Array(_len25),_key25=0;_key25<_len25;_key25++){args[_key25]=arguments[_key25];}_this58=_callSuper(this,Pl,[].concat(args));_defineProperty(_this58,"domEventType",["keydown","keyup"]);return _this58;}_inherits(Pl,_Tl2);return _createClass(Pl,[{key:"onDomEvent",value:function onDomEvent(e){var t={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return or(this);}};this.fire(e.type,e,t);}}]);}(Tl);var Sl=/*#__PURE__*/function(_Al3){function Sl(e){var _this59;_classCallCheck(this,Sl);_this59=_callSuper(this,Sl,[e]),_defineProperty(_assertThisInitialized(_this59),"_fireSelectionChangeDoneDebounced",void 0),_this59._fireSelectionChangeDoneDebounced=vs(function(e){_this59.document.fire("selectionChangeDone",e);},200);return _this59;}_inherits(Sl,_Al3);return _createClass(Sl,[{key:"observe",value:function observe(){var _this60=this;var e=this.document;e.on("arrowKey",function(t,i){e.selection.isFake&&_this60.isEnabled&&i.preventDefault();},{context:"$capture"}),e.on("arrowKey",function(t,i){e.selection.isFake&&_this60.isEnabled&&_this60._handleSelectionMove(i.keyCode);},{priority:"lowest"});}},{key:"stopObserving",value:function stopObserving(){}},{key:"destroy",value:function destroy(){_superPropGet(Sl,"destroy",this,3)([]),this._fireSelectionChangeDoneDebounced.cancel();}},{key:"_handleSelectionMove",value:function _handleSelectionMove(e){var t=this.document.selection,i=new Aa(t.getRanges(),{backward:t.isBackward,fake:!1});e!=nr.arrowleft&&e!=nr.arrowup||i.setTo(i.getFirstPosition()),e!=nr.arrowright&&e!=nr.arrowdown||i.setTo(i.getLastPosition());var n={oldSelection:t,newSelection:i,domSelection:null};this.document.fire("selectionChange",n),this._fireSelectionChangeDoneDebounced(n);}}]);}(Al);var Il=/*#__PURE__*/function(_Al4){function Il(e){var _this61;_classCallCheck(this,Il);_this61=_callSuper(this,Il,[e]),_defineProperty(_assertThisInitialized(_this61),"domConverter",void 0),_defineProperty(_assertThisInitialized(_this61),"_config",void 0),_defineProperty(_assertThisInitialized(_this61),"_domElements",void 0),_defineProperty(_assertThisInitialized(_this61),"_mutationObserver",void 0),_this61._config={childList:!0,characterData:!0,subtree:!0},_this61.domConverter=e.domConverter,_this61._domElements=new Set(),_this61._mutationObserver=new window.MutationObserver(_this61._onMutations.bind(_assertThisInitialized(_this61)));return _this61;}_inherits(Il,_Al4);return _createClass(Il,[{key:"flush",value:function flush(){this._onMutations(this._mutationObserver.takeRecords());}},{key:"observe",value:function observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config);}},{key:"stopObserving",value:function stopObserving(e){if(this._domElements["delete"](e),this.isEnabled){this._mutationObserver.disconnect();var _iterator104=_createForOfIteratorHelper(this._domElements),_step104;try{for(_iterator104.s();!(_step104=_iterator104.n()).done;){var _e163=_step104.value;this._mutationObserver.observe(_e163,this._config);}}catch(err){_iterator104.e(err);}finally{_iterator104.f();}}}},{key:"enable",value:function enable(){_superPropGet(Il,"enable",this,3)([]);var _iterator105=_createForOfIteratorHelper(this._domElements),_step105;try{for(_iterator105.s();!(_step105=_iterator105.n()).done;){var _e164=_step105.value;this._mutationObserver.observe(_e164,this._config);}}catch(err){_iterator105.e(err);}finally{_iterator105.f();}}},{key:"disable",value:function disable(){_superPropGet(Il,"disable",this,3)([]),this._mutationObserver.disconnect();}},{key:"destroy",value:function destroy(){_superPropGet(Il,"destroy",this,3)([]),this._mutationObserver.disconnect();}},{key:"_onMutations",value:function _onMutations(e){if(0===e.length)return;var t=this.domConverter,i=new Set(),n=new Set();var _iterator106=_createForOfIteratorHelper(e),_step106;try{for(_iterator106.s();!(_step106=_iterator106.n()).done;){var _i86=_step106.value;var _e165=t.mapDomToView(_i86.target);_e165&&(_e165.is("uiElement")||_e165.is("rawElement")||"childList"!==_i86.type||this._isBogusBrMutation(_i86)||n.add(_e165));}}catch(err){_iterator106.e(err);}finally{_iterator106.f();}var _iterator107=_createForOfIteratorHelper(e),_step107;try{for(_iterator107.s();!(_step107=_iterator107.n()).done;){var _s34=_step107.value;var _e166=t.mapDomToView(_s34.target);if((!_e166||!_e166.is("uiElement")&&!_e166.is("rawElement"))&&"characterData"===_s34.type){var _e167=t.findCorrespondingViewText(_s34.target);_e167&&!n.has(_e167.parent)?i.add(_e167):!_e167&&al(_s34.target)&&n.add(t.mapDomToView(_s34.target.parentNode));}}}catch(err){_iterator107.e(err);}finally{_iterator107.f();}var s=[];var _iterator108=_createForOfIteratorHelper(i),_step108;try{for(_iterator108.s();!(_step108=_iterator108.n()).done;){var _e168=_step108.value;s.push({type:"text",node:_e168});}}catch(err){_iterator108.e(err);}finally{_iterator108.f();}var _iterator109=_createForOfIteratorHelper(n),_step109;try{for(_iterator109.s();!(_step109=_iterator109.n()).done;){var _e169=_step109.value;var _i87=t.mapViewToDom(_e169),_n44=Array.from(_e169.getChildren()),_c4=Array.from(t.domChildrenToView(_i87,{withChildren:!1}));o=_n44,r=_c4,l=void 0,(void 0===(l=(a="function"==typeof(a=Vl)?a:void 0)?a(o,r):void 0)?os(o,r,void 0,a):l)||s.push({type:"children",node:_e169});}}catch(err){_iterator109.e(err);}finally{_iterator109.f();}var o,r,a,l;s.length&&this.document.fire("mutations",{mutations:s});}},{key:"_isBogusBrMutation",value:function _isBogusBrMutation(e){var t=null;return null===e.nextSibling&&0===e.removedNodes.length&&1==e.addedNodes.length&&(t=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),t&&t.is("element","br");}}]);}(Al);function Vl(e,t){if(!Array.isArray(e))return e===t||!(!e.is("$text")||!t.is("$text"))&&e.data===t.data;}var Rl=/*#__PURE__*/function(_Tl3){function Rl(e){var _this62;_classCallCheck(this,Rl);_this62=_callSuper(this,Rl,[e]),_defineProperty(_assertThisInitialized(_this62),"_renderTimeoutId",null),_defineProperty(_assertThisInitialized(_this62),"_isFocusChanging",!1),_defineProperty(_assertThisInitialized(_this62),"domEventType",["focus","blur"]),_this62.useCapture=!0;var t=_this62.document;t.on("focus",function(){return _this62._handleFocus();}),t.on("blur",function(e,t){return _this62._handleBlur(t);}),t.on("beforeinput",function(){t.isFocused||_this62._handleFocus();},{priority:"highest"});return _this62;}_inherits(Rl,_Tl3);return _createClass(Rl,[{key:"flush",value:function flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0);}},{key:"onDomEvent",value:function onDomEvent(e){this.fire(e.type,e);}},{key:"destroy",value:function destroy(){this._clearTimeout(),_superPropGet(Rl,"destroy",this,3)([]);}},{key:"_handleFocus",value:function _handleFocus(){var _this63=this;this._clearTimeout(),this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(function(){_this63._renderTimeoutId=null,_this63.flush(),_this63.view.change(function(){});},50);}},{key:"_handleBlur",value:function _handleBlur(e){var t=this.document.selection.editableElement;null!==t&&t!==e.target||(this.document.isFocused=!1,this._isFocusChanging=!1,this.view.change(function(){}));}},{key:"_clearTimeout",value:function _clearTimeout(){this._renderTimeoutId&&(clearTimeout(this._renderTimeoutId),this._renderTimeoutId=null);}}]);}(Tl);var Ol=/*#__PURE__*/function(_Al5){function Ol(e){var _this64;_classCallCheck(this,Ol);_this64=_callSuper(this,Ol,[e]),_defineProperty(_assertThisInitialized(_this64),"mutationObserver",void 0),_defineProperty(_assertThisInitialized(_this64),"focusObserver",void 0),_defineProperty(_assertThisInitialized(_this64),"selection",void 0),_defineProperty(_assertThisInitialized(_this64),"domConverter",void 0),_defineProperty(_assertThisInitialized(_this64),"_documents",void 0),_defineProperty(_assertThisInitialized(_this64),"_fireSelectionChangeDoneDebounced",void 0),_defineProperty(_assertThisInitialized(_this64),"_clearInfiniteLoopInterval",void 0),_defineProperty(_assertThisInitialized(_this64),"_documentIsSelectingInactivityTimeoutDebounced",void 0),_defineProperty(_assertThisInitialized(_this64),"_loopbackCounter",void 0),_this64.mutationObserver=e.getObserver(Il),_this64.focusObserver=e.getObserver(Rl),_this64.selection=_this64.document.selection,_this64.domConverter=e.domConverter,_this64._documents=new WeakSet(),_this64._fireSelectionChangeDoneDebounced=vs(function(e){_this64.document.fire("selectionChangeDone",e);},200),_this64._clearInfiniteLoopInterval=setInterval(function(){return _this64._clearInfiniteLoop();},1e3),_this64._documentIsSelectingInactivityTimeoutDebounced=vs(function(){return _this64.document.isSelecting=!1;},5e3),_this64._loopbackCounter=0;return _this64;}_inherits(Ol,_Al5);return _createClass(Ol,[{key:"observe",value:function observe(e){var _this65=this;var t=e.ownerDocument,i=function i(){_this65.document.isSelecting&&(_this65._handleSelectionChange(t),_this65.document.isSelecting=!1,_this65._documentIsSelectingInactivityTimeoutDebounced.cancel());};this.listenTo(e,"selectstart",function(){_this65.document.isSelecting=!0,_this65._documentIsSelectingInactivityTimeoutDebounced();},{priority:"highest"}),this.listenTo(e,"keydown",i,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",i,{priority:"highest",useCapture:!0}),this._documents.has(t)||(this.listenTo(t,"mouseup",i,{priority:"highest",useCapture:!0}),this.listenTo(t,"selectionchange",function(){_this65.document.isComposing&&!o.isAndroid||(_this65._handleSelectionChange(t),_this65._documentIsSelectingInactivityTimeoutDebounced());}),this.listenTo(this.view.document,"compositionstart",function(){_this65._handleSelectionChange(t);},{priority:"lowest"}),this._documents.add(t));}},{key:"stopObserving",value:function stopObserving(e){this.stopListening(e);}},{key:"destroy",value:function destroy(){_superPropGet(Ol,"destroy",this,3)([]),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel();}},{key:"_reportInfiniteLoop",value:function _reportInfiniteLoop(){}},{key:"_handleSelectionChange",value:function _handleSelectionChange(e){if(!this.isEnabled)return;var t=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(t.anchorNode))return;this.mutationObserver.flush();var i=this.domConverter.domSelectionToView(t);if(0!=i.rangeCount){if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!this.selection.isEqual(i)||!this.domConverter.isDomSelectionCorrect(t))if(++this._loopbackCounter>60)this._reportInfiniteLoop();else if(this.selection.isSimilar(i))this.view.forceRender();else{var _e170={oldSelection:this.selection,newSelection:i,domSelection:t};this.document.fire("selectionChange",_e170),this._fireSelectionChangeDoneDebounced(_e170);}}else this.view.hasDomSelection=!1;}},{key:"_clearInfiniteLoop",value:function _clearInfiniteLoop(){this._loopbackCounter=0;}}]);}(Al);var Bl=/*#__PURE__*/function(_Tl4){function Bl(e){var _this66;_classCallCheck(this,Bl);_this66=_callSuper(this,Bl,[e]);_defineProperty(_this66,"domEventType",["compositionstart","compositionupdate","compositionend"]);var t=_this66.document;t.on("compositionstart",function(){t.isComposing=!0;},{priority:"low"}),t.on("compositionend",function(){t.isComposing=!1;},{priority:"low"});return _this66;}_inherits(Bl,_Tl4);return _createClass(Bl,[{key:"onDomEvent",value:function onDomEvent(e){this.fire(e.type,e,{data:e.data});}}]);}(Tl);var Ml=/*#__PURE__*/function(){function Ml(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Ml);_defineProperty(this,"_files",void 0);_defineProperty(this,"_native",void 0);this._files=t.cacheFiles?Ll(e):null,this._native=e;}return _createClass(Ml,[{key:"files",get:function get(){return this._files||(this._files=Ll(this._native)),this._files;}},{key:"types",get:function get(){return this._native.types;}},{key:"getData",value:function getData(e){return this._native.getData(e);}},{key:"setData",value:function setData(e,t){this._native.setData(e,t);}},{key:"effectAllowed",get:function get(){return this._native.effectAllowed;},set:function set(e){this._native.effectAllowed=e;}},{key:"dropEffect",get:function get(){return this._native.dropEffect;},set:function set(e){this._native.dropEffect=e;}},{key:"setDragImage",value:function setDragImage(e,t,i){this._native.setDragImage(e,t,i);}},{key:"isCanceled",get:function get(){return"none"==this._native.dropEffect||!!this._native.mozUserCancelled;}}]);}();function Ll(e){var t=Array.from(e.files||[]),i=Array.from(e.items||[]);return t.length?t:i.filter(function(e){return"file"===e.kind;}).map(function(e){return e.getAsFile();});}var Fl=/*#__PURE__*/function(_Tl5){function Fl(){var _this67;_classCallCheck(this,Fl);for(var _len26=arguments.length,args=new Array(_len26),_key26=0;_key26<_len26;_key26++){args[_key26]=arguments[_key26];}_this67=_callSuper(this,Fl,[].concat(args));_defineProperty(_this67,"domEventType","beforeinput");return _this67;}_inherits(Fl,_Tl5);return _createClass(Fl,[{key:"onDomEvent",value:function onDomEvent(e){var t=e.getTargetRanges(),i=this.view,n=i.document;var s=null,r=null,a=[];if(e.dataTransfer&&(s=new Ml(e.dataTransfer)),null!==e.data?r=e.data:s&&(r=s.getData("text/plain")),n.selection.isFake)a=Array.from(n.selection.getRanges());else if(t.length)a=t.map(function(e){var t=i.domConverter.domPositionToView(e.startContainer,e.startOffset),n=i.domConverter.domPositionToView(e.endContainer,e.endOffset);return t?i.createRange(t,n):n?i.createRange(n):void 0;}).filter(function(e){return!!e;});else if(o.isAndroid){var _t78=e.target.ownerDocument.defaultView.getSelection();a=Array.from(i.domConverter.domSelectionToView(_t78).getRanges());}if(o.isAndroid&&"insertCompositionText"==e.inputType&&r&&r.endsWith("\n"))this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[i.createRange(a[0].end)]});else if("insertText"==e.inputType&&r&&r.includes("\n")){var _t79=r.split(/\n{1,2}/g);var _i88=a;for(var _o18=0;_o18<_t79.length;_o18++){var _r14=_t79[_o18];""!=_r14&&(this.fire(e.type,e,{data:_r14,dataTransfer:s,targetRanges:_i88,inputType:e.inputType,isComposing:e.isComposing}),_i88=[n.selection.getFirstRange()]),_o18+1<_t79.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:_i88}),_i88=[n.selection.getFirstRange()]);}}else this.fire(e.type,e,{data:r,dataTransfer:s,targetRanges:a,inputType:e.inputType,isComposing:e.isComposing});}}]);}(Tl);var Nl=/*#__PURE__*/function(_Al6){function Nl(e){var _this68;_classCallCheck(this,Nl);_this68=_callSuper(this,Nl,[e]),_this68.document.on("keydown",function(e,t){if(_this68.isEnabled&&lr(t.keyCode)){var _i89=new Ta(_this68.document,"arrowKey",_this68.document.selection.getFirstRange());_this68.document.fire(_i89,t),_i89.stop.called&&e.stop();}});return _this68;}_inherits(Nl,_Al6);return _createClass(Nl,[{key:"observe",value:function observe(){}},{key:"stopObserving",value:function stopObserving(){}}]);}(Al);var Dl=/*#__PURE__*/function(_Al7){function Dl(e){var _this69;_classCallCheck(this,Dl);_this69=_callSuper(this,Dl,[e]);var t=_this69.document;t.on("keydown",function(e,i){if(!_this69.isEnabled||i.keyCode!=nr.tab||i.ctrlKey)return;var n=new Ta(t,"tab",t.selection.getFirstRange());t.fire(n,i),n.stop.called&&e.stop();});return _this69;}_inherits(Dl,_Al7);return _createClass(Dl,[{key:"observe",value:function observe(){}},{key:"stopObserving",value:function stopObserving(){}}]);}(Al);var zl=/*#__PURE__*/function(_Zs6){function zl(e){var _this70;_classCallCheck(this,zl);_this70=_callSuper(this,zl),_defineProperty(_assertThisInitialized(_this70),"document",void 0),_defineProperty(_assertThisInitialized(_this70),"domConverter",void 0),_defineProperty(_assertThisInitialized(_this70),"domRoots",new Map()),_defineProperty(_assertThisInitialized(_this70),"_renderer",void 0),_defineProperty(_assertThisInitialized(_this70),"_initialDomRootAttributes",new WeakMap()),_defineProperty(_assertThisInitialized(_this70),"_observers",new Map()),_defineProperty(_assertThisInitialized(_this70),"_writer",void 0),_defineProperty(_assertThisInitialized(_this70),"_ongoingChange",!1),_defineProperty(_assertThisInitialized(_this70),"_postFixersInProgress",!1),_defineProperty(_assertThisInitialized(_this70),"_renderingDisabled",!1),_defineProperty(_assertThisInitialized(_this70),"_hasChangedSinceTheLastRendering",!1),_this70.document=new Ba(e),_this70.domConverter=new yl(_this70.document),_this70.set("isRenderingInProgress",!1),_this70.set("hasDomSelection",!1),_this70._renderer=new ul(_this70.domConverter,_this70.document.selection),_this70._renderer.bind("isFocused","isSelecting","isComposing").to(_this70.document,"isFocused","isSelecting","isComposing"),_this70._writer=new qa(_this70.document),_this70.addObserver(Il),_this70.addObserver(Rl),_this70.addObserver(Ol),_this70.addObserver(Pl),_this70.addObserver(Sl),_this70.addObserver(Bl),_this70.addObserver(Nl),_this70.addObserver(Fl),_this70.addObserver(Dl),_this70.document.on("arrowKey",dl,{priority:"low"}),Ha(_assertThisInitialized(_this70)),_this70.on("render",function(){_this70._render(),_this70.document.fire("layoutChanged"),_this70._hasChangedSinceTheLastRendering=!1;}),_this70.listenTo(_this70.document.selection,"change",function(){_this70._hasChangedSinceTheLastRendering=!0;}),_this70.listenTo(_this70.document,"change:isFocused",function(){_this70._hasChangedSinceTheLastRendering=!0;}),o.isiOS&&_this70.listenTo(_this70.document,"blur",function(e,t){_this70.domConverter.mapDomToView(t.domEvent.relatedTarget)||_this70.domConverter._clearDomSelection();}),_this70.listenTo(_this70.document,"mutations",function(e,_ref25){var t=_ref25.mutations;t.forEach(function(e){return _this70._renderer.markToSync(e.type,e.node);});},{priority:"low"}),_this70.listenTo(_this70.document,"mutations",function(){_this70.forceRender();},{priority:"lowest"});return _this70;}_inherits(zl,_Zs6);return _createClass(zl,[{key:"attachDomRoot",value:function attachDomRoot(e){var _this71=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"main";var i=this.document.getRoot(t);i._name=e.tagName.toLowerCase();var n={};for(var _i90=0,_Array$from2=Array.from(e.attributes);_i90<_Array$from2.length;_i90++){var _Array$from2$_i=_Array$from2[_i90],_t80=_Array$from2$_i.name,_s35=_Array$from2$_i.value;n[_t80]=_s35,"class"===_t80?this._writer.addClass(_s35.split(" "),i):i.hasAttribute(_t80)||this._writer.setAttribute(_t80,_s35,i);}this._initialDomRootAttributes.set(e,n);var s=function s(){_this71._writer.setAttribute("contenteditable",(!i.isReadOnly).toString(),i),i.isReadOnly?_this71._writer.addClass("ck-read-only",i):_this71._writer.removeClass("ck-read-only",i);};s(),this.domRoots.set(t,e),this.domConverter.bindElements(e,i),this._renderer.markToSync("children",i),this._renderer.markToSync("attributes",i),this._renderer.domDocuments.add(e.ownerDocument),i.on("change:children",function(e,t){return _this71._renderer.markToSync("children",t);}),i.on("change:attributes",function(e,t){return _this71._renderer.markToSync("attributes",t);}),i.on("change:text",function(e,t){return _this71._renderer.markToSync("text",t);}),i.on("change:isReadOnly",function(){return _this71.change(s);}),i.on("change",function(){_this71._hasChangedSinceTheLastRendering=!0;});var _iterator110=_createForOfIteratorHelper(this._observers.values()),_step110;try{for(_iterator110.s();!(_step110=_iterator110.n()).done;){var _i91=_step110.value;_i91.observe(e,t);}}catch(err){_iterator110.e(err);}finally{_iterator110.f();}}},{key:"detachDomRoot",value:function detachDomRoot(e){var t=this.domRoots.get(e);Array.from(t.attributes).forEach(function(_ref26){var e=_ref26.name;return t.removeAttribute(e);});var i=this._initialDomRootAttributes.get(t);for(var _e171 in i)t.setAttribute(_e171,i[_e171]);this.domRoots["delete"](e),this.domConverter.unbindDomElement(t);var _iterator111=_createForOfIteratorHelper(this._observers.values()),_step111;try{for(_iterator111.s();!(_step111=_iterator111.n()).done;){var _e172=_step111.value;_e172.stopObserving(t);}}catch(err){_iterator111.e(err);}finally{_iterator111.f();}}},{key:"getDomRoot",value:function getDomRoot(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"main";return this.domRoots.get(e);}},{key:"addObserver",value:function addObserver(e){var t=this._observers.get(e);if(t)return t;t=new e(this),this._observers.set(e,t);var _iterator112=_createForOfIteratorHelper(this.domRoots),_step112;try{for(_iterator112.s();!(_step112=_iterator112.n()).done;){var _step112$value=_slicedToArray(_step112.value,2),_e173=_step112$value[0],_i92=_step112$value[1];t.observe(_i92,_e173);}}catch(err){_iterator112.e(err);}finally{_iterator112.f();}return t.enable(),t;}},{key:"getObserver",value:function getObserver(e){return this._observers.get(e);}},{key:"disableObservers",value:function disableObservers(){var _iterator113=_createForOfIteratorHelper(this._observers.values()),_step113;try{for(_iterator113.s();!(_step113=_iterator113.n()).done;){var _e174=_step113.value;_e174.disable();}}catch(err){_iterator113.e(err);}finally{_iterator113.f();}}},{key:"enableObservers",value:function enableObservers(){var _iterator114=_createForOfIteratorHelper(this._observers.values()),_step114;try{for(_iterator114.s();!(_step114=_iterator114.n()).done;){var _e175=_step114.value;_e175.enable();}}catch(err){_iterator114.e(err);}finally{_iterator114.f();}}},{key:"scrollToTheSelection",value:function scrollToTheSelection(){var _ref27=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=_ref27.alignToTop,t=_ref27.forceScroll,_ref27$viewportOffset=_ref27.viewportOffset,i=_ref27$viewportOffset===void 0?20:_ref27$viewportOffset,_ref27$ancestorOffset=_ref27.ancestorOffset,n=_ref27$ancestorOffset===void 0?20:_ref27$ancestorOffset;var s=this.document.selection.getFirstRange();if(!s)return;var o=Un({alignToTop:e,forceScroll:t,viewportOffset:i,ancestorOffset:n});"number"==typeof i&&(i={top:i,bottom:i,left:i,right:i});var r={target:this.domConverter.viewRangeToDom(s),viewportOffset:i,ancestorOffset:n,alignToTop:e,forceScroll:t};this.fire("scrollToTheSelection",r,o),Uo(r);}},{key:"focus",value:function focus(){if(!this.document.isFocused){var _e176=this.document.selection.editableElement;_e176&&(this.domConverter.focus(_e176),this.forceRender());}}},{key:"change",value:function change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new A("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;var _t81=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),_t81;}catch(e){A.rethrowUnexpectedError(e,this);}}},{key:"forceRender",value:function forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(Rl).flush(),this.change(function(){});}},{key:"destroy",value:function destroy(){var _iterator115=_createForOfIteratorHelper(this._observers.values()),_step115;try{for(_iterator115.s();!(_step115=_iterator115.n()).done;){var _e177=_step115.value;_e177.destroy();}}catch(err){_iterator115.e(err);}finally{_iterator115.f();}this.document.destroy(),this.stopListening();}},{key:"createPositionAt",value:function createPositionAt(e,t){return ka._createAt(e,t);}},{key:"createPositionAfter",value:function createPositionAfter(e){return ka._createAfter(e);}},{key:"createPositionBefore",value:function createPositionBefore(e){return ka._createBefore(e);}},{key:"createRange",value:function createRange(e,t){return new Ca(e,t);}},{key:"createRangeOn",value:function createRangeOn(e){return Ca._createOn(e);}},{key:"createRangeIn",value:function createRangeIn(e){return Ca._createIn(e);}},{key:"createSelection",value:function createSelection(){for(var _len27=arguments.length,e=new Array(_len27),_key27=0;_key27<_len27;_key27++){e[_key27]=arguments[_key27];}return _construct(Aa,e);}},{key:"_disableRendering",value:function _disableRendering(e){this._renderingDisabled=e,0==e&&this.change(function(){});}},{key:"_render",value:function _render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1;}}]);}(Zs());var Hl=/*#__PURE__*/function(){function Hl(){_classCallCheck(this,Hl);}return _createClass(Hl,[{key:"is",value:function is(){throw new Error("is() method is abstract");}}]);}();var $l=/*#__PURE__*/function(_Hl){function $l(e){var _this72;_classCallCheck(this,$l);_this72=_callSuper(this,$l),_defineProperty(_assertThisInitialized(_this72),"parent",null),_defineProperty(_assertThisInitialized(_this72),"_attrs",void 0),_defineProperty(_assertThisInitialized(_this72),"_index",null),_defineProperty(_assertThisInitialized(_this72),"_startOffset",null),_this72._attrs=xr(e);return _this72;}_inherits($l,_Hl);return _createClass($l,[{key:"document",get:function get(){return null;}},{key:"index",get:function get(){return this._index;}},{key:"startOffset",get:function get(){return this._startOffset;}},{key:"offsetSize",get:function get(){return 1;}},{key:"endOffset",get:function get(){return null===this.startOffset?null:this.startOffset+this.offsetSize;}},{key:"nextSibling",get:function get(){var e=this.index;return null!==e&&this.parent.getChild(e+1)||null;}},{key:"previousSibling",get:function get(){var e=this.index;return null!==e&&this.parent.getChild(e-1)||null;}},{key:"root",get:function get(){var e=this;for(;e.parent;)e=e.parent;return e;}},{key:"isAttached",value:function isAttached(){return null!==this.parent&&this.root.isAttached();}},{key:"getPath",value:function getPath(){var e=[];var t=this;for(;t.parent;)e.unshift(t.startOffset),t=t.parent;return e;}},{key:"getAncestors",value:function getAncestors(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=[];var i=e.includeSelf?this:this.parent;for(;i;)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t;}},{key:"getCommonAncestor",value:function getCommonAncestor(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.getAncestors(t),n=e.getAncestors(t);var s=0;for(;i[s]==n[s]&&i[s];)s++;return 0===s?null:i[s-1];}},{key:"isBefore",value:function isBefore(e){if(this==e)return!1;if(this.root!==e.root)return!1;var t=this.getPath(),i=e.getPath(),n=so(t,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return t[n]<i[n];}}},{key:"isAfter",value:function isAfter(e){return this!=e&&this.root===e.root&&!this.isBefore(e);}},{key:"hasAttribute",value:function hasAttribute(e){return this._attrs.has(e);}},{key:"getAttribute",value:function getAttribute(e){return this._attrs.get(e);}},{key:"getAttributes",value:function getAttributes(){return this._attrs.entries();}},{key:"getAttributeKeys",value:function getAttributeKeys(){return this._attrs.keys();}},{key:"toJSON",value:function toJSON(){var e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce(function(e,t){return e[t[0]]=t[1],e;},{})),e;}},{key:"_clone",value:function _clone(e){return new this.constructor(this._attrs);}},{key:"_remove",value:function _remove(){this.parent._removeChildren(this.index);}},{key:"_setAttribute",value:function _setAttribute(e,t){this._attrs.set(e,t);}},{key:"_setAttributesTo",value:function _setAttributesTo(e){this._attrs=xr(e);}},{key:"_removeAttribute",value:function _removeAttribute(e){return this._attrs["delete"](e);}},{key:"_clearAttributes",value:function _clearAttributes(){this._attrs.clear();}}]);}(Hl);$l.prototype.is=function(e){return"node"===e||"model:node"===e;};var Ul=/*#__PURE__*/function(){function Ul(e){_classCallCheck(this,Ul);_defineProperty(this,"_nodes",[]);_defineProperty(this,"_offsetToNode",[]);e&&this._insertNodes(0,e);}return _createClass(Ul,[{key:Symbol.iterator,value:function value(){return this._nodes[Symbol.iterator]();}},{key:"length",get:function get(){return this._nodes.length;}},{key:"maxOffset",get:function get(){return this._offsetToNode.length;}},{key:"getNode",value:function getNode(e){return this._nodes[e]||null;}},{key:"getNodeAtOffset",value:function getNodeAtOffset(e){return this._offsetToNode[e]||null;}},{key:"getNodeIndex",value:function getNodeIndex(e){return e.index;}},{key:"getNodeStartOffset",value:function getNodeStartOffset(e){return e.startOffset;}},{key:"indexToOffset",value:function indexToOffset(e){if(e==this._nodes.length)return this.maxOffset;var t=this._nodes[e];if(!t)throw new A("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(t);}},{key:"offsetToIndex",value:function offsetToIndex(e){if(e==this._offsetToNode.length)return this._nodes.length;var t=this._offsetToNode[e];if(!t)throw new A("model-nodelist-offset-out-of-bounds",this,{offset:e,nodeList:this});return this.getNodeIndex(t);}},{key:"_insertNodes",value:function _insertNodes(e,t){var _iterator116=_createForOfIteratorHelper(t),_step116;try{for(_iterator116.s();!(_step116=_iterator116.n()).done;){var _e179=_step116.value;if(!(_e179 instanceof $l))throw new A("model-nodelist-insertnodes-not-node",this);}}catch(err){_iterator116.e(err);}finally{_iterator116.f();}var i=Array.from(t),n=function(e){var t=[];var _iterator117=_createForOfIteratorHelper(e),_step117;try{for(_iterator117.s();!(_step117=_iterator117.n()).done;){var _i93=_step117.value;var _e178=t.length;t.length+=_i93.offsetSize,t.fill(_i93,_e178);}}catch(err){_iterator117.e(err);}finally{_iterator117.f();}return t;}(i);var s=this.indexToOffset(e);this._nodes=Pr(this._nodes,i,e,0),this._offsetToNode=Pr(this._offsetToNode,n,s,0);for(var _t82=e;_t82<this._nodes.length;_t82++)this._nodes[_t82]._index=_t82,this._nodes[_t82]._startOffset=s,s+=this._nodes[_t82].offsetSize;}},{key:"_removeNodes",value:function _removeNodes(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;if(0==t)return[];var i=this.indexToOffset(e);var n=this._nodes.splice(e,t),s=n[n.length-1],o=s.startOffset+s.offsetSize-i;this._offsetToNode.splice(i,o);var _iterator118=_createForOfIteratorHelper(n),_step118;try{for(_iterator118.s();!(_step118=_iterator118.n()).done;){var _e180=_step118.value;_e180._index=null,_e180._startOffset=null;}}catch(err){_iterator118.e(err);}finally{_iterator118.f();}for(var _t83=e;_t83<this._nodes.length;_t83++)this._nodes[_t83]._index=_t83,this._nodes[_t83]._startOffset=i,i+=this._nodes[_t83].offsetSize;return n;}},{key:"toJSON",value:function toJSON(){return this._nodes.map(function(e){return e.toJSON();});}}]);}();var Wl=/*#__PURE__*/function(_$l){function Wl(e,t){var _this73;_classCallCheck(this,Wl);_this73=_callSuper(this,Wl,[t]),_defineProperty(_assertThisInitialized(_this73),"_data",void 0),_this73._data=e||"";return _this73;}_inherits(Wl,_$l);return _createClass(Wl,[{key:"offsetSize",get:function get(){return this.data.length;}},{key:"data",get:function get(){return this._data;}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Wl,"toJSON",this,3)([]);return e.data=this.data,e;}},{key:"_clone",value:function _clone(){return new Wl(this.data,this.getAttributes());}}],[{key:"fromJSON",value:function fromJSON(e){return new Wl(e.data,e.attributes);}}]);}($l);Wl.prototype.is=function(e){return"$text"===e||"model:$text"===e||"text"===e||"model:text"===e||"node"===e||"model:node"===e;};var jl=/*#__PURE__*/function(_Hl2){function jl(e,t,i){var _this74;_classCallCheck(this,jl);if(_this74=_callSuper(this,jl),_defineProperty(_assertThisInitialized(_this74),"textNode",void 0),_defineProperty(_assertThisInitialized(_this74),"data",void 0),_defineProperty(_assertThisInitialized(_this74),"offsetInText",void 0),_this74.textNode=e,t<0||t>e.offsetSize)throw new A("model-textproxy-wrong-offsetintext",_assertThisInitialized(_this74));if(i<0||t+i>e.offsetSize)throw new A("model-textproxy-wrong-length",_this74);_this74.data=e.data.substring(t,t+i),_this74.offsetInText=t;return _this74;}_inherits(jl,_Hl2);return _createClass(jl,[{key:"startOffset",get:function get(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null;}},{key:"offsetSize",get:function get(){return this.data.length;}},{key:"endOffset",get:function get(){return null!==this.startOffset?this.startOffset+this.offsetSize:null;}},{key:"isPartial",get:function get(){return this.offsetSize!==this.textNode.offsetSize;}},{key:"parent",get:function get(){return this.textNode.parent;}},{key:"root",get:function get(){return this.textNode.root;}},{key:"getPath",value:function getPath(){var e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e;}},{key:"getAncestors",value:function getAncestors(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=[];var i=e.includeSelf?this:this.parent;for(;i;)t[e.parentFirst?"push":"unshift"](i),i=i.parent;return t;}},{key:"hasAttribute",value:function hasAttribute(e){return this.textNode.hasAttribute(e);}},{key:"getAttribute",value:function getAttribute(e){return this.textNode.getAttribute(e);}},{key:"getAttributes",value:function getAttributes(){return this.textNode.getAttributes();}},{key:"getAttributeKeys",value:function getAttributeKeys(){return this.textNode.getAttributeKeys();}}]);}(Hl);jl.prototype.is=function(e){return"$textProxy"===e||"model:$textProxy"===e||"textProxy"===e||"model:textProxy"===e;};var ql=/*#__PURE__*/function(_$l2){function ql(e,t,i){var _this75;_classCallCheck(this,ql);_this75=_callSuper(this,ql,[t]),_defineProperty(_assertThisInitialized(_this75),"name",void 0),_defineProperty(_assertThisInitialized(_this75),"_children",new Ul()),_this75.name=e,i&&_this75._insertChild(0,i);return _this75;}_inherits(ql,_$l2);return _createClass(ql,[{key:"childCount",get:function get(){return this._children.length;}},{key:"maxOffset",get:function get(){return this._children.maxOffset;}},{key:"isEmpty",get:function get(){return 0===this.childCount;}},{key:"getChild",value:function getChild(e){return this._children.getNode(e);}},{key:"getChildAtOffset",value:function getChildAtOffset(e){return this._children.getNodeAtOffset(e);}},{key:"getChildren",value:function getChildren(){return this._children[Symbol.iterator]();}},{key:"getChildIndex",value:function getChildIndex(e){return this._children.getNodeIndex(e);}},{key:"getChildStartOffset",value:function getChildStartOffset(e){return this._children.getNodeStartOffset(e);}},{key:"offsetToIndex",value:function offsetToIndex(e){return this._children.offsetToIndex(e);}},{key:"getNodeByPath",value:function getNodeByPath(e){var t=this;var _iterator119=_createForOfIteratorHelper(e),_step119;try{for(_iterator119.s();!(_step119=_iterator119.n()).done;){var _i94=_step119.value;t=t.getChildAtOffset(_i94);}}catch(err){_iterator119.e(err);}finally{_iterator119.f();}return t;}},{key:"findAncestor",value:function findAncestor(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=t.includeSelf?this:this.parent;for(;i;){if(i.name===e)return i;i=i.parent;}return null;}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(ql,"toJSON",this,3)([]);if(e.name=this.name,this._children.length>0){e.children=[];var _iterator120=_createForOfIteratorHelper(this._children),_step120;try{for(_iterator120.s();!(_step120=_iterator120.n()).done;){var _t84=_step120.value;e.children.push(_t84.toJSON());}}catch(err){_iterator120.e(err);}finally{_iterator120.f();}}return e;}},{key:"_clone",value:function _clone(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var t=e?Array.from(this._children).map(function(e){return e._clone(!0);}):void 0;return new ql(this.name,this.getAttributes(),t);}},{key:"_appendChild",value:function _appendChild(e){this._insertChild(this.childCount,e);}},{key:"_insertChild",value:function _insertChild(e,t){var i=function(e){if("string"==typeof e)return[new Wl(e)];oo(e)||(e=[e]);return Array.from(e).map(function(e){return"string"==typeof e?new Wl(e):e instanceof jl?new Wl(e.data,e.getAttributes()):e;});}(t);var _iterator121=_createForOfIteratorHelper(i),_step121;try{for(_iterator121.s();!(_step121=_iterator121.n()).done;){var _e181=_step121.value;null!==_e181.parent&&_e181._remove(),_e181.parent=this;}}catch(err){_iterator121.e(err);}finally{_iterator121.f();}this._children._insertNodes(e,i);}},{key:"_removeChildren",value:function _removeChildren(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var i=this._children._removeNodes(e,t);var _iterator122=_createForOfIteratorHelper(i),_step122;try{for(_iterator122.s();!(_step122=_iterator122.n()).done;){var _e182=_step122.value;_e182.parent=null;}}catch(err){_iterator122.e(err);}finally{_iterator122.f();}return i;}}],[{key:"fromJSON",value:function fromJSON(e){var t;if(e.children){t=[];var _iterator123=_createForOfIteratorHelper(e.children),_step123;try{for(_iterator123.s();!(_step123=_iterator123.n()).done;){var _i95=_step123.value;_i95.name?t.push(ql.fromJSON(_i95)):t.push(Wl.fromJSON(_i95));}}catch(err){_iterator123.e(err);}finally{_iterator123.f();}}return new ql(e.name,e.attributes,t);}}]);}($l);ql.prototype.is=function(e,t){return t?t===this.name&&("element"===e||"model:element"===e):"element"===e||"model:element"===e||"node"===e||"model:node"===e;};var Gl=/*#__PURE__*/function(){function Gl(e){_classCallCheck(this,Gl);_defineProperty(this,"direction",void 0);_defineProperty(this,"boundaries",void 0);_defineProperty(this,"singleCharacters",void 0);_defineProperty(this,"shallow",void 0);_defineProperty(this,"ignoreElementEnd",void 0);_defineProperty(this,"_position",void 0);_defineProperty(this,"_boundaryStartParent",void 0);_defineProperty(this,"_boundaryEndParent",void 0);_defineProperty(this,"_visitedParent",void 0);if(!e||!e.boundaries&&!e.startPosition)throw new A("model-tree-walker-no-start-position",null);var t=e.direction||"forward";if("forward"!=t&&"backward"!=t)throw new A("model-tree-walker-unknown-direction",e,{direction:t});this.direction=t,this.boundaries=e.boundaries||null,e.startPosition?this._position=e.startPosition.clone():this._position=Zl._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!e.singleCharacters,this.shallow=!!e.shallow,this.ignoreElementEnd=!!e.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent;}return _createClass(Gl,[{key:Symbol.iterator,value:function value(){return this;}},{key:"position",get:function get(){return this._position;}},{key:"skip",value:function skip(e){var t,i,n,s;do{var _this$next;n=this.position,s=this._visitedParent,_this$next=this.next(),t=_this$next.done,i=_this$next.value;}while(!t&&e(i));t||(this._position=n,this._visitedParent=s);}},{key:"next",value:function next(){return"forward"==this.direction?this._next():this._previous();}},{key:"_next",value:function _next(){var e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&t.offset===i.maxOffset)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};var n=Jl(t,i),s=n||Ql(t,i,n);if(s instanceof ql){if(this.shallow){if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++;}else t.path.push(0),this._visitedParent=s;return this._position=t,Kl("elementStart",s,e,t,1);}if(s instanceof Wl){var _n45;if(this.singleCharacters)_n45=1;else{var _e183=s.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<_e183&&(_e183=this.boundaries.end.offset),_n45=_e183-t.offset;}var _o19=t.offset-s.startOffset,_r15=new jl(s,_o19,_n45);return t.offset+=_n45,this._position=t,Kl("text",_r15,e,t,_n45);}return t.path.pop(),t.offset++,this._position=t,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():Kl("elementEnd",i,e,t);}},{key:"_previous",value:function _previous(){var e=this.position,t=this.position.clone(),i=this._visitedParent;if(null===i.parent&&0===t.offset)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};var n=t.parent,s=Jl(t,n),o=s||Yl(t,n,s);if(o instanceof ql)return t.offset--,this.shallow?(this._position=t,Kl("elementStart",o,e,t,1)):(t.path.push(o.maxOffset),this._position=t,this._visitedParent=o,this.ignoreElementEnd?this._previous():Kl("elementEnd",o,e,t));if(o instanceof Wl){var _n46;if(this.singleCharacters)_n46=1;else{var _e184=o.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>_e184&&(_e184=this.boundaries.start.offset),_n46=t.offset-_e184;}var _s36=t.offset-o.startOffset,_r16=new jl(o,_s36-_n46,_n46);return t.offset-=_n46,this._position=t,Kl("text",_r16,e,t,_n46);}return t.path.pop(),this._position=t,this._visitedParent=i.parent,Kl("elementStart",i,e,t,1);}}]);}();function Kl(e,t,i,n,s){return{done:!1,value:{type:e,item:t,previousPosition:i,nextPosition:n,length:s}};}var Zl=/*#__PURE__*/function(_Hl3){function Zl(e,t){var _this76;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"toNone";_classCallCheck(this,Zl);if(_this76=_callSuper(this,Zl),_defineProperty(_assertThisInitialized(_this76),"root",void 0),_defineProperty(_assertThisInitialized(_this76),"path",void 0),_defineProperty(_assertThisInitialized(_this76),"stickiness",void 0),!e.is("element")&&!e.is("documentFragment"))throw new A("model-position-root-invalid",e);if(!(t instanceof Array)||0===t.length)throw new A("model-position-path-incorrect-format",e,{path:t});e.is("rootElement")?t=t.slice():(t=[].concat(_toConsumableArray(e.getPath()),_toConsumableArray(t)),e=e.root),_this76.root=e,_this76.path=t,_this76.stickiness=i;return _this76;}_inherits(Zl,_Hl3);return _createClass(Zl,[{key:"offset",get:function get(){return this.path[this.path.length-1];},set:function set(e){this.path[this.path.length-1]=e;}},{key:"parent",get:function get(){var e=this.root;for(var _t85=0;_t85<this.path.length-1;_t85++)if(e=e.getChildAtOffset(this.path[_t85]),!e)throw new A("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new A("model-position-path-incorrect",this,{position:this});return e;}},{key:"index",get:function get(){return this.parent.offsetToIndex(this.offset);}},{key:"textNode",get:function get(){return Jl(this,this.parent);}},{key:"nodeAfter",get:function get(){var e=this.parent;return Ql(this,e,Jl(this,e));}},{key:"nodeBefore",get:function get(){var e=this.parent;return Yl(this,e,Jl(this,e));}},{key:"isAtStart",get:function get(){return 0===this.offset;}},{key:"isAtEnd",get:function get(){return this.offset==this.parent.maxOffset;}},{key:"isValid",value:function isValid(){if(this.offset<0)return!1;var e=this.root;for(var _t86=0;_t86<this.path.length-1;_t86++)if(e=e.getChildAtOffset(this.path[_t86]),!e)return!1;return this.offset<=e.maxOffset;}},{key:"compareWith",value:function compareWith(e){if(this.root!=e.root)return"different";var t=so(this.path,e.path);switch(t){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[t]<e.path[t]?"before":"after";}}},{key:"getLastMatchingPosition",value:function getLastMatchingPosition(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};t.startPosition=this;var i=new Gl(t);return i.skip(e),i.position;}},{key:"getParentPath",value:function getParentPath(){return this.path.slice(0,-1);}},{key:"getAncestors",value:function getAncestors(){var e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0});}},{key:"findAncestor",value:function findAncestor(e){var t=this.parent;return t.is("element")?t.findAncestor(e,{includeSelf:!0}):null;}},{key:"getCommonPath",value:function getCommonPath(e){if(this.root!=e.root)return[];var t=so(this.path,e.path),i="string"==typeof t?Math.min(this.path.length,e.path.length):t;return this.path.slice(0,i);}},{key:"getCommonAncestor",value:function getCommonAncestor(e){var t=this.getAncestors(),i=e.getAncestors();var n=0;for(;t[n]==i[n]&&t[n];)n++;return 0===n?null:t[n-1];}},{key:"getShiftedBy",value:function getShiftedBy(e){var t=this.clone(),i=t.offset+e;return t.offset=i<0?0:i,t;}},{key:"isAfter",value:function isAfter(e){return"after"==this.compareWith(e);}},{key:"isBefore",value:function isBefore(e){return"before"==this.compareWith(e);}},{key:"isEqual",value:function isEqual(e){return"same"==this.compareWith(e);}},{key:"isTouching",value:function isTouching(e){if(this.root!==e.root)return!1;var t=Math.min(this.path.length,e.path.length);for(var _i96=0;_i96<t;_i96++){var _t87=this.path[_i96]-e.path[_i96];if(_t87<-1||_t87>1)return!1;if(1===_t87)return Xl(e,this,_i96);if(-1===_t87)return Xl(this,e,_i96);}return this.path.length===e.path.length||(this.path.length>e.path.length?ec(this.path,t):ec(e.path,t));}},{key:"hasSameParentAs",value:function hasSameParentAs(e){if(this.root!==e.root)return!1;return"same"==so(this.getParentPath(),e.getParentPath());}},{key:"getTransformedByOperation",value:function getTransformedByOperation(e){var t;switch(e.type){case"insert":t=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":t=this._getTransformedByMoveOperation(e);break;case"split":t=this._getTransformedBySplitOperation(e);break;case"merge":t=this._getTransformedByMergeOperation(e);break;default:t=Zl._createAt(this);}return t;}},{key:"_getTransformedByInsertOperation",value:function _getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany);}},{key:"_getTransformedByMoveOperation",value:function _getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany);}},{key:"_getTransformedBySplitOperation",value:function _getTransformedBySplitOperation(e){var t=e.movedRange;return t.containsPosition(this)||t.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1);}},{key:"_getTransformedByMergeOperation",value:function _getTransformedByMergeOperation(e){var t=e.movedRange;var i;return t.containsPosition(this)||t.start.isEqual(this)?(i=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(i=i._getTransformedByDeletion(e.deletionPosition,1))):i=this.isEqual(e.deletionPosition)?Zl._createAt(e.deletionPosition):this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),i;}},{key:"_getTransformedByDeletion",value:function _getTransformedByDeletion(e,t){var i=Zl._createAt(this);if(this.root!=e.root)return i;if("same"==so(e.getParentPath(),this.getParentPath())){if(e.offset<this.offset){if(e.offset+t>this.offset)return null;i.offset-=t;}}else if("prefix"==so(e.getParentPath(),this.getParentPath())){var _n47=e.path.length-1;if(e.offset<=this.path[_n47]){if(e.offset+t>this.path[_n47])return null;i.path[_n47]-=t;}}return i;}},{key:"_getTransformedByInsertion",value:function _getTransformedByInsertion(e,t){var i=Zl._createAt(this);if(this.root!=e.root)return i;if("same"==so(e.getParentPath(),this.getParentPath()))(e.offset<this.offset||e.offset==this.offset&&"toPrevious"!=this.stickiness)&&(i.offset+=t);else if("prefix"==so(e.getParentPath(),this.getParentPath())){var _n48=e.path.length-1;e.offset<=this.path[_n48]&&(i.path[_n48]+=t);}return i;}},{key:"_getTransformedByMove",value:function _getTransformedByMove(e,t,i){if(t=t._getTransformedByDeletion(e,i),e.isEqual(t))return Zl._createAt(this);var n=this._getTransformedByDeletion(e,i);return null===n||e.isEqual(this)&&"toNext"==this.stickiness||e.getShiftedBy(i).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(e,t):n._getTransformedByInsertion(t,i);}},{key:"_getCombined",value:function _getCombined(e,t){var i=e.path.length-1,n=Zl._createAt(t);return n.stickiness=this.stickiness,n.offset=n.offset+this.path[i]-e.offset,n.path=[].concat(_toConsumableArray(n.path),_toConsumableArray(this.path.slice(i+1))),n;}},{key:"toJSON",value:function toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness};}},{key:"clone",value:function clone(){return new this.constructor(this.root,this.path,this.stickiness);}}],[{key:"_createAt",value:function _createAt(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"toNone";if(e instanceof Zl)return new Zl(e.root,e.path,e.stickiness);{var _n49=e;if("end"==t)t=_n49.maxOffset;else{if("before"==t)return this._createBefore(_n49,i);if("after"==t)return this._createAfter(_n49,i);if(0!==t&&!t)throw new A("model-createpositionat-offset-required",[this,e]);}if(!_n49.is("element")&&!_n49.is("documentFragment"))throw new A("model-position-parent-incorrect",[this,e]);var _s37=_n49.getPath();return _s37.push(t),new this(_n49.root,_s37,i);}}},{key:"_createAfter",value:function _createAfter(e,t){if(!e.parent)throw new A("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,t);}},{key:"_createBefore",value:function _createBefore(e,t){if(!e.parent)throw new A("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,t);}},{key:"fromJSON",value:function fromJSON(e,t){if("$graveyard"===e.root){var _i97=new Zl(t.graveyard,e.path);return _i97.stickiness=e.stickiness,_i97;}if(!t.getRoot(e.root))throw new A("model-position-fromjson-no-root",t,{rootName:e.root});return new Zl(t.getRoot(e.root),e.path,e.stickiness);}}]);}(Hl);function Jl(e,t){var i=t.getChildAtOffset(e.offset);return i&&i.is("$text")&&i.startOffset<e.offset?i:null;}function Ql(e,t,i){return null!==i?null:t.getChildAtOffset(e.offset);}function Yl(e,t,i){return null!==i?null:t.getChild(t.offsetToIndex(e.offset)-1);}function Xl(e,t,i){return i+1!==e.path.length&&!!ec(t.path,i+1)&&!!function(e,t){var i=e.parent,n=e.path.length-1,s=0;for(;n>=t;){if(e.path[n]+s!==i.maxOffset)return!1;s=1,n--,i=i.parent;}return!0;}(e,i+1);}function ec(e,t){for(;t<e.length;){if(0!==e[t])return!1;t++;}return!0;}Zl.prototype.is=function(e){return"position"===e||"model:position"===e;};var tc=/*#__PURE__*/function(_Hl4){function tc(e,t){var _this77;_classCallCheck(this,tc);_this77=_callSuper(this,tc),_defineProperty(_assertThisInitialized(_this77),"start",void 0),_defineProperty(_assertThisInitialized(_this77),"end",void 0),_this77.start=Zl._createAt(e),_this77.end=t?Zl._createAt(t):Zl._createAt(e),_this77.start.stickiness=_this77.isCollapsed?"toNone":"toNext",_this77.end.stickiness=_this77.isCollapsed?"toNone":"toPrevious";return _this77;}_inherits(tc,_Hl4);return _createClass(tc,[{key:Symbol.iterator,value:/*#__PURE__*/_regeneratorRuntime().mark(function value(){return _regeneratorRuntime().wrap(function value$(_context15){while(1)switch(_context15.prev=_context15.next){case 0:return _context15.delegateYield(new Gl({boundaries:this,ignoreElementEnd:!0}),"t0",1);case 1:case"end":return _context15.stop();}},value,this);})},{key:"isCollapsed",get:function get(){return this.start.isEqual(this.end);}},{key:"isFlat",get:function get(){return"same"==so(this.start.getParentPath(),this.end.getParentPath());}},{key:"root",get:function get(){return this.start.root;}},{key:"containsPosition",value:function containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end);}},{key:"containsRange",value:function containsRange(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;e.isCollapsed&&(t=!1);var i=this.containsPosition(e.start)||t&&this.start.isEqual(e.start),n=this.containsPosition(e.end)||t&&this.end.isEqual(e.end);return i&&n;}},{key:"containsItem",value:function containsItem(e){var t=Zl._createBefore(e);return this.containsPosition(t)||this.start.isEqual(t);}},{key:"isEqual",value:function isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end);}},{key:"isIntersecting",value:function isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start);}},{key:"getDifference",value:function getDifference(e){var t=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&t.push(new tc(this.start,e.start)),this.containsPosition(e.end)&&t.push(new tc(e.end,this.end))):t.push(new tc(this.start,this.end)),t;}},{key:"getIntersection",value:function getIntersection(e){if(this.isIntersecting(e)){var _t88=this.start,_i98=this.end;return this.containsPosition(e.start)&&(_t88=e.start),this.containsPosition(e.end)&&(_i98=e.end),new tc(_t88,_i98);}return null;}},{key:"getJoined",value:function getJoined(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=this.isIntersecting(e);if(i||(i=this.start.isBefore(e.start)?t?this.end.isTouching(e.start):this.end.isEqual(e.start):t?e.end.isTouching(this.start):e.end.isEqual(this.start)),!i)return null;var n=this.start,s=this.end;return e.start.isBefore(n)&&(n=e.start),e.end.isAfter(s)&&(s=e.end),new tc(n,s);}},{key:"getMinimalFlatRanges",value:function getMinimalFlatRanges(){var e=[],t=this.start.getCommonPath(this.end).length,i=Zl._createAt(this.start);var n=i.parent;for(;i.path.length>t+1;){var _t89=n.maxOffset-i.offset;0!==_t89&&e.push(new tc(i,i.getShiftedBy(_t89))),i.path=i.path.slice(0,-1),i.offset++,n=n.parent;}for(;i.path.length<=this.end.path.length;){var _t90=this.end.path[i.path.length-1],_n50=_t90-i.offset;0!==_n50&&e.push(new tc(i,i.getShiftedBy(_n50))),i.offset=_t90,i.path.push(0);}return e;}},{key:"getWalker",value:function getWalker(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return e.boundaries=this,new Gl(e);}},{key:"getItems",value:function getItems(){var _this78=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var t,_iterator124,_step124,_e185;return _regeneratorRuntime().wrap(function _callee5$(_context16){while(1)switch(_context16.prev=_context16.next){case 0:e.boundaries=_this78,e.ignoreElementEnd=!0;t=new Gl(e);_iterator124=_createForOfIteratorHelper(t);_context16.prev=3;_iterator124.s();case 5:if((_step124=_iterator124.n()).done){_context16.next=11;break;}_e185=_step124.value;_context16.next=9;return _e185.item;case 9:_context16.next=5;break;case 11:_context16.next=16;break;case 13:_context16.prev=13;_context16.t0=_context16["catch"](3);_iterator124.e(_context16.t0);case 16:_context16.prev=16;_iterator124.f();return _context16.finish(16);case 19:case"end":return _context16.stop();}},_callee5,null,[[3,13,16,19]]);})();}},{key:"getPositions",value:function getPositions(){var _this79=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){var t,_iterator125,_step125,_e186;return _regeneratorRuntime().wrap(function _callee6$(_context17){while(1)switch(_context17.prev=_context17.next){case 0:e.boundaries=_this79;t=new Gl(e);_context17.next=4;return t.position;case 4:_iterator125=_createForOfIteratorHelper(t);_context17.prev=5;_iterator125.s();case 7:if((_step125=_iterator125.n()).done){_context17.next=13;break;}_e186=_step125.value;_context17.next=11;return _e186.nextPosition;case 11:_context17.next=7;break;case 13:_context17.next=18;break;case 15:_context17.prev=15;_context17.t0=_context17["catch"](5);_iterator125.e(_context17.t0);case 18:_context17.prev=18;_iterator125.f();return _context17.finish(18);case 21:case"end":return _context17.stop();}},_callee6,null,[[5,15,18,21]]);})();}},{key:"getTransformedByOperation",value:function getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)];}return[new tc(this.start,this.end)];}},{key:"getTransformedByOperations",value:function getTransformedByOperations(e){var t=[new tc(this.start,this.end)];var _iterator126=_createForOfIteratorHelper(e),_step126;try{for(_iterator126.s();!(_step126=_iterator126.n()).done;){var _i100=_step126.value;for(var _e189=0;_e189<t.length;_e189++){var _n52=t[_e189].getTransformedByOperation(_i100);t.splice.apply(t,[_e189,1].concat(_toConsumableArray(_n52))),_e189+=_n52.length-1;}}}catch(err){_iterator126.e(err);}finally{_iterator126.f();}for(var _e187=0;_e187<t.length;_e187++){var _i99=t[_e187];for(var _n51=_e187+1;_n51<t.length;_n51++){var _e188=t[_n51];(_i99.containsRange(_e188)||_e188.containsRange(_i99)||_i99.isEqual(_e188))&&t.splice(_n51,1);}}return t;}},{key:"getCommonAncestor",value:function getCommonAncestor(){return this.start.getCommonAncestor(this.end);}},{key:"getContainedElement",value:function getContainedElement(){if(this.isCollapsed)return null;var e=this.start.nodeAfter,t=this.end.nodeBefore;return e&&e.is("element")&&e===t?e:null;}},{key:"toJSON",value:function toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()};}},{key:"clone",value:function clone(){return new this.constructor(this.start,this.end);}},{key:"_getTransformedByInsertOperation",value:function _getTransformedByInsertOperation(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return this._getTransformedByInsertion(e.position,e.howMany,t);}},{key:"_getTransformedByMoveOperation",value:function _getTransformedByMoveOperation(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=e.sourcePosition,n=e.howMany,s=e.targetPosition;return this._getTransformedByMove(i,s,n,t);}},{key:"_getTransformedBySplitOperation",value:function _getTransformedBySplitOperation(e){var t=this.start._getTransformedBySplitOperation(e);var i=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(i=this.end.getShiftedBy(1)),t.root!=i.root&&(i=this.end.getShiftedBy(-1)),new tc(t,i);}},{key:"_getTransformedByMergeOperation",value:function _getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new tc(this.start);var t=this.start._getTransformedByMergeOperation(e),i=this.end._getTransformedByMergeOperation(e);return t.root!=i.root&&(i=this.end.getShiftedBy(-1)),t.isAfter(i)?(e.sourcePosition.isBefore(e.targetPosition)?(t=Zl._createAt(i),t.offset=0):(e.deletionPosition.isEqual(t)||(i=e.deletionPosition),t=e.targetPosition),new tc(t,i)):new tc(t,i);}},{key:"_getTransformedByInsertion",value:function _getTransformedByInsertion(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;if(i&&this.containsPosition(e))return[new tc(this.start,e),new tc(e.getShiftedBy(t),this.end._getTransformedByInsertion(e,t))];{var _i101=new tc(this.start,this.end);return _i101.start=_i101.start._getTransformedByInsertion(e,t),_i101.end=_i101.end._getTransformedByInsertion(e,t),[_i101];}}},{key:"_getTransformedByMove",value:function _getTransformedByMove(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;if(this.isCollapsed){var _n53=this.start._getTransformedByMove(e,t,i);return[new tc(_n53)];}var s=tc._createFromPositionAndShift(e,i),o=t._getTransformedByDeletion(e,i);if(this.containsPosition(t)&&!n&&(s.containsPosition(this.start)||s.containsPosition(this.end))){var _n54=this.start._getTransformedByMove(e,t,i),_s38=this.end._getTransformedByMove(e,t,i);return[new tc(_n54,_s38)];}var r;var a=this.getDifference(s);var l=null;var c=this.getIntersection(s);if(1==a.length?l=new tc(a[0].start._getTransformedByDeletion(e,i),a[0].end._getTransformedByDeletion(e,i)):2==a.length&&(l=new tc(this.start,this.end._getTransformedByDeletion(e,i))),r=l?l._getTransformedByInsertion(o,i,null!==c||n):[],c){var _e190=new tc(c.start._getCombined(s.start,o),c.end._getCombined(s.start,o));2==r.length?r.splice(1,0,_e190):r.push(_e190);}return r;}},{key:"_getTransformedByDeletion",value:function _getTransformedByDeletion(e,t){var i=this.start._getTransformedByDeletion(e,t),n=this.end._getTransformedByDeletion(e,t);return null==i&&null==n?null:(null==i&&(i=e),null==n&&(n=e),new tc(i,n));}}],[{key:"_createFromPositionAndShift",value:function _createFromPositionAndShift(e,t){var i=e,n=e.getShiftedBy(t);return t>0?new this(i,n):new this(n,i);}},{key:"_createIn",value:function _createIn(e){return new this(Zl._createAt(e,0),Zl._createAt(e,e.maxOffset));}},{key:"_createOn",value:function _createOn(e){return this._createFromPositionAndShift(Zl._createBefore(e),e.offsetSize);}},{key:"_createFromRanges",value:function _createFromRanges(e){if(0===e.length)throw new A("range-create-from-ranges-empty-array",null);if(1==e.length)return e[0].clone();var t=e[0];e.sort(function(e,t){return e.start.isAfter(t.start)?1:-1;});var i=e.indexOf(t),n=new this(t.start,t.end);for(var _t91=i-1;_t91>=0&&e[_t91].end.isEqual(n.start);_t91--)n.start=Zl._createAt(e[_t91].start);for(var _t92=i+1;_t92<e.length&&e[_t92].start.isEqual(n.end);_t92++)n.end=Zl._createAt(e[_t92].end);return n;}},{key:"fromJSON",value:function fromJSON(e,t){return new this(Zl.fromJSON(e.start,t),Zl.fromJSON(e.end,t));}}]);}(Hl);tc.prototype.is=function(e){return"range"===e||"model:range"===e;};var ic=/*#__PURE__*/function(_L9){function ic(){var _this80;_classCallCheck(this,ic);_this80=_callSuper(this,ic),_defineProperty(_assertThisInitialized(_this80),"_modelToViewMapping",new WeakMap()),_defineProperty(_assertThisInitialized(_this80),"_viewToModelMapping",new WeakMap()),_defineProperty(_assertThisInitialized(_this80),"_viewToModelLengthCallbacks",new Map()),_defineProperty(_assertThisInitialized(_this80),"_markerNameToElements",new Map()),_defineProperty(_assertThisInitialized(_this80),"_elementToMarkerNames",new Map()),_defineProperty(_assertThisInitialized(_this80),"_deferredBindingRemovals",new Map()),_defineProperty(_assertThisInitialized(_this80),"_unboundMarkerNames",new Set()),_this80.on("modelToViewPosition",function(e,t){if(t.viewPosition)return;var i=_this80._modelToViewMapping.get(t.modelPosition.parent);if(!i)throw new A("mapping-model-position-view-parent-not-found",_assertThisInitialized(_this80),{modelPosition:t.modelPosition});t.viewPosition=_this80.findPositionIn(i,t.modelPosition.offset);},{priority:"low"}),_this80.on("viewToModelPosition",function(e,t){if(t.modelPosition)return;var i=_this80.findMappedViewAncestor(t.viewPosition),n=_this80._viewToModelMapping.get(i),s=_this80._toModelOffset(t.viewPosition.parent,t.viewPosition.offset,i);t.modelPosition=Zl._createAt(n,s);},{priority:"low"});return _this80;}_inherits(ic,_L9);return _createClass(ic,[{key:"bindElements",value:function bindElements(e,t){this._modelToViewMapping.set(e,t),this._viewToModelMapping.set(t,e);}},{key:"unbindViewElement",value:function unbindViewElement(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.toModelElement(e);if(this._elementToMarkerNames.has(e)){var _iterator127=_createForOfIteratorHelper(this._elementToMarkerNames.get(e)),_step127;try{for(_iterator127.s();!(_step127=_iterator127.n()).done;){var _t93=_step127.value;this._unboundMarkerNames.add(_t93);}}catch(err){_iterator127.e(err);}finally{_iterator127.f();}}t.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping["delete"](e),this._modelToViewMapping.get(i)==e&&this._modelToViewMapping["delete"](i));}},{key:"unbindModelElement",value:function unbindModelElement(e){var t=this.toViewElement(e);this._modelToViewMapping["delete"](e),this._viewToModelMapping.get(t)==e&&this._viewToModelMapping["delete"](t);}},{key:"bindElementToMarker",value:function bindElementToMarker(e,t){var i=this._markerNameToElements.get(t)||new Set();i.add(e);var n=this._elementToMarkerNames.get(e)||new Set();n.add(t),this._markerNameToElements.set(t,i),this._elementToMarkerNames.set(e,n);}},{key:"unbindElementFromMarkerName",value:function unbindElementFromMarkerName(e,t){var i=this._markerNameToElements.get(t);i&&(i["delete"](e),0==i.size&&this._markerNameToElements["delete"](t));var n=this._elementToMarkerNames.get(e);n&&(n["delete"](t),0==n.size&&this._elementToMarkerNames["delete"](e));}},{key:"flushUnboundMarkerNames",value:function flushUnboundMarkerNames(){var e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e;}},{key:"flushDeferredBindings",value:function flushDeferredBindings(){var _iterator128=_createForOfIteratorHelper(this._deferredBindingRemovals),_step128;try{for(_iterator128.s();!(_step128=_iterator128.n()).done;){var _step128$value=_slicedToArray(_step128.value,2),_e191=_step128$value[0],_t94=_step128$value[1];_e191.root==_t94&&this.unbindViewElement(_e191);}}catch(err){_iterator128.e(err);}finally{_iterator128.f();}this._deferredBindingRemovals=new Map();}},{key:"clearBindings",value:function clearBindings(){this._modelToViewMapping=new WeakMap(),this._viewToModelMapping=new WeakMap(),this._markerNameToElements=new Map(),this._elementToMarkerNames=new Map(),this._unboundMarkerNames=new Set(),this._deferredBindingRemovals=new Map();}},{key:"toModelElement",value:function toModelElement(e){return this._viewToModelMapping.get(e);}},{key:"toViewElement",value:function toViewElement(e){return this._modelToViewMapping.get(e);}},{key:"toModelRange",value:function toModelRange(e){return new tc(this.toModelPosition(e.start),this.toModelPosition(e.end));}},{key:"toViewRange",value:function toViewRange(e){return new Ca(this.toViewPosition(e.start),this.toViewPosition(e.end));}},{key:"toModelPosition",value:function toModelPosition(e){var t={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",t),t.modelPosition;}},{key:"toViewPosition",value:function toViewPosition(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i={modelPosition:e,mapper:this,isPhantom:t.isPhantom};return this.fire("modelToViewPosition",i),i.viewPosition;}},{key:"markerNameToElements",value:function markerNameToElements(e){var t=this._markerNameToElements.get(e);if(!t)return null;var i=new Set();var _iterator129=_createForOfIteratorHelper(t),_step129;try{for(_iterator129.s();!(_step129=_iterator129.n()).done;){var _e192=_step129.value;if(_e192.is("attributeElement")){var _iterator130=_createForOfIteratorHelper(_e192.getElementsWithSameId()),_step130;try{for(_iterator130.s();!(_step130=_iterator130.n()).done;){var _t95=_step130.value;i.add(_t95);}}catch(err){_iterator130.e(err);}finally{_iterator130.f();}}else i.add(_e192);}}catch(err){_iterator129.e(err);}finally{_iterator129.f();}return i;}},{key:"registerViewToModelLength",value:function registerViewToModelLength(e,t){this._viewToModelLengthCallbacks.set(e,t);}},{key:"findMappedViewAncestor",value:function findMappedViewAncestor(e){var t=e.parent;for(;!this._viewToModelMapping.has(t);)t=t.parent;return t;}},{key:"_toModelOffset",value:function _toModelOffset(e,t,i){if(i!=e){return this._toModelOffset(e.parent,e.index,i)+this._toModelOffset(e,t,e);}if(e.is("$text"))return t;var n=0;for(var _i102=0;_i102<t;_i102++)n+=this.getModelLength(e.getChild(_i102));return n;}},{key:"getModelLength",value:function getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name)){return this._viewToModelLengthCallbacks.get(e.name)(e);}if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{var _t96=0;var _iterator131=_createForOfIteratorHelper(e.getChildren()),_step131;try{for(_iterator131.s();!(_step131=_iterator131.n()).done;){var _i103=_step131.value;_t96+=this.getModelLength(_i103);}}catch(err){_iterator131.e(err);}finally{_iterator131.f();}return _t96;}}},{key:"findPositionIn",value:function findPositionIn(e,t){var i,n=0,s=0,o=0;if(e.is("$text"))return new ka(e,t);for(;s<t;)i=e.getChild(o),n=this.getModelLength(i),s+=n,o++;return s==t?this._moveViewPositionToTextNode(new ka(e,o)):this.findPositionIn(i,t-(s-n));}},{key:"_moveViewPositionToTextNode",value:function _moveViewPositionToTextNode(e){var t=e.nodeBefore,i=e.nodeAfter;return t instanceof oa?new ka(t,t.data.length):i instanceof oa?new ka(i,0):e;}}]);}(L());var nc=/*#__PURE__*/function(){function nc(){_classCallCheck(this,nc);_defineProperty(this,"_consumable",new Map());_defineProperty(this,"_textProxyRegistry",new Map());}return _createClass(nc,[{key:"add",value:function add(e,t){t=sc(t),e instanceof jl&&(e=this._getSymbolForTextProxy(e)),this._consumable.has(e)||this._consumable.set(e,new Map()),this._consumable.get(e).set(t,!0);}},{key:"consume",value:function consume(e,t){return t=sc(t),e instanceof jl&&(e=this._getSymbolForTextProxy(e)),!!this.test(e,t)&&(this._consumable.get(e).set(t,!1),!0);}},{key:"test",value:function test(e,t){t=sc(t),e instanceof jl&&(e=this._getSymbolForTextProxy(e));var i=this._consumable.get(e);if(void 0===i)return null;var n=i.get(t);return void 0===n?null:n;}},{key:"revert",value:function revert(e,t){t=sc(t),e instanceof jl&&(e=this._getSymbolForTextProxy(e));var i=this.test(e,t);return!1===i?(this._consumable.get(e).set(t,!0),!0):!0!==i&&null;}},{key:"verifyAllConsumed",value:function verifyAllConsumed(e){var t=[];var _iterator132=_createForOfIteratorHelper(this._consumable),_step132;try{for(_iterator132.s();!(_step132=_iterator132.n()).done;){var _step132$value=_slicedToArray(_step132.value,2),_i104=_step132$value[0],_n55=_step132$value[1];var _iterator133=_createForOfIteratorHelper(_n55),_step133;try{for(_iterator133.s();!(_step133=_iterator133.n()).done;){var _step133$value=_slicedToArray(_step133.value,2),_s39=_step133$value[0],_o20=_step133$value[1];var _n56=_s39.split(":")[0];_o20&&e==_n56&&t.push({event:_s39,item:_i104.name||_i104.description});}}catch(err){_iterator133.e(err);}finally{_iterator133.f();}}}catch(err){_iterator132.e(err);}finally{_iterator132.f();}if(t.length)throw new A("conversion-model-consumable-not-consumed",null,{items:t});}},{key:"_getSymbolForTextProxy",value:function _getSymbolForTextProxy(e){var t=null;var i=this._textProxyRegistry.get(e.startOffset);if(i){var _n57=i.get(e.endOffset);_n57&&(t=_n57.get(e.parent));}return t||(t=this._addSymbolForTextProxy(e)),t;}},{key:"_addSymbolForTextProxy",value:function _addSymbolForTextProxy(e){var t=e.startOffset,i=e.endOffset,n=e.parent,s=Symbol("$textProxy:"+e.data);var o,r;return o=this._textProxyRegistry.get(t),o||(o=new Map(),this._textProxyRegistry.set(t,o)),r=o.get(i),r||(r=new Map(),o.set(i,r)),r.set(n,s),s;}}]);}();function sc(e){var t=e.split(":");return"insert"==t[0]?t[0]:"addMarker"==t[0]||"removeMarker"==t[0]?e:t.length>1?t[0]+":"+t[1]:t[0];}var oc=/*#__PURE__*/function(_L10){function oc(e){var _this81;_classCallCheck(this,oc);_this81=_callSuper(this,oc),_defineProperty(_assertThisInitialized(_this81),"_conversionApi",void 0),_defineProperty(_assertThisInitialized(_this81),"_firedEventsMap",void 0),_this81._conversionApi=_objectSpread({dispatcher:_assertThisInitialized(_this81)},e),_this81._firedEventsMap=new WeakMap();return _this81;}_inherits(oc,_L10);return _createClass(oc,[{key:"convertChanges",value:function convertChanges(e,t,i){var n=this._createConversionApi(i,e.getRefreshedItems());var _iterator134=_createForOfIteratorHelper(e.getMarkersToRemove()),_step134;try{for(_iterator134.s();!(_step134=_iterator134.n()).done;){var _t97=_step134.value;this._convertMarkerRemove(_t97.name,_t97.range,n);}}catch(err){_iterator134.e(err);}finally{_iterator134.f();}var s=this._reduceChanges(e.getChanges());var _iterator135=_createForOfIteratorHelper(s),_step135;try{for(_iterator135.s();!(_step135=_iterator135.n()).done;){var _e193=_step135.value;"insert"===_e193.type?this._convertInsert(tc._createFromPositionAndShift(_e193.position,_e193.length),n):"reinsert"===_e193.type?this._convertReinsert(tc._createFromPositionAndShift(_e193.position,_e193.length),n):"remove"===_e193.type?this._convertRemove(_e193.position,_e193.length,_e193.name,n):this._convertAttribute(_e193.range,_e193.attributeKey,_e193.attributeOldValue,_e193.attributeNewValue,n);}}catch(err){_iterator135.e(err);}finally{_iterator135.f();}n.mapper.flushDeferredBindings();var _iterator136=_createForOfIteratorHelper(n.mapper.flushUnboundMarkerNames()),_step136;try{for(_iterator136.s();!(_step136=_iterator136.n()).done;){var _e194=_step136.value;var _i105=t.get(_e194).getRange();this._convertMarkerRemove(_e194,_i105,n),this._convertMarkerAdd(_e194,_i105,n);}}catch(err){_iterator136.e(err);}finally{_iterator136.f();}var _iterator137=_createForOfIteratorHelper(e.getMarkersToAdd()),_step137;try{for(_iterator137.s();!(_step137=_iterator137.n()).done;){var _t98=_step137.value;this._convertMarkerAdd(_t98.name,_t98.range,n);}}catch(err){_iterator137.e(err);}finally{_iterator137.f();}n.consumable.verifyAllConsumed("insert");}},{key:"convert",value:function convert(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s=this._createConversionApi(i,void 0,n);this._convertInsert(e,s);var _iterator138=_createForOfIteratorHelper(t),_step138;try{for(_iterator138.s();!(_step138=_iterator138.n()).done;){var _step138$value=_slicedToArray(_step138.value,2),_e195=_step138$value[0],_i106=_step138$value[1];this._convertMarkerAdd(_e195,_i106,s);}}catch(err){_iterator138.e(err);}finally{_iterator138.f();}s.consumable.verifyAllConsumed("insert");}},{key:"convertSelection",value:function convertSelection(e,t,i){var n=this._createConversionApi(i);this.fire("cleanSelection",{selection:e},n);var s=e.getFirstPosition().root;if(!n.mapper.toViewElement(s))return;var o=Array.from(t.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(n.consumable,e,o),this.fire("selection",{selection:e},n),e.isCollapsed){var _iterator139=_createForOfIteratorHelper(o),_step139;try{for(_iterator139.s();!(_step139=_iterator139.n()).done;){var _t99=_step139.value;if(n.consumable.test(e,"addMarker:"+_t99.name)){var _i107=_t99.getRange();if(!rc(e.getFirstPosition(),_t99,n.mapper))continue;var _s40={item:e,markerName:_t99.name,markerRange:_i107};this.fire("addMarker:".concat(_t99.name),_s40,n);}}}catch(err){_iterator139.e(err);}finally{_iterator139.f();}var _iterator140=_createForOfIteratorHelper(e.getAttributeKeys()),_step140;try{for(_iterator140.s();!(_step140=_iterator140.n()).done;){var _t100=_step140.value;if(n.consumable.test(e,"attribute:"+_t100)){var _i108={item:e,range:e.getFirstRange(),attributeKey:_t100,attributeOldValue:null,attributeNewValue:e.getAttribute(_t100)};this.fire("attribute:".concat(_t100,":$text"),_i108,n);}}}catch(err){_iterator140.e(err);}finally{_iterator140.f();}}}},{key:"_convertInsert",value:function _convertInsert(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};i.doNotAddConsumables||this._addConsumablesForInsert(t.consumable,e);var _iterator141=_createForOfIteratorHelper(Array.from(e.getWalker({shallow:!0})).map(ac)),_step141;try{for(_iterator141.s();!(_step141=_iterator141.n()).done;){var _i109=_step141.value;this._testAndFire("insert",_i109,t);}}catch(err){_iterator141.e(err);}finally{_iterator141.f();}}},{key:"_convertRemove",value:function _convertRemove(e,t,i,n){this.fire("remove:".concat(i),{position:e,length:t},n);}},{key:"_convertAttribute",value:function _convertAttribute(e,t,i,n,s){this._addConsumablesForRange(s.consumable,e,"attribute:".concat(t));var _iterator142=_createForOfIteratorHelper(e),_step142;try{for(_iterator142.s();!(_step142=_iterator142.n()).done;){var _o21=_step142.value;var _e196={item:_o21.item,range:tc._createFromPositionAndShift(_o21.previousPosition,_o21.length),attributeKey:t,attributeOldValue:i,attributeNewValue:n};this._testAndFire("attribute:".concat(t),_e196,s);}}catch(err){_iterator142.e(err);}finally{_iterator142.f();}}},{key:"_convertReinsert",value:function _convertReinsert(e,t){var i=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(t.consumable,i);var _iterator143=_createForOfIteratorHelper(i.map(ac)),_step143;try{for(_iterator143.s();!(_step143=_iterator143.n()).done;){var _e197=_step143.value;this._testAndFire("insert",_objectSpread(_objectSpread({},_e197),{},{reconversion:!0}),t);}}catch(err){_iterator143.e(err);}finally{_iterator143.f();}}},{key:"_convertMarkerAdd",value:function _convertMarkerAdd(e,t,i){if("$graveyard"==t.root.rootName)return;var n="addMarker:".concat(e);if(i.consumable.add(t,n),this.fire(n,{markerName:e,markerRange:t},i),i.consumable.consume(t,n)){this._addConsumablesForRange(i.consumable,t,n);var _iterator144=_createForOfIteratorHelper(t.getItems()),_step144;try{for(_iterator144.s();!(_step144=_iterator144.n()).done;){var _s41=_step144.value;if(!i.consumable.test(_s41,n))continue;var _o22={item:_s41,range:tc._createOn(_s41),markerName:e,markerRange:t};this.fire(n,_o22,i);}}catch(err){_iterator144.e(err);}finally{_iterator144.f();}}}},{key:"_convertMarkerRemove",value:function _convertMarkerRemove(e,t,i){"$graveyard"!=t.root.rootName&&this.fire("removeMarker:".concat(e),{markerName:e,markerRange:t},i);}},{key:"_reduceChanges",value:function _reduceChanges(e){var t={changes:e};return this.fire("reduceChanges",t),t.changes;}},{key:"_addConsumablesForInsert",value:function _addConsumablesForInsert(e,t){var _iterator145=_createForOfIteratorHelper(t),_step145;try{for(_iterator145.s();!(_step145=_iterator145.n()).done;){var _i110=_step145.value;var _t101=_i110.item;if(null===e.test(_t101,"insert")){e.add(_t101,"insert");var _iterator146=_createForOfIteratorHelper(_t101.getAttributeKeys()),_step146;try{for(_iterator146.s();!(_step146=_iterator146.n()).done;){var _i111=_step146.value;e.add(_t101,"attribute:"+_i111);}}catch(err){_iterator146.e(err);}finally{_iterator146.f();}}}}catch(err){_iterator145.e(err);}finally{_iterator145.f();}return e;}},{key:"_addConsumablesForRange",value:function _addConsumablesForRange(e,t,i){var _iterator147=_createForOfIteratorHelper(t.getItems()),_step147;try{for(_iterator147.s();!(_step147=_iterator147.n()).done;){var _n58=_step147.value;e.add(_n58,i);}}catch(err){_iterator147.e(err);}finally{_iterator147.f();}return e;}},{key:"_addConsumablesForSelection",value:function _addConsumablesForSelection(e,t,i){e.add(t,"selection");var _iterator148=_createForOfIteratorHelper(i),_step148;try{for(_iterator148.s();!(_step148=_iterator148.n()).done;){var _n59=_step148.value;e.add(t,"addMarker:"+_n59.name);}}catch(err){_iterator148.e(err);}finally{_iterator148.f();}var _iterator149=_createForOfIteratorHelper(t.getAttributeKeys()),_step149;try{for(_iterator149.s();!(_step149=_iterator149.n()).done;){var _i112=_step149.value;e.add(t,"attribute:"+_i112);}}catch(err){_iterator149.e(err);}finally{_iterator149.f();}return e;}},{key:"_testAndFire",value:function _testAndFire(e,t,i){var n=function(e,t){var i=t.item.is("element")?t.item.name:"$text";return"".concat(e,":").concat(i);}(e,t),s=t.item.is("$textProxy")?i.consumable._getSymbolForTextProxy(t.item):t.item,o=this._firedEventsMap.get(i),r=o.get(s);if(r){if(r.has(n))return;r.add(n);}else o.set(s,new Set([n]));this.fire(n,t,i);}},{key:"_testAndFireAddAttributes",value:function _testAndFireAddAttributes(e,t){var i={item:e,range:tc._createOn(e)};var _iterator150=_createForOfIteratorHelper(i.item.getAttributeKeys()),_step150;try{for(_iterator150.s();!(_step150=_iterator150.n()).done;){var _e198=_step150.value;i.attributeKey=_e198,i.attributeOldValue=null,i.attributeNewValue=i.item.getAttribute(_e198),this._testAndFire("attribute:".concat(_e198),i,t);}}catch(err){_iterator150.e(err);}finally{_iterator150.f();}}},{key:"_createConversionApi",value:function _createConversionApi(e){var _this82=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Set();var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=_objectSpread(_objectSpread({},this._conversionApi),{},{consumable:new nc(),writer:e,options:i,convertItem:function convertItem(e){return _this82._convertInsert(tc._createOn(e),n);},convertChildren:function convertChildren(e){return _this82._convertInsert(tc._createIn(e),n,{doNotAddConsumables:!0});},convertAttributes:function convertAttributes(e){return _this82._testAndFireAddAttributes(e,n);},canReuseView:function canReuseView(e){return!t.has(n.mapper.toModelElement(e));}});return this._firedEventsMap.set(n,new Map()),n;}}]);}(L());function rc(e,t,i){var n=t.getRange(),s=Array.from(e.getAncestors());s.shift(),s.reverse();return!s.some(function(e){if(n.containsItem(e)){return!!i.toViewElement(e).getCustomProperty("addHighlight");}});}function ac(e){return{item:e.item,range:tc._createFromPositionAndShift(e.previousPosition,e.length)};}var lc=/*#__PURE__*/function(_L11){function lc(){var _this84;var _this83;_classCallCheck(this,lc);_this83=_callSuper(this,lc),_defineProperty(_assertThisInitialized(_this83),"_lastRangeBackward",!1),_defineProperty(_assertThisInitialized(_this83),"_attrs",new Map()),_defineProperty(_assertThisInitialized(_this83),"_ranges",[]),arguments.length&&(_this84=_this83).setTo.apply(_this84,arguments);return _this83;}_inherits(lc,_L11);return _createClass(lc,[{key:"anchor",get:function get(){if(this._ranges.length>0){var _e199=this._ranges[this._ranges.length-1];return this._lastRangeBackward?_e199.end:_e199.start;}return null;}},{key:"focus",get:function get(){if(this._ranges.length>0){var _e200=this._ranges[this._ranges.length-1];return this._lastRangeBackward?_e200.start:_e200.end;}return null;}},{key:"isCollapsed",get:function get(){return 1===this._ranges.length&&this._ranges[0].isCollapsed;}},{key:"rangeCount",get:function get(){return this._ranges.length;}},{key:"isBackward",get:function get(){return!this.isCollapsed&&this._lastRangeBackward;}},{key:"isEqual",value:function isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;var _iterator151=_createForOfIteratorHelper(this._ranges),_step151;try{for(_iterator151.s();!(_step151=_iterator151.n()).done;){var _t102=_step151.value;var _i113=!1;var _iterator152=_createForOfIteratorHelper(e._ranges),_step152;try{for(_iterator152.s();!(_step152=_iterator152.n()).done;){var _n60=_step152.value;if(_t102.isEqual(_n60)){_i113=!0;break;}}}catch(err){_iterator152.e(err);}finally{_iterator152.f();}if(!_i113)return!1;}}catch(err){_iterator151.e(err);}finally{_iterator151.f();}return!0;}},{key:"getRanges",value:/*#__PURE__*/_regeneratorRuntime().mark(function getRanges(){var _iterator153,_step153,_e201;return _regeneratorRuntime().wrap(function getRanges$(_context18){while(1)switch(_context18.prev=_context18.next){case 0:_iterator153=_createForOfIteratorHelper(this._ranges);_context18.prev=1;_iterator153.s();case 3:if((_step153=_iterator153.n()).done){_context18.next=9;break;}_e201=_step153.value;_context18.next=7;return new tc(_e201.start,_e201.end);case 7:_context18.next=3;break;case 9:_context18.next=14;break;case 11:_context18.prev=11;_context18.t0=_context18["catch"](1);_iterator153.e(_context18.t0);case 14:_context18.prev=14;_iterator153.f();return _context18.finish(14);case 17:case"end":return _context18.stop();}},getRanges,this,[[1,11,14,17]]);})},{key:"getFirstRange",value:function getFirstRange(){var e=null;var _iterator154=_createForOfIteratorHelper(this._ranges),_step154;try{for(_iterator154.s();!(_step154=_iterator154.n()).done;){var _t103=_step154.value;e&&!_t103.start.isBefore(e.start)||(e=_t103);}}catch(err){_iterator154.e(err);}finally{_iterator154.f();}return e?new tc(e.start,e.end):null;}},{key:"getLastRange",value:function getLastRange(){var e=null;var _iterator155=_createForOfIteratorHelper(this._ranges),_step155;try{for(_iterator155.s();!(_step155=_iterator155.n()).done;){var _t104=_step155.value;e&&!_t104.end.isAfter(e.end)||(e=_t104);}}catch(err){_iterator155.e(err);}finally{_iterator155.f();}return e?new tc(e.start,e.end):null;}},{key:"getFirstPosition",value:function getFirstPosition(){var e=this.getFirstRange();return e?e.start.clone():null;}},{key:"getLastPosition",value:function getLastPosition(){var e=this.getLastRange();return e?e.end.clone():null;}},{key:"setTo",value:function setTo(){for(var _len28=arguments.length,e=new Array(_len28),_key28=0;_key28<_len28;_key28++){e[_key28]=arguments[_key28];}var t=e[0],i=e[1],n=e[2];if("object"==_typeof(i)&&(n=i,i=void 0),null===t)this._setRanges([]);else if(t instanceof lc)this._setRanges(t.getRanges(),t.isBackward);else if(t&&"function"==typeof t.getRanges)this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof tc)this._setRanges([t],!!n&&!!n.backward);else if(t instanceof Zl)this._setRanges([new tc(t)]);else if(t instanceof $l){var _e202=!!n&&!!n.backward;var _s42;if("in"==i)_s42=tc._createIn(t);else if("on"==i)_s42=tc._createOn(t);else{if(void 0===i)throw new A("model-selection-setto-required-second-parameter",[this,t]);_s42=new tc(Zl._createAt(t,i));}this._setRanges([_s42],_e202);}else{if(!oo(t))throw new A("model-selection-setto-not-selectable",[this,t]);this._setRanges(t,n&&!!n.backward);}}},{key:"_setRanges",value:function _setRanges(e){var _this85=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=Array.from(e),n=i.some(function(t){if(!(t instanceof tc))throw new A("model-selection-set-ranges-not-range",[_this85,e]);return _this85._ranges.every(function(e){return!e.isEqual(t);});});(i.length!==this._ranges.length||n)&&(this._replaceAllRanges(i),this._lastRangeBackward=!!t,this.fire("change:range",{directChange:!0}));}},{key:"setFocus",value:function setFocus(e,t){if(null===this.anchor)throw new A("model-selection-setfocus-no-ranges",[this,e]);var i=Zl._createAt(e,t);if("same"==i.compareWith(this.focus))return;var n=this.anchor;this._ranges.length&&this._popRange(),"before"==i.compareWith(n)?(this._pushRange(new tc(i,n)),this._lastRangeBackward=!0):(this._pushRange(new tc(n,i)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0});}},{key:"getAttribute",value:function getAttribute(e){return this._attrs.get(e);}},{key:"getAttributes",value:function getAttributes(){return this._attrs.entries();}},{key:"getAttributeKeys",value:function getAttributeKeys(){return this._attrs.keys();}},{key:"hasAttribute",value:function hasAttribute(e){return this._attrs.has(e);}},{key:"removeAttribute",value:function removeAttribute(e){this.hasAttribute(e)&&(this._attrs["delete"](e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}));}},{key:"setAttribute",value:function setAttribute(e,t){this.getAttribute(e)!==t&&(this._attrs.set(e,t),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}));}},{key:"getSelectedElement",value:function getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement();}},{key:"getSelectedBlocks",value:/*#__PURE__*/_regeneratorRuntime().mark(function getSelectedBlocks(){var e,_iterator156,_step156,_t105,_i114,_iterator157,_step157,_i115,_n62,_n61;return _regeneratorRuntime().wrap(function getSelectedBlocks$(_context19){while(1)switch(_context19.prev=_context19.next){case 0:e=new WeakSet();_iterator156=_createForOfIteratorHelper(this.getRanges());_context19.prev=2;_iterator156.s();case 4:if((_step156=_iterator156.n()).done){_context19.next=38;break;}_t105=_step156.value;_i114=uc(_t105.start,e);_context19.t0=mc(_i114,_t105);if(!_context19.t0){_context19.next=11;break;}_context19.next=11;return _i114;case 11:_iterator157=_createForOfIteratorHelper(_t105.getWalker());_context19.prev=12;_iterator157.s();case 14:if((_step157=_iterator157.n()).done){_context19.next=23;break;}_i115=_step157.value;_n62=_i115.item;_context19.t1="elementEnd"==_i115.type&&dc(_n62,e,_t105);if(!_context19.t1){_context19.next=21;break;}_context19.next=21;return _n62;case 21:_context19.next=14;break;case 23:_context19.next=28;break;case 25:_context19.prev=25;_context19.t2=_context19["catch"](12);_iterator157.e(_context19.t2);case 28:_context19.prev=28;_iterator157.f();return _context19.finish(28);case 31:_n61=uc(_t105.end,e);_context19.t3=gc(_n61,_t105);if(!_context19.t3){_context19.next=36;break;}_context19.next=36;return _n61;case 36:_context19.next=4;break;case 38:_context19.next=43;break;case 40:_context19.prev=40;_context19.t4=_context19["catch"](2);_iterator156.e(_context19.t4);case 43:_context19.prev=43;_iterator156.f();return _context19.finish(43);case 46:case"end":return _context19.stop();}},getSelectedBlocks,this,[[2,40,43,46],[12,25,28,31]]);})},{key:"containsEntireContent",value:function containsEntireContent(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.anchor.root;var t=Zl._createAt(e,0),i=Zl._createAt(e,"end");return t.isTouching(this.getFirstPosition())&&i.isTouching(this.getLastPosition());}},{key:"_pushRange",value:function _pushRange(e){this._checkRange(e),this._ranges.push(new tc(e.start,e.end));}},{key:"_checkRange",value:function _checkRange(e){for(var _t106=0;_t106<this._ranges.length;_t106++)if(e.isIntersecting(this._ranges[_t106]))throw new A("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[_t106]});}},{key:"_replaceAllRanges",value:function _replaceAllRanges(e){this._removeAllRanges();var _iterator158=_createForOfIteratorHelper(e),_step158;try{for(_iterator158.s();!(_step158=_iterator158.n()).done;){var _t107=_step158.value;this._pushRange(_t107);}}catch(err){_iterator158.e(err);}finally{_iterator158.f();}}},{key:"_removeAllRanges",value:function _removeAllRanges(){for(;this._ranges.length>0;)this._popRange();}},{key:"_popRange",value:function _popRange(){this._ranges.pop();}}]);}(L(Hl));function cc(e,t){return!t.has(e)&&(t.add(e),e.root.document.model.schema.isBlock(e)&&!!e.parent);}function dc(e,t,i){return cc(e,t)&&hc(e,i);}function uc(e,t){var i=e.parent.root.document.model.schema,n=e.parent.getAncestors({parentFirst:!0,includeSelf:!0});var s=!1;var o=n.find(function(e){return!s&&(s=i.isLimit(e),!s&&cc(e,t));});return n.forEach(function(e){return t.add(e);}),o;}function hc(e,t){var i=function(e){var t=e.root.document.model.schema;var i=e.parent;for(;i;){if(t.isBlock(i))return i;i=i.parent;}}(e);if(!i)return!0;return!t.containsRange(tc._createOn(i),!0);}function mc(e,t){return!!e&&(!(!t.isCollapsed&&!e.isEmpty)||!t.start.isTouching(Zl._createAt(e,e.maxOffset))&&hc(e,t));}function gc(e,t){return!!e&&(!(!t.isCollapsed&&!e.isEmpty)||!t.end.isTouching(Zl._createAt(e,0))&&hc(e,t));}lc.prototype.is=function(e){return"selection"===e||"model:selection"===e;};var fc=/*#__PURE__*/function(_L12){function fc(e,t){var _this86;_classCallCheck(this,fc);_this86=_callSuper(this,fc,[e,t]),pc.call(_assertThisInitialized(_this86));return _this86;}_inherits(fc,_L12);return _createClass(fc,[{key:"detach",value:function detach(){this.stopListening();}},{key:"toRange",value:function toRange(){return new tc(this.start,this.end);}}],[{key:"fromRange",value:function fromRange(e){return new fc(e.start,e.end);}}]);}(L(tc));function pc(){var _this87=this;this.listenTo(this.root.document.model,"applyOperation",function(e,t){var i=t[0];i.isDocumentOperation&&bc.call(_this87,i);},{priority:"low"});}function bc(e){var t=this.getTransformedByOperation(e),i=tc._createFromRanges(t),n=!i.isEqual(this),s=function(e,t){switch(t.type){case"insert":return e.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return e.containsPosition(t.sourcePosition)||e.start.isEqual(t.sourcePosition)||e.containsPosition(t.targetPosition);case"split":return e.containsPosition(t.splitPosition)||e.containsPosition(t.insertionPosition);}return!1;}(this,e);var o=null;if(n){"$graveyard"==i.root.rootName&&(o="remove"==e.type?e.sourcePosition:e.deletionPosition);var _t108=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",_t108,{deletionPosition:o});}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o});}fc.prototype.is=function(e){return"liveRange"===e||"model:liveRange"===e||"range"==e||"model:range"===e;};var wc="selection:";var _c=/*#__PURE__*/function(_L13){function _c(e){var _this88;_classCallCheck(this,_c);_this88=_callSuper(this,_c),_defineProperty(_assertThisInitialized(_this88),"_selection",void 0),_this88._selection=new vc(e),_this88._selection.delegate("change:range").to(_assertThisInitialized(_this88)),_this88._selection.delegate("change:attribute").to(_assertThisInitialized(_this88)),_this88._selection.delegate("change:marker").to(_assertThisInitialized(_this88));return _this88;}_inherits(_c,_L13);return _createClass(_c,[{key:"isCollapsed",get:function get(){return this._selection.isCollapsed;}},{key:"anchor",get:function get(){return this._selection.anchor;}},{key:"focus",get:function get(){return this._selection.focus;}},{key:"rangeCount",get:function get(){return this._selection.rangeCount;}},{key:"hasOwnRange",get:function get(){return this._selection.hasOwnRange;}},{key:"isBackward",get:function get(){return this._selection.isBackward;}},{key:"isGravityOverridden",get:function get(){return this._selection.isGravityOverridden;}},{key:"markers",get:function get(){return this._selection.markers;}},{key:"_ranges",get:function get(){return this._selection._ranges;}},{key:"getRanges",value:function getRanges(){return this._selection.getRanges();}},{key:"getFirstPosition",value:function getFirstPosition(){return this._selection.getFirstPosition();}},{key:"getLastPosition",value:function getLastPosition(){return this._selection.getLastPosition();}},{key:"getFirstRange",value:function getFirstRange(){return this._selection.getFirstRange();}},{key:"getLastRange",value:function getLastRange(){return this._selection.getLastRange();}},{key:"getSelectedBlocks",value:function getSelectedBlocks(){return this._selection.getSelectedBlocks();}},{key:"getSelectedElement",value:function getSelectedElement(){return this._selection.getSelectedElement();}},{key:"containsEntireContent",value:function containsEntireContent(e){return this._selection.containsEntireContent(e);}},{key:"destroy",value:function destroy(){this._selection.destroy();}},{key:"getAttributeKeys",value:function getAttributeKeys(){return this._selection.getAttributeKeys();}},{key:"getAttributes",value:function getAttributes(){return this._selection.getAttributes();}},{key:"getAttribute",value:function getAttribute(e){return this._selection.getAttribute(e);}},{key:"hasAttribute",value:function hasAttribute(e){return this._selection.hasAttribute(e);}},{key:"refresh",value:function refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1);}},{key:"observeMarkers",value:function observeMarkers(e){this._selection.observeMarkers(e);}},{key:"_setFocus",value:function _setFocus(e,t){this._selection.setFocus(e,t);}},{key:"_setTo",value:function _setTo(){var _this$_selection2;(_this$_selection2=this._selection).setTo.apply(_this$_selection2,arguments);}},{key:"_setAttribute",value:function _setAttribute(e,t){this._selection.setAttribute(e,t);}},{key:"_removeAttribute",value:function _removeAttribute(e){this._selection.removeAttribute(e);}},{key:"_getStoredAttributes",value:function _getStoredAttributes(){return this._selection.getStoredAttributes();}},{key:"_overrideGravity",value:function _overrideGravity(){return this._selection.overrideGravity();}},{key:"_restoreGravity",value:function _restoreGravity(e){this._selection.restoreGravity(e);}}],[{key:"_getStoreAttributeKey",value:function _getStoreAttributeKey(e){return wc+e;}},{key:"_isStoreAttributeKey",value:function _isStoreAttributeKey(e){return e.startsWith(wc);}}]);}(L(Hl));_c.prototype.is=function(e){return"selection"===e||"model:selection"==e||"documentSelection"==e||"model:documentSelection"==e;};var vc=/*#__PURE__*/function(_lc2){function vc(e){var _this89;_classCallCheck(this,vc);_this89=_callSuper(this,vc),_defineProperty(_assertThisInitialized(_this89),"markers",new br({idProperty:"name"})),_defineProperty(_assertThisInitialized(_this89),"_model",void 0),_defineProperty(_assertThisInitialized(_this89),"_document",void 0),_defineProperty(_assertThisInitialized(_this89),"_attributePriority",new Map()),_defineProperty(_assertThisInitialized(_this89),"_selectionRestorePosition",null),_defineProperty(_assertThisInitialized(_this89),"_hasChangedRange",!1),_defineProperty(_assertThisInitialized(_this89),"_overriddenGravityRegister",new Set()),_defineProperty(_assertThisInitialized(_this89),"_observedMarkers",new Set()),_this89._model=e.model,_this89._document=e,_this89.listenTo(_this89._model,"applyOperation",function(e,t){var i=t[0];i.isDocumentOperation&&"marker"!=i.type&&"rename"!=i.type&&"noop"!=i.type&&(0==_this89._ranges.length&&_this89._selectionRestorePosition&&_this89._fixGraveyardSelection(_this89._selectionRestorePosition),_this89._selectionRestorePosition=null,_this89._hasChangedRange&&(_this89._hasChangedRange=!1,_this89.fire("change:range",{directChange:!1})));},{priority:"lowest"}),_this89.on("change:range",function(){_this89._validateSelectionRanges(_this89.getRanges());}),_this89.listenTo(_this89._model.markers,"update",function(e,t,i,n){_this89._updateMarker(t,n);}),_this89.listenTo(_this89._document,"change",function(e,t){!function(e,t){var i=e.document.differ;var _iterator159=_createForOfIteratorHelper(i.getChanges()),_step159;try{var _loop2=function _loop2(){var n=_step159.value;if("insert"!=n.type)return 1;// continue
var i=n.position.parent;n.length===i.maxOffset&&e.enqueueChange(t,function(e){var t=Array.from(i.getAttributeKeys()).filter(function(e){return e.startsWith(wc);});var _iterator160=_createForOfIteratorHelper(t),_step160;try{for(_iterator160.s();!(_step160=_iterator160.n()).done;){var _n63=_step160.value;e.removeAttribute(_n63,i);}}catch(err){_iterator160.e(err);}finally{_iterator160.f();}});};for(_iterator159.s();!(_step159=_iterator159.n()).done;){if(_loop2())continue;}}catch(err){_iterator159.e(err);}finally{_iterator159.f();}}(_this89._model,t);});return _this89;}_inherits(vc,_lc2);return _createClass(vc,[{key:"isCollapsed",get:function get(){return 0===this._ranges.length?this._document._getDefaultRange().isCollapsed:_superPropGet(vc,"isCollapsed",this,1);}},{key:"anchor",get:function get(){return _superPropGet(vc,"anchor",this,1)||this._document._getDefaultRange().start;}},{key:"focus",get:function get(){return _superPropGet(vc,"focus",this,1)||this._document._getDefaultRange().end;}},{key:"rangeCount",get:function get(){return this._ranges.length?this._ranges.length:1;}},{key:"hasOwnRange",get:function get(){return this._ranges.length>0;}},{key:"isGravityOverridden",get:function get(){return!!this._overriddenGravityRegister.size;}},{key:"destroy",value:function destroy(){for(var _e203=0;_e203<this._ranges.length;_e203++)this._ranges[_e203].detach();this.stopListening();}},{key:"getRanges",value:/*#__PURE__*/_regeneratorRuntime().mark(function getRanges(){return _regeneratorRuntime().wrap(function getRanges$(_context20){while(1)switch(_context20.prev=_context20.next){case 0:if(!this._ranges.length){_context20.next=4;break;}return _context20.delegateYield(_superPropGet(vc,"getRanges",this,3)([]),"t0",2);case 2:_context20.next=6;break;case 4:_context20.next=6;return this._document._getDefaultRange();case 6:case"end":return _context20.stop();}},getRanges,this);})},{key:"getFirstRange",value:function getFirstRange(){return _superPropGet(vc,"getFirstRange",this,3)([])||this._document._getDefaultRange();}},{key:"getLastRange",value:function getLastRange(){return _superPropGet(vc,"getLastRange",this,3)([])||this._document._getDefaultRange();}},{key:"setTo",value:function setTo(){for(var _len29=arguments.length,e=new Array(_len29),_key29=0;_key29<_len29;_key29++){e[_key29]=arguments[_key29];}_superPropGet(vc,"setTo",this,3)(e),this._updateAttributes(!0),this.updateMarkers();}},{key:"setFocus",value:function setFocus(e,t){_superPropGet(vc,"setFocus",this,3)([e,t]),this._updateAttributes(!0),this.updateMarkers();}},{key:"setAttribute",value:function setAttribute(e,t){if(this._setAttribute(e,t)){var _t109=[e];this.fire("change:attribute",{attributeKeys:_t109,directChange:!0});}}},{key:"removeAttribute",value:function removeAttribute(e){if(this._removeAttribute(e)){var _t110=[e];this.fire("change:attribute",{attributeKeys:_t110,directChange:!0});}}},{key:"overrideGravity",value:function overrideGravity(){var e=k();return this._overriddenGravityRegister.add(e),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),e;}},{key:"restoreGravity",value:function restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new A("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister["delete"](e),this.isGravityOverridden||this._updateAttributes(!0);}},{key:"observeMarkers",value:function observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers();}},{key:"_replaceAllRanges",value:function _replaceAllRanges(e){this._validateSelectionRanges(e),_superPropGet(vc,"_replaceAllRanges",this,3)([e]);}},{key:"_popRange",value:function _popRange(){this._ranges.pop().detach();}},{key:"_pushRange",value:function _pushRange(e){var t=this._prepareRange(e);t&&this._ranges.push(t);}},{key:"_validateSelectionRanges",value:function _validateSelectionRanges(e){var _iterator161=_createForOfIteratorHelper(e),_step161;try{for(_iterator161.s();!(_step161=_iterator161.n()).done;){var _t111=_step161.value;if(!this._document._validateSelectionRange(_t111))throw new A("document-selection-wrong-position",this,{range:_t111});}}catch(err){_iterator161.e(err);}finally{_iterator161.f();}}},{key:"_prepareRange",value:function _prepareRange(e){var _this90=this;if(this._checkRange(e),e.root==this._document.graveyard)return;var t=fc.fromRange(e);return t.on("change:range",function(e,i,n){if(_this90._hasChangedRange=!0,t.root==_this90._document.graveyard){_this90._selectionRestorePosition=n.deletionPosition;var _e204=_this90._ranges.indexOf(t);_this90._ranges.splice(_e204,1),t.detach();}}),t;}},{key:"updateMarkers",value:function updateMarkers(){if(!this._observedMarkers.size)return;var e=[];var t=!1;var _iterator162=_createForOfIteratorHelper(this._model.markers),_step162;try{for(_iterator162.s();!(_step162=_iterator162.n()).done;){var _t112=_step162.value;var _i120=_t112.name.split(":",1)[0];if(!this._observedMarkers.has(_i120))continue;var _n64=_t112.getRange();var _iterator163=_createForOfIteratorHelper(this.getRanges()),_step163;try{for(_iterator163.s();!(_step163=_iterator163.n()).done;){var _i121=_step163.value;_n64.containsRange(_i121,!_i121.isCollapsed)&&e.push(_t112);}}catch(err){_iterator163.e(err);}finally{_iterator163.f();}}}catch(err){_iterator162.e(err);}finally{_iterator162.f();}var i=Array.from(this.markers);for(var _i116=0,_e205=e;_i116<_e205.length;_i116++){var _i117=_e205[_i116];this.markers.has(_i117)||(this.markers.add(_i117),t=!0);}for(var _i118=0,_Array$from3=Array.from(this.markers);_i118<_Array$from3.length;_i118++){var _i119=_Array$from3[_i118];e.includes(_i119)||(this.markers.remove(_i119),t=!0);}t&&this.fire("change:marker",{oldMarkers:i,directChange:!1});}},{key:"_updateMarker",value:function _updateMarker(e,t){var i=e.name.split(":",1)[0];if(!this._observedMarkers.has(i))return;var n=!1;var s=Array.from(this.markers),o=this.markers.has(e);if(t){var _i122=!1;var _iterator164=_createForOfIteratorHelper(this.getRanges()),_step164;try{for(_iterator164.s();!(_step164=_iterator164.n()).done;){var _e206=_step164.value;if(t.containsRange(_e206,!_e206.isCollapsed)){_i122=!0;break;}}}catch(err){_iterator164.e(err);}finally{_iterator164.f();}_i122&&!o?(this.markers.add(e),n=!0):!_i122&&o&&(this.markers.remove(e),n=!0);}else o&&(this.markers.remove(e),n=!0);n&&this.fire("change:marker",{oldMarkers:s,directChange:!1});}},{key:"_updateAttributes",value:function _updateAttributes(e){var t=xr(this._getSurroundingAttributes()),i=xr(this.getAttributes());if(e)this._attributePriority=new Map(),this._attrs=new Map();else{var _iterator165=_createForOfIteratorHelper(this._attributePriority),_step165;try{for(_iterator165.s();!(_step165=_iterator165.n()).done;){var _step165$value=_slicedToArray(_step165.value,2),_e207=_step165$value[0],_t113=_step165$value[1];"low"==_t113&&(this._attrs["delete"](_e207),this._attributePriority["delete"](_e207));}}catch(err){_iterator165.e(err);}finally{_iterator165.f();}}this._setAttributesTo(t);var n=[];var _iterator166=_createForOfIteratorHelper(this.getAttributes()),_step166;try{for(_iterator166.s();!(_step166=_iterator166.n()).done;){var _step166$value=_slicedToArray(_step166.value,2),_e208=_step166$value[0],_t114=_step166$value[1];i.has(_e208)&&i.get(_e208)===_t114||n.push(_e208);}}catch(err){_iterator166.e(err);}finally{_iterator166.f();}var _iterator167=_createForOfIteratorHelper(i),_step167;try{for(_iterator167.s();!(_step167=_iterator167.n()).done;){var _step167$value=_slicedToArray(_step167.value,1),_e209=_step167$value[0];this.hasAttribute(_e209)||n.push(_e209);}}catch(err){_iterator167.e(err);}finally{_iterator167.f();}n.length>0&&this.fire("change:attribute",{attributeKeys:n,directChange:!1});}},{key:"_setAttribute",value:function _setAttribute(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!0;var n=i?"normal":"low";if("low"==n&&"normal"==this._attributePriority.get(e))return!1;return _superPropGet(vc,"getAttribute",this,3)([e])!==t&&(this._attrs.set(e,t),this._attributePriority.set(e,n),!0);}},{key:"_removeAttribute",value:function _removeAttribute(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var i=t?"normal":"low";return("low"!=i||"normal"!=this._attributePriority.get(e))&&(this._attributePriority.set(e,i),!!_superPropGet(vc,"hasAttribute",this,3)([e])&&(this._attrs["delete"](e),!0));}},{key:"_setAttributesTo",value:function _setAttributesTo(e){var t=new Set();var _iterator168=_createForOfIteratorHelper(this.getAttributes()),_step168;try{for(_iterator168.s();!(_step168=_iterator168.n()).done;){var _step168$value=_slicedToArray(_step168.value,2),_t115=_step168$value[0],_i123=_step168$value[1];e.get(_t115)!==_i123&&this._removeAttribute(_t115,!1);}}catch(err){_iterator168.e(err);}finally{_iterator168.f();}var _iterator169=_createForOfIteratorHelper(e),_step169;try{for(_iterator169.s();!(_step169=_iterator169.n()).done;){var _step169$value=_slicedToArray(_step169.value,2),_i124=_step169$value[0],_n65=_step169$value[1];this._setAttribute(_i124,_n65,!1)&&t.add(_i124);}}catch(err){_iterator169.e(err);}finally{_iterator169.f();}return t;}},{key:"getStoredAttributes",value:/*#__PURE__*/_regeneratorRuntime().mark(function getStoredAttributes(){var e,_iterator170,_step170,_t116,_i125;return _regeneratorRuntime().wrap(function getStoredAttributes$(_context21){while(1)switch(_context21.prev=_context21.next){case 0:e=this.getFirstPosition().parent;if(!(this.isCollapsed&&e.isEmpty)){_context21.next=21;break;}_iterator170=_createForOfIteratorHelper(e.getAttributeKeys());_context21.prev=3;_iterator170.s();case 5:if((_step170=_iterator170.n()).done){_context21.next=13;break;}_t116=_step170.value;if(!_t116.startsWith(wc)){_context21.next=11;break;}_i125=_t116.substr(10);_context21.next=11;return[_i125,e.getAttribute(_t116)];case 11:_context21.next=5;break;case 13:_context21.next=18;break;case 15:_context21.prev=15;_context21.t0=_context21["catch"](3);_iterator170.e(_context21.t0);case 18:_context21.prev=18;_iterator170.f();return _context21.finish(18);case 21:case"end":return _context21.stop();}},getStoredAttributes,this,[[3,15,18,21]]);})},{key:"_getSurroundingAttributes",value:function _getSurroundingAttributes(){var e=this.getFirstPosition(),t=this._model.schema;if("$graveyard"==e.root.rootName)return null;var i=null;if(this.isCollapsed){var _n66=e.textNode?e.textNode:e.nodeBefore,_s43=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(i=yc(_n66,t)),i||(i=yc(_s43,t)),!this.isGravityOverridden&&!i){var _e210=_n66;for(;_e210&&!i;)_e210=_e210.previousSibling,i=yc(_e210,t);}if(!i){var _e211=_s43;for(;_e211&&!i;)_e211=_e211.nextSibling,i=yc(_e211,t);}i||(i=this.getStoredAttributes());}else{var _e212=this.getFirstRange();var _iterator171=_createForOfIteratorHelper(_e212),_step171;try{for(_iterator171.s();!(_step171=_iterator171.n()).done;){var _n67=_step171.value;if(_n67.item.is("element")&&t.isObject(_n67.item)){i=yc(_n67.item,t);break;}if("text"==_n67.type){i=_n67.item.getAttributes();break;}}}catch(err){_iterator171.e(err);}finally{_iterator171.f();}}return i;}},{key:"_fixGraveyardSelection",value:function _fixGraveyardSelection(e){var t=this._model.schema.getNearestSelectionRange(e);t&&this._pushRange(t);}}]);}(lc);function yc(e,t){if(!e)return null;if(e instanceof jl||e instanceof Wl)return e.getAttributes();if(!t.isInline(e))return null;if(!t.isObject(e))return[];var i=[];var _iterator172=_createForOfIteratorHelper(e.getAttributes()),_step172;try{for(_iterator172.s();!(_step172=_iterator172.n()).done;){var _step172$value=_slicedToArray(_step172.value,2),_n68=_step172$value[0],_s44=_step172$value[1];t.checkAttribute("$text",_n68)&&!1!==t.getAttributeProperties(_n68).copyFromObject&&i.push([_n68,_s44]);}}catch(err){_iterator172.e(err);}finally{_iterator172.f();}return i;}var kc=/*#__PURE__*/function(){function kc(e){_classCallCheck(this,kc);_defineProperty(this,"_dispatchers",void 0);this._dispatchers=e;}return _createClass(kc,[{key:"add",value:function add(e){var _iterator173=_createForOfIteratorHelper(this._dispatchers),_step173;try{for(_iterator173.s();!(_step173=_iterator173.n()).done;){var _t117=_step173.value;e(_t117);}}catch(err){_iterator173.e(err);}finally{_iterator173.f();}return this;}}]);}();var Cc=/*#__PURE__*/function(_kc2){function Cc(){_classCallCheck(this,Cc);return _callSuper(this,Cc,arguments);}_inherits(Cc,_kc2);return _createClass(Cc,[{key:"elementToElement",value:function elementToElement(e){return this.add(function(e){var t=Sc(e.model),i=Ic(e.view,"container");t.attributes.length&&(t.children=!0);return function(n){n.on("insert:".concat(t.name),Ec(i,Mc(t)),{priority:e.converterPriority||"normal"}),(t.children||t.attributes.length)&&n.on("reduceChanges",Bc(t),{priority:"low"});};}(e));}},{key:"elementToStructure",value:function elementToStructure(e){return this.add(function(e){var t=Sc(e.model),i=Ic(e.view,"container");return t.children=!0,function(n){if(n._conversionApi.schema.checkChild(t.name,"$text"))throw new A("conversion-element-to-structure-disallowed-text",n,{elementName:t.name});var s,o;n.on("insert:".concat(t.name),(s=i,o=Mc(t),function(e,t,i){if(!o(t.item,i.consumable,{preflight:!0}))return;var n=new Map();i.writer._registerSlotFactory(function(e,t,i){return function(n,s){var o=n.createContainerElement("$slot");var r=null;if("children"===s)r=Array.from(e.getChildren());else{if("function"!=typeof s)throw new A("conversion-slot-mode-unknown",i.dispatcher,{modeOrFilter:s});r=Array.from(e.getChildren()).filter(function(e){return s(e);});}return t.set(o,r),o;};}(t.item,n,i));var r=s(t.item,i,t);if(i.writer._clearSlotFactory(),!r)return;!function(e,t,i){var n=Array.from(t.values()).flat(),s=new Set(n);if(s.size!=n.length)throw new A("conversion-slot-filter-overlap",i.dispatcher,{element:e});if(s.size!=e.childCount)throw new A("conversion-slot-filter-incomplete",i.dispatcher,{element:e});}(t.item,n,i),o(t.item,i.consumable);var a=i.mapper.toViewPosition(t.range.start);i.mapper.bindElements(t.item,r),i.writer.insert(a,r),i.convertAttributes(t.item),function(e,t,i,n){i.mapper.on("modelToViewPosition",r,{priority:"highest"});var s=null,o=null;var _iterator174=_createForOfIteratorHelper(t),_step174;try{for(_iterator174.s();!(_step174=_iterator174.n()).done;){var _step174$value=_slicedToArray(_step174.value,2);s=_step174$value[0];o=_step174$value[1];Lc(e,o,i,n),i.writer.move(i.writer.createRangeIn(s),i.writer.createPositionBefore(s)),i.writer.remove(s);}}catch(err){_iterator174.e(err);}finally{_iterator174.f();}function r(e,t){var i=t.modelPosition.nodeAfter,n=o.indexOf(i);n<0||(t.viewPosition=t.mapper.findPositionIn(s,n));}i.mapper.off("modelToViewPosition",r);}(r,n,i,{reconversion:t.reconversion});}),{priority:e.converterPriority||"normal"}),n.on("reduceChanges",Bc(t),{priority:"low"});};}(e));}},{key:"attributeToElement",value:function attributeToElement(e){return this.add(function(e){e=Un(e);var t=e.model;"string"==typeof t&&(t={key:t});var i="attribute:".concat(t.key);t.name&&(i+=":"+t.name);if(t.values){var _iterator175=_createForOfIteratorHelper(t.values),_step175;try{for(_iterator175.s();!(_step175=_iterator175.n()).done;){var _i126=_step175.value;e.view[_i126]=Ic(e.view[_i126],"attribute");}}catch(err){_iterator175.e(err);}finally{_iterator175.f();}}else e.view=Ic(e.view,"attribute");var n=Vc(e);return function(t){t.on(i,Ac(n),{priority:e.converterPriority||"normal"});};}(e));}},{key:"attributeToAttribute",value:function attributeToAttribute(e){return this.add(function(e){e=Un(e);var t=e.model;"string"==typeof t&&(t={key:t});var i="attribute:".concat(t.key);t.name&&(i+=":"+t.name);if(t.values){var _iterator176=_createForOfIteratorHelper(t.values),_step176;try{for(_iterator176.s();!(_step176=_iterator176.n()).done;){var _i127=_step176.value;e.view[_i127]=Rc(e.view[_i127]);}}catch(err){_iterator176.e(err);}finally{_iterator176.f();}}else e.view=Rc(e.view);var n=Vc(e);return function(t){var s;t.on(i,(s=n,function(e,t,i){if(!i.consumable.test(t.item,e.name))return;var n=s(t.attributeOldValue,i,t),o=s(t.attributeNewValue,i,t);if(!n&&!o)return;i.consumable.consume(t.item,e.name);var r=i.mapper.toViewElement(t.item),a=i.writer;if(!r)throw new A("conversion-attribute-to-attribute-on-text",i.dispatcher,t);if(null!==t.attributeOldValue&&n)if("class"==n.key){var _e213="string"==typeof n.value?n.value.split(/\s+/):n.value;var _iterator177=_createForOfIteratorHelper(_e213),_step177;try{for(_iterator177.s();!(_step177=_iterator177.n()).done;){var _t118=_step177.value;a.removeClass(_t118,r);}}catch(err){_iterator177.e(err);}finally{_iterator177.f();}}else if("style"==n.key){if("string"==typeof n.value){var _e214=new da(a.document.stylesProcessor);_e214.setTo(n.value);var _iterator178=_createForOfIteratorHelper(_e214.getStylesEntries()),_step178;try{for(_iterator178.s();!(_step178=_iterator178.n()).done;){var _step178$value=_slicedToArray(_step178.value,1),_t119=_step178$value[0];a.removeStyle(_t119,r);}}catch(err){_iterator178.e(err);}finally{_iterator178.f();}}else{var _e215=Object.keys(n.value);for(var _i128=0,_e216=_e215;_i128<_e216.length;_i128++){var _t120=_e216[_i128];a.removeStyle(_t120,r);}}}else a.removeAttribute(n.key,r);if(null!==t.attributeNewValue&&o)if("class"==o.key){var _e217="string"==typeof o.value?o.value.split(/\s+/):o.value;var _iterator179=_createForOfIteratorHelper(_e217),_step179;try{for(_iterator179.s();!(_step179=_iterator179.n()).done;){var _t121=_step179.value;a.addClass(_t121,r);}}catch(err){_iterator179.e(err);}finally{_iterator179.f();}}else if("style"==o.key){if("string"==typeof o.value){var _e218=new da(a.document.stylesProcessor);_e218.setTo(o.value);var _iterator180=_createForOfIteratorHelper(_e218.getStylesEntries()),_step180;try{for(_iterator180.s();!(_step180=_iterator180.n()).done;){var _step180$value=_slicedToArray(_step180.value,2),_t122=_step180$value[0],_i129=_step180$value[1];a.setStyle(_t122,_i129,r);}}catch(err){_iterator180.e(err);}finally{_iterator180.f();}}else{var _e219=Object.keys(o.value);for(var _i130=0,_e220=_e219;_i130<_e220.length;_i130++){var _t123=_e220[_i130];a.setStyle(_t123,o.value[_t123],r);}}}else a.setAttribute(o.key,o.value,r);}),{priority:e.converterPriority||"normal"});};}(e));}},{key:"markerToElement",value:function markerToElement(e){return this.add(function(e){var t=Ic(e.view,"ui");return function(i){i.on("addMarker:".concat(e.model),Tc(t),{priority:e.converterPriority||"normal"}),i.on("removeMarker:".concat(e.model),function(e,t,i){var n=i.mapper.markerNameToElements(t.markerName);if(n){var _iterator181=_createForOfIteratorHelper(n),_step181;try{for(_iterator181.s();!(_step181=_iterator181.n()).done;){var _e221=_step181.value;i.mapper.unbindElementFromMarkerName(_e221,t.markerName),i.writer.clear(i.writer.createRangeOn(_e221),_e221);}}catch(err){_iterator181.e(err);}finally{_iterator181.f();}i.writer.clearClonedElementsGroup(t.markerName),e.stop();}},{priority:e.converterPriority||"normal"});};}(e));}},{key:"markerToHighlight",value:function markerToHighlight(e){return this.add(function(e){return function(t){var i;t.on("addMarker:".concat(e.model),(i=e.view,function(e,t,n){if(!t.item)return;if(!(t.item instanceof lc||t.item instanceof _c||t.item.is("$textProxy")))return;var s=Oc(i,t,n);if(!s)return;if(!n.consumable.consume(t.item,e.name))return;var o=n.writer,r=xc(o,s),a=o.document.selection;if(t.item instanceof lc||t.item instanceof _c)o.wrap(a.getFirstRange(),r);else{var _e222=n.mapper.toViewRange(t.range),_i131=o.wrap(_e222,r);var _iterator182=_createForOfIteratorHelper(_i131.getItems()),_step182;try{for(_iterator182.s();!(_step182=_iterator182.n()).done;){var _e223=_step182.value;if(_e223.is("attributeElement")&&_e223.isSimilar(r)){n.mapper.bindElementToMarker(_e223,t.markerName);break;}}}catch(err){_iterator182.e(err);}finally{_iterator182.f();}}}),{priority:e.converterPriority||"normal"}),t.on("addMarker:".concat(e.model),function(e){return function(t,i,n){if(!i.item)return;if(!(i.item instanceof ql))return;var s=Oc(e,i,n);if(!s)return;if(!n.consumable.test(i.item,t.name))return;var o=n.mapper.toViewElement(i.item);if(o&&o.getCustomProperty("addHighlight")){n.consumable.consume(i.item,t.name);var _iterator183=_createForOfIteratorHelper(tc._createIn(i.item)),_step183;try{for(_iterator183.s();!(_step183=_iterator183.n()).done;){var _e224=_step183.value;n.consumable.consume(_e224.item,t.name);}}catch(err){_iterator183.e(err);}finally{_iterator183.f();}o.getCustomProperty("addHighlight")(o,s,n.writer),n.mapper.bindElementToMarker(o,i.markerName);}};}(e.view),{priority:e.converterPriority||"normal"}),t.on("removeMarker:".concat(e.model),function(e){return function(t,i,n){if(i.markerRange.isCollapsed)return;var s=Oc(e,i,n);if(!s)return;var o=xc(n.writer,s),r=n.mapper.markerNameToElements(i.markerName);if(r){var _iterator184=_createForOfIteratorHelper(r),_step184;try{for(_iterator184.s();!(_step184=_iterator184.n()).done;){var _e225=_step184.value;if(n.mapper.unbindElementFromMarkerName(_e225,i.markerName),_e225.is("attributeElement"))n.writer.unwrap(n.writer.createRangeOn(_e225),o);else{_e225.getCustomProperty("removeHighlight")(_e225,s.id,n.writer);}}}catch(err){_iterator184.e(err);}finally{_iterator184.f();}n.writer.clearClonedElementsGroup(i.markerName),t.stop();}};}(e.view),{priority:e.converterPriority||"normal"});};}(e));}},{key:"markerToData",value:function markerToData(e){return this.add(function(e){e=Un(e);var t=e.model;var i=e.view;i||(i=function i(_i132){return{group:t,name:_i132.substr(e.model.length+1)};});return function(n){var s;n.on("addMarker:".concat(t),(s=i,function(e,t,i){var n=s(t.markerName,i);if(!n)return;var o=t.markerRange;i.consumable.consume(o,e.name)&&(Pc(o,!1,i,t,n),Pc(o,!0,i,t,n),e.stop());}),{priority:e.converterPriority||"normal"}),n.on("removeMarker:".concat(t),function(e){return function(t,i,n){var s=e(i.markerName,n);if(!s)return;var o=n.mapper.markerNameToElements(i.markerName);if(o){var _iterator185=_createForOfIteratorHelper(o),_step185;try{for(_iterator185.s();!(_step185=_iterator185.n()).done;){var _e226=_step185.value;n.mapper.unbindElementFromMarkerName(_e226,i.markerName),_e226.is("containerElement")?(r("data-".concat(s.group,"-start-before"),_e226),r("data-".concat(s.group,"-start-after"),_e226),r("data-".concat(s.group,"-end-before"),_e226),r("data-".concat(s.group,"-end-after"),_e226)):n.writer.clear(n.writer.createRangeOn(_e226),_e226);}}catch(err){_iterator185.e(err);}finally{_iterator185.f();}n.writer.clearClonedElementsGroup(i.markerName),t.stop();}function r(e,t){if(t.hasAttribute(e)){var _i133=new Set(t.getAttribute(e).split(","));_i133["delete"](s.name),0==_i133.size?n.writer.removeAttribute(e,t):n.writer.setAttribute(e,Array.from(_i133).join(","),t);}}};}(i),{priority:e.converterPriority||"normal"});};}(e));}}]);}(kc);function xc(e,t){var i=e.createAttributeElement("span",t.attributes);return t.classes&&i._addClass(t.classes),"number"==typeof t.priority&&(i._priority=t.priority),i._id=t.id,i;}function Ac(e){return function(t,i,n){if(!n.consumable.test(i.item,t.name))return;var s=e(i.attributeOldValue,n,i),o=e(i.attributeNewValue,n,i);if(!s&&!o)return;n.consumable.consume(i.item,t.name);var r=n.writer,a=r.document.selection;if(i.item instanceof lc||i.item instanceof _c)r.wrap(a.getFirstRange(),o);else{var _e227=n.mapper.toViewRange(i.range);null!==i.attributeOldValue&&s&&(_e227=r.unwrap(_e227,s)),null!==i.attributeNewValue&&o&&r.wrap(_e227,o);}};}function Ec(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Nc;return function(i,n,s){if(!t(n.item,s.consumable,{preflight:!0}))return;var o=e(n.item,s,n);if(!o)return;t(n.item,s.consumable);var r=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,o),s.writer.insert(r,o),s.convertAttributes(n.item),Lc(o,n.item.getChildren(),s,{reconversion:n.reconversion});};}function Tc(e){return function(t,i,n){i.isOpening=!0;var s=e(i,n);i.isOpening=!1;var o=e(i,n);if(!s||!o)return;var r=i.markerRange;if(r.isCollapsed&&!n.consumable.consume(r,t.name))return;var _iterator186=_createForOfIteratorHelper(r),_step186;try{for(_iterator186.s();!(_step186=_iterator186.n()).done;){var _e228=_step186.value;if(!n.consumable.consume(_e228.item,t.name))return;}}catch(err){_iterator186.e(err);}finally{_iterator186.f();}var a=n.mapper,l=n.writer;l.insert(a.toViewPosition(r.start),s),n.mapper.bindElementToMarker(s,i.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),o),n.mapper.bindElementToMarker(o,i.markerName)),t.stop();};}function Pc(e,t,i,n,s){var o=t?e.start:e.end,r=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,a=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(r||a){var _e229,_o23;t&&r||!t&&!a?(_e229=r,_o23=!0):(_e229=a,_o23=!1);var _l6=i.mapper.toViewElement(_e229);if(_l6)return void function(e,t,i,n,s,o){var r="data-".concat(o.group,"-").concat(t?"start":"end","-").concat(i?"before":"after"),a=e.hasAttribute(r)?e.getAttribute(r).split(","):[];a.unshift(o.name),n.writer.setAttribute(r,a.join(","),e),n.mapper.bindElementToMarker(e,s.markerName);}(_l6,t,_o23,i,n,s);}!function(e,t,i,n,s){var o="".concat(s.group,"-").concat(t?"start":"end"),r=s.name?{name:s.name}:null,a=i.writer.createUIElement(o,r);i.writer.insert(e,a),i.mapper.bindElementToMarker(a,n.markerName);}(i.mapper.toViewPosition(o),t,i,n,s);}function Sc(e){return"string"==typeof e&&(e={name:e}),{name:e.name,attributes:e.attributes?gr(e.attributes):[],children:!!e.children};}function Ic(e,t){return"function"==typeof e?e:function(i,n){return function(e,t,i){"string"==typeof e&&(e={name:e});var n;var s=t.writer,o=Object.assign({},e.attributes);if("container"==i)n=s.createContainerElement(e.name,o);else if("attribute"==i){var _t124={priority:e.priority||Ma.DEFAULT_PRIORITY};n=s.createAttributeElement(e.name,o,_t124);}else n=s.createUIElement(e.name,o);if(e.styles){var _t125=Object.keys(e.styles);for(var _i134=0,_t126=_t125;_i134<_t126.length;_i134++){var _i135=_t126[_i134];s.setStyle(_i135,e.styles[_i135],n);}}if(e.classes){var _t127=e.classes;if("string"==typeof _t127)s.addClass(_t127,n);else{var _iterator187=_createForOfIteratorHelper(_t127),_step187;try{for(_iterator187.s();!(_step187=_iterator187.n()).done;){var _e230=_step187.value;s.addClass(_e230,n);}}catch(err){_iterator187.e(err);}finally{_iterator187.f();}}}return n;}(e,n,t);};}function Vc(e){return e.model.values?function(t,i,n){var s=e.view[t];return s?s(t,i,n):null;}:e.view;}function Rc(e){return"string"==typeof e?function(t){return{key:e,value:t};}:"object"==_typeof(e)?e.value?function(){return e;}:function(t){return{key:e.key,value:t};}:e;}function Oc(e,t,i){var n="function"==typeof e?e(t,i):e;return n?(n.priority||(n.priority=10),n.id||(n.id=t.markerName),n):null;}function Bc(e){var t=function(e){return function(t,i){if(!t.is("element",e.name))return!1;if("attribute"==i.type){if(e.attributes.includes(i.attributeKey))return!0;}else if(e.children)return!0;return!1;};}(e);return function(e,i){var n=[];i.reconvertedElements||(i.reconvertedElements=new Set());var _iterator188=_createForOfIteratorHelper(i.changes),_step188;try{for(_iterator188.s();!(_step188=_iterator188.n()).done;){var _e231=_step188.value;var _s45="attribute"==_e231.type?_e231.range.start.nodeAfter:_e231.position.parent;if(_s45&&t(_s45,_e231)){if(!i.reconvertedElements.has(_s45)){i.reconvertedElements.add(_s45);var _e232=Zl._createBefore(_s45);var _t128=n.length;for(var _i136=n.length-1;_i136>=0;_i136--){var _s46=n[_i136],_o24=("attribute"==_s46.type?_s46.range.start:_s46.position).compareWith(_e232);if("before"==_o24||"remove"==_s46.type&&"same"==_o24)break;_t128=_i136;}n.splice(_t128,0,{type:"remove",name:_s45.name,position:_e232,length:1},{type:"reinsert",name:_s45.name,position:_e232,length:1});}}else n.push(_e231);}}catch(err){_iterator188.e(err);}finally{_iterator188.f();}i.changes=n;};}function Mc(e){return function(t,i){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var s=["insert"];var _iterator189=_createForOfIteratorHelper(e.attributes),_step189;try{for(_iterator189.s();!(_step189=_iterator189.n()).done;){var _i137=_step189.value;t.hasAttribute(_i137)&&s.push("attribute:".concat(_i137));}}catch(err){_iterator189.e(err);}finally{_iterator189.f();}return!!s.every(function(e){return i.test(t,e);})&&(n.preflight||s.forEach(function(e){return i.consume(t,e);}),!0);};}function Lc(e,t,i,n){var _iterator190=_createForOfIteratorHelper(t),_step190;try{for(_iterator190.s();!(_step190=_iterator190.n()).done;){var _s47=_step190.value;Fc(e.root,_s47,i,n)||i.convertItem(_s47);}}catch(err){_iterator190.e(err);}finally{_iterator190.f();}}function Fc(e,t,i,n){var s=i.writer,o=i.mapper;if(!n.reconversion)return!1;var r=o.toViewElement(t);return!(!r||r.root==e)&&!!i.canReuseView(r)&&(s.move(s.createRangeOn(r),o.toViewPosition(Zl._createBefore(t))),!0);}function Nc(e,t){var _ref28=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=_ref28.preflight;return i?t.test(e,"insert"):t.consume(e,"insert");}function Dc(e){var _e$model=e.model,t=_e$model.schema,i=_e$model.document;var _iterator191=_createForOfIteratorHelper(i.getRoots()),_step191;try{for(_iterator191.s();!(_step191=_iterator191.n()).done;){var _n69=_step191.value;if(_n69.isEmpty&&!t.checkChild(_n69,"$text")&&t.checkChild(_n69,"paragraph"))return e.insertElement("paragraph",_n69),!0;}}catch(err){_iterator191.e(err);}finally{_iterator191.f();}return!1;}function zc(e,t,i){var n=i.createContext(e);return!!i.checkChild(n,"paragraph")&&!!i.checkChild(n.push("paragraph"),t);}function Hc(e,t){var i=t.createElement("paragraph");return t.insert(i,e),t.createPositionAt(i,0);}var $c=/*#__PURE__*/function(_kc3){function $c(){_classCallCheck(this,$c);return _callSuper(this,$c,arguments);}_inherits($c,_kc3);return _createClass($c,[{key:"elementToElement",value:function elementToElement(e){return this.add(Uc(e));}},{key:"elementToAttribute",value:function elementToAttribute(e){return this.add(function(e){e=Un(e),qc(e);var t=Gc(e,!1),i=Wc(e.view),n=i?"element:".concat(i):"element";return function(i){i.on(n,t,{priority:e.converterPriority||"low"});};}(e));}},{key:"attributeToAttribute",value:function attributeToAttribute(e){return this.add(function(e){e=Un(e);var t=null;("string"==typeof e.view||e.view.key)&&(t=function(e){"string"==typeof e.view&&(e.view={key:e.view});var t=e.view.key,i=void 0===e.view.value?/[\s\S]*/:e.view.value;var n;if("class"==t||"style"==t){var _e233="class"==t?"classes":"styles";n=_defineProperty({},_e233,i);}else n={attributes:_defineProperty({},t,i)};e.view.name&&(n.name=e.view.name);return e.view=n,t;}(e));qc(e,t);var i=Gc(e,!0);return function(t){t.on("element",i,{priority:e.converterPriority||"low"});};}(e));}},{key:"elementToMarker",value:function elementToMarker(e){return this.add(function(e){var t=function(e){return function(t,i){var n="string"==typeof e?e:e(t,i);return i.writer.createElement("$marker",{"data-name":n});};}(e.model);return Uc(_objectSpread(_objectSpread({},e),{},{model:t}));}(e));}},{key:"dataToMarker",value:function dataToMarker(e){return this.add(function(e){e=Un(e),e.model||(e.model=function(t){return t?e.view+":"+t:e.view;});var t={view:e.view,model:e.model},i=jc(Kc(t,"start")),n=jc(Kc(t,"end"));return function(s){s.on("element:".concat(e.view,"-start"),i,{priority:e.converterPriority||"normal"}),s.on("element:".concat(e.view,"-end"),n,{priority:e.converterPriority||"normal"});var o=C.low,r=C.highest,a=C.get(e.converterPriority)/r;s.on("element",function(e){return function(t,i,n){var s="data-".concat(e.view);function o(t,s){var _iterator192=_createForOfIteratorHelper(s),_step192;try{for(_iterator192.s();!(_step192=_iterator192.n()).done;){var _o25=_step192.value;var _s48=e.model(_o25,n),_r17=n.writer.createElement("$marker",{"data-name":_s48});n.writer.insert(_r17,t),i.modelCursor.isEqual(t)?i.modelCursor=i.modelCursor.getShiftedBy(1):i.modelCursor=i.modelCursor._getTransformedByInsertion(t,1),i.modelRange=i.modelRange._getTransformedByInsertion(t,1)[0];}}catch(err){_iterator192.e(err);}finally{_iterator192.f();}}(n.consumable.test(i.viewItem,{attributes:s+"-end-after"})||n.consumable.test(i.viewItem,{attributes:s+"-start-after"})||n.consumable.test(i.viewItem,{attributes:s+"-end-before"})||n.consumable.test(i.viewItem,{attributes:s+"-start-before"}))&&(i.modelRange||Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor)),n.consumable.consume(i.viewItem,{attributes:s+"-end-after"})&&o(i.modelRange.end,i.viewItem.getAttribute(s+"-end-after").split(",")),n.consumable.consume(i.viewItem,{attributes:s+"-start-after"})&&o(i.modelRange.end,i.viewItem.getAttribute(s+"-start-after").split(",")),n.consumable.consume(i.viewItem,{attributes:s+"-end-before"})&&o(i.modelRange.start,i.viewItem.getAttribute(s+"-end-before").split(",")),n.consumable.consume(i.viewItem,{attributes:s+"-start-before"})&&o(i.modelRange.start,i.viewItem.getAttribute(s+"-start-before").split(",")));};}(t),{priority:o+a});};}(e));}}]);}(kc);function Uc(e){var t=jc(e=Un(e)),i=Wc(e.view),n=i?"element:".concat(i):"element";return function(i){i.on(n,t,{priority:e.converterPriority||"normal"});};}function Wc(e){return"string"==typeof e?e:"object"==_typeof(e)&&"string"==typeof e.name?e.name:null;}function jc(e){var t=new aa(e.view);return function(i,n,s){var o=t.match(n.viewItem);if(!o)return;var r=o.match;if(r.name=!0,!s.consumable.test(n.viewItem,r))return;var a=function(e,t,i){return e instanceof Function?e(t,i):i.writer.createElement(e);}(e.model,n.viewItem,s);a&&s.safeInsert(a,n.modelCursor)&&(s.consumable.consume(n.viewItem,r),s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n));};}function qc(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=null===t||function(e){return e.getAttribute(t);},n="object"!=_typeof(e.model)?e.model:e.model.key,s="object"!=_typeof(e.model)||void 0===e.model.value?i:e.model.value;e.model={key:n,value:s};}function Gc(e,t){var i=new aa(e.view);return function(n,s,o){if(!s.modelRange&&t)return;var r=i.match(s.viewItem);if(!r)return;if(!function(e,t){var i="function"==typeof e?e(t):e;if("object"==_typeof(i)&&!Wc(i))return!1;return!i.classes&&!i.attributes&&!i.styles;}(e.view,s.viewItem)?delete r.match.name:r.match.name=!0,!o.consumable.test(s.viewItem,r.match))return;var a=e.model.key,l="function"==typeof e.model.value?e.model.value(s.viewItem,o):e.model.value;if(null===l)return;s.modelRange||Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor));var c=function(e,t,i,n){var s=!1;for(var _i138=0,_Array$from4=Array.from(e.getItems({shallow:i}));_i138<_Array$from4.length;_i138++){var _o26=_Array$from4[_i138];n.schema.checkAttribute(_o26,t.key)&&(s=!0,_o26.hasAttribute(t.key)||n.writer.setAttribute(t.key,t.value,_o26));}return s;}(s.modelRange,{key:a,value:l},t,o);c&&(o.consumable.test(s.viewItem,{name:!0})&&(r.match.name=!0),o.consumable.consume(s.viewItem,r.match));};}function Kc(e,t){return{view:"".concat(e.view,"-").concat(t),model:function model(t,i){var n=t.getAttribute("name"),s=e.model(n,i);return i.writer.createElement("$marker",{"data-name":s});}};}function Zc(e){e.document.registerPostFixer(function(t){return function(e,t){var i=t.document.selection,n=t.schema,s=[];var o=!1;var _iterator193=_createForOfIteratorHelper(i.getRanges()),_step193;try{for(_iterator193.s();!(_step193=_iterator193.n()).done;){var _e235=_step193.value;var _t129=Jc(_e235,n);_t129&&!_t129.isEqual(_e235)?(s.push(_t129),o=!0):s.push(_e235);}}catch(err){_iterator193.e(err);}finally{_iterator193.f();}o&&e.setSelection(function(e){var t=_toConsumableArray(e),i=new Set();var n=1;for(;n<t.length;){var _e234=t[n],_s49=t.slice(0,n);var _iterator194=_createForOfIteratorHelper(_s49.entries()),_step194;try{for(_iterator194.s();!(_step194=_iterator194.n()).done;){var _step194$value=_slicedToArray(_step194.value,2),_o27=_step194$value[0],_r18=_step194$value[1];if(!i.has(_o27))if(_e234.isEqual(_r18))i.add(_o27);else if(_e234.isIntersecting(_r18)){i.add(_o27),i.add(n);var _s50=_e234.getJoined(_r18);t.push(_s50);}}}catch(err){_iterator194.e(err);}finally{_iterator194.f();}n++;}return t.filter(function(e,t){return!i.has(t);});}(s),{backward:i.isBackward});return!1;}(t,e);});}function Jc(e,t){return e.isCollapsed?function(e,t){var i=e.start,n=t.getNearestSelectionRange(i);if(!n){var _e236=i.getAncestors().reverse().find(function(e){return t.isObject(e);});return _e236?tc._createOn(_e236):null;}if(!n.isCollapsed)return n;var s=n.start;if(i.isEqual(s))return null;return new tc(s);}(e,t):function(e,t){var i=e.start,n=e.end,s=t.checkChild(i,"$text"),o=t.checkChild(n,"$text"),r=t.getLimitElement(i),a=t.getLimitElement(n);if(r===a){if(s&&o)return null;if(function(e,t,i){var n=e.nodeAfter&&!i.isLimit(e.nodeAfter)||i.checkChild(e,"$text"),s=t.nodeBefore&&!i.isLimit(t.nodeBefore)||i.checkChild(t,"$text");return n||s;}(i,n,t)){var _e237=i.nodeAfter&&t.isSelectable(i.nodeAfter)?null:t.getNearestSelectionRange(i,"forward"),_s51=n.nodeBefore&&t.isSelectable(n.nodeBefore)?null:t.getNearestSelectionRange(n,"backward"),_o28=_e237?_e237.start:i,_r19=_s51?_s51.end:n;return new tc(_o28,_r19);}}var l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){var _e238=i.nodeAfter&&n.nodeBefore&&i.nodeAfter.parent===n.nodeBefore.parent,_s52=l&&(!_e238||!Yc(i.nodeAfter,t)),_o29=c&&(!_e238||!Yc(n.nodeBefore,t));var _d3=i,_u3=n;return _s52&&(_d3=Zl._createBefore(Qc(r,t))),_o29&&(_u3=Zl._createAfter(Qc(a,t))),new tc(_d3,_u3);}return null;}(e,t);}function Qc(e,t){var i=e,n=i;for(;t.isLimit(n)&&n.parent;)i=n,n=n.parent;return i;}function Yc(e,t){return e&&t.isSelectable(e);}var Xc=/*#__PURE__*/function(_Zs7){function Xc(e,t){var _this91;_classCallCheck(this,Xc);_this91=_callSuper(this,Xc),_defineProperty(_assertThisInitialized(_this91),"model",void 0),_defineProperty(_assertThisInitialized(_this91),"view",void 0),_defineProperty(_assertThisInitialized(_this91),"mapper",void 0),_defineProperty(_assertThisInitialized(_this91),"downcastDispatcher",void 0),_this91.model=e,_this91.view=new zl(t),_this91.mapper=new ic(),_this91.downcastDispatcher=new oc({mapper:_this91.mapper,schema:e.schema});var i=_this91.model.document,n=i.selection,s=_this91.model.markers;var r,a,l;_this91.listenTo(_this91.model,"_beforeChanges",function(){_this91.view._disableRendering(!0);},{priority:"highest"}),_this91.listenTo(_this91.model,"_afterChanges",function(){_this91.view._disableRendering(!1);},{priority:"lowest"}),_this91.listenTo(i,"change",function(){_this91.view.change(function(e){_this91.downcastDispatcher.convertChanges(i.differ,s,e),_this91.downcastDispatcher.convertSelection(n,s,e);});},{priority:"low"}),_this91.listenTo(_this91.view.document,"selectionChange",function(e,t){return function(i,n){var s=n.newSelection,o=[];var _iterator195=_createForOfIteratorHelper(s.getRanges()),_step195;try{for(_iterator195.s();!(_step195=_iterator195.n()).done;){var _e239=_step195.value;o.push(t.toModelRange(_e239));}}catch(err){_iterator195.e(err);}finally{_iterator195.f();}var r=e.createSelection(o,{backward:s.isBackward});r.isEqual(e.document.selection)||e.change(function(e){e.setSelection(r);});};}(_this91.model,_this91.mapper)),_this91.listenTo(_this91.view.document,"beforeinput",(r=_this91.mapper,a=_this91.model.schema,l=_this91.view,function(e,t){if(!l.document.isComposing||o.isAndroid)for(var _e240=0;_e240<t.targetRanges.length;_e240++){var _i139=t.targetRanges[_e240],_n71=r.toModelRange(_i139),_s53=Jc(_n71,a);_s53&&!_s53.isEqual(_n71)&&(t.targetRanges[_e240]=r.toViewRange(_s53));}}),{priority:"high"}),_this91.downcastDispatcher.on("insert:$text",function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=i.writer,s=i.mapper.toViewPosition(t.range.start),o=n.createText(t.item.data);n.insert(s,o);},{priority:"lowest"}),_this91.downcastDispatcher.on("insert",function(e,t,i){i.convertAttributes(t.item),t.reconversion||!t.item.is("element")||t.item.isEmpty||i.convertChildren(t.item);},{priority:"lowest"}),_this91.downcastDispatcher.on("remove",function(e,t,i){var n=i.mapper.toViewPosition(t.position),s=t.position.getShiftedBy(t.length),o=i.mapper.toViewPosition(s,{isPhantom:!0}),r=i.writer.createRange(n,o),a=i.writer.remove(r.getTrimmed());var _iterator196=_createForOfIteratorHelper(i.writer.createRangeIn(a).getItems()),_step196;try{for(_iterator196.s();!(_step196=_iterator196.n()).done;){var _e241=_step196.value;i.mapper.unbindViewElement(_e241,{defer:!0});}}catch(err){_iterator196.e(err);}finally{_iterator196.f();}},{priority:"low"}),_this91.downcastDispatcher.on("cleanSelection",function(e,t,i){var n=i.writer,s=n.document.selection;var _iterator197=_createForOfIteratorHelper(s.getRanges()),_step197;try{for(_iterator197.s();!(_step197=_iterator197.n()).done;){var _e242=_step197.value;_e242.isCollapsed&&_e242.end.parent.isAttached()&&i.writer.mergeAttributes(_e242.start);}}catch(err){_iterator197.e(err);}finally{_iterator197.f();}n.setSelection(null);}),_this91.downcastDispatcher.on("selection",function(e,t,i){var n=t.selection;if(n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;var s=[];var _iterator198=_createForOfIteratorHelper(n.getRanges()),_step198;try{for(_iterator198.s();!(_step198=_iterator198.n()).done;){var _e243=_step198.value;s.push(i.mapper.toViewRange(_e243));}}catch(err){_iterator198.e(err);}finally{_iterator198.f();}i.writer.setSelection(s,{backward:n.isBackward});},{priority:"low"}),_this91.downcastDispatcher.on("selection",function(e,t,i){var n=t.selection;if(!n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;var s=i.writer,o=n.getFirstPosition(),r=i.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a);},{priority:"low"}),_this91.view.document.roots.bindTo(_this91.model.document.roots).using(function(e){if("$graveyard"==e.rootName)return null;var t=new va(_this91.view.document,e.name);return t.rootName=e.rootName,_this91.mapper.bindElements(e,t),t;});return _this91;}_inherits(Xc,_Zs7);return _createClass(Xc,[{key:"destroy",value:function destroy(){this.view.destroy(),this.stopListening();}},{key:"reconvertMarker",value:function reconvertMarker(e){var _this92=this;var t="string"==typeof e?e:e.name,i=this.model.markers.get(t);if(!i)throw new A("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:t});this.model.change(function(){_this92.model.markers._refresh(i);});}},{key:"reconvertItem",value:function reconvertItem(e){var _this93=this;this.model.change(function(){_this93.model.document.differ._refreshItem(e);});}}]);}(Zs());var ed=/*#__PURE__*/function(){function ed(){_classCallCheck(this,ed);_defineProperty(this,"_consumables",new Map());}return _createClass(ed,[{key:"add",value:function add(e,t){var i;e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):(this._consumables.has(e)?i=this._consumables.get(e):(i=new id(e),this._consumables.set(e,i)),i.add(t));}},{key:"test",value:function test(e,t){var i=this._consumables.get(e);return void 0===i?null:e.is("$text")||e.is("documentFragment")?i:i.test(t);}},{key:"consume",value:function consume(e,t){return!!this.test(e,t)&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!1):this._consumables.get(e).consume(t),!0);}},{key:"revert",value:function revert(e,t){var i=this._consumables.get(e);void 0!==i&&(e.is("$text")||e.is("documentFragment")?this._consumables.set(e,!0):i.revert(t));}}],[{key:"consumablesFromElement",value:function consumablesFromElement(e){var t={element:e,name:!0,attributes:[],classes:[],styles:[]},i=e.getAttributeKeys();var _iterator199=_createForOfIteratorHelper(i),_step199;try{for(_iterator199.s();!(_step199=_iterator199.n()).done;){var _e244=_step199.value;"style"!=_e244&&"class"!=_e244&&t.attributes.push(_e244);}}catch(err){_iterator199.e(err);}finally{_iterator199.f();}var n=e.getClassNames();var _iterator200=_createForOfIteratorHelper(n),_step200;try{for(_iterator200.s();!(_step200=_iterator200.n()).done;){var _e245=_step200.value;t.classes.push(_e245);}}catch(err){_iterator200.e(err);}finally{_iterator200.f();}var s=e.getStyleNames();var _iterator201=_createForOfIteratorHelper(s),_step201;try{for(_iterator201.s();!(_step201=_iterator201.n()).done;){var _e246=_step201.value;t.styles.push(_e246);}}catch(err){_iterator201.e(err);}finally{_iterator201.f();}return t;}},{key:"createFrom",value:function createFrom(e,t){if(t||(t=new ed()),e.is("$text"))return t.add(e),t;e.is("element")&&t.add(e,ed.consumablesFromElement(e)),e.is("documentFragment")&&t.add(e);var _iterator202=_createForOfIteratorHelper(e.getChildren()),_step202;try{for(_iterator202.s();!(_step202=_iterator202.n()).done;){var _i140=_step202.value;t=ed.createFrom(_i140,t);}}catch(err){_iterator202.e(err);}finally{_iterator202.f();}return t;}}]);}();var td=["attributes","classes","styles"];var id=/*#__PURE__*/function(){function id(e){_classCallCheck(this,id);_defineProperty(this,"element",void 0);_defineProperty(this,"_canConsumeName",void 0);_defineProperty(this,"_consumables",void 0);this.element=e,this._canConsumeName=null,this._consumables={attributes:new Map(),styles:new Map(),classes:new Map()};}return _createClass(id,[{key:"add",value:function add(e){e.name&&(this._canConsumeName=!0);for(var _i141=0,_td=td;_i141<_td.length;_i141++){var _t130=_td[_i141];_t130 in e&&this._add(_t130,e[_t130]);}}},{key:"test",value:function test(e){if(e.name&&!this._canConsumeName)return this._canConsumeName;for(var _i142=0,_td2=td;_i142<_td2.length;_i142++){var _t131=_td2[_i142];if(_t131 in e){var _i143=this._test(_t131,e[_t131]);if(!0!==_i143)return _i143;}}return!0;}},{key:"consume",value:function consume(e){e.name&&(this._canConsumeName=!1);for(var _i144=0,_td3=td;_i144<_td3.length;_i144++){var _t132=_td3[_i144];_t132 in e&&this._consume(_t132,e[_t132]);}}},{key:"revert",value:function revert(e){e.name&&(this._canConsumeName=!0);for(var _i145=0,_td4=td;_i145<_td4.length;_i145++){var _t133=_td4[_i145];_t133 in e&&this._revert(_t133,e[_t133]);}}},{key:"_add",value:function _add(e,t){var i=gr(t),n=this._consumables[e];var _iterator203=_createForOfIteratorHelper(i),_step203;try{for(_iterator203.s();!(_step203=_iterator203.n()).done;){var _t134=_step203.value;if("attributes"===e&&("class"===_t134||"style"===_t134))throw new A("viewconsumable-invalid-attribute",this);if(n.set(_t134,!0),"styles"===e){var _iterator204=_createForOfIteratorHelper(this.element.document.stylesProcessor.getRelatedStyles(_t134)),_step204;try{for(_iterator204.s();!(_step204=_iterator204.n()).done;){var _e247=_step204.value;n.set(_e247,!0);}}catch(err){_iterator204.e(err);}finally{_iterator204.f();}}}}catch(err){_iterator203.e(err);}finally{_iterator203.f();}}},{key:"_test",value:function _test(e,t){var i=gr(t),n=this._consumables[e];var _iterator205=_createForOfIteratorHelper(i),_step205;try{for(_iterator205.s();!(_step205=_iterator205.n()).done;){var _t135=_step205.value;if("attributes"!==e||"class"!==_t135&&"style"!==_t135){var _e248=n.get(_t135);if(void 0===_e248)return null;if(!_e248)return!1;}else{var _e249="class"==_t135?"classes":"styles",_i146=this._test(_e249,_toConsumableArray(this._consumables[_e249].keys()));if(!0!==_i146)return _i146;}}}catch(err){_iterator205.e(err);}finally{_iterator205.f();}return!0;}},{key:"_consume",value:function _consume(e,t){var i=gr(t),n=this._consumables[e];var _iterator206=_createForOfIteratorHelper(i),_step206;try{for(_iterator206.s();!(_step206=_iterator206.n()).done;){var _t136=_step206.value;if("attributes"!==e||"class"!==_t136&&"style"!==_t136){if(n.set(_t136,!1),"styles"==e){var _iterator207=_createForOfIteratorHelper(this.element.document.stylesProcessor.getRelatedStyles(_t136)),_step207;try{for(_iterator207.s();!(_step207=_iterator207.n()).done;){var _e250=_step207.value;n.set(_e250,!1);}}catch(err){_iterator207.e(err);}finally{_iterator207.f();}}}else{var _e251="class"==_t136?"classes":"styles";this._consume(_e251,_toConsumableArray(this._consumables[_e251].keys()));}}}catch(err){_iterator206.e(err);}finally{_iterator206.f();}}},{key:"_revert",value:function _revert(e,t){var i=gr(t),n=this._consumables[e];var _iterator208=_createForOfIteratorHelper(i),_step208;try{for(_iterator208.s();!(_step208=_iterator208.n()).done;){var _t137=_step208.value;if("attributes"!==e||"class"!==_t137&&"style"!==_t137){!1===n.get(_t137)&&n.set(_t137,!0);}else{var _e252="class"==_t137?"classes":"styles";this._revert(_e252,_toConsumableArray(this._consumables[_e252].keys()));}}}catch(err){_iterator208.e(err);}finally{_iterator208.f();}}}]);}();var nd=/*#__PURE__*/function(_Zs8){function nd(){var _this94;_classCallCheck(this,nd);_this94=_callSuper(this,nd),_defineProperty(_assertThisInitialized(_this94),"_sourceDefinitions",{}),_defineProperty(_assertThisInitialized(_this94),"_attributeProperties",Object.create(null)),_defineProperty(_assertThisInitialized(_this94),"_customChildChecks",new Map()),_defineProperty(_assertThisInitialized(_this94),"_customAttributeChecks",new Map()),_defineProperty(_assertThisInitialized(_this94),"_genericCheckSymbol",Symbol("$generic")),_defineProperty(_assertThisInitialized(_this94),"_compiledDefinitions",void 0),_this94.decorate("checkChild"),_this94.decorate("checkAttribute"),_this94.on("checkAttribute",function(e,t){t[0]=new sd(t[0]);},{priority:"highest"}),_this94.on("checkChild",function(e,t){t[0]=new sd(t[0]),t[1]=_this94.getDefinition(t[1]);},{priority:"highest"});return _this94;}_inherits(nd,_Zs8);return _createClass(nd,[{key:"register",value:function register(e,t){if(this._sourceDefinitions[e])throw new A("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},t)],this._clearCache();}},{key:"extend",value:function extend(e,t){if(!this._sourceDefinitions[e])throw new A("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},t)),this._clearCache();}},{key:"getDefinitions",value:function getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions;}},{key:"getDefinition",value:function getDefinition(e){var t;return t="string"==typeof e?e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?"$text":e.name,this.getDefinitions()[t];}},{key:"isRegistered",value:function isRegistered(e){return!!this.getDefinition(e);}},{key:"isBlock",value:function isBlock(e){var t=this.getDefinition(e);return!(!t||!t.isBlock);}},{key:"isLimit",value:function isLimit(e){var t=this.getDefinition(e);return!!t&&!(!t.isLimit&&!t.isObject);}},{key:"isObject",value:function isObject(e){var t=this.getDefinition(e);return!!t&&!!(t.isObject||t.isLimit&&t.isSelectable&&t.isContent);}},{key:"isInline",value:function isInline(e){var t=this.getDefinition(e);return!(!t||!t.isInline);}},{key:"isSelectable",value:function isSelectable(e){var t=this.getDefinition(e);return!!t&&!(!t.isSelectable&&!t.isObject);}},{key:"isContent",value:function isContent(e){var t=this.getDefinition(e);return!!t&&!(!t.isContent&&!t.isObject);}},{key:"checkChild",value:function checkChild(e,t){return!!t&&this._checkContextMatch(e,t);}},{key:"checkAttribute",value:function checkAttribute(e,t){var i=this.getDefinition(e.last);if(!i)return!1;var n=this._evaluateAttributeChecks(e,t);return void 0!==n?n:i.allowAttributes.includes(t);}},{key:"checkMerge",value:function checkMerge(e,t){if(e instanceof Zl){var _t138=e.nodeBefore,_i147=e.nodeAfter;if(!(_t138 instanceof ql))throw new A("schema-check-merge-no-element-before",this);if(!(_i147 instanceof ql))throw new A("schema-check-merge-no-element-after",this);return this.checkMerge(_t138,_i147);}if(this.isLimit(e)||this.isLimit(t))return!1;var _iterator209=_createForOfIteratorHelper(t.getChildren()),_step209;try{for(_iterator209.s();!(_step209=_iterator209.n()).done;){var _i148=_step209.value;if(!this.checkChild(e,_i148))return!1;}}catch(err){_iterator209.e(err);}finally{_iterator209.f();}return!0;}},{key:"addChildCheck",value:function addChildCheck(e,t){var i=void 0!==t?t:this._genericCheckSymbol,n=this._customChildChecks.get(i)||[];n.push(e),this._customChildChecks.set(i,n);}},{key:"addAttributeCheck",value:function addAttributeCheck(e,t){var i=void 0!==t?t:this._genericCheckSymbol,n=this._customAttributeChecks.get(i)||[];n.push(e),this._customAttributeChecks.set(i,n);}},{key:"setAttributeProperties",value:function setAttributeProperties(e,t){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),t);}},{key:"getAttributeProperties",value:function getAttributeProperties(e){return this._attributeProperties[e]||Object.create(null);}},{key:"getLimitElement",value:function getLimitElement(e){var t;if(e instanceof Zl)t=e.parent;else{t=(e instanceof tc?[e]:Array.from(e.getRanges())).reduce(function(e,t){var i=t.getCommonAncestor();return e?e.getCommonAncestor(i,{includeSelf:!0}):i;},null);}for(;!this.isLimit(t)&&t.parent;)t=t.parent;return t;}},{key:"checkAttributeInSelection",value:function checkAttributeInSelection(e,t){if(e.isCollapsed){var _i149=[].concat(_toConsumableArray(e.getFirstPosition().getAncestors()),[new Wl("",e.getAttributes())]);return this.checkAttribute(_i149,t);}{var _i150=e.getRanges();var _iterator210=_createForOfIteratorHelper(_i150),_step210;try{for(_iterator210.s();!(_step210=_iterator210.n()).done;){var _e253=_step210.value;var _iterator211=_createForOfIteratorHelper(_e253),_step211;try{for(_iterator211.s();!(_step211=_iterator211.n()).done;){var _i151=_step211.value;if(this.checkAttribute(_i151.item,t))return!0;}}catch(err){_iterator211.e(err);}finally{_iterator211.f();}}}catch(err){_iterator210.e(err);}finally{_iterator210.f();}}return!1;}},{key:"getValidRanges",value:/*#__PURE__*/_regeneratorRuntime().mark(function getValidRanges(e,t){var _iterator213,_step213,_i152;return _regeneratorRuntime().wrap(function getValidRanges$(_context23){while(1)switch(_context23.prev=_context23.next){case 0:e=/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(e){var _iterator212,_step212,_t139;return _regeneratorRuntime().wrap(function _callee7$(_context22){while(1)switch(_context22.prev=_context22.next){case 0:_iterator212=_createForOfIteratorHelper(e);_context22.prev=1;_iterator212.s();case 3:if((_step212=_iterator212.n()).done){_context22.next=8;break;}_t139=_step212.value;return _context22.delegateYield(_t139.getMinimalFlatRanges(),"t0",6);case 6:_context22.next=3;break;case 8:_context22.next=13;break;case 10:_context22.prev=10;_context22.t1=_context22["catch"](1);_iterator212.e(_context22.t1);case 13:_context22.prev=13;_iterator212.f();return _context22.finish(13);case 16:case"end":return _context22.stop();}},_callee7,null,[[1,10,13,16]]);})(e);_iterator213=_createForOfIteratorHelper(e);_context23.prev=2;_iterator213.s();case 4:if((_step213=_iterator213.n()).done){_context23.next=9;break;}_i152=_step213.value;return _context23.delegateYield(this._getValidRangesForRange(_i152,t),"t0",7);case 7:_context23.next=4;break;case 9:_context23.next=14;break;case 11:_context23.prev=11;_context23.t1=_context23["catch"](2);_iterator213.e(_context23.t1);case 14:_context23.prev=14;_iterator213.f();return _context23.finish(14);case 17:case"end":return _context23.stop();}},getValidRanges,this,[[2,11,14,17]]);})},{key:"getNearestSelectionRange",value:function getNearestSelectionRange(e){var _this95=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"both";if("$graveyard"==e.root.rootName)return null;if(this.checkChild(e,"$text"))return new tc(e);var i,n;var s=e.getAncestors().reverse().find(function(e){return _this95.isLimit(e);})||e.root;"both"!=t&&"backward"!=t||(i=new Gl({boundaries:tc._createIn(s),startPosition:e,direction:"backward"})),"both"!=t&&"forward"!=t||(n=new Gl({boundaries:tc._createIn(s),startPosition:e}));var _iterator214=_createForOfIteratorHelper(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(e,t){var i,_t140,_e254;return _regeneratorRuntime().wrap(function _callee8$(_context24){while(1)switch(_context24.prev=_context24.next){case 0:i=!1;case 1:if(i){_context24.next=18;break;}if(!(i=!0,e)){_context24.next=9;break;}_t140=e.next();_context24.t0=_t140.done;if(_context24.t0){_context24.next=9;break;}i=!1;_context24.next=9;return{walker:e,value:_t140.value};case 9:if(!t){_context24.next=16;break;}_e254=t.next();_context24.t1=_e254.done;if(_context24.t1){_context24.next=16;break;}i=!1;_context24.next=16;return{walker:t,value:_e254.value};case 16:_context24.next=1;break;case 18:case"end":return _context24.stop();}},_callee8);})(i,n)),_step214;try{for(_iterator214.s();!(_step214=_iterator214.n()).done;){var _e255=_step214.value;var _t141=_e255.walker==i?"elementEnd":"elementStart",_n72=_e255.value;if(_n72.type==_t141&&this.isObject(_n72.item))return tc._createOn(_n72.item);if(this.checkChild(_n72.nextPosition,"$text"))return new tc(_n72.nextPosition);}}catch(err){_iterator214.e(err);}finally{_iterator214.f();}return null;}},{key:"findAllowedParent",value:function findAllowedParent(e,t){var i=e.parent;for(;i;){if(this.checkChild(i,t))return i;if(this.isLimit(i))return null;i=i.parent;}return null;}},{key:"setAllowedAttributes",value:function setAllowedAttributes(e,t,i){var n=i.model;for(var _i153=0,_Object$entries2=Object.entries(t);_i153<_Object$entries2.length;_i153++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i153],2),_s54=_Object$entries2$_i[0],_o30=_Object$entries2$_i[1];n.schema.checkAttribute(e,_s54)&&i.setAttribute(_s54,_o30,e);}}},{key:"removeDisallowedAttributes",value:function removeDisallowedAttributes(e,t){var _iterator215=_createForOfIteratorHelper(e),_step215;try{for(_iterator215.s();!(_step215=_iterator215.n()).done;){var _i154=_step215.value;if(_i154.is("$text"))bd(this,_i154,t);else{var _e256=tc._createIn(_i154).getPositions();var _iterator216=_createForOfIteratorHelper(_e256),_step216;try{for(_iterator216.s();!(_step216=_iterator216.n()).done;){var _i155=_step216.value;bd(this,_i155.nodeBefore||_i155.parent,t);}}catch(err){_iterator216.e(err);}finally{_iterator216.f();}}}}catch(err){_iterator215.e(err);}finally{_iterator215.f();}}},{key:"getAttributesWithProperty",value:function getAttributesWithProperty(e,t,i){var n={};var _iterator217=_createForOfIteratorHelper(e.getAttributes()),_step217;try{for(_iterator217.s();!(_step217=_iterator217.n()).done;){var _step217$value=_slicedToArray(_step217.value,2),_s55=_step217$value[0],_o31=_step217$value[1];var _e257=this.getAttributeProperties(_s55);void 0!==_e257[t]&&(void 0!==i&&i!==_e257[t]||(n[_s55]=_o31));}}catch(err){_iterator217.e(err);}finally{_iterator217.f();}return n;}},{key:"createContext",value:function createContext(e){return new sd(e);}},{key:"_clearCache",value:function _clearCache(){this._compiledDefinitions=null;}},{key:"_compile",value:function _compile(){var e={},t=this._sourceDefinitions,i=Object.keys(t);for(var _i157=0,_i156=i;_i157<_i156.length;_i157++){var _n73=_i156[_i157];e[_n73]=od(t[_n73],_n73);}var n=Object.values(e);for(var _i158=0,_n74=n;_i158<_n74.length;_i158++){var _t142=_n74[_i158];rd(e,_t142),ad(e,_t142),ld(e,_t142),cd(e,_t142);}for(var _i159=0,_n75=n;_i159<_n75.length;_i159++){var _t143=_n75[_i159];dd(e,_t143);}for(var _i160=0,_n76=n;_i160<_n76.length;_i160++){var _t144=_n76[_i160];ud(e,_t144);}for(var _i161=0,_n77=n;_i161<_n77.length;_i161++){var _t145=_n77[_i161];hd(e,_t145);}for(var _i162=0,_n78=n;_i162<_n78.length;_i162++){var _t146=_n78[_i162];md(e,_t146);}for(var _i163=0,_n79=n;_i163<_n79.length;_i163++){var _t147=_n79[_i163];gd(e,_t147);}this._compiledDefinitions=function(e){var t={};for(var _i164=0,_Object$values=Object.values(e);_i164<_Object$values.length;_i164++){var _i165=_Object$values[_i164];t[_i165.name]={name:_i165.name,isBlock:!!_i165.isBlock,isContent:!!_i165.isContent,isInline:!!_i165.isInline,isLimit:!!_i165.isLimit,isObject:!!_i165.isObject,isSelectable:!!_i165.isSelectable,allowIn:Array.from(_i165.allowIn).filter(function(t){return!!e[t];}),allowChildren:Array.from(_i165.allowChildren).filter(function(t){return!!e[t];}),allowAttributes:Array.from(_i165.allowAttributes)};}return t;}(e);}},{key:"_checkContextMatch",value:function _checkContextMatch(e,t){var i=e.last;var n=this._evaluateChildChecks(e,t);if(n=void 0!==n?n:t.allowIn.includes(i.name),!n)return!1;var s=this.getDefinition(i),o=e.trimLast();return!!s&&(0==o.length||this._checkContextMatch(o,s));}},{key:"_evaluateChildChecks",value:function _evaluateChildChecks(e,t){var i=this._customChildChecks.get(this._genericCheckSymbol)||[],n=this._customChildChecks.get(t.name)||[];for(var _i166=0,_arr=[].concat(_toConsumableArray(i),_toConsumableArray(n));_i166<_arr.length;_i166++){var _s56=_arr[_i166];var _i167=_s56(e,t);if(void 0!==_i167)return _i167;}}},{key:"_evaluateAttributeChecks",value:function _evaluateAttributeChecks(e,t){var i=this._customAttributeChecks.get(this._genericCheckSymbol)||[],n=this._customAttributeChecks.get(t)||[];for(var _i168=0,_arr2=[].concat(_toConsumableArray(i),_toConsumableArray(n));_i168<_arr2.length;_i168++){var _s57=_arr2[_i168];var _i169=_s57(e,t);if(void 0!==_i169)return _i169;}}},{key:"_getValidRangesForRange",value:/*#__PURE__*/_regeneratorRuntime().mark(function _getValidRangesForRange(e,t){var i,n,_iterator218,_step218,_s58;return _regeneratorRuntime().wrap(function _getValidRangesForRange$(_context25){while(1)switch(_context25.prev=_context25.next){case 0:i=e.start,n=e.start;_iterator218=_createForOfIteratorHelper(e.getItems({shallow:!0}));_context25.prev=2;_iterator218.s();case 4:if((_step218=_iterator218.n()).done){_context25.next=19;break;}_s58=_step218.value;_context25.t0=_s58.is("element");if(!_context25.t0){_context25.next=9;break;}return _context25.delegateYield(this._getValidRangesForRange(tc._createIn(_s58),t),"t1",9);case 9:_context25.t2=this.checkAttribute(_s58,t);if(_context25.t2){_context25.next=16;break;}_context25.t3=i.isEqual(n);if(_context25.t3){_context25.next=15;break;}_context25.next=15;return new tc(i,n);case 15:i=Zl._createAfter(_s58);case 16:n=Zl._createAfter(_s58);case 17:_context25.next=4;break;case 19:_context25.next=24;break;case 21:_context25.prev=21;_context25.t4=_context25["catch"](2);_iterator218.e(_context25.t4);case 24:_context25.prev=24;_iterator218.f();return _context25.finish(24);case 27:_context25.t5=i.isEqual(n);if(_context25.t5){_context25.next=31;break;}_context25.next=31;return new tc(i,n);case 31:case"end":return _context25.stop();}},_getValidRangesForRange,this,[[2,21,24,27]]);})},{key:"findOptimalInsertionRange",value:function findOptimalInsertionRange(e,t){var i=e.getSelectedElement();if(i&&this.isObject(i)&&!this.isInline(i))return"before"==t||"after"==t?new tc(Zl._createAt(i,t)):tc._createOn(i);var n=wr(e.getSelectedBlocks());if(!n)return new tc(e.focus);if(n.isEmpty)return new tc(Zl._createAt(n,0));var s=Zl._createAfter(n);return e.focus.isTouching(s)?new tc(s):new tc(Zl._createBefore(n));}}]);}(Zs());var sd=/*#__PURE__*/function(){function sd(e){_classCallCheck(this,sd);_defineProperty(this,"_items",void 0);if(e instanceof sd)return e;var t;t="string"==typeof e?[e]:Array.isArray(e)?e:e.getAncestors({includeSelf:!0}),this._items=t.map(pd);}return _createClass(sd,[{key:"length",get:function get(){return this._items.length;}},{key:"last",get:function get(){return this._items[this._items.length-1];}},{key:Symbol.iterator,value:function value(){return this._items[Symbol.iterator]();}},{key:"push",value:function push(e){var t=new sd([e]);return t._items=[].concat(_toConsumableArray(this._items),_toConsumableArray(t._items)),t;}},{key:"trimLast",value:function trimLast(){var e=new sd([]);return e._items=this._items.slice(0,-1),e;}},{key:"getItem",value:function getItem(e){return this._items[e];}},{key:"getNames",value:/*#__PURE__*/_regeneratorRuntime().mark(function getNames(){return _regeneratorRuntime().wrap(function getNames$(_context26){while(1)switch(_context26.prev=_context26.next){case 0:return _context26.delegateYield(this._items.map(function(e){return e.name;}),"t0",1);case 1:case"end":return _context26.stop();}},getNames,this);})},{key:"endsWith",value:function endsWith(e){return Array.from(this.getNames()).join(" ").endsWith(e);}},{key:"startsWith",value:function startsWith(e){return Array.from(this.getNames()).join(" ").startsWith(e);}}]);}();function od(e,t){var i={name:t,allowIn:new Set(),allowChildren:new Set(),disallowIn:new Set(),disallowChildren:new Set(),allowContentOf:new Set(),allowWhere:new Set(),allowAttributes:new Set(),disallowAttributes:new Set(),allowAttributesOf:new Set(),inheritTypesFrom:new Set()};return function(e,t){var _iterator219=_createForOfIteratorHelper(e),_step219;try{for(_iterator219.s();!(_step219=_iterator219.n()).done;){var _i170=_step219.value;var _e258=Object.keys(_i170).filter(function(e){return e.startsWith("is");});var _iterator220=_createForOfIteratorHelper(_e258),_step220;try{for(_iterator220.s();!(_step220=_iterator220.n()).done;){var _n80=_step220.value;t[_n80]=!!_i170[_n80];}}catch(err){_iterator220.e(err);}finally{_iterator220.f();}}}catch(err){_iterator219.e(err);}finally{_iterator219.f();}}(e,i),fd(e,i,"allowIn"),fd(e,i,"allowChildren"),fd(e,i,"disallowIn"),fd(e,i,"disallowChildren"),fd(e,i,"allowContentOf"),fd(e,i,"allowWhere"),fd(e,i,"allowAttributes"),fd(e,i,"disallowAttributes"),fd(e,i,"allowAttributesOf"),fd(e,i,"inheritTypesFrom"),function(e,t){var _iterator221=_createForOfIteratorHelper(e),_step221;try{for(_iterator221.s();!(_step221=_iterator221.n()).done;){var _i171=_step221.value;var _e259=_i171.inheritAllFrom;_e259&&(t.allowContentOf.add(_e259),t.allowWhere.add(_e259),t.allowAttributesOf.add(_e259),t.inheritTypesFrom.add(_e259));}}catch(err){_iterator221.e(err);}finally{_iterator221.f();}}(e,i),i;}function rd(e,t){var _iterator222=_createForOfIteratorHelper(t.allowIn),_step222;try{for(_iterator222.s();!(_step222=_iterator222.n()).done;){var _i172=_step222.value;var _n81=e[_i172];_n81?_n81.allowChildren.add(t.name):t.allowIn["delete"](_i172);}}catch(err){_iterator222.e(err);}finally{_iterator222.f();}}function ad(e,t){var _iterator223=_createForOfIteratorHelper(t.allowChildren),_step223;try{for(_iterator223.s();!(_step223=_iterator223.n()).done;){var _i173=_step223.value;var _n82=e[_i173];_n82?_n82.allowIn.add(t.name):t.allowChildren["delete"](_i173);}}catch(err){_iterator223.e(err);}finally{_iterator223.f();}}function ld(e,t){var _iterator224=_createForOfIteratorHelper(t.disallowIn),_step224;try{for(_iterator224.s();!(_step224=_iterator224.n()).done;){var _i174=_step224.value;var _n83=e[_i174];_n83?_n83.disallowChildren.add(t.name):t.disallowIn["delete"](_i174);}}catch(err){_iterator224.e(err);}finally{_iterator224.f();}}function cd(e,t){var _iterator225=_createForOfIteratorHelper(t.disallowChildren),_step225;try{for(_iterator225.s();!(_step225=_iterator225.n()).done;){var _i175=_step225.value;var _n84=e[_i175];_n84?_n84.disallowIn.add(t.name):t.disallowChildren["delete"](_i175);}}catch(err){_iterator225.e(err);}finally{_iterator225.f();}}function dd(e,t){var _iterator226=_createForOfIteratorHelper(t.disallowChildren),_step226;try{for(_iterator226.s();!(_step226=_iterator226.n()).done;){var _e260=_step226.value;t.allowChildren["delete"](_e260);}}catch(err){_iterator226.e(err);}finally{_iterator226.f();}var _iterator227=_createForOfIteratorHelper(t.disallowIn),_step227;try{for(_iterator227.s();!(_step227=_iterator227.n()).done;){var _e261=_step227.value;t.allowIn["delete"](_e261);}}catch(err){_iterator227.e(err);}finally{_iterator227.f();}var _iterator228=_createForOfIteratorHelper(t.disallowAttributes),_step228;try{for(_iterator228.s();!(_step228=_iterator228.n()).done;){var _e262=_step228.value;t.allowAttributes["delete"](_e262);}}catch(err){_iterator228.e(err);}finally{_iterator228.f();}}function ud(e,t){var _iterator229=_createForOfIteratorHelper(t.allowContentOf),_step229;try{for(_iterator229.s();!(_step229=_iterator229.n()).done;){var _i176=_step229.value;var _n85=e[_i176];_n85&&(_n85.disallowChildren.forEach(function(i){t.allowChildren.has(i)||(t.disallowChildren.add(i),e[i].disallowIn.add(t.name));}),_n85.allowChildren.forEach(function(i){t.disallowChildren.has(i)||(t.allowChildren.add(i),e[i].allowIn.add(t.name));}));}}catch(err){_iterator229.e(err);}finally{_iterator229.f();}}function hd(e,t){var _iterator230=_createForOfIteratorHelper(t.allowWhere),_step230;try{for(_iterator230.s();!(_step230=_iterator230.n()).done;){var _i177=_step230.value;var _n86=e[_i177];_n86&&(_n86.disallowIn.forEach(function(i){t.allowIn.has(i)||(t.disallowIn.add(i),e[i].disallowChildren.add(t.name));}),_n86.allowIn.forEach(function(i){t.disallowIn.has(i)||(t.allowIn.add(i),e[i].allowChildren.add(t.name));}));}}catch(err){_iterator230.e(err);}finally{_iterator230.f();}}function md(e,t){var _iterator231=_createForOfIteratorHelper(t.allowAttributesOf),_step231;try{for(_iterator231.s();!(_step231=_iterator231.n()).done;){var _i178=_step231.value;var _n87=e[_i178];if(!_n87)return;_n87.allowAttributes.forEach(function(e){t.disallowAttributes.has(e)||t.allowAttributes.add(e);});}}catch(err){_iterator231.e(err);}finally{_iterator231.f();}}function gd(e,t){var _iterator232=_createForOfIteratorHelper(t.inheritTypesFrom),_step232;try{for(_iterator232.s();!(_step232=_iterator232.n()).done;){var _i179=_step232.value;var _n88=e[_i179];if(_n88){var _e263=Object.keys(_n88).filter(function(e){return e.startsWith("is");});var _iterator233=_createForOfIteratorHelper(_e263),_step233;try{for(_iterator233.s();!(_step233=_iterator233.n()).done;){var _i180=_step233.value;_i180 in t||(t[_i180]=_n88[_i180]);}}catch(err){_iterator233.e(err);}finally{_iterator233.f();}}}}catch(err){_iterator232.e(err);}finally{_iterator232.f();}}function fd(e,t,i){var _iterator234=_createForOfIteratorHelper(e),_step234;try{for(_iterator234.s();!(_step234=_iterator234.n()).done;){var _n89=_step234.value;var _e264=_n89[i];"string"==typeof _e264&&(_e264=[_e264]),Array.isArray(_e264)&&_e264.forEach(function(e){return t[i].add(e);});}}catch(err){_iterator234.e(err);}finally{_iterator234.f();}}function pd(e){return"string"==typeof e||e.is("documentFragment")?{name:"string"==typeof e?e:"$documentFragment",getAttributeKeys:/*#__PURE__*/_regeneratorRuntime().mark(function getAttributeKeys(){return _regeneratorRuntime().wrap(function getAttributeKeys$(_context27){while(1)switch(_context27.prev=_context27.next){case 0:case"end":return _context27.stop();}},getAttributeKeys);}),getAttribute:function getAttribute(){}}:{name:e.is("element")?e.name:"$text",getAttributeKeys:/*#__PURE__*/_regeneratorRuntime().mark(function getAttributeKeys(){return _regeneratorRuntime().wrap(function getAttributeKeys$(_context28){while(1)switch(_context28.prev=_context28.next){case 0:return _context28.delegateYield(e.getAttributeKeys(),"t0",1);case 1:case"end":return _context28.stop();}},getAttributeKeys);}),getAttribute:function getAttribute(t){return e.getAttribute(t);}};}function bd(e,t,i){var _iterator235=_createForOfIteratorHelper(t.getAttributeKeys()),_step235;try{for(_iterator235.s();!(_step235=_iterator235.n()).done;){var _n90=_step235.value;e.checkAttribute(t,_n90)||i.removeAttribute(_n90,t);}}catch(err){_iterator235.e(err);}finally{_iterator235.f();}}var wd=/*#__PURE__*/function(_L14){function wd(e){var _this96;_classCallCheck(this,wd);_this96=_callSuper(this,wd),_defineProperty(_assertThisInitialized(_this96),"conversionApi",void 0),_defineProperty(_assertThisInitialized(_this96),"_splitParts",new Map()),_defineProperty(_assertThisInitialized(_this96),"_cursorParents",new Map()),_defineProperty(_assertThisInitialized(_this96),"_modelCursor",null),_defineProperty(_assertThisInitialized(_this96),"_emptyElementsToKeep",new Set()),_this96.conversionApi=_objectSpread(_objectSpread({},e),{},{consumable:null,writer:null,store:null,convertItem:function convertItem(e,t){return _this96._convertItem(e,t);},convertChildren:function convertChildren(e,t){return _this96._convertChildren(e,t);},safeInsert:function safeInsert(e,t){return _this96._safeInsert(e,t);},updateConversionResult:function updateConversionResult(e,t){return _this96._updateConversionResult(e,t);},splitToAllowedParent:function splitToAllowedParent(e,t){return _this96._splitToAllowedParent(e,t);},getSplitParts:function getSplitParts(e){return _this96._getSplitParts(e);},keepEmptyElement:function keepEmptyElement(e){return _this96._keepEmptyElement(e);}});return _this96;}_inherits(wd,_L14);return _createClass(wd,[{key:"convert",value:function convert(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:["$root"];this.fire("viewCleanup",e),this._modelCursor=function(e,t){var i;var _iterator236=_createForOfIteratorHelper(new sd(e)),_step236;try{for(_iterator236.s();!(_step236=_iterator236.n()).done;){var _n91=_step236.value;var _e265={};var _iterator237=_createForOfIteratorHelper(_n91.getAttributeKeys()),_step237;try{for(_iterator237.s();!(_step237=_iterator237.n()).done;){var _t148=_step237.value;_e265[_t148]=_n91.getAttribute(_t148);}}catch(err){_iterator237.e(err);}finally{_iterator237.f();}var _s59=t.createElement(_n91.name,_e265);i&&t.insert(_s59,i),i=Zl._createAt(_s59,0);}}catch(err){_iterator236.e(err);}finally{_iterator236.f();}return i;}(i,t),this.conversionApi.writer=t,this.conversionApi.consumable=ed.createFrom(e),this.conversionApi.store={};var _this$_convertItem=this._convertItem(e,this._modelCursor),n=_this$_convertItem.modelRange,s=t.createDocumentFragment();if(n){this._removeEmptyElements();for(var _i181=0,_Array$from5=Array.from(this._modelCursor.parent.getChildren());_i181<_Array$from5.length;_i181++){var _e266=_Array$from5[_i181];t.append(_e266,s);}s.markers=function(e,t){var i=new Set(),n=new Map(),s=tc._createIn(e).getItems();var _iterator238=_createForOfIteratorHelper(s),_step238;try{for(_iterator238.s();!(_step238=_iterator238.n()).done;){var _e267=_step238.value;_e267.is("element","$marker")&&i.add(_e267);}}catch(err){_iterator238.e(err);}finally{_iterator238.f();}var _iterator239=_createForOfIteratorHelper(i),_step239;try{for(_iterator239.s();!(_step239=_iterator239.n()).done;){var _e268=_step239.value;var _i182=_e268.getAttribute("data-name"),_s60=t.createPositionBefore(_e268);n.has(_i182)?n.get(_i182).end=_s60.clone():n.set(_i182,new tc(_s60.clone())),t.remove(_e268);}}catch(err){_iterator239.e(err);}finally{_iterator239.f();}return n;}(s,t);}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,s;}},{key:"_convertItem",value:function _convertItem(e,t){var i={viewItem:e,modelCursor:t,modelRange:null};if(e.is("element")?this.fire("element:".concat(e.name),i,this.conversionApi):e.is("$text")?this.fire("text",i,this.conversionApi):this.fire("documentFragment",i,this.conversionApi),i.modelRange&&!(i.modelRange instanceof tc))throw new A("view-conversion-dispatcher-incorrect-result",this);return{modelRange:i.modelRange,modelCursor:i.modelCursor};}},{key:"_convertChildren",value:function _convertChildren(e,t){var i=t.is("position")?t:Zl._createAt(t,0);var n=new tc(i);for(var _i183=0,_Array$from6=Array.from(e.getChildren());_i183<_Array$from6.length;_i183++){var _t149=_Array$from6[_i183];var _e269=this._convertItem(_t149,i);_e269.modelRange instanceof tc&&(n.end=_e269.modelRange.end,i=_e269.modelCursor);}return{modelRange:n,modelCursor:i};}},{key:"_safeInsert",value:function _safeInsert(e,t){var i=this._splitToAllowedParent(e,t);return!!i&&(this.conversionApi.writer.insert(e,i.position),!0);}},{key:"_updateConversionResult",value:function _updateConversionResult(e,t){var i=this._getSplitParts(e),n=this.conversionApi.writer;t.modelRange||(t.modelRange=n.createRange(n.createPositionBefore(e),n.createPositionAfter(i[i.length-1])));var s=this._cursorParents.get(e);t.modelCursor=s?n.createPositionAt(s,0):t.modelRange.end;}},{key:"_splitToAllowedParent",value:function _splitToAllowedParent(e,t){var _this$conversionApi=this.conversionApi,i=_this$conversionApi.schema,n=_this$conversionApi.writer;var s=i.findAllowedParent(t,e);if(s){if(s===t.parent)return{position:t};this._modelCursor.parent.getAncestors().includes(s)&&(s=null);}if(!s)return zc(t,e,i)?{position:Hc(t,n)}:null;var o=this.conversionApi.writer.split(t,s),r=[];var _iterator240=_createForOfIteratorHelper(o.range.getWalker()),_step240;try{for(_iterator240.s();!(_step240=_iterator240.n()).done;){var _e270=_step240.value;if("elementEnd"==_e270.type)r.push(_e270.item);else{var _t150=r.pop(),_i184=_e270.item;this._registerSplitPair(_t150,_i184);}}}catch(err){_iterator240.e(err);}finally{_iterator240.f();}var a=o.range.end.parent;return this._cursorParents.set(e,a),{position:o.position,cursorParent:a};}},{key:"_registerSplitPair",value:function _registerSplitPair(e,t){this._splitParts.has(e)||this._splitParts.set(e,[e]);var i=this._splitParts.get(e);this._splitParts.set(t,i),i.push(t);}},{key:"_getSplitParts",value:function _getSplitParts(e){var t;return t=this._splitParts.has(e)?this._splitParts.get(e):[e],t;}},{key:"_keepEmptyElement",value:function _keepEmptyElement(e){this._emptyElementsToKeep.add(e);}},{key:"_removeEmptyElements",value:function _removeEmptyElements(){var e=!1;var _iterator241=_createForOfIteratorHelper(this._splitParts.keys()),_step241;try{for(_iterator241.s();!(_step241=_iterator241.n()).done;){var _t151=_step241.value;_t151.isEmpty&&!this._emptyElementsToKeep.has(_t151)&&(this.conversionApi.writer.remove(_t151),this._splitParts["delete"](_t151),e=!0);}}catch(err){_iterator241.e(err);}finally{_iterator241.f();}e&&this._removeEmptyElements();}}]);}(L());var _d=/*#__PURE__*/function(){function _d(){_classCallCheck(this,_d);}return _createClass(_d,[{key:"getHtml",value:function getHtml(e){var t=i.document.implementation.createHTMLDocument("").createElement("div");return t.appendChild(e),t.innerHTML;}}]);}();var vd=/*#__PURE__*/function(){function vd(e){_classCallCheck(this,vd);_defineProperty(this,"domParser",void 0);_defineProperty(this,"domConverter",void 0);_defineProperty(this,"htmlWriter",void 0);_defineProperty(this,"skipComments",!0);this.domParser=new DOMParser(),this.domConverter=new yl(e,{renderingMode:"data"}),this.htmlWriter=new _d();}return _createClass(vd,[{key:"toData",value:function toData(e){var t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t);}},{key:"toView",value:function toView(e){var t=this._toDom(e);return this.domConverter.domToView(t,{skipComments:this.skipComments});}},{key:"registerRawContentMatcher",value:function registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e);}},{key:"useFillerType",value:function useFillerType(e){this.domConverter.blockFillerMode="marked"==e?"markedNbsp":"nbsp";}},{key:"_toDom",value:function _toDom(e){/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(e.trim().slice(0,1e4))||(e="<body>".concat(e,"</body>"));var t=this.domParser.parseFromString(e,"text/html"),i=t.createDocumentFragment(),n=t.body.childNodes;for(;n.length>0;)i.appendChild(n[0]);return i;}}]);}();var yd=/*#__PURE__*/function(_L15){function yd(e,t){var _this97;_classCallCheck(this,yd);_this97=_callSuper(this,yd),_defineProperty(_assertThisInitialized(_this97),"model",void 0),_defineProperty(_assertThisInitialized(_this97),"mapper",void 0),_defineProperty(_assertThisInitialized(_this97),"downcastDispatcher",void 0),_defineProperty(_assertThisInitialized(_this97),"upcastDispatcher",void 0),_defineProperty(_assertThisInitialized(_this97),"viewDocument",void 0),_defineProperty(_assertThisInitialized(_this97),"stylesProcessor",void 0),_defineProperty(_assertThisInitialized(_this97),"htmlProcessor",void 0),_defineProperty(_assertThisInitialized(_this97),"processor",void 0),_defineProperty(_assertThisInitialized(_this97),"_viewWriter",void 0),_this97.model=e,_this97.mapper=new ic(),_this97.downcastDispatcher=new oc({mapper:_this97.mapper,schema:e.schema}),_this97.downcastDispatcher.on("insert:$text",function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=i.writer,s=i.mapper.toViewPosition(t.range.start),o=n.createText(t.item.data);n.insert(s,o);},{priority:"lowest"}),_this97.downcastDispatcher.on("insert",function(e,t,i){i.convertAttributes(t.item),t.reconversion||!t.item.is("element")||t.item.isEmpty||i.convertChildren(t.item);},{priority:"lowest"}),_this97.upcastDispatcher=new wd({schema:e.schema}),_this97.viewDocument=new Ba(t),_this97.stylesProcessor=t,_this97.htmlProcessor=new vd(_this97.viewDocument),_this97.processor=_this97.htmlProcessor,_this97._viewWriter=new qa(_this97.viewDocument),_this97.upcastDispatcher.on("text",function(e,t,_ref29){var i=_ref29.schema,n=_ref29.consumable,s=_ref29.writer;var o=t.modelCursor;if(!n.test(t.viewItem))return;if(!i.checkChild(o,"$text")){if(!zc(o,"$text",i))return;if(0==t.viewItem.data.trim().length)return;o=Hc(o,s);}n.consume(t.viewItem);var r=s.createText(t.viewItem.data);s.insert(r,o),t.modelRange=s.createRange(o,o.getShiftedBy(r.offsetSize)),t.modelCursor=t.modelRange.end;},{priority:"lowest"}),_this97.upcastDispatcher.on("element",function(e,t,i){if(!t.modelRange&&i.consumable.consume(t.viewItem,{name:!0})){var _i$convertChildren=i.convertChildren(t.viewItem,t.modelCursor),_e271=_i$convertChildren.modelRange,_n92=_i$convertChildren.modelCursor;t.modelRange=_e271,t.modelCursor=_n92;}},{priority:"lowest"}),_this97.upcastDispatcher.on("documentFragment",function(e,t,i){if(!t.modelRange&&i.consumable.consume(t.viewItem,{name:!0})){var _i$convertChildren2=i.convertChildren(t.viewItem,t.modelCursor),_e272=_i$convertChildren2.modelRange,_n93=_i$convertChildren2.modelCursor;t.modelRange=_e272,t.modelCursor=_n93;}},{priority:"lowest"}),Zs().prototype.decorate.call(_assertThisInitialized(_this97),"init"),Zs().prototype.decorate.call(_assertThisInitialized(_this97),"set"),Zs().prototype.decorate.call(_assertThisInitialized(_this97),"get"),Zs().prototype.decorate.call(_assertThisInitialized(_this97),"toView"),Zs().prototype.decorate.call(_assertThisInitialized(_this97),"toModel"),_this97.on("init",function(){_this97.fire("ready");},{priority:"lowest"}),_this97.on("ready",function(){_this97.model.enqueueChange({isUndoable:!1},Dc);},{priority:"lowest"});return _this97;}_inherits(yd,_L15);return _createClass(yd,[{key:"get",value:function get(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _e$rootName=e.rootName,t=_e$rootName===void 0?"main":_e$rootName,_e$trim=e.trim,i=_e$trim===void 0?"empty":_e$trim;if(!this._checkIfRootsExists([t]))throw new A("datacontroller-get-non-existent-root",this);var n=this.model.document.getRoot(t);return n.isAttached()||E("datacontroller-get-detached-root",this),"empty"!==i||this.model.hasContent(n,{ignoreWhitespaces:!0})?this.stringify(n,e):"";}},{key:"stringify",value:function stringify(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.toView(e,t);return this.processor.toData(i);}},{key:"toView",value:function toView(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.viewDocument,n=this._viewWriter;this.mapper.clearBindings();var s=tc._createIn(e),o=new ja(i);this.mapper.bindElements(e,o);var r=e.is("documentFragment")?e.markers:function(e){var t=[],i=e.root.document;if(!i)return new Map();var n=tc._createIn(e);var _iterator242=_createForOfIteratorHelper(i.model.markers),_step242;try{for(_iterator242.s();!(_step242=_iterator242.n()).done;){var _e273=_step242.value;var _i185=_e273.getRange(),_s61=_i185.isCollapsed,_o32=_i185.start.isEqual(n.start)||_i185.end.isEqual(n.end);if(_s61&&_o32)t.push([_e273.name,_i185]);else{var _s62=n.getIntersection(_i185);_s62&&t.push([_e273.name,_s62]);}}}catch(err){_iterator242.e(err);}finally{_iterator242.f();}return t.sort(function(_ref30,_ref31){var _ref32=_slicedToArray(_ref30,2),e=_ref32[0],t=_ref32[1];var _ref33=_slicedToArray(_ref31,2),i=_ref33[0],n=_ref33[1];if("after"!==t.end.compareWith(n.start))return 1;if("before"!==t.start.compareWith(n.end))return-1;switch(t.start.compareWith(n.start)){case"before":return 1;case"after":return-1;default:switch(t.end.compareWith(n.end)){case"before":return 1;case"after":return-1;default:return i.localeCompare(e);}}}),new Map(t);}(e);return this.downcastDispatcher.convert(s,r,n,t),o;}},{key:"init",value:function init(e){var _this98=this;if(this.model.document.version)throw new A("datacontroller-init-document-not-empty",this);var t={};if("string"==typeof e?t.main=e:t=e,!this._checkIfRootsExists(Object.keys(t)))throw new A("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},function(e){for(var _i186=0,_Object$keys3=Object.keys(t);_i186<_Object$keys3.length;_i186++){var _i187=_Object$keys3[_i186];var _n94=_this98.model.document.getRoot(_i187);e.insert(_this98.parse(t[_i187],_n94),_n94,0);}}),Promise.resolve();}},{key:"set",value:function set(e){var _this99=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i={};if("string"==typeof e?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new A("datacontroller-set-non-existent-root",this);this.model.enqueueChange(t.batchType||{},function(e){e.setSelection(null),e.removeSelectionAttribute(_this99.model.document.selection.getAttributeKeys());for(var _i188=0,_Object$keys4=Object.keys(i);_i188<_Object$keys4.length;_i188++){var _t152=_Object$keys4[_i188];var _n95=_this99.model.document.getRoot(_t152);e.remove(e.createRangeIn(_n95)),e.insert(_this99.parse(i[_t152],_n95),_n95,0);}});}},{key:"parse",value:function parse(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"$root";var i=this.processor.toView(e);return this.toModel(i,t);}},{key:"toModel",value:function toModel(e){var _this100=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"$root";return this.model.change(function(i){return _this100.upcastDispatcher.convert(e,i,t);});}},{key:"addStyleProcessorRules",value:function addStyleProcessorRules(e){e(this.stylesProcessor);}},{key:"registerRawContentMatcher",value:function registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e);}},{key:"destroy",value:function destroy(){this.stopListening();}},{key:"_checkIfRootsExists",value:function _checkIfRootsExists(e){var _iterator243=_createForOfIteratorHelper(e),_step243;try{for(_iterator243.s();!(_step243=_iterator243.n()).done;){var _t153=_step243.value;if(!this.model.document.getRoot(_t153))return!1;}}catch(err){_iterator243.e(err);}finally{_iterator243.f();}return!0;}}]);}(L());var kd=/*#__PURE__*/function(){function kd(e,t){_classCallCheck(this,kd);_defineProperty(this,"_helpers",new Map());_defineProperty(this,"_downcast",void 0);_defineProperty(this,"_upcast",void 0);this._downcast=gr(e),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=gr(t),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1});}return _createClass(kd,[{key:"addAlias",value:function addAlias(e,t){var i=this._downcast.includes(t);if(!this._upcast.includes(t)&&!i)throw new A("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:e,dispatchers:[t],isDowncast:i});}},{key:"for",value:function _for(e){if(!this._helpers.has(e))throw new A("conversion-for-unknown-group",this);return this._helpers.get(e);}},{key:"elementToElement",value:function elementToElement(e){this["for"]("downcast").elementToElement(e);var _iterator244=_createForOfIteratorHelper(Cd(e)),_step244;try{for(_iterator244.s();!(_step244=_iterator244.n()).done;){var _step244$value=_step244.value,_t154=_step244$value.model,_i189=_step244$value.view;this["for"]("upcast").elementToElement({model:_t154,view:_i189,converterPriority:e.converterPriority});}}catch(err){_iterator244.e(err);}finally{_iterator244.f();}}},{key:"attributeToElement",value:function attributeToElement(e){this["for"]("downcast").attributeToElement(e);var _iterator245=_createForOfIteratorHelper(Cd(e)),_step245;try{for(_iterator245.s();!(_step245=_iterator245.n()).done;){var _step245$value=_step245.value,_t155=_step245$value.model,_i190=_step245$value.view;this["for"]("upcast").elementToAttribute({view:_i190,model:_t155,converterPriority:e.converterPriority});}}catch(err){_iterator245.e(err);}finally{_iterator245.f();}}},{key:"attributeToAttribute",value:function attributeToAttribute(e){this["for"]("downcast").attributeToAttribute(e);var _iterator246=_createForOfIteratorHelper(Cd(e)),_step246;try{for(_iterator246.s();!(_step246=_iterator246.n()).done;){var _step246$value=_step246.value,_t156=_step246$value.model,_i191=_step246$value.view;this["for"]("upcast").attributeToAttribute({view:_i191,model:_t156});}}catch(err){_iterator246.e(err);}finally{_iterator246.f();}}},{key:"_createConversionHelpers",value:function _createConversionHelpers(_ref34){var e=_ref34.name,t=_ref34.dispatchers,i=_ref34.isDowncast;if(this._helpers.has(e))throw new A("conversion-group-exists",this);var n=i?new Cc(t):new $c(t);this._helpers.set(e,n);}}]);}();function Cd(e){var _iterator247,_step247,_t157,_i192,_n96,_s63;return _regeneratorRuntime().wrap(function Cd$(_context29){while(1)switch(_context29.prev=_context29.next){case 0:if(!e.model.values){_context29.next=20;break;}_iterator247=_createForOfIteratorHelper(e.model.values);_context29.prev=2;_iterator247.s();case 4:if((_step247=_iterator247.n()).done){_context29.next=10;break;}_t157=_step247.value;_i192={key:e.model.key,value:_t157},_n96=e.view[_t157],_s63=e.upcastAlso?e.upcastAlso[_t157]:void 0;return _context29.delegateYield(xd(_i192,_n96,_s63),"t0",8);case 8:_context29.next=4;break;case 10:_context29.next=15;break;case 12:_context29.prev=12;_context29.t1=_context29["catch"](2);_iterator247.e(_context29.t1);case 15:_context29.prev=15;_iterator247.f();return _context29.finish(15);case 18:_context29.next=21;break;case 20:return _context29.delegateYield(xd(e.model,e.view,e.upcastAlso),"t2",21);case 21:case"end":return _context29.stop();}},_marked,null,[[2,12,15,18]]);}function xd(e,t,i){var _iterator248,_step248,_t158;return _regeneratorRuntime().wrap(function xd$(_context30){while(1)switch(_context30.prev=_context30.next){case 0:_context30.next=2;return{model:e,view:t};case 2:if(!i){_context30.next=20;break;}_iterator248=_createForOfIteratorHelper(gr(i));_context30.prev=4;_iterator248.s();case 6:if((_step248=_iterator248.n()).done){_context30.next=12;break;}_t158=_step248.value;_context30.next=10;return{model:e,view:_t158};case 10:_context30.next=6;break;case 12:_context30.next=17;break;case 14:_context30.prev=14;_context30.t0=_context30["catch"](4);_iterator248.e(_context30.t0);case 17:_context30.prev=17;_iterator248.f();return _context30.finish(17);case 20:case"end":return _context30.stop();}},_marked2,null,[[4,14,17,20]]);}var Ad=/*#__PURE__*/function(){function Ad(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Ad);_defineProperty(this,"namespaces",void 0);_defineProperty(this,"domParser",void 0);_defineProperty(this,"domConverter",void 0);_defineProperty(this,"htmlWriter",void 0);_defineProperty(this,"skipComments",!0);this.namespaces=t.namespaces||[],this.domParser=new DOMParser(),this.domConverter=new yl(e,{renderingMode:"data"}),this.htmlWriter=new _d();}return _createClass(Ad,[{key:"toData",value:function toData(e){var t=this.domConverter.viewToDom(e);return this.htmlWriter.getHtml(t);}},{key:"toView",value:function toView(e){var t=this._toDom(e);return this.domConverter.domToView(t,{keepOriginalCase:!0,skipComments:this.skipComments});}},{key:"registerRawContentMatcher",value:function registerRawContentMatcher(e){this.domConverter.registerRawContentMatcher(e);}},{key:"useFillerType",value:function useFillerType(e){this.domConverter.blockFillerMode="marked"==e?"markedNbsp":"nbsp";}},{key:"_toDom",value:function _toDom(e){e="<xml ".concat(this.namespaces.map(function(e){return"xmlns:".concat(e,"=\"nsp\"");}).join(" "),">").concat(e,"</xml>");var t=this.domParser.parseFromString(e,"text/xml"),i=t.querySelector("parsererror");if(i)throw new Error("Parse error - "+i.textContent);var n=t.createDocumentFragment(),s=t.documentElement.childNodes;for(;s.length>0;)n.appendChild(s[0]);return n;}}]);}();var Ed=/*#__PURE__*/function(){function Ed(e){_classCallCheck(this,Ed);_defineProperty(this,"baseVersion",void 0);_defineProperty(this,"isDocumentOperation",void 0);_defineProperty(this,"batch",void 0);this.baseVersion=e,this.isDocumentOperation=null!==this.baseVersion,this.batch=null;}return _createClass(Ed,[{key:"_validate",value:function _validate(){}},{key:"toJSON",value:function toJSON(){var e=Object.assign({},this);return e.__className=this.constructor.className,delete e.batch,delete e.isDocumentOperation,e;}}],[{key:"className",get:function get(){return"Operation";}},{key:"fromJSON",value:function fromJSON(e,t){return new this(e.baseVersion);}}]);}();function Td(e,t){var i=Id(t),n=i.reduce(function(e,t){return e+t.offsetSize;},0),s=e.parent;Rd(e);var o=e.index;return s._insertChild(o,i),Vd(s,o+i.length),Vd(s,o),new tc(e,e.getShiftedBy(n));}function Pd(e){if(!e.isFlat)throw new A("operation-utils-remove-range-not-flat",this);var t=e.start.parent;Rd(e.start),Rd(e.end);var i=t._removeChildren(e.start.index,e.end.index-e.start.index);return Vd(t,e.start.index),i;}function Sd(e,t){if(!e.isFlat)throw new A("operation-utils-move-range-not-flat",this);var i=Pd(e);return Td(t=t._getTransformedByDeletion(e.start,e.end.offset-e.start.offset),i);}function Id(e){var t=[];!function e(i){if("string"==typeof i)t.push(new Wl(i));else if(i instanceof jl)t.push(new Wl(i.data,i.getAttributes()));else if(i instanceof $l)t.push(i);else if(oo(i)){var _iterator249=_createForOfIteratorHelper(i),_step249;try{for(_iterator249.s();!(_step249=_iterator249.n()).done;){var _t159=_step249.value;e(_t159);}}catch(err){_iterator249.e(err);}finally{_iterator249.f();}}}(e);for(var _e274=1;_e274<t.length;_e274++){var _i193=t[_e274],_n97=t[_e274-1];_i193 instanceof Wl&&_n97 instanceof Wl&&Od(_i193,_n97)&&(t.splice(_e274-1,2,new Wl(_n97.data+_i193.data,_n97.getAttributes())),_e274--);}return t;}function Vd(e,t){var i=e.getChild(t-1),n=e.getChild(t);if(i&&n&&i.is("$text")&&n.is("$text")&&Od(i,n)){var _s64=new Wl(i.data+n.data,i.getAttributes());e._removeChildren(t-1,2),e._insertChild(t-1,_s64);}}function Rd(e){var t=e.textNode,i=e.parent;if(t){var _n98=e.offset-t.startOffset,_s65=t.index;i._removeChildren(_s65,1);var _o33=new Wl(t.data.substr(0,_n98),t.getAttributes()),_r20=new Wl(t.data.substr(_n98),t.getAttributes());i._insertChild(_s65,[_o33,_r20]);}}function Od(e,t){var i=e.getAttributes(),n=t.getAttributes();var _iterator250=_createForOfIteratorHelper(i),_step250;try{for(_iterator250.s();!(_step250=_iterator250.n()).done;){var _e275=_step250.value;if(_e275[1]!==t.getAttribute(_e275[0]))return!1;n.next();}}catch(err){_iterator250.e(err);}finally{_iterator250.f();}return n.next().done;}var Bd=/*#__PURE__*/function(_Ed2){function Bd(e,t,i,n){var _this101;_classCallCheck(this,Bd);_this101=_callSuper(this,Bd,[n]),_defineProperty(_assertThisInitialized(_this101),"sourcePosition",void 0),_defineProperty(_assertThisInitialized(_this101),"howMany",void 0),_defineProperty(_assertThisInitialized(_this101),"targetPosition",void 0),_this101.sourcePosition=e.clone(),_this101.sourcePosition.stickiness="toNext",_this101.howMany=t,_this101.targetPosition=i.clone(),_this101.targetPosition.stickiness="toNone";return _this101;}_inherits(Bd,_Ed2);return _createClass(Bd,[{key:"type",get:function get(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move";}},{key:"affectedSelectable",get:function get(){return[tc._createFromPositionAndShift(this.sourcePosition,this.howMany),tc._createFromPositionAndShift(this.targetPosition,0)];}},{key:"clone",value:function clone(){return new Bd(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion);}},{key:"getMovedRangeStart",value:function getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany);}},{key:"getReversed",value:function getReversed(){var e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new Bd(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1);}},{key:"_validate",value:function _validate(){var e=this.sourcePosition.parent,t=this.targetPosition.parent,i=this.sourcePosition.offset,n=this.targetPosition.offset;if(i+this.howMany>e.maxOffset)throw new A("move-operation-nodes-do-not-exist",this);if(e===t&&i<n&&n<i+this.howMany)throw new A("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==so(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){var _e276=this.sourcePosition.path.length-1;if(this.targetPosition.path[_e276]>=i&&this.targetPosition.path[_e276]<i+this.howMany)throw new A("move-operation-node-into-itself",this);}}},{key:"_execute",value:function _execute(){Sd(tc._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Bd,"toJSON",this,3)([]);return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e;}}],[{key:"className",get:function get(){return"MoveOperation";}},{key:"fromJSON",value:function fromJSON(e,t){var i=Zl.fromJSON(e.sourcePosition,t),n=Zl.fromJSON(e.targetPosition,t);return new this(i,e.howMany,n,e.baseVersion);}}]);}(Ed);var Md=/*#__PURE__*/function(_Ed3){function Md(e,t,i){var _this102;_classCallCheck(this,Md);_this102=_callSuper(this,Md,[i]),_defineProperty(_assertThisInitialized(_this102),"position",void 0),_defineProperty(_assertThisInitialized(_this102),"nodes",void 0),_defineProperty(_assertThisInitialized(_this102),"shouldReceiveAttributes",void 0),_this102.position=e.clone(),_this102.position.stickiness="toNone",_this102.nodes=new Ul(Id(t)),_this102.shouldReceiveAttributes=!1;return _this102;}_inherits(Md,_Ed3);return _createClass(Md,[{key:"type",get:function get(){return"insert";}},{key:"howMany",get:function get(){return this.nodes.maxOffset;}},{key:"affectedSelectable",get:function get(){return this.position.clone();}},{key:"clone",value:function clone(){var e=new Ul(_toConsumableArray(this.nodes).map(function(e){return e._clone(!0);})),t=new Md(this.position,e,this.baseVersion);return t.shouldReceiveAttributes=this.shouldReceiveAttributes,t;}},{key:"getReversed",value:function getReversed(){var e=this.position.root.document.graveyard,t=new Zl(e,[0]);return new Bd(this.position,this.nodes.maxOffset,t,this.baseVersion+1);}},{key:"_validate",value:function _validate(){var e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new A("insert-operation-position-invalid",this);}},{key:"_execute",value:function _execute(){var e=this.nodes;this.nodes=new Ul(_toConsumableArray(e).map(function(e){return e._clone(!0);})),Td(this.position,e);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Md,"toJSON",this,3)([]);return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e;}}],[{key:"className",get:function get(){return"InsertOperation";}},{key:"fromJSON",value:function fromJSON(e,t){var i=[];var _iterator251=_createForOfIteratorHelper(e.nodes),_step251;try{for(_iterator251.s();!(_step251=_iterator251.n()).done;){var _t160=_step251.value;_t160.name?i.push(ql.fromJSON(_t160)):i.push(Wl.fromJSON(_t160));}}catch(err){_iterator251.e(err);}finally{_iterator251.f();}var n=new Md(Zl.fromJSON(e.position,t),i,e.baseVersion);return n.shouldReceiveAttributes=e.shouldReceiveAttributes,n;}}]);}(Ed);var Ld=/*#__PURE__*/function(_Ed4){function Ld(e,t,i,n,s){var _this103;_classCallCheck(this,Ld);_this103=_callSuper(this,Ld,[s]),_defineProperty(_assertThisInitialized(_this103),"splitPosition",void 0),_defineProperty(_assertThisInitialized(_this103),"howMany",void 0),_defineProperty(_assertThisInitialized(_this103),"insertionPosition",void 0),_defineProperty(_assertThisInitialized(_this103),"graveyardPosition",void 0),_this103.splitPosition=e.clone(),_this103.splitPosition.stickiness="toNext",_this103.howMany=t,_this103.insertionPosition=i,_this103.graveyardPosition=n?n.clone():null,_this103.graveyardPosition&&(_this103.graveyardPosition.stickiness="toNext");return _this103;}_inherits(Ld,_Ed4);return _createClass(Ld,[{key:"type",get:function get(){return"split";}},{key:"moveTargetPosition",get:function get(){var e=this.insertionPosition.path.slice();return e.push(0),new Zl(this.insertionPosition.root,e);}},{key:"movedRange",get:function get(){var e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new tc(this.splitPosition,e);}},{key:"affectedSelectable",get:function get(){var e=[tc._createFromPositionAndShift(this.splitPosition,0),tc._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(tc._createFromPositionAndShift(this.graveyardPosition,0)),e;}},{key:"clone",value:function clone(){return new Ld(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion);}},{key:"getReversed",value:function getReversed(){var e=this.splitPosition.root.document.graveyard,t=new Zl(e,[0]);return new Fd(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1);}},{key:"_validate",value:function _validate(){var e=this.splitPosition.parent,t=this.splitPosition.offset;if(!e||e.maxOffset<t)throw new A("split-operation-position-invalid",this);if(!e.parent)throw new A("split-operation-split-in-root",this);if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new A("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new A("split-operation-graveyard-position-invalid",this);}},{key:"_execute",value:function _execute(){var e=this.splitPosition.parent;if(this.graveyardPosition)Sd(tc._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{var _t161=e._clone();Td(this.insertionPosition,_t161);}Sd(new tc(Zl._createAt(e,this.splitPosition.offset),Zl._createAt(e,e.maxOffset)),this.moveTargetPosition);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Ld,"toJSON",this,3)([]);return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e;}}],[{key:"className",get:function get(){return"SplitOperation";}},{key:"getInsertionPosition",value:function getInsertionPosition(e){var t=e.path.slice(0,-1);return t[t.length-1]++,new Zl(e.root,t,"toPrevious");}},{key:"fromJSON",value:function fromJSON(e,t){var i=Zl.fromJSON(e.splitPosition,t),n=Zl.fromJSON(e.insertionPosition,t),s=e.graveyardPosition?Zl.fromJSON(e.graveyardPosition,t):null;return new this(i,e.howMany,n,s,e.baseVersion);}}]);}(Ed);var Fd=/*#__PURE__*/function(_Ed5){function Fd(e,t,i,n,s){var _this104;_classCallCheck(this,Fd);_this104=_callSuper(this,Fd,[s]),_defineProperty(_assertThisInitialized(_this104),"sourcePosition",void 0),_defineProperty(_assertThisInitialized(_this104),"howMany",void 0),_defineProperty(_assertThisInitialized(_this104),"targetPosition",void 0),_defineProperty(_assertThisInitialized(_this104),"graveyardPosition",void 0),_this104.sourcePosition=e.clone(),_this104.sourcePosition.stickiness="toPrevious",_this104.howMany=t,_this104.targetPosition=i.clone(),_this104.targetPosition.stickiness="toNext",_this104.graveyardPosition=n.clone();return _this104;}_inherits(Fd,_Ed5);return _createClass(Fd,[{key:"type",get:function get(){return"merge";}},{key:"deletionPosition",get:function get(){return new Zl(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1));}},{key:"movedRange",get:function get(){var e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new tc(this.sourcePosition,e);}},{key:"affectedSelectable",get:function get(){var e=this.sourcePosition.parent;return[tc._createOn(e),tc._createFromPositionAndShift(this.targetPosition,0),tc._createFromPositionAndShift(this.graveyardPosition,0)];}},{key:"clone",value:function clone(){return new Fd(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion);}},{key:"getReversed",value:function getReversed(){var e=this.targetPosition._getTransformedByMergeOperation(this),t=this.sourcePosition.path.slice(0,-1),i=new Zl(this.sourcePosition.root,t)._getTransformedByMergeOperation(this);return new Ld(e,this.howMany,i,this.graveyardPosition,this.baseVersion+1);}},{key:"_validate",value:function _validate(){var e=this.sourcePosition.parent,t=this.targetPosition.parent;if(!e.parent)throw new A("merge-operation-source-position-invalid",this);if(!t.parent)throw new A("merge-operation-target-position-invalid",this);if(this.howMany!=e.maxOffset)throw new A("merge-operation-how-many-invalid",this);}},{key:"_execute",value:function _execute(){var e=this.sourcePosition.parent;Sd(tc._createIn(e),this.targetPosition),Sd(tc._createOn(e),this.graveyardPosition);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Fd,"toJSON",this,3)([]);return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e;}}],[{key:"className",get:function get(){return"MergeOperation";}},{key:"fromJSON",value:function fromJSON(e,t){var i=Zl.fromJSON(e.sourcePosition,t),n=Zl.fromJSON(e.targetPosition,t),s=Zl.fromJSON(e.graveyardPosition,t);return new this(i,e.howMany,n,s,e.baseVersion);}}]);}(Ed);var Nd=/*#__PURE__*/function(_Ed6){function Nd(e,t,i,n,s,o){var _this105;_classCallCheck(this,Nd);_this105=_callSuper(this,Nd,[o]),_defineProperty(_assertThisInitialized(_this105),"name",void 0),_defineProperty(_assertThisInitialized(_this105),"oldRange",void 0),_defineProperty(_assertThisInitialized(_this105),"newRange",void 0),_defineProperty(_assertThisInitialized(_this105),"affectsData",void 0),_defineProperty(_assertThisInitialized(_this105),"_markers",void 0),_this105.name=e,_this105.oldRange=t?t.clone():null,_this105.newRange=i?i.clone():null,_this105.affectsData=s,_this105._markers=n;return _this105;}_inherits(Nd,_Ed6);return _createClass(Nd,[{key:"type",get:function get(){return"marker";}},{key:"affectedSelectable",get:function get(){var e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push.apply(e,_toConsumableArray(this.newRange.getDifference(this.oldRange))):e.push(this.newRange.clone())),e;}},{key:"clone",value:function clone(){return new Nd(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion);}},{key:"getReversed",value:function getReversed(){return new Nd(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1);}},{key:"_execute",value:function _execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Nd,"toJSON",this,3)([]);return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e;}}],[{key:"className",get:function get(){return"MarkerOperation";}},{key:"fromJSON",value:function fromJSON(e,t){return new Nd(e.name,e.oldRange?tc.fromJSON(e.oldRange,t):null,e.newRange?tc.fromJSON(e.newRange,t):null,t.model.markers,e.affectsData,e.baseVersion);}}]);}(Ed);var Dd=/*#__PURE__*/function(_Ed7){function Dd(e,t,i,n,s){var _this106;_classCallCheck(this,Dd);_this106=_callSuper(this,Dd,[s]),_defineProperty(_assertThisInitialized(_this106),"range",void 0),_defineProperty(_assertThisInitialized(_this106),"key",void 0),_defineProperty(_assertThisInitialized(_this106),"oldValue",void 0),_defineProperty(_assertThisInitialized(_this106),"newValue",void 0),_this106.range=e.clone(),_this106.key=t,_this106.oldValue=void 0===i?null:i,_this106.newValue=void 0===n?null:n;return _this106;}_inherits(Dd,_Ed7);return _createClass(Dd,[{key:"type",get:function get(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute";}},{key:"affectedSelectable",get:function get(){return this.range.clone();}},{key:"clone",value:function clone(){return new Dd(this.range,this.key,this.oldValue,this.newValue,this.baseVersion);}},{key:"getReversed",value:function getReversed(){return new Dd(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Dd,"toJSON",this,3)([]);return e.range=this.range.toJSON(),e;}},{key:"_validate",value:function _validate(){if(!this.range.isFlat)throw new A("attribute-operation-range-not-flat",this);var _iterator252=_createForOfIteratorHelper(this.range.getItems({shallow:!0})),_step252;try{for(_iterator252.s();!(_step252=_iterator252.n()).done;){var _e277=_step252.value;if(null!==this.oldValue&&!Ls(_e277.getAttribute(this.key),this.oldValue))throw new A("attribute-operation-wrong-old-value",this,{item:_e277,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&_e277.hasAttribute(this.key))throw new A("attribute-operation-attribute-exists",this,{node:_e277,key:this.key});}}catch(err){_iterator252.e(err);}finally{_iterator252.f();}}},{key:"_execute",value:function _execute(){Ls(this.oldValue,this.newValue)||function(e,t,i){Rd(e.start),Rd(e.end);var _iterator253=_createForOfIteratorHelper(e.getItems({shallow:!0})),_step253;try{for(_iterator253.s();!(_step253=_iterator253.n()).done;){var _n99=_step253.value;var _e278=_n99.is("$textProxy")?_n99.textNode:_n99;null!==i?_e278._setAttribute(t,i):_e278._removeAttribute(t),Vd(_e278.parent,_e278.index);}}catch(err){_iterator253.e(err);}finally{_iterator253.f();}Vd(e.end.parent,e.end.index);}(this.range,this.key,this.newValue);}}],[{key:"className",get:function get(){return"AttributeOperation";}},{key:"fromJSON",value:function fromJSON(e,t){return new Dd(tc.fromJSON(e.range,t),e.key,e.oldValue,e.newValue,e.baseVersion);}}]);}(Ed);var zd=/*#__PURE__*/function(_Ed8){function zd(){_classCallCheck(this,zd);return _callSuper(this,zd,arguments);}_inherits(zd,_Ed8);return _createClass(zd,[{key:"type",get:function get(){return"noop";}},{key:"affectedSelectable",get:function get(){return null;}},{key:"clone",value:function clone(){return new zd(this.baseVersion);}},{key:"getReversed",value:function getReversed(){return new zd(this.baseVersion+1);}},{key:"_execute",value:function _execute(){}}],[{key:"className",get:function get(){return"NoOperation";}}]);}(Ed);var Hd=/*#__PURE__*/function(_Ed9){function Hd(e,t,i,n){var _this107;_classCallCheck(this,Hd);_this107=_callSuper(this,Hd,[n]),_defineProperty(_assertThisInitialized(_this107),"position",void 0),_defineProperty(_assertThisInitialized(_this107),"oldName",void 0),_defineProperty(_assertThisInitialized(_this107),"newName",void 0),_this107.position=e,_this107.position.stickiness="toNext",_this107.oldName=t,_this107.newName=i;return _this107;}_inherits(Hd,_Ed9);return _createClass(Hd,[{key:"type",get:function get(){return"rename";}},{key:"affectedSelectable",get:function get(){return this.position.nodeAfter;}},{key:"clone",value:function clone(){return new Hd(this.position.clone(),this.oldName,this.newName,this.baseVersion);}},{key:"getReversed",value:function getReversed(){return new Hd(this.position.clone(),this.newName,this.oldName,this.baseVersion+1);}},{key:"_validate",value:function _validate(){var e=this.position.nodeAfter;if(!(e instanceof ql))throw new A("rename-operation-wrong-position",this);if(e.name!==this.oldName)throw new A("rename-operation-wrong-name",this);}},{key:"_execute",value:function _execute(){this.position.nodeAfter.name=this.newName;}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Hd,"toJSON",this,3)([]);return e.position=this.position.toJSON(),e;}}],[{key:"className",get:function get(){return"RenameOperation";}},{key:"fromJSON",value:function fromJSON(e,t){return new Hd(Zl.fromJSON(e.position,t),e.oldName,e.newName,e.baseVersion);}}]);}(Ed);var $d=/*#__PURE__*/function(_Ed10){function $d(e,t,i,n,s){var _this108;_classCallCheck(this,$d);_this108=_callSuper(this,$d,[s]),_defineProperty(_assertThisInitialized(_this108),"root",void 0),_defineProperty(_assertThisInitialized(_this108),"key",void 0),_defineProperty(_assertThisInitialized(_this108),"oldValue",void 0),_defineProperty(_assertThisInitialized(_this108),"newValue",void 0),_this108.root=e,_this108.key=t,_this108.oldValue=void 0===i?null:i,_this108.newValue=void 0===n?null:n;return _this108;}_inherits($d,_Ed10);return _createClass($d,[{key:"type",get:function get(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute";}},{key:"affectedSelectable",get:function get(){return this.root;}},{key:"clone",value:function clone(){return new $d(this.root,this.key,this.oldValue,this.newValue,this.baseVersion);}},{key:"getReversed",value:function getReversed(){return new $d(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1);}},{key:"_validate",value:function _validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new A("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new A("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new A("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key});}},{key:"_execute",value:function _execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key);}},{key:"toJSON",value:function toJSON(){var e=_superPropGet($d,"toJSON",this,3)([]);return e.root=this.root.toJSON(),e;}}],[{key:"className",get:function get(){return"RootAttributeOperation";}},{key:"fromJSON",value:function fromJSON(e,t){if(!t.getRoot(e.root))throw new A("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new $d(t.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion);}}]);}(Ed);var Ud=/*#__PURE__*/function(_Ed11){function Ud(e,t,i,n,s){var _this109;_classCallCheck(this,Ud);if(_this109=_callSuper(this,Ud,[s]),_defineProperty(_assertThisInitialized(_this109),"rootName",void 0),_defineProperty(_assertThisInitialized(_this109),"elementName",void 0),_defineProperty(_assertThisInitialized(_this109),"isAdd",void 0),_defineProperty(_assertThisInitialized(_this109),"_document",void 0),_this109.rootName=e,_this109.elementName=t,_this109.isAdd=i,_this109._document=n,!_this109._document.getRoot(_this109.rootName)){_this109._document.createRoot(_this109.elementName,_this109.rootName)._isAttached=!1;}return _this109;}_inherits(Ud,_Ed11);return _createClass(Ud,[{key:"type",get:function get(){return this.isAdd?"addRoot":"detachRoot";}},{key:"affectedSelectable",get:function get(){return this._document.getRoot(this.rootName);}},{key:"clone",value:function clone(){return new Ud(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion);}},{key:"getReversed",value:function getReversed(){return new Ud(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1);}},{key:"_execute",value:function _execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd;}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(Ud,"toJSON",this,3)([]);return delete e._document,e;}}],[{key:"className",get:function get(){return"RootOperation";}},{key:"fromJSON",value:function fromJSON(e,t){return new Ud(e.rootName,e.elementName,e.isAdd,t,e.baseVersion);}}]);}(Ed);var Wd={};Wd[Dd.className]=Dd,Wd[Md.className]=Md,Wd[Nd.className]=Nd,Wd[Bd.className]=Bd,Wd[zd.className]=zd,Wd[Ed.className]=Ed,Wd[Hd.className]=Hd,Wd[$d.className]=$d,Wd[Ud.className]=Ud,Wd[Ld.className]=Ld,Wd[Fd.className]=Fd;var jd=/*#__PURE__*/function(){function jd(){_classCallCheck(this,jd);}return _createClass(jd,null,[{key:"fromJSON",value:function fromJSON(e,t){return Wd[e.__className].fromJSON(e,t);}}]);}();var qd=new Map();function Gd(e,t,i){var n=qd.get(e);n||(n=new Map(),qd.set(e,n)),n.set(t,i);}function Kd(e){return[e];}function Zd(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=function(e,t){var i=qd.get(e);return i&&i.has(t)?i.get(t):Kd;}(e.constructor,t.constructor);try{return n(e=e.clone(),t,i);}catch(e){throw e;}}function Jd(e,t,i){e=e.slice(),t=t.slice();var n=new Qd(i.document,i.useRelations,i.forceWeakRemove);n.setOriginalOperations(e),n.setOriginalOperations(t);var s=n.originalOperations;if(0==e.length||0==t.length)return{operationsA:e,operationsB:t,originalOperations:s};var o=new WeakMap();var _iterator254=_createForOfIteratorHelper(e),_step254;try{for(_iterator254.s();!(_step254=_iterator254.n()).done;){var _t163=_step254.value;o.set(_t163,0);}}catch(err){_iterator254.e(err);}finally{_iterator254.f();}var r={nextBaseVersionA:e[e.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:e.length,originalOperationsBCount:t.length};var a=0;for(;a<e.length;){var _e279,_t162;var _i194=e[a],_s66=o.get(_i194);if(_s66==t.length){a++;continue;}var _r21=t[_s66],_l7=Zd(_i194,_r21,n.getContext(_i194,_r21,!0)),_c6=Zd(_r21,_i194,n.getContext(_r21,_i194,!1));n.updateRelation(_i194,_r21),n.setOriginalOperations(_l7,_i194),n.setOriginalOperations(_c6,_r21);var _iterator255=_createForOfIteratorHelper(_l7),_step255;try{for(_iterator255.s();!(_step255=_iterator255.n()).done;){var _e280=_step255.value;o.set(_e280,_s66+_c6.length);}}catch(err){_iterator255.e(err);}finally{_iterator255.f();}(_e279=e).splice.apply(_e279,[a,1].concat(_toConsumableArray(_l7))),(_t162=t).splice.apply(_t162,[_s66,1].concat(_toConsumableArray(_c6)));}if(eu(e),eu(t),i.padWithNoOps){var _i195=e.length-r.originalOperationsACount,_n100=t.length-r.originalOperationsBCount;Xd(e,_n100-_i195),Xd(t,_i195-_n100);}return Yd(e,r.nextBaseVersionB),Yd(t,r.nextBaseVersionA),{operationsA:e,operationsB:t,originalOperations:s};}var Qd=/*#__PURE__*/function(){function Qd(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;_classCallCheck(this,Qd);_defineProperty(this,"originalOperations",void 0);_defineProperty(this,"_history",void 0);_defineProperty(this,"_useRelations",void 0);_defineProperty(this,"_forceWeakRemove",void 0);_defineProperty(this,"_relations",void 0);this.originalOperations=new Map(),this._history=e.history,this._useRelations=t,this._forceWeakRemove=!!i,this._relations=new Map();}return _createClass(Qd,[{key:"setOriginalOperations",value:function setOriginalOperations(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=t?this.originalOperations.get(t):null;var _iterator256=_createForOfIteratorHelper(e),_step256;try{for(_iterator256.s();!(_step256=_iterator256.n()).done;){var _t164=_step256.value;this.originalOperations.set(_t164,i||_t164);}}catch(err){_iterator256.e(err);}finally{_iterator256.f();}}},{key:"updateRelation",value:function updateRelation(e,t){if(e instanceof Bd)t instanceof Fd?e.targetPosition.isEqual(t.sourcePosition)||t.movedRange.containsPosition(e.targetPosition)?this._setRelation(e,t,"insertAtSource"):e.targetPosition.isEqual(t.deletionPosition)?this._setRelation(e,t,"insertBetween"):e.targetPosition.isAfter(t.sourcePosition)&&this._setRelation(e,t,"moveTargetAfter"):t instanceof Bd&&(e.targetPosition.isEqual(t.sourcePosition)||e.targetPosition.isBefore(t.sourcePosition)?this._setRelation(e,t,"insertBefore"):this._setRelation(e,t,"insertAfter"));else if(e instanceof Ld){if(t instanceof Fd)e.splitPosition.isBefore(t.sourcePosition)&&this._setRelation(e,t,"splitBefore");else if(t instanceof Bd)if(e.splitPosition.isEqual(t.sourcePosition)||e.splitPosition.isBefore(t.sourcePosition))this._setRelation(e,t,"splitBefore");else{var _i196=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&_i196.containsPosition(e.splitPosition)){var _n101=_i196.end.offset-e.splitPosition.offset,_s67=e.splitPosition.offset-_i196.start.offset;this._setRelation(e,t,{howMany:_n101,offset:_s67});}}}else if(e instanceof Fd)t instanceof Fd?(e.targetPosition.isEqual(t.sourcePosition)||this._setRelation(e,t,"mergeTargetNotMoved"),e.sourcePosition.isEqual(t.targetPosition)&&this._setRelation(e,t,"mergeSourceNotMoved"),e.sourcePosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeSameElement")):t instanceof Ld?e.sourcePosition.isEqual(t.splitPosition)&&this._setRelation(e,t,"splitAtSource"):t instanceof Bd&&t.howMany>0&&(e.sourcePosition.isEqual(t.sourcePosition.getShiftedBy(t.howMany))&&this._setRelation(e,t,"mergeSourceAffected"),e.targetPosition.isEqual(t.sourcePosition)&&this._setRelation(e,t,"mergeTargetWasBefore"));else if(e instanceof Nd){var _i197=e.newRange;if(!_i197)return;if(t instanceof Fd){var _n102=_i197.start.isEqual(t.targetPosition),_s68=_i197.start.isEqual(t.deletionPosition),_o34=_i197.end.isEqual(t.deletionPosition),_r22=_i197.end.isEqual(t.sourcePosition);(_n102||_s68||_o34||_r22)&&this._setRelation(e,t,{wasInLeftElement:_n102,wasStartBeforeMergedElement:_s68,wasEndBeforeMergedElement:_o34,wasInRightElement:_r22});}}}},{key:"getContext",value:function getContext(e,t,i){return{aIsStrong:i,aWasUndone:this._wasUndone(e),bWasUndone:this._wasUndone(t),abRelation:this._useRelations?this._getRelation(e,t):null,baRelation:this._useRelations?this._getRelation(t,e):null,forceWeakRemove:this._forceWeakRemove};}},{key:"_wasUndone",value:function _wasUndone(e){var t=this.originalOperations.get(e);return t.wasUndone||this._history.isUndoneOperation(t);}},{key:"_getRelation",value:function _getRelation(e,t){var i=this.originalOperations.get(t),n=this._history.getUndoneOperation(i);if(!n)return null;var s=this.originalOperations.get(e),o=this._relations.get(s);return o&&o.get(n)||null;}},{key:"_setRelation",value:function _setRelation(e,t,i){var n=this.originalOperations.get(e),s=this.originalOperations.get(t);var o=this._relations.get(n);o||(o=new Map(),this._relations.set(n,o)),o.set(s,i);}}]);}();function Yd(e,t){var _iterator257=_createForOfIteratorHelper(e),_step257;try{for(_iterator257.s();!(_step257=_iterator257.n()).done;){var _i198=_step257.value;_i198.baseVersion=t++;}}catch(err){_iterator257.e(err);}finally{_iterator257.f();}}function Xd(e,t){for(var _i199=0;_i199<t;_i199++)e.push(new zd(0));}function eu(e){var t=new Map();for(var _i200=0;_i200<e.length;_i200++){var _n103=e[_i200];_n103 instanceof Nd&&(-1!==_n103.baseVersion?t.set(_n103.name,{op:_n103,ranges:_n103.newRange?[_n103.newRange]:[]}):(_n103.newRange&&t.get(_n103.name).ranges.push(_n103.newRange),e.splice(_i200,1),_i200--));}var _iterator258=_createForOfIteratorHelper(t.values()),_step258;try{for(_iterator258.s();!(_step258=_iterator258.n()).done;){var _step258$value=_step258.value,_e281=_step258$value.op,_i201=_step258$value.ranges;_i201.length?_e281.newRange=tc._createFromRanges(_i201):_e281.newRange=null;}}catch(err){_iterator258.e(err);}finally{_iterator258.f();}}function tu(e,t,i){var n=e.nodes.getNode(0).getAttribute(t);if(n==i)return null;var s=new tc(e.position,e.position.getShiftedBy(e.howMany));return new Dd(s,t,n,i,0);}function iu(e,t){return null===e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany);}function nu(e,t){var i=[];for(var _n104=0;_n104<e.length;_n104++){var _s69=e[_n104],_o35=new Bd(_s69.start,_s69.end.offset-_s69.start.offset,t,0);i.push(_o35);for(var _t165=_n104+1;_t165<e.length;_t165++)e[_t165]=e[_t165]._getTransformedByMove(_o35.sourcePosition,_o35.targetPosition,_o35.howMany)[0];t=t._getTransformedByMove(_o35.sourcePosition,_o35.targetPosition,_o35.howMany);}return i;}Gd(Dd,Dd,function(e,t,i){if(e.key===t.key&&e.range.start.hasSameParentAs(t.range.start)){var _n105=e.range.getDifference(t.range).map(function(t){return new Dd(t,e.key,e.oldValue,e.newValue,0);}),_s70=e.range.getIntersection(t.range);return _s70&&i.aIsStrong&&_n105.push(new Dd(_s70,t.key,t.newValue,e.newValue,0)),0==_n105.length?[new zd(0)]:_n105;}return[e];}),Gd(Dd,Md,function(e,t){if(e.range.start.hasSameParentAs(t.position)&&e.range.containsPosition(t.position)){var _i202=e.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(function(t){return new Dd(t,e.key,e.oldValue,e.newValue,e.baseVersion);});if(t.shouldReceiveAttributes){var _n106=tu(t,e.key,e.oldValue);_n106&&_i202.unshift(_n106);}return _i202;}return e.range=e.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[e];}),Gd(Dd,Fd,function(e,t){var i=[];e.range.start.hasSameParentAs(t.deletionPosition)&&(e.range.containsPosition(t.deletionPosition)||e.range.start.isEqual(t.deletionPosition))&&i.push(tc._createFromPositionAndShift(t.graveyardPosition,1));var n=e.range._getTransformedByMergeOperation(t);return n.isCollapsed||i.push(n),i.map(function(t){return new Dd(t,e.key,e.oldValue,e.newValue,e.baseVersion);});}),Gd(Dd,Bd,function(e,t){var i=function(e,t){var i=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);var n=null,s=[];i.containsRange(e,!0)?n=e:e.start.hasSameParentAs(i.start)?(s=e.getDifference(i),n=e.getIntersection(i)):s=[e];var o=[];var _iterator259=_createForOfIteratorHelper(s),_step259;try{for(_iterator259.s();!(_step259=_iterator259.n()).done;){var _e282=_step259.value;_e282=_e282._getTransformedByDeletion(t.sourcePosition,t.howMany);var _i203=t.getMovedRangeStart(),_n107=_e282.start.hasSameParentAs(_i203),_s71=_e282._getTransformedByInsertion(_i203,t.howMany,_n107);o.push.apply(o,_toConsumableArray(_s71));}}catch(err){_iterator259.e(err);}finally{_iterator259.f();}n&&o.push(n._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]);return o;}(e.range,t);return i.map(function(t){return new Dd(t,e.key,e.oldValue,e.newValue,e.baseVersion);});}),Gd(Dd,Ld,function(e,t){if(e.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.range.end.offset++,[e];if(e.range.start.hasSameParentAs(t.splitPosition)&&e.range.containsPosition(t.splitPosition)){var _i204=e.clone();return _i204.range=new tc(t.moveTargetPosition.clone(),e.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),e.range.end=t.splitPosition.clone(),e.range.end.stickiness="toPrevious",[e,_i204];}return e.range=e.range._getTransformedBySplitOperation(t),[e];}),Gd(Md,Dd,function(e,t){var i=[e];if(e.shouldReceiveAttributes&&e.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(e.position)){var _n108=tu(e,t.key,t.newValue);_n108&&i.push(_n108);}return i;}),Gd(Md,Md,function(e,t,i){return e.position.isEqual(t.position)&&i.aIsStrong||(e.position=e.position._getTransformedByInsertOperation(t)),[e];}),Gd(Md,Bd,function(e,t){return e.position=e.position._getTransformedByMoveOperation(t),[e];}),Gd(Md,Ld,function(e,t){return e.position=e.position._getTransformedBySplitOperation(t),[e];}),Gd(Md,Fd,function(e,t){return e.position=e.position._getTransformedByMergeOperation(t),[e];}),Gd(Nd,Md,function(e,t){return e.oldRange&&(e.oldRange=e.oldRange._getTransformedByInsertOperation(t)[0]),e.newRange&&(e.newRange=e.newRange._getTransformedByInsertOperation(t)[0]),[e];}),Gd(Nd,Nd,function(e,t,i){if(e.name==t.name){if(!i.aIsStrong)return[new zd(0)];e.oldRange=t.newRange?t.newRange.clone():null;}return[e];}),Gd(Nd,Fd,function(e,t){return e.oldRange&&(e.oldRange=e.oldRange._getTransformedByMergeOperation(t)),e.newRange&&(e.newRange=e.newRange._getTransformedByMergeOperation(t)),[e];}),Gd(Nd,Bd,function(e,t){var i=[e];if(e.oldRange&&(e.oldRange=tc._createFromRanges(e.oldRange._getTransformedByMoveOperation(t))),e.newRange){var _n109=e.newRange._getTransformedByMoveOperation(t);e.newRange=_n109[0];for(var _t166=1;_t166<_n109.length;_t166++){var _s72=e.clone();_s72.oldRange=null,_s72.newRange=_n109[_t166],_s72.baseVersion=-1,i.push(_s72);}}return i;}),Gd(Nd,Ld,function(e,t,i){if(e.oldRange&&(e.oldRange=e.oldRange._getTransformedBySplitOperation(t)),e.newRange){if(i.abRelation){var _n110=e.newRange._getTransformedBySplitOperation(t);return e.newRange.start.isEqual(t.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?e.newRange.start=Zl._createAt(t.insertionPosition):e.newRange.start.isEqual(t.splitPosition)&&!i.abRelation.wasInLeftElement?e.newRange.start=Zl._createAt(t.moveTargetPosition):e.newRange.start=_n110.start,e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasInRightElement?e.newRange.end=Zl._createAt(t.moveTargetPosition):e.newRange.end.isEqual(t.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?e.newRange.end=Zl._createAt(t.insertionPosition):e.newRange.end=_n110.end,[e];}e.newRange=e.newRange._getTransformedBySplitOperation(t);}return[e];}),Gd(Fd,Md,function(e,t){return e.sourcePosition.hasSameParentAs(t.position)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByInsertOperation(t),e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t),[e];}),Gd(Fd,Fd,function(e,t,i){if(e.sourcePosition.isEqual(t.sourcePosition)&&e.targetPosition.isEqual(t.targetPosition)){if(i.bWasUndone){var _i205=t.graveyardPosition.path.slice();return _i205.push(0),e.sourcePosition=new Zl(t.graveyardPosition.root,_i205),e.howMany=0,[e];}return[new zd(0)];}if(e.sourcePosition.isEqual(t.sourcePosition)&&!e.targetPosition.isEqual(t.targetPosition)&&!i.bWasUndone&&"splitAtSource"!=i.abRelation){var _n111="$graveyard"==e.targetPosition.root.rootName,_s73="$graveyard"==t.targetPosition.root.rootName;if(_s73&&!_n111||!(_n111&&!_s73)&&i.aIsStrong){var _i206=t.targetPosition._getTransformedByMergeOperation(t),_n112=e.targetPosition._getTransformedByMergeOperation(t);return[new Bd(_i206,e.howMany,_n112,0)];}return[new zd(0)];}return e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition=e.sourcePosition._getTransformedByMergeOperation(t),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),e.graveyardPosition.isEqual(t.graveyardPosition)&&i.aIsStrong||(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e];}),Gd(Fd,Bd,function(e,t,i){var n=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);return"remove"==t.type&&!i.bWasUndone&&e.deletionPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.sourcePosition)?[new zd(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(e.sourcePosition)?e.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(e.sourcePosition)&&"mergeSourceAffected"==i.abRelation?e.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(e.targetPosition)?(e.targetPosition.stickiness="toNone",e.howMany-=t.howMany):t.targetPosition.isEqual(e.targetPosition)&&"mergeTargetWasBefore"==i.abRelation?(e.targetPosition.stickiness="toPrevious",e.howMany+=t.howMany):(e.sourcePosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.sourcePosition.hasSameParentAs(t.sourcePosition)&&(e.howMany-=t.howMany)),e.sourcePosition=e.sourcePosition._getTransformedByMoveOperation(t),e.targetPosition=e.targetPosition._getTransformedByMoveOperation(t),e.sourcePosition.stickiness="toPrevious",e.targetPosition.stickiness="toNext",e.graveyardPosition.isEqual(t.targetPosition)||(e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t)),[e]);}),Gd(Fd,Ld,function(e,t,i){if(t.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),e.deletionPosition.isEqual(t.graveyardPosition)&&(e.howMany=t.howMany)),e.targetPosition.isEqual(t.splitPosition)){if(t.graveyardPosition&&e.deletionPosition.isEqual(t.graveyardPosition)||"mergeTargetNotMoved"==i.abRelation)return e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),[e];}if(e.sourcePosition.isEqual(t.splitPosition)){if("mergeSourceNotMoved"==i.abRelation)return e.howMany=0,e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];if("mergeSameElement"==i.abRelation||e.sourcePosition.offset>0)return e.sourcePosition=t.moveTargetPosition.clone(),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];}return e.sourcePosition.hasSameParentAs(t.splitPosition)&&(e.howMany=t.splitPosition.offset),e.sourcePosition=e.sourcePosition._getTransformedBySplitOperation(t),e.targetPosition=e.targetPosition._getTransformedBySplitOperation(t),[e];}),Gd(Bd,Md,function(e,t){var i=tc._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByInsertOperation(t,!1)[0];return e.sourcePosition=i.start,e.howMany=i.end.offset-i.start.offset,e.targetPosition.isEqual(t.position)||(e.targetPosition=e.targetPosition._getTransformedByInsertOperation(t)),[e];}),Gd(Bd,Bd,function(e,t,i){var n=tc._createFromPositionAndShift(e.sourcePosition,e.howMany),s=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);var o,r=i.aIsStrong,a=!i.aIsStrong;if("insertBefore"==i.abRelation||"insertAfter"==i.baRelation?a=!0:"insertAfter"!=i.abRelation&&"insertBefore"!=i.baRelation||(a=!1),o=e.targetPosition.isEqual(t.targetPosition)&&a?e.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):e.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),iu(e,t)&&iu(t,e))return[t.getReversed()];if(n.containsPosition(t.targetPosition)&&n.containsRange(s,!0))return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),nu([n],o);if(s.containsPosition(e.targetPosition)&&s.containsRange(n,!0))return n.start=n.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),n.end=n.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),nu([n],o);var l=so(e.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if("prefix"==l||"extension"==l)return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),nu([n],o);"remove"!=e.type||"remove"==t.type||i.aWasUndone||i.forceWeakRemove?"remove"==e.type||"remove"!=t.type||i.bWasUndone||i.forceWeakRemove||(r=!1):r=!0;var c=[],d=n.getDifference(s);var _iterator260=_createForOfIteratorHelper(d),_step260;try{for(_iterator260.s();!(_step260=_iterator260.n()).done;){var _e283=_step260.value;_e283.start=_e283.start._getTransformedByDeletion(t.sourcePosition,t.howMany),_e283.end=_e283.end._getTransformedByDeletion(t.sourcePosition,t.howMany);var _i207="same"==so(_e283.start.getParentPath(),t.getMovedRangeStart().getParentPath()),_n113=_e283._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,_i207);c.push.apply(c,_toConsumableArray(_n113));}}catch(err){_iterator260.e(err);}finally{_iterator260.f();}var u=n.getIntersection(s);return null!==u&&r&&(u.start=u.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),u.end=u.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),0===c.length?c.push(u):1==c.length?s.start.isBefore(n.start)||s.start.isEqual(n.start)?c.unshift(u):c.push(u):c.splice(1,0,u)),0===c.length?[new zd(e.baseVersion)]:nu(c,o);}),Gd(Bd,Ld,function(e,t,i){var n=e.targetPosition.clone();e.targetPosition.isEqual(t.insertionPosition)&&t.graveyardPosition&&"moveTargetAfter"!=i.abRelation||(n=e.targetPosition._getTransformedBySplitOperation(t));var s=tc._createFromPositionAndShift(e.sourcePosition,e.howMany);if(s.end.isEqual(t.insertionPosition))return t.graveyardPosition||e.howMany++,e.targetPosition=n,[e];if(s.start.hasSameParentAs(t.splitPosition)&&s.containsPosition(t.splitPosition)){var _e284=new tc(t.splitPosition,s.end);_e284=_e284._getTransformedBySplitOperation(t);return nu([new tc(s.start,t.splitPosition),_e284],n);}e.targetPosition.isEqual(t.splitPosition)&&"insertAtSource"==i.abRelation&&(n=t.moveTargetPosition),e.targetPosition.isEqual(t.insertionPosition)&&"insertBetween"==i.abRelation&&(n=e.targetPosition);var o=[s._getTransformedBySplitOperation(t)];if(t.graveyardPosition){var _n114=s.start.isEqual(t.graveyardPosition)||s.containsPosition(t.graveyardPosition);e.howMany>1&&_n114&&!i.aWasUndone&&o.push(tc._createFromPositionAndShift(t.insertionPosition,1));}return nu(o,n);}),Gd(Bd,Fd,function(e,t,i){var n=tc._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.sourcePosition))if("remove"!=e.type||i.forceWeakRemove){if(1==e.howMany)return i.bWasUndone?(e.sourcePosition=t.graveyardPosition.clone(),e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e]):[new zd(0)];}else if(!i.aWasUndone){var _i208=[];var _n115=t.graveyardPosition.clone(),_s74=t.targetPosition._getTransformedByMergeOperation(t);var _o36=e.targetPosition.getTransformedByOperation(t);e.howMany>1&&(_i208.push(new Bd(e.sourcePosition,e.howMany-1,_o36,0)),_n115=_n115._getTransformedByMove(e.sourcePosition,_o36,e.howMany-1),_s74=_s74._getTransformedByMove(e.sourcePosition,_o36,e.howMany-1));var _r23=t.deletionPosition._getCombined(e.sourcePosition,_o36),_a9=new Bd(_n115,1,_r23,0),_l8=_a9.getMovedRangeStart().path.slice();_l8.push(0);var _c7=new Zl(_a9.targetPosition.root,_l8);_s74=_s74._getTransformedByMove(_n115,_r23,1);var _d4=new Bd(_s74,t.howMany,_c7,0);return _i208.push(_a9),_i208.push(_d4),_i208;}var s=tc._createFromPositionAndShift(e.sourcePosition,e.howMany)._getTransformedByMergeOperation(t);return e.sourcePosition=s.start,e.howMany=s.end.offset-s.start.offset,e.targetPosition=e.targetPosition._getTransformedByMergeOperation(t),[e];}),Gd(Hd,Md,function(e,t){return e.position=e.position._getTransformedByInsertOperation(t),[e];}),Gd(Hd,Fd,function(e,t){return e.position.isEqual(t.deletionPosition)?(e.position=t.graveyardPosition.clone(),e.position.stickiness="toNext",[e]):(e.position=e.position._getTransformedByMergeOperation(t),[e]);}),Gd(Hd,Bd,function(e,t){return e.position=e.position._getTransformedByMoveOperation(t),[e];}),Gd(Hd,Hd,function(e,t,i){if(e.position.isEqual(t.position)){if(!i.aIsStrong)return[new zd(0)];e.oldName=t.newName;}return[e];}),Gd(Hd,Ld,function(e,t){if("same"==so(e.position.path,t.splitPosition.getParentPath())&&!t.graveyardPosition){var _t167=new Hd(e.position.getShiftedBy(1),e.oldName,e.newName,0);return[e,_t167];}return e.position=e.position._getTransformedBySplitOperation(t),[e];}),Gd($d,$d,function(e,t,i){if(e.root===t.root&&e.key===t.key){if(!i.aIsStrong||e.newValue===t.newValue)return[new zd(0)];e.oldValue=t.newValue;}return[e];}),Gd(Ud,Ud,function(e,t){return e.rootName===t.rootName&&e.isAdd===t.isAdd?[new zd(0)]:[e];}),Gd(Ld,Md,function(e,t){return e.splitPosition.hasSameParentAs(t.position)&&e.splitPosition.offset<t.position.offset&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByInsertOperation(t),e.insertionPosition=e.insertionPosition._getTransformedByInsertOperation(t),[e];}),Gd(Ld,Fd,function(e,t,i){if(!e.graveyardPosition&&!i.bWasUndone&&e.splitPosition.hasSameParentAs(t.sourcePosition)){var _i209=t.graveyardPosition.path.slice();_i209.push(0);var _n116=new Zl(t.graveyardPosition.root,_i209),_s75=Ld.getInsertionPosition(new Zl(t.graveyardPosition.root,_i209)),_o37=new Ld(_n116,0,_s75,null,0);return e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=Ld.getInsertionPosition(e.splitPosition),e.graveyardPosition=_o37.insertionPosition.clone(),e.graveyardPosition.stickiness="toNext",[_o37,e];}return e.splitPosition.hasSameParentAs(t.deletionPosition)&&!e.splitPosition.isAfter(t.deletionPosition)&&e.howMany--,e.splitPosition.hasSameParentAs(t.targetPosition)&&(e.howMany+=t.howMany),e.splitPosition=e.splitPosition._getTransformedByMergeOperation(t),e.insertionPosition=Ld.getInsertionPosition(e.splitPosition),e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedByMergeOperation(t)),[e];}),Gd(Ld,Bd,function(e,t,i){var n=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.graveyardPosition){var _s76=n.start.isEqual(e.graveyardPosition)||n.containsPosition(e.graveyardPosition);if(!i.bWasUndone&&_s76){var _i210=e.splitPosition._getTransformedByMoveOperation(t),_n117=e.graveyardPosition._getTransformedByMoveOperation(t),_s77=_n117.path.slice();_s77.push(0);var _o38=new Zl(_n117.root,_s77);return[new Bd(_i210,e.howMany,_o38,0)];}e.graveyardPosition=e.graveyardPosition._getTransformedByMoveOperation(t);}var s=e.splitPosition.isEqual(t.targetPosition);if(s&&("insertAtSource"==i.baRelation||"splitBefore"==i.abRelation))return e.howMany+=t.howMany,e.splitPosition=e.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),e.insertionPosition=Ld.getInsertionPosition(e.splitPosition),[e];if(s&&i.abRelation&&i.abRelation.howMany){var _i$abRelation=i.abRelation,_t168=_i$abRelation.howMany,_n118=_i$abRelation.offset;return e.howMany+=_t168,e.splitPosition=e.splitPosition.getShiftedBy(_n118),[e];}if(e.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.splitPosition)){var _i211=t.howMany-(e.splitPosition.offset-t.sourcePosition.offset);return e.howMany-=_i211,e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany),e.splitPosition=t.sourcePosition.clone(),e.insertionPosition=Ld.getInsertionPosition(e.splitPosition),[e];}return t.sourcePosition.isEqual(t.targetPosition)||(e.splitPosition.hasSameParentAs(t.sourcePosition)&&e.splitPosition.offset<=t.sourcePosition.offset&&(e.howMany-=t.howMany),e.splitPosition.hasSameParentAs(t.targetPosition)&&e.splitPosition.offset<t.targetPosition.offset&&(e.howMany+=t.howMany)),e.splitPosition.stickiness="toNone",e.splitPosition=e.splitPosition._getTransformedByMoveOperation(t),e.splitPosition.stickiness="toNext",e.graveyardPosition?e.insertionPosition=e.insertionPosition._getTransformedByMoveOperation(t):e.insertionPosition=Ld.getInsertionPosition(e.splitPosition),[e];}),Gd(Ld,Ld,function(e,t,i){if(e.splitPosition.isEqual(t.splitPosition)){if(!e.graveyardPosition&&!t.graveyardPosition)return[new zd(0)];if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition))return[new zd(0)];if("splitBefore"==i.abRelation)return e.howMany=0,e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t),[e];}if(e.graveyardPosition&&t.graveyardPosition&&e.graveyardPosition.isEqual(t.graveyardPosition)){var _n119="$graveyard"==e.splitPosition.root.rootName,_s78="$graveyard"==t.splitPosition.root.rootName;if(_s78&&!_n119||!(_n119&&!_s78)&&i.aIsStrong){var _i212=[];return t.howMany&&_i212.push(new Bd(t.moveTargetPosition,t.howMany,t.splitPosition,0)),e.howMany&&_i212.push(new Bd(e.splitPosition,e.howMany,e.moveTargetPosition,0)),_i212;}return[new zd(0)];}if(e.graveyardPosition&&(e.graveyardPosition=e.graveyardPosition._getTransformedBySplitOperation(t)),e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==i.abRelation)return e.howMany++,[e];if(t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==i.baRelation){var _i213=t.insertionPosition.path.slice();_i213.push(0);var _n120=new Zl(t.insertionPosition.root,_i213);return[e,new Bd(e.insertionPosition,1,_n120,0)];}return e.splitPosition.hasSameParentAs(t.splitPosition)&&e.splitPosition.offset<t.splitPosition.offset&&(e.howMany-=t.howMany),e.splitPosition=e.splitPosition._getTransformedBySplitOperation(t),e.insertionPosition=Ld.getInsertionPosition(e.splitPosition),[e];});var su=/*#__PURE__*/function(_L16){function su(e,t){var _this110;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"toNone";_classCallCheck(this,su);if(_this110=_callSuper(this,su,[e,t,i]),!_this110.root.is("rootElement"))throw new A("model-liveposition-root-not-rootelement",e);ou.call(_this110);return _this110;}_inherits(su,_L16);return _createClass(su,[{key:"detach",value:function detach(){this.stopListening();}},{key:"toPosition",value:function toPosition(){return new Zl(this.root,this.path.slice(),this.stickiness);}}],[{key:"fromPosition",value:function fromPosition(e,t){return new this(e.root,e.path.slice(),t||e.stickiness);}}]);}(L(Zl));function ou(){var _this111=this;this.listenTo(this.root.document.model,"applyOperation",function(e,t){var i=t[0];i.isDocumentOperation&&ru.call(_this111,i);},{priority:"low"});}function ru(e){var t=this.getTransformedByOperation(e);if(!this.isEqual(t)){var _e285=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",_e285);}}su.prototype.is=function(e){return"livePosition"===e||"model:livePosition"===e||"position"==e||"model:position"===e;};var au=/*#__PURE__*/function(){function au(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,au);_defineProperty(this,"operations",void 0);_defineProperty(this,"isUndoable",void 0);_defineProperty(this,"isLocal",void 0);_defineProperty(this,"isUndo",void 0);_defineProperty(this,"isTyping",void 0);"string"==typeof e&&(e="transparent"===e?{isUndoable:!1}:{},E("batch-constructor-deprecated-string-type"));var _e286=e,_e286$isUndoable=_e286.isUndoable,t=_e286$isUndoable===void 0?!0:_e286$isUndoable,_e286$isLocal=_e286.isLocal,i=_e286$isLocal===void 0?!0:_e286$isLocal,_e286$isUndo=_e286.isUndo,n=_e286$isUndo===void 0?!1:_e286$isUndo,_e286$isTyping=_e286.isTyping,s=_e286$isTyping===void 0?!1:_e286$isTyping;this.operations=[],this.isUndoable=t,this.isLocal=i,this.isUndo=n,this.isTyping=s;}return _createClass(au,[{key:"type",get:function get(){return E("batch-type-deprecated"),"default";}},{key:"baseVersion",get:function get(){var _iterator261=_createForOfIteratorHelper(this.operations),_step261;try{for(_iterator261.s();!(_step261=_iterator261.n()).done;){var _e287=_step261.value;if(null!==_e287.baseVersion)return _e287.baseVersion;}}catch(err){_iterator261.e(err);}finally{_iterator261.f();}return null;}},{key:"addOperation",value:function addOperation(e){return e.batch=this,this.operations.push(e),e;}}]);}();var lu=/*#__PURE__*/function(){function lu(e){_classCallCheck(this,lu);_defineProperty(this,"_markerCollection",void 0);_defineProperty(this,"_changesInElement",new Map());_defineProperty(this,"_elementsSnapshots",new Map());_defineProperty(this,"_elementChildrenSnapshots",new Map());_defineProperty(this,"_elementState",new Map());_defineProperty(this,"_changedMarkers",new Map());_defineProperty(this,"_changedRoots",new Map());_defineProperty(this,"_changeCount",0);_defineProperty(this,"_cachedChanges",null);_defineProperty(this,"_cachedChangesWithGraveyard",null);_defineProperty(this,"_refreshedItems",new Set());this._markerCollection=e;}return _createClass(lu,[{key:"isEmpty",get:function get(){return 0==this._changesInElement.size&&0==this._changedMarkers.size&&0==this._changedRoots.size;}},{key:"bufferOperation",value:function bufferOperation(e){var t=e;switch(t.type){case"insert":if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":var _iterator262=_createForOfIteratorHelper(t.range.getItems({shallow:!0})),_step262;try{for(_iterator262.s();!(_step262=_iterator262.n()).done;){var _e288=_step262.value;this._isInInsertedElement(_e288.parent)||this._markAttribute(_e288);}}catch(err){_iterator262.e(err);}finally{_iterator262.f();}break;case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;var _e289=this._isInInsertedElement(t.sourcePosition.parent),_i214=this._isInInsertedElement(t.targetPosition.parent);_e289||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),_i214||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);var _n121=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);var _iterator263=_createForOfIteratorHelper(_n121.getItems({shallow:!0})),_step263;try{for(_iterator263.s();!(_step263=_iterator263.n()).done;){var _e290=_step263.value;this._setElementState(_e290,"move");}}catch(err){_iterator263.e(err);}finally{_iterator263.f();}break;}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);var _e291=tc._createFromPositionAndShift(t.position,1);var _iterator264=_createForOfIteratorHelper(this._markerCollection.getMarkersIntersectingRange(_e291)),_step264;try{for(_iterator264.s();!(_step264=_iterator264.n()).done;){var _t169=_step264.value;var _e292=_t169.getData();this.bufferMarkerChange(_t169.name,_e292,_e292);}}catch(err){_iterator264.e(err);}finally{_iterator264.f();}this._setElementState(t.position.nodeAfter,"rename");break;}case"split":{var _e293=t.splitPosition.parent;if(!this._isInInsertedElement(_e293)){this._markRemove(_e293,t.splitPosition.offset,t.howMany);var _i215=tc._createFromPositionAndShift(t.splitPosition,t.howMany);var _iterator265=_createForOfIteratorHelper(_i215.getItems({shallow:!0})),_step265;try{for(_iterator265.s();!(_step265=_iterator265.n()).done;){var _e294=_step265.value;this._setElementState(_e294,"move");}}catch(err){_iterator265.e(err);}finally{_iterator265.f();}}this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&(this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1),this._setElementState(t.graveyardPosition.nodeAfter,"move"));break;}case"merge":{var _e295=t.sourcePosition.parent;this._isInInsertedElement(_e295.parent)||this._markRemove(_e295.parent,_e295.startOffset,1);var _i216=t.graveyardPosition.parent;this._markInsert(_i216,t.graveyardPosition.offset,1),this._setElementState(_e295,"move");var _n122=t.targetPosition.parent;if(!this._isInInsertedElement(_n122)){this._markInsert(_n122,t.targetPosition.offset,_e295.maxOffset);var _i217=tc._createFromPositionAndShift(t.sourcePosition,t.howMany);var _iterator266=_createForOfIteratorHelper(_i217.getItems({shallow:!0})),_step266;try{for(_iterator266.s();!(_step266=_iterator266.n()).done;){var _e296=_step266.value;this._setElementState(_e296,"move");}}catch(err){_iterator266.e(err);}finally{_iterator266.f();}}break;}case"detachRoot":case"addRoot":{var _e297=t.affectedSelectable;if(!_e297._isLoaded)return;if(_e297.isAttached()==t.isAdd)return;this._bufferRootStateChange(t.rootName,t.isAdd);break;}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!t.root._isLoaded)return;var _e298=t.root.rootName;this._bufferRootAttributeChange(_e298,t.key,t.oldValue,t.newValue);break;}}this._cachedChanges=null;}},{key:"bufferMarkerChange",value:function bufferMarkerChange(e,t,i){t.range&&t.range.root.is("rootElement")&&!t.range.root._isLoaded&&(t.range=null),i.range&&i.range.root.is("rootElement")&&!i.range.root._isLoaded&&(i.range=null);var n=this._changedMarkers.get(e);n?n.newMarkerData=i:(n={newMarkerData:i,oldMarkerData:t},this._changedMarkers.set(e,n)),null==n.oldMarkerData.range&&null==i.range&&this._changedMarkers["delete"](e);}},{key:"getMarkersToRemove",value:function getMarkersToRemove(){var e=[];var _iterator267=_createForOfIteratorHelper(this._changedMarkers),_step267;try{for(_iterator267.s();!(_step267=_iterator267.n()).done;){var _step267$value=_slicedToArray(_step267.value,2),_t170=_step267$value[0],_i218=_step267$value[1];null!=_i218.oldMarkerData.range&&e.push({name:_t170,range:_i218.oldMarkerData.range});}}catch(err){_iterator267.e(err);}finally{_iterator267.f();}return e;}},{key:"getMarkersToAdd",value:function getMarkersToAdd(){var e=[];var _iterator268=_createForOfIteratorHelper(this._changedMarkers),_step268;try{for(_iterator268.s();!(_step268=_iterator268.n()).done;){var _step268$value=_slicedToArray(_step268.value,2),_t171=_step268$value[0],_i219=_step268$value[1];null!=_i219.newMarkerData.range&&e.push({name:_t171,range:_i219.newMarkerData.range});}}catch(err){_iterator268.e(err);}finally{_iterator268.f();}return e;}},{key:"getChangedMarkers",value:function getChangedMarkers(){return Array.from(this._changedMarkers).map(function(_ref35){var _ref36=_slicedToArray(_ref35,2),e=_ref36[0],t=_ref36[1];return{name:e,data:{oldRange:t.oldMarkerData.range,newRange:t.newMarkerData.range}};});}},{key:"hasDataChanges",value:function hasDataChanges(){if(this.getChanges().length)return!0;if(this._changedRoots.size>0)return!0;var _iterator269=_createForOfIteratorHelper(this._changedMarkers.values()),_step269;try{for(_iterator269.s();!(_step269=_iterator269.n()).done;){var _step269$value=_step269.value,_e299=_step269$value.newMarkerData,_t172=_step269$value.oldMarkerData;if(_e299.affectsData!==_t172.affectsData)return!0;if(_e299.affectsData){var _i220=_e299.range&&!_t172.range,_n123=!_e299.range&&_t172.range,_s79=_e299.range&&_t172.range&&!_e299.range.isEqual(_t172.range);if(_i220||_n123||_s79)return!0;}}}catch(err){_iterator269.e(err);}finally{_iterator269.f();}return!1;}},{key:"getChanges",value:function getChanges(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(this._cachedChanges)return e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();var t=[];var _iterator270=_createForOfIteratorHelper(this._changesInElement.keys()),_step270;try{for(_iterator270.s();!(_step270=_iterator270.n()).done;){var _e301=_step270.value;var _i222=this._changesInElement.get(_e301).sort(function(e,t){return e.offset===t.offset?e.type!=t.type?"remove"==e.type?-1:1:0:e.offset<t.offset?-1:1;}),_n125=this._elementChildrenSnapshots.get(_e301),_s81=du(_e301.getChildren()),_o40=uu(_n125.length,_i222);var _r25=0,_a11=0;var _iterator272=_createForOfIteratorHelper(_o40),_step272;try{for(_iterator272.s();!(_step272=_iterator272.n()).done;){var _i223=_step272.value;if("i"===_i223){var _i224=this._getDiffActionForNode(_s81[_r25].node,"insert"),_n126=this._elementsSnapshots.get(_s81[_r25].node),_o41=this._getInsertDiff(_e301,_r25,_i224,_s81[_r25],_n126);t.push(_o41),_r25++;}else if("r"===_i223){var _i225=this._getDiffActionForNode(_n125[_a11].node,"remove"),_s82=this._getRemoveDiff(_e301,_r25,_i225,_n125[_a11]);t.push(_s82),_a11++;}else if("a"===_i223){var _t174;var _i226=_n125[_a11].attributes,_o42=_s81[_r25].attributes;var _l9=void 0;if("$text"==_s81[_r25].name)_l9=new tc(Zl._createAt(_e301,_r25),Zl._createAt(_e301,_r25+1));else{var _t173=_e301.offsetToIndex(_r25);_l9=new tc(Zl._createAt(_e301,_r25),Zl._createAt(_e301.getChild(_t173),0));}var _c8=this._getAttributesDiff(_l9,_i226,_o42);(_t174=t).push.apply(_t174,_toConsumableArray(_c8)),_r25++,_a11++;}else _r25++,_a11++;}}catch(err){_iterator272.e(err);}finally{_iterator272.f();}}}catch(err){_iterator270.e(err);}finally{_iterator270.f();}t.sort(function(e,t){return e.position.root!=t.position.root?e.position.root.rootName<t.position.root.rootName?-1:1:e.position.isEqual(t.position)?e.changeCount-t.changeCount:e.position.isBefore(t.position)?-1:1;});for(var _e300=1,_i221=0;_e300<t.length;_e300++){var _n124=t[_i221],_s80=t[_e300],_o39="remove"==_n124.type&&"remove"==_s80.type&&"$text"==_n124.name&&"$text"==_s80.name&&_n124.position.isEqual(_s80.position),_r24="insert"==_n124.type&&"insert"==_s80.type&&"$text"==_n124.name&&"$text"==_s80.name&&_n124.position.parent==_s80.position.parent&&_n124.position.offset+_n124.length==_s80.position.offset,_a10="attribute"==_n124.type&&"attribute"==_s80.type&&_n124.position.parent==_s80.position.parent&&_n124.range.isFlat&&_s80.range.isFlat&&_n124.position.offset+_n124.length==_s80.position.offset&&_n124.attributeKey==_s80.attributeKey&&_n124.attributeOldValue==_s80.attributeOldValue&&_n124.attributeNewValue==_s80.attributeNewValue;_o39||_r24||_a10?(_n124.length++,_a10&&(_n124.range.end=_n124.range.end.getShiftedBy(1)),t[_e300]=null):_i221=_e300;}t=t.filter(function(e){return e;});var _iterator271=_createForOfIteratorHelper(t),_step271;try{for(_iterator271.s();!(_step271=_iterator271.n()).done;){var _e302=_step271.value;delete _e302.changeCount,"attribute"==_e302.type&&(delete _e302.position,delete _e302.length);}}catch(err){_iterator271.e(err);}finally{_iterator271.f();}return this._changeCount=0,this._cachedChangesWithGraveyard=t,this._cachedChanges=t.filter(hu),e.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();}},{key:"getChangedRoots",value:function getChangedRoots(){return Array.from(this._changedRoots.values()).map(function(e){var t=_objectSpread({},e);return void 0!==t.state&&delete t.attributes,t;});}},{key:"getRefreshedItems",value:function getRefreshedItems(){return new Set(this._refreshedItems);}},{key:"reset",value:function reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null;}},{key:"_refreshItem",value:function _refreshItem(e){if(this._isInInsertedElement(e.parent))return;this._markRemove(e.parent,e.startOffset,e.offsetSize),this._markInsert(e.parent,e.startOffset,e.offsetSize),this._refreshedItems.add(e),this._setElementState(e,"refresh");var t=tc._createOn(e);var _iterator273=_createForOfIteratorHelper(this._markerCollection.getMarkersIntersectingRange(t)),_step273;try{for(_iterator273.s();!(_step273=_iterator273.n()).done;){var _e303=_step273.value;var _t175=_e303.getData();this.bufferMarkerChange(_e303.name,_t175,_t175);}}catch(err){_iterator273.e(err);}finally{_iterator273.f();}this._cachedChanges=null;}},{key:"_bufferRootLoad",value:function _bufferRootLoad(e){if(e.isAttached()){this._bufferRootStateChange(e.rootName,!0),this._markInsert(e,0,e.maxOffset);var _iterator274=_createForOfIteratorHelper(e.getAttributeKeys()),_step274;try{for(_iterator274.s();!(_step274=_iterator274.n()).done;){var _t176=_step274.value;this._bufferRootAttributeChange(e.rootName,_t176,null,e.getAttribute(_t176));}}catch(err){_iterator274.e(err);}finally{_iterator274.f();}var _iterator275=_createForOfIteratorHelper(this._markerCollection),_step275;try{for(_iterator275.s();!(_step275=_iterator275.n()).done;){var _t177=_step275.value;if(_t177.getRange().root==e){var _e304=_t177.getData();this.bufferMarkerChange(_t177.name,_objectSpread(_objectSpread({},_e304),{},{range:null}),_e304);}}}catch(err){_iterator275.e(err);}finally{_iterator275.f();}}}},{key:"_bufferRootStateChange",value:function _bufferRootStateChange(e,t){if(!this._changedRoots.has(e))return void this._changedRoots.set(e,{name:e,state:t?"attached":"detached"});var i=this._changedRoots.get(e);void 0!==i.state?(delete i.state,void 0===i.attributes&&this._changedRoots["delete"](e)):i.state=t?"attached":"detached";}},{key:"_bufferRootAttributeChange",value:function _bufferRootAttributeChange(e,t,i,n){var s=this._changedRoots.get(e)||{name:e},o=s.attributes||{};if(o[t]){var _e305=o[t];n===_e305.oldValue?delete o[t]:_e305.newValue=n;}else o[t]={oldValue:i,newValue:n};0===Object.entries(o).length?(delete s.attributes,void 0===s.state&&this._changedRoots["delete"](e)):(s.attributes=o,this._changedRoots.set(e,s));}},{key:"_markInsert",value:function _markInsert(e,t,i){if(e.root.is("rootElement")&&!e.root._isLoaded)return;var n={type:"insert",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,n);}},{key:"_markRemove",value:function _markRemove(e,t,i){if(e.root.is("rootElement")&&!e.root._isLoaded)return;var n={type:"remove",offset:t,howMany:i,count:this._changeCount++};this._markChange(e,n),this._removeAllNestedChanges(e,t,i);}},{key:"_markAttribute",value:function _markAttribute(e){if(e.root.is("rootElement")&&!e.root._isLoaded)return;var t={type:"attribute",offset:e.startOffset,howMany:e.offsetSize,count:this._changeCount++};this._markChange(e.parent,t);}},{key:"_markChange",value:function _markChange(e,t){this._makeSnapshots(e);var i=this._getChangesForElement(e);this._handleChange(t,i),i.push(t);for(var _e306=0;_e306<i.length;_e306++)i[_e306].howMany<1&&(i.splice(_e306,1),_e306--);}},{key:"_setElementState",value:function _setElementState(e,t){if(!e.is("element"))return;var i=lu._statesPriority.indexOf(this._elementState.get(e));lu._statesPriority.indexOf(t)>i&&this._elementState.set(e,t);}},{key:"_getDiffActionForNode",value:function _getDiffActionForNode(e,t){if(!e.is("element"))return t;if(!this._elementsSnapshots.has(e))return t;var i=this._elementState.get(e);return i&&"move"!=i?i:t;}},{key:"_getChangesForElement",value:function _getChangesForElement(e){var t;return this._changesInElement.has(e)?t=this._changesInElement.get(e):(t=[],this._changesInElement.set(e,t)),t;}},{key:"_makeSnapshots",value:function _makeSnapshots(e){if(this._elementChildrenSnapshots.has(e))return;var t=du(e.getChildren());this._elementChildrenSnapshots.set(e,t);var _iterator276=_createForOfIteratorHelper(t),_step276;try{for(_iterator276.s();!(_step276=_iterator276.n()).done;){var _e307=_step276.value;this._elementsSnapshots.set(_e307.node,_e307);}}catch(err){_iterator276.e(err);}finally{_iterator276.f();}}},{key:"_handleChange",value:function _handleChange(e,t){e.nodesToHandle=e.howMany;var _iterator277=_createForOfIteratorHelper(t),_step277;try{for(_iterator277.s();!(_step277=_iterator277.n()).done;){var _i227=_step277.value;var _n127=e.offset+e.howMany,_s83=_i227.offset+_i227.howMany;if("insert"==e.type&&("insert"==_i227.type&&(e.offset<=_i227.offset?_i227.offset+=e.howMany:e.offset<_s83&&(_i227.howMany+=e.nodesToHandle,e.nodesToHandle=0)),"remove"==_i227.type&&e.offset<_i227.offset&&(_i227.offset+=e.howMany),"attribute"==_i227.type))if(e.offset<=_i227.offset)_i227.offset+=e.howMany;else if(e.offset<_s83){var _s84=_i227.howMany;_i227.howMany=e.offset-_i227.offset,t.unshift({type:"attribute",offset:_n127,howMany:_s84-_i227.howMany,count:this._changeCount++});}if("remove"==e.type){if("insert"==_i227.type)if(_n127<=_i227.offset)_i227.offset-=e.howMany;else if(_n127<=_s83){if(e.offset<_i227.offset){var _t178=_n127-_i227.offset;_i227.offset=e.offset,_i227.howMany-=_t178,e.nodesToHandle-=_t178;}else _i227.howMany-=e.nodesToHandle,e.nodesToHandle=0;}else if(e.offset<=_i227.offset)e.nodesToHandle-=_i227.howMany,_i227.howMany=0;else if(e.offset<_s83){var _t179=_s83-e.offset;_i227.howMany-=_t179,e.nodesToHandle-=_t179;}if("remove"==_i227.type&&(_n127<=_i227.offset?_i227.offset-=e.howMany:e.offset<_i227.offset&&(e.nodesToHandle+=_i227.howMany,_i227.howMany=0)),"attribute"==_i227.type)if(_n127<=_i227.offset)_i227.offset-=e.howMany;else if(e.offset<_i227.offset){var _t180=_n127-_i227.offset;_i227.offset=e.offset,_i227.howMany-=_t180;}else if(e.offset<_s83)if(_n127<=_s83){var _n128=_i227.howMany;_i227.howMany=e.offset-_i227.offset;var _s85=_n128-_i227.howMany-e.nodesToHandle;t.unshift({type:"attribute",offset:e.offset,howMany:_s85,count:this._changeCount++});}else _i227.howMany-=_s83-e.offset;}if("attribute"==e.type){if("insert"==_i227.type)if(e.offset<_i227.offset&&_n127>_i227.offset){if(_n127>_s83){var _e308={type:"attribute",offset:_s83,howMany:_n127-_s83,count:this._changeCount++};this._handleChange(_e308,t),t.push(_e308);}e.nodesToHandle=_i227.offset-e.offset,e.howMany=e.nodesToHandle;}else e.offset>=_i227.offset&&e.offset<_s83&&(_n127>_s83?(e.nodesToHandle=_n127-_s83,e.offset=_s83):e.nodesToHandle=0);if("remove"==_i227.type&&e.offset<_i227.offset&&_n127>_i227.offset){var _s86={type:"attribute",offset:_i227.offset,howMany:_n127-_i227.offset,count:this._changeCount++};this._handleChange(_s86,t),t.push(_s86),e.nodesToHandle=_i227.offset-e.offset,e.howMany=e.nodesToHandle;}"attribute"==_i227.type&&(e.offset>=_i227.offset&&_n127<=_s83?(e.nodesToHandle=0,e.howMany=0,e.offset=0):e.offset<=_i227.offset&&_n127>=_s83&&(_i227.howMany=0));}}}catch(err){_iterator277.e(err);}finally{_iterator277.f();}e.howMany=e.nodesToHandle,delete e.nodesToHandle;}},{key:"_getInsertDiff",value:function _getInsertDiff(e,t,i,n,s){var o={type:"insert",position:Zl._createAt(e,t),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++,action:i};return"insert"!=i&&s&&(o.before={name:s.name,attributes:new Map(s.attributes)}),o;}},{key:"_getRemoveDiff",value:function _getRemoveDiff(e,t,i,n){return{type:"remove",action:i,position:Zl._createAt(e,t),name:n.name,attributes:new Map(n.attributes),length:1,changeCount:this._changeCount++};}},{key:"_getAttributesDiff",value:function _getAttributesDiff(e,t,i){var n=[];i=new Map(i);var _iterator278=_createForOfIteratorHelper(t),_step278;try{for(_iterator278.s();!(_step278=_iterator278.n()).done;){var _step278$value=_slicedToArray(_step278.value,2),_s87=_step278$value[0],_o43=_step278$value[1];var _t181=i.has(_s87)?i.get(_s87):null;_t181!==_o43&&n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:_s87,attributeOldValue:_o43,attributeNewValue:_t181,changeCount:this._changeCount++}),i["delete"](_s87);}}catch(err){_iterator278.e(err);}finally{_iterator278.f();}var _iterator279=_createForOfIteratorHelper(i),_step279;try{for(_iterator279.s();!(_step279=_iterator279.n()).done;){var _step279$value=_slicedToArray(_step279.value,2),_t182=_step279$value[0],_s88=_step279$value[1];n.push({type:"attribute",position:e.start,range:e.clone(),length:1,attributeKey:_t182,attributeOldValue:null,attributeNewValue:_s88,changeCount:this._changeCount++});}}catch(err){_iterator279.e(err);}finally{_iterator279.f();}return n;}},{key:"_isInInsertedElement",value:function _isInInsertedElement(e){var t=e.parent;if(!t)return!1;var i=this._changesInElement.get(t),n=e.startOffset;if(i){var _iterator280=_createForOfIteratorHelper(i),_step280;try{for(_iterator280.s();!(_step280=_iterator280.n()).done;){var _e309=_step280.value;if("insert"==_e309.type&&n>=_e309.offset&&n<_e309.offset+_e309.howMany)return!0;}}catch(err){_iterator280.e(err);}finally{_iterator280.f();}}return this._isInInsertedElement(t);}},{key:"_removeAllNestedChanges",value:function _removeAllNestedChanges(e,t,i){var n=new tc(Zl._createAt(e,t),Zl._createAt(e,t+i));var _iterator281=_createForOfIteratorHelper(n.getItems({shallow:!0})),_step281;try{for(_iterator281.s();!(_step281=_iterator281.n()).done;){var _e310=_step281.value;_e310.is("element")&&(this._changesInElement["delete"](_e310),this._removeAllNestedChanges(_e310,0,_e310.maxOffset));}}catch(err){_iterator281.e(err);}finally{_iterator281.f();}}}]);}();_defineProperty(lu,"_statesPriority",[void 0,"refresh","rename","move"]);function cu(e){return{node:e,name:e.is("$text")?"$text":e.name,attributes:new Map(e.getAttributes())};}function du(e){var t=[];var _iterator282=_createForOfIteratorHelper(e),_step282;try{for(_iterator282.s();!(_step282=_iterator282.n()).done;){var _i228=_step282.value;if(_i228.is("$text"))for(var _e311=0;_e311<_i228.data.length;++_e311)t.push(cu(_i228));else t.push(cu(_i228));}}catch(err){_iterator282.e(err);}finally{_iterator282.f();}return t;}function uu(e,t){var i=[];var n=0,s=0;var _iterator283=_createForOfIteratorHelper(t),_step283;try{for(_iterator283.s();!(_step283=_iterator283.n()).done;){var _e312=_step283.value;if(_e312.offset>n){for(var _t184=0;_t184<_e312.offset-n;_t184++)i.push("e");s+=_e312.offset-n;}if("insert"==_e312.type){for(var _t185=0;_t185<_e312.howMany;_t185++)i.push("i");n=_e312.offset+_e312.howMany;}else if("remove"==_e312.type){for(var _t186=0;_t186<_e312.howMany;_t186++)i.push("r");n=_e312.offset,s+=_e312.howMany;}else{if(_e312.howMany>1500)for(var _t187=0;_t187<_e312.howMany;_t187++)i.push("a");else i.push.apply(i,_toConsumableArray("a".repeat(_e312.howMany).split("")));n=_e312.offset+_e312.howMany,s+=_e312.howMany;}}}catch(err){_iterator283.e(err);}finally{_iterator283.f();}if(s<e)for(var _t183=0;_t183<e-s-n;_t183++)i.push("e");return i;}function hu(e){var t="position"in e&&"$graveyard"==e.position.root.rootName,i="range"in e&&"$graveyard"==e.range.root.rootName;return!t&&!i;}var mu=/*#__PURE__*/function(){function mu(){_classCallCheck(this,mu);_defineProperty(this,"_operations",[]);_defineProperty(this,"_undoPairs",new Map());_defineProperty(this,"_undoneOperations",new Set());_defineProperty(this,"_baseVersionToOperationIndex",new Map());_defineProperty(this,"_version",0);_defineProperty(this,"_gaps",new Map());}return _createClass(mu,[{key:"version",get:function get(){return this._version;},set:function set(e){this._operations.length&&e>this._version+1&&this._gaps.set(this._version,e),this._version=e;}},{key:"lastOperation",get:function get(){return this._operations[this._operations.length-1];}},{key:"addOperation",value:function addOperation(e){if(e.baseVersion!==this.version)throw new A("model-document-history-addoperation-incorrect-version",this,{operation:e,historyVersion:this.version});this._operations.push(e),this._version++,this._baseVersionToOperationIndex.set(e.baseVersion,this._operations.length-1);}},{key:"getOperations",value:function getOperations(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.version;if(!this._operations.length)return[];var i=this._operations[0];void 0===e&&(e=i.baseVersion);var n=t-1;var _iterator284=_createForOfIteratorHelper(this._gaps),_step284;try{for(_iterator284.s();!(_step284=_iterator284.n()).done;){var _step284$value=_slicedToArray(_step284.value,2),_t188=_step284$value[0],_i229=_step284$value[1];e>_t188&&e<_i229&&(e=_i229),n>_t188&&n<_i229&&(n=_t188-1);}}catch(err){_iterator284.e(err);}finally{_iterator284.f();}if(n<i.baseVersion||e>this.lastOperation.baseVersion)return[];var s=this._baseVersionToOperationIndex.get(e);void 0===s&&(s=0);var o=this._baseVersionToOperationIndex.get(n);return void 0===o&&(o=this._operations.length-1),this._operations.slice(s,o+1);}},{key:"getOperation",value:function getOperation(e){var t=this._baseVersionToOperationIndex.get(e);if(void 0!==t)return this._operations[t];}},{key:"setOperationAsUndone",value:function setOperationAsUndone(e,t){this._undoPairs.set(t,e),this._undoneOperations.add(e);}},{key:"isUndoingOperation",value:function isUndoingOperation(e){return this._undoPairs.has(e);}},{key:"isUndoneOperation",value:function isUndoneOperation(e){return this._undoneOperations.has(e);}},{key:"getUndoneOperation",value:function getUndoneOperation(e){return this._undoPairs.get(e);}},{key:"reset",value:function reset(){this._version=0,this._undoPairs=new Map(),this._operations=[],this._undoneOperations=new Set(),this._gaps=new Map(),this._baseVersionToOperationIndex=new Map();}}]);}();var gu=/*#__PURE__*/function(_ql2){function gu(e,t){var _this112;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"main";_classCallCheck(this,gu);_this112=_callSuper(this,gu,[t]),_defineProperty(_assertThisInitialized(_this112),"rootName",void 0),_defineProperty(_assertThisInitialized(_this112),"_document",void 0),_defineProperty(_assertThisInitialized(_this112),"_isAttached",!0),_defineProperty(_assertThisInitialized(_this112),"_isLoaded",!0),_this112._document=e,_this112.rootName=i;return _this112;}_inherits(gu,_ql2);return _createClass(gu,[{key:"document",get:function get(){return this._document;}},{key:"isAttached",value:function isAttached(){return this._isAttached;}},{key:"toJSON",value:function toJSON(){return this.rootName;}}]);}(ql);gu.prototype.is=function(e,t){return t?t===this.name&&("rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e):"rootElement"===e||"model:rootElement"===e||"element"===e||"model:element"===e||"node"===e||"model:node"===e;};var fu="$graveyard";var pu=/*#__PURE__*/function(_L17){function pu(e){var _this113;_classCallCheck(this,pu);_this113=_callSuper(this,pu),_defineProperty(_assertThisInitialized(_this113),"model",void 0),_defineProperty(_assertThisInitialized(_this113),"history",void 0),_defineProperty(_assertThisInitialized(_this113),"selection",void 0),_defineProperty(_assertThisInitialized(_this113),"roots",void 0),_defineProperty(_assertThisInitialized(_this113),"differ",void 0),_defineProperty(_assertThisInitialized(_this113),"isReadOnly",void 0),_defineProperty(_assertThisInitialized(_this113),"_postFixers",void 0),_defineProperty(_assertThisInitialized(_this113),"_hasSelectionChangedFromTheLastChangeBlock",void 0),_this113.model=e,_this113.history=new mu(),_this113.selection=new _c(_assertThisInitialized(_this113)),_this113.roots=new br({idProperty:"rootName"}),_this113.differ=new lu(e.markers),_this113.isReadOnly=!1,_this113._postFixers=new Set(),_this113._hasSelectionChangedFromTheLastChangeBlock=!1,_this113.createRoot("$root",fu),_this113.listenTo(e,"applyOperation",function(e,t){var i=t[0];i.isDocumentOperation&&_this113.differ.bufferOperation(i);},{priority:"high"}),_this113.listenTo(e,"applyOperation",function(e,t){var i=t[0];i.isDocumentOperation&&_this113.history.addOperation(i);},{priority:"low"}),_this113.listenTo(_this113.selection,"change",function(){_this113._hasSelectionChangedFromTheLastChangeBlock=!0;}),_this113.listenTo(e.markers,"update",function(e,t,i,n,s){var o=_objectSpread(_objectSpread({},t.getData()),{},{range:n});_this113.differ.bufferMarkerChange(t.name,s,o),null===i&&t.on("change",function(e,i){var n=t.getData();_this113.differ.bufferMarkerChange(t.name,_objectSpread(_objectSpread({},n),{},{range:i}),n);});}),_this113.registerPostFixer(function(e){var t=!1;var _iterator285=_createForOfIteratorHelper(_this113.roots),_step285;try{for(_iterator285.s();!(_step285=_iterator285.n()).done;){var _i230=_step285.value;_i230.isAttached()||_i230.isEmpty||(e.remove(e.createRangeIn(_i230)),t=!0);}}catch(err){_iterator285.e(err);}finally{_iterator285.f();}var _iterator286=_createForOfIteratorHelper(_this113.model.markers),_step286;try{for(_iterator286.s();!(_step286=_iterator286.n()).done;){var _i231=_step286.value;_i231.getRange().root.isAttached()||(e.removeMarker(_i231),t=!0);}}catch(err){_iterator286.e(err);}finally{_iterator286.f();}return t;});return _this113;}_inherits(pu,_L17);return _createClass(pu,[{key:"version",get:function get(){return this.history.version;},set:function set(e){this.history.version=e;}},{key:"graveyard",get:function get(){return this.getRoot(fu);}},{key:"createRoot",value:function createRoot(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"$root";var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"main";if(this.roots.get(t))throw new A("model-document-createroot-name-exists",this,{name:t});var i=new gu(this,e,t);return this.roots.add(i),i;}},{key:"destroy",value:function destroy(){this.selection.destroy(),this.stopListening();}},{key:"getRoot",value:function getRoot(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"main";return this.roots.get(e);}},{key:"getRootNames",value:function getRootNames(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;return this.getRoots(e).map(function(e){return e.rootName;});}},{key:"getRoots",value:function getRoots(){var _this114=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;return this.roots.filter(function(t){return t!=_this114.graveyard&&(e||t.isAttached())&&t._isLoaded;});}},{key:"registerPostFixer",value:function registerPostFixer(e){this._postFixers.add(e);}},{key:"toJSON",value:function toJSON(){var e=$n(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e;}},{key:"_handleChangeBlock",value:function _handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1;}},{key:"_hasDocumentChangedFromTheLastChangeBlock",value:function _hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock;}},{key:"_getDefaultRoot",value:function _getDefaultRoot(){var e=this.getRoots();return e.length?e[0]:this.graveyard;}},{key:"_getDefaultRange",value:function _getDefaultRange(){var e=this._getDefaultRoot(),t=this.model,i=t.schema,n=t.createPositionFromPath(e,[0]);return i.getNearestSelectionRange(n)||t.createRange(n);}},{key:"_validateSelectionRange",value:function _validateSelectionRange(e){return e.start.isValid()&&e.end.isValid()&&bu(e.start)&&bu(e.end);}},{key:"_callPostFixers",value:function _callPostFixers(e){var t=!1;do{var _iterator287=_createForOfIteratorHelper(this._postFixers),_step287;try{for(_iterator287.s();!(_step287=_iterator287.n()).done;){var _i232=_step287.value;if(this.selection.refresh(),t=_i232(e),t)break;}}catch(err){_iterator287.e(err);}finally{_iterator287.f();}}while(t);}}]);}(L());function bu(e){var t=e.textNode;if(t){var _i233=t.data,_n129=e.offset-t.startOffset;return!Br(_i233,_n129)&&!Mr(_i233,_n129);}return!0;}var wu=/*#__PURE__*/function(_L18){function wu(){var _this115;_classCallCheck(this,wu);for(var _len30=arguments.length,args=new Array(_len30),_key30=0;_key30<_len30;_key30++){args[_key30]=arguments[_key30];}_this115=_callSuper(this,wu,[].concat(args));_defineProperty(_this115,"_markers",new Map());return _this115;}_inherits(wu,_L18);return _createClass(wu,[{key:Symbol.iterator,value:function value(){return this._markers.values();}},{key:"has",value:function has(e){var t=e instanceof _u?e.name:e;return this._markers.has(t);}},{key:"get",value:function get(e){return this._markers.get(e)||null;}},{key:"_set",value:function _set(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;var s=e instanceof _u?e.name:e;if(s.includes(","))throw new A("markercollection-incorrect-marker-name",this);var o=this._markers.get(s);if(o){var _e313=o.getData(),_r26=o.getRange();var _a12=!1;return _r26.isEqual(t)||(o._attachLiveRange(fc.fromRange(t)),_a12=!0),i!=o.managedUsingOperations&&(o._managedUsingOperations=i,_a12=!0),"boolean"==typeof n&&n!=o.affectsData&&(o._affectsData=n,_a12=!0),_a12&&this.fire("update:".concat(s),o,_r26,t,_e313),o;}var r=fc.fromRange(t),a=new _u(s,r,i,n);return this._markers.set(s,a),this.fire("update:".concat(s),a,null,t,_objectSpread(_objectSpread({},a.getData()),{},{range:null})),a;}},{key:"_remove",value:function _remove(e){var t=e instanceof _u?e.name:e,i=this._markers.get(t);return!!i&&(this._markers["delete"](t),this.fire("update:".concat(t),i,i.getRange(),null,i.getData()),this._destroyMarker(i),!0);}},{key:"_refresh",value:function _refresh(e){var t=e instanceof _u?e.name:e,i=this._markers.get(t);if(!i)throw new A("markercollection-refresh-marker-not-exists",this);var n=i.getRange();this.fire("update:".concat(t),i,n,n,i.getData());}},{key:"getMarkersAtPosition",value:/*#__PURE__*/_regeneratorRuntime().mark(function getMarkersAtPosition(e){var _iterator288,_step288,_t189;return _regeneratorRuntime().wrap(function getMarkersAtPosition$(_context31){while(1)switch(_context31.prev=_context31.next){case 0:_iterator288=_createForOfIteratorHelper(this);_context31.prev=1;_iterator288.s();case 3:if((_step288=_iterator288.n()).done){_context31.next=11;break;}_t189=_step288.value;_context31.t0=_t189.getRange().containsPosition(e);if(!_context31.t0){_context31.next=9;break;}_context31.next=9;return _t189;case 9:_context31.next=3;break;case 11:_context31.next=16;break;case 13:_context31.prev=13;_context31.t1=_context31["catch"](1);_iterator288.e(_context31.t1);case 16:_context31.prev=16;_iterator288.f();return _context31.finish(16);case 19:case"end":return _context31.stop();}},getMarkersAtPosition,this,[[1,13,16,19]]);})},{key:"getMarkersIntersectingRange",value:/*#__PURE__*/_regeneratorRuntime().mark(function getMarkersIntersectingRange(e){var _iterator289,_step289,_t190;return _regeneratorRuntime().wrap(function getMarkersIntersectingRange$(_context32){while(1)switch(_context32.prev=_context32.next){case 0:_iterator289=_createForOfIteratorHelper(this);_context32.prev=1;_iterator289.s();case 3:if((_step289=_iterator289.n()).done){_context32.next=11;break;}_t190=_step289.value;_context32.t0=null!==_t190.getRange().getIntersection(e);if(!_context32.t0){_context32.next=9;break;}_context32.next=9;return _t190;case 9:_context32.next=3;break;case 11:_context32.next=16;break;case 13:_context32.prev=13;_context32.t1=_context32["catch"](1);_iterator289.e(_context32.t1);case 16:_context32.prev=16;_iterator289.f();return _context32.finish(16);case 19:case"end":return _context32.stop();}},getMarkersIntersectingRange,this,[[1,13,16,19]]);})},{key:"destroy",value:function destroy(){var _iterator290=_createForOfIteratorHelper(this._markers.values()),_step290;try{for(_iterator290.s();!(_step290=_iterator290.n()).done;){var _e314=_step290.value;this._destroyMarker(_e314);}}catch(err){_iterator290.e(err);}finally{_iterator290.f();}this._markers=null,this.stopListening();}},{key:"getMarkersGroup",value:/*#__PURE__*/_regeneratorRuntime().mark(function getMarkersGroup(e){var _iterator291,_step291,_t191;return _regeneratorRuntime().wrap(function getMarkersGroup$(_context33){while(1)switch(_context33.prev=_context33.next){case 0:_iterator291=_createForOfIteratorHelper(this._markers.values());_context33.prev=1;_iterator291.s();case 3:if((_step291=_iterator291.n()).done){_context33.next=11;break;}_t191=_step291.value;_context33.t0=_t191.name.startsWith(e+":");if(!_context33.t0){_context33.next=9;break;}_context33.next=9;return _t191;case 9:_context33.next=3;break;case 11:_context33.next=16;break;case 13:_context33.prev=13;_context33.t1=_context33["catch"](1);_iterator291.e(_context33.t1);case 16:_context33.prev=16;_iterator291.f();return _context33.finish(16);case 19:case"end":return _context33.stop();}},getMarkersGroup,this,[[1,13,16,19]]);})},{key:"_destroyMarker",value:function _destroyMarker(e){e.stopListening(),e._detachLiveRange();}}]);}(L());var _u=/*#__PURE__*/function(_L19){function _u(e,t,i,n){var _this116;_classCallCheck(this,_u);_this116=_callSuper(this,_u),_defineProperty(_assertThisInitialized(_this116),"name",void 0),_defineProperty(_assertThisInitialized(_this116),"_managedUsingOperations",void 0),_defineProperty(_assertThisInitialized(_this116),"_affectsData",void 0),_defineProperty(_assertThisInitialized(_this116),"_liveRange",void 0),_this116.name=e,_this116._liveRange=_this116._attachLiveRange(t),_this116._managedUsingOperations=i,_this116._affectsData=n;return _this116;}_inherits(_u,_L19);return _createClass(_u,[{key:"managedUsingOperations",get:function get(){if(!this._liveRange)throw new A("marker-destroyed",this);return this._managedUsingOperations;}},{key:"affectsData",get:function get(){if(!this._liveRange)throw new A("marker-destroyed",this);return this._affectsData;}},{key:"getData",value:function getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations};}},{key:"getStart",value:function getStart(){if(!this._liveRange)throw new A("marker-destroyed",this);return this._liveRange.start.clone();}},{key:"getEnd",value:function getEnd(){if(!this._liveRange)throw new A("marker-destroyed",this);return this._liveRange.end.clone();}},{key:"getRange",value:function getRange(){if(!this._liveRange)throw new A("marker-destroyed",this);return this._liveRange.toRange();}},{key:"_attachLiveRange",value:function _attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e;}},{key:"_detachLiveRange",value:function _detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null;}}]);}(L(Hl));_u.prototype.is=function(e){return"marker"===e||"model:marker"===e;};var vu=/*#__PURE__*/function(_Ed12){function vu(e,t){var _this117;_classCallCheck(this,vu);_this117=_callSuper(this,vu,[null]),_defineProperty(_assertThisInitialized(_this117),"sourcePosition",void 0),_defineProperty(_assertThisInitialized(_this117),"howMany",void 0),_this117.sourcePosition=e.clone(),_this117.howMany=t;return _this117;}_inherits(vu,_Ed12);return _createClass(vu,[{key:"type",get:function get(){return"detach";}},{key:"affectedSelectable",get:function get(){return null;}},{key:"toJSON",value:function toJSON(){var e=_superPropGet(vu,"toJSON",this,3)([]);return e.sourcePosition=this.sourcePosition.toJSON(),e;}},{key:"_validate",value:function _validate(){if(this.sourcePosition.root.document)throw new A("detach-operation-on-document-node",this);}},{key:"_execute",value:function _execute(){Pd(tc._createFromPositionAndShift(this.sourcePosition,this.howMany));}}],[{key:"className",get:function get(){return"DetachOperation";}}]);}(Ed);var yu=/*#__PURE__*/function(_Hl5){function yu(e){var _this118;_classCallCheck(this,yu);_this118=_callSuper(this,yu),_defineProperty(_assertThisInitialized(_this118),"markers",new Map()),_defineProperty(_assertThisInitialized(_this118),"_children",new Ul()),e&&_this118._insertChild(0,e);return _this118;}_inherits(yu,_Hl5);return _createClass(yu,[{key:Symbol.iterator,value:function value(){return this.getChildren();}},{key:"childCount",get:function get(){return this._children.length;}},{key:"maxOffset",get:function get(){return this._children.maxOffset;}},{key:"isEmpty",get:function get(){return 0===this.childCount;}},{key:"nextSibling",get:function get(){return null;}},{key:"previousSibling",get:function get(){return null;}},{key:"root",get:function get(){return this;}},{key:"parent",get:function get(){return null;}},{key:"document",get:function get(){return null;}},{key:"isAttached",value:function isAttached(){return!1;}},{key:"getAncestors",value:function getAncestors(){return[];}},{key:"getChild",value:function getChild(e){return this._children.getNode(e);}},{key:"getChildAtOffset",value:function getChildAtOffset(e){return this._children.getNodeAtOffset(e);}},{key:"getChildren",value:function getChildren(){return this._children[Symbol.iterator]();}},{key:"getChildIndex",value:function getChildIndex(e){return this._children.getNodeIndex(e);}},{key:"getChildStartOffset",value:function getChildStartOffset(e){return this._children.getNodeStartOffset(e);}},{key:"getPath",value:function getPath(){return[];}},{key:"getNodeByPath",value:function getNodeByPath(e){var t=this;var _iterator292=_createForOfIteratorHelper(e),_step292;try{for(_iterator292.s();!(_step292=_iterator292.n()).done;){var _i234=_step292.value;t=t.getChildAtOffset(_i234);}}catch(err){_iterator292.e(err);}finally{_iterator292.f();}return t;}},{key:"offsetToIndex",value:function offsetToIndex(e){return this._children.offsetToIndex(e);}},{key:"toJSON",value:function toJSON(){var e=[];var _iterator293=_createForOfIteratorHelper(this._children),_step293;try{for(_iterator293.s();!(_step293=_iterator293.n()).done;){var _t192=_step293.value;e.push(_t192.toJSON());}}catch(err){_iterator293.e(err);}finally{_iterator293.f();}return e;}},{key:"_appendChild",value:function _appendChild(e){this._insertChild(this.childCount,e);}},{key:"_insertChild",value:function _insertChild(e,t){var i=function(e){if("string"==typeof e)return[new Wl(e)];oo(e)||(e=[e]);return Array.from(e).map(function(e){return"string"==typeof e?new Wl(e):e instanceof jl?new Wl(e.data,e.getAttributes()):e;});}(t);var _iterator294=_createForOfIteratorHelper(i),_step294;try{for(_iterator294.s();!(_step294=_iterator294.n()).done;){var _e315=_step294.value;null!==_e315.parent&&_e315._remove(),_e315.parent=this;}}catch(err){_iterator294.e(err);}finally{_iterator294.f();}this._children._insertNodes(e,i);}},{key:"_removeChildren",value:function _removeChildren(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;var i=this._children._removeNodes(e,t);var _iterator295=_createForOfIteratorHelper(i),_step295;try{for(_iterator295.s();!(_step295=_iterator295.n()).done;){var _e316=_step295.value;_e316.parent=null;}}catch(err){_iterator295.e(err);}finally{_iterator295.f();}return i;}}],[{key:"fromJSON",value:function fromJSON(e){var t=[];var _iterator296=_createForOfIteratorHelper(e),_step296;try{for(_iterator296.s();!(_step296=_iterator296.n()).done;){var _i235=_step296.value;_i235.name?t.push(ql.fromJSON(_i235)):t.push(Wl.fromJSON(_i235));}}catch(err){_iterator296.e(err);}finally{_iterator296.f();}return new yu(t);}}]);}(Hl);yu.prototype.is=function(e){return"documentFragment"===e||"model:documentFragment"===e;};var ku=/*#__PURE__*/function(){function ku(e,t){_classCallCheck(this,ku);_defineProperty(this,"model",void 0);_defineProperty(this,"batch",void 0);this.model=e,this.batch=t;}return _createClass(ku,[{key:"createText",value:function createText(e,t){return new Wl(e,t);}},{key:"createElement",value:function createElement(e,t){return new ql(e,t);}},{key:"createDocumentFragment",value:function createDocumentFragment(){return new yu();}},{key:"cloneElement",value:function cloneElement(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;return e._clone(t);}},{key:"insert",value:function insert(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(this._assertWriterUsedCorrectly(),e instanceof Wl&&""==e.data)return;var n=Zl._createAt(t,i);if(e.parent){if(Tu(e.root,n.root))return void this.move(tc._createOn(e),n);if(e.root.document)throw new A("model-writer-insert-forbidden-move",this);this.remove(e);}var s=n.root.document?n.root.document.version:null,o=new Md(n,e,s);if(e instanceof Wl&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),e instanceof yu){var _iterator297=_createForOfIteratorHelper(e.markers),_step297;try{for(_iterator297.s();!(_step297=_iterator297.n()).done;){var _step297$value=_slicedToArray(_step297.value,2),_t193=_step297$value[0],_i236=_step297$value[1];var _e317=Zl._createAt(_i236.root,0),_s89={range:new tc(_i236.start._getCombined(_e317,n),_i236.end._getCombined(_e317,n)),usingOperation:!0,affectsData:!0};this.model.markers.has(_t193)?this.updateMarker(_t193,_s89):this.addMarker(_t193,_s89);}}catch(err){_iterator297.e(err);}finally{_iterator297.f();}}}},{key:"insertText",value:function insertText(e,t,i,n){t instanceof yu||t instanceof ql||t instanceof Zl?this.insert(this.createText(e),t,i):this.insert(this.createText(e,t),i,n);}},{key:"insertElement",value:function insertElement(e,t,i,n){t instanceof yu||t instanceof ql||t instanceof Zl?this.insert(this.createElement(e),t,i):this.insert(this.createElement(e,t),i,n);}},{key:"append",value:function append(e,t){this.insert(e,t,"end");}},{key:"appendText",value:function appendText(e,t,i){t instanceof yu||t instanceof ql?this.insert(this.createText(e),t,"end"):this.insert(this.createText(e,t),i,"end");}},{key:"appendElement",value:function appendElement(e,t,i){t instanceof yu||t instanceof ql?this.insert(this.createElement(e),t,"end"):this.insert(this.createElement(e,t),i,"end");}},{key:"setAttribute",value:function setAttribute(e,t,i){if(this._assertWriterUsedCorrectly(),i instanceof tc){var _n130=i.getMinimalFlatRanges();var _iterator298=_createForOfIteratorHelper(_n130),_step298;try{for(_iterator298.s();!(_step298=_iterator298.n()).done;){var _i237=_step298.value;Cu(this,e,t,_i237);}}catch(err){_iterator298.e(err);}finally{_iterator298.f();}}else xu(this,e,t,i);}},{key:"setAttributes",value:function setAttributes(e,t){var _iterator299=_createForOfIteratorHelper(xr(e)),_step299;try{for(_iterator299.s();!(_step299=_iterator299.n()).done;){var _step299$value=_slicedToArray(_step299.value,2),_i238=_step299$value[0],_n131=_step299$value[1];this.setAttribute(_i238,_n131,t);}}catch(err){_iterator299.e(err);}finally{_iterator299.f();}}},{key:"removeAttribute",value:function removeAttribute(e,t){if(this._assertWriterUsedCorrectly(),t instanceof tc){var _i239=t.getMinimalFlatRanges();var _iterator300=_createForOfIteratorHelper(_i239),_step300;try{for(_iterator300.s();!(_step300=_iterator300.n()).done;){var _t194=_step300.value;Cu(this,e,null,_t194);}}catch(err){_iterator300.e(err);}finally{_iterator300.f();}}else xu(this,e,null,t);}},{key:"clearAttributes",value:function clearAttributes(e){var _this119=this;this._assertWriterUsedCorrectly();var t=function t(e){var _iterator301=_createForOfIteratorHelper(e.getAttributeKeys()),_step301;try{for(_iterator301.s();!(_step301=_iterator301.n()).done;){var _t195=_step301.value;_this119.removeAttribute(_t195,e);}}catch(err){_iterator301.e(err);}finally{_iterator301.f();}};if(e instanceof tc){var _iterator302=_createForOfIteratorHelper(e.getItems()),_step302;try{for(_iterator302.s();!(_step302=_iterator302.n()).done;){var _i240=_step302.value;t(_i240);}}catch(err){_iterator302.e(err);}finally{_iterator302.f();}}else t(e);}},{key:"move",value:function move(e,t,i){if(this._assertWriterUsedCorrectly(),!(e instanceof tc))throw new A("writer-move-invalid-range",this);if(!e.isFlat)throw new A("writer-move-range-not-flat",this);var n=Zl._createAt(t,i);if(n.isEqual(e.start))return;if(this._addOperationForAffectedMarkers("move",e),!Tu(e.root,n.root))throw new A("writer-move-different-document",this);var s=e.root.document?e.root.document.version:null,o=new Bd(e.start,e.end.offset-e.start.offset,n,s);this.batch.addOperation(o),this.model.applyOperation(o);}},{key:"remove",value:function remove(e){this._assertWriterUsedCorrectly();var t=(e instanceof tc?e:tc._createOn(e)).getMinimalFlatRanges().reverse();var _iterator303=_createForOfIteratorHelper(t),_step303;try{for(_iterator303.s();!(_step303=_iterator303.n()).done;){var _e318=_step303.value;this._addOperationForAffectedMarkers("move",_e318),Eu(_e318.start,_e318.end.offset-_e318.start.offset,this.batch,this.model);}}catch(err){_iterator303.e(err);}finally{_iterator303.f();}}},{key:"merge",value:function merge(e){this._assertWriterUsedCorrectly();var t=e.nodeBefore,i=e.nodeAfter;if(this._addOperationForAffectedMarkers("merge",e),!(t instanceof ql))throw new A("writer-merge-no-element-before",this);if(!(i instanceof ql))throw new A("writer-merge-no-element-after",this);e.root.document?this._merge(e):this._mergeDetached(e);}},{key:"createPositionFromPath",value:function createPositionFromPath(e,t,i){return this.model.createPositionFromPath(e,t,i);}},{key:"createPositionAt",value:function createPositionAt(e,t){return this.model.createPositionAt(e,t);}},{key:"createPositionAfter",value:function createPositionAfter(e){return this.model.createPositionAfter(e);}},{key:"createPositionBefore",value:function createPositionBefore(e){return this.model.createPositionBefore(e);}},{key:"createRange",value:function createRange(e,t){return this.model.createRange(e,t);}},{key:"createRangeIn",value:function createRangeIn(e){return this.model.createRangeIn(e);}},{key:"createRangeOn",value:function createRangeOn(e){return this.model.createRangeOn(e);}},{key:"createSelection",value:function createSelection(){var _this$model;return(_this$model=this.model).createSelection.apply(_this$model,arguments);}},{key:"_mergeDetached",value:function _mergeDetached(e){var t=e.nodeBefore,i=e.nodeAfter;this.move(tc._createIn(i),Zl._createAt(t,"end")),this.remove(i);}},{key:"_merge",value:function _merge(e){var t=Zl._createAt(e.nodeBefore,"end"),i=Zl._createAt(e.nodeAfter,0),n=e.root.document.graveyard,s=new Zl(n,[0]),o=e.root.document.version,r=new Fd(i,e.nodeAfter.maxOffset,t,s,o);this.batch.addOperation(r),this.model.applyOperation(r);}},{key:"rename",value:function rename(e,t){if(this._assertWriterUsedCorrectly(),!(e instanceof ql))throw new A("writer-rename-not-element-instance",this);var i=e.root.document?e.root.document.version:null,n=new Hd(Zl._createBefore(e),e.name,t,i);this.batch.addOperation(n),this.model.applyOperation(n);}},{key:"split",value:function split(e,t){this._assertWriterUsedCorrectly();var i,n,s=e.parent;if(!s.parent)throw new A("writer-split-element-no-parent",this);if(t||(t=s.parent),!e.parent.getAncestors({includeSelf:!0}).includes(t))throw new A("writer-split-invalid-limit-element",this);do{var _t196=s.root.document?s.root.document.version:null,_o44=s.maxOffset-e.offset,_r27=Ld.getInsertionPosition(e),_a13=new Ld(e,_o44,_r27,null,_t196);this.batch.addOperation(_a13),this.model.applyOperation(_a13),i||n||(i=s,n=e.parent.nextSibling),s=(e=this.createPositionAfter(e.parent)).parent;}while(s!==t);return{position:e,range:new tc(Zl._createAt(i,"end"),Zl._createAt(n,0))};}},{key:"wrap",value:function wrap(e,t){if(this._assertWriterUsedCorrectly(),!e.isFlat)throw new A("writer-wrap-range-not-flat",this);var i=t instanceof ql?t:new ql(t);if(i.childCount>0)throw new A("writer-wrap-element-not-empty",this);if(null!==i.parent)throw new A("writer-wrap-element-attached",this);this.insert(i,e.start);var n=new tc(e.start.getShiftedBy(1),e.end.getShiftedBy(1));this.move(n,Zl._createAt(i,0));}},{key:"unwrap",value:function unwrap(e){if(this._assertWriterUsedCorrectly(),null===e.parent)throw new A("writer-unwrap-element-no-parent",this);this.move(tc._createIn(e),this.createPositionAfter(e)),this.remove(e);}},{key:"addMarker",value:function addMarker(e,t){if(this._assertWriterUsedCorrectly(),!t||"boolean"!=typeof t.usingOperation)throw new A("writer-addmarker-no-usingoperation",this);var i=t.usingOperation,n=t.range,s=void 0!==t.affectsData&&t.affectsData;if(this.model.markers.has(e))throw new A("writer-addmarker-marker-exists",this);if(!n)throw new A("writer-addmarker-no-range",this);return i?(Au(this,e,null,n,s),this.model.markers.get(e)):this.model.markers._set(e,n,i,s);}},{key:"updateMarker",value:function updateMarker(e,t){this._assertWriterUsedCorrectly();var i="string"==typeof e?e:e.name,n=this.model.markers.get(i);if(!n)throw new A("writer-updatemarker-marker-not-exists",this);if(!t)return E("writer-updatemarker-reconvert-using-editingcontroller",{markerName:i}),void this.model.markers._refresh(n);var s="boolean"==typeof t.usingOperation,o="boolean"==typeof t.affectsData,r=o?t.affectsData:n.affectsData;if(!s&&!t.range&&!o)throw new A("writer-updatemarker-wrong-options",this);var a=n.getRange(),l=t.range?t.range:a;s&&t.usingOperation!==n.managedUsingOperations?t.usingOperation?Au(this,i,null,l,r):(Au(this,i,a,null,r),this.model.markers._set(i,l,void 0,r)):n.managedUsingOperations?Au(this,i,a,l,r):this.model.markers._set(i,l,void 0,r);}},{key:"removeMarker",value:function removeMarker(e){this._assertWriterUsedCorrectly();var t="string"==typeof e?e:e.name;if(!this.model.markers.has(t))throw new A("writer-removemarker-no-marker",this);var i=this.model.markers.get(t);if(!i.managedUsingOperations)return void this.model.markers._remove(t);Au(this,t,i.getRange(),null,i.affectsData);}},{key:"addRoot",value:function addRoot(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"$root";this._assertWriterUsedCorrectly();var i=this.model.document.getRoot(e);if(i&&i.isAttached())throw new A("writer-addroot-root-exists",this);var n=this.model.document,s=new Ud(e,t,!0,n,n.version);return this.batch.addOperation(s),this.model.applyOperation(s),this.model.document.getRoot(e);}},{key:"detachRoot",value:function detachRoot(e){this._assertWriterUsedCorrectly();var t="string"==typeof e?this.model.document.getRoot(e):e;if(!t||!t.isAttached())throw new A("writer-detachroot-no-root",this);var _iterator304=_createForOfIteratorHelper(this.model.markers),_step304;try{for(_iterator304.s();!(_step304=_iterator304.n()).done;){var _e319=_step304.value;_e319.getRange().root===t&&this.removeMarker(_e319);}}catch(err){_iterator304.e(err);}finally{_iterator304.f();}var _iterator305=_createForOfIteratorHelper(t.getAttributeKeys()),_step305;try{for(_iterator305.s();!(_step305=_iterator305.n()).done;){var _e320=_step305.value;this.removeAttribute(_e320,t);}}catch(err){_iterator305.e(err);}finally{_iterator305.f();}this.remove(this.createRangeIn(t));var i=this.model.document,n=new Ud(t.rootName,t.name,!1,i,i.version);this.batch.addOperation(n),this.model.applyOperation(n);}},{key:"setSelection",value:function setSelection(){var _this$model$document$;this._assertWriterUsedCorrectly(),(_this$model$document$=this.model.document.selection)._setTo.apply(_this$model$document$,arguments);}},{key:"setSelectionFocus",value:function setSelectionFocus(e,t){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(e,t);}},{key:"setSelectionAttribute",value:function setSelectionAttribute(e,t){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._setSelectionAttribute(e,t);else{var _iterator306=_createForOfIteratorHelper(xr(e)),_step306;try{for(_iterator306.s();!(_step306=_iterator306.n()).done;){var _step306$value=_slicedToArray(_step306.value,2),_t197=_step306$value[0],_i241=_step306$value[1];this._setSelectionAttribute(_t197,_i241);}}catch(err){_iterator306.e(err);}finally{_iterator306.f();}}}},{key:"removeSelectionAttribute",value:function removeSelectionAttribute(e){if(this._assertWriterUsedCorrectly(),"string"==typeof e)this._removeSelectionAttribute(e);else{var _iterator307=_createForOfIteratorHelper(e),_step307;try{for(_iterator307.s();!(_step307=_iterator307.n()).done;){var _t198=_step307.value;this._removeSelectionAttribute(_t198);}}catch(err){_iterator307.e(err);}finally{_iterator307.f();}}}},{key:"overrideSelectionGravity",value:function overrideSelectionGravity(){return this.model.document.selection._overrideGravity();}},{key:"restoreSelectionGravity",value:function restoreSelectionGravity(e){this.model.document.selection._restoreGravity(e);}},{key:"_setSelectionAttribute",value:function _setSelectionAttribute(e,t){var i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){var _n132=_c._getStoreAttributeKey(e);this.setAttribute(_n132,t,i.anchor.parent);}i._setAttribute(e,t);}},{key:"_removeSelectionAttribute",value:function _removeSelectionAttribute(e){var t=this.model.document.selection;if(t.isCollapsed&&t.anchor.parent.isEmpty){var _i242=_c._getStoreAttributeKey(e);this.removeAttribute(_i242,t.anchor.parent);}t._removeAttribute(e);}},{key:"_assertWriterUsedCorrectly",value:function _assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new A("writer-incorrect-use",this);}},{key:"_addOperationForAffectedMarkers",value:function _addOperationForAffectedMarkers(e,t){var _iterator308=_createForOfIteratorHelper(this.model.markers),_step308;try{for(_iterator308.s();!(_step308=_iterator308.n()).done;){var _i243=_step308.value;if(!_i243.managedUsingOperations)continue;var _n133=_i243.getRange();var _s90=!1;if("move"===e){var _e321=t;_s90=_e321.containsPosition(_n133.start)||_e321.start.isEqual(_n133.start)||_e321.containsPosition(_n133.end)||_e321.end.isEqual(_n133.end);}else{var _e322=t,_i244=_e322.nodeBefore,_o45=_e322.nodeAfter,_r28=_n133.start.parent==_i244&&_n133.start.isAtEnd,_a14=_n133.end.parent==_o45&&0==_n133.end.offset,_l10=_n133.end.nodeAfter==_o45,_c9=_n133.start.nodeAfter==_o45;_s90=_r28||_a14||_l10||_c9;}_s90&&this.updateMarker(_i243.name,{range:_n133});}}catch(err){_iterator308.e(err);}finally{_iterator308.f();}}}]);}();function Cu(e,t,i,n){var s=e.model,o=s.document;var r,a,l,c=n.start;var _iterator309=_createForOfIteratorHelper(n.getWalker({shallow:!0})),_step309;try{for(_iterator309.s();!(_step309=_iterator309.n()).done;){var _e323=_step309.value;l=_e323.item.getAttribute(t),r&&a!=l&&(a!=i&&d(),c=r),r=_e323.nextPosition,a=l;}}catch(err){_iterator309.e(err);}finally{_iterator309.f();}function d(){var n=new tc(c,r),l=n.root.document?o.version:null,d=new Dd(n,t,a,i,l);e.batch.addOperation(d),s.applyOperation(d);}r instanceof Zl&&r!=c&&a!=i&&d();}function xu(e,t,i,n){var s=e.model,o=s.document,r=n.getAttribute(t);var a,l;if(r!=i){if(n.root===n){var _e324=n.document?o.version:null;l=new $d(n,t,r,i,_e324);}else{a=new tc(Zl._createBefore(n),e.createPositionAfter(n));var _s91=a.root.document?o.version:null;l=new Dd(a,t,r,i,_s91);}e.batch.addOperation(l),s.applyOperation(l);}}function Au(e,t,i,n,s){var o=e.model,r=o.document,a=new Nd(t,i,n,o.markers,!!s,r.version);e.batch.addOperation(a),o.applyOperation(a);}function Eu(e,t,i,n){var s;if(e.root.document){var _i245=n.document,_o46=new Zl(_i245.graveyard,[0]);s=new Bd(e,t,_o46,_i245.version);}else s=new vu(e,t);i.addOperation(s),n.applyOperation(s);}function Tu(e,t){return e===t||e instanceof gu&&t instanceof gu;}function Pu(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(t.isCollapsed)return;var n=t.getFirstRange();if("$graveyard"==n.root.rootName)return;var s=e.schema;e.change(function(e){if(!i.doNotResetEntireContent&&function(e,t){var i=e.getLimitElement(t);if(!t.containsEntireContent(i))return!1;var n=t.getFirstRange();if(n.start.parent==n.end.parent)return!1;return e.checkChild(i,"paragraph");}(s,t))return void function(e,t){var i=e.model.schema.getLimitElement(t);e.remove(e.createRangeIn(i)),Ru(e,e.createPositionAt(i,0),t);}(e,t);var o={};if(!i.doNotAutoparagraph){var _e325=t.getSelectedElement();_e325&&Object.assign(o,s.getAttributesWithProperty(_e325,"copyOnReplace",!0));}var _ref37=function(e){var t=e.root.document.model,i=e.start;var n=e.end;if(t.hasContent(e,{ignoreMarkers:!0})){var _i246=function(e){var t=e.parent,i=t.root.document.model.schema,n=t.getAncestors({parentFirst:!0,includeSelf:!0});var _iterator310=_createForOfIteratorHelper(n),_step310;try{for(_iterator310.s();!(_step310=_iterator310.n()).done;){var _e326=_step310.value;if(i.isLimit(_e326))return null;if(i.isBlock(_e326))return _e326;}}catch(err){_iterator310.e(err);}finally{_iterator310.f();}}(n);if(_i246&&n.isTouching(t.createPositionAt(_i246,0))){var _i247=t.createSelection(e);t.modifySelection(_i247,{direction:"backward"});var _s92=_i247.getLastPosition(),_o47=t.createRange(_s92,n);t.hasContent(_o47,{ignoreMarkers:!0})||(n=_s92);}}return[su.fromPosition(i,"toPrevious"),su.fromPosition(n,"toNext")];}(n),_ref38=_slicedToArray(_ref37,2),r=_ref38[0],a=_ref38[1];r.isTouching(a)||e.remove(e.createRange(r,a)),i.leaveUnmerged||(!function(e,t,i){var n=e.model;if(!Vu(e.model.schema,t,i))return;var _ref39=function(e,t){var i=e.getAncestors(),n=t.getAncestors();var s=0;for(;i[s]&&i[s]==n[s];)s++;return[i[s],n[s]];}(t,i),_ref40=_slicedToArray(_ref39,2),s=_ref40[0],o=_ref40[1];if(!s||!o)return;!n.hasContent(s,{ignoreMarkers:!0})&&n.hasContent(o,{ignoreMarkers:!0})?Iu(e,t,i,s.parent):Su(e,t,i,s.parent);}(e,r,a),s.removeDisallowedAttributes(r.parent.getChildren(),e)),Ou(e,t,r),!i.doNotAutoparagraph&&function(e,t){var i=e.checkChild(t,"$text"),n=e.checkChild(t,"paragraph");return!i&&n;}(s,r)&&Ru(e,r,t,o),r.detach(),a.detach();});}function Su(e,t,i,n){var s=t.parent,o=i.parent;if(s!=n&&o!=n){for(t=e.createPositionAfter(s),(i=e.createPositionBefore(o)).isEqual(t)||e.insert(o,t),e.merge(t);i.parent.isEmpty;){var _t199=i.parent;i=e.createPositionBefore(_t199),e.remove(_t199);}Vu(e.model.schema,t,i)&&Su(e,t,i,n);}}function Iu(e,t,i,n){var s=t.parent,o=i.parent;if(s!=n&&o!=n){for(t=e.createPositionAfter(s),(i=e.createPositionBefore(o)).isEqual(t)||e.insert(s,i);t.parent.isEmpty;){var _i248=t.parent;t=e.createPositionBefore(_i248),e.remove(_i248);}i=e.createPositionBefore(o),function(e,t){var i=t.nodeBefore,n=t.nodeAfter;i.name!=n.name&&e.rename(i,n.name);e.clearAttributes(i),e.setAttributes(Object.fromEntries(n.getAttributes()),i),e.merge(t);}(e,i),Vu(e.model.schema,t,i)&&Iu(e,t,i,n);}}function Vu(e,t,i){var n=t.parent,s=i.parent;return n!=s&&!e.isLimit(n)&&!e.isLimit(s)&&function(e,t,i){var n=new tc(e,t);var _iterator311=_createForOfIteratorHelper(n.getWalker()),_step311;try{for(_iterator311.s();!(_step311=_iterator311.n()).done;){var _e327=_step311.value;if(i.isLimit(_e327.item))return!1;}}catch(err){_iterator311.e(err);}finally{_iterator311.f();}return!0;}(t,i,e);}function Ru(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s=e.createElement("paragraph");e.model.schema.setAllowedAttributes(s,n,e),e.insert(s,t),Ou(e,i,e.createPositionAt(s,0));}function Ou(e,t,i){t instanceof _c?e.setSelection(i):t.setTo(i);}function Bu(e,t){var i=[];Array.from(e.getItems({direction:"backward"})).map(function(e){return t.createRangeOn(e);}).filter(function(t){return(t.start.isAfter(e.start)||t.start.isEqual(e.start))&&(t.end.isBefore(e.end)||t.end.isEqual(e.end));}).forEach(function(e){i.push(e.start.parent),t.remove(e);}),i.forEach(function(e){var i=e;for(;i.parent&&i.isEmpty;){var _e328=t.createRangeOn(i);i=i.parent,t.remove(_e328);}});}var Mu=/*#__PURE__*/function(){function Mu(e,t,i){_classCallCheck(this,Mu);_defineProperty(this,"model",void 0);_defineProperty(this,"writer",void 0);_defineProperty(this,"position",void 0);_defineProperty(this,"canMergeWith",void 0);_defineProperty(this,"schema",void 0);_defineProperty(this,"_documentFragment",void 0);_defineProperty(this,"_documentFragmentPosition",void 0);_defineProperty(this,"_firstNode",null);_defineProperty(this,"_lastNode",null);_defineProperty(this,"_lastAutoParagraph",null);_defineProperty(this,"_filterAttributesOf",[]);_defineProperty(this,"_affectedStart",null);_defineProperty(this,"_affectedEnd",null);_defineProperty(this,"_nodeToSelect",null);this.model=e,this.writer=t,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=e.schema,this._documentFragment=t.createDocumentFragment(),this._documentFragmentPosition=t.createPositionAt(this._documentFragment,0);}return _createClass(Mu,[{key:"handleNodes",value:function handleNodes(e){for(var _i249=0,_Array$from7=Array.from(e);_i249<_Array$from7.length;_i249++){var _t200=_Array$from7[_i249];this._handleNode(_t200);}this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[];}},{key:"_updateLastNodeFromAutoParagraph",value:function _updateLastNodeFromAutoParagraph(e){var t=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(e);if(i.isAfter(t)){if(this._lastNode=e,this.position.parent!=e||!this.position.isAtEnd)throw new A("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position);}}},{key:"getSelectionRange",value:function getSelectionRange(){return this._nodeToSelect?tc._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position);}},{key:"getAffectedRange",value:function getAffectedRange(){return this._affectedStart?new tc(this._affectedStart,this._affectedEnd):null;}},{key:"destroy",value:function destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach();}},{key:"_handleNode",value:function _handleNode(e){this._checkAndSplitToAllowedPosition(e)?(this._appendToFragment(e),this._firstNode||(this._firstNode=e),this._lastNode=e):this.schema.isObject(e)||this._handleDisallowedNode(e);}},{key:"_insertPartialFragment",value:function _insertPartialFragment(){if(this._documentFragment.isEmpty)return;var e=su.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=e.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=e.toPosition(),e.detach();}},{key:"_handleDisallowedNode",value:function _handleDisallowedNode(e){e.is("element")&&this.handleNodes(e.getChildren());}},{key:"_appendToFragment",value:function _appendToFragment(e){if(!this.schema.checkChild(this.position,e))throw new A("insertcontent-wrong-position",this,{node:e,position:this.position});this.writer.insert(e,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(e.offsetSize),this.schema.isObject(e)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=e:this._nodeToSelect=null,this._filterAttributesOf.push(e);}},{key:"_setAffectedBoundaries",value:function _setAffectedBoundaries(e){this._affectedStart||(this._affectedStart=su.fromPosition(e,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(e)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=su.fromPosition(e,"toNext"));}},{key:"_mergeOnLeft",value:function _mergeOnLeft(){var e=this._firstNode;if(!(e instanceof ql))return;if(!this._canMergeLeft(e))return;var t=su._createBefore(e);t.stickiness="toNext";var i=su.fromPosition(this.position,"toNext");this._affectedStart.isEqual(t)&&(this._affectedStart.detach(),this._affectedStart=su._createAt(t.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=su._createAt(t.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach();}},{key:"_mergeOnRight",value:function _mergeOnRight(){var e=this._lastNode;if(!(e instanceof ql))return;if(!this._canMergeRight(e))return;var t=su._createAfter(e);if(t.stickiness="toNext",!this.position.isEqual(t))throw new A("insertcontent-invalid-insertion-position",this);this.position=Zl._createAt(t.nodeBefore,"end");var i=su.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(t)&&(this._affectedEnd.detach(),this._affectedEnd=su._createAt(t.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=t.nodeBefore,this._lastNode=t.nodeBefore),this.writer.merge(t),t.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=su._createAt(t.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),t.detach();}},{key:"_canMergeLeft",value:function _canMergeLeft(e){var t=e.previousSibling;return t instanceof ql&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(t,e);}},{key:"_canMergeRight",value:function _canMergeRight(e){var t=e.nextSibling;return t instanceof ql&&this.canMergeWith.has(t)&&this.model.schema.checkMerge(e,t);}},{key:"_insertAutoParagraph",value:function _insertAutoParagraph(){this._insertPartialFragment();var e=this.writer.createElement("paragraph");this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0);}},{key:"_checkAndSplitToAllowedPosition",value:function _checkAndSplitToAllowedPosition(e){var t=this._getAllowedIn(this.position.parent,e);if(!t)return!1;for(t!=this.position.parent&&this._insertPartialFragment();t!=this.position.parent;)if(this.position.isAtStart){var _e329=this.position.parent;this.position=this.writer.createPositionBefore(_e329),_e329.isEmpty&&_e329.parent===t&&this.writer.remove(_e329);}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{var _e330=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=_e330,this.canMergeWith.add(this.position.nodeAfter);}return this.schema.checkChild(this.position.parent,e)||this._insertAutoParagraph(),!0;}},{key:"_getAllowedIn",value:function _getAllowedIn(e,t){return this.schema.checkChild(e,t)||this.schema.checkChild(e,"paragraph")&&this.schema.checkChild("paragraph",t)?e:this.schema.isLimit(e)?null:this._getAllowedIn(e.parent,t);}}]);}();function Lu(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(!e.schema.isObject(t))throw new A("insertobject-element-not-an-object",e,{object:t});var s=i||e.document.selection;var o=s;n.findOptimalPosition&&e.schema.isBlock(t)&&(o=e.createSelection(e.schema.findOptimalInsertionRange(s,n.findOptimalPosition)));var r=wr(s.getSelectedBlocks()),a={};return r&&Object.assign(a,e.schema.getAttributesWithProperty(r,"copyOnReplace",!0)),e.change(function(i){o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0});var s=t;var r=o.anchor.parent;!e.schema.checkChild(r,t)&&e.schema.checkChild(r,"paragraph")&&e.schema.checkChild("paragraph",t)&&(s=i.createElement("paragraph"),i.insert(t,s)),e.schema.setAllowedAttributes(s,a,i);var l=e.insertContent(s,o);return l.isCollapsed||n.setSelection&&function(e,t,i,n){var s=e.model;if("on"==i)return void e.setSelection(t,"on");if("after"!=i)throw new A("insertobject-invalid-place-parameter-value",s);var o=t.nextSibling;if(s.schema.isInline(t))return void e.setSelection(t,"after");var r=o&&s.schema.checkChild(o,"$text");!r&&s.schema.checkChild(t.parent,"paragraph")&&(o=e.createElement("paragraph"),s.schema.setAllowedAttributes(o,n,e),s.insertContent(o,e.createPositionAfter(t)));o&&e.setSelection(o,0);}(i,t,n.setSelection,a),l;});}function Fu(e,t){var i=e.isForward,n=e.walker,s=e.unit,o=e.schema,r=e.treatEmojiAsSingleUnit,a=t.type,l=t.item,c=t.nextPosition;if("text"==a)return"word"===e.unit?function(e,t){var i=e.position.textNode;i||(i=t?e.position.nodeAfter:e.position.nodeBefore);for(;i&&i.is("$text");){var _n134=e.position.offset-i.startOffset;if(zu(i,_n134,t))i=t?e.position.nodeAfter:e.position.nodeBefore;else{if(Du(i.data,_n134,t))break;e.next();}}return e.position;}(n,i):function(e,t,i){var n=e.position.textNode;if(n){var _s93=n.data;var _o48=e.position.offset-n.startOffset;for(;Br(_s93,_o48)||"character"==t&&Mr(_s93,_o48)||i&&Fr(_s93,_o48);)e.next(),_o48=e.position.offset-n.startOffset;}return e.position;}(n,s,r);if(a==(i?"elementStart":"elementEnd")){if(o.isSelectable(l))return Zl._createAt(l,i?"after":"before");if(o.checkChild(c,"$text"))return c;}else{if(o.isLimit(l))return void n.skip(function(){return!0;});if(o.checkChild(c,"$text"))return c;}}function Nu(e,t){var i=e.root,n=Zl._createAt(i,t?"end":0);return t?new tc(e,n):new tc(n,e);}function Du(e,t,i){var n=t+(i?0:-1);return' ,.?!:;"-()'.includes(e.charAt(n));}function zu(e,t,i){return t===(i?e.offsetSize:0);}var Hu=/*#__PURE__*/function(_Zs9){function Hu(){var _this120;_classCallCheck(this,Hu);_this120=_callSuper(this,Hu),_defineProperty(_assertThisInitialized(_this120),"markers",void 0),_defineProperty(_assertThisInitialized(_this120),"document",void 0),_defineProperty(_assertThisInitialized(_this120),"schema",void 0),_defineProperty(_assertThisInitialized(_this120),"_pendingChanges",void 0),_defineProperty(_assertThisInitialized(_this120),"_currentWriter",void 0),_this120.markers=new wu(),_this120.document=new pu(_assertThisInitialized(_this120)),_this120.schema=new nd(),_this120._pendingChanges=[],_this120._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(function(e){return _this120.decorate(e);}),_this120.on("applyOperation",function(e,t){t[0]._validate();},{priority:"highest"}),_this120.schema.register("$root",{isLimit:!0}),_this120.schema.register("$container",{allowIn:["$root","$container"]}),_this120.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),_this120.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),_this120.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),_this120.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),_this120.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),_this120.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),_this120.schema.register("$marker"),_this120.schema.addChildCheck(function(){return!0;},"$marker"),Zc(_assertThisInitialized(_this120)),_this120.document.registerPostFixer(Dc),_this120.on("insertContent",function(e,_ref41){var _ref42=_slicedToArray(_ref41,2),t=_ref42[0],i=_ref42[1];e["return"]=function(e,t,i){return e.change(function(n){var s=i||e.document.selection;s.isCollapsed||e.deleteContent(s,{doNotAutoparagraph:!0});var o=new Mu(e,n,s.anchor),r=[];var a;if(t.is("documentFragment")){if(t.markers.size){var _e331=[];var _iterator312=_createForOfIteratorHelper(t.markers),_step312;try{for(_iterator312.s();!(_step312=_iterator312.n()).done;){var _step312$value=_slicedToArray(_step312.value,2),_i252=_step312$value[0],_n135=_step312$value[1];var _t201=_n135.start,_s95=_n135.end,_o50=_t201.isEqual(_s95);_e331.push({position:_t201,name:_i252,isCollapsed:_o50},{position:_s95,name:_i252,isCollapsed:_o50});}}catch(err){_iterator312.e(err);}finally{_iterator312.f();}_e331.sort(function(_ref43,_ref44){var e=_ref43.position;var t=_ref44.position;return e.isBefore(t)?1:-1;});for(var _i250=0,_e332=_e331;_i250<_e332.length;_i250++){var _e332$_i=_e332[_i250],_i251=_e332$_i.position,_s94=_e332$_i.name,_o49=_e332$_i.isCollapsed;var _e333=null,_a15=null;var _l11=_i251.parent===t&&_i251.isAtStart,_c10=_i251.parent===t&&_i251.isAtEnd;_l11||_c10?_o49&&(_a15=_l11?"start":"end"):(_e333=n.createElement("$marker"),n.insert(_e333,_i251)),r.push({name:_s94,element:_e333,collapsed:_a15});}}a=t.getChildren();}else a=[t];o.handleNodes(a);var l=o.getSelectionRange();if(t.is("documentFragment")&&r.length){var _e334=l?fc.fromRange(l):null,_t202={};for(var _e335=r.length-1;_e335>=0;_e335--){var _r$_e=r[_e335],_i253=_r$_e.name,_s96=_r$_e.element,_a16=_r$_e.collapsed,_l12=!_t202[_i253];if(_l12&&(_t202[_i253]=[]),_s96){var _e336=n.createPositionAt(_s96,"before");_t202[_i253].push(_e336),n.remove(_s96);}else{var _e337=o.getAffectedRange();if(!_e337){_a16&&_t202[_i253].push(o.position);continue;}_a16?_t202[_i253].push(_e337[_a16]):_t202[_i253].push(_l12?_e337.start:_e337.end);}}for(var _i254=0,_Object$entries3=Object.entries(_t202);_i254<_Object$entries3.length;_i254++){var _Object$entries3$_i=_slicedToArray(_Object$entries3[_i254],2),_e338=_Object$entries3$_i[0],_Object$entries3$_i$=_slicedToArray(_Object$entries3$_i[1],2),_i255=_Object$entries3$_i$[0],_s97=_Object$entries3$_i$[1];_i255&&_s97&&_i255.root===_s97.root&&_i255.root.document&&!n.model.markers.has(_e338)&&n.addMarker(_e338,{usingOperation:!0,affectsData:!0,range:new tc(_i255,_s97)});}_e334&&(l=_e334.toRange(),_e334.detach());}l&&(s instanceof _c?n.setSelection(l):s.setTo(l));var c=o.getAffectedRange()||e.createRange(s.anchor);return o.destroy(),c;});}(_assertThisInitialized(_this120),t,i);}),_this120.on("insertObject",function(e,_ref45){var _ref46=_slicedToArray(_ref45,3),t=_ref46[0],i=_ref46[1],n=_ref46[2];e["return"]=Lu(_assertThisInitialized(_this120),t,i,n);}),_this120.on("canEditAt",function(e){var t=!_this120.document.isReadOnly;e["return"]=t,t||e.stop();});return _this120;}_inherits(Hu,_Zs9);return _createClass(Hu,[{key:"change",value:function change(e){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new au(),callback:e}),this._runPendingChanges()[0]):e(this._currentWriter);}catch(e){A.rethrowUnexpectedError(e,this);}}},{key:"enqueueChange",value:function enqueueChange(e,t){try{e?"function"==typeof e?(t=e,e=new au()):e instanceof au||(e=new au(e)):e=new au(),this._pendingChanges.push({batch:e,callback:t}),1==this._pendingChanges.length&&this._runPendingChanges();}catch(e){A.rethrowUnexpectedError(e,this);}}},{key:"applyOperation",value:function applyOperation(e){e._execute();}},{key:"insertContent",value:function insertContent(e,t,i){var s=$u(t,i);for(var _len31=arguments.length,n=new Array(_len31>3?_len31-3:0),_key31=3;_key31<_len31;_key31++){n[_key31-3]=arguments[_key31];}return this.fire("insertContent",[e,s,i].concat(n));}},{key:"insertObject",value:function insertObject(e,t,i,n){var o=$u(t,i);for(var _len32=arguments.length,s=new Array(_len32>4?_len32-4:0),_key32=4;_key32<_len32;_key32++){s[_key32-4]=arguments[_key32];}return this.fire("insertObject",[e,o,n,n].concat(s));}},{key:"deleteContent",value:function deleteContent(e,t){Pu(this,e,t);}},{key:"modifySelection",value:function modifySelection(e,t){!function(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=e.schema,s="backward"!=i.direction,o=i.unit?i.unit:"character",r=!!i.treatEmojiAsSingleUnit,a=t.focus,l=new Gl({boundaries:Nu(a,s),singleCharacters:!0,direction:s?"forward":"backward"}),c={walker:l,schema:n,isForward:s,unit:o,treatEmojiAsSingleUnit:r};var d;var _loop3=function _loop3(){if(d.done)return{v:void 0};var i=Fu(c,d.value);if(i)return{v:void(t instanceof _c?e.change(function(e){e.setSelectionFocus(i);}):t.setFocus(i))};},_ret;for(;d=l.next();){_ret=_loop3();if(_ret)return _ret.v;}}(this,e,t);}},{key:"getSelectedContent",value:function getSelectedContent(e){return function(e,t){return e.change(function(e){var i=e.createDocumentFragment(),n=t.getFirstRange();if(!n||n.isCollapsed)return i;var s=n.start.root,o=n.start.getCommonPath(n.end),r=s.getNodeByPath(o);var a;a=n.start.parent==n.end.parent?n:e.createRange(e.createPositionAt(r,n.start.path[o.length]),e.createPositionAt(r,n.end.path[o.length]+1));var l=a.end.offset-a.start.offset;var _iterator313=_createForOfIteratorHelper(a.getItems({shallow:!0})),_step313;try{for(_iterator313.s();!(_step313=_iterator313.n()).done;){var _t204=_step313.value;_t204.is("$textProxy")?e.appendText(_t204.data,_t204.getAttributes(),i):e.append(e.cloneElement(_t204,!0),i);}}catch(err){_iterator313.e(err);}finally{_iterator313.f();}if(a!=n){var _t203=n._getTransformedByMove(a.start,e.createPositionAt(i,0),l)[0],_s98=e.createRange(e.createPositionAt(i,0),_t203.start);Bu(e.createRange(_t203.end,e.createPositionAt(i,"end")),e),Bu(_s98,e);}return i;});}(this,e);}},{key:"hasContent",value:function hasContent(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=e instanceof tc?e:tc._createIn(e);if(i.isCollapsed)return!1;var _t$ignoreWhitespaces=t.ignoreWhitespaces,n=_t$ignoreWhitespaces===void 0?!1:_t$ignoreWhitespaces,_t$ignoreMarkers=t.ignoreMarkers,s=_t$ignoreMarkers===void 0?!1:_t$ignoreMarkers;if(!s){var _iterator314=_createForOfIteratorHelper(this.markers.getMarkersIntersectingRange(i)),_step314;try{for(_iterator314.s();!(_step314=_iterator314.n()).done;){var _e339=_step314.value;if(_e339.affectsData)return!0;}}catch(err){_iterator314.e(err);}finally{_iterator314.f();}}var _iterator315=_createForOfIteratorHelper(i.getItems()),_step315;try{for(_iterator315.s();!(_step315=_iterator315.n()).done;){var _e340=_step315.value;if(this.schema.isContent(_e340)){if(!_e340.is("$textProxy"))return!0;if(!n)return!0;if(-1!==_e340.data.search(/\S/))return!0;}}}catch(err){_iterator315.e(err);}finally{_iterator315.f();}return!1;}},{key:"canEditAt",value:function canEditAt(e){var t=$u(e);return this.fire("canEditAt",[t]);}},{key:"createPositionFromPath",value:function createPositionFromPath(e,t,i){return new Zl(e,t,i);}},{key:"createPositionAt",value:function createPositionAt(e,t){return Zl._createAt(e,t);}},{key:"createPositionAfter",value:function createPositionAfter(e){return Zl._createAfter(e);}},{key:"createPositionBefore",value:function createPositionBefore(e){return Zl._createBefore(e);}},{key:"createRange",value:function createRange(e,t){return new tc(e,t);}},{key:"createRangeIn",value:function createRangeIn(e){return tc._createIn(e);}},{key:"createRangeOn",value:function createRangeOn(e){return tc._createOn(e);}},{key:"createSelection",value:function createSelection(){for(var _len33=arguments.length,e=new Array(_len33),_key33=0;_key33<_len33;_key33++){e[_key33]=arguments[_key33];}return _construct(lc,e);}},{key:"createBatch",value:function createBatch(e){return new au(e);}},{key:"createOperationFromJSON",value:function createOperationFromJSON(e){return jd.fromJSON(e,this.document);}},{key:"destroy",value:function destroy(){this.document.destroy(),this.stopListening();}},{key:"_runPendingChanges",value:function _runPendingChanges(){var e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){var _t205=this._pendingChanges[0].batch;this._currentWriter=new ku(this,_t205);var _i256=this._pendingChanges[0].callback(this._currentWriter);e.push(_i256),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null;}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges");}return e;}}]);}(Zs());function $u(e,t){if(e)return e instanceof lc||e instanceof _c?e:e instanceof $l?t||0===t?new lc(e,t):e.is("rootElement")?new lc(e,"in"):new lc(e,"on"):new lc(e);}var Uu=/*#__PURE__*/function(_Tl6){function Uu(){var _this121;_classCallCheck(this,Uu);for(var _len34=arguments.length,args=new Array(_len34),_key34=0;_key34<_len34;_key34++){args[_key34]=arguments[_key34];}_this121=_callSuper(this,Uu,[].concat(args));_defineProperty(_this121,"domEventType","click");return _this121;}_inherits(Uu,_Tl6);return _createClass(Uu,[{key:"onDomEvent",value:function onDomEvent(e){this.fire(e.type,e);}}]);}(Tl);var Wu=/*#__PURE__*/function(_Tl7){function Wu(){var _this122;_classCallCheck(this,Wu);for(var _len35=arguments.length,args=new Array(_len35),_key35=0;_key35<_len35;_key35++){args[_key35]=arguments[_key35];}_this122=_callSuper(this,Wu,[].concat(args));_defineProperty(_this122,"domEventType",["mousedown","mouseup","mouseover","mouseout"]);return _this122;}_inherits(Wu,_Tl7);return _createClass(Wu,[{key:"onDomEvent",value:function onDomEvent(e){this.fire(e.type,e);}}]);}(Tl);var ju=/*#__PURE__*/function(){function ju(e){_classCallCheck(this,ju);_defineProperty(this,"document",void 0);this.document=e;}return _createClass(ju,[{key:"createDocumentFragment",value:function createDocumentFragment(e){return new ja(this.document,e);}},{key:"createElement",value:function createElement(e,t,i){return new ga(this.document,e,t,i);}},{key:"createText",value:function createText(e){return new oa(this.document,e);}},{key:"clone",value:function clone(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return e._clone(t);}},{key:"appendChild",value:function appendChild(e,t){return t._appendChild(e);}},{key:"insertChild",value:function insertChild(e,t,i){return i._insertChild(e,t);}},{key:"removeChildren",value:function removeChildren(e,t,i){return i._removeChildren(e,t);}},{key:"remove",value:function remove(e){var t=e.parent;return t?this.removeChildren(t.getChildIndex(e),1,t):[];}},{key:"replace",value:function replace(e,t){var i=e.parent;if(i){var _n136=i.getChildIndex(e);return this.removeChildren(_n136,1,i),this.insertChild(_n136,t,i),!0;}return!1;}},{key:"unwrapElement",value:function unwrapElement(e){var t=e.parent;if(t){var _i257=t.getChildIndex(e);this.remove(e),this.insertChild(_i257,e.getChildren(),t);}}},{key:"rename",value:function rename(e,t){var i=new ga(this.document,e,t.getAttributes(),t.getChildren());return this.replace(t,i)?i:null;}},{key:"setAttribute",value:function setAttribute(e,t,i){i._setAttribute(e,t);}},{key:"removeAttribute",value:function removeAttribute(e,t){t._removeAttribute(e);}},{key:"addClass",value:function addClass(e,t){t._addClass(e);}},{key:"removeClass",value:function removeClass(e,t){t._removeClass(e);}},{key:"setStyle",value:function setStyle(e,t,i){ei(e)&&void 0===i?t._setStyle(e):i._setStyle(e,t);}},{key:"removeStyle",value:function removeStyle(e,t){t._removeStyle(e);}},{key:"setCustomProperty",value:function setCustomProperty(e,t,i){i._setCustomProperty(e,t);}},{key:"removeCustomProperty",value:function removeCustomProperty(e,t){return t._removeCustomProperty(e);}},{key:"createPositionAt",value:function createPositionAt(e,t){return ka._createAt(e,t);}},{key:"createPositionAfter",value:function createPositionAfter(e){return ka._createAfter(e);}},{key:"createPositionBefore",value:function createPositionBefore(e){return ka._createBefore(e);}},{key:"createRange",value:function createRange(e,t){return new Ca(e,t);}},{key:"createRangeOn",value:function createRangeOn(e){return Ca._createOn(e);}},{key:"createRangeIn",value:function createRangeIn(e){return Ca._createIn(e);}},{key:"createSelection",value:function createSelection(){for(var _len36=arguments.length,e=new Array(_len36),_key36=0;_key36<_len36;_key36++){e[_key36]=arguments[_key36];}return _construct(Aa,e);}}]);}();var qu=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Gu=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,Ku=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Zu=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,Ju=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Qu=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,Yu=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function Xu(e){return e.startsWith("#")?qu.test(e):e.startsWith("rgb")?Gu.test(e)||Ku.test(e):e.startsWith("hsl")?Zu.test(e)||Ju.test(e):Yu.has(e.toLowerCase());}var eh=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function th(e){return eh.includes(e);}var ih=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function nh(e){return ih.test(e);}var sh=/^[+-]?[0-9]*([.][0-9]+)?%$/;function oh(e){return sh.test(e);}var rh=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function ah(e){return rh.includes(e);}var lh=["center","top","bottom","left","right"];function ch(e){return lh.includes(e);}var dh=["fixed","scroll","local"];function uh(e){return dh.includes(e);}var hh=/^url\(/;function mh(e){return hh.test(e);}function gh(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"";if(""===e)return{top:void 0,right:void 0,bottom:void 0,left:void 0};var t=wh(e),i=t[0],n=t[2]||i,s=t[1]||i;return{top:i,bottom:n,right:s,left:t[3]||s};}function fh(e){return function(t){var i=t.top,n=t.right,s=t.bottom,o=t.left,r=[];return[i,n,o,s].every(function(e){return!!e;})?r.push([e,ph(t)]):(i&&r.push([e+"-top",i]),n&&r.push([e+"-right",n]),s&&r.push([e+"-bottom",s]),o&&r.push([e+"-left",o])),r;};}function ph(_ref47){var e=_ref47.top,t=_ref47.right,i=_ref47.bottom,n=_ref47.left;var s=[];return n!==t?s.push(e,t,i,n):i!==e?s.push(e,t,i):t!==e?s.push(e,t):s.push(e),s.join(" ");}function bh(e){return function(t){return{path:e,value:gh(t)};};}function wh(e){var t=e.trim().slice(0,1500).matchAll(Qu);return Array.from(t).map(function(e){return e[0];});}function _h(e){e.setNormalizer("background",function(e){var t={},i=wh(e);var _iterator316=_createForOfIteratorHelper(i),_step316;try{for(_iterator316.s();!(_step316=_iterator316.n()).done;){var _e341=_step316.value;ah(_e341)?(t.repeat=t.repeat||[],t.repeat.push(_e341)):ch(_e341)?(t.position=t.position||[],t.position.push(_e341)):uh(_e341)?t.attachment=_e341:Xu(_e341)?t.color=_e341:mh(_e341)&&(t.image=_e341);}}catch(err){_iterator316.e(err);}finally{_iterator316.f();}return{path:"background",value:t};}),e.setNormalizer("background-color",function(e){return{path:"background.color",value:e};}),e.setReducer("background",function(e){var t=[];return t.push(["background-color",e.color]),t;}),e.setStyleRelation("background",["background-color"]);}function vh(e){e.setNormalizer("border",function(e){var _Th=Th(e),t=_Th.color,i=_Th.style,n=_Th.width;return{path:"border",value:{color:gh(t),style:gh(i),width:gh(n)}};}),e.setNormalizer("border-top",yh("top")),e.setNormalizer("border-right",yh("right")),e.setNormalizer("border-bottom",yh("bottom")),e.setNormalizer("border-left",yh("left")),e.setNormalizer("border-color",kh("color")),e.setNormalizer("border-width",kh("width")),e.setNormalizer("border-style",kh("style")),e.setNormalizer("border-top-color",xh("color","top")),e.setNormalizer("border-top-style",xh("style","top")),e.setNormalizer("border-top-width",xh("width","top")),e.setNormalizer("border-right-color",xh("color","right")),e.setNormalizer("border-right-style",xh("style","right")),e.setNormalizer("border-right-width",xh("width","right")),e.setNormalizer("border-bottom-color",xh("color","bottom")),e.setNormalizer("border-bottom-style",xh("style","bottom")),e.setNormalizer("border-bottom-width",xh("width","bottom")),e.setNormalizer("border-left-color",xh("color","left")),e.setNormalizer("border-left-style",xh("style","left")),e.setNormalizer("border-left-width",xh("width","left")),e.setExtractor("border-top",Ah("top")),e.setExtractor("border-right",Ah("right")),e.setExtractor("border-bottom",Ah("bottom")),e.setExtractor("border-left",Ah("left")),e.setExtractor("border-top-color","border.color.top"),e.setExtractor("border-right-color","border.color.right"),e.setExtractor("border-bottom-color","border.color.bottom"),e.setExtractor("border-left-color","border.color.left"),e.setExtractor("border-top-width","border.width.top"),e.setExtractor("border-right-width","border.width.right"),e.setExtractor("border-bottom-width","border.width.bottom"),e.setExtractor("border-left-width","border.width.left"),e.setExtractor("border-top-style","border.style.top"),e.setExtractor("border-right-style","border.style.right"),e.setExtractor("border-bottom-style","border.style.bottom"),e.setExtractor("border-left-style","border.style.left"),e.setReducer("border-color",fh("border-color")),e.setReducer("border-style",fh("border-style")),e.setReducer("border-width",fh("border-width")),e.setReducer("border-top",Ph("top")),e.setReducer("border-right",Ph("right")),e.setReducer("border-bottom",Ph("bottom")),e.setReducer("border-left",Ph("left")),e.setReducer("border",function(){return function(t){var i=Eh(t,"top"),n=Eh(t,"right"),s=Eh(t,"bottom"),o=Eh(t,"left"),r=[i,n,s,o],a={width:e(r,"width"),style:e(r,"style"),color:e(r,"color")},l=Sh(a,"all");if(l.length)return l;var c=Object.entries(a).reduce(function(e,_ref48){var _ref49=_slicedToArray(_ref48,2),t=_ref49[0],i=_ref49[1];return i&&(e.push(["border-".concat(t),i]),r.forEach(function(e){return delete e[t];})),e;},[]);return[].concat(_toConsumableArray(c),_toConsumableArray(Sh(i,"top")),_toConsumableArray(Sh(n,"right")),_toConsumableArray(Sh(s,"bottom")),_toConsumableArray(Sh(o,"left")));};function e(e,t){return e.map(function(e){return e[t];}).reduce(function(e,t){return e==t?e:null;});}}()),e.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),e.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),e.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),e.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),e.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),e.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),e.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"]);}function yh(e){return function(t){var _Th2=Th(t),i=_Th2.color,n=_Th2.style,s=_Th2.width,o={};return void 0!==i&&(o.color=_defineProperty({},e,i)),void 0!==n&&(o.style=_defineProperty({},e,n)),void 0!==s&&(o.width=_defineProperty({},e,s)),{path:"border",value:o};};}function kh(e){return function(t){return{path:"border",value:Ch(t,e)};};}function Ch(e,t){return _defineProperty({},t,gh(e));}function xh(e,t){return function(i){return{path:"border",value:_defineProperty({},e,_defineProperty({},t,i))};};}function Ah(e){return function(t,i){if(i.border)return Eh(i.border,e);};}function Eh(e,t){var i={};return e.width&&e.width[t]&&(i.width=e.width[t]),e.style&&e.style[t]&&(i.style=e.style[t]),e.color&&e.color[t]&&(i.color=e.color[t]),i;}function Th(e){var t={},i=wh(e);var _iterator317=_createForOfIteratorHelper(i),_step317;try{for(_iterator317.s();!(_step317=_iterator317.n()).done;){var _e343=_step317.value;nh(_e343)||/thin|medium|thick/.test(_e343)?t.width=_e343:th(_e343)?t.style=_e343:t.color=_e343;}}catch(err){_iterator317.e(err);}finally{_iterator317.f();}return t;}function Ph(e){return function(t){return Sh(t,e);};}function Sh(e,t){var i=[];if(e&&e.width&&i.push("width"),e&&e.style&&i.push("style"),e&&e.color&&i.push("color"),3==i.length){var _n137=i.map(function(t){return e[t];}).join(" ");return["all"==t?["border",_n137]:["border-".concat(t),_n137]];}return"all"==t?[]:i.map(function(i){return["border-".concat(t,"-").concat(i),e[i]];});}function Ih(e){e.setNormalizer("margin",bh("margin")),e.setNormalizer("margin-top",function(e){return{path:"margin.top",value:e};}),e.setNormalizer("margin-right",function(e){return{path:"margin.right",value:e};}),e.setNormalizer("margin-bottom",function(e){return{path:"margin.bottom",value:e};}),e.setNormalizer("margin-left",function(e){return{path:"margin.left",value:e};}),e.setReducer("margin",fh("margin")),e.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"]);}function Vh(e){e.setNormalizer("padding",bh("padding")),e.setNormalizer("padding-top",function(e){return{path:"padding.top",value:e};}),e.setNormalizer("padding-right",function(e){return{path:"padding.right",value:e};}),e.setNormalizer("padding-bottom",function(e){return{path:"padding.bottom",value:e};}),e.setNormalizer("padding-left",function(e){return{path:"padding.left",value:e};}),e.setReducer("padding",fh("padding")),e.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"]);}var Rh="[",Oh="]",Bh="{",Mh="}",Lh={container:pa,attribute:Ma,empty:Na,ui:za,raw:Ua},Fh={setContentOf:function setContentOf(e,t){e.innerHTML=t;}};function Nh(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!(e instanceof zl))throw new TypeError("View needs to be an instance of module:engine/view/view~View.");var i=e.document,n=!!t.withoutSelection,s=t.rootName||"main",o=i.getRoot(s),r={showType:t.showType,showPriority:t.showPriority,renderUIElements:t.renderUIElements,renderRawElements:t.renderRawElements,ignoreRoot:!0,domConverter:t.domConverter};return n?Nh._stringify(o,null,r):Nh._stringify(o,i.selection,r);}function Dh(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!(e instanceof zl))throw new TypeError("View needs to be an instance of module:engine/view/view~View.");var n=e.document,s=i.rootName||"main",o=n.getRoot(s);e.change(function(e){var i=Dh._parse(t,{rootElement:o});i.view&&i.selection&&e.setSelection(i.selection);});}function zh(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n;n=t instanceof ka||t instanceof Ca?new Ea(t):t;return new Uh(e,n,i).stringify();}function Hh(e){var _s$domConverter$inlin;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=new Ba(new ua());t.order=t.order||[];var n=new $h({sameSelectionCharacters:t.sameSelectionCharacters}),s=new Ad(i,{namespaces:Object.keys(Lh)});t.inlineObjectElements&&(_s$domConverter$inlin=s.domConverter.inlineObjectElements).push.apply(_s$domConverter$inlin,_toConsumableArray(t.inlineObjectElements));var o=s.toView(e);if(o=Wh(o),t.rootElement){var _e344=t.rootElement,_i258=o._removeChildren(0,o.childCount);_e344._removeChildren(0,_e344.childCount),_e344._appendChild(_i258),o=_e344;}var r=n.parse(o,t.order);if(o.is("documentFragment")&&1===o.childCount&&(o=o.getChild(0)),r.length){return{view:o,selection:new Ea(r,{backward:!!t.lastRangeBackward})};}return o.parent&&o._remove(),o;}Nh._stringify=zh,Dh._parse=Hh;var $h=/*#__PURE__*/function(){function $h(e){_classCallCheck(this,$h);_defineProperty(this,"sameSelectionCharacters",void 0);_defineProperty(this,"_positions",void 0);this.sameSelectionCharacters=!!e.sameSelectionCharacters;}return _createClass($h,[{key:"parse",value:function parse(e,t){this._positions=[],this._getPositions(e);var i=this._createRanges();if(t.length){if(t.length!=i.length)throw new Error("Parse error - there are ".concat(i.length," ranges found, but ranges order array contains ").concat(t.length," elements."));i=this._sortRanges(i,t);}return i;}},{key:"_getPositions",value:function _getPositions(e){if(e.is("documentFragment")||e.is("element")){var _t206=_toConsumableArray(e.getChildren());var _iterator318=_createForOfIteratorHelper(_t206),_step318;try{for(_iterator318.s();!(_step318=_iterator318.n()).done;){var _e345=_step318.value;this._getPositions(_e345);}}catch(err){_iterator318.e(err);}finally{_iterator318.f();}}if(e.is("$text")){var _t207=new RegExp("[".concat(Bh).concat(Mh,"\\").concat(Oh,"\\").concat(Rh,"]"),"g");var _i259,_n138=e.data,_s99=0;var _o51=[];for(;_i259=_t207.exec(_n138);){var _e346=_i259.index,_t208=_i259[0];_o51.push({bracket:_t208,textOffset:_e346-_s99}),_s99++;}_n138=_n138.replace(_t207,""),e._data=_n138;var _r29=e.index,_a17=e.parent;_n138||e._remove();for(var _i260=0,_o52=_o51;_i260<_o52.length;_i260++){var _t209=_o52[_i260];if(_n138){if(this.sameSelectionCharacters||!this.sameSelectionCharacters&&(_t209.bracket==Bh||_t209.bracket==Mh))this._positions.push({bracket:_t209.bracket,position:new ka(e,_t209.textOffset)});else{if(!this.sameSelectionCharacters&&0!==_t209.textOffset&&_t209.textOffset!==_n138.length)throw new Error("Parse error - range delimiter '".concat(_t209.bracket,"' is placed inside text node."));var _e347=0===_t209.textOffset?_r29:_r29+1;this._positions.push({bracket:_t209.bracket,position:new ka(_a17,_e347)});}}else{if(!this.sameSelectionCharacters&&_t209.bracket==Bh||_t209.bracket==Mh)throw new Error("Parse error - text range delimiter '".concat(_t209.bracket,"' is placed inside empty text node. "));this._positions.push({bracket:_t209.bracket,position:new ka(_a17,_r29)});}}}}},{key:"_sortRanges",value:function _sortRanges(e,t){var i=[];var n=0;var _iterator319=_createForOfIteratorHelper(t),_step319;try{for(_iterator319.s();!(_step319=_iterator319.n()).done;){var _s100=_step319.value;if(void 0===e[_s100-1])throw new Error("Parse error - provided ranges order is invalid.");i[_s100-1]=e[n],n++;}}catch(err){_iterator319.e(err);}finally{_iterator319.f();}return i;}},{key:"_createRanges",value:function _createRanges(){var e=[];var t=null;var _iterator320=_createForOfIteratorHelper(this._positions),_step320;try{for(_iterator320.s();!(_step320=_iterator320.n()).done;){var _i261=_step320.value;if(!t&&(_i261.bracket==Oh||_i261.bracket==Mh))throw new Error("Parse error - end of range was found '".concat(_i261.bracket,"' but range was not started before."));if(t&&(_i261.bracket==Rh||_i261.bracket==Bh))throw new Error("Parse error - start of range was found '".concat(_i261.bracket,"' but one range is already started."));_i261.bracket==Rh||_i261.bracket==Bh?t=new Ca(_i261.position,_i261.position):(t.end=_i261.position,e.push(t),t=null);}}catch(err){_iterator320.e(err);}finally{_iterator320.f();}if(null!==t)throw new Error("Parse error - range was started but no end delimiter was found.");return e;}}]);}();var Uh=/*#__PURE__*/function(){function Uh(e,t,i){_classCallCheck(this,Uh);_defineProperty(this,"root",void 0);_defineProperty(this,"selection",void 0);_defineProperty(this,"ranges",void 0);_defineProperty(this,"showType",void 0);_defineProperty(this,"showPriority",void 0);_defineProperty(this,"showAttributeElementId",void 0);_defineProperty(this,"ignoreRoot",void 0);_defineProperty(this,"sameSelectionCharacters",void 0);_defineProperty(this,"renderUIElements",void 0);_defineProperty(this,"renderRawElements",void 0);_defineProperty(this,"domConverter",void 0);this.root=e,this.selection=t,this.ranges=[],t&&(this.ranges=_toConsumableArray(t.getRanges())),this.showType=!!i.showType,this.showPriority=!!i.showPriority,this.showAttributeElementId=!!i.showAttributeElementId,this.ignoreRoot=!!i.ignoreRoot,this.sameSelectionCharacters=!!i.sameSelectionCharacters,this.renderUIElements=!!i.renderUIElements,this.renderRawElements=!!i.renderRawElements,this.domConverter=i.domConverter||Fh;}return _createClass(Uh,[{key:"stringify",value:function stringify(){var e="";return this._walkView(this.root,function(t){e+=t;}),e;}},{key:"_walkView",value:function _walkView(e,t){var i=this.ignoreRoot&&this.root===e;if(e.is("element")||e.is("documentFragment")){if(e.is("element")&&!i&&t(this._stringifyElementOpen(e)),this.renderUIElements&&e.is("uiElement"))t(e.render(document,this.domConverter).innerHTML);else if(this.renderRawElements&&e.is("rawElement")){var _i262=document.createElement("div");e.render(_i262,this.domConverter),t(_i262.innerHTML);}else{var _i263=0;t(this._stringifyElementRanges(e,_i263));var _iterator321=_createForOfIteratorHelper(e.getChildren()),_step321;try{for(_iterator321.s();!(_step321=_iterator321.n()).done;){var _n139=_step321.value;this._walkView(_n139,t),_i263++,t(this._stringifyElementRanges(e,_i263));}}catch(err){_iterator321.e(err);}finally{_iterator321.f();}}e.is("element")&&!i&&t(this._stringifyElementClose(e));}e.is("$text")&&t(this._stringifyTextRanges(e));}},{key:"_stringifyElementRanges",value:function _stringifyElementRanges(e,t){var i="",n="",s="";var _iterator322=_createForOfIteratorHelper(this.ranges),_step322;try{for(_iterator322.s();!(_step322=_iterator322.n()).done;){var _o53=_step322.value;_o53.start.parent==e&&_o53.start.offset===t&&(_o53.isCollapsed?s+=Rh+Oh:i+=Rh),_o53.end.parent!==e||_o53.end.offset!==t||_o53.isCollapsed||(n+=Oh);}}catch(err){_iterator322.e(err);}finally{_iterator322.f();}return n+s+i;}},{key:"_stringifyTextRanges",value:function _stringifyTextRanges(e){var t=e.data.length,i=e.data.split("");var n,s;this.sameSelectionCharacters?(n=Rh,s=Oh):(n=Bh,s=Mh),i[t]="";var o=i.map(function(e){return{letter:e,start:"",end:"",collapsed:""};});var _iterator323=_createForOfIteratorHelper(this.ranges),_step323;try{for(_iterator323.s();!(_step323=_iterator323.n()).done;){var _i264=_step323.value;var _r30=_i264.start,_a18=_i264.end;_r30.parent==e&&_r30.offset>=0&&_r30.offset<=t&&(_i264.isCollapsed?o[_a18.offset].collapsed+=n+s:o[_r30.offset].start+=n),_a18.parent==e&&_a18.offset>=0&&_a18.offset<=t&&!_i264.isCollapsed&&(o[_a18.offset].end+=s);}}catch(err){_iterator323.e(err);}finally{_iterator323.f();}return o.map(function(e){return e.end+e.collapsed+e.start+e.letter;}).join("");}},{key:"_stringifyElementOpen",value:function _stringifyElementOpen(e){var t=this._stringifyElementPriority(e),i=this._stringifyElementId(e);return"<".concat([[this._stringifyElementType(e),e.name].filter(function(e){return""!==e;}).join(":"),t,i,this._stringifyElementAttributes(e)].filter(function(e){return""!==e;}).join(" "),">");}},{key:"_stringifyElementClose",value:function _stringifyElementClose(e){return"</".concat([this._stringifyElementType(e),e.name].filter(function(e){return""!==e;}).join(":"),">");}},{key:"_stringifyElementType",value:function _stringifyElementType(e){if(this.showType)for(var _t210 in Lh)if(e instanceof Lh[_t210])return _t210;return"";}},{key:"_stringifyElementPriority",value:function _stringifyElementPriority(e){return this.showPriority&&e.is("attributeElement")?"view-priority=\"".concat(e.priority,"\""):"";}},{key:"_stringifyElementId",value:function _stringifyElementId(e){return this.showAttributeElementId&&e.is("attributeElement")&&e.id?"view-id=\"".concat(e.id,"\""):"";}},{key:"_stringifyElementAttributes",value:function _stringifyElementAttributes(e){var t=[],i=_toConsumableArray(e.getAttributeKeys()).sort();var _iterator324=_createForOfIteratorHelper(i),_step324;try{for(_iterator324.s();!(_step324=_iterator324.n()).done;){var _n140=_step324.value;var _i265=void 0;_i265="class"===_n140?_toConsumableArray(e.getClassNames()).sort().join(" "):"style"===_n140?_toConsumableArray(e.getStyleNames()).sort().map(function(t){return"".concat(t,":").concat(e.getStyle(t).replace(/"/g,"&quot;"));}).join(";"):e.getAttribute(_n140),t.push("".concat(_n140,"=\"").concat(_i265,"\""));}}catch(err){_iterator324.e(err);}finally{_iterator324.f();}return t.join(" ");}}]);}();function Wh(e){if(e.is("element")||e.is("documentFragment")){var _t211=e.is("documentFragment")?new ja(e.document):function(e,t){var i=function(e){var t=e.name.split(":"),i=function(e){var t=parseInt(e,10);if(!isNaN(t))return t;return null;}(e.getAttribute("view-priority")),n=e.hasAttribute("view-id")?e.getAttribute("view-id"):null;if(e._removeAttribute("view-priority"),e._removeAttribute("view-id"),1==t.length)return{name:t[0],type:null!==i?"attribute":null,priority:i,id:n};var s=function(e){return e in Lh?e:null;}(t[0]);if(s)return{name:t[1],type:s,priority:i,id:n};throw new Error("Parse error - cannot parse element's name: ".concat(e.name,"."));}(t),n=Lh[i.type],s=n?new n(e,i.name):new ga(e,i.name);s.is("attributeElement")&&(null!==i.priority&&(s._priority=i.priority),null!==i.id&&(s._id=i.id));var _iterator325=_createForOfIteratorHelper(t.getAttributeKeys()),_step325;try{for(_iterator325.s();!(_step325=_iterator325.n()).done;){var _e348=_step325.value;s._setAttribute(_e348,t.getAttribute(_e348));}}catch(err){_iterator325.e(err);}finally{_iterator325.f();}return s;}(e.document,e);for(var _i266=0,_arr3=_toConsumableArray(e.getChildren());_i266<_arr3.length;_i266++){var _i267=_arr3[_i266];if(_t211.is("emptyElement"))throw new Error("Parse error - cannot parse inside EmptyElement.");if(_t211.is("uiElement"))throw new Error("Parse error - cannot parse inside UIElement.");if(_t211.is("rawElement"))throw new Error("Parse error - cannot parse inside RawElement.");_t211._appendChild(Wh(_i267));}return _t211;}return e;}function jh(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!(e instanceof Hu))throw new TypeError("Model needs to be an instance of module:engine/model/model~Model.");var i=t.rootName||"main",n=e.document.getRoot(i);return jh._stringify(n,t.withoutSelection?null:e.document.selection,t.convertMarkers?e.markers:null);}function qh(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!(e instanceof Hu))throw new TypeError("Model needs to be an instance of module:engine/model/model~Model.");var n,s=null;var o=e.document.getRoot(i.rootName||"main"),r=qh._parse(t,e.schema,{lastRangeBackward:i.lastRangeBackward,selectionAttributes:i.selectionAttributes,context:[o.name],inlineObjectElements:i.inlineObjectElements});function a(t){if(t.remove(t.createRangeIn(o)),t.insert(n,o),t.setSelection(null),t.removeSelectionAttribute(e.document.selection.getAttributeKeys()),s){var _e349=[];var _iterator326=_createForOfIteratorHelper(s.getRanges()),_step326;try{for(_iterator326.s();!(_step326=_iterator326.n()).done;){var _t212=_step326.value;var _i268=new Zl(o,_t212.start.path),_n141=new Zl(o,_t212.end.path);_e349.push(new tc(_i268,_n141));}}catch(err){_iterator326.e(err);}finally{_iterator326.f();}t.setSelection(_e349,{backward:s.isBackward}),i.selectionAttributes&&t.setSelectionAttribute(s.getAttributes());}}"model"in r?(n=r.model,s=r.selection):n=r,void 0!==i.batchType?e.enqueueChange(i.batchType,a):e.change(a);}function Gh(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var n=new Hu(),s=new ic();var o,r=null;if(e instanceof gu||e instanceof yu)o=n.createRangeIn(e);else if(e.parent)o=new tc(n.createPositionBefore(e),n.createPositionAfter(e));else{var _t213=new yu(e);o=n.createRangeIn(_t213);}t instanceof lc||t instanceof _c?r=t:(t instanceof tc||t instanceof Zl)&&(r=new lc(t));var a=new ua(),l=new zl(a),c=l.document,d=new va(c,"div");d.rootName="main",c.roots.add(d);var u=new oc({mapper:s,schema:n.schema});s.bindElements(e.root,d),u.on("insert:$text",function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=i.writer,s=i.mapper.toViewPosition(t.range.start),o=n.createText(t.item.data);n.insert(s,o);}),u.on("insert",function(e,t,i){i.convertAttributes(t.item),t.reconversion||!t.item.is("element")||t.item.isEmpty||i.convertChildren(t.item);},{priority:"lowest"}),u.on("attribute",function(e,t,i){if(t.item instanceof lc||t.item instanceof _c||t.item.is("$textProxy")){var _n142=Ac(function(e,_ref51){var i=_ref51.writer;return i.createAttributeElement("model-text-with-attributes",_defineProperty({},t.attributeKey,Qh(e)));});_n142(e,t,i);}}),u.on("insert",Ec(function(e){var t=Yh(e.getAttributes(),Qh);return new pa(c,e.name,t);})),u.on("selection",function(e,t,i){var n=t.selection;if(n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;var s=[];var _iterator327=_createForOfIteratorHelper(n.getRanges()),_step327;try{for(_iterator327.s();!(_step327=_iterator327.n()).done;){var _e350=_step327.value;s.push(i.mapper.toViewRange(_e350));}}catch(err){_iterator327.e(err);}finally{_iterator327.f();}i.writer.setSelection(s,{backward:n.isBackward});}),u.on("selection",function(e,t,i){var n=t.selection;if(!n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;var s=i.writer,o=n.getFirstPosition(),r=i.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a);}),u.on("addMarker",Tc(function(e,_ref52){var t=_ref52.writer;var i=e.markerName+":"+(e.isOpening?"start":"end");return t.createUIElement(i);}));var h=new Map();if(i){var _iterator328=_createForOfIteratorHelper(Array.from(i).sort(function(e,t){return e.name<t.name?1:-1;})),_step328;try{for(_iterator328.s();!(_step328=_iterator328.n()).done;){var _e351=_step328.value;h.set(_e351.name,_e351.getRange());}}catch(err){_iterator328.e(err);}finally{_iterator328.f();}}var m=l._writer;u.convert(o,h,m),r&&u.convertSelection(r,i||n.markers,m);var g=zh(d,c.selection,{sameSelectionCharacters:!0});return g=g.substr(5,g.length-11),l.destroy(),g.replace(new RegExp("model-text-with-attributes","g"),"$text");}function Kh(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=new ic(),s=Hh(e=e.replace(new RegExp("\\$text","g"),"model-text-with-attributes"),{sameSelectionCharacters:!0,lastRangeBackward:!!i.lastRangeBackward,inlineObjectElements:i.inlineObjectElements});var o,r=null,a=null;"view"in s&&"selection"in s?(o=s.view,r=s.selection):o=s;var l=new Hu(),c=new wd({schema:t});c.on("documentFragment",function(e){return function(t,i,n){var s=n.convertChildren(i.viewItem,i.modelCursor);e.bindElements(i.modelCursor.parent,i.viewItem),i=Object.assign(i,s),t.stop();};}(n)),c.on("element:model-text-with-attributes",Zh()),c.on("element",function(e){return function(t,i,n){var s=i.viewItem.name;if(!n.schema.checkChild(i.modelCursor,s))throw new Error("Element '".concat(s,"' was not allowed in given position."));var o=Yh(i.viewItem.getAttributes(),Jh),r=n.writer.createElement(i.viewItem.name,o);n.writer.insert(r,i.modelCursor),e.bindElements(r,i.viewItem),n.convertChildren(i.viewItem,r),i.modelRange=tc._createOn(r),i.modelCursor=i.modelRange.end,t.stop();};}(n)),c.on("text",Zh());var d=l.change(function(e){return c.convert(o.root,e,i.context||"$root");});if(n.bindElements(d,o.root),1==d.childCount&&(d=d.getChild(0)),r){var _e352=[];var _iterator329=_createForOfIteratorHelper(r.getRanges()),_step329;try{for(_iterator329.s();!(_step329=_iterator329.n()).done;){var _t214=_step329.value;_e352.push(n.toModelRange(_t214));}}catch(err){_iterator329.e(err);}finally{_iterator329.f();}a=new lc(_e352,{backward:r.isBackward});var _iterator330=_createForOfIteratorHelper(xr(i.selectionAttributes||[])),_step330;try{for(_iterator330.s();!(_step330=_iterator330.n()).done;){var _step330$value=_slicedToArray(_step330.value,2),_e353=_step330$value[0],_t215=_step330$value[1];a.setAttribute(_e353,_t215);}}catch(err){_iterator330.e(err);}finally{_iterator330.f();}}return a?{model:d,selection:a}:d;}function Zh(){return function(e,t,i){if(!i.schema.checkChild(t.modelCursor,"$text"))throw new Error("Text was not allowed in given position.");var n;if(t.viewItem.is("element")){var _e354=Yh(t.viewItem.getAttributes(),Jh),_s101=t.viewItem.getChild(0);n=i.writer.createText(_s101.data,_e354);}else n=i.writer.createText(t.viewItem.data);i.writer.insert(n,t.modelCursor),t.modelRange=tc._createFromPositionAndShift(t.modelCursor,n.offsetSize),t.modelCursor=t.modelRange.end,e.stop();};}function Jh(e){try{return JSON.parse(e);}catch(t){return e;}}function Qh(e){return ei(e)?JSON.stringify(e):e;}function Yh(e,t){var _iterator331,_step331,_step331$value,_i269,_n143;return _regeneratorRuntime().wrap(function Yh$(_context34){while(1)switch(_context34.prev=_context34.next){case 0:_iterator331=_createForOfIteratorHelper(e);_context34.prev=1;_iterator331.s();case 3:if((_step331=_iterator331.n()).done){_context34.next=9;break;}_step331$value=_slicedToArray(_step331.value,2),_i269=_step331$value[0],_n143=_step331$value[1];_context34.next=7;return[_i269,t(_n143)];case 7:_context34.next=3;break;case 9:_context34.next=14;break;case 11:_context34.prev=11;_context34.t0=_context34["catch"](1);_iterator331.e(_context34.t0);case 14:_context34.prev=14;_iterator331.f();return _context34.finish(14);case 17:case"end":return _context34.stop();}},_marked3,null,[[1,11,14,17]]);}jh._stringify=Gh,qh._parse=Kh;var Xh=/*#__PURE__*/function(){function Xh(e){var _this123=this;_classCallCheck(this,Xh);_defineProperty(this,"crashes",[]);_defineProperty(this,"state","initializing");_defineProperty(this,"_crashNumberLimit",void 0);_defineProperty(this,"_now",Date.now);_defineProperty(this,"_minimumNonErrorTimePeriod",void 0);_defineProperty(this,"_boundErrorHandler",void 0);_defineProperty(this,"_listeners",void 0);if(this.crashes=[],this._crashNumberLimit="number"==typeof e.crashNumberLimit?e.crashNumberLimit:3,this._minimumNonErrorTimePeriod="number"==typeof e.minimumNonErrorTimePeriod?e.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=function(e){var t="error"in e?e.error:e.reason;t instanceof Error&&_this123._handleError(t,e);},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.");}return _createClass(Xh,[{key:"destroy",value:function destroy(){this._stopErrorHandling(),this._listeners={};}},{key:"on",value:function on(e,t){this._listeners[e]||(this._listeners[e]=[]),this._listeners[e].push(t);}},{key:"off",value:function off(e,t){this._listeners[e]=this._listeners[e].filter(function(e){return e!==t;});}},{key:"_fire",value:function _fire(e){var i=this._listeners[e]||[];for(var _len37=arguments.length,t=new Array(_len37>1?_len37-1:0),_key37=1;_key37<_len37;_key37++){t[_key37-1]=arguments[_key37];}var _iterator332=_createForOfIteratorHelper(i),_step332;try{for(_iterator332.s();!(_step332=_iterator332.n()).done;){var _e355=_step332.value;_e355.apply(this,[null].concat(t));}}catch(err){_iterator332.e(err);}finally{_iterator332.f();}}},{key:"_startErrorHandling",value:function _startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler);}},{key:"_stopErrorHandling",value:function _stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler);}},{key:"_handleError",value:function _handleError(e,t){if(this._shouldReactToError(e)){this.crashes.push({message:e.message,stack:e.stack,filename:t instanceof ErrorEvent?t.filename:void 0,lineno:t instanceof ErrorEvent?t.lineno:void 0,colno:t instanceof ErrorEvent?t.colno:void 0,date:this._now()});var _i270=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:e,causesRestart:_i270}),_i270?this._restart():(this.state="crashedPermanently",this._fire("stateChange"));}}},{key:"_shouldReactToError",value:function _shouldReactToError(e){return e.is&&e.is("CKEditorError")&&void 0!==e.context&&null!==e.context&&"ready"===this.state&&this._isErrorComingFromThisItem(e);}},{key:"_shouldRestart",value:function _shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;return(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod;}}]);}();function em(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Set();var i=[e],n=new Set();var s=0;for(;i.length>s;){var _e356=i[s++];if(!n.has(_e356)&&tm(_e356)&&!t.has(_e356))if(n.add(_e356),Symbol.iterator in _e356)try{var _iterator333=_createForOfIteratorHelper(_e356),_step333;try{for(_iterator333.s();!(_step333=_iterator333.n()).done;){var _t216=_step333.value;i.push(_t216);}}catch(err){_iterator333.e(err);}finally{_iterator333.f();}}catch(e){}else for(var _t217 in _e356)"defaultValue"!==_t217&&i.push(_e356[_t217]);}return n;}function tm(e){var t=Object.prototype.toString.call(e),i=_typeof(e);return!("number"===i||"boolean"===i||"string"===i||"symbol"===i||"function"===i||"[object Date]"===t||"[object RegExp]"===t||"[object Module]"===t||null==e||e._watchdogExcluded||e instanceof EventTarget||e instanceof Event);}function im(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:new Set();if(e===t&&"object"==_typeof(n=e)&&null!==n)return!0;var n;var s=em(e,i),o=em(t,i);var _iterator334=_createForOfIteratorHelper(s),_step334;try{for(_iterator334.s();!(_step334=_iterator334.n()).done;){var _e357=_step334.value;if(o.has(_e357))return!0;}}catch(err){_iterator334.e(err);}finally{_iterator334.f();}return!1;}var nm=/*#__PURE__*/function(_Xh2){function nm(e){var _this124;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,nm);_this124=_callSuper(this,nm,[t]),_defineProperty(_assertThisInitialized(_this124),"_editor",null),_defineProperty(_assertThisInitialized(_this124),"_lifecyclePromise",null),_defineProperty(_assertThisInitialized(_this124),"_throttledSave",void 0),_defineProperty(_assertThisInitialized(_this124),"_data",void 0),_defineProperty(_assertThisInitialized(_this124),"_lastDocumentVersion",void 0),_defineProperty(_assertThisInitialized(_this124),"_elementOrData",void 0),_defineProperty(_assertThisInitialized(_this124),"_initUsingData",!0),_defineProperty(_assertThisInitialized(_this124),"_editables",{}),_defineProperty(_assertThisInitialized(_this124),"_config",void 0),_defineProperty(_assertThisInitialized(_this124),"_excludedProps",void 0),_this124._throttledSave=$s(_this124._save.bind(_assertThisInitialized(_this124)),"number"==typeof t.saveInterval?t.saveInterval:5e3),e&&(_this124._creator=function(t,i){return e.create(t,i);}),_this124._destructor=function(e){return e.destroy();};return _this124;}_inherits(nm,_Xh2);return _createClass(nm,[{key:"editor",get:function get(){return this._editor;}},{key:"_item",get:function get(){return this._editor;}},{key:"setCreator",value:function setCreator(e){this._creator=e;}},{key:"setDestructor",value:function setDestructor(e){this._destructor=e;}},{key:"_restart",value:function _restart(){var _this125=this;return Promise.resolve().then(function(){return _this125.state="initializing",_this125._fire("stateChange"),_this125._destroy();})["catch"](function(e){console.error("An error happened during the editor destroying.",e);}).then(function(){var e={},t=[],i=_this125._config.rootsAttributes||{},n={};for(var _i271=0,_Object$entries4=Object.entries(_this125._data.roots);_i271<_Object$entries4.length;_i271++){var _Object$entries4$_i=_slicedToArray(_Object$entries4[_i271],2),_s102=_Object$entries4$_i[0],_o54=_Object$entries4$_i[1];_o54.isLoaded?(e[_s102]="",n[_s102]=i[_s102]||{}):t.push(_s102);}var s=_objectSpread(_objectSpread({},_this125._config),{},{extraPlugins:_this125._config.extraPlugins||[],lazyRoots:t,rootsAttributes:n,_watchdogInitialData:_this125._data});return delete s.initialData,s.extraPlugins.push(sm),_this125._initUsingData?_this125.create(e,s,s.context):Ms(_this125._elementOrData)?_this125.create(_this125._elementOrData,s,s.context):_this125.create(_this125._editables,s,s.context);}).then(function(){_this125._fire("restart");});}},{key:"create",value:function create(){var _this126=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this._elementOrData;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._config;var i=arguments.length>2?arguments[2]:undefined;return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(function(){return _superPropGet(nm,"_startErrorHandling",_this126,3)([]),_this126._elementOrData=e,_this126._initUsingData="string"==typeof e||Object.keys(e).length>0&&"string"==typeof Object.values(e)[0],_this126._config=_this126._cloneEditorConfiguration(t)||{},_this126._config.context=i,_this126._creator(e,_this126._config);}).then(function(e){_this126._editor=e,e.model.document.on("change:data",_this126._throttledSave),_this126._lastDocumentVersion=e.model.document.version,_this126._data=_this126._getData(),_this126._initUsingData||(_this126._editables=_this126._getEditables()),_this126.state="ready",_this126._fire("stateChange");})["finally"](function(){_this126._lifecyclePromise=null;}),this._lifecyclePromise;}},{key:"destroy",value:function destroy(){var _this127=this;return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(function(){return _this127.state="destroyed",_this127._fire("stateChange"),_superPropGet(nm,"destroy",_this127,3)([]),_this127._destroy();})["finally"](function(){_this127._lifecyclePromise=null;}),this._lifecyclePromise;}},{key:"_destroy",value:function _destroy(){var _this128=this;return Promise.resolve().then(function(){_this128._stopErrorHandling(),_this128._throttledSave.cancel();var e=_this128._editor;return _this128._editor=null,e.model.document.off("change:data",_this128._throttledSave),_this128._destructor(e);});}},{key:"_save",value:function _save(){var e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e;}catch(e){console.error(e,"An error happened during restoring editor data. Editor will be restored from the previously saved data.");}}},{key:"_setExcludedProperties",value:function _setExcludedProperties(e){this._excludedProps=e;}},{key:"_getData",value:function _getData(){var e=this._editor,t=e.model.document.roots.filter(function(e){return e.isAttached()&&"$graveyard"!=e.rootName;}),i=e.plugins,n=i.has("CommentsRepository")&&i.get("CommentsRepository"),s=i.has("TrackChanges")&&i.get("TrackChanges"),o={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};t.forEach(function(e){o.roots[e.rootName]={content:JSON.stringify(Array.from(e.getChildren())),attributes:JSON.stringify(Array.from(e.getAttributes())),isLoaded:e._isLoaded};});var _iterator335=_createForOfIteratorHelper(e.model.markers),_step335;try{for(_iterator335.s();!(_step335=_iterator335.n()).done;){var _t218=_step335.value;_t218._affectsData&&(o.markers[_t218.name]={rangeJSON:_t218.getRange().toJSON(),usingOperation:_t218._managedUsingOperations,affectsData:_t218._affectsData});}}catch(err){_iterator335.e(err);}finally{_iterator335.f();}return n&&(o.commentThreads=JSON.stringify(n.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),s&&(o.suggestions=JSON.stringify(s.getSuggestions({toJSON:!0,skipNotAttached:!0}))),o;}},{key:"_getEditables",value:function _getEditables(){var e={};var _iterator336=_createForOfIteratorHelper(this.editor.model.document.getRootNames()),_step336;try{for(_iterator336.s();!(_step336=_iterator336.n()).done;){var _t219=_step336.value;var _i272=this.editor.ui.getEditableElement(_t219);_i272&&(e[_t219]=_i272);}}catch(err){_iterator336.e(err);}finally{_iterator336.f();}return e;}},{key:"_isErrorComingFromThisItem",value:function _isErrorComingFromThisItem(e){return im(this._editor,e.context,this._excludedProps);}},{key:"_cloneEditorConfiguration",value:function _cloneEditorConfiguration(e){return Wn(e,function(e,t){return Ms(e)||"context"===t?e:void 0;});}}]);}(Xh);var sm=/*#__PURE__*/function(){function sm(e){_classCallCheck(this,sm);_defineProperty(this,"editor",void 0);_defineProperty(this,"_data",void 0);this.editor=e,this._data=e.config.get("_watchdogInitialData");}return _createClass(sm,[{key:"init",value:function init(){var _this129=this;this.editor.data.on("init",function(e){e.stop(),_this129.editor.model.enqueueChange({isUndoable:!1},function(e){_this129._restoreCollaborationData(),_this129._restoreEditorData(e);}),_this129.editor.data.fire("ready");},{priority:999});}},{key:"_createNode",value:function _createNode(e,t){if("name"in t){var _i273=e.createElement(t.name,t.attributes);if(t.children){var _iterator337=_createForOfIteratorHelper(t.children),_step337;try{for(_iterator337.s();!(_step337=_iterator337.n()).done;){var _n144=_step337.value;_i273._appendChild(this._createNode(e,_n144));}}catch(err){_iterator337.e(err);}finally{_iterator337.f();}}return _i273;}return e.createText(t.data,t.attributes);}},{key:"_restoreEditorData",value:function _restoreEditorData(e){var _this130=this;var t=this.editor;Object.entries(this._data.roots).forEach(function(_ref53){var _ref54=_slicedToArray(_ref53,2),i=_ref54[0],_ref54$=_ref54[1],n=_ref54$.content,s=_ref54$.attributes;var o=JSON.parse(n),r=JSON.parse(s),a=t.model.document.getRoot(i);var _iterator338=_createForOfIteratorHelper(r),_step338;try{for(_iterator338.s();!(_step338=_iterator338.n()).done;){var _step338$value=_slicedToArray(_step338.value,2),_t220=_step338$value[0],_i274=_step338$value[1];e.setAttribute(_t220,_i274,a);}}catch(err){_iterator338.e(err);}finally{_iterator338.f();}var _iterator339=_createForOfIteratorHelper(o),_step339;try{for(_iterator339.s();!(_step339=_iterator339.n()).done;){var _t221=_step339.value;var _i275=_this130._createNode(e,_t221);e.insert(_i275,a,"end");}}catch(err){_iterator339.e(err);}finally{_iterator339.f();}}),Object.entries(this._data.markers).forEach(function(_ref55){var _ref56=_slicedToArray(_ref55,2),i=_ref56[0],n=_ref56[1];var s=t.model.document,_n$rangeJSON=n.rangeJSON,o=_n$rangeJSON.start,r=_n$rangeJSON.end,a=_objectWithoutProperties(n,_excluded2),l=s.getRoot(o.root),c=e.createPositionFromPath(l,o.path,o.stickiness),d=e.createPositionFromPath(l,r.path,r.stickiness),u=e.createRange(c,d);e.addMarker(i,_objectSpread({range:u},a));});}},{key:"_restoreCollaborationData",value:function _restoreCollaborationData(){var _this131=this;var e=JSON.parse(this._data.commentThreads),t=JSON.parse(this._data.suggestions);e.forEach(function(e){var t=_this131.editor.config.get("collaboration.channelId"),i=_this131.editor.plugins.get("CommentsRepository");if(i.hasCommentThread(e.threadId)){i.getCommentThread(e.threadId).remove();}i.addCommentThread(_objectSpread({channelId:t},e));}),t.forEach(function(e){var t=_this131.editor.plugins.get("TrackChangesEditing");if(t.hasSuggestion(e.id)){t.getSuggestion(e.id).attributes=e.attributes;}else t.addSuggestionData(e);});}}]);}();var om=Symbol("MainQueueId");var rm=/*#__PURE__*/function(_Xh3){function rm(e){var _this132;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,rm);_this132=_callSuper(this,rm,[t]),_defineProperty(_assertThisInitialized(_this132),"_watchdogs",new Map()),_defineProperty(_assertThisInitialized(_this132),"_watchdogConfig",void 0),_defineProperty(_assertThisInitialized(_this132),"_context",null),_defineProperty(_assertThisInitialized(_this132),"_contextProps",new Set()),_defineProperty(_assertThisInitialized(_this132),"_actionQueues",new am()),_defineProperty(_assertThisInitialized(_this132),"_contextConfig",void 0),_defineProperty(_assertThisInitialized(_this132),"_item",void 0),_this132._watchdogConfig=t,_this132._creator=function(t){return e.create(t);},_this132._destructor=function(e){return e.destroy();},_this132._actionQueues.onEmpty(function(){"initializing"===_this132.state&&(_this132.state="ready",_this132._fire("stateChange"));});return _this132;}_inherits(rm,_Xh3);return _createClass(rm,[{key:"setCreator",value:function setCreator(e){this._creator=e;}},{key:"setDestructor",value:function setDestructor(e){this._destructor=e;}},{key:"context",get:function get(){return this._context;}},{key:"create",value:function create(){var _this133=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return this._actionQueues.enqueue(om,function(){return _this133._contextConfig=e,_this133._create();});}},{key:"getItem",value:function getItem(e){return this._getWatchdog(e)._item;}},{key:"getItemState",value:function getItemState(e){return this._getWatchdog(e).state;}},{key:"add",value:function add(e){var _this134=this;var t=lm(e);return Promise.all(t.map(function(e){return _this134._actionQueues.enqueue(e.id,function(){if("destroyed"===_this134.state)throw new Error("Cannot add items to destroyed watchdog.");if(!_this134._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");var t;if(_this134._watchdogs.has(e.id))throw new Error("Item with the given id is already added: '".concat(e.id,"'."));if("editor"===e.type)return t=new nm(null,_this134._watchdogConfig),t.setCreator(e.creator),t._setExcludedProperties(_this134._contextProps),e.destructor&&t.setDestructor(e.destructor),_this134._watchdogs.set(e.id,t),t.on("error",function(i,_ref57){var n=_ref57.error,s=_ref57.causesRestart;_this134._fire("itemError",{itemId:e.id,error:n}),s&&_this134._actionQueues.enqueue(e.id,function(){return new Promise(function(i){var _n145=function n(){t.off("restart",_n145),_this134._fire("itemRestart",{itemId:e.id}),i();};t.on("restart",_n145);});});}),t.create(e.sourceElementOrData,e.config,_this134._context);throw new Error("Not supported item type: '".concat(e.type,"'."));});}));}},{key:"remove",value:function remove(e){var _this135=this;var t=lm(e);return Promise.all(t.map(function(e){return _this135._actionQueues.enqueue(e,function(){var t=_this135._getWatchdog(e);return _this135._watchdogs["delete"](e),t.destroy();});}));}},{key:"destroy",value:function destroy(){var _this136=this;return this._actionQueues.enqueue(om,function(){return _this136.state="destroyed",_this136._fire("stateChange"),_superPropGet(rm,"destroy",_this136,3)([]),_this136._destroy();});}},{key:"_restart",value:function _restart(){var _this137=this;return this._actionQueues.enqueue(om,function(){return _this137.state="initializing",_this137._fire("stateChange"),_this137._destroy()["catch"](function(e){console.error("An error happened during destroying the context or items.",e);}).then(function(){return _this137._create();}).then(function(){return _this137._fire("restart");});});}},{key:"_create",value:function _create(){var _this138=this;return Promise.resolve().then(function(){return _this138._startErrorHandling(),_this138._creator(_this138._contextConfig);}).then(function(e){return _this138._context=e,_this138._contextProps=em(_this138._context),Promise.all(Array.from(_this138._watchdogs.values()).map(function(e){return e._setExcludedProperties(_this138._contextProps),e.create(void 0,void 0,_this138._context);}));});}},{key:"_destroy",value:function _destroy(){var _this139=this;return Promise.resolve().then(function(){_this139._stopErrorHandling();var e=_this139._context;return _this139._context=null,_this139._contextProps=new Set(),Promise.all(Array.from(_this139._watchdogs.values()).map(function(e){return e.destroy();})).then(function(){return _this139._destructor(e);});});}},{key:"_getWatchdog",value:function _getWatchdog(e){var t=this._watchdogs.get(e);if(!t)throw new Error("Item with the given id was not registered: ".concat(e,"."));return t;}},{key:"_isErrorComingFromThisItem",value:function _isErrorComingFromThisItem(e){var _iterator340=_createForOfIteratorHelper(this._watchdogs.values()),_step340;try{for(_iterator340.s();!(_step340=_iterator340.n()).done;){var _t222=_step340.value;if(_t222._isErrorComingFromThisItem(e))return!1;}}catch(err){_iterator340.e(err);}finally{_iterator340.f();}return im(this._context,e.context);}}]);}(Xh);var am=/*#__PURE__*/function(){function am(){_classCallCheck(this,am);_defineProperty(this,"_onEmptyCallbacks",[]);_defineProperty(this,"_queues",new Map());_defineProperty(this,"_activeActions",0);}return _createClass(am,[{key:"onEmpty",value:function onEmpty(e){this._onEmptyCallbacks.push(e);}},{key:"enqueue",value:function enqueue(e,t){var _this140=this;var i=e===om;this._activeActions++,this._queues.get(e)||this._queues.set(e,Promise.resolve());var n=(i?Promise.all(this._queues.values()):Promise.all([this._queues.get(om),this._queues.get(e)])).then(t),s=n["catch"](function(){});return this._queues.set(e,s),n["finally"](function(){_this140._activeActions--,_this140._queues.get(e)===s&&0===_this140._activeActions&&_this140._onEmptyCallbacks.forEach(function(e){return e();});});}}]);}();function lm(e){return Array.isArray(e)?e:[e];}var cm=/*#__PURE__*/function(){function cm(){_classCallCheck(this,cm);_defineProperty(this,"_commands",void 0);this._commands=new Map();}return _createClass(cm,[{key:"add",value:function add(e,t){this._commands.set(e,t);}},{key:"get",value:function get(e){return this._commands.get(e);}},{key:"execute",value:function execute(e){var i=this.get(e);if(!i)throw new A("commandcollection-command-not-found",this,{commandName:e});for(var _len38=arguments.length,t=new Array(_len38>1?_len38-1:0),_key38=1;_key38<_len38;_key38++){t[_key38-1]=arguments[_key38];}return i.execute.apply(i,t);}},{key:"names",value:/*#__PURE__*/_regeneratorRuntime().mark(function names(){return _regeneratorRuntime().wrap(function names$(_context35){while(1)switch(_context35.prev=_context35.next){case 0:return _context35.delegateYield(this._commands.keys(),"t0",1);case 1:case"end":return _context35.stop();}},names,this);})},{key:"commands",value:/*#__PURE__*/_regeneratorRuntime().mark(function commands(){return _regeneratorRuntime().wrap(function commands$(_context36){while(1)switch(_context36.prev=_context36.next){case 0:return _context36.delegateYield(this._commands.values(),"t0",1);case 1:case"end":return _context36.stop();}},commands,this);})},{key:Symbol.iterator,value:function value(){return this._commands[Symbol.iterator]();}},{key:"destroy",value:function destroy(){var _iterator341=_createForOfIteratorHelper(this.commands()),_step341;try{for(_iterator341.s();!(_step341=_iterator341.n()).done;){var _e358=_step341.value;_e358.destroy();}}catch(err){_iterator341.e(err);}finally{_iterator341.f();}}}]);}();var dm=/*#__PURE__*/function(_Cr2){function dm(e){var _this141;_classCallCheck(this,dm);_this141=_callSuper(this,dm),_defineProperty(_assertThisInitialized(_this141),"editor",void 0),_this141.editor=e;return _this141;}_inherits(dm,_Cr2);return _createClass(dm,[{key:"set",value:function set(e,t){var _this142=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if("string"==typeof t){var _e359=t;t=function t(_t223,i){_this142.editor.execute(_e359),i();};}_superPropGet(dm,"set",this,3)([e,t,i]);}}]);}(Cr);var um="contentEditing",hm="common";var mm=/*#__PURE__*/function(){function mm(e){_classCallCheck(this,mm);_defineProperty(this,"keystrokeInfos",new Map());_defineProperty(this,"_editor",void 0);this._editor=e;var t=e.config.get("menuBar.isVisible"),i=e.locale.t;this.addKeystrokeInfoCategory({id:um,label:i("Content editing keystrokes"),description:i("These keyboard shortcuts allow for quick access to content editing features.")});var n=[{label:i("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:i("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:i("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:i("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:i("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:i("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];t&&n.push({label:i("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:i("User interface and content navigation keystrokes"),description:i("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:n}]});}return _createClass(mm,[{key:"addKeystrokeInfoCategory",value:function addKeystrokeInfoCategory(_ref58){var _this143=this;var e=_ref58.id,t=_ref58.label,i=_ref58.description,n=_ref58.groups;this.keystrokeInfos.set(e,{id:e,label:t,description:i,groups:new Map()}),this.addKeystrokeInfoGroup({categoryId:e,id:hm}),n&&n.forEach(function(t){_this143.addKeystrokeInfoGroup(_objectSpread({categoryId:e},t));});}},{key:"addKeystrokeInfoGroup",value:function addKeystrokeInfoGroup(_ref59){var _ref59$categoryId=_ref59.categoryId,e=_ref59$categoryId===void 0?um:_ref59$categoryId,t=_ref59.id,i=_ref59.label,n=_ref59.keystrokes;var s=this.keystrokeInfos.get(e);if(!s)throw new A("accessibility-unknown-keystroke-info-category",this._editor,{groupId:t,categoryId:e});s.groups.set(t,{id:t,label:i,keystrokes:n||[]});}},{key:"addKeystrokeInfos",value:function addKeystrokeInfos(_ref60){var _n$groups$get$keystro;var _ref60$categoryId=_ref60.categoryId,e=_ref60$categoryId===void 0?um:_ref60$categoryId,_ref60$groupId=_ref60.groupId,t=_ref60$groupId===void 0?hm:_ref60$groupId,i=_ref60.keystrokes;if(!this.keystrokeInfos.has(e))throw new A("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:e,keystrokes:i});var n=this.keystrokeInfos.get(e);if(!n.groups.has(t))throw new A("accessibility-unknown-keystroke-info-group",this._editor,{groupId:t,categoryId:e,keystrokes:i});(_n$groups$get$keystro=n.groups.get(t).keystrokes).push.apply(_n$groups$get$keystro,_toConsumableArray(i));}}]);}();var gm=/*#__PURE__*/function(_Zs10){function gm(){var _this144;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,gm);if(_this144=_callSuper(this,gm),_defineProperty(_assertThisInitialized(_this144),"accessibility",void 0),_defineProperty(_assertThisInitialized(_this144),"commands",void 0),_defineProperty(_assertThisInitialized(_this144),"config",void 0),_defineProperty(_assertThisInitialized(_this144),"conversion",void 0),_defineProperty(_assertThisInitialized(_this144),"data",void 0),_defineProperty(_assertThisInitialized(_this144),"editing",void 0),_defineProperty(_assertThisInitialized(_this144),"locale",void 0),_defineProperty(_assertThisInitialized(_this144),"model",void 0),_defineProperty(_assertThisInitialized(_this144),"plugins",void 0),_defineProperty(_assertThisInitialized(_this144),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this144),"t",void 0),_defineProperty(_assertThisInitialized(_this144),"_context",void 0),_defineProperty(_assertThisInitialized(_this144),"_readOnlyLocks",void 0),_assertThisInitialized(_this144),"sanitizeHtml"in e)throw new A("editor-config-sanitizehtml-not-supported");var t=_this144.constructor,_ref61=t.defaultConfig||{},i=_ref61.translations,n=_objectWithoutProperties(_ref61,_excluded3),_e$translations=e.translations,s=_e$translations===void 0?i:_e$translations,o=_objectWithoutProperties(e,_excluded4),r=e.language||n.language;_this144._context=e.context||new jr({language:r,translations:s}),_this144._context._addEditor(_this144,!e.context);var a=Array.from(t.builtinPlugins||[]);_this144.config=new ao(o,n),_this144.config.define("plugins",a),_this144.config.define(_this144._context._getEditorConfig()),_this144.plugins=new Wr(_this144,a,_this144._context.plugins),_this144.locale=_this144._context.locale,_this144.t=_this144.locale.t,_this144._readOnlyLocks=new Set(),_this144.commands=new cm(),_this144.set("state","initializing"),_this144.once("ready",function(){return _this144.state="ready";},{priority:"high"}),_this144.once("destroy",function(){return _this144.state="destroyed";},{priority:"high"}),_this144.model=new Hu(),_this144.on("change:isReadOnly",function(){_this144.model.document.isReadOnly=_this144.isReadOnly;});var l=new ua();_this144.data=new yd(_this144.model,l),_this144.editing=new Xc(_this144.model,l),_this144.editing.view.document.bind("isReadOnly").to(_this144),_this144.conversion=new kd([_this144.editing.downcastDispatcher,_this144.data.downcastDispatcher],_this144.data.upcastDispatcher),_this144.conversion.addAlias("dataDowncast",_this144.data.downcastDispatcher),_this144.conversion.addAlias("editingDowncast",_this144.editing.downcastDispatcher),_this144.keystrokes=new dm(_this144),_this144.keystrokes.listenTo(_this144.editing.view.document),_this144.accessibility=new mm(_this144);return _this144;}_inherits(gm,_Zs10);return _createClass(gm,[{key:"isReadOnly",get:function get(){return this._readOnlyLocks.size>0;},set:function set(e){throw new A("editor-isreadonly-has-no-setter");}},{key:"enableReadOnlyMode",value:function enableReadOnlyMode(e){if("string"!=typeof e&&"symbol"!=_typeof(e))throw new A("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),1===this._readOnlyLocks.size&&this.fire("change:isReadOnly","isReadOnly",!0,!1));}},{key:"disableReadOnlyMode",value:function disableReadOnlyMode(e){if("string"!=typeof e&&"symbol"!=_typeof(e))throw new A("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks["delete"](e),0===this._readOnlyLocks.size&&this.fire("change:isReadOnly","isReadOnly",!1,!0));}},{key:"setData",value:function setData(e){this.data.set(e);}},{key:"getData",value:function getData(e){return this.data.get(e);}},{key:"initPlugins",value:function initPlugins(){var e=this.config,t=e.get("plugins"),i=e.get("removePlugins")||[],n=e.get("extraPlugins")||[],s=e.get("substitutePlugins")||[];return this.plugins.init(t.concat(n),i,s);}},{key:"destroy",value:function destroy(){var _this145=this;var e=Promise.resolve();return"initializing"==this.state&&(e=new Promise(function(e){return _this145.once("ready",e);})),e.then(function(){_this145.fire("destroy"),_this145.stopListening(),_this145.commands.destroy();}).then(function(){return _this145.plugins.destroy();}).then(function(){_this145.model.destroy(),_this145.data.destroy(),_this145.editing.destroy(),_this145.keystrokes.destroy();}).then(function(){return _this145._context._removeEditor(_this145);});}},{key:"execute",value:function execute(e){try{var _this$commands;for(var _len39=arguments.length,t=new Array(_len39>1?_len39-1:0),_key39=1;_key39<_len39;_key39++){t[_key39-1]=arguments[_key39];}return(_this$commands=this.commands).execute.apply(_this$commands,[e].concat(t));}catch(e){A.rethrowUnexpectedError(e,this);}}},{key:"focus",value:function focus(){this.editing.view.focus();}}],[{key:"create",value:function create(){throw new Error("This is an abstract method.");}}]);}(Zs());_defineProperty(gm,"defaultConfig",void 0);_defineProperty(gm,"builtinPlugins",void 0);_defineProperty(gm,"Context",jr);_defineProperty(gm,"EditorWatchdog",nm);_defineProperty(gm,"ContextWatchdog",rm);function fm(e){if(!we(e.updateSourceElement))throw new A("attachtoform-missing-elementapi-interface",e);var t=e.sourceElement;if(function(e){return!!e&&"textarea"===e.tagName.toLowerCase();}(t)&&t.form){var _i276;var _n146=t.form,_s103=function _s103(){return e.updateSourceElement();};we(_n146.submit)&&(_i276=_n146.submit,_n146.submit=function(){_s103(),_i276.apply(_n146);}),_n146.addEventListener("submit",_s103),e.on("destroy",function(){_n146.removeEventListener("submit",_s103),_i276&&(_n146.submit=_i276);});}}function pm(e){return e;}function bm(e){return/*#__PURE__*/function(_e360){function _class5(){var _this146;_classCallCheck(this,_class5);for(var _len40=arguments.length,args=new Array(_len40),_key40=0;_key40<_len40;_key40++){args[_key40]=arguments[_key40];}_this146=_callSuper(this,_class5,[].concat(args));_defineProperty(_this146,"sourceElement",void 0);return _this146;}_inherits(_class5,_e360);return _createClass(_class5,[{key:"updateSourceElement",value:function updateSourceElement(e){if(!this.sourceElement)throw new A("editor-missing-sourceelement",this);var t=this.config.get("updateSourceElementOnDestroy"),i=this.sourceElement instanceof HTMLTextAreaElement;if(!t&&!i)return void Ro(this.sourceElement,"");var n="string"==typeof e?e:this.data.get();Ro(this.sourceElement,n);}}]);}(e);}function wm(e,t){if(t.ckeditorInstance)throw new A("editor-source-element-already-used",e);t.ckeditorInstance=e,e.once("destroy",function(){delete t.ckeditorInstance;});}bm.updateSourceElement=bm(Object).prototype.updateSourceElement;var _m=/*#__PURE__*/function(_qr2){function _m(){var _this147;_classCallCheck(this,_m);for(var _len41=arguments.length,args=new Array(_len41),_key41=0;_key41<_len41;_key41++){args[_key41]=arguments[_key41];}_this147=_callSuper(this,_m,[].concat(args));_defineProperty(_this147,"_actions",void 0);return _this147;}_inherits(_m,_qr2);return _createClass(_m,[{key:"init",value:function init(){this.set("hasAny",!1),this._actions=new br({idProperty:"_id"}),this._actions.delegate("add","remove").to(this);}},{key:"add",value:function add(e){if("string"!=typeof e)throw new A("pendingactions-add-invalid-message",this);var t=new(Zs())();return t.set("message",e),this._actions.add(t),this.hasAny=!0,t;}},{key:"remove",value:function remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length;}},{key:"first",get:function get(){return this._actions.get(0);}},{key:Symbol.iterator,value:function value(){return this._actions[Symbol.iterator]();}}],[{key:"pluginName",get:function get(){return"PendingActions";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(qr);var vm={bold:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',cancel:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',caption:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',check:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',cog:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',colorPalette:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',eraser:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',history:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11 1a9 9 0 1 1-8.027 13.075l1.128-1.129A7.502 7.502 0 0 0 18.5 10a7.5 7.5 0 1 0-14.962.759l-.745-.746-.76.76A9 9 0 0 1 11 1z"/><path d="M.475 8.17a.75.75 0 0 1 .978.047l.075.082 1.284 1.643 1.681-1.284a.75.75 0 0 1 .978.057l.073.083a.75.75 0 0 1-.057.978l-.083.073-2.27 1.737a.75.75 0 0 1-.973-.052l-.074-.082-1.741-2.23a.75.75 0 0 1 .13-1.052z"/><path d="M11.5 5v4.999l3.196 3.196-1.06 1.06L10.1 10.72l-.1-.113V5z"/></svg>',image:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1l4.16-4.482ZM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1h15.6Zm-5.655 6a2.128 2.128 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7Z"/></svg>',imageUpload:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/></svg>',imageAssetManager:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1c-.662 0-1.2.47-1.2 1.1v14.248c0 .64.533 1.152 1.185 1.152h6.623v-7.236L6.617 9.15a.694.694 0 0 0-.957-.033L1.602 13.55V2.553l14.798.003V9.7H18V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.723 2.805a2.094 2.094 0 0 0-1.621.832 2.127 2.127 0 0 0 1.136 3.357 2.13 2.13 0 0 0 2.611-1.506 2.133 2.133 0 0 0-.76-2.244 2.13 2.13 0 0 0-1.366-.44Z"/><path clip-rule="evenodd" d="M19.898 12.369v6.187a.844.844 0 0 1-.844.844h-8.719a.844.844 0 0 1-.843-.844v-7.312a.844.844 0 0 1 .843-.844h2.531a.843.843 0 0 1 .597.248l.838.852h4.75c.223 0 .441.114.6.272a.844.844 0 0 1 .247.597Zm-1.52.654-4.377.02-1.1-1.143H11v6h7.4l-.023-4.877Z"/></svg>',imageUrl:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h7.029a5.401 5.401 0 0 1 .615-4.338l.762-1.232-2.975-2.78a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v6.023c.449.131.887.32 1.307.573l.058.033c.046.028.09.057.135.086V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.15 2.15 0 0 0-1.611.834 2.118 2.118 0 0 0-.438 1.158 2.14 2.14 0 0 0 1.277 2.096 2.132 2.132 0 0 0 2.645-3.11 2.13 2.13 0 0 0-1.873-.978Z"/><path d="M16.63 10.294a3.003 3.003 0 0 0-4.142.887l-.117.177a.647.647 0 0 0-.096.492.664.664 0 0 0 .278.418.7.7 0 0 0 .944-.234 1.741 1.741 0 0 1 2.478-.463 1.869 1.869 0 0 1 .476 2.55.637.637 0 0 0-.071.5.646.646 0 0 0 .309.396.627.627 0 0 0 .869-.19l.027-.041a3.226 3.226 0 0 0-.956-4.492Zm-6.061 3.78-.044.066a3.228 3.228 0 0 0 .82 4.403 3.005 3.005 0 0 0 4.275-.798l.13-.197a.626.626 0 0 0 .092-.475.638.638 0 0 0-.268-.402.713.713 0 0 0-.99.26l-.018.029a1.741 1.741 0 0 1-2.477.461 1.87 1.87 0 0 1-.475-2.55l.029-.047a.647.647 0 0 0 .086-.485.66.66 0 0 0-.275-.408l-.04-.027a.609.609 0 0 0-.845.17Z"/><path d="M15.312 13.925c.24-.36.154-.838-.19-1.067-.346-.23-.82-.124-1.059.236l-1.268 1.907c-.239.36-.153.838.192 1.067.345.23.818.123 1.057-.236l1.268-1.907Z"/></svg>',lowVision:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',textAlternative:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1H3.035Zm10.453 2.61a1.885 1.885 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.903 1.903 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598ZM7.463 8.163a.611.611 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.628.628 0 0 0-.417-.185Zm6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.618.618 0 0 0-.42-.165ZM.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.908.908 0 0 0-.912-.912H.91ZM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516L3.668 13Zm4.947 0h1.801v4.3h2.7v1.4h-4.5V13h-.001Zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9V13h-.001Zm-8.517 1.457-.614 2.059h1.262l-.648-2.059Z"/></svg>',loupe:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.68 13.74h-.001l4.209 4.208a1 1 0 1 0 1.414-1.414l-4.267-4.268a6 6 0 1 0-1.355 1.474ZM13 9a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/></svg>',previousArrow:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',nextArrow:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',importExport:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',paragraph:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',plus:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',text:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',alignBottom:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',alignMiddle:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',alignTop:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',alignLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',alignCenter:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',alignRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',alignJustify:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',objectLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectCenter:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',objectRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectFullWidth:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',objectInline:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectBlockLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectBlockRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectSizeCustom:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95H.95zm.55 3.5v-2h2v2h-2zm0 9.3v2h2v-2h-2zm15-11.3v2h2v-2h-2z"/><path d="M8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046h-2.39zm11.421-9.101a.64.64 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.63.63 0 0 1 .206-.138.635.635 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243z"/></svg>',objectSizeFull:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',objectSizeLarge:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2ZM13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7h11Z"/></svg>',objectSizeSmall:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2ZM7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11h5Z"/></svg>',objectSizeMedium:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2ZM10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9h8Z"/></svg>',pencil:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',pilcrow:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',quote:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',threeVerticalDots:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',dragIndicator:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',redo:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',undo:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',bulletedList:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',numberedList:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',todoList:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',codeBlock:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',browseFiles:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',heading1:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 9v10h-2v-8h-2V9h4zM4 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H10a1 1 0 0 1-1-1V11H4v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v4.5z"/></svg>',heading2:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm16.076 8.343V18.5h-6.252c.067-.626.27-1.22.61-1.78.338-.561 1.006-1.305 2.005-2.232.804-.749 1.297-1.257 1.479-1.523.245-.368.368-.732.368-1.092 0-.398-.107-.703-.32-.917-.214-.214-.51-.32-.886-.32-.372 0-.669.111-.889.336-.22.224-.347.596-.38 1.117l-1.778-.178c.106-.982.438-1.686.997-2.114.558-.427 1.257-.64 2.095-.64.918 0 1.64.247 2.164.742.525.495.787 1.11.787 1.847 0 .419-.075.818-.225 1.197-.15.378-.388.775-.714 1.19-.216.275-.605.67-1.168 1.187-.563.516-.92.859-1.07 1.028a3.11 3.11 0 0 0-.365.495h3.542z"/></svg>',heading3:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm9.989 7.53 1.726-.209c.055.44.203.777.445 1.01.24.232.533.349.876.349.368 0 .678-.14.93-.42.251-.279.377-.655.377-1.13 0-.448-.12-.803-.362-1.066a1.153 1.153 0 0 0-.882-.393c-.228 0-.501.044-.819.133l.197-1.453c.482.012.85-.092 1.105-.315.253-.222.38-.517.38-.885 0-.313-.093-.563-.279-.75-.186-.185-.434-.278-.743-.278a1.07 1.07 0 0 0-.78.317c-.216.212-.347.52-.394.927l-1.644-.28c.114-.562.287-1.012.517-1.348.231-.337.553-.601.965-.794a3.24 3.24 0 0 1 1.387-.289c.876 0 1.579.28 2.108.838.436.457.653.973.653 1.549 0 .817-.446 1.468-1.339 1.955.533.114.96.37 1.28.768.319.398.478.878.478 1.441 0 .817-.298 1.513-.895 2.088-.596.576-1.339.864-2.228.864-.842 0-1.54-.243-2.094-.727-.555-.485-.876-1.118-.965-1.901z"/></svg>',heading4:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm13.55 10v-1.873h-3.81v-1.561l4.037-5.91h1.498v5.904h1.156v1.567h-1.156V18.5H17.05zm0-3.44v-3.18l-2.14 3.18h2.14z"/></svg>',heading5:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm9.578 7.607 1.777-.184c.05.402.201.72.45.955a1.223 1.223 0 0 0 1.81-.101c.258-.303.387-.759.387-1.368 0-.572-.128-1-.384-1.286-.256-.285-.59-.428-1-.428-.512 0-.971.226-1.377.679l-1.448-.21.915-4.843h4.716v1.67H15.56l-.28 1.58a2.697 2.697 0 0 1 1.219-.298 2.68 2.68 0 0 1 2.012.863c.55.576.825 1.323.825 2.241a3.36 3.36 0 0 1-.666 2.05c-.605.821-1.445 1.232-2.52 1.232-.86 0-1.56-.23-2.101-.692-.542-.461-.866-1.081-.971-1.86z"/></svg>',heading6:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm15.595 2.973-1.726.19c-.043-.355-.153-.617-.33-.787-.178-.169-.409-.253-.692-.253-.377 0-.695.169-.956.507-.26.339-.424 1.043-.492 2.114.445-.525.997-.787 1.657-.787.745 0 1.383.284 1.914.85.531.568.797 1.3.797 2.197 0 .952-.28 1.716-.838 2.291-.559.576-1.276.864-2.152.864-.94 0-1.712-.365-2.317-1.095-.605-.73-.908-1.927-.908-3.59 0-1.705.316-2.935.946-3.688.63-.753 1.45-1.13 2.457-1.13.706 0 1.291.198 1.755.594.463.395.758.97.885 1.723zm-4.043 3.891c0 .58.133 1.028.4 1.343.266.315.57.473.914.473.33 0 .605-.13.825-.388.22-.258.33-.68.33-1.27 0-.604-.118-1.047-.355-1.329a1.115 1.115 0 0 0-.89-.422c-.342 0-.632.134-.869.403s-.355.666-.355 1.19z"/></svg>',horizontalLine:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',html:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',indent:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',outdent:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',table:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>'};var ym=/*#__PURE__*/function(_Zs11){function ym(){var _this148;_classCallCheck(this,ym);_this148=_callSuper(this,ym);_defineProperty(_this148,"total",void 0);_defineProperty(_this148,"_reader",void 0);_defineProperty(_this148,"_data",void 0);var e=new window.FileReader();_this148._reader=e,_this148._data=void 0,_this148.set("loaded",0),e.onprogress=function(e){_this148.loaded=e.loaded;};return _this148;}_inherits(ym,_Zs11);return _createClass(ym,[{key:"error",get:function get(){return this._reader.error;}},{key:"data",get:function get(){return this._data;}},{key:"read",value:function read(e){var _this149=this;var t=this._reader;return this.total=e.size,new Promise(function(i,n){t.onload=function(){var e=t.result;_this149._data=e,i(e);},t.onerror=function(){n("error");},t.onabort=function(){n("aborted");},_this149._reader.readAsDataURL(e);});}},{key:"abort",value:function abort(){this._reader.abort();}}]);}(Zs());var km=/*#__PURE__*/function(_Dr2){function km(){var _this150;_classCallCheck(this,km);for(var _len42=arguments.length,args=new Array(_len42),_key42=0;_key42<_len42;_key42++){args[_key42]=arguments[_key42];}_this150=_callSuper(this,km,[].concat(args));_defineProperty(_this150,"loaders",new br());_defineProperty(_this150,"_loadersMap",new Map());_defineProperty(_this150,"_pendingAction",null);return _this150;}_inherits(km,_Dr2);return _createClass(km,[{key:"init",value:function init(){var _this151=this;this.loaders.on("change",function(){return _this151._updatePendingAction();}),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",function(e,t){return t?e/t*100:0;});}},{key:"getLoader",value:function getLoader(e){return this._loadersMap.get(e)||null;}},{key:"createLoader",value:function createLoader(e){var _this152=this;if(!this.createUploadAdapter)return E("filerepository-no-upload-adapter"),null;var t=new Cm(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(t),this._loadersMap.set(e,t),e instanceof Promise&&t.file.then(function(e){_this152._loadersMap.set(e,t);})["catch"](function(){}),t.on("change:uploaded",function(){var e=0;var _iterator342=_createForOfIteratorHelper(_this152.loaders),_step342;try{for(_iterator342.s();!(_step342=_iterator342.n()).done;){var _t224=_step342.value;e+=_t224.uploaded;}}catch(err){_iterator342.e(err);}finally{_iterator342.f();}_this152.uploaded=e;}),t.on("change:uploadTotal",function(){var e=0;var _iterator343=_createForOfIteratorHelper(_this152.loaders),_step343;try{for(_iterator343.s();!(_step343=_iterator343.n()).done;){var _t225=_step343.value;_t225.uploadTotal&&(e+=_t225.uploadTotal);}}catch(err){_iterator343.e(err);}finally{_iterator343.f();}_this152.uploadTotal=e;}),t;}},{key:"destroyLoader",value:function destroyLoader(e){var _this153=this;var t=e instanceof Cm?e:this.getLoader(e);t._destroy(),this.loaders.remove(t),this._loadersMap.forEach(function(e,i){e===t&&_this153._loadersMap["delete"](i);});}},{key:"_updatePendingAction",value:function _updatePendingAction(){var e=this.editor.plugins.get(_m);if(this.loaders.length){if(!this._pendingAction){var _t226=this.editor.t,_i277=function _i277(e){return"".concat(_t226("Upload in progress")," ").concat(parseInt(e),"%.");};this._pendingAction=e.add(_i277(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",_i277);}}else e.remove(this._pendingAction),this._pendingAction=null;}}],[{key:"pluginName",get:function get(){return"FileRepository";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[_m];}}]);}(Dr);var Cm=/*#__PURE__*/function(_Zs12){function Cm(e,t){var _this154;_classCallCheck(this,Cm);_this154=_callSuper(this,Cm),_defineProperty(_assertThisInitialized(_this154),"id",void 0),_defineProperty(_assertThisInitialized(_this154),"_filePromiseWrapper",void 0),_defineProperty(_assertThisInitialized(_this154),"_adapter",void 0),_defineProperty(_assertThisInitialized(_this154),"_reader",void 0),_this154.id=k(),_this154._filePromiseWrapper=_this154._createFilePromiseWrapper(e),_this154._adapter=t(_assertThisInitialized(_this154)),_this154._reader=new ym(),_this154.set("status","idle"),_this154.set("uploaded",0),_this154.set("uploadTotal",null),_this154.bind("uploadedPercent").to(_assertThisInitialized(_this154),"uploaded",_this154,"uploadTotal",function(e,t){return t?e/t*100:0;}),_this154.set("uploadResponse",null);return _this154;}_inherits(Cm,_Zs12);return _createClass(Cm,[{key:"file",get:function get(){var _this155=this;return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(function(e){return _this155._filePromiseWrapper?e:null;}):Promise.resolve(null);}},{key:"data",get:function get(){return this._reader.data;}},{key:"read",value:function read(){var _this156=this;if("idle"!=this.status)throw new A("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(function(e){return _this156._reader.read(e);}).then(function(e){if("reading"!==_this156.status)throw _this156.status;return _this156.status="idle",e;})["catch"](function(e){if("aborted"===e)throw _this156.status="aborted","aborted";throw _this156.status="error",_this156._reader.error?_this156._reader.error:e;});}},{key:"upload",value:function upload(){var _this157=this;if("idle"!=this.status)throw new A("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(function(){return _this157._adapter.upload();}).then(function(e){return _this157.uploadResponse=e,_this157.status="idle",e;})["catch"](function(e){if("aborted"===_this157.status)throw"aborted";throw _this157.status="error",e;});}},{key:"abort",value:function abort(){var e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==e?this._reader.abort():"uploading"==e&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise["catch"](function(){}),this._filePromiseWrapper.rejecter("aborted")),this._destroy();}},{key:"_destroy",value:function _destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0;}},{key:"_createFilePromiseWrapper",value:function _createFilePromiseWrapper(e){var t={};return t.promise=new Promise(function(i,n){t.rejecter=n,t.isFulfilled=!1,e.then(function(e){t.isFulfilled=!0,i(e);})["catch"](function(e){t.isFulfilled=!0,n(e);});}),t;}}]);}(Zs());var xm=/*#__PURE__*/function(_Dr3){function xm(){_classCallCheck(this,xm);return _callSuper(this,xm,arguments);}_inherits(xm,_Dr3);return _createClass(xm,[{key:"init",value:function init(){this.editor.plugins.get(km).createUploadAdapter=function(e){return new Am(e);};}}],[{key:"requires",get:function get(){return[km];}},{key:"pluginName",get:function get(){return"Base64UploadAdapter";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Am=/*#__PURE__*/function(){function Am(e){_classCallCheck(this,Am);_defineProperty(this,"loader",void 0);_defineProperty(this,"reader",void 0);this.loader=e;}return _createClass(Am,[{key:"upload",value:function upload(){var _this158=this;return new Promise(function(e,t){var i=_this158.reader=new window.FileReader();i.addEventListener("load",function(){e({"default":i.result});}),i.addEventListener("error",function(e){t(e);}),i.addEventListener("abort",function(){t();}),_this158.loader.file.then(function(e){i.readAsDataURL(e);});});}},{key:"abort",value:function abort(){this.reader.abort();}}]);}();var Em=/*#__PURE__*/function(_Dr4){function Em(){_classCallCheck(this,Em);return _callSuper(this,Em,arguments);}_inherits(Em,_Dr4);return _createClass(Em,[{key:"init",value:function init(){var e=this.editor.config.get("simpleUpload");e&&(e.uploadUrl?this.editor.plugins.get(km).createUploadAdapter=function(t){return new Tm(t,e);}:E("simple-upload-adapter-missing-uploadurl"));}}],[{key:"requires",get:function get(){return[km];}},{key:"pluginName",get:function get(){return"SimpleUploadAdapter";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Tm=/*#__PURE__*/function(){function Tm(e,t){_classCallCheck(this,Tm);_defineProperty(this,"loader",void 0);_defineProperty(this,"options",void 0);_defineProperty(this,"xhr",void 0);this.loader=e,this.options=t;}return _createClass(Tm,[{key:"upload",value:function upload(){var _this159=this;return this.loader.file.then(function(e){return new Promise(function(t,i){_this159._initRequest(),_this159._initListeners(t,i,e),_this159._sendRequest(e);});});}},{key:"abort",value:function abort(){this.xhr&&this.xhr.abort();}},{key:"_initRequest",value:function _initRequest(){var e=this.xhr=new XMLHttpRequest();e.open("POST",this.options.uploadUrl,!0),e.responseType="json";}},{key:"_initListeners",value:function _initListeners(e,t,i){var n=this.xhr,s=this.loader,o="Couldn't upload file: ".concat(i.name,".");n.addEventListener("error",function(){return t(o);}),n.addEventListener("abort",function(){return t();}),n.addEventListener("load",function(){var i=n.response;if(!i||i.error)return t(i&&i.error&&i.error.message?i.error.message:o);var s=i.url?{"default":i.url}:i.urls;e(_objectSpread(_objectSpread({},i),{},{urls:s}));}),n.upload&&n.upload.addEventListener("progress",function(e){e.lengthComputable&&(s.uploadTotal=e.total,s.uploaded=e.loaded);});}},{key:"_sendRequest",value:function _sendRequest(e){var t=this.options.headers||{},i=this.options.withCredentials||!1;for(var _i278=0,_Object$keys5=Object.keys(t);_i278<_Object$keys5.length;_i278++){var _e361=_Object$keys5[_i278];this.xhr.setRequestHeader(_e361,t[_e361]);}this.xhr.withCredentials=i;var n=new FormData();n.append("upload",e),this.xhr.send(n);}}]);}();var Pm="ckCsrfToken",Sm="abcdefghijklmnopqrstuvwxyz0123456789";function Im(){var e=function(e){e=e.toLowerCase();var t=document.cookie.split(";");var _iterator344=_createForOfIteratorHelper(t),_step344;try{for(_iterator344.s();!(_step344=_iterator344.n()).done;){var _i279=_step344.value;var _t227=_i279.split("=");if(decodeURIComponent(_t227[0].trim().toLowerCase())===e)return decodeURIComponent(_t227[1]);}}catch(err){_iterator344.e(err);}finally{_iterator344.f();}return null;}(Pm);var t,i;return e&&40==e.length||(e=function(e){var t="";var i=new Uint8Array(e);window.crypto.getRandomValues(i);for(var _e362=0;_e362<i.length;_e362++){var _n147=Sm.charAt(i[_e362]%36);t+=Math.random()>.5?_n147.toUpperCase():_n147;}return t;}(40),t=Pm,i=e,document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(i)+";path=/"),e;}var Vm=/*#__PURE__*/function(_Dr5){function Vm(){_classCallCheck(this,Vm);return _callSuper(this,Vm,arguments);}_inherits(Vm,_Dr5);return _createClass(Vm,[{key:"init",value:function init(){var _this160=this;var e=this.editor.config.get("ckfinder.uploadUrl");e&&(this.editor.plugins.get(km).createUploadAdapter=function(t){return new Rm(t,e,_this160.editor.t);});}}],[{key:"requires",get:function get(){return[km];}},{key:"pluginName",get:function get(){return"CKFinderUploadAdapter";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Rm=/*#__PURE__*/function(){function Rm(e,t,i){_classCallCheck(this,Rm);_defineProperty(this,"loader",void 0);_defineProperty(this,"url",void 0);_defineProperty(this,"t",void 0);_defineProperty(this,"xhr",void 0);this.loader=e,this.url=t,this.t=i;}return _createClass(Rm,[{key:"upload",value:function upload(){var _this161=this;return this.loader.file.then(function(e){return new Promise(function(t,i){_this161._initRequest(),_this161._initListeners(t,i,e),_this161._sendRequest(e);});});}},{key:"abort",value:function abort(){this.xhr&&this.xhr.abort();}},{key:"_initRequest",value:function _initRequest(){var e=this.xhr=new XMLHttpRequest();e.open("POST",this.url,!0),e.responseType="json";}},{key:"_initListeners",value:function _initListeners(e,t,i){var n=this.xhr,s=this.loader,o=(0,this.t)("Cannot upload file:")+" ".concat(i.name,".");n.addEventListener("error",function(){return t(o);}),n.addEventListener("abort",function(){return t();}),n.addEventListener("load",function(){var i=n.response;if(!i||!i.uploaded)return t(i&&i.error&&i.error.message?i.error.message:o);e({"default":i.url});}),n.upload&&n.upload.addEventListener("progress",function(e){e.lengthComputable&&(s.uploadTotal=e.total,s.uploaded=e.loaded);});}},{key:"_sendRequest",value:function _sendRequest(e){var t=new FormData();t.append("upload",e),t.append("ckCsrfToken",Im()),this.xhr.send(t);}}]);}();var Om=["left","right","center","justify"];function Bm(e){return Om.includes(e);}function Mm(e,t){return"rtl"==t.contentLanguageDirection?"right"===e:"left"===e;}function Lm(e){var t=e.map(function(e){var t;return t="string"==typeof e?{name:e}:e,t;}).filter(function(e){var t=Om.includes(e.name);return t||E("alignment-config-name-not-recognized",{option:e}),t;}),i=t.filter(function(e){return Boolean(e.className);}).length;if(i&&i<t.length)throw new A("alignment-config-classnames-are-missing",{configuredOptions:e});return t.forEach(function(t,i,n){var s=n.slice(i+1);if(s.some(function(e){return e.name==t.name;}))throw new A("alignment-config-name-already-defined",{option:t,configuredOptions:e});if(t.className){if(s.some(function(e){return e.className==t.className;}))throw new A("alignment-config-classname-already-defined",{option:t,configuredOptions:e});}}),t;}var Fm="alignment";var Nm=/*#__PURE__*/function(_Hr3){function Nm(){_classCallCheck(this,Nm);return _callSuper(this,Nm,arguments);}_inherits(Nm,_Hr3);return _createClass(Nm,[{key:"refresh",value:function refresh(){var e=this.editor.locale,t=wr(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=Boolean(t)&&this._canBeAligned(t),this.isEnabled&&t.hasAttribute("alignment")?this.value=t.getAttribute("alignment"):this.value="rtl"===e.contentLanguageDirection?"right":"left";}},{key:"execute",value:function execute(){var _this162=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor,i=t.locale,n=t.model,s=n.document,o=e.value;n.change(function(e){var t=Array.from(s.selection.getSelectedBlocks()).filter(function(e){return _this162._canBeAligned(e);}),n=t[0].getAttribute("alignment");Mm(o,i)||n===o||!o?function(e,t){var _iterator345=_createForOfIteratorHelper(e),_step345;try{for(_iterator345.s();!(_step345=_iterator345.n()).done;){var _i280=_step345.value;t.removeAttribute(Fm,_i280);}}catch(err){_iterator345.e(err);}finally{_iterator345.f();}}(t,e):function(e,t,i){var _iterator346=_createForOfIteratorHelper(e),_step346;try{for(_iterator346.s();!(_step346=_iterator346.n()).done;){var _n148=_step346.value;t.setAttribute(Fm,i,_n148);}}catch(err){_iterator346.e(err);}finally{_iterator346.f();}}(t,e,o);});}},{key:"_canBeAligned",value:function _canBeAligned(e){return this.editor.model.schema.checkAttribute(e,Fm);}}]);}(Hr);var Dm=/*#__PURE__*/function(_Dr6){function Dm(e){var _this163;_classCallCheck(this,Dm);_this163=_callSuper(this,Dm,[e]),e.config.define("alignment",{options:Om.map(function(e){return{name:e};})});return _this163;}_inherits(Dm,_Dr6);return _createClass(Dm,[{key:"init",value:function init(){var e=this.editor,t=e.locale,i=e.model.schema,n=Lm(e.config.get("alignment.options")).filter(function(e){return Bm(e.name)&&!Mm(e.name,t);}),s=n.some(function(e){return!!e.className;});i.extend("$block",{allowAttributes:"alignment"}),e.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),s?e.conversion.attributeToAttribute(function(e){var t={};var _iterator347=_createForOfIteratorHelper(e),_step347;try{for(_iterator347.s();!(_step347=_iterator347.n()).done;){var _i281=_step347.value;t[_i281.name]={key:"class",value:_i281.className};}}catch(err){_iterator347.e(err);}finally{_iterator347.f();}var i={model:{key:"alignment",values:e.map(function(e){return e.name;})},view:t};return i;}(n)):e.conversion["for"]("downcast").attributeToAttribute(function(e){var t={};var _iterator348=_createForOfIteratorHelper(e),_step348;try{for(_iterator348.s();!(_step348=_iterator348.n()).done;){var _i282=_step348.value.name;t[_i282]={key:"style",value:{"text-align":_i282}};}}catch(err){_iterator348.e(err);}finally{_iterator348.f();}var i={model:{key:"alignment",values:e.map(function(e){return e.name;})},view:t};return i;}(n));var o=function(e){var t=[];var _iterator349=_createForOfIteratorHelper(e),_step349;try{for(_iterator349.s();!(_step349=_iterator349.n()).done;){var _i283=_step349.value.name;t.push({view:{key:"style",value:{"text-align":_i283}},model:{key:"alignment",value:_i283}});}}catch(err){_iterator349.e(err);}finally{_iterator349.f();}return t;}(n);var _iterator350=_createForOfIteratorHelper(o),_step350;try{for(_iterator350.s();!(_step350=_iterator350.n()).done;){var _t228=_step350.value;e.conversion["for"]("upcast").attributeToAttribute(_t228);}}catch(err){_iterator350.e(err);}finally{_iterator350.f();}var r=function(e){var t=[];var _iterator351=_createForOfIteratorHelper(e),_step351;try{for(_iterator351.s();!(_step351=_iterator351.n()).done;){var _i284=_step351.value.name;t.push({view:{key:"align",value:_i284},model:{key:"alignment",value:_i284}});}}catch(err){_iterator351.e(err);}finally{_iterator351.f();}return t;}(n);var _iterator352=_createForOfIteratorHelper(r),_step352;try{for(_iterator352.s();!(_step352=_iterator352.n()).done;){var _t229=_step352.value;e.conversion["for"]("upcast").attributeToAttribute(_t229);}}catch(err){_iterator352.e(err);}finally{_iterator352.f();}e.commands.add("alignment",new Nm(e));}}],[{key:"pluginName",get:function get(){return"AlignmentEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var zm=/*#__PURE__*/function(_br2){function zm(){var _this164;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];_classCallCheck(this,zm);_this164=_callSuper(this,zm,[e,{idProperty:"viewUid"}]),_defineProperty(_assertThisInitialized(_this164),"_parentElement",void 0),_this164.on("add",function(e,t,i){_this164._renderViewIntoCollectionParent(t,i);}),_this164.on("remove",function(e,t){t.element&&_this164._parentElement&&t.element.remove();}),_this164._parentElement=null;return _this164;}_inherits(zm,_br2);return _createClass(zm,[{key:"destroy",value:function destroy(){this.map(function(e){return e.destroy();});}},{key:"setParent",value:function setParent(e){this._parentElement=e;var _iterator353=_createForOfIteratorHelper(this),_step353;try{for(_iterator353.s();!(_step353=_iterator353.n()).done;){var _e363=_step353.value;this._renderViewIntoCollectionParent(_e363);}}catch(err){_iterator353.e(err);}finally{_iterator353.f();}}},{key:"delegate",value:function delegate(){var _this165=this;for(var _len43=arguments.length,e=new Array(_len43),_key43=0;_key43<_len43;_key43++){e[_key43]=arguments[_key43];}if(!e.length||!e.every(function(e){return"string"==typeof e;}))throw new A("ui-viewcollection-delegate-wrong-events",this);return{to:function to(t){var _iterator354=_createForOfIteratorHelper(_this165),_step354;try{for(_iterator354.s();!(_step354=_iterator354.n()).done;){var _i289=_step354.value;for(var _i290=0,_e366=e;_i290<_e366.length;_i290++){var _n149=_e366[_i290];_i289.delegate(_n149).to(t);}}}catch(err){_iterator354.e(err);}finally{_iterator354.f();}_this165.on("add",function(i,n){for(var _i285=0,_e364=e;_i285<_e364.length;_i285++){var _i286=_e364[_i285];n.delegate(_i286).to(t);}}),_this165.on("remove",function(i,n){for(var _i287=0,_e365=e;_i287<_e365.length;_i287++){var _i288=_e365[_i287];n.stopDelegating(_i288,t);}});}};}},{key:"_renderViewIntoCollectionParent",value:function _renderViewIntoCollectionParent(e,t){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[t]);}},{key:"remove",value:function remove(e){return _superPropGet(zm,"remove",this,3)([e]);}}]);}(br);var Hm=/*#__PURE__*/function(_L20){function Hm(e){var _this166;_classCallCheck(this,Hm);_this166=_callSuper(this,Hm),_defineProperty(_assertThisInitialized(_this166),"ns",void 0),_defineProperty(_assertThisInitialized(_this166),"tag",void 0),_defineProperty(_assertThisInitialized(_this166),"text",void 0),_defineProperty(_assertThisInitialized(_this166),"attributes",void 0),_defineProperty(_assertThisInitialized(_this166),"children",void 0),_defineProperty(_assertThisInitialized(_this166),"eventListeners",void 0),_defineProperty(_assertThisInitialized(_this166),"_isRendered",void 0),_defineProperty(_assertThisInitialized(_this166),"_revertData",void 0),Object.assign(_assertThisInitialized(_this166),Qm(Jm(e))),_this166._isRendered=!1,_this166._revertData=null;return _this166;}_inherits(Hm,_L20);return _createClass(Hm,[{key:"render",value:function render(){var e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e;}},{key:"apply",value:function apply(e){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e;}},{key:"revert",value:function revert(e){if(!this._revertData)throw new A("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData);}},{key:"getViews",value:/*#__PURE__*/_regeneratorRuntime().mark(function getViews(){return _regeneratorRuntime().wrap(function getViews$(_context38){while(1)switch(_context38.prev=_context38.next){case 0:return _context38.delegateYield(/*#__PURE__*/_regeneratorRuntime().mark(function e(t){var _iterator355,_step355,_i291;return _regeneratorRuntime().wrap(function e$(_context37){while(1)switch(_context37.prev=_context37.next){case 0:if(!t.children){_context37.next=24;break;}_iterator355=_createForOfIteratorHelper(t.children);_context37.prev=2;_iterator355.s();case 4:if((_step355=_iterator355.n()).done){_context37.next=16;break;}_i291=_step355.value;if(!ng(_i291)){_context37.next=11;break;}_context37.next=9;return _i291;case 9:_context37.next=14;break;case 11:_context37.t0=sg(_i291);if(!_context37.t0){_context37.next=14;break;}return _context37.delegateYield(e(_i291),"t1",14);case 14:_context37.next=4;break;case 16:_context37.next=21;break;case 18:_context37.prev=18;_context37.t2=_context37["catch"](2);_iterator355.e(_context37.t2);case 21:_context37.prev=21;_iterator355.f();return _context37.finish(21);case 24:case"end":return _context37.stop();}},e,null,[[2,18,21,24]]);})(this),"t0",1);case 1:case"end":return _context38.stop();}},getViews,this);})},{key:"_renderNode",value:function _renderNode(e){var t;if(t=e.node?this.tag&&this.text:this.tag?this.text:!this.text,t)throw new A("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e);}},{key:"_renderElement",value:function _renderElement(e){var t=e.node;return t||(t=e.node=document.createElementNS(this.ns||"http://www.w3.org/1999/xhtml",this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),t;}},{key:"_renderText",value:function _renderText(e){var t=e.node;return t?e.revertData.text=t.textContent:t=e.node=document.createTextNode(""),jm(this.text)?this._bindToObservable({schema:this.text,updater:Gm(t),data:e}):t.textContent=this.text.join(""),t;}},{key:"_renderAttributes",value:function _renderAttributes(e){if(!this.attributes)return;var t=e.node,i=e.revertData;for(var _n150 in this.attributes){var _s104=t.getAttribute(_n150),_o55=this.attributes[_n150];i&&(i.attributes[_n150]=_s104);var _r31=rg(_o55)?_o55[0].ns:null;if(jm(_o55)){var _a19=rg(_o55)?_o55[0].value:_o55;i&&ag(_n150)&&_a19.unshift(_s104),this._bindToObservable({schema:_a19,updater:Km(t,_n150,_r31),data:e});}else if("style"==_n150&&"string"!=typeof _o55[0])this._renderStyleAttribute(_o55[0],e);else{i&&_s104&&ag(_n150)&&_o55.unshift(_s104);var _e367=_o55.map(function(e){return e&&e.value||e;}).reduce(function(e,t){return e.concat(t);},[]).reduce(Xm,"");ig(_e367)||t.setAttributeNS(_r31,_n150,_e367);}}}},{key:"_renderStyleAttribute",value:function _renderStyleAttribute(e,t){var i=t.node;for(var _n151 in e){var _s105=e[_n151];jm(_s105)?this._bindToObservable({schema:[_s105],updater:Zm(i,_n151),data:t}):i.style[_n151]=_s105;}}},{key:"_renderElementChildren",value:function _renderElementChildren(e){var t=e.node,i=e.intoFragment?document.createDocumentFragment():t,n=e.isApplying;var s=0;var _iterator356=_createForOfIteratorHelper(this.children),_step356;try{for(_iterator356.s();!(_step356=_iterator356.n()).done;){var _o56=_step356.value;if(og(_o56)){if(!n){_o56.setParent(t);var _iterator357=_createForOfIteratorHelper(_o56),_step357;try{for(_iterator357.s();!(_step357=_iterator357.n()).done;){var _e368=_step357.value;i.appendChild(_e368.element);}}catch(err){_iterator357.e(err);}finally{_iterator357.f();}}}else if(ng(_o56))n||(_o56.isRendered||_o56.render(),i.appendChild(_o56.element));else if(uo(_o56))i.appendChild(_o56);else if(n){var _t230={children:[],bindings:[],attributes:{}};e.revertData.children.push(_t230),_o56._renderNode({intoFragment:!1,node:i.childNodes[s++],isApplying:!0,revertData:_t230});}else i.appendChild(_o56.render());}}catch(err){_iterator356.e(err);}finally{_iterator356.f();}e.intoFragment&&t.appendChild(i);}},{key:"_setUpListeners",value:function _setUpListeners(e){var _this167=this;if(this.eventListeners){var _loop4=function _loop4(_t231){var i=_this167.eventListeners[_t231].map(function(i){var _t231$split=_t231.split("@"),_t231$split2=_slicedToArray(_t231$split,2),n=_t231$split2[0],s=_t231$split2[1];return i.activateDomEventListener(n,s,e);});e.revertData&&e.revertData.bindings.push(i);};for(var _t231 in this.eventListeners){_loop4(_t231);}}}},{key:"_bindToObservable",value:function _bindToObservable(_ref62){var e=_ref62.schema,t=_ref62.updater,i=_ref62.data;var n=i.revertData;qm(e,t,i);var s=e.filter(function(e){return!ig(e);}).filter(function(e){return e.observable;}).map(function(n){return n.activateAttributeListener(e,t,i);});n&&n.bindings.push(s);}},{key:"_revertTemplateFromNode",value:function _revertTemplateFromNode(e,t){var _iterator358=_createForOfIteratorHelper(t.bindings),_step358;try{for(_iterator358.s();!(_step358=_iterator358.n()).done;){var _e371=_step358.value;var _iterator359=_createForOfIteratorHelper(_e371),_step359;try{for(_iterator359.s();!(_step359=_iterator359.n()).done;){var _t232=_step359.value;_t232();}}catch(err){_iterator359.e(err);}finally{_iterator359.f();}}}catch(err){_iterator358.e(err);}finally{_iterator358.f();}if(t.text)return void(e.textContent=t.text);var i=e;for(var _e369 in t.attributes){var _n152=t.attributes[_e369];null===_n152?i.removeAttribute(_e369):i.setAttribute(_e369,_n152);}for(var _e370=0;_e370<t.children.length;++_e370)this._revertTemplateFromNode(i.childNodes[_e370],t.children[_e370]);}}],[{key:"bind",value:function bind(e,t){return{to:function to(i,n){return new Um({eventNameOrFunction:i,attribute:i,observable:e,emitter:t,callback:n});},"if":function _if(i,n,s){return new Wm({observable:e,emitter:t,attribute:i,valueIfTrue:n,callback:s});}};}},{key:"extend",value:function extend(e,t){if(e._isRendered)throw new A("template-extend-render",[this,e]);tg(e,Qm(Jm(t)));}}]);}(L());var $m=/*#__PURE__*/function(){function $m(e){_classCallCheck(this,$m);_defineProperty(this,"attribute",void 0);_defineProperty(this,"observable",void 0);_defineProperty(this,"emitter",void 0);_defineProperty(this,"callback",void 0);this.attribute=e.attribute,this.observable=e.observable,this.emitter=e.emitter,this.callback=e.callback;}return _createClass($m,[{key:"getValue",value:function getValue(e){var t=this.observable[this.attribute];return this.callback?this.callback(t,e):t;}},{key:"activateAttributeListener",value:function activateAttributeListener(e,t,i){var _this168=this;var n=function n(){return qm(e,t,i);};return this.emitter.listenTo(this.observable,"change:".concat(this.attribute),n),function(){_this168.emitter.stopListening(_this168.observable,"change:".concat(_this168.attribute),n);};}}]);}();var Um=/*#__PURE__*/function(_$m2){function Um(e){var _this169;_classCallCheck(this,Um);_this169=_callSuper(this,Um,[e]),_defineProperty(_assertThisInitialized(_this169),"eventNameOrFunction",void 0),_this169.eventNameOrFunction=e.eventNameOrFunction;return _this169;}_inherits(Um,_$m2);return _createClass(Um,[{key:"activateDomEventListener",value:function activateDomEventListener(e,t,i){var _this170=this;var n=function n(e,i){t&&!i.target.matches(t)||("function"==typeof _this170.eventNameOrFunction?_this170.eventNameOrFunction(i):_this170.observable.fire(_this170.eventNameOrFunction,i));};return this.emitter.listenTo(i.node,e,n),function(){_this170.emitter.stopListening(i.node,e,n);};}}]);}($m);var Wm=/*#__PURE__*/function(_$m3){function Wm(e){var _this171;_classCallCheck(this,Wm);_this171=_callSuper(this,Wm,[e]),_defineProperty(_assertThisInitialized(_this171),"valueIfTrue",void 0),_this171.valueIfTrue=e.valueIfTrue;return _this171;}_inherits(Wm,_$m3);return _createClass(Wm,[{key:"getValue",value:function getValue(e){return!ig(_superPropGet(Wm,"getValue",this,3)([e]))&&(this.valueIfTrue||!0);}}]);}($m);function jm(e){return!!e&&(e.value&&(e=e.value),Array.isArray(e)?e.some(jm):e instanceof $m);}function qm(e,t,_ref63){var i=_ref63.node;var n=function(e,t){return e.map(function(e){return e instanceof $m?e.getValue(t):e;});}(e,i);var s;s=1==e.length&&e[0]instanceof Wm?n[0]:n.reduce(Xm,""),ig(s)?t.remove():t.set(s);}function Gm(e){return{set:function set(t){e.textContent=t;},remove:function remove(){e.textContent="";}};}function Km(e,t,i){return{set:function set(n){e.setAttributeNS(i,t,n);},remove:function remove(){e.removeAttributeNS(i,t);}};}function Zm(e,t){return{set:function set(i){e.style[t]=i;},remove:function remove(){e.style[t]=null;}};}function Jm(e){return Wn(e,function(e){if(e&&(e instanceof $m||sg(e)||ng(e)||og(e)))return e;});}function Qm(e){if("string"==typeof e?e=function(e){return{text:[e]};}(e):e.text&&function(e){e.text=gr(e.text);}(e),e.on&&(e.eventListeners=function(e){for(var _t233 in e)Ym(e,_t233);return e;}(e.on),delete e.on),!e.text){e.attributes&&function(e){for(var _t234 in e)e[_t234].value&&(e[_t234].value=gr(e[_t234].value)),Ym(e,_t234);}(e.attributes);var _t235=[];if(e.children)if(og(e.children))_t235.push(e.children);else{var _iterator360=_createForOfIteratorHelper(e.children),_step360;try{for(_iterator360.s();!(_step360=_iterator360.n()).done;){var _i292=_step360.value;sg(_i292)||ng(_i292)||uo(_i292)?_t235.push(_i292):_t235.push(new Hm(_i292));}}catch(err){_iterator360.e(err);}finally{_iterator360.f();}}e.children=_t235;}return e;}function Ym(e,t){e[t]=gr(e[t]);}function Xm(e,t){return ig(t)?e:ig(e)?t:"".concat(e," ").concat(t);}function eg(e,t){for(var _i293 in t){var _e$_i;e[_i293]?(_e$_i=e[_i293]).push.apply(_e$_i,_toConsumableArray(t[_i293])):e[_i293]=t[_i293];}}function tg(e,t){var _e$text;if(t.attributes&&(e.attributes||(e.attributes={}),eg(e.attributes,t.attributes)),t.eventListeners&&(e.eventListeners||(e.eventListeners={}),eg(e.eventListeners,t.eventListeners)),t.text&&(_e$text=e.text).push.apply(_e$text,_toConsumableArray(t.text)),t.children&&t.children.length){if(e.children.length!=t.children.length)throw new A("ui-template-extend-children-mismatch",e);var _i294=0;var _iterator361=_createForOfIteratorHelper(t.children),_step361;try{for(_iterator361.s();!(_step361=_iterator361.n()).done;){var _n153=_step361.value;tg(e.children[_i294++],_n153);}}catch(err){_iterator361.e(err);}finally{_iterator361.f();}}}function ig(e){return!e&&0!==e;}function ng(e){return e instanceof lg;}function sg(e){return e instanceof Hm;}function og(e){return e instanceof zm;}function rg(e){return ue(e[0])&&e[0].ns;}function ag(e){return"class"==e||"style"==e;}var lg=/*#__PURE__*/function(_go3){function lg(e){var _this172;_classCallCheck(this,lg);_this172=_callSuper(this,lg),_defineProperty(_assertThisInitialized(_this172),"element",void 0),_defineProperty(_assertThisInitialized(_this172),"isRendered",void 0),_defineProperty(_assertThisInitialized(_this172),"locale",void 0),_defineProperty(_assertThisInitialized(_this172),"t",void 0),_defineProperty(_assertThisInitialized(_this172),"template",void 0),_defineProperty(_assertThisInitialized(_this172),"_viewCollections",void 0),_defineProperty(_assertThisInitialized(_this172),"_unboundChildren",void 0),_defineProperty(_assertThisInitialized(_this172),"_bindTemplate",void 0),_this172.element=null,_this172.isRendered=!1,_this172.locale=e,_this172.t=e&&e.t,_this172._viewCollections=new br(),_this172._unboundChildren=_this172.createCollection(),_this172._viewCollections.on("add",function(t,i){i.locale=e,i.t=e&&e.t;}),_this172.decorate("render");return _this172;}_inherits(lg,_go3);return _createClass(lg,[{key:"bindTemplate",get:function get(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Hm.bind(this,this);}},{key:"createCollection",value:function createCollection(e){var t=new zm(e);return this._viewCollections.add(t),t;}},{key:"registerChild",value:function registerChild(e){oo(e)||(e=[e]);var _iterator362=_createForOfIteratorHelper(e),_step362;try{for(_iterator362.s();!(_step362=_iterator362.n()).done;){var _t236=_step362.value;this._unboundChildren.add(_t236);}}catch(err){_iterator362.e(err);}finally{_iterator362.f();}}},{key:"deregisterChild",value:function deregisterChild(e){oo(e)||(e=[e]);var _iterator363=_createForOfIteratorHelper(e),_step363;try{for(_iterator363.s();!(_step363=_iterator363.n()).done;){var _t237=_step363.value;this._unboundChildren.remove(_t237);}}catch(err){_iterator363.e(err);}finally{_iterator363.f();}}},{key:"setTemplate",value:function setTemplate(e){this.template=new Hm(e);}},{key:"extendTemplate",value:function extendTemplate(e){Hm.extend(this.template,e);}},{key:"render",value:function render(){if(this.isRendered)throw new A("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0;}},{key:"destroy",value:function destroy(){this.stopListening(),this._viewCollections.map(function(e){return e.destroy();}),this.template&&this.template._revertData&&this.template.revert(this.element);}}]);}(go(Zs()));function cg(_ref64){var e=_ref64.emitter,t=_ref64.activator,i=_ref64.callback,n=_ref64.contextElements,s=_ref64.listenerOptions;e.listenTo(document,"mousedown",function(e,s){if(!t())return;var o="function"==typeof s.composedPath?s.composedPath():[],r="function"==typeof n?n():n;var _iterator364=_createForOfIteratorHelper(r),_step364;try{for(_iterator364.s();!(_step364=_iterator364.n()).done;){var _e372=_step364.value;if(_e372.contains(s.target)||o.includes(_e372))return;}}catch(err){_iterator364.e(err);}finally{_iterator364.f();}i();},s);}function dg(e){var t=e;t.set("_isCssTransitionsDisabled",!1),t.disableCssTransitions=function(){t._isCssTransitionsDisabled=!0;},t.enableCssTransitions=function(){t._isCssTransitionsDisabled=!1;},t.extendTemplate({attributes:{"class":[t.bindTemplate["if"]("_isCssTransitionsDisabled","ck-transitions-disabled")]}});}function ug(e){return/*#__PURE__*/function(_e373){function _class6(){var _this173;_classCallCheck(this,_class6);for(var _len44=arguments.length,e=new Array(_len44),_key44=0;_key44<_len44;_key44++){e[_key44]=arguments[_key44];}_this173=_callSuper(this,_class6,[].concat(e)),_this173.set("_isCssTransitionsDisabled",!1),_this173.initializeCssTransitionDisablerMixin();return _this173;}_inherits(_class6,_e373);return _createClass(_class6,[{key:"disableCssTransitions",value:function disableCssTransitions(){this._isCssTransitionsDisabled=!0;}},{key:"enableCssTransitions",value:function enableCssTransitions(){this._isCssTransitionsDisabled=!1;}},{key:"initializeCssTransitionDisablerMixin",value:function initializeCssTransitionDisablerMixin(){this.extendTemplate({attributes:{"class":[this.bindTemplate["if"]("_isCssTransitionsDisabled","ck-transitions-disabled")]}});}}]);}(e);}function hg(_ref65){var e=_ref65.view;e.listenTo(e.element,"submit",function(t,i){i.preventDefault(),e.fire("submit");},{useCapture:!0});}function mg(_ref66){var e=_ref66.keystrokeHandler,t=_ref66.focusTracker,i=_ref66.gridItems,n=_ref66.numberOfColumns,s=_ref66.uiLanguageDirection;var o="number"==typeof n?function(){return n;}:n;function r(e){return function(n){var s=i.find(function(e){return e.element===t.focusedElement;}),o=i.getIndex(s),r=e(o,i);i.get(r).focus(),n.stopPropagation(),n.preventDefault();};}function a(e,t){return e===t-1?0:e+1;}function l(e,t){return 0===e?t-1:e-1;}e.set("arrowright",r(function(e,t){return"rtl"===s?l(e,t.length):a(e,t.length);})),e.set("arrowleft",r(function(e,t){return"rtl"===s?a(e,t.length):l(e,t.length);})),e.set("arrowup",r(function(e,t){var i=e-o();return i<0&&(i=e+o()*Math.floor(t.length/o()),i>t.length-1&&(i-=o())),i;})),e.set("arrowdown",r(function(e,t){var i=e+o();return i>t.length-1&&(i=e%o()),i;}));}var gg=/*#__PURE__*/function(_lg2){function gg(){var _this174;_classCallCheck(this,gg);_this174=_callSuper(this,gg);var e=_this174.bindTemplate;_this174.set("content",""),_this174.set("viewBox","0 0 20 20"),_this174.set("fillColor",""),_this174.set("isColorInherited",!0),_this174.set("isVisible",!0),_this174.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{"class":["ck","ck-icon",e["if"]("isVisible","ck-hidden",function(e){return!e;}),"ck-reset_all-excluded",e["if"]("isColorInherited","ck-icon_inherit-color")],viewBox:e.to("viewBox")}});return _this174;}_inherits(gg,_lg2);return _createClass(gg,[{key:"render",value:function render(){var _this175=this;_superPropGet(gg,"render",this,3)([]),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",function(){_this175._updateXMLContent(),_this175._colorFillPaths();}),this.on("change:fillColor",function(){_this175._colorFillPaths();});}},{key:"_updateXMLContent",value:function _updateXMLContent(){if(this.content){var _e374=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),_t238=_e374.getAttribute("viewBox");_t238&&(this.viewBox=_t238);for(var _i295=0,_Array$from8=Array.from(_e374.attributes);_i295<_Array$from8.length;_i295++){var _Array$from8$_i=_Array$from8[_i295],_t239=_Array$from8$_i.name,_i296=_Array$from8$_i.value;gg.presentationalAttributeNames.includes(_t239)&&this.element.setAttribute(_t239,_i296);}for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;_e374.childNodes.length>0;)this.element.appendChild(_e374.childNodes[0]);}}},{key:"_colorFillPaths",value:function _colorFillPaths(){var _this176=this;this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(function(e){e.style.fill=_this176.fillColor;});}}]);}(lg);_defineProperty(gg,"presentationalAttributeNames",["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"]);var fg=/*#__PURE__*/function(_lg3){function fg(){var _this177;_classCallCheck(this,fg);_this177=_callSuper(this,fg),_this177.set({style:void 0,text:void 0,id:void 0});var e=_this177.bindTemplate;_this177.setTemplate({tag:"span",attributes:{"class":["ck","ck-button__label"],style:e.to("style"),id:e.to("id")},children:[{text:e.to("text")}]});return _this177;}_inherits(fg,_lg3);return _createClass(fg);}(lg);var pg=/*#__PURE__*/function(_lg4){function pg(e){var _this178;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new fg();_classCallCheck(this,pg);_this178=_callSuper(this,pg,[e]);_defineProperty(_this178,"children",void 0);_defineProperty(_this178,"labelView",void 0);_defineProperty(_this178,"iconView",void 0);_defineProperty(_this178,"keystrokeView",void 0);_defineProperty(_this178,"_focusDelayed",null);var i=_this178.bindTemplate,n=k();_this178.set("_ariaPressed",!1),_this178.set("_ariaChecked",!1),_this178.set("ariaLabel",void 0),_this178.set("ariaLabelledBy","ck-editor__aria-label_".concat(n)),_this178.set("class",void 0),_this178.set("labelStyle",void 0),_this178.set("icon",void 0),_this178.set("isEnabled",!0),_this178.set("isOn",!1),_this178.set("isVisible",!0),_this178.set("isToggleable",!1),_this178.set("keystroke",void 0),_this178.set("label",void 0),_this178.set("role",void 0),_this178.set("tabindex",-1),_this178.set("tooltip",!1),_this178.set("tooltipPosition","s"),_this178.set("type","button"),_this178.set("withText",!1),_this178.set("withKeystroke",!1),_this178.children=_this178.createCollection(),_this178.labelView=_this178._setupLabelView(t),_this178.iconView=new gg(),_this178.iconView.extendTemplate({attributes:{"class":"ck-button__icon"}}),_this178.keystrokeView=_this178._createKeystrokeView(),_this178.bind("_tooltipString").to(_this178,"tooltip",_this178,"label",_this178,"keystroke",_this178._getTooltipString.bind(_this178));var s={tag:"button",attributes:{"class":["ck","ck-button",i.to("class"),i["if"]("isEnabled","ck-disabled",function(e){return!e;}),i["if"]("isVisible","ck-hidden",function(e){return!e;}),i.to("isOn",function(e){return e?"ck-on":"ck-off";}),i["if"]("withText","ck-button_with-text"),i["if"]("withKeystroke","ck-button_with-keystroke")],role:i.to("role"),type:i.to("type",function(e){return e||"button";}),tabindex:i.to("tabindex"),"aria-checked":i.to("_ariaChecked"),"aria-pressed":i.to("_ariaPressed"),"aria-label":i.to("ariaLabel"),"aria-labelledby":i.to("ariaLabelledBy"),"aria-disabled":i["if"]("isEnabled",!0,function(e){return!e;}),"data-cke-tooltip-text":i.to("_tooltipString"),"data-cke-tooltip-position":i.to("tooltipPosition")},children:_this178.children,on:{click:i.to(function(e){_this178.isEnabled?_this178.fire("execute"):e.preventDefault();})}};_this178.bind("_ariaPressed").to(_this178,"isOn",_this178,"isToggleable",_this178,"role",function(e,t,i){return!(!t||bg(i))&&String(!!e);}),_this178.bind("_ariaChecked").to(_this178,"isOn",_this178,"isToggleable",_this178,"role",function(e,t,i){return!(!t||!bg(i))&&String(!!e);}),o.isSafari&&(_this178._focusDelayed||(_this178._focusDelayed=Sr(function(){return _this178.focus();},0)),s.on.mousedown=i.to(function(){_this178._focusDelayed();}),s.on.mouseup=i.to(function(){_this178._focusDelayed.cancel();})),_this178.setTemplate(s);return _this178;}_inherits(pg,_lg4);return _createClass(pg,[{key:"render",value:function render(){_superPropGet(pg,"render",this,3)([]),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView);}},{key:"focus",value:function focus(){this.element.focus();}},{key:"destroy",value:function destroy(){this._focusDelayed&&this._focusDelayed.cancel(),_superPropGet(pg,"destroy",this,3)([]);}},{key:"_setupLabelView",value:function _setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e;}},{key:"_createKeystrokeView",value:function _createKeystrokeView(){var e=new lg();return e.setTemplate({tag:"span",attributes:{"class":["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",function(e){return ar(e);})}]}),e;}},{key:"_getTooltipString",value:function _getTooltipString(e,t,i){return e?"string"==typeof e?e:(i&&(i=ar(i)),e instanceof Function?e(t,i):"".concat(t).concat(i?" (".concat(i,")"):"")):"";}}]);}(lg);function bg(e){switch(e){case"radio":case"checkbox":case"option":case"switch":case"menuitemcheckbox":case"menuitemradio":return!0;default:return!1;}}var wg=/*#__PURE__*/function(_lg5){function wg(e){var _this179;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,wg);_this179=_callSuper(this,wg,[e]);_defineProperty(_this179,"children",void 0);_defineProperty(_this179,"iconView",void 0);var i=_this179.bindTemplate;_this179.set("label",t.label||""),_this179.set("class",t["class"]||null),_this179.children=_this179.createCollection(),_this179.setTemplate({tag:"div",attributes:{"class":["ck","ck-form__header",i.to("class")]},children:_this179.children}),t.icon&&(_this179.iconView=new gg(),_this179.iconView.content=t.icon,_this179.children.add(_this179.iconView));var n=new lg(e);n.setTemplate({tag:"h2",attributes:{"class":["ck","ck-form__header__label"],role:"presentation"},children:[{text:i.to("label")}]}),_this179.children.add(n);return _this179;}_inherits(wg,_lg5);return _createClass(wg);}(lg);var _g=/*#__PURE__*/function(_L21){function _g(e){var _this180;_classCallCheck(this,_g);if(_this180=_callSuper(this,_g),_defineProperty(_assertThisInitialized(_this180),"focusables",void 0),_defineProperty(_assertThisInitialized(_this180),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this180),"keystrokeHandler",void 0),_defineProperty(_assertThisInitialized(_this180),"actions",void 0),_this180.focusables=e.focusables,_this180.focusTracker=e.focusTracker,_this180.keystrokeHandler=e.keystrokeHandler,_this180.actions=e.actions,e.actions&&e.keystrokeHandler){var _loop5=function _loop5(_t240){var i=e.actions[_t240];"string"==typeof i&&(i=[i]);var _iterator365=_createForOfIteratorHelper(i),_step365;try{for(_iterator365.s();!(_step365=_iterator365.n()).done;){var _n154=_step365.value;e.keystrokeHandler.set(_n154,function(e,i){_this180[_t240](),i();},e.keystrokeHandlerOptions);}}catch(err){_iterator365.e(err);}finally{_iterator365.f();}};for(var _t240 in e.actions){_loop5(_t240);}}_this180.on("forwardCycle",function(){return _this180.focusFirst();},{priority:"low"}),_this180.on("backwardCycle",function(){return _this180.focusLast();},{priority:"low"});return _this180;}_inherits(_g,_L21);return _createClass(_g,[{key:"first",get:function get(){return this.focusables.find(vg)||null;}},{key:"last",get:function get(){return this.focusables.filter(vg).slice(-1)[0]||null;}},{key:"next",get:function get(){return this._getDomFocusableItem(1);}},{key:"previous",get:function get(){return this._getDomFocusableItem(-1);}},{key:"current",get:function get(){var _this181=this;var e=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find(function(t,i){var n=t.element===_this181.focusTracker.focusedElement;return n&&(e=i),n;}),e);}},{key:"focusFirst",value:function focusFirst(){this._focus(this.first,1);}},{key:"focusLast",value:function focusLast(){this._focus(this.last,-1);}},{key:"focusNext",value:function focusNext(){var e=this.next;e&&this.focusables.getIndex(e)===this.current||e===this.first?this.fire("forwardCycle"):this._focus(e,1);}},{key:"focusPrevious",value:function focusPrevious(){var e=this.previous;e&&this.focusables.getIndex(e)===this.current||e===this.last?this.fire("backwardCycle"):this._focus(e,-1);}},{key:"chain",value:function chain(e){var _this182=this;var t=function t(){return null===_this182.current?null:_this182.focusables.get(_this182.current);};this.listenTo(e,"forwardCycle",function(e){var i=t();_this182.focusNext(),i!==t()&&e.stop();},{priority:"low"}),this.listenTo(e,"backwardCycle",function(e){var i=t();_this182.focusPrevious(),i!==t()&&e.stop();},{priority:"low"});}},{key:"unchain",value:function unchain(e){this.stopListening(e);}},{key:"_focus",value:function _focus(e,t){e&&this.focusTracker.focusedElement!==e.element&&e.focus(t);}},{key:"_getDomFocusableItem",value:function _getDomFocusableItem(e){var t=this.focusables.length;if(!t)return null;var i=this.current;if(null===i)return this[1===e?"first":"last"];var n=this.focusables.get(i),s=(i+t+e)%t;do{var _i297=this.focusables.get(s);if(vg(_i297)){n=_i297;break;}s=(s+t+e)%t;}while(s!==i);return n;}}]);}(L());function vg(e){return yg(e)&&No(e.element);}function yg(e){return!(!("focus"in e)||"function"!=typeof e.focus);}function kg(e){return yg(e)&&"focusCycler"in e&&e.focusCycler instanceof _g;}function Cg(e){return/*#__PURE__*/function(_e375){function _class7(){var _this183;_classCallCheck(this,_class7);for(var _len45=arguments.length,e=new Array(_len45),_key45=0;_key45<_len45;_key45++){e[_key45]=arguments[_key45];}_this183=_callSuper(this,_class7,[].concat(e)),_defineProperty(_assertThisInitialized(_this183),"_onDragBound",_this183._onDrag.bind(_assertThisInitialized(_this183))),_defineProperty(_assertThisInitialized(_this183),"_onDragEndBound",_this183._onDragEnd.bind(_assertThisInitialized(_this183))),_defineProperty(_assertThisInitialized(_this183),"_lastDraggingCoordinates",{x:0,y:0}),_this183.on("render",function(){_this183._attachListeners();}),_this183.set("isDragging",!1);return _this183;}_inherits(_class7,_e375);return _createClass(_class7,[{key:"_attachListeners",value:function _attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this));}},{key:"_attachDragListeners",value:function _attachDragListeners(){this.listenTo(i.document,"mouseup",this._onDragEndBound),this.listenTo(i.document,"touchend",this._onDragEndBound),this.listenTo(i.document,"mousemove",this._onDragBound),this.listenTo(i.document,"touchmove",this._onDragBound);}},{key:"_detachDragListeners",value:function _detachDragListeners(){this.stopListening(i.document,"mouseup",this._onDragEndBound),this.stopListening(i.document,"touchend",this._onDragEndBound),this.stopListening(i.document,"mousemove",this._onDragBound),this.stopListening(i.document,"touchmove",this._onDragBound);}},{key:"_onDragStart",value:function _onDragStart(e,t){if(!this._isHandleElementPressed(t))return;this._attachDragListeners();var i=0,n=0;t instanceof MouseEvent?(i=t.clientX,n=t.clientY):(i=t.touches[0].clientX,n=t.touches[0].clientY),this._lastDraggingCoordinates={x:i,y:n},this.isDragging=!0;}},{key:"_onDrag",value:function _onDrag(e,t){if(!this.isDragging)return void this._detachDragListeners();var i=0,n=0;t instanceof MouseEvent?(i=t.clientX,n=t.clientY):(i=t.touches[0].clientX,n=t.touches[0].clientY),t.preventDefault(),this.fire("drag",{deltaX:Math.round(i-this._lastDraggingCoordinates.x),deltaY:Math.round(n-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:i,y:n};}},{key:"_onDragEnd",value:function _onDragEnd(){this._detachDragListeners(),this.isDragging=!1;}},{key:"_isHandleElementPressed",value:function _isHandleElementPressed(e){return!!this.dragHandleElement&&(this.dragHandleElement===e.target||e.target instanceof HTMLElement&&this.dragHandleElement.contains(e.target));}}]);}(e);}var xg=/*#__PURE__*/function(_lg6){function xg(e){var _this184;_classCallCheck(this,xg);_this184=_callSuper(this,xg,[e]),_defineProperty(_assertThisInitialized(_this184),"children",void 0),_defineProperty(_assertThisInitialized(_this184),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this184),"focusCycler",void 0),_defineProperty(_assertThisInitialized(_this184),"_focusTracker",void 0),_defineProperty(_assertThisInitialized(_this184),"_focusables",void 0),_this184.children=_this184.createCollection(),_this184.keystrokes=new Cr(),_this184._focusTracker=new _r(),_this184._focusables=new zm(),_this184.focusCycler=new _g({focusables:_this184._focusables,focusTracker:_this184._focusTracker,keystrokeHandler:_this184.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this184.setTemplate({tag:"div",attributes:{"class":["ck","ck-dialog__actions"]},children:_this184.children});return _this184;}_inherits(xg,_lg6);return _createClass(xg,[{key:"render",value:function render(){_superPropGet(xg,"render",this,3)([]),this.keystrokes.listenTo(this.element);}},{key:"setButtons",value:function setButtons(e){var _this185=this;var _iterator366=_createForOfIteratorHelper(e),_step366;try{var _loop6=function _loop6(){var t=_step366.value;var e=new pg(_this185.locale);var i;for(i in e.on("execute",function(){return t.onExecute();}),t.onCreate&&t.onCreate(e),t)"onExecute"!=i&&"onCreate"!=i&&e.set(i,t[i]);_this185.children.add(e);};for(_iterator366.s();!(_step366=_iterator366.n()).done;){_loop6();}}catch(err){_iterator366.e(err);}finally{_iterator366.f();}this._updateFocusCyclableItems();}},{key:"focus",value:function focus(e){-1===e?this.focusCycler.focusLast():this.focusCycler.focusFirst();}},{key:"_updateFocusCyclableItems",value:function _updateFocusCyclableItems(){var _this186=this;Array.from(this.children).forEach(function(e){_this186._focusables.add(e),_this186._focusTracker.add(e.element);});}}]);}(lg);var Ag=/*#__PURE__*/function(_lg7){function Ag(e){var _this187;_classCallCheck(this,Ag);_this187=_callSuper(this,Ag,[e]),_defineProperty(_assertThisInitialized(_this187),"children",void 0),_this187.children=_this187.createCollection(),_this187.setTemplate({tag:"div",attributes:{"class":["ck","ck-dialog__content"]},children:_this187.children});return _this187;}_inherits(Ag,_lg7);return _createClass(Ag,[{key:"reset",value:function reset(){for(;this.children.length;)this.children.remove(0);}}]);}(lg);var Eg={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},Tg=Oo("px");var Pg=/*#__PURE__*/function(_Cg){function Pg(e,_ref67){var _this188;var t=_ref67.getCurrentDomRoot,i=_ref67.getViewportOffset;_classCallCheck(this,Pg);_this188=_callSuper(this,Pg,[e]);_defineProperty(_this188,"parts",void 0);_defineProperty(_this188,"headerView",void 0);_defineProperty(_this188,"closeButtonView",void 0);_defineProperty(_this188,"actionsView",void 0);_defineProperty(_this188,"contentView",void 0);_defineProperty(_this188,"keystrokes",void 0);_defineProperty(_this188,"focusTracker",void 0);_defineProperty(_this188,"wasMoved",!1);_defineProperty(_this188,"_getCurrentDomRoot",void 0);_defineProperty(_this188,"_getViewportOffset",void 0);_defineProperty(_this188,"_focusables",void 0);_defineProperty(_this188,"_focusCycler",void 0);var n=_this188.bindTemplate,s=e.t;_this188.set("className",""),_this188.set("ariaLabel",s("Editor dialog")),_this188.set("isModal",!1),_this188.set("position",Eg.SCREEN_CENTER),_this188.set("_isVisible",!1),_this188.set("_isTransparent",!1),_this188.set("_top",0),_this188.set("_left",0),_this188._getCurrentDomRoot=t,_this188._getViewportOffset=i,_this188.decorate("moveTo"),_this188.parts=_this188.createCollection(),_this188.keystrokes=new Cr(),_this188.focusTracker=new _r(),_this188._focusables=new zm(),_this188._focusCycler=new _g({focusables:_this188._focusables,focusTracker:_this188.focusTracker,keystrokeHandler:_this188.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this188.setTemplate({tag:"div",attributes:{"class":["ck","ck-dialog-overlay",n["if"]("isModal","ck-dialog-overlay__transparent",function(e){return!e;}),n["if"]("_isVisible","ck-hidden",function(e){return!e;})],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1","class":["ck","ck-dialog",n["if"]("isModal","ck-dialog_modal"),n.to("className")],role:"dialog","aria-label":n.to("ariaLabel"),style:{top:n.to("_top",function(e){return Tg(e);}),left:n.to("_left",function(e){return Tg(e);}),visibility:n["if"]("_isTransparent","hidden")}},children:_this188.parts}]});return _this188;}_inherits(Pg,_Cg);return _createClass(Pg,[{key:"render",value:function render(){var _this189=this;_superPropGet(Pg,"render",this,3)([]),this.keystrokes.set("Esc",function(e,t){_this189.fire("close",{source:"escKeyPress"}),t();}),this.on("drag",function(e,_ref68){var t=_ref68.deltaX,i=_ref68.deltaY;_this189.wasMoved=!0,_this189.moveBy(t,i);}),this.listenTo(i.window,"resize",function(){_this189._isVisible&&!_this189.wasMoved&&_this189.updatePosition();}),this.listenTo(i.document,"scroll",function(){_this189._isVisible&&!_this189.wasMoved&&_this189.updatePosition();}),this.on("change:_isVisible",function(e,t,i){i&&(_this189._isTransparent=!0,setTimeout(function(){_this189.updatePosition(),_this189._isTransparent=!1,_this189.focus();},10));}),this.keystrokes.listenTo(this.element);}},{key:"dragHandleElement",get:function get(){return this.headerView&&!this.isModal?this.headerView.element:null;}},{key:"setupParts",value:function setupParts(_ref69){var e=_ref69.icon,t=_ref69.title,_ref69$hasCloseButton=_ref69.hasCloseButton,i=_ref69$hasCloseButton===void 0?!0:_ref69$hasCloseButton,n=_ref69.content,s=_ref69.actionButtons;t&&(this.headerView=new wg(this.locale,{icon:e}),i&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=t,this.ariaLabel=t,this.parts.add(this.headerView,0)),n&&(n instanceof lg&&(n=[n]),this.contentView=new Ag(this.locale),this.contentView.children.addMany(n),this.parts.add(this.contentView)),s&&(this.actionsView=new xg(this.locale),this.actionsView.setButtons(s),this.parts.add(this.actionsView)),this._updateFocusCyclableItems();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"moveTo",value:function moveTo(e,t){var i=this._getViewportRect(),n=this._getDialogRect();e+n.width>i.right&&(e=i.right-n.width),e<i.left&&(e=i.left),t<i.top&&(t=i.top),this._moveTo(e,t);}},{key:"_moveTo",value:function _moveTo(e,t){this._left=e,this._top=t;}},{key:"moveBy",value:function moveBy(e,t){this.moveTo(this._left+e,this._top+t);}},{key:"_moveOffScreen",value:function _moveOffScreen(){this._moveTo(-9999,-9999);}},{key:"updatePosition",value:function updatePosition(){if(!this.element||!this.element.parentNode)return;var e=this._getViewportRect();var t,i=this.position;this._getCurrentDomRoot()?t=this._getVisibleDomRootRect(e):i=Eg.SCREEN_CENTER;var n=Pg.defaultOffset,s=this._getDialogRect();switch(i){case Eg.EDITOR_TOP_SIDE:if(t){var _e376="ltr"===this.locale.contentLanguageDirection?t.right-s.width-n:t.left+n;this.moveTo(_e376,t.top+n);}else this._moveOffScreen();break;case Eg.EDITOR_CENTER:t?this.moveTo(Math.round(t.left+t.width/2-s.width/2),Math.round(t.top+t.height/2-s.height/2)):this._moveOffScreen();break;case Eg.SCREEN_CENTER:this.moveTo(Math.round((e.width-s.width)/2),Math.round((e.height-s.height)/2));break;case Eg.EDITOR_TOP_CENTER:t?this.moveTo(Math.round(t.left+t.width/2-s.width/2),t.top+n):this._moveOffScreen();break;case Eg.EDITOR_BOTTOM_CENTER:t?this.moveTo(Math.round(t.left+t.width/2-s.width/2),t.bottom-s.height-n):this._moveOffScreen();break;case Eg.EDITOR_ABOVE_CENTER:t?this.moveTo(Math.round(t.left+t.width/2-s.width/2),t.top-s.height-n):this._moveOffScreen();break;case Eg.EDITOR_BELOW_CENTER:t?this.moveTo(Math.round(t.left+t.width/2-s.width/2),t.bottom+n):this._moveOffScreen();}}},{key:"_getVisibleDomRootRect",value:function _getVisibleDomRootRect(e){var t=new Eo(this._getCurrentDomRoot()).getVisible();return t?(t=e.getIntersection(t),t||null):null;}},{key:"_getDialogRect",value:function _getDialogRect(){return new Eo(this.element.firstElementChild);}},{key:"_getViewportRect",value:function _getViewportRect(){var e=new Eo(i.window);if(this.isModal)return e;var t=_objectSpread({top:0,bottom:0,left:0,right:0},this._getViewportOffset());return e.top+=t.top,e.height-=t.top,e.bottom-=t.bottom,e.height-=t.bottom,e.left+=t.left,e.right-=t.right,e.width-=t.left+t.right,e;}},{key:"_updateFocusCyclableItems",value:function _updateFocusCyclableItems(){var _this190=this;var e=[];if(this.contentView){var _iterator367=_createForOfIteratorHelper(this.contentView.children),_step367;try{for(_iterator367.s();!(_step367=_iterator367.n()).done;){var _t241=_step367.value;yg(_t241)&&e.push(_t241);}}catch(err){_iterator367.e(err);}finally{_iterator367.f();}}this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(function(e){_this190._focusables.add(e),_this190.focusTracker.add(e.element),kg(e)&&_this190._focusCycler.chain(e.focusCycler);});}},{key:"_createCloseButton",value:function _createCloseButton(){var _this191=this;var e=new pg(this.locale),t=this.locale.t;return e.set({label:t("Close"),tooltip:!0,icon:vm.cancel}),e.on("execute",function(){return _this191.fire("close",{source:"closeButton"});}),e;}}]);}(Cg(lg));_defineProperty(Pg,"defaultOffset",15);var Sg=/*#__PURE__*/function(_Dr7){function Sg(e){var _this192;_classCallCheck(this,Sg);_this192=_callSuper(this,Sg,[e]);_defineProperty(_this192,"view",void 0);_defineProperty(_this192,"_onHide",void 0);var t=e.t;_this192._initShowHideListeners(),_this192._initFocusToggler(),_this192._initMultiRootIntegration(),_this192.set({id:null,isOpen:!1}),e.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:t("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]});return _this192;}_inherits(Sg,_Dr7);return _createClass(Sg,[{key:"destroy",value:function destroy(){_superPropGet(Sg,"destroy",this,3)([]),this._unlockBodyScroll();}},{key:"_initShowHideListeners",value:function _initShowHideListeners(){var _this193=this;this.on("show",function(e,t){_this193._show(t);}),this.on("show",function(e,t){t.onShow&&t.onShow(_this193);},{priority:"low"}),this.on("hide",function(){Sg._visibleDialogPlugin&&Sg._visibleDialogPlugin._hide();}),this.on("hide",function(){_this193._onHide&&(_this193._onHide(_this193),_this193._onHide=void 0);},{priority:"low"});}},{key:"_initFocusToggler",value:function _initFocusToggler(){var _this194=this;var e=this.editor;e.keystrokes.set("Ctrl+F6",function(t,i){_this194.isOpen&&!_this194.view.isModal&&(_this194.view.focusTracker.isFocused?e.editing.view.focus():_this194.view.focus(),i());});}},{key:"_initMultiRootIntegration",value:function _initMultiRootIntegration(){var _this195=this;var e=this.editor.model;e.document.on("change:data",function(){if(!_this195.view)return;var t=e.document.differ.getChangedRoots();var _iterator368=_createForOfIteratorHelper(t),_step368;try{for(_iterator368.s();!(_step368=_iterator368.n()).done;){var _e377=_step368.value;_e377.state&&_this195.view.updatePosition();}}catch(err){_iterator368.e(err);}finally{_iterator368.f();}});}},{key:"show",value:function show(e){this.hide(),this.fire("show:".concat(e.id),e);}},{key:"_show",value:function _show(_ref70){var _this196=this;var e=_ref70.id,t=_ref70.icon,i=_ref70.title,_ref70$hasCloseButton=_ref70.hasCloseButton,n=_ref70$hasCloseButton===void 0?!0:_ref70$hasCloseButton,s=_ref70.content,o=_ref70.actionButtons,r=_ref70.className,a=_ref70.isModal,l=_ref70.position,c=_ref70.onHide;var d=this.editor;this.view=new Pg(d.locale,{getCurrentDomRoot:function getCurrentDomRoot(){return d.editing.view.getDomRoot(d.model.document.selection.anchor.root.rootName);},getViewportOffset:function getViewportOffset(){return d.ui.viewportOffset;}});var u=this.view;u.on("close",function(){_this196.hide();}),d.ui.view.body.add(u),d.keystrokes.listenTo(u.element),l||(l=a?Eg.SCREEN_CENTER:Eg.EDITOR_CENTER),a&&this._lockBodyScroll(),u.set({position:l,_isVisible:!0,className:r,isModal:a}),u.setupParts({icon:t,title:i,hasCloseButton:n,content:s,actionButtons:o}),this.id=e,c&&(this._onHide=c),this.isOpen=!0,Sg._visibleDialogPlugin=this;}},{key:"hide",value:function hide(){Sg._visibleDialogPlugin&&Sg._visibleDialogPlugin.fire("hide:".concat(Sg._visibleDialogPlugin.id));}},{key:"_hide",value:function _hide(){if(!this.view)return;var e=this.editor,t=this.view;t.isModal&&this._unlockBodyScroll(),t.contentView&&t.contentView.reset(),e.ui.view.body.remove(t),e.ui.focusTracker.remove(t.element),e.keystrokes.stopListening(t.element),t.destroy(),e.editing.view.focus(),this.id=null,this.isOpen=!1,Sg._visibleDialogPlugin=null;}},{key:"_lockBodyScroll",value:function _lockBodyScroll(){document.documentElement.classList.add("ck-dialog-scroll-locked");}},{key:"_unlockBodyScroll",value:function _unlockBodyScroll(){document.documentElement.classList.remove("ck-dialog-scroll-locked");}}],[{key:"pluginName",get:function get(){return"Dialog";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);_defineProperty(Sg,"_visibleDialogPlugin",void 0);var Ig=/*#__PURE__*/function(_pg2){function Ig(e){var _this197;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new fg();_classCallCheck(this,Ig);_this197=_callSuper(this,Ig,[e,t]),_defineProperty(_assertThisInitialized(_this197),"_checkIconHolderView",new Vg()),_this197.set({hasCheckSpace:!1,_hasCheck:_this197.isToggleable});var i=_this197.bindTemplate;_this197.extendTemplate({attributes:{"class":["ck-list-item-button",i["if"]("isToggleable","ck-list-item-button_toggleable")]}}),_this197.bind("_hasCheck").to(_this197,"hasCheckSpace",_this197,"isToggleable",function(e,t){return e||t;});return _this197;}_inherits(Ig,_pg2);return _createClass(Ig,[{key:"render",value:function render(){_superPropGet(Ig,"render",this,3)([]),this._hasCheck&&this.children.add(this._checkIconHolderView,0),this._watchCheckIconHolderMount();}},{key:"_watchCheckIconHolderMount",value:function _watchCheckIconHolderMount(){var _this198=this;this._checkIconHolderView.bind("isOn").to(this,"isOn",function(e){return _this198.isToggleable&&e;}),this.on("change:_hasCheck",function(e,t,i){var n=_this198.children,s=_this198._checkIconHolderView;i?n.add(s,0):n.remove(s);});}}]);}(pg);var Vg=/*#__PURE__*/function(_lg8){function Vg(){var _this199;_classCallCheck(this,Vg);_this199=_callSuper(this,Vg);_defineProperty(_this199,"children",void 0);_defineProperty(_this199,"_checkIconView",_this199._createCheckIconView());var e=_this199.bindTemplate;_this199.children=_this199.createCollection(),_this199.set("isOn",!1),_this199.setTemplate({tag:"span",children:_this199.children,attributes:{"class":["ck","ck-list-item-button__check-holder",e.to("isOn",function(e){return e?"ck-on":"ck-off";})]}});return _this199;}_inherits(Vg,_lg8);return _createClass(Vg,[{key:"render",value:function render(){_superPropGet(Vg,"render",this,3)([]),this.isOn&&this.children.add(this._checkIconView,0),this._watchCheckIconMount();}},{key:"_watchCheckIconMount",value:function _watchCheckIconMount(){var _this200=this;this.on("change:isOn",function(e,t,i){var n=_this200.children,s=_this200._checkIconView;i&&!n.has(s)?n.add(s):!i&&n.has(s)&&n.remove(s);});}},{key:"_createCheckIconView",value:function _createCheckIconView(){var e=new gg();return e.content=vm.check,e.extendTemplate({attributes:{"class":"ck-list-item-button__check-icon"}}),e;}}]);}(lg);var Rg=/*#__PURE__*/function(_Ig2){function Rg(e){var _this201;_classCallCheck(this,Rg);_this201=_callSuper(this,Rg,[e]),_this201.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),_this201.extendTemplate({attributes:{"class":["ck-menu-bar__menu__item__button"]}});return _this201;}_inherits(Rg,_Ig2);return _createClass(Rg);}(Ig);var Og=/*#__PURE__*/function(_lg9){function Og(e){var _this202;_classCallCheck(this,Og);_this202=_callSuper(this,Og,[e]),_defineProperty(_assertThisInitialized(_this202),"id",void 0),_this202.set("text",void 0),_this202.set("for",void 0),_this202.id="ck-editor__label_".concat(k());var t=_this202.bindTemplate;_this202.setTemplate({tag:"label",attributes:{"class":["ck","ck-label"],id:_this202.id,"for":t.to("for")},children:[{text:t.to("text")}]});return _this202;}_inherits(Og,_lg9);return _createClass(Og);}(lg);var Bg=/*#__PURE__*/function(_lg10){function Bg(e,t){var _this203;_classCallCheck(this,Bg);_this203=_callSuper(this,Bg,[e]);var i=e.t,n=new Og();n.text=i("Help Contents. To close this dialog press ESC."),_this203.setTemplate({tag:"div",attributes:{"class":["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":n.id,role:"document",tabindex:-1},children:[ro(document,"p",{},i("Below, you can find a list of keyboard shortcuts that can be used in the editor."))].concat(_toConsumableArray(_this203._createCategories(Array.from(t.values()))),[n])});return _this203;}_inherits(Bg,_lg10);return _createClass(Bg,[{key:"focus",value:function focus(){this.element.focus();}},{key:"_createCategories",value:function _createCategories(e){var _this204=this;return e.map(function(e){var t=[ro(document,"h3",{},e.label)].concat(_toConsumableArray(Array.from(e.groups.values()).map(function(e){return _this204._createGroup(e);}).flat()));return e.description&&t.splice(1,0,ro(document,"p",{},e.description)),ro(document,"section",{},t);});}},{key:"_createGroup",value:function _createGroup(e){var _this205=this;var t=e.keystrokes.sort(function(e,t){return e.label.localeCompare(t.label);}).map(function(e){return _this205._createGroupRow(e);}).flat(),i=[ro(document,"dl",{},t)];return e.label&&i.unshift(ro(document,"h4",{},e.label)),i;}},{key:"_createGroupRow",value:function _createGroupRow(e){var t=this.locale.t,i=ro(document,"dt"),n=ro(document,"dd"),s=function(e){if("string"==typeof e)return[[e]];if("string"==typeof e[0])return[e];return e;}(e.keystroke),r=[];var _iterator369=_createForOfIteratorHelper(s),_step369;try{for(_iterator369.s();!(_step369=_iterator369.n()).done;){var _e378=_step369.value;r.push(_e378.map(Mg).join(""));}}catch(err){_iterator369.e(err);}finally{_iterator369.f();}return i.innerHTML=e.label,n.innerHTML=r.join(", ")+(e.mayRequireFn&&o.isMac?" ".concat(t("(may require <kbd>Fn</kbd>)")):""),[i,n];}}]);}(lg);function Mg(e){return ar(e).split("+").map(function(e){return"<kbd>".concat(e,"</kbd>");}).join("+");}var Lg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>';var Fg=/*#__PURE__*/function(_Dr8){function Fg(){var _this206;_classCallCheck(this,Fg);for(var _len46=arguments.length,args=new Array(_len46),_key46=0;_key46<_len46;_key46++){args[_key46]=arguments[_key46];}_this206=_callSuper(this,Fg,[].concat(args));_defineProperty(_this206,"contentView",null);return _this206;}_inherits(Fg,_Dr8);return _createClass(Fg,[{key:"init",value:function init(){var _this207=this;var e=this.editor,t=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",function(){var e=_this207._createButton(pg);return e.set({tooltip:!0,withText:!1,label:t("Accessibility help")}),e;}),e.ui.componentFactory.add("menuBar:accessibilityHelp",function(){var e=_this207._createButton(Rg);return e.label=t("Accessibility"),e;}),e.keystrokes.set("Alt+0",function(e,t){_this207._toggleDialog(),t();}),this._setupRootLabels();}},{key:"_createButton",value:function _createButton(e){var _this208=this;var t=this.editor,i=t.plugins.get("Dialog"),n=new e(t.locale);return n.set({keystroke:"Alt+0",icon:Lg,isToggleable:!0}),n.on("execute",function(){return _this208._toggleDialog();}),n.bind("isOn").to(i,"id",function(e){return"accessibilityHelp"===e;}),n;}},{key:"_setupRootLabels",value:function _setupRootLabels(){var e=this.editor,t=e.editing.view,i=e.t;function n(e,t){var n=[t.getAttribute("aria-label"),i("Press %0 for help.",[ar("Alt+0")])].filter(function(e){return e;}).join(". ");e.setAttribute("aria-label",n,t);}e.ui.on("ready",function(){t.change(function(e){var _iterator370=_createForOfIteratorHelper(t.document.roots),_step370;try{for(_iterator370.s();!(_step370=_iterator370.n()).done;){var _i298=_step370.value;n(e,_i298);}}catch(err){_iterator370.e(err);}finally{_iterator370.f();}}),e.on("addRoot",function(i,s){var o=e.editing.view.document.getRoot(s.rootName);t.change(function(e){return n(e,o);});},{priority:"low"});});}},{key:"_toggleDialog",value:function _toggleDialog(){var e=this.editor,t=e.plugins.get("Dialog"),i=e.locale.t;this.contentView||(this.contentView=new Bg(e.locale,e.accessibility.keystrokeInfos)),"accessibilityHelp"===t.id?t.hide():t.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:i("Accessibility help"),icon:Lg,hasCloseButton:!0,content:this.contentView});}}],[{key:"requires",get:function get(){return[Sg];}},{key:"pluginName",get:function get(){return"AccessibilityHelp";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Ng=/*#__PURE__*/function(_zm2){function Ng(e){var _this209;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,Ng);_this209=_callSuper(this,Ng,[t]),_defineProperty(_assertThisInitialized(_this209),"locale",void 0),_defineProperty(_assertThisInitialized(_this209),"_bodyCollectionContainer",void 0),_this209.locale=e;return _this209;}_inherits(Ng,_zm2);return _createClass(Ng,[{key:"bodyCollectionContainer",get:function get(){return this._bodyCollectionContainer;}},{key:"attachToDom",value:function attachToDom(){this._bodyCollectionContainer=new Hm({tag:"div",attributes:{"class":["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection,role:"application"},children:this}).render();var e=document.querySelector(".ck-body-wrapper");e||(e=ro(document,"div",{"class":"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer);}},{key:"detachFromDom",value:function detachFromDom(){_superPropGet(Ng,"destroy",this,3)([]),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();var e=document.querySelector(".ck-body-wrapper");e&&0==e.childElementCount&&e.remove();}}]);}(zm);var Dg=/*#__PURE__*/function(_pg3){function Dg(e){var _this210;_classCallCheck(this,Dg);_this210=_callSuper(this,Dg,[e]),_defineProperty(_assertThisInitialized(_this210),"toggleSwitchView",void 0),_this210.isToggleable=!0,_this210.toggleSwitchView=_this210._createToggleView(),_this210.extendTemplate({attributes:{"class":"ck-switchbutton"}});return _this210;}_inherits(Dg,_pg3);return _createClass(Dg,[{key:"render",value:function render(){_superPropGet(Dg,"render",this,3)([]),this.children.add(this.toggleSwitchView);}},{key:"_createToggleView",value:function _createToggleView(){var e=new lg();return e.setTemplate({tag:"span",attributes:{"class":["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{"class":["ck","ck-button__toggle__inner"]}}]}),e;}}]);}(pg);var zg=/*#__PURE__*/function(_$g){function zg(){_classCallCheck(this,zg);return _callSuper(this,zg,arguments);}_inherits(zg,_$g);return _createClass(zg);}($g(pg));var Hg=/*#__PURE__*/function(_$g2){function Hg(){_classCallCheck(this,Hg);return _callSuper(this,Hg,arguments);}_inherits(Hg,_$g2);return _createClass(Hg);}($g(Ig));function $g(e){return/*#__PURE__*/function(_e379){function _class8(){var _this211;_classCallCheck(this,_class8);for(var _len47=arguments.length,e=new Array(_len47),_key47=0;_key47<_len47;_key47++){e[_key47]=arguments[_key47];}_this211=_callSuper(this,_class8,[].concat(e)),_defineProperty(_assertThisInitialized(_this211),"buttonView",void 0),_defineProperty(_assertThisInitialized(_this211),"_fileInputView",void 0),_this211.buttonView=_assertThisInitialized(_this211),_this211._fileInputView=new Ug(_this211.locale),_this211._fileInputView.bind("acceptedType").to(_assertThisInitialized(_this211)),_this211._fileInputView.bind("allowMultipleFiles").to(_assertThisInitialized(_this211)),_this211._fileInputView.delegate("done").to(_assertThisInitialized(_this211)),_this211.on("execute",function(){_this211._fileInputView.open();}),_this211.extendTemplate({attributes:{"class":"ck-file-dialog-button"}});return _this211;}_inherits(_class8,_e379);return _createClass(_class8,[{key:"render",value:function render(){_superPropGet(_class8,"render",this,3)([]),this.children.add(this._fileInputView);}}]);}(e);}var Ug=/*#__PURE__*/function(_lg11){function Ug(e){var _this212;_classCallCheck(this,Ug);_this212=_callSuper(this,Ug,[e]),_this212.set("acceptedType",void 0),_this212.set("allowMultipleFiles",!1);var t=_this212.bindTemplate;_this212.setTemplate({tag:"input",attributes:{"class":["ck-hidden"],type:"file",tabindex:"-1",accept:t.to("acceptedType"),multiple:t.to("allowMultipleFiles")},on:{change:t.to(function(){_this212.element&&_this212.element.files&&_this212.element.files.length&&_this212.fire("done",_this212.element.files),_this212.element.value="";})}});return _this212;}_inherits(Ug,_lg11);return _createClass(Ug,[{key:"open",value:function open(){this.element.click();}}]);}(lg);var Wg='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';var jg=/*#__PURE__*/function(_lg12){function jg(e,t){var _this213;_classCallCheck(this,jg);_this213=_callSuper(this,jg,[e]);_defineProperty(_this213,"buttonView",void 0);_defineProperty(_this213,"children",void 0);var i=_this213.bindTemplate;_this213.set("isCollapsed",!1),_this213.set("label",""),_this213.buttonView=_this213._createButtonView(),_this213.children=_this213.createCollection(),_this213.set("_collapsibleAriaLabelUid",void 0),t&&_this213.children.addMany(t),_this213.setTemplate({tag:"div",attributes:{"class":["ck","ck-collapsible",i["if"]("isCollapsed","ck-collapsible_collapsed")]},children:[_this213.buttonView,{tag:"div",attributes:{"class":["ck","ck-collapsible__children"],role:"region",hidden:i["if"]("isCollapsed","hidden"),"aria-labelledby":i.to("_collapsibleAriaLabelUid")},children:_this213.children}]});return _this213;}_inherits(jg,_lg12);return _createClass(jg,[{key:"render",value:function render(){_superPropGet(jg,"render",this,3)([]),this._collapsibleAriaLabelUid=this.buttonView.labelView.element.id;}},{key:"focus",value:function focus(){this.buttonView.focus();}},{key:"_createButtonView",value:function _createButtonView(){var _this214=this;var e=new pg(this.locale),t=e.bindTemplate;return e.set({withText:!0,icon:Wg}),e.extendTemplate({attributes:{"aria-expanded":t.to("isOn",function(e){return String(e);})}}),e.bind("label").to(this),e.bind("isOn").to(this,"isCollapsed",function(e){return!e;}),e.on("execute",function(){_this214.isCollapsed=!_this214.isCollapsed;}),e;}}]);}(lg);function qg(e,t){var i=e.t,n={Black:i("Black"),"Dim grey":i("Dim grey"),Grey:i("Grey"),"Light grey":i("Light grey"),White:i("White"),Red:i("Red"),Orange:i("Orange"),Yellow:i("Yellow"),"Light green":i("Light green"),Green:i("Green"),Aquamarine:i("Aquamarine"),Turquoise:i("Turquoise"),"Light blue":i("Light blue"),Blue:i("Blue"),Purple:i("Purple")};return t.map(function(e){var t=n[e.label];return t&&t!=e.label&&(e.label=t),e;});}function Gg(e){return e.map(Kg).filter(function(e){return!!e;});}function Kg(e){return"string"==typeof e?{model:e,label:e,hasBorder:!1,view:{name:"span",styles:{color:e}}}:{model:e.color,label:e.label||e.color,hasBorder:void 0!==e.hasBorder&&e.hasBorder,view:{name:"span",styles:{color:"".concat(e.color)}}};}var Zg=/*#__PURE__*/function(_pg4){function Zg(e){var _this215;_classCallCheck(this,Zg);_this215=_callSuper(this,Zg,[e]);var t=_this215.bindTemplate;_this215.set("color",void 0),_this215.set("hasBorder",!1),_this215.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',_this215.extendTemplate({attributes:{style:{backgroundColor:t.to("color",function(e){return o.isMediaForcedColors?null:e;})},"class":["ck","ck-color-grid__tile",t["if"]("hasBorder","ck-color-selector__color-tile_bordered")]}});return _this215;}_inherits(Zg,_pg4);return _createClass(Zg,[{key:"render",value:function render(){_superPropGet(Zg,"render",this,3)([]),this.iconView.fillColor="hsl(0, 0%, 100%)";}}]);}(pg);var Jg=/*#__PURE__*/function(_lg13){function Jg(e,t){var _this216;_classCallCheck(this,Jg);_this216=_callSuper(this,Jg,[e]);_defineProperty(_this216,"columns",void 0);_defineProperty(_this216,"items",void 0);_defineProperty(_this216,"focusTracker",void 0);_defineProperty(_this216,"keystrokes",void 0);var i=t&&t.colorDefinitions?t.colorDefinitions:[];_this216.columns=t&&t.columns?t.columns:5;var n={gridTemplateColumns:"repeat( ".concat(_this216.columns,", 1fr)")};_this216.set("selectedColor",void 0),_this216.items=_this216.createCollection(),_this216.focusTracker=new _r(),_this216.keystrokes=new Cr(),_this216.items.on("add",function(e,t){t.isOn=t.color===_this216.selectedColor;}),i.forEach(function(e){var t=new Zg();t.set({color:e.color,label:e.label,tooltip:!0,hasBorder:e.options.hasBorder}),t.on("execute",function(){_this216.fire("execute",{value:e.color,hasBorder:e.options.hasBorder,label:e.label});}),_this216.items.add(t);}),_this216.setTemplate({tag:"div",children:_this216.items,attributes:{"class":["ck","ck-color-grid"],style:n}}),_this216.on("change:selectedColor",function(e,t,i){var _iterator371=_createForOfIteratorHelper(_this216.items),_step371;try{for(_iterator371.s();!(_step371=_iterator371.n()).done;){var _e380=_step371.value;_e380.isOn=_e380.color===i;}}catch(err){_iterator371.e(err);}finally{_iterator371.f();}});return _this216;}_inherits(Jg,_lg13);return _createClass(Jg,[{key:"focus",value:function focus(){this.items.length&&this.items.first.focus();}},{key:"focusLast",value:function focusLast(){this.items.length&&this.items.last.focus();}},{key:"render",value:function render(){var _this217=this;_superPropGet(Jg,"render",this,3)([]);var _iterator372=_createForOfIteratorHelper(this.items),_step372;try{for(_iterator372.s();!(_step372=_iterator372.n()).done;){var _e381=_step372.value;this.focusTracker.add(_e381.element);}}catch(err){_iterator372.e(err);}finally{_iterator372.f();}this.items.on("add",function(e,t){_this217.focusTracker.add(t.element);}),this.items.on("remove",function(e,t){_this217.focusTracker.remove(t.element);}),this.keystrokes.listenTo(this.element),mg({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});}},{key:"destroy",value:function destroy(){_superPropGet(Jg,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}}]);}(lg);var Qg={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Yg={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function Xg(e){var t,i,n=[],s=1;if("string"==typeof e){if(Qg[e])n=Qg[e].slice(),i="rgb";else if("transparent"===e)s=0,i="rgb",n=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var o=e.slice(1);s=1,(l=o.length)<=4?(n=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],4===l&&(s=parseInt(o[3]+o[3],16)/255)):(n=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],8===l&&(s=parseInt(o[6]+o[7],16)/255)),n[0]||(n[0]=0),n[1]||(n[1]=0),n[2]||(n[2]=0),i="rgb";}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var r=t[1],a="rgb"===r;i=o=r.replace(/a$/,"");var l="cmyk"===o?4:"gray"===o?1:3;n=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(e,t){if(/%$/.test(e))return t===l?parseFloat(e)/100:"rgb"===o?255*parseFloat(e)/100:parseFloat(e);if("h"===o[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==Yg[e])return Yg[e];}return parseFloat(e);}),r===o&&n.push(1),s=a||void 0===n[l]?1:n[l],n=n.slice(0,l);}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(n=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e);}),i=e.match(/([a-z])/gi).join("").toLowerCase());}else isNaN(e)?Array.isArray(e)||e.length?(n=[e[0],e[1],e[2]],i="rgb",s=4===e.length?e[3]:1):e instanceof Object&&(null!=e.r||null!=e.red||null!=e.R?(i="rgb",n=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(i="hsl",n=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),s=e.a||e.alpha||e.opacity||1,null!=e.opacity&&(s/=100)):(i="rgb",n=[e>>>16,(65280&e)>>>8,255&e]);return{space:i,values:n,alpha:s};}var ef=Qg,tf={};for(var _i299=0,_Object$keys6=Object.keys(ef);_i299<_Object$keys6.length;_i299++){var _e382=_Object$keys6[_i299];tf[ef[_e382]]=_e382;}var nf={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var sf=nf;for(var _i300=0,_Object$keys7=Object.keys(nf);_i300<_Object$keys7.length;_i300++){var _e383=_Object$keys7[_i300];if(!("channels"in nf[_e383]))throw new Error("missing channels property: "+_e383);if(!("labels"in nf[_e383]))throw new Error("missing channel labels property: "+_e383);if(nf[_e383].labels.length!==nf[_e383].channels)throw new Error("channel and label counts mismatch: "+_e383);var _nf$_e=nf[_e383],_t242=_nf$_e.channels,_i301=_nf$_e.labels;delete nf[_e383].channels,delete nf[_e383].labels,Object.defineProperty(nf[_e383],"channels",{value:_t242}),Object.defineProperty(nf[_e383],"labels",{value:_i301});}function of(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2);}nf.rgb.hsl=function(e){var t=e[0]/255,i=e[1]/255,n=e[2]/255,s=Math.min(t,i,n),o=Math.max(t,i,n),r=o-s;var a,l;o===s?a=0:t===o?a=(i-n)/r:i===o?a=2+(n-t)/r:n===o&&(a=4+(t-i)/r),a=Math.min(60*a,360),a<0&&(a+=360);var c=(s+o)/2;return l=o===s?0:c<=.5?r/(o+s):r/(2-o-s),[a,100*l,100*c];},nf.rgb.hsv=function(e){var t,i,n,s,o;var r=e[0]/255,a=e[1]/255,l=e[2]/255,c=Math.max(r,a,l),d=c-Math.min(r,a,l),u=function u(e){return(c-e)/6/d+.5;};return 0===d?(s=0,o=0):(o=d/c,t=u(r),i=u(a),n=u(l),r===c?s=n-i:a===c?s=1/3+t-n:l===c&&(s=2/3+i-t),s<0?s+=1:s>1&&(s-=1)),[360*s,100*o,100*c];},nf.rgb.hwb=function(e){var t=e[0],i=e[1];var n=e[2];var s=nf.rgb.hsl(e)[0],o=1/255*Math.min(t,Math.min(i,n));return n=1-1/255*Math.max(t,Math.max(i,n)),[s,100*o,100*n];},nf.rgb.cmyk=function(e){var t=e[0]/255,i=e[1]/255,n=e[2]/255,s=Math.min(1-t,1-i,1-n);return[100*((1-t-s)/(1-s)||0),100*((1-i-s)/(1-s)||0),100*((1-n-s)/(1-s)||0),100*s];},nf.rgb.keyword=function(e){var t=tf[e];if(t)return t;var i,n=1/0;for(var _i302=0,_Object$keys8=Object.keys(ef);_i302<_Object$keys8.length;_i302++){var _t243=_Object$keys8[_i302];var _s106=of(e,ef[_t243]);_s106<n&&(n=_s106,i=_t243);}return i;},nf.keyword.rgb=function(e){return ef[e];},nf.rgb.xyz=function(e){var t=e[0]/255,i=e[1]/255,n=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;return[100*(.4124*t+.3576*i+.1805*n),100*(.2126*t+.7152*i+.0722*n),100*(.0193*t+.1192*i+.9505*n)];},nf.rgb.lab=function(e){var t=nf.rgb.xyz(e);var i=t[0],n=t[1],s=t[2];i/=95.047,n/=100,s/=108.883,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116;return[116*n-16,500*(i-n),200*(n-s)];},nf.hsl.rgb=function(e){var t=e[0]/360,i=e[1]/100,n=e[2]/100;var s,o,r;if(0===i)return r=255*n,[r,r,r];s=n<.5?n*(1+i):n+i-n*i;var a=2*n-s,l=[0,0,0];for(var _e384=0;_e384<3;_e384++)o=t+1/3*-(_e384-1),o<0&&o++,o>1&&o--,r=6*o<1?a+6*(s-a)*o:2*o<1?s:3*o<2?a+(s-a)*(2/3-o)*6:a,l[_e384]=255*r;return l;},nf.hsl.hsv=function(e){var t=e[0];var i=e[1]/100,n=e[2]/100,s=i;var o=Math.max(n,.01);n*=2,i*=n<=1?n:2-n,s*=o<=1?o:2-o;return[t,100*(0===n?2*s/(o+s):2*i/(n+i)),100*((n+i)/2)];},nf.hsv.rgb=function(e){var t=e[0]/60,i=e[1]/100;var n=e[2]/100;var s=Math.floor(t)%6,o=t-Math.floor(t),r=255*n*(1-i),a=255*n*(1-i*o),l=255*n*(1-i*(1-o));switch(n*=255,s){case 0:return[n,l,r];case 1:return[a,n,r];case 2:return[r,n,l];case 3:return[r,a,n];case 4:return[l,r,n];case 5:return[n,r,a];}},nf.hsv.hsl=function(e){var t=e[0],i=e[1]/100,n=e[2]/100,s=Math.max(n,.01);var o,r;r=(2-i)*n;var a=(2-i)*s;return o=i*s,o/=a<=1?a:2-a,o=o||0,r/=2,[t,100*o,100*r];},nf.hwb.rgb=function(e){var t=e[0]/360;var i=e[1]/100,n=e[2]/100;var s=i+n;var o;s>1&&(i/=s,n/=s);var r=Math.floor(6*t),a=1-n;o=6*t-r,1&r&&(o=1-o);var l=i+o*(a-i);var c,d,u;switch(r){default:case 6:case 0:c=a,d=l,u=i;break;case 1:c=l,d=a,u=i;break;case 2:c=i,d=a,u=l;break;case 3:c=i,d=l,u=a;break;case 4:c=l,d=i,u=a;break;case 5:c=a,d=i,u=l;}return[255*c,255*d,255*u];},nf.cmyk.rgb=function(e){var t=e[0]/100,i=e[1]/100,n=e[2]/100,s=e[3]/100;return[255*(1-Math.min(1,t*(1-s)+s)),255*(1-Math.min(1,i*(1-s)+s)),255*(1-Math.min(1,n*(1-s)+s))];},nf.xyz.rgb=function(e){var t=e[0]/100,i=e[1]/100,n=e[2]/100;var s,o,r;return s=3.2406*t+-1.5372*i+-.4986*n,o=-.9689*t+1.8758*i+.0415*n,r=.0557*t+-.204*i+1.057*n,s=s>.0031308?1.055*Math.pow(s,1/2.4)-.055:12.92*s,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:12.92*o,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),r=Math.min(Math.max(0,r),1),[255*s,255*o,255*r];},nf.xyz.lab=function(e){var t=e[0],i=e[1],n=e[2];t/=95.047,i/=100,n/=108.883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116;return[116*i-16,500*(t-i),200*(i-n)];},nf.lab.xyz=function(e){var t,i,n;i=(e[0]+16)/116,t=e[1]/500+i,n=i-e[2]/200;var s=Math.pow(i,3),o=Math.pow(t,3),r=Math.pow(n,3);return i=s>.008856?s:(i-16/116)/7.787,t=o>.008856?o:(t-16/116)/7.787,n=r>.008856?r:(n-16/116)/7.787,t*=95.047,i*=100,n*=108.883,[t,i,n];},nf.lab.lch=function(e){var t=e[0],i=e[1],n=e[2];var s;s=360*Math.atan2(n,i)/2/Math.PI,s<0&&(s+=360);return[t,Math.sqrt(i*i+n*n),s];},nf.lch.lab=function(e){var t=e[0],i=e[1],n=e[2]/360*2*Math.PI;return[t,i*Math.cos(n),i*Math.sin(n)];},nf.rgb.ansi16=function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var _e385=_slicedToArray(e,3),i=_e385[0],n=_e385[1],s=_e385[2];var o=null===t?nf.rgb.hsv(e)[2]:t;if(o=Math.round(o/50),0===o)return 30;var r=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(i/255));return 2===o&&(r+=60),r;},nf.hsv.ansi16=function(e){return nf.rgb.ansi16(nf.hsv.rgb(e),e[2]);},nf.rgb.ansi256=function(e){var t=e[0],i=e[1],n=e[2];if(t===i&&i===n)return t<8?16:t>248?231:Math.round((t-8)/247*24)+232;return 16+36*Math.round(t/255*5)+6*Math.round(i/255*5)+Math.round(n/255*5);},nf.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];var i=.5*(1+~~(e>50));return[(1&t)*i*255,(t>>1&1)*i*255,(t>>2&1)*i*255];},nf.ansi256.rgb=function(e){if(e>=232){var _t244=10*(e-232)+8;return[_t244,_t244,_t244];}var t;e-=16;return[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255];},nf.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t;},nf.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var i=t[0];3===t[0].length&&(i=i.split("").map(function(e){return e+e;}).join(""));var n=parseInt(i,16);return[n>>16&255,n>>8&255,255&n];},nf.rgb.hcg=function(e){var t=e[0]/255,i=e[1]/255,n=e[2]/255,s=Math.max(Math.max(t,i),n),o=Math.min(Math.min(t,i),n),r=s-o;var a,l;return a=r<1?o/(1-r):0,l=r<=0?0:s===t?(i-n)/r%6:s===i?2+(n-t)/r:4+(t-i)/r,l/=6,l%=1,[360*l,100*r,100*a];},nf.hsl.hcg=function(e){var t=e[1]/100,i=e[2]/100,n=i<.5?2*t*i:2*t*(1-i);var s=0;return n<1&&(s=(i-.5*n)/(1-n)),[e[0],100*n,100*s];},nf.hsv.hcg=function(e){var t=e[1]/100,i=e[2]/100,n=t*i;var s=0;return n<1&&(s=(i-n)/(1-n)),[e[0],100*n,100*s];},nf.hcg.rgb=function(e){var t=e[0]/360,i=e[1]/100,n=e[2]/100;if(0===i)return[255*n,255*n,255*n];var s=[0,0,0],o=t%1*6,r=o%1,a=1-r;var l=0;switch(Math.floor(o)){case 0:s[0]=1,s[1]=r,s[2]=0;break;case 1:s[0]=a,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=r;break;case 3:s[0]=0,s[1]=a,s[2]=1;break;case 4:s[0]=r,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=a;}return l=(1-i)*n,[255*(i*s[0]+l),255*(i*s[1]+l),255*(i*s[2]+l)];},nf.hcg.hsv=function(e){var t=e[1]/100,i=t+e[2]/100*(1-t);var n=0;return i>0&&(n=t/i),[e[0],100*n,100*i];},nf.hcg.hsl=function(e){var t=e[1]/100,i=e[2]/100*(1-t)+.5*t;var n=0;return i>0&&i<.5?n=t/(2*i):i>=.5&&i<1&&(n=t/(2*(1-i))),[e[0],100*n,100*i];},nf.hcg.hwb=function(e){var t=e[1]/100,i=t+e[2]/100*(1-t);return[e[0],100*(i-t),100*(1-i)];},nf.hwb.hcg=function(e){var t=e[1]/100,i=1-e[2]/100,n=i-t;var s=0;return n<1&&(s=(i-n)/(1-n)),[e[0],100*n,100*s];},nf.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255];},nf.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535];},nf.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255];},nf.gray.hsl=function(e){return[0,0,e[0]];},nf.gray.hsv=nf.gray.hsl,nf.gray.hwb=function(e){return[0,100,e[0]];},nf.gray.cmyk=function(e){return[0,0,0,e[0]];},nf.gray.lab=function(e){return[e[0],0,0];},nf.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i;},nf.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100];};var rf=sf;function af(e){var t=function(){var e={},t=Object.keys(rf);for(var _i303=t.length,_n155=0;_n155<_i303;_n155++)e[t[_n155]]={distance:-1,parent:null};return e;}(),i=[e];for(t[e].distance=0;i.length;){var _e386=i.pop(),_n156=Object.keys(rf[_e386]);for(var _s107=_n156.length,_o57=0;_o57<_s107;_o57++){var _s108=_n156[_o57],_r32=t[_s108];-1===_r32.distance&&(_r32.distance=t[_e386].distance+1,_r32.parent=_e386,i.unshift(_s108));}}return t;}function lf(e,t){return function(i){return t(e(i));};}function cf(e,t){var i=[t[e].parent,e];var n=rf[t[e].parent][e],s=t[e].parent;for(;t[s].parent;)i.unshift(t[s].parent),n=lf(rf[t[s].parent][s],n),s=t[s].parent;return n.conversion=i,n;}var df=sf,uf=function uf(e){var t=af(e),i={},n=Object.keys(t);for(var _e387=n.length,_s109=0;_s109<_e387;_s109++){var _e388=n[_s109];null!==t[_e388].parent&&(i[_e388]=cf(_e388,t));}return i;},hf={};Object.keys(df).forEach(function(e){hf[e]={},Object.defineProperty(hf[e],"channels",{value:df[e].channels}),Object.defineProperty(hf[e],"labels",{value:df[e].labels});var t=uf(e);Object.keys(t).forEach(function(i){var n=t[i];hf[e][i]=function(e){var t=function t(){for(var _len48=arguments.length,t=new Array(_len48),_key48=0;_key48<_len48;_key48++){t[_key48]=arguments[_key48];}var i=t[0];if(null==i)return i;i.length>1&&(t=i);var n=e(t);if("object"==_typeof(n))for(var _e389=n.length,_t245=0;_t245<_e389;_t245++)n[_t245]=Math.round(n[_t245]);return n;};return"conversion"in e&&(t.conversion=e.conversion),t;}(n),hf[e][i].raw=function(e){var t=function t(){for(var _len49=arguments.length,t=new Array(_len49),_key49=0;_key49<_len49;_key49++){t[_key49]=arguments[_key49];}var i=t[0];return null==i?i:(i.length>1&&(t=i),e(t));};return"conversion"in e&&(t.conversion=e.conversion),t;}(n);});});var mf=e({__proto__:null,"default":hf},[hf]);function gf(e,t){if(!e)return"";var i=ff(e);if(!i)return"";if(i.space===t)return e;if(n=i,!Object.keys(mf).includes(n.space))return"";var n;var s=mf[i.space][t];if(!s)return"";return function(e,t){switch(t){case"hex":return"#".concat(e);case"rgb":return"rgb( ".concat(e[0],", ").concat(e[1],", ").concat(e[2]," )");case"hsl":return"hsl( ".concat(e[0],", ").concat(e[1],"%, ").concat(e[2],"% )");case"hwb":return"hwb( ".concat(e[0],", ").concat(e[1],", ").concat(e[2]," )");case"lab":return"lab( ".concat(e[0],"% ").concat(e[1]," ").concat(e[2]," )");case"lch":return"lch( ".concat(e[0],"% ").concat(e[1]," ").concat(e[2]," )");default:return"";}}(s("hex"===i.space?i.hexValue:i.values),t);}function ff(e){if(e.startsWith("#")){var _t246=Xg(e);return{space:"hex",values:_t246.values,hexValue:e,alpha:_t246.alpha};}var t=Xg(e);return t.space?t:null;}var pf=/*#__PURE__*/function(_lg14){function pf(e,t){var _this218;_classCallCheck(this,pf);_this218=_callSuper(this,pf,[e]);_defineProperty(_this218,"fieldView",void 0);_defineProperty(_this218,"labelView",void 0);_defineProperty(_this218,"statusView",void 0);_defineProperty(_this218,"fieldWrapperChildren",void 0);var i="ck-labeled-field-view-".concat(k()),n="ck-labeled-field-view-status-".concat(k());_this218.fieldView=t(_this218,i,n),_this218.set("label",void 0),_this218.set("isEnabled",!0),_this218.set("isEmpty",!0),_this218.set("isFocused",!1),_this218.set("errorText",null),_this218.set("infoText",null),_this218.set("class",void 0),_this218.set("placeholder",void 0),_this218.labelView=_this218._createLabelView(i),_this218.statusView=_this218._createStatusView(n),_this218.fieldWrapperChildren=_this218.createCollection([_this218.fieldView,_this218.labelView]),_this218.bind("_statusText").to(_this218,"errorText",_this218,"infoText",function(e,t){return e||t;});var s=_this218.bindTemplate;_this218.setTemplate({tag:"div",attributes:{"class":["ck","ck-labeled-field-view",s.to("class"),s["if"]("isEnabled","ck-disabled",function(e){return!e;}),s["if"]("isEmpty","ck-labeled-field-view_empty"),s["if"]("isFocused","ck-labeled-field-view_focused"),s["if"]("placeholder","ck-labeled-field-view_placeholder"),s["if"]("errorText","ck-error")]},children:[{tag:"div",attributes:{"class":["ck","ck-labeled-field-view__input-wrapper"]},children:_this218.fieldWrapperChildren},_this218.statusView]});return _this218;}_inherits(pf,_lg14);return _createClass(pf,[{key:"_createLabelView",value:function _createLabelView(e){var t=new Og(this.locale);return t["for"]=e,t.bind("text").to(this,"label"),t;}},{key:"_createStatusView",value:function _createStatusView(e){var t=new lg(this.locale),i=this.bindTemplate;return t.setTemplate({tag:"div",attributes:{"class":["ck","ck-labeled-field-view__status",i["if"]("errorText","ck-labeled-field-view__status_error"),i["if"]("_statusText","ck-hidden",function(e){return!e;})],id:e,role:i["if"]("errorText","alert")},children:[{text:i.to("_statusText")}]}),t;}},{key:"focus",value:function focus(e){this.fieldView.focus(e);}}]);}(lg);var bf=/*#__PURE__*/function(_lg15){function bf(e){var _this219;_classCallCheck(this,bf);_this219=_callSuper(this,bf,[e]),_defineProperty(_assertThisInitialized(_this219),"focusTracker",void 0),_this219.set("value",void 0),_this219.set("id",void 0),_this219.set("placeholder",void 0),_this219.set("tabIndex",void 0),_this219.set("isReadOnly",!1),_this219.set("hasError",!1),_this219.set("ariaDescribedById",void 0),_this219.set("ariaLabel",void 0),_this219.focusTracker=new _r(),_this219.bind("isFocused").to(_this219.focusTracker),_this219.set("isEmpty",!0);var t=_this219.bindTemplate;_this219.setTemplate({tag:"input",attributes:{"class":["ck","ck-input",t["if"]("isFocused","ck-input_focused"),t["if"]("isEmpty","ck-input-text_empty"),t["if"]("hasError","ck-error")],id:t.to("id"),placeholder:t.to("placeholder"),tabindex:t.to("tabIndex"),readonly:t.to("isReadOnly"),"aria-invalid":t["if"]("hasError",!0),"aria-describedby":t.to("ariaDescribedById"),"aria-label":t.to("ariaLabel")},on:{input:t.to(function(){var _this220;for(var _len50=arguments.length,e=new Array(_len50),_key50=0;_key50<_len50;_key50++){e[_key50]=arguments[_key50];}(_this220=_this219).fire.apply(_this220,["input"].concat(e)),_this219._updateIsEmpty();}),change:t.to(_this219._updateIsEmpty.bind(_this219))}});return _this219;}_inherits(bf,_lg15);return _createClass(bf,[{key:"render",value:function render(){var _this221=this;_superPropGet(bf,"render",this,3)([]),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",function(e,t,i){_this221._setDomElementValue(i),_this221._updateIsEmpty();});}},{key:"destroy",value:function destroy(){_superPropGet(bf,"destroy",this,3)([]),this.focusTracker.destroy();}},{key:"select",value:function select(){this.element.select();}},{key:"focus",value:function focus(){this.element.focus();}},{key:"reset",value:function reset(){this.value=this.element.value="",this._updateIsEmpty();}},{key:"_updateIsEmpty",value:function _updateIsEmpty(){this.isEmpty=!this.element.value;}},{key:"_setDomElementValue",value:function _setDomElementValue(e){this.element.value=e||0===e?e:"";}}]);}(lg);var wf=/*#__PURE__*/function(_bf2){function wf(e){var _this222;_classCallCheck(this,wf);_this222=_callSuper(this,wf,[e]),_this222.set("inputMode","text");var t=_this222.bindTemplate;_this222.extendTemplate({attributes:{inputmode:t.to("inputMode")}});return _this222;}_inherits(wf,_bf2);return _createClass(wf);}(bf);var _f=/*#__PURE__*/function(_wf){function _f(e){var _this223;_classCallCheck(this,_f);_this223=_callSuper(this,_f,[e]),_this223.extendTemplate({attributes:{type:"text","class":["ck-input-text"]}});return _this223;}_inherits(_f,_wf);return _createClass(_f);}(wf);var vf=/*#__PURE__*/function(_wf2){function vf(e){var _this224;var _ref71=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},t=_ref71.min,i=_ref71.max,n=_ref71.step;_classCallCheck(this,vf);_this224=_callSuper(this,vf,[e]);var s=_this224.bindTemplate;_this224.set("min",t),_this224.set("max",i),_this224.set("step",n),_this224.extendTemplate({attributes:{type:"number","class":["ck-input-number"],min:s.to("min"),max:s.to("max"),step:s.to("step")}});return _this224;}_inherits(vf,_wf2);return _createClass(vf);}(wf);var yf=/*#__PURE__*/function(_bf3){function yf(e){var _this225;_classCallCheck(this,yf);_this225=_callSuper(this,yf,[e]);_defineProperty(_this225,"_resizeObserver",void 0);_defineProperty(_this225,"_isUpdateAutoGrowHeightPending",!1);var t=Oo("px");_this225.set("minRows",2),_this225.set("maxRows",5),_this225.set("_height",null),_this225.set("resize","none"),_this225._resizeObserver=null,_this225.on("change:minRows",_this225._validateMinMaxRows.bind(_this225)),_this225.on("change:maxRows",_this225._validateMinMaxRows.bind(_this225));var i=_this225.bindTemplate;_this225.template.tag="textarea",_this225.extendTemplate({attributes:{"class":["ck-textarea"],style:{height:i.to("_height",function(e){return e?t(e):null;}),resize:i.to("resize")},rows:i.to("minRows")}});return _this225;}_inherits(yf,_bf3);return _createClass(yf,[{key:"render",value:function render(){var _this226=this;_superPropGet(yf,"render",this,3)([]);var e=!1;this.on("input",function(){_this226._updateAutoGrowHeight(!0),_this226.fire("update");}),this.on("change:value",function(){i.window.requestAnimationFrame(function(){No(_this226.element)?(_this226._updateAutoGrowHeight(),_this226.fire("update")):_this226._isUpdateAutoGrowHeightPending=!0;});}),this._resizeObserver=new Vo(this.element,function(t){var n=!!t.contentRect.width&&!!t.contentRect.height;!e&&n&&_this226._isUpdateAutoGrowHeightPending&&i.window.requestAnimationFrame(function(){_this226._updateAutoGrowHeight(),_this226.fire("update");}),e=n;});}},{key:"destroy",value:function destroy(){this._resizeObserver&&this._resizeObserver.destroy();}},{key:"reset",value:function reset(){_superPropGet(yf,"reset",this,3)([]),this._updateAutoGrowHeight(),this.fire("update");}},{key:"_updateAutoGrowHeight",value:function _updateAutoGrowHeight(e){var t=this.element;if(!t.offsetParent)return void(this._isUpdateAutoGrowHeightPending=!0);this._isUpdateAutoGrowHeightPending=!1;var i=kf(t,"1"),n=kf(t,t.value),s=i.ownerDocument.defaultView.getComputedStyle(i),o=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom),r=vo(i),a=parseFloat(s.lineHeight),l=r.top+r.bottom,c=new Eo(i).height,d=Math.round((n.scrollHeight-o)/a),u=this.maxRows*a+o+l,h=1===d?c:this.minRows*a+o+l;this._height=Math.min(Math.max(Math.max(d,this.minRows)*a+o+l,h),u),e&&(t.scrollTop=t.scrollHeight),i.remove(),n.remove();}},{key:"_validateMinMaxRows",value:function _validateMinMaxRows(){if(this.minRows>this.maxRows)throw new A("ui-textarea-view-min-rows-greater-than-max-rows",{textareaView:this,minRows:this.minRows,maxRows:this.maxRows});}}]);}(bf);function kf(e,t){var i=e.cloneNode();return i.style.position="absolute",i.style.top="-99999px",i.style.left="-99999px",i.style.height="auto",i.style.overflow="hidden",i.style.width=e.ownerDocument.defaultView.getComputedStyle(e).width,i.tabIndex=-1,i.rows=1,i.value=t,e.parentNode.insertBefore(i,e),i;}var Cf=/*#__PURE__*/function(_lg16){function Cf(e){var _this227;_classCallCheck(this,Cf);_this227=_callSuper(this,Cf,[e]);_defineProperty(_this227,"children",void 0);var t=_this227.bindTemplate;_this227.set("isVisible",!1),_this227.set("position","se"),_this227.children=_this227.createCollection(),_this227.setTemplate({tag:"div",attributes:{"class":["ck","ck-reset","ck-dropdown__panel",t.to("position",function(e){return"ck-dropdown__panel_".concat(e);}),t["if"]("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:_this227.children,on:{selectstart:t.to(function(e){"input"!==e.target.tagName.toLocaleLowerCase()&&e.preventDefault();})}});return _this227;}_inherits(Cf,_lg16);return _createClass(Cf,[{key:"focus",value:function focus(){if(this.children.length){var _e390=this.children.first;"function"==typeof _e390.focus?_e390.focus():E("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this});}}},{key:"focusLast",value:function focusLast(){if(this.children.length){var _e391=this.children.last;"function"==typeof _e391.focusLast?_e391.focusLast():_e391.focus();}}}]);}(lg);var xf=/*#__PURE__*/function(_lg17){function xf(e,t,i){var _this228;_classCallCheck(this,xf);_this228=_callSuper(this,xf,[e]);_defineProperty(_this228,"buttonView",void 0);_defineProperty(_this228,"panelView",void 0);_defineProperty(_this228,"focusTracker",void 0);_defineProperty(_this228,"keystrokes",void 0);_defineProperty(_this228,"listView",void 0);_defineProperty(_this228,"toolbarView",void 0);_defineProperty(_this228,"menuView",void 0);var n=_this228.bindTemplate;_this228.buttonView=t,_this228.panelView=i,_this228.set("isOpen",!1),_this228.set("isEnabled",!0),_this228.set("class",void 0),_this228.set("id",void 0),_this228.set("panelPosition","auto"),_this228.panelView.bind("isVisible").to(_this228,"isOpen"),_this228.keystrokes=new Cr(),_this228.focusTracker=new _r(),_this228.setTemplate({tag:"div",attributes:{"class":["ck","ck-dropdown",n.to("class"),n["if"]("isEnabled","ck-disabled",function(e){return!e;})],id:n.to("id"),"aria-describedby":n.to("ariaDescribedById")},children:[t,i]}),t.extendTemplate({attributes:{"class":["ck-dropdown__button"],"data-cke-tooltip-disabled":n.to("isOpen")}});return _this228;}_inherits(xf,_lg17);return _createClass(xf,[{key:"render",value:function render(){var _this229=this;_superPropGet(xf,"render",this,3)([]),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",function(){_this229.isOpen=!_this229.isOpen;}),this.on("change:isOpen",function(e,t,i){if(i)if("auto"===_this229.panelPosition){var _e392=xf._getOptimalPosition({element:_this229.panelView.element,target:_this229.buttonView.element,fitInViewport:!0,positions:_this229._panelPositions});_this229.panelView.position=_e392?_e392.name:_this229._panelPositions[0].name;}else _this229.panelView.position=_this229.panelPosition;}),this.keystrokes.listenTo(this.element);var e=function(_e393){function e(_x3,_x4){return _e393.apply(this,arguments);}e.toString=function(){return _e393.toString();};return e;}(function(e,t){_this229.isOpen&&(_this229.isOpen=!1,t());});this.keystrokes.set("arrowdown",function(e,t){_this229.buttonView.isEnabled&&!_this229.isOpen&&(_this229.isOpen=!0,t());}),this.keystrokes.set("arrowright",function(e,t){_this229.isOpen&&t();}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e);}},{key:"focus",value:function focus(){this.buttonView.focus();}},{key:"_panelPositions",get:function get(){var _xf$defaultPanelPosit=xf.defaultPanelPositions,e=_xf$defaultPanelPosit.south,t=_xf$defaultPanelPosit.north,i=_xf$defaultPanelPosit.southEast,n=_xf$defaultPanelPosit.southWest,s=_xf$defaultPanelPosit.northEast,o=_xf$defaultPanelPosit.northWest,r=_xf$defaultPanelPosit.southMiddleEast,a=_xf$defaultPanelPosit.southMiddleWest,l=_xf$defaultPanelPosit.northMiddleEast,c=_xf$defaultPanelPosit.northMiddleWest;return"rtl"!==this.locale.uiLanguageDirection?[i,n,r,a,e,s,o,l,c,t]:[n,i,a,r,e,o,s,c,l,t];}}]);}(lg);_defineProperty(xf,"defaultPanelPositions",{south:function south(e,t){return{top:e.bottom,left:e.left-(t.width-e.width)/2,name:"s"};},southEast:function southEast(e){return{top:e.bottom,left:e.left,name:"se"};},southWest:function southWest(e,t){return{top:e.bottom,left:e.left-t.width+e.width,name:"sw"};},southMiddleEast:function southMiddleEast(e,t){return{top:e.bottom,left:e.left-(t.width-e.width)/4,name:"sme"};},southMiddleWest:function southMiddleWest(e,t){return{top:e.bottom,left:e.left-3*(t.width-e.width)/4,name:"smw"};},north:function north(e,t){return{top:e.top-t.height,left:e.left-(t.width-e.width)/2,name:"n"};},northEast:function northEast(e,t){return{top:e.top-t.height,left:e.left,name:"ne"};},northWest:function northWest(e,t){return{top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"};},northMiddleEast:function northMiddleEast(e,t){return{top:e.top-t.height,left:e.left-(t.width-e.width)/4,name:"nme"};},northMiddleWest:function northMiddleWest(e,t){return{top:e.top-t.height,left:e.left-3*(t.width-e.width)/4,name:"nmw"};}});_defineProperty(xf,"_getOptimalPosition",Do);var Af=/*#__PURE__*/function(_pg5){function Af(e){var _this230;_classCallCheck(this,Af);_this230=_callSuper(this,Af,[e]),_defineProperty(_assertThisInitialized(_this230),"arrowView",void 0),_this230.arrowView=_this230._createArrowView(),_this230.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":_this230.bindTemplate.to("isOn",function(e){return String(e);})}}),_this230.delegate("execute").to(_assertThisInitialized(_this230),"open");return _this230;}_inherits(Af,_pg5);return _createClass(Af,[{key:"render",value:function render(){_superPropGet(Af,"render",this,3)([]),this.children.add(this.arrowView);}},{key:"_createArrowView",value:function _createArrowView(){var e=new gg();return e.content=Wg,e.extendTemplate({attributes:{"class":"ck-dropdown__arrow"}}),e;}}]);}(pg);var Ef=/*#__PURE__*/function(_pg6){function Ef(e,t,i){var _this231;_classCallCheck(this,Ef);_this231=_callSuper(this,Ef,[e]),_defineProperty(_assertThisInitialized(_this231),"id",void 0),_this231.id=t,_this231.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem",label:i}),_this231.extendTemplate({attributes:{"class":["ck-dropdown-menu-list__nested-menu__item__button"]}});return _this231;}_inherits(Ef,_pg6);return _createClass(Ef);}(pg);var Tf=/*#__PURE__*/function(_Ig3){function Tf(e){var _this232;_classCallCheck(this,Tf);_this232=_callSuper(this,Tf,[e]);_defineProperty(_this232,"arrowView",void 0);var t=_this232.bindTemplate;_this232.set({withText:!0,role:"menuitem"}),_this232.arrowView=_this232._createArrowView(),_this232.extendTemplate({attributes:{"class":["ck-dropdown-menu-list__nested-menu__button"],"aria-haspopup":!0,"aria-expanded":_this232.bindTemplate.to("isOn",function(e){return String(e);}),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}});return _this232;}_inherits(Tf,_Ig3);return _createClass(Tf,[{key:"render",value:function render(){_superPropGet(Tf,"render",this,3)([]),this.children.add(this.arrowView);}},{key:"_createArrowView",value:function _createArrowView(){var e=new gg();return e.content=Wg,e.extendTemplate({attributes:{"class":"ck-dropdown-menu-list__nested-menu__button__arrow"}}),e;}}]);}(Ig);var Pf=/*#__PURE__*/function(_lg18){function Pf(e){var _this233;_classCallCheck(this,Pf);_this233=_callSuper(this,Pf,[e]);_defineProperty(_this233,"children",void 0);var t=_this233.bindTemplate;_this233.set("isVisible",!0),_this233.children=_this233.createCollection(),_this233.setTemplate({tag:"li",attributes:{"class":["ck","ck-list__item",t["if"]("isVisible","ck-hidden",function(e){return!e;})],role:"presentation"},children:_this233.children});return _this233;}_inherits(Pf,_lg18);return _createClass(Pf,[{key:"focus",value:function focus(){this.children.first&&this.children.first.focus();}}]);}(lg);var Sf=/*#__PURE__*/function(_lg19){function Sf(e){var _this234;_classCallCheck(this,Sf);_this234=_callSuper(this,Sf,[e]),_this234.setTemplate({tag:"li",attributes:{"class":["ck","ck-list__separator"]}});return _this234;}_inherits(Sf,_lg19);return _createClass(Sf);}(lg);var If=/*#__PURE__*/function(_lg20){function If(e){var _this235;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Og();_classCallCheck(this,If);_this235=_callSuper(this,If,[e]);_defineProperty(_this235,"labelView",void 0);_defineProperty(_this235,"items",void 0);_defineProperty(_this235,"children",void 0);var i=_this235.bindTemplate,n=new Vf(e);_this235.set({label:"",isVisible:!0}),_this235.labelView=t,_this235.labelView.bind("text").to(_this235,"label"),_this235.children=_this235.createCollection(),_this235.children.addMany([_this235.labelView,n]),n.set({role:"group",ariaLabelledBy:t.id}),n.focusTracker.destroy(),n.keystrokes.destroy(),_this235.items=n.items,_this235.setTemplate({tag:"li",attributes:{role:"presentation","class":["ck","ck-list__group",i["if"]("isVisible","ck-hidden",function(e){return!e;})]},children:_this235.children});return _this235;}_inherits(If,_lg20);return _createClass(If,[{key:"focus",value:function focus(){if(this.items){var _e394=this.items.find(function(e){return!(e instanceof Sf);});_e394&&_e394.focus();}}}]);}(lg);var Vf=/*#__PURE__*/function(_lg21){function Vf(e){var _this236;_classCallCheck(this,Vf);_this236=_callSuper(this,Vf,[e]);_defineProperty(_this236,"focusables",void 0);_defineProperty(_this236,"items",void 0);_defineProperty(_this236,"focusTracker",void 0);_defineProperty(_this236,"keystrokes",void 0);_defineProperty(_this236,"_focusCycler",void 0);_defineProperty(_this236,"_listItemGroupToChangeListeners",new WeakMap());var t=_this236.bindTemplate;_this236.focusables=new zm(),_this236.items=_this236.createCollection(),_this236.focusTracker=new _r(),_this236.keystrokes=new Cr(),_this236._focusCycler=new _g({focusables:_this236.focusables,focusTracker:_this236.focusTracker,keystrokeHandler:_this236.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),_this236.set("ariaLabel",void 0),_this236.set("ariaLabelledBy",void 0),_this236.set("role",void 0),_this236.setTemplate({tag:"ul",attributes:{"class":["ck","ck-reset","ck-list"],role:t.to("role"),"aria-label":t.to("ariaLabel"),"aria-labelledby":t.to("ariaLabelledBy")},children:_this236.items});return _this236;}_inherits(Vf,_lg21);return _createClass(Vf,[{key:"render",value:function render(){var _this237=this;_superPropGet(Vf,"render",this,3)([]);var _iterator373=_createForOfIteratorHelper(this.items),_step373;try{for(_iterator373.s();!(_step373=_iterator373.n()).done;){var _e397=_step373.value;_e397 instanceof If?this._registerFocusableItemsGroup(_e397):_e397 instanceof Pf&&this._registerFocusableListItem(_e397);}}catch(err){_iterator373.e(err);}finally{_iterator373.f();}this.items.on("change",function(e,t){var _iterator374=_createForOfIteratorHelper(t.removed),_step374;try{for(_iterator374.s();!(_step374=_iterator374.n()).done;){var _e395=_step374.value;_e395 instanceof If?_this237._deregisterFocusableItemsGroup(_e395):_e395 instanceof Pf&&_this237._deregisterFocusableListItem(_e395);}}catch(err){_iterator374.e(err);}finally{_iterator374.f();}var _iterator375=_createForOfIteratorHelper(Array.from(t.added).reverse()),_step375;try{for(_iterator375.s();!(_step375=_iterator375.n()).done;){var _e396=_step375.value;_e396 instanceof If?_this237._registerFocusableItemsGroup(_e396,t.index):_this237._registerFocusableListItem(_e396,t.index);}}catch(err){_iterator375.e(err);}finally{_iterator375.f();}}),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(Vf,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"focusFirst",value:function focusFirst(){this._focusCycler.focusFirst();}},{key:"focusLast",value:function focusLast(){this._focusCycler.focusLast();}},{key:"_registerFocusableListItem",value:function _registerFocusableListItem(e,t){this.focusTracker.add(e.element),this.focusables.add(e,t);}},{key:"_deregisterFocusableListItem",value:function _deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e);}},{key:"_getOnGroupItemsChangeCallback",value:function _getOnGroupItemsChangeCallback(e){var _this238=this;return function(t,i){var _iterator376=_createForOfIteratorHelper(i.removed),_step376;try{for(_iterator376.s();!(_step376=_iterator376.n()).done;){var _e398=_step376.value;_this238._deregisterFocusableListItem(_e398);}}catch(err){_iterator376.e(err);}finally{_iterator376.f();}var _iterator377=_createForOfIteratorHelper(Array.from(i.added).reverse()),_step377;try{for(_iterator377.s();!(_step377=_iterator377.n()).done;){var _t247=_step377.value;_this238._registerFocusableListItem(_t247,_this238.items.getIndex(e)+i.index);}}catch(err){_iterator377.e(err);}finally{_iterator377.f();}};}},{key:"_registerFocusableItemsGroup",value:function _registerFocusableItemsGroup(e,t){var _this239=this;Array.from(e.items).forEach(function(e,i){var n=void 0!==t?t+i:void 0;_this239._registerFocusableListItem(e,n);});var i=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,i),e.items.on("change",i);}},{key:"_deregisterFocusableItemsGroup",value:function _deregisterFocusableItemsGroup(e){var _iterator378=_createForOfIteratorHelper(e.items),_step378;try{for(_iterator378.s();!(_step378=_iterator378.n()).done;){var _t248=_step378.value;this._deregisterFocusableListItem(_t248);}}catch(err){_iterator378.e(err);}finally{_iterator378.f();}e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners["delete"](e);}}]);}(lg);var Rf=/*#__PURE__*/function(_Vf2){function Rf(e){var _this240;_classCallCheck(this,Rf);_this240=_callSuper(this,Rf,[e]);var t=_this240.bindTemplate;_this240.role="menu",_this240.set("isVisible",!0),_this240.extendTemplate({attributes:{"class":["ck-dropdown-menu-list",t["if"]("isVisible","ck-hidden",function(e){return!e;})]}});return _this240;}_inherits(Rf,_Vf2);return _createClass(Rf);}(Vf);var Of={eastSouth:function eastSouth(e){return{top:e.top,left:e.right-5,name:"es"};},eastNorth:function eastNorth(e,t){return{top:e.top-t.height+e.height,left:e.right-5,name:"en"};},westSouth:function westSouth(e,t){return{top:e.top,left:e.left-t.width+5,name:"ws"};},westNorth:function westNorth(e,t){return{top:e.top-t.height+e.height,left:e.left-t.width+5,name:"wn"};}};var Bf=/*#__PURE__*/function(_Pf2){function Bf(e,t,i){var _this241;_classCallCheck(this,Bf);_this241=_callSuper(this,Bf,[e]);_defineProperty(_this241,"childView",void 0);var n=_this241.bindTemplate;_this241.childView=i,_this241.children.add(i),_this241.extendTemplate({attributes:{"class":["ck-dropdown-menu-list__nested-menu__item"]},on:{mouseenter:n.to("mouseenter")}}),t&&(_this241.delegate("mouseenter").to(t),i instanceof Ef&&i.delegate("execute").to(t));return _this241;}_inherits(Bf,_Pf2);return _createClass(Bf);}(Pf);var Mf={toggleMenusAndFocusItemsOnHover:function toggleMenusAndFocusItemsOnHover(e){e.on("menu:mouseenter",function(t){var _t$path=_slicedToArray(t.path,1),i=_t$path[0];t.source.focus();var _iterator379=_createForOfIteratorHelper(e.menus),_step379;try{for(_iterator379.s();!(_step379=_iterator379.n()).done;){var _n157=_step379.value;var _e399=i instanceof Bf&&i.childView===_n157;_n157.isOpen=(t.path.includes(_n157)||_e399)&&_n157.isEnabled;}}catch(err){_iterator379.e(err);}finally{_iterator379.f();}});},closeMenuWhenAnotherOnTheSameLevelOpens:function closeMenuWhenAnotherOnTheSameLevelOpens(e){e.on("menu:change:isOpen",function(t,i,n){if(!n)return;var s=t.source;var _iterator380=_createForOfIteratorHelper(e.menus),_step380;try{for(_iterator380.s();!(_step380=_iterator380.n()).done;){var _t249=_step380.value;s.parentMenuView===_t249.parentMenuView&&s!==_t249&&(_t249.isOpen=!1);}}catch(err){_iterator380.e(err);}finally{_iterator380.f();}});}},Lf={openOnArrowRightKey:function openOnArrowRightKey(e){var t="rtl"===e.locale.uiLanguageDirection?"arrowleft":"arrowright";e.keystrokes.set(t,function(t,i){e.focusTracker.focusedElement===e.buttonView.element&&e.isEnabled&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),i());});},openOnButtonClick:function openOnButtonClick(e){e.buttonView.on("execute",function(){e.isEnabled&&(e.isOpen=!0);});},openAndFocusOnEnterKeyPress:function openAndFocusOnEnterKeyPress(e){e.keystrokes.set("enter",function(t,i){e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen=!0,e.panelView.focus(),i());});},closeOnArrowLeftKey:function closeOnArrowLeftKey(e){var t="rtl"===e.locale.uiLanguageDirection?"arrowright":"arrowleft";e.keystrokes.set(t,function(t,i){e.isOpen&&(e.focus(),e.isOpen=!1,i());});},closeOnEscKey:function closeOnEscKey(e){e.keystrokes.set("esc",function(t,i){e.isOpen&&(e.focus(),e.isOpen=!1,i());});},closeOnParentClose:function closeOnParentClose(e,t){t.on("change:isOpen",function(i,n,s){s||i.source!==t||(e.isOpen=!1);});}},Ff=Oo("px"),Nf={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}};var Df=/*#__PURE__*/function(_lg22){function Df(e){var _this242;_classCallCheck(this,Df);_this242=_callSuper(this,Df,[e]);_defineProperty(_this242,"content",void 0);_defineProperty(_this242,"_pinWhenIsVisibleCallback",void 0);_defineProperty(_this242,"_resizeObserver",void 0);var t=_this242.bindTemplate;_this242.set("top",0),_this242.set("left",0),_this242.set("position","arrow_nw"),_this242.set("isVisible",!1),_this242.set("withArrow",!0),_this242.set("class",void 0),_this242._pinWhenIsVisibleCallback=null,_this242._resizeObserver=null,_this242.content=_this242.createCollection(),_this242.setTemplate({tag:"div",attributes:{"class":["ck","ck-balloon-panel",t.to("position",function(e){return"ck-balloon-panel_".concat(e);}),t["if"]("isVisible","ck-balloon-panel_visible"),t["if"]("withArrow","ck-balloon-panel_with-arrow"),t.to("class")],style:{top:t.to("top",Ff),left:t.to("left",Ff)}},children:_this242.content});return _this242;}_inherits(Df,_lg22);return _createClass(Df,[{key:"destroy",value:function destroy(){this.hide(),_superPropGet(Df,"destroy",this,3)([]);}},{key:"show",value:function show(){this.isVisible=!0;}},{key:"hide",value:function hide(){this.isVisible=!1;}},{key:"attachTo",value:function attachTo(e){var t=zf(e.target);if(t&&!No(t))return!1;this.show();var n=Df.defaultPositions,s=Object.assign({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthMiddleWest,n.southArrowNorthMiddleEast,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthMiddleWest,n.northArrowSouthMiddleEast,n.northArrowSouthWest,n.northArrowSouthEast,n.viewportStickyNorth],limiter:i.document.body,fitInViewport:!0},e),o=Df._getOptimalPosition(s)||Nf,r=parseInt(o.left),a=parseInt(o.top),l=o.name,c=o.config||{},_c$withArrow=c.withArrow,d=_c$withArrow===void 0?!0:_c$withArrow;return this.top=a,this.left=r,this.position=l,this.withArrow=d,!0;}},{key:"pin",value:function pin(e){var _this243=this;this.unpin(),this._startPinning(e)&&(this._pinWhenIsVisibleCallback=function(){_this243.isVisible?_this243._startPinning(e):_this243._stopPinning();},this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback));}},{key:"unpin",value:function unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide());}},{key:"_startPinning",value:function _startPinning(e){var _this244=this;if(!this.attachTo(e))return!1;var t=zf(e.target);var n=e.limiter?zf(e.limiter):i.document.body;if(this.listenTo(i.document,"scroll",function(i,s){var o=s.target,r=t&&o.contains(t),a=n&&o.contains(n);!r&&!a&&t&&n||_this244.attachTo(e);},{useCapture:!0}),this.listenTo(i.window,"resize",function(){_this244.attachTo(e);}),!this._resizeObserver&&(t&&ko(t)&&(t=t.parentElement),t)){var _e400=function _e400(){No(t)||_this244.unpin();};this._resizeObserver=new Vo(t,_e400);}return!0;}},{key:"_stopPinning",value:function _stopPinning(){this.stopListening(i.document,"scroll"),this.stopListening(i.window,"resize"),this._resizeObserver&&(this._resizeObserver.destroy(),this._resizeObserver=null);}}],[{key:"generatePositions",value:function generatePositions(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _e$sideOffset=e.sideOffset,t=_e$sideOffset===void 0?Df.arrowSideOffset:_e$sideOffset,_e$heightOffset=e.heightOffset,i=_e$heightOffset===void 0?Df.arrowHeightOffset:_e$heightOffset,_e$stickyVerticalOffs=e.stickyVerticalOffset,n=_e$stickyVerticalOffs===void 0?Df.stickyVerticalOffset:_e$stickyVerticalOffs,s=e.config;return{northWestArrowSouthWest:function northWestArrowSouthWest(e,i){return _objectSpread({top:o(e,i),left:e.left-t,name:"arrow_sw"},s&&{config:s});},northWestArrowSouthMiddleWest:function northWestArrowSouthMiddleWest(e,i){return _objectSpread({top:o(e,i),left:e.left-.25*i.width-t,name:"arrow_smw"},s&&{config:s});},northWestArrowSouth:function northWestArrowSouth(e,t){return _objectSpread({top:o(e,t),left:e.left-t.width/2,name:"arrow_s"},s&&{config:s});},northWestArrowSouthMiddleEast:function northWestArrowSouthMiddleEast(e,i){return _objectSpread({top:o(e,i),left:e.left-.75*i.width+t,name:"arrow_sme"},s&&{config:s});},northWestArrowSouthEast:function northWestArrowSouthEast(e,i){return _objectSpread({top:o(e,i),left:e.left-i.width+t,name:"arrow_se"},s&&{config:s});},northArrowSouthWest:function northArrowSouthWest(e,i){return _objectSpread({top:o(e,i),left:e.left+e.width/2-t,name:"arrow_sw"},s&&{config:s});},northArrowSouthMiddleWest:function northArrowSouthMiddleWest(e,i){return _objectSpread({top:o(e,i),left:e.left+e.width/2-.25*i.width-t,name:"arrow_smw"},s&&{config:s});},northArrowSouth:function northArrowSouth(e,t){return _objectSpread({top:o(e,t),left:e.left+e.width/2-t.width/2,name:"arrow_s"},s&&{config:s});},northArrowSouthMiddleEast:function northArrowSouthMiddleEast(e,i){return _objectSpread({top:o(e,i),left:e.left+e.width/2-.75*i.width+t,name:"arrow_sme"},s&&{config:s});},northArrowSouthEast:function northArrowSouthEast(e,i){return _objectSpread({top:o(e,i),left:e.left+e.width/2-i.width+t,name:"arrow_se"},s&&{config:s});},northEastArrowSouthWest:function northEastArrowSouthWest(e,i){return _objectSpread({top:o(e,i),left:e.right-t,name:"arrow_sw"},s&&{config:s});},northEastArrowSouthMiddleWest:function northEastArrowSouthMiddleWest(e,i){return _objectSpread({top:o(e,i),left:e.right-.25*i.width-t,name:"arrow_smw"},s&&{config:s});},northEastArrowSouth:function northEastArrowSouth(e,t){return _objectSpread({top:o(e,t),left:e.right-t.width/2,name:"arrow_s"},s&&{config:s});},northEastArrowSouthMiddleEast:function northEastArrowSouthMiddleEast(e,i){return _objectSpread({top:o(e,i),left:e.right-.75*i.width+t,name:"arrow_sme"},s&&{config:s});},northEastArrowSouthEast:function northEastArrowSouthEast(e,i){return _objectSpread({top:o(e,i),left:e.right-i.width+t,name:"arrow_se"},s&&{config:s});},southWestArrowNorthWest:function southWestArrowNorthWest(e){return _objectSpread({top:r(e),left:e.left-t,name:"arrow_nw"},s&&{config:s});},southWestArrowNorthMiddleWest:function southWestArrowNorthMiddleWest(e,i){return _objectSpread({top:r(e),left:e.left-.25*i.width-t,name:"arrow_nmw"},s&&{config:s});},southWestArrowNorth:function southWestArrowNorth(e,t){return _objectSpread({top:r(e),left:e.left-t.width/2,name:"arrow_n"},s&&{config:s});},southWestArrowNorthMiddleEast:function southWestArrowNorthMiddleEast(e,i){return _objectSpread({top:r(e),left:e.left-.75*i.width+t,name:"arrow_nme"},s&&{config:s});},southWestArrowNorthEast:function southWestArrowNorthEast(e,i){return _objectSpread({top:r(e),left:e.left-i.width+t,name:"arrow_ne"},s&&{config:s});},southArrowNorthWest:function southArrowNorthWest(e){return _objectSpread({top:r(e),left:e.left+e.width/2-t,name:"arrow_nw"},s&&{config:s});},southArrowNorthMiddleWest:function southArrowNorthMiddleWest(e,i){return _objectSpread({top:r(e),left:e.left+e.width/2-.25*i.width-t,name:"arrow_nmw"},s&&{config:s});},southArrowNorth:function southArrowNorth(e,t){return _objectSpread({top:r(e),left:e.left+e.width/2-t.width/2,name:"arrow_n"},s&&{config:s});},southArrowNorthMiddleEast:function southArrowNorthMiddleEast(e,i){return _objectSpread({top:r(e),left:e.left+e.width/2-.75*i.width+t,name:"arrow_nme"},s&&{config:s});},southArrowNorthEast:function southArrowNorthEast(e,i){return _objectSpread({top:r(e),left:e.left+e.width/2-i.width+t,name:"arrow_ne"},s&&{config:s});},southEastArrowNorthWest:function southEastArrowNorthWest(e){return _objectSpread({top:r(e),left:e.right-t,name:"arrow_nw"},s&&{config:s});},southEastArrowNorthMiddleWest:function southEastArrowNorthMiddleWest(e,i){return _objectSpread({top:r(e),left:e.right-.25*i.width-t,name:"arrow_nmw"},s&&{config:s});},southEastArrowNorth:function southEastArrowNorth(e,t){return _objectSpread({top:r(e),left:e.right-t.width/2,name:"arrow_n"},s&&{config:s});},southEastArrowNorthMiddleEast:function southEastArrowNorthMiddleEast(e,i){return _objectSpread({top:r(e),left:e.right-.75*i.width+t,name:"arrow_nme"},s&&{config:s});},southEastArrowNorthEast:function southEastArrowNorthEast(e,i){return _objectSpread({top:r(e),left:e.right-i.width+t,name:"arrow_ne"},s&&{config:s});},westArrowEast:function westArrowEast(e,t){return _objectSpread({top:e.top+e.height/2-t.height/2,left:e.left-t.width-i,name:"arrow_e"},s&&{config:s});},eastArrowWest:function eastArrowWest(e,t){return _objectSpread({top:e.top+e.height/2-t.height/2,left:e.right+i,name:"arrow_w"},s&&{config:s});},viewportStickyNorth:function viewportStickyNorth(e,t,i,o){var r=o||i;return e.getIntersection(r)?r.height-e.height>n?null:{top:r.top+n,left:e.left+e.width/2-t.width/2,name:"arrowless",config:_objectSpread({withArrow:!1},s)}:null;}};function o(e,t){return e.top-t.height-i;}function r(e){return e.bottom+i;}}}]);}(lg);_Df=Df;_defineProperty(Df,"arrowSideOffset",25);_defineProperty(Df,"arrowHeightOffset",10);_defineProperty(Df,"stickyVerticalOffset",20);_defineProperty(Df,"_getOptimalPosition",Do);_defineProperty(Df,"defaultPositions",_Df.generatePositions());function zf(e){return Ms(e)?e:Co(e)?e.commonAncestorContainer:"function"==typeof e?zf(e()):null;}var Hf=/*#__PURE__*/function(_Df2){function Hf(e){var _this245;_classCallCheck(this,Hf);_this245=_callSuper(this,Hf,[e]);var t=_this245.bindTemplate;_this245.set({isVisible:!1,position:"se","class":null,top:0,left:0}),_this245.extendTemplate({tag:"div",attributes:{"class":["ck-reset","ck-dropdown-menu__nested-menu__panel"],tabindex:"-1"},on:{selectstart:t.to(function(e){"input"!==e.target.tagName.toLocaleLowerCase()&&e.preventDefault();})}});return _this245;}_inherits(Hf,_Df2);return _createClass(Hf,[{key:"focus",value:function focus(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;var t=this.content;t.length&&(1===e?t.first.focus():t.last.focus());}}]);}(Df);var $f=/*#__PURE__*/function(_lg23){function $f(e,t,i,n,s){var _this246;_classCallCheck(this,$f);_this246=_callSuper(this,$f,[e]),_defineProperty(_assertThisInitialized(_this246),"id",void 0),_defineProperty(_assertThisInitialized(_this246),"buttonView",void 0),_defineProperty(_assertThisInitialized(_this246),"panelView",void 0),_defineProperty(_assertThisInitialized(_this246),"listView",void 0),_defineProperty(_assertThisInitialized(_this246),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this246),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this246),"_bodyCollection",void 0),_this246._bodyCollection=t,_this246.id=i,_this246.set({isOpen:!1,isEnabled:!0,panelPosition:"w","class":void 0,parentMenuView:null}),_this246.keystrokes=new Cr(),_this246.focusTracker=new _r(),_this246.buttonView=new Tf(e),_this246.buttonView.delegate("mouseenter").to(_assertThisInitialized(_this246)),_this246.buttonView.bind("isOn","isEnabled").to(_assertThisInitialized(_this246),"isOpen","isEnabled"),_this246.buttonView.label=n,_this246.panelView=new Hf(e),_this246.panelView.isVisible=!0,_this246.listView=new Rf(e),_this246.listView.bind("ariaLabel").to(_this246.buttonView,"label"),_this246.panelView.content.add(_this246.listView);var o=_this246.bindTemplate;_this246.setTemplate({tag:"div",attributes:{"class":["ck","ck-dropdown-menu-list__nested-menu",o.to("class"),o["if"]("isEnabled","ck-disabled",function(e){return!e;})],role:"presentation"},children:[_this246.buttonView]}),_this246.parentMenuView=s,_this246.parentMenuView&&_this246._handleParentMenuView(),_this246._attachBehaviors();return _this246;}_inherits($f,_lg23);return _createClass($f,[{key:"_panelPositions",get:function get(){var e=Of.westSouth,t=Of.eastSouth,i=Of.westNorth,n=Of.eastNorth;return"ltr"===this.locale.uiLanguageDirection?[t,n,e,i]:[e,i,t,n];}},{key:"render",value:function render(){_superPropGet($f,"render",this,3)([]),this.panelView.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.focusTracker.add(this.listView),this.keystrokes.listenTo(this.element),this._mountPanelOnOpen();}},{key:"destroy",value:function destroy(){this._removePanelFromBody(),this.panelView.destroy(),_superPropGet($f,"destroy",this,3)([]);}},{key:"focus",value:function focus(){this.buttonView.focus();}},{key:"_handleParentMenuView",value:function _handleParentMenuView(){this.delegate.apply(this,_toConsumableArray($f.DELEGATED_EVENTS)).to(this.parentMenuView),Lf.closeOnParentClose(this,this.parentMenuView);}},{key:"_attachBehaviors",value:function _attachBehaviors(){Lf.openOnButtonClick(this),Lf.openAndFocusOnEnterKeyPress(this),Lf.openOnArrowRightKey(this),Lf.closeOnEscKey(this),Lf.closeOnArrowLeftKey(this);}},{key:"_mountPanelOnOpen",value:function _mountPanelOnOpen(){var _this247=this;var e=this.panelView;this.on("change:isOpen",function(t,i,n){t.source===_this247&&(n||!_this247._bodyCollection.has(e)?n&&!_this247._bodyCollection.has(e)&&_this247._addPanelToBody():_this247._removePanelFromBody());});}},{key:"_removePanelFromBody",value:function _removePanelFromBody(){var e=this.panelView,t=this.keystrokes;this._bodyCollection.has(e)&&(this._bodyCollection.remove(e),t.stopListening(e.element));}},{key:"_addPanelToBody",value:function _addPanelToBody(){var e=this.panelView,t=this.buttonView,n=this.keystrokes;this._bodyCollection.has(e)||(this._bodyCollection.add(e),n.listenTo(e.element),e.pin({positions:this._panelPositions,limiter:i.document.body,element:e.element,target:t.element,fitInViewport:!0}));}}]);}(lg);_defineProperty($f,"DELEGATED_EVENTS",["mouseenter","execute","change:isOpen"]);var Uf=/*#__PURE__*/function(_Rf){function Uf(e,t,i){var _this248;_classCallCheck(this,Uf);_this248=_callSuper(this,Uf,[e]),_defineProperty(_assertThisInitialized(_this248),"_definition",void 0),_defineProperty(_assertThisInitialized(_this248),"_cachedMenus",[]),_defineProperty(_assertThisInitialized(_this248),"_cachedButtons",[]),_defineProperty(_assertThisInitialized(_this248),"_bodyCollection",void 0),_this248._bodyCollection=t,_this248._definition=i,_this248.set("menuPanelClass",void 0);return _this248;}_inherits(Uf,_Rf);return _createClass(Uf,[{key:"menus",get:function get(){return Array.from(this._cachedMenus.values());}},{key:"buttons",get:function get(){return Array.from(this._cachedButtons.values());}},{key:"render",value:function render(){this._createStructure(this._definition,null),_superPropGet(Uf,"render",this,3)([]),Mf.toggleMenusAndFocusItemsOnHover(this),Mf.closeMenuWhenAnotherOnTheSameLevelOpens(this);}},{key:"closeMenus",value:function closeMenus(){this.menus.forEach(function(e){e.isOpen=!1;});}},{key:"_createStructure",value:function _createStructure(e,t){var i=[];var _iterator381=_createForOfIteratorHelper(e),_step381;try{for(_iterator381.s();!(_step381=_iterator381.n()).done;){var _e402;var _n158=_step381.value;var _e401=void 0;"menu"in _n158?(_e401=new $f(this.locale,this._bodyCollection,_n158.id,_n158.menu,t),_e401.panelView.bind("class").to(this,"menuPanelClass"),t||(_e402=_e401).delegate.apply(_e402,_toConsumableArray($f.DELEGATED_EVENTS)).to(this,function(e){return"menu:".concat(e);}),this._cachedMenus.push(_e401),this._createStructure(_n158.children,_e401)):(_e401=new Ef(this.locale,_n158.id,_n158.label),t||_e401.delegate("execute").to(this,"menu:execute"),this._cachedButtons.push(_e401));var _s110=new Bf(this.locale,t,_e401);t||_s110.delegate("mouseenter").to(this,"menu:mouseenter"),i.push(_s110);}}catch(err){_iterator381.e(err);}finally{_iterator381.f();}(t?t.listView:this).items.addMany(i);}}]);}(Rf);var Wf=/*#__PURE__*/function(_lg24){function Wf(e){var _this249;_classCallCheck(this,Wf);_this249=_callSuper(this,Wf,[e]),_this249.setTemplate({tag:"span",attributes:{"class":["ck","ck-toolbar__separator"]}});return _this249;}_inherits(Wf,_lg24);return _createClass(Wf);}(lg);var jf=/*#__PURE__*/function(_lg25){function jf(e){var _this250;_classCallCheck(this,jf);_this250=_callSuper(this,jf,[e]),_this250.setTemplate({tag:"span",attributes:{"class":["ck","ck-toolbar__line-break"]}});return _this250;}_inherits(jf,_lg25);return _createClass(jf);}(lg);function qf(e){if(Array.isArray(e))return{items:e,removeItems:[]};var t={items:[],removeItems:[]};return e?_objectSpread(_objectSpread({},t),e):t;}var Gf=function(){return{alignLeft:vm.alignLeft,bold:vm.bold,importExport:vm.importExport,paragraph:vm.paragraph,plus:vm.plus,text:vm.text,threeVerticalDots:vm.threeVerticalDots,pilcrow:vm.pilcrow,dragIndicator:vm.dragIndicator};}();var Kf=/*#__PURE__*/function(_lg26){function Kf(e,t){var _this251;_classCallCheck(this,Kf);_this251=_callSuper(this,Kf,[e]);_defineProperty(_this251,"options",void 0);_defineProperty(_this251,"items",void 0);_defineProperty(_this251,"focusTracker",void 0);_defineProperty(_this251,"keystrokes",void 0);_defineProperty(_this251,"itemsView",void 0);_defineProperty(_this251,"children",void 0);_defineProperty(_this251,"focusables",void 0);_defineProperty(_this251,"_focusCycler",void 0);_defineProperty(_this251,"_behavior",void 0);var i=_this251.bindTemplate,n=_this251.t;_this251.options=t||{},_this251.set("ariaLabel",n("Editor toolbar")),_this251.set("maxWidth","auto"),_this251.items=_this251.createCollection(),_this251.focusTracker=new _r(),_this251.keystrokes=new Cr(),_this251.set("class",void 0),_this251.set("isCompact",!1),_this251.itemsView=new Zf(e),_this251.children=_this251.createCollection(),_this251.children.add(_this251.itemsView),_this251.focusables=_this251.createCollection();var s="rtl"===e.uiLanguageDirection;_this251._focusCycler=new _g({focusables:_this251.focusables,focusTracker:_this251.focusTracker,keystrokeHandler:_this251.keystrokes,actions:{focusPrevious:[s?"arrowright":"arrowleft","arrowup"],focusNext:[s?"arrowleft":"arrowright","arrowdown"]}});var o=["ck","ck-toolbar",i.to("class"),i["if"]("isCompact","ck-toolbar_compact")];var r;_this251.options.shouldGroupWhenFull&&_this251.options.isFloating&&o.push("ck-toolbar_floating"),_this251.setTemplate({tag:"div",attributes:{"class":o,role:"toolbar","aria-label":i.to("ariaLabel"),style:{maxWidth:i.to("maxWidth")},tabindex:-1},children:_this251.children,on:{mousedown:(r=_this251,r.bindTemplate.to(function(e){e.target===r.element&&e.preventDefault();}))}}),_this251._behavior=_this251.options.shouldGroupWhenFull?new Qf(_this251):new Jf(_this251);return _this251;}_inherits(Kf,_lg26);return _createClass(Kf,[{key:"render",value:function render(){var _this252=this;_superPropGet(Kf,"render",this,3)([]),this.focusTracker.add(this.element);var _iterator382=_createForOfIteratorHelper(this.items),_step382;try{for(_iterator382.s();!(_step382=_iterator382.n()).done;){var _e403=_step382.value;this.focusTracker.add(_e403);}}catch(err){_iterator382.e(err);}finally{_iterator382.f();}this.items.on("add",function(e,t){_this252.focusTracker.add(t);}),this.items.on("remove",function(e,t){_this252.focusTracker.remove(t);}),this.keystrokes.listenTo(this.element),this._behavior.render(this);}},{key:"destroy",value:function destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),_superPropGet(Kf,"destroy",this,3)([]);}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"focusLast",value:function focusLast(){this._focusCycler.focusLast();}},{key:"fillFromConfig",value:function fillFromConfig(e,t,i){this.items.addMany(this._buildItemsFromConfig(e,t,i));}},{key:"_buildItemsFromConfig",value:function _buildItemsFromConfig(e,t,i){var _this253=this;var n=qf(e),s=i||n.removeItems;return this._cleanItemsConfiguration(n.items,t,s).map(function(e){return ue(e)?_this253._createNestedToolbarDropdown(e,t,s):"|"===e?new Wf():"-"===e?new jf():t.create(e);}).filter(function(e){return!!e;});}},{key:"_cleanItemsConfiguration",value:function _cleanItemsConfiguration(e,t,i){var _this254=this;var n=e.filter(function(e,n,s){return"|"===e||-1===i.indexOf(e)&&("-"===e?!_this254.options.shouldGroupWhenFull||(E("toolbarview-line-break-ignored-when-grouping-items",s),!1):!(!ue(e)&&!t.has(e))||(E("toolbarview-item-unavailable",{item:e}),!1));});return this._cleanSeparatorsAndLineBreaks(n);}},{key:"_cleanSeparatorsAndLineBreaks",value:function _cleanSeparatorsAndLineBreaks(e){var t=function t(e){return"-"!==e&&"|"!==e;},i=e.length,n=e.findIndex(t);if(-1===n)return[];var s=i-e.slice().reverse().findIndex(t);return e.slice(n,s).filter(function(e,i,n){if(t(e))return!0;return!(i>0&&n[i-1]===e);});}},{key:"_createNestedToolbarDropdown",value:function _createNestedToolbarDropdown(e,t,i){var n=e.label,s=e.icon,o=e.items,_e$tooltip=e.tooltip,r=_e$tooltip===void 0?!0:_e$tooltip,_e$withText=e.withText,a=_e$withText===void 0?!1:_e$withText;if(o=this._cleanItemsConfiguration(o,t,i),!o.length)return null;var l=Xf(this.locale);return n||E("toolbarview-nested-toolbar-dropdown-missing-label",e),l["class"]="ck-toolbar__nested-toolbar-dropdown",l.buttonView.set({label:n,tooltip:r,withText:!!a}),!1!==s?l.buttonView.icon=Gf[s]||s||vm.threeVerticalDots:l.buttonView.withText=!0,ip(l,function(){return l.toolbarView._buildItemsFromConfig(o,t,i);}),l;}}]);}(lg);var Zf=/*#__PURE__*/function(_lg27){function Zf(e){var _this255;_classCallCheck(this,Zf);_this255=_callSuper(this,Zf,[e]),_defineProperty(_assertThisInitialized(_this255),"children",void 0),_this255.children=_this255.createCollection(),_this255.setTemplate({tag:"div",attributes:{"class":["ck","ck-toolbar__items"]},children:_this255.children});return _this255;}_inherits(Zf,_lg27);return _createClass(Zf);}(lg);var Jf=/*#__PURE__*/function(){function Jf(e){_classCallCheck(this,Jf);var t=e.bindTemplate;e.set("isVertical",!1),e.itemsView.children.bindTo(e.items).using(function(e){return e;}),e.focusables.bindTo(e.items).using(function(e){return yg(e)?e:null;}),e.extendTemplate({attributes:{"class":[t["if"]("isVertical","ck-toolbar_vertical")]}});}return _createClass(Jf,[{key:"render",value:function render(){}},{key:"destroy",value:function destroy(){}}]);}();var Qf=/*#__PURE__*/function(){function Qf(e){var _this256=this;_classCallCheck(this,Qf);_defineProperty(this,"view",void 0);_defineProperty(this,"viewChildren",void 0);_defineProperty(this,"viewFocusables",void 0);_defineProperty(this,"viewItemsView",void 0);_defineProperty(this,"viewFocusTracker",void 0);_defineProperty(this,"viewLocale",void 0);_defineProperty(this,"ungroupedItems",void 0);_defineProperty(this,"groupedItems",void 0);_defineProperty(this,"groupedItemsDropdown",void 0);_defineProperty(this,"resizeObserver",null);_defineProperty(this,"cachedPadding",null);_defineProperty(this,"shouldUpdateGroupingOnNextResize",!1);_defineProperty(this,"viewElement",void 0);this.view=e,this.viewChildren=e.children,this.viewFocusables=e.focusables,this.viewItemsView=e.itemsView,this.viewFocusTracker=e.focusTracker,this.viewLocale=e.locale,this.ungroupedItems=e.createCollection(),this.groupedItems=e.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),e.itemsView.children.bindTo(this.ungroupedItems).using(function(e){return e;}),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),e.children.on("change",this._updateFocusCyclableItems.bind(this)),e.items.on("change",function(e,t){var i=t.index,n=Array.from(t.added);var _iterator383=_createForOfIteratorHelper(t.removed),_step383;try{for(_iterator383.s();!(_step383=_iterator383.n()).done;){var _e405=_step383.value;i>=_this256.ungroupedItems.length?_this256.groupedItems.remove(_e405):_this256.ungroupedItems.remove(_e405);}}catch(err){_iterator383.e(err);}finally{_iterator383.f();}for(var _e404=i;_e404<i+n.length;_e404++){var _t250=n[_e404-i];_e404>_this256.ungroupedItems.length?_this256.groupedItems.add(_t250,_e404-_this256.ungroupedItems.length):_this256.ungroupedItems.add(_t250,_e404);}_this256._updateGrouping();}),e.extendTemplate({attributes:{"class":["ck-toolbar_grouping"]}});}return _createClass(Qf,[{key:"render",value:function render(e){this.viewElement=e.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(e);}},{key:"destroy",value:function destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy();}},{key:"_updateGrouping",value:function _updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!No(this.viewElement))return void(this.shouldUpdateGroupingOnNextResize=!0);var e=this.groupedItems.length;var t;for(;this._areItemsOverflowing;)this._groupLastItem(),t=!0;if(!t&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem();}this.groupedItems.length!==e&&this.view.fire("groupedItemsUpdate");}},{key:"_areItemsOverflowing",get:function get(){if(!this.ungroupedItems.length)return!1;var e=this.viewElement,t=this.viewLocale.uiLanguageDirection,n=new Eo(e.lastChild),s=new Eo(e);if(!this.cachedPadding){var _n159=i.window.getComputedStyle(e),_s111="ltr"===t?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(_n159[_s111]);}return"ltr"===t?n.right>s.right-this.cachedPadding:n.left<s.left+this.cachedPadding;}},{key:"_enableGroupingOnResize",value:function _enableGroupingOnResize(){var _this257=this;var e;this.resizeObserver=new Vo(this.viewElement,function(t){e&&e===t.contentRect.width&&!_this257.shouldUpdateGroupingOnNextResize||(_this257.shouldUpdateGroupingOnNextResize=!1,_this257._updateGrouping(),e=t.contentRect.width);}),this._updateGrouping();}},{key:"_enableGroupingOnMaxWidthChange",value:function _enableGroupingOnMaxWidthChange(e){var _this258=this;e.on("change:maxWidth",function(){_this258._updateGrouping();});}},{key:"_groupLastItem",value:function _groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new Wf()),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0);}},{key:"_ungroupFirstItem",value:function _ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element));}},{key:"_createGroupedItemsDropdown",value:function _createGroupedItemsDropdown(){var e=this.viewLocale,t=e.t,i=Xf(e);return i["class"]="ck-toolbar__grouped-dropdown",i.panelPosition="ltr"===e.uiLanguageDirection?"sw":"se",ip(i,this.groupedItems),i.buttonView.set({label:t("Show more items"),tooltip:!0,tooltipPosition:"rtl"===e.uiLanguageDirection?"se":"sw",icon:vm.threeVerticalDots}),i;}},{key:"_updateFocusCyclableItems",value:function _updateFocusCyclableItems(){var _this259=this;this.viewFocusables.clear(),this.ungroupedItems.map(function(e){yg(e)&&_this259.viewFocusables.add(e);}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown);}}]);}();var Yf=/*#__PURE__*/function(_lg28){function Yf(e,t){var _this260;_classCallCheck(this,Yf);_this260=_callSuper(this,Yf,[e]);_defineProperty(_this260,"children",void 0);_defineProperty(_this260,"actionView",void 0);_defineProperty(_this260,"arrowView",void 0);_defineProperty(_this260,"keystrokes",void 0);_defineProperty(_this260,"focusTracker",void 0);var i=_this260.bindTemplate;_this260.set("class",void 0),_this260.set("labelStyle",void 0),_this260.set("icon",void 0),_this260.set("isEnabled",!0),_this260.set("isOn",!1),_this260.set("isToggleable",!1),_this260.set("isVisible",!0),_this260.set("keystroke",void 0),_this260.set("withKeystroke",!1),_this260.set("label",void 0),_this260.set("tabindex",-1),_this260.set("tooltip",!1),_this260.set("tooltipPosition","s"),_this260.set("type","button"),_this260.set("withText",!1),_this260.children=_this260.createCollection(),_this260.actionView=_this260._createActionView(t),_this260.arrowView=_this260._createArrowView(),_this260.keystrokes=new Cr(),_this260.focusTracker=new _r(),_this260.setTemplate({tag:"div",attributes:{"class":["ck","ck-splitbutton",i.to("class"),i["if"]("isVisible","ck-hidden",function(e){return!e;}),_this260.arrowView.bindTemplate["if"]("isOn","ck-splitbutton_open")]},children:_this260.children});return _this260;}_inherits(Yf,_lg28);return _createClass(Yf,[{key:"render",value:function render(){var _this261=this;_superPropGet(Yf,"render",this,3)([]),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",function(e,t){_this261.focusTracker.focusedElement===_this261.actionView.element&&(_this261.arrowView.focus(),t());}),this.keystrokes.set("arrowleft",function(e,t){_this261.focusTracker.focusedElement===_this261.arrowView.element&&(_this261.actionView.focus(),t());});}},{key:"destroy",value:function destroy(){_superPropGet(Yf,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this.actionView.focus();}},{key:"_createActionView",value:function _createActionView(e){var t=e||new pg();return e||t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{"class":"ck-splitbutton__action"}}),t.delegate("execute").to(this),t;}},{key:"_createArrowView",value:function _createArrowView(){var e=new pg(),t=e.bindTemplate;return e.icon=Wg,e.extendTemplate({attributes:{"class":["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":t.to("isOn"),"aria-haspopup":!0,"aria-expanded":t.to("isOn",function(e){return String(e);})}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e;}}]);}(lg);function Xf(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:Af;var n="function"==typeof t?new t(e):t,s=new Cf(e),o=new xf(e,n,s);return n.bind("isEnabled").to(o),n instanceof Yf?n.arrowView.bind("isOn").to(o,"isOpen"):n.bind("isOn").to(o,"isOpen"),function(e){(function(e){cg({emitter:e,activator:function activator(){return e.isRendered&&e.isOpen;},callback:function callback(){e.isOpen=!1;},contextElements:function contextElements(){return[e.element].concat(_toConsumableArray(ap(e.focusTracker).filter(function(t){return!e.element.contains(t);})));}});})(e),function(e){e.on("execute",function(t){t.source instanceof Dg||(e.isOpen=!1);});}(e),function(e){e.focusTracker.on("change:isFocused",function(t,i,n){!n&&e.isOpen&&(e.isOpen=!1);});}(e),function(e){e.keystrokes.set("arrowdown",function(t,i){e.isOpen&&(e.panelView.focus(),i());}),e.keystrokes.set("arrowup",function(t,i){e.isOpen&&(e.panelView.focusLast(),i());});}(e),function(e){e.on("change:isOpen",function(t,n,s){if(s)return;e.focusTracker.elements.some(function(e){return e.contains(i.document.activeElement);})&&e.buttonView.focus();});}(e),function(e){e.on("change:isOpen",function(t,i,n){n&&e.panelView.focus();},{priority:"low"});}(e);}(o),o;}function ep(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};e.menuView=new Uf(e.locale,t,i),e.focusTracker.add(e.menuView),e.isOpen?tp(e,n):e.once("change:isOpen",function(){tp(e,n);},{priority:"highest"});}function tp(e,t){var i=e.menuView,n=e.locale.t;i.delegate("menu:execute").to(e,"execute"),i.listenTo(e,"change:isOpen",function(e,t,n){n||i.closeMenus();},{priority:"low"}),e.panelView.children.add(i);var _iterator384=_createForOfIteratorHelper(i.menus),_step384;try{for(_iterator384.s();!(_step384=_iterator384.n()).done;){var _t251=_step384.value;e.focusTracker.add(_t251);}}catch(err){_iterator384.e(err);}finally{_iterator384.f();}i.ariaLabel=t.ariaLabel||n("Dropdown menu");}function ip(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};e.extendTemplate({attributes:{"class":["ck-toolbar-dropdown"]}}),e.isOpen?np(e,t,i):e.once("change:isOpen",function(){return np(e,t,i);},{priority:"highest"}),i.enableActiveItemFocusOnDropdownOpen&&rp(e,function(){return e.toolbarView.items.find(function(e){return e.isOn;});});}function np(e,t,i){var n=e.locale,s=n.t,o=e.toolbarView=new Kf(n),r="function"==typeof t?t():t;o.ariaLabel=i.ariaLabel||s("Dropdown toolbar"),i.maxWidth&&(o.maxWidth=i.maxWidth),i["class"]&&(o["class"]=i["class"]),i.isCompact&&(o.isCompact=i.isCompact),i.isVertical&&(o.isVertical=!0),r instanceof zm?o.items.bindTo(r).using(function(e){return e;}):o.items.addMany(r),e.panelView.children.add(o),e.focusTracker.add(o),o.items.delegate("execute").to(e);}function sp(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};e.isOpen?op(e,t,i):e.once("change:isOpen",function(){return op(e,t,i);},{priority:"highest"}),rp(e,function(){return e.listView.items.find(function(e){return e instanceof Pf&&e.children.first.isOn;});});}function op(e,t,i){var n=e.locale,s=e.listView=new Vf(n),o="function"==typeof t?t():t;s.ariaLabel=i.ariaLabel,s.role=i.role,lp(e,s.items,o,n),e.panelView.children.add(s),s.items.delegate("execute").to(e);}function rp(e,t){e.on("change:isOpen",function(){if(!e.isOpen)return;var i=t();i&&("function"==typeof i.focus?i.focus():E("ui-dropdown-focus-child-on-open-child-missing-focus",{view:i}));},{priority:C.low-10});}function ap(e){return[].concat(_toConsumableArray(e.elements),_toConsumableArray(e.externalViews.flatMap(function(e){return ap(e.focusTracker);})));}function lp(e,t,i,n){t.on("change",function(){var e=_toConsumableArray(t).reduce(function(e,t){return t instanceof Pf&&t.children.first instanceof Ig&&e.push(t.children.first),e;},[]),i=e.some(function(e){return e.isToggleable;});e.forEach(function(e){e.hasCheckSpace=i;});}),t.bindTo(i).using(function(t){if("separator"===t.type)return new Sf(n);if("group"===t.type){var _i304=new If(n);return _i304.set({label:t.label}),lp(e,_i304.items,t.items,n),_i304.items.delegate("execute").to(e),_i304;}if("button"===t.type||"switchbutton"===t.type){var _s113;var _e406="menuitemcheckbox"===t.model.role||"menuitemradio"===t.model.role,_i305=new Pf(n);var _s112;return"button"===t.type?(_s112=new Ig(n),_s112.set({isToggleable:_e406})):_s112=new Dg(n),(_s113=_s112).bind.apply(_s113,_toConsumableArray(Object.keys(t.model))).to(t.model),_s112.delegate("execute").to(_i305),_i305.children.add(_s112),_i305;}return null;});}var cp=function cp(e,t,i){var n=new _f(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isReadOnly").to(e,"isEnabled",function(e){return!e;}),n.bind("hasError").to(e,"errorText",function(e){return!!e;}),n.on("input",function(){e.errorText=null;}),e.bind("isEmpty","isFocused","placeholder").to(n),n;},dp=function dp(e,t,i){var n=new vf(e.locale);return n.set({id:t,ariaDescribedById:i,inputMode:"numeric"}),n.bind("isReadOnly").to(e,"isEnabled",function(e){return!e;}),n.bind("hasError").to(e,"errorText",function(e){return!!e;}),n.on("input",function(){e.errorText=null;}),e.bind("isEmpty","isFocused","placeholder").to(n),n;},up=function up(e,t,i){var n=new yf(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isReadOnly").to(e,"isEnabled",function(e){return!e;}),n.bind("hasError").to(e,"errorText",function(e){return!!e;}),n.on("input",function(){e.errorText=null;}),e.bind("isEmpty","isFocused","placeholder").to(n),n;},hp=function hp(e,t,i){var n=Xf(e.locale);return n.set({id:t,ariaDescribedById:i}),n.bind("isEnabled").to(e),n;},mp=function mp(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:1;return e>i?i:e<t?t:e;},gp=function gp(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:Math.pow(10,t);return Math.round(i*e)/i;},fp=function fp(e){return"#"===e[0]&&(e=e.substring(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?gp(parseInt(e[3]+e[3],16)/255,2):1}:{r:parseInt(e.substring(0,2),16),g:parseInt(e.substring(2,4),16),b:parseInt(e.substring(4,6),16),a:8===e.length?gp(parseInt(e.substring(6,8),16)/255,2):1};},pp=function pp(e){var _ref72=function(_ref73){var e=_ref73.h,t=_ref73.s,i=_ref73.v,n=_ref73.a;var s=(200-t)*i/100;return{h:gp(e),s:gp(s>0&&s<200?t*i/100/(s<=100?s:200-s)*100:0),l:gp(s/2),a:gp(n,2)};}(e),t=_ref72.h,i=_ref72.s,n=_ref72.l;return"hsl(".concat(t,", ").concat(i,"%, ").concat(n,"%)");},bp=function bp(_ref74){var e=_ref74.h,t=_ref74.s,i=_ref74.v,n=_ref74.a;e=e/360*6,t/=100,i/=100;var s=Math.floor(e),o=i*(1-t),r=i*(1-(e-s)*t),a=i*(1-(1-e+s)*t),l=s%6;return{r:gp(255*[i,r,o,o,a,i][l]),g:gp(255*[a,i,i,r,o,o][l]),b:gp(255*[o,o,a,i,i,r][l]),a:gp(n,2)};},wp=function wp(e){var t=e.toString(16);return t.length<2?"0"+t:t;},_p=function _p(_ref75){var e=_ref75.r,t=_ref75.g,i=_ref75.b,n=_ref75.a;var s=n<1?wp(gp(255*n)):"";return"#"+wp(e)+wp(t)+wp(i)+s;},vp=function vp(_ref76){var e=_ref76.r,t=_ref76.g,i=_ref76.b,n=_ref76.a;var s=Math.max(e,t,i),o=s-Math.min(e,t,i),r=o?s===e?(t-i)/o:s===t?2+(i-e)/o:4+(e-t)/o:0;return{h:gp(60*(r<0?r+6:r)),s:gp(s?o/s*100:0),v:gp(s/255*100),a:n};},yp=function yp(e,t){if(e===t)return!0;for(var _i306 in e)if(e[_i306]!==t[_i306])return!1;return!0;},kp={},Cp=function Cp(e){var t=kp[e];return t||(t=document.createElement("template"),t.innerHTML=e,kp[e]=t),t;},xp=function xp(e,t,i){e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:i}));};var Ap=!1;var Ep=function Ep(e){return"touches"in e;},Tp=function Tp(e,t){var i=Ep(t)?t.touches[0]:t,n=e.el.getBoundingClientRect();xp(e.el,"move",e.getMove({x:mp((i.pageX-(n.left+window.pageXOffset))/n.width),y:mp((i.pageY-(n.top+window.pageYOffset))/n.height)}));};var Pp=/*#__PURE__*/function(){function Pp(e,t,i,n){_classCallCheck(this,Pp);var s=Cp("<div role=\"slider\" tabindex=\"0\" part=\"".concat(t,"\" ").concat(i,"><div part=\"").concat(t,"-pointer\"></div></div>"));e.appendChild(s.content.cloneNode(!0));var o=e.querySelector("[part=".concat(t,"]"));o.addEventListener("mousedown",this),o.addEventListener("touchstart",this),o.addEventListener("keydown",this),this.el=o,this.xy=n,this.nodes=[o.firstChild,o];}return _createClass(Pp,[{key:"dragging",set:function set(e){var t=e?document.addEventListener:document.removeEventListener;t(Ap?"touchmove":"mousemove",this),t(Ap?"touchend":"mouseup",this);}},{key:"handleEvent",value:function handleEvent(e){switch(e.type){case"mousedown":case"touchstart":if(e.preventDefault(),!function(e){return!(Ap&&!Ep(e)||(Ap||(Ap=Ep(e)),0));}(e)||!Ap&&0!=e.button)return;this.el.focus(),Tp(this,e),this.dragging=!0;break;case"mousemove":case"touchmove":e.preventDefault(),Tp(this,e);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":(function(e,t){var i=t.keyCode;i>40||e.xy&&i<37||i<33||(t.preventDefault(),xp(e.el,"move",e.getMove({x:39===i?.01:37===i?-.01:34===i?.05:33===i?-.05:35===i?1:36===i?-1:0,y:40===i?.01:38===i?-.01:0},!0)));})(this,e);}}},{key:"style",value:function style(e){var _this262=this;e.forEach(function(e,t){for(var _i307 in e)_this262.nodes[t].style.setProperty(_i307,e[_i307]);});}}]);}();var Sp=/*#__PURE__*/function(_Pp){function Sp(e){_classCallCheck(this,Sp);return _callSuper(this,Sp,[e,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1]);}_inherits(Sp,_Pp);return _createClass(Sp,[{key:"update",value:function update(_ref77){var e=_ref77.h;this.h=e,this.style([{left:e/360*100+"%",color:pp({h:e,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow","".concat(gp(e)));}},{key:"getMove",value:function getMove(e,t){return{h:t?mp(this.h+360*e.x,0,360):360*e.x};}}]);}(Pp);var Ip=/*#__PURE__*/function(_Pp2){function Ip(e){_classCallCheck(this,Ip);return _callSuper(this,Ip,[e,"saturation",'aria-label="Color"',!0]);}_inherits(Ip,_Pp2);return _createClass(Ip,[{key:"update",value:function update(e){this.hsva=e,this.style([{top:100-e.v+"%",left:"".concat(e.s,"%"),color:pp(e)},{"background-color":pp({h:e.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext","Saturation ".concat(gp(e.s),"%, Brightness ").concat(gp(e.v),"%"));}},{key:"getMove",value:function getMove(e,t){return{s:t?mp(this.hsva.s+100*e.x,0,100):100*e.x,v:t?mp(this.hsva.v-100*e.y,0,100):Math.round(100-100*e.y)};}}]);}(Pp);var Vp=Symbol("same"),Rp=Symbol("color"),Op=Symbol("hsva"),Bp=Symbol("update"),Mp=Symbol("parts"),Lp=Symbol("css"),Fp=Symbol("sliders");var Np=/*#__PURE__*/function(_HTMLElement){function Np(){var _this263;_classCallCheck(this,Np);_this263=_callSuper(this,Np);var e=Cp("<style>".concat(_this263[Lp].join(""),"</style>")),t=_this263.attachShadow({mode:"open"});t.appendChild(e.content.cloneNode(!0)),t.addEventListener("move",_this263),_this263[Mp]=_this263[Fp].map(function(e){return new e(t);});return _this263;}_inherits(Np,_HTMLElement);return _createClass(Np,[{key:Lp,get:function get(){return[':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',"[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}","[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}"];}},{key:Fp,get:function get(){return[Ip,Sp];}},{key:"color",get:function get(){return this[Rp];},set:function set(e){if(!this[Vp](e)){var _t252=this.colorModel.toHsva(e);this[Bp](_t252),this[Rp]=e;}}},{key:"connectedCallback",value:function connectedCallback(){if(this.hasOwnProperty("color")){var _e407=this.color;delete this.color,this.color=_e407;}else this.color||(this.color=this.colorModel.defaultColor);}},{key:"attributeChangedCallback",value:function attributeChangedCallback(e,t,i){var n=this.colorModel.fromAttr(i);this[Vp](n)||(this.color=n);}},{key:"handleEvent",value:function handleEvent(e){var t=this[Op],i=_objectSpread(_objectSpread({},t),e.detail);var n;this[Bp](i),yp(i,t)||this[Vp](n=this.colorModel.fromHsva(i))||(this[Rp]=n,xp(this,"color-changed",{value:n}));}},{key:Vp,value:function value(e){return this.color&&this.colorModel.equal(e,this.color);}},{key:Bp,value:function value(e){this[Op]=e,this[Mp].forEach(function(t){return t.update(e);});}}],[{key:"observedAttributes",get:function get(){return["color"];}}]);}(/*#__PURE__*/_wrapNativeSuper(HTMLElement));var Dp={defaultColor:"#000",toHsva:function toHsva(e){return vp(fp(e));},fromHsva:function fromHsva(_ref78){var e=_ref78.h,t=_ref78.s,i=_ref78.v;return _p(bp({h:e,s:t,v:i,a:1}));},equal:function equal(e,t){return e.toLowerCase()===t.toLowerCase()||yp(fp(e),fp(t));},fromAttr:function fromAttr(e){return e;}};var zp=/*#__PURE__*/function(_Np){function zp(){_classCallCheck(this,zp);return _callSuper(this,zp,arguments);}_inherits(zp,_Np);return _createClass(zp,[{key:"colorModel",get:function get(){return Dp;}}]);}(Np);var Hp=/*#__PURE__*/function(_lg29){function Hp(e){var _this264;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Hp);_this264=_callSuper(this,Hp,[e]),_defineProperty(_assertThisInitialized(_this264),"hexInputRow",void 0),_defineProperty(_assertThisInitialized(_this264),"_debounceColorPickerEvent",void 0),_defineProperty(_assertThisInitialized(_this264),"_config",void 0),_this264.set({color:"",_hexColor:""}),_this264.hexInputRow=_this264._createInputRow();var i=_this264.createCollection();t.hideInput||i.add(_this264.hexInputRow),_this264.setTemplate({tag:"div",attributes:{"class":["ck","ck-color-picker"],tabindex:-1},children:i}),_this264._config=t,_this264._debounceColorPickerEvent=vs(function(e){_this264.set("color",e),_this264.fire("colorSelected",{color:_this264.color});},150,{leading:!0}),_this264.on("set:color",function(e,t,i){e["return"]=gf(i,_this264._config.format||"hsl");}),_this264.on("change:color",function(){_this264._hexColor=$p(_this264.color);}),_this264.on("change:_hexColor",function(){document.activeElement!==_this264.picker&&_this264.picker.setAttribute("color",_this264._hexColor),$p(_this264.color)!=$p(_this264._hexColor)&&(_this264.color=_this264._hexColor);});return _this264;}_inherits(Hp,_lg29);return _createClass(Hp,[{key:"render",value:function render(){var _this265=this;var e,t;if(_superPropGet(Hp,"render",this,3)([]),e="hex-color-picker",t=zp,void 0===customElements.get(e)&&customElements.define(e,t),this.picker=i.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);var _e408=document.createElement("style");_e408.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(_e408);}this.picker.addEventListener("color-changed",function(e){var t=e.detail.value;_this265._debounceColorPickerEvent(t);});}},{key:"focus",value:function focus(){if(!this._config.hideInput&&(o.isGecko||o.isiOS||o.isSafari)){this.hexInputRow.children.get(1).focus();}this.slidersView.first.focus();}},{key:"_createSlidersView",value:function _createSlidersView(){var _this266=this;var e=_toConsumableArray(this.picker.shadowRoot.children).filter(function(e){return"slider"===e.getAttribute("role");}).map(function(e){return new Up(e);});this.slidersView=this.createCollection(),e.forEach(function(e){_this266.slidersView.add(e);});}},{key:"_createInputRow",value:function _createInputRow(){var e=this._createColorInput();return new jp(this.locale,e);}},{key:"_createColorInput",value:function _createColorInput(){var _this267=this;var e=new pf(this.locale,cp),t=this.locale.t;return e.set({label:t("HEX"),"class":"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",function(t){return e.isFocused?e.fieldView.value:t.startsWith("#")?t.substring(1):t;}),e.fieldView.on("input",function(){var t=e.fieldView.element.value;if(t){var _e409=qp(t);_e409&&_this267._debounceColorPickerEvent(_e409);}}),e;}},{key:"isValid",value:function isValid(){var e=this.locale.t;return!!this._config.hideInput||(this.resetValidationStatus(),!!this.hexInputRow.getParsedColor()||(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1));}},{key:"resetValidationStatus",value:function resetValidationStatus(){this.hexInputRow.inputView.errorText=null;}}]);}(lg);function $p(e){var t=function(e){if(!e)return"";var t=ff(e);return t?"hex"===t.space?t.hexValue:gf(e,"hex"):"#000";}(e);return t||(t="#000"),4===t.length&&(t="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("")),t.toLowerCase();}var Up=/*#__PURE__*/function(_lg30){function Up(e){var _this268;_classCallCheck(this,Up);_this268=_callSuper(this,Up),_this268.element=e;return _this268;}_inherits(Up,_lg30);return _createClass(Up,[{key:"focus",value:function focus(){this.element.focus();}}]);}(lg);var Wp=/*#__PURE__*/function(_lg31){function Wp(e){var _this269;_classCallCheck(this,Wp);_this269=_callSuper(this,Wp,[e]),_this269.setTemplate({tag:"div",attributes:{"class":["ck","ck-color-picker__hash-view"]},children:"#"});return _this269;}_inherits(Wp,_lg31);return _createClass(Wp);}(lg);var jp=/*#__PURE__*/function(_lg32){function jp(e,t){var _this270;_classCallCheck(this,jp);_this270=_callSuper(this,jp,[e]),_defineProperty(_assertThisInitialized(_this270),"children",void 0),_defineProperty(_assertThisInitialized(_this270),"inputView",void 0),_this270.inputView=t,_this270.children=_this270.createCollection([new Wp(),_this270.inputView]),_this270.setTemplate({tag:"div",attributes:{"class":["ck","ck-color-picker__row"]},children:_this270.children});return _this270;}_inherits(jp,_lg32);return _createClass(jp,[{key:"getParsedColor",value:function getParsedColor(){return qp(this.inputView.fieldView.element.value);}}]);}(lg);function qp(e){if(!e)return null;var t=e.trim().replace(/^#/,"");return[3,4,6,8].includes(t.length)&&/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(t)?"#".concat(t):null;}var Gp=/*#__PURE__*/function(_Zs13){function Gp(e){var _this271;_classCallCheck(this,Gp);_this271=_callSuper(this,Gp,[e]),_this271.set("isEmpty",!0),_this271.on("change",function(){_this271.set("isEmpty",0===_this271.length);});return _this271;}_inherits(Gp,_Zs13);return _createClass(Gp,[{key:"add",value:function add(e,t){return this.find(function(t){return t.color===e.color;})?this:_superPropGet(Gp,"add",this,3)([e,t]);}},{key:"hasColor",value:function hasColor(e){return!!this.find(function(t){return t.color===e;});}}]);}(Zs(br));var Kp=/*#__PURE__*/function(_lg33){function Kp(e,_ref79){var _this272;var t=_ref79.colors,i=_ref79.columns,n=_ref79.removeButtonLabel,s=_ref79.documentColorsLabel,o=_ref79.documentColorsCount,r=_ref79.colorPickerLabel,a=_ref79.focusTracker,l=_ref79.focusables;_classCallCheck(this,Kp);_this272=_callSuper(this,Kp,[e]);_defineProperty(_this272,"items",void 0);_defineProperty(_this272,"colorDefinitions",void 0);_defineProperty(_this272,"focusTracker",void 0);_defineProperty(_this272,"columns",void 0);_defineProperty(_this272,"documentColors",void 0);_defineProperty(_this272,"documentColorsCount",void 0);_defineProperty(_this272,"staticColorsGrid",void 0);_defineProperty(_this272,"documentColorsGrid",void 0);_defineProperty(_this272,"colorPickerButtonView",void 0);_defineProperty(_this272,"removeColorButtonView",void 0);_defineProperty(_this272,"_focusables",void 0);_defineProperty(_this272,"_documentColorsLabel",void 0);_defineProperty(_this272,"_removeButtonLabel",void 0);_defineProperty(_this272,"_colorPickerLabel",void 0);var c=_this272.bindTemplate;_this272.set("isVisible",!0),_this272.focusTracker=a,_this272.items=_this272.createCollection(),_this272.colorDefinitions=t,_this272.columns=i,_this272.documentColors=new Gp(),_this272.documentColorsCount=o,_this272._focusables=l,_this272._removeButtonLabel=n,_this272._colorPickerLabel=r,_this272._documentColorsLabel=s,_this272.setTemplate({tag:"div",attributes:{"class":["ck-color-grids-fragment",c["if"]("isVisible","ck-hidden",function(e){return!e;})]},children:_this272.items}),_this272.removeColorButtonView=_this272._createRemoveColorButton(),_this272.items.add(_this272.removeColorButtonView);return _this272;}_inherits(Kp,_lg33);return _createClass(Kp,[{key:"updateDocumentColors",value:function updateDocumentColors(e,t){var i=e.document,n=this.documentColorsCount;this.documentColors.clear();var _iterator385=_createForOfIteratorHelper(i.getRoots()),_step385;try{for(_iterator385.s();!(_step385=_iterator385.n()).done;){var _s114=_step385.value;var _i308=e.createRangeIn(_s114);var _iterator386=_createForOfIteratorHelper(_i308.getItems()),_step386;try{for(_iterator386.s();!(_step386=_iterator386.n()).done;){var _e410=_step386.value;if(_e410.is("$textProxy")&&_e410.hasAttribute(t)&&(this._addColorToDocumentColors(_e410.getAttribute(t)),this.documentColors.length>=n))return;}}catch(err){_iterator386.e(err);}finally{_iterator386.f();}}}catch(err){_iterator385.e(err);}finally{_iterator385.f();}}},{key:"updateSelectedColors",value:function updateSelectedColors(){var e=this.documentColorsGrid,t=this.staticColorsGrid,i=this.selectedColor;t.selectedColor=i,e&&(e.selectedColor=i);}},{key:"render",value:function render(){if(_superPropGet(Kp,"render",this,3)([]),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){var _e411=Hm.bind(this.documentColors,this.documentColors),_t253=new lg(this.locale);_t253.setTemplate({tag:"span",attributes:{"class":["ck","ck-color-grid__label",_e411["if"]("isEmpty","ck-hidden")]},children:[{text:this._documentColorsLabel}]}),this.items.add(_t253),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid);}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker();}},{key:"focus",value:function focus(){this.removeColorButtonView.focus();}},{key:"destroy",value:function destroy(){_superPropGet(Kp,"destroy",this,3)([]);}},{key:"addColorPickerButton",value:function addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView));}},{key:"_addColorSelectorElementsToFocusTracker",value:function _addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid));}},{key:"_createColorPickerButton",value:function _createColorPickerButton(){var _this273=this;this.colorPickerButtonView=new pg(),this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:vm.colorPalette,"class":"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",function(){_this273.fire("colorPicker:show");});}},{key:"_createRemoveColorButton",value:function _createRemoveColorButton(){var _this274=this;var e=new pg();return e.set({withText:!0,icon:vm.eraser,label:this._removeButtonLabel}),e["class"]="ck-color-selector__remove-color",e.on("execute",function(){_this274.fire("execute",{value:null,source:"removeColorButton"});}),e.render(),e;}},{key:"_createStaticColorsGrid",value:function _createStaticColorsGrid(){var _this275=this;var e=new Jg(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",function(e,t){_this275.fire("execute",{value:t.value,source:"staticColorsGrid"});}),e;}},{key:"_createDocumentColorsGrid",value:function _createDocumentColorsGrid(){var _this276=this;var e=Hm.bind(this.documentColors,this.documentColors),t=new Jg(this.locale,{columns:this.columns});return t.extendTemplate({attributes:{"class":e["if"]("isEmpty","ck-hidden")}}),t.items.bindTo(this.documentColors).using(function(e){var t=new Zg();return t.set({color:e.color,hasBorder:e.options&&e.options.hasBorder}),e.label&&t.set({label:e.label,tooltip:!0}),t.on("execute",function(){_this276.fire("execute",{value:e.color,source:"documentColorsGrid"});}),t;}),this.documentColors.on("change:isEmpty",function(e,i,n){n&&(t.selectedColor=null);}),t;}},{key:"_addColorToDocumentColors",value:function _addColorToDocumentColors(e){var t=this.colorDefinitions.find(function(t){return t.color===e;});t?this.documentColors.add(Object.assign({},t)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}});}}]);}(lg);var Zp=/*#__PURE__*/function(_lg34){function Zp(e,_ref80){var _this277;var t=_ref80.focusTracker,i=_ref80.focusables,n=_ref80.keystrokes,s=_ref80.colorPickerViewConfig;_classCallCheck(this,Zp);_this277=_callSuper(this,Zp,[e]),_defineProperty(_assertThisInitialized(_this277),"items",void 0),_defineProperty(_assertThisInitialized(_this277),"colorPickerView",void 0),_defineProperty(_assertThisInitialized(_this277),"saveButtonView",void 0),_defineProperty(_assertThisInitialized(_this277),"cancelButtonView",void 0),_defineProperty(_assertThisInitialized(_this277),"actionBarView",void 0),_defineProperty(_assertThisInitialized(_this277),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this277),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this277),"_focusables",void 0),_defineProperty(_assertThisInitialized(_this277),"_colorPickerViewConfig",void 0),_this277.items=_this277.createCollection(),_this277.focusTracker=t,_this277.keystrokes=n,_this277.set("isVisible",!1),_this277.set("selectedColor",void 0),_this277._focusables=i,_this277._colorPickerViewConfig=s;var o=_this277.bindTemplate,_this277$_createActio=_this277._createActionButtons(),r=_this277$_createActio.saveButtonView,a=_this277$_createActio.cancelButtonView;_this277.saveButtonView=r,_this277.cancelButtonView=a,_this277.actionBarView=_this277._createActionBarView({saveButtonView:r,cancelButtonView:a}),_this277.setTemplate({tag:"div",attributes:{"class":["ck-color-picker-fragment",o["if"]("isVisible","ck-hidden",function(e){return!e;})]},children:_this277.items});return _this277;}_inherits(Zp,_lg34);return _createClass(Zp,[{key:"render",value:function render(){_superPropGet(Zp,"render",this,3)([]);var e=new Hp(this.locale,_objectSpread({},this._colorPickerViewConfig));this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",function(t,i,n){e.color=n;}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange();}},{key:"destroy",value:function destroy(){_superPropGet(Zp,"destroy",this,3)([]);}},{key:"focus",value:function focus(){this.colorPickerView.focus();}},{key:"resetValidationStatus",value:function resetValidationStatus(){this.colorPickerView.resetValidationStatus();}},{key:"_executeOnEnterPress",value:function _executeOnEnterPress(){var _this278=this;this.keystrokes.set("enter",function(e){_this278.isVisible&&_this278.focusTracker.focusedElement!==_this278.cancelButtonView.element&&_this278.colorPickerView.isValid()&&(_this278.fire("execute",{value:_this278.selectedColor}),e.stopPropagation(),e.preventDefault());});}},{key:"_stopPropagationOnArrowsKeys",value:function _stopPropagationOnArrowsKeys(){var e=function(_e412){function e(_x5){return _e412.apply(this,arguments);}e.toString=function(){return _e412.toString();};return e;}(function(e){return e.stopPropagation();});this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e);}},{key:"_addColorPickersElementsToFocusTracker",value:function _addColorPickersElementsToFocusTracker(){var _iterator387=_createForOfIteratorHelper(this.colorPickerView.slidersView),_step387;try{for(_iterator387.s();!(_step387=_iterator387.n()).done;){var _e413=_step387.value;this.focusTracker.add(_e413.element),this._focusables.add(_e413);}}catch(err){_iterator387.e(err);}finally{_iterator387.f();}var e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView);}},{key:"_createActionBarView",value:function _createActionBarView(_ref81){var e=_ref81.saveButtonView,t=_ref81.cancelButtonView;var i=new lg(),n=this.createCollection();return n.add(e),n.add(t),i.setTemplate({tag:"div",attributes:{"class":["ck","ck-color-selector_action-bar"]},children:n}),i;}},{key:"_createActionButtons",value:function _createActionButtons(){var _this279=this;var e=this.locale,t=e.t,i=new pg(e),n=new pg(e);return i.set({icon:vm.check,"class":"ck-button-save",type:"button",withText:!1,label:t("Accept")}),n.set({icon:vm.cancel,"class":"ck-button-cancel",type:"button",withText:!1,label:t("Cancel")}),i.on("execute",function(){_this279.colorPickerView.isValid()&&_this279.fire("execute",{source:"colorPickerSaveButton",value:_this279.selectedColor});}),n.on("execute",function(){_this279.fire("colorPicker:cancel");}),{saveButtonView:i,cancelButtonView:n};}},{key:"_executeUponColorChange",value:function _executeUponColorChange(){var _this280=this;this.colorPickerView.on("colorSelected",function(e,t){_this280.fire("execute",{value:t.color,source:"colorPicker"}),_this280.set("selectedColor",t.color);});}}]);}(lg);var Jp=/*#__PURE__*/function(_lg35){function Jp(e,_ref82){var _this281;var t=_ref82.colors,i=_ref82.columns,n=_ref82.removeButtonLabel,s=_ref82.documentColorsLabel,o=_ref82.documentColorsCount,r=_ref82.colorPickerLabel,a=_ref82.colorPickerViewConfig;_classCallCheck(this,Jp);_this281=_callSuper(this,Jp,[e]),_defineProperty(_assertThisInitialized(_this281),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this281),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this281),"items",void 0),_defineProperty(_assertThisInitialized(_this281),"colorGridsFragmentView",void 0),_defineProperty(_assertThisInitialized(_this281),"colorPickerFragmentView",void 0),_defineProperty(_assertThisInitialized(_this281),"_focusCycler",void 0),_defineProperty(_assertThisInitialized(_this281),"_focusables",void 0),_defineProperty(_assertThisInitialized(_this281),"_colorPickerViewConfig",void 0),_this281.items=_this281.createCollection(),_this281.focusTracker=new _r(),_this281.keystrokes=new Cr(),_this281._focusables=new zm(),_this281._colorPickerViewConfig=a,_this281._focusCycler=new _g({focusables:_this281._focusables,focusTracker:_this281.focusTracker,keystrokeHandler:_this281.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this281.colorGridsFragmentView=new Kp(e,{colors:t,columns:i,removeButtonLabel:n,documentColorsLabel:s,documentColorsCount:o,colorPickerLabel:r,focusTracker:_this281.focusTracker,focusables:_this281._focusables}),_this281.colorPickerFragmentView=new Zp(e,{focusables:_this281._focusables,focusTracker:_this281.focusTracker,keystrokes:_this281.keystrokes,colorPickerViewConfig:a}),_this281.set("_isColorGridsFragmentVisible",!0),_this281.set("_isColorPickerFragmentVisible",!1),_this281.set("selectedColor",void 0),_this281.colorGridsFragmentView.bind("isVisible").to(_assertThisInitialized(_this281),"_isColorGridsFragmentVisible"),_this281.colorPickerFragmentView.bind("isVisible").to(_assertThisInitialized(_this281),"_isColorPickerFragmentVisible"),_this281.on("change:selectedColor",function(e,t,i){_this281.colorGridsFragmentView.set("selectedColor",i),_this281.colorPickerFragmentView.set("selectedColor",i);}),_this281.colorGridsFragmentView.on("change:selectedColor",function(e,t,i){_this281.set("selectedColor",i);}),_this281.colorPickerFragmentView.on("change:selectedColor",function(e,t,i){_this281.set("selectedColor",i);}),_this281.setTemplate({tag:"div",attributes:{"class":["ck","ck-color-selector"]},children:_this281.items});return _this281;}_inherits(Jp,_lg35);return _createClass(Jp,[{key:"render",value:function render(){_superPropGet(Jp,"render",this,3)([]),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(Jp,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"appendUI",value:function appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment();}},{key:"showColorPickerFragment",value:function showColorPickerFragment(){this.colorPickerFragmentView.colorPickerView&&!this._isColorPickerFragmentVisible&&(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1);}},{key:"showColorGridsFragment",value:function showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1);}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"focusLast",value:function focusLast(){this._focusCycler.focusLast();}},{key:"updateDocumentColors",value:function updateDocumentColors(e,t){this.colorGridsFragmentView.updateDocumentColors(e,t);}},{key:"updateSelectedColors",value:function updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors();}},{key:"_appendColorGridsFragment",value:function _appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this));}},{key:"_appendColorPickerFragment",value:function _appendColorPickerFragment(){var _this282=this;2!==this.items.length&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",function(){_this282.showColorPickerFragment();}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this));}}]);}(lg);var Qp=/*#__PURE__*/function(){function Qp(e){_classCallCheck(this,Qp);_defineProperty(this,"editor",void 0);_defineProperty(this,"_components",new Map());this.editor=e;}return _createClass(Qp,[{key:"names",value:/*#__PURE__*/_regeneratorRuntime().mark(function names(){var _iterator388,_step388,_e414;return _regeneratorRuntime().wrap(function names$(_context39){while(1)switch(_context39.prev=_context39.next){case 0:_iterator388=_createForOfIteratorHelper(this._components.values());_context39.prev=1;_iterator388.s();case 3:if((_step388=_iterator388.n()).done){_context39.next=9;break;}_e414=_step388.value;_context39.next=7;return _e414.originalName;case 7:_context39.next=3;break;case 9:_context39.next=14;break;case 11:_context39.prev=11;_context39.t0=_context39["catch"](1);_iterator388.e(_context39.t0);case 14:_context39.prev=14;_iterator388.f();return _context39.finish(14);case 17:case"end":return _context39.stop();}},names,this,[[1,11,14,17]]);})},{key:"add",value:function add(e,t){this._components.set(Yp(e),{callback:t,originalName:e});}},{key:"create",value:function create(e){if(!this.has(e))throw new A("componentfactory-item-missing",this,{name:e});return this._components.get(Yp(e)).callback(this.editor.locale);}},{key:"has",value:function has(e){return this._components.has(Yp(e));}}]);}();function Yp(e){return String(e).toLowerCase();}var Xp="ck-tooltip";var eb=/*#__PURE__*/function(_go4){function eb(e){var _this283;_classCallCheck(this,eb);if(_this283=_callSuper(this,eb),_defineProperty(_assertThisInitialized(_this283),"tooltipTextView",void 0),_defineProperty(_assertThisInitialized(_this283),"balloonPanelView",void 0),_defineProperty(_assertThisInitialized(_this283),"_currentElementWithTooltip",null),_defineProperty(_assertThisInitialized(_this283),"_currentTooltipPosition",null),_defineProperty(_assertThisInitialized(_this283),"_mutationObserver",null),_defineProperty(_assertThisInitialized(_this283),"_pinTooltipDebounced",void 0),_defineProperty(_assertThisInitialized(_this283),"_unpinTooltipDebounced",void 0),_defineProperty(_assertThisInitialized(_this283),"_watchdogExcluded",void 0),_assertThisInitialized(_this283),eb._editors.add(e),eb._instance)return _possibleConstructorReturn(_this283,eb._instance);eb._instance=_this283,_this283.tooltipTextView=new lg(e.locale),_this283.tooltipTextView.set("text",""),_this283.tooltipTextView.setTemplate({tag:"span",attributes:{"class":["ck","ck-tooltip__text"]},children:[{text:_this283.tooltipTextView.bindTemplate.to("text")}]}),_this283.balloonPanelView=new Df(e.locale),_this283.balloonPanelView["class"]=Xp,_this283.balloonPanelView.content.add(_this283.tooltipTextView),_this283._mutationObserver=function(e){var t=new MutationObserver(function(){e();});return{attach:function attach(e){t.observe(e,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]});},detach:function detach(){t.disconnect();}};}(function(){_this283._updateTooltipPosition();}),_this283._pinTooltipDebounced=vs(_this283._pinTooltip,600),_this283._unpinTooltipDebounced=vs(_this283._unpinTooltip,400),_this283.listenTo(i.document,"keydown",_this283._onKeyDown.bind(_this283),{useCapture:!0}),_this283.listenTo(i.document,"mouseenter",_this283._onEnterOrFocus.bind(_this283),{useCapture:!0}),_this283.listenTo(i.document,"mouseleave",_this283._onLeaveOrBlur.bind(_this283),{useCapture:!0}),_this283.listenTo(i.document,"focus",_this283._onEnterOrFocus.bind(_this283),{useCapture:!0}),_this283.listenTo(i.document,"blur",_this283._onLeaveOrBlur.bind(_this283),{useCapture:!0}),_this283.listenTo(i.document,"scroll",_this283._onScroll.bind(_this283),{useCapture:!0}),_this283._watchdogExcluded=!0;return _this283;}_inherits(eb,_go4);return _createClass(eb,[{key:"destroy",value:function destroy(e){var t=e.ui.view&&e.ui.view.body;eb._editors["delete"](e),this.stopListening(e.ui),t&&t.has(this.balloonPanelView)&&t.remove(this.balloonPanelView),eb._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),eb._instance=null);}},{key:"_onKeyDown",value:function _onKeyDown(e,t){"Escape"===t.key&&this._currentElementWithTooltip&&(this._unpinTooltip(),t.stopPropagation());}},{key:"_onEnterOrFocus",value:function _onEnterOrFocus(e,_ref83){var t=_ref83.target;var i=tb(t);i?i!==this._currentElementWithTooltip&&(this._unpinTooltip(),"focus"!==e.name||i.matches(":hover")?this._pinTooltipDebounced(i,ib(i)):this._pinTooltip(i,ib(i))):"focus"===e.name&&this._unpinTooltip();}},{key:"_onLeaveOrBlur",value:function _onLeaveOrBlur(e,_ref84){var t=_ref84.target,i=_ref84.relatedTarget;if("mouseleave"===e.name){if(!Ms(t))return;var _e415=this.balloonPanelView.element,_n160=_e415&&(_e415===i||_e415.contains(i)),_s115=!_n160&&t===_e415;if(_n160)return void this._unpinTooltipDebounced.cancel();if(!_s115&&this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;var _o58=tb(t),_r33=tb(i);(_s115||_o58&&_o58!==_r33)&&this._unpinTooltipDebounced();}else{if(this._currentElementWithTooltip&&t!==this._currentElementWithTooltip)return;this._unpinTooltipDebounced();}}},{key:"_onScroll",value:function _onScroll(e,_ref85){var t=_ref85.target;this._currentElementWithTooltip&&(t.contains(this.balloonPanelView.element)&&t.contains(this._currentElementWithTooltip)||this._unpinTooltip());}},{key:"_pinTooltip",value:function _pinTooltip(e,_ref86){var t=_ref86.text,i=_ref86.position,n=_ref86.cssClass;this._unpinTooltip();var s=wr(eb._editors.values()).ui.view.body;s.has(this.balloonPanelView)||s.add(this.balloonPanelView),this.tooltipTextView.text=t,this.balloonPanelView["class"]=[Xp,n].filter(function(e){return e;}).join(" "),this.balloonPanelView.pin({target:e,positions:eb.getPositioningFunctions(i)}),this._mutationObserver.attach(e);var _iterator389=_createForOfIteratorHelper(eb._editors),_step389;try{for(_iterator389.s();!(_step389=_iterator389.n()).done;){var _e416=_step389.value;this.listenTo(_e416.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});}}catch(err){_iterator389.e(err);}finally{_iterator389.f();}this._currentElementWithTooltip=e,this._currentTooltipPosition=i;}},{key:"_unpinTooltip",value:function _unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();var _iterator390=_createForOfIteratorHelper(eb._editors),_step390;try{for(_iterator390.s();!(_step390=_iterator390.n()).done;){var _e417=_step390.value;this.stopListening(_e417.ui,"update");}}catch(err){_iterator390.e(err);}finally{_iterator390.f();}this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._mutationObserver.detach();}},{key:"_updateTooltipPosition",value:function _updateTooltipPosition(){if(!this._currentElementWithTooltip)return;var e=ib(this._currentElementWithTooltip);No(this._currentElementWithTooltip)&&e.text?this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:eb.getPositioningFunctions(e.position)}):this._unpinTooltip();}}],[{key:"getPositioningFunctions",value:function getPositioningFunctions(e){var t=eb.defaultBalloonPositions;return{s:[t.southArrowNorth,t.southArrowNorthEast,t.southArrowNorthWest],n:[t.northArrowSouth],e:[t.eastArrowWest],w:[t.westArrowEast],sw:[t.southArrowNorthEast],se:[t.southArrowNorthWest]}[e];}}]);}(go());_defineProperty(eb,"defaultBalloonPositions",Df.generatePositions({heightOffset:5,sideOffset:13}));_defineProperty(eb,"_editors",new Set());_defineProperty(eb,"_instance",null);function tb(e){return Ms(e)?e.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null;}function ib(e){return{text:e.dataset.ckeTooltipText,position:e.dataset.ckeTooltipPosition||"s",cssClass:e.dataset.ckeTooltipClass||""};}var nb=/*#__PURE__*/function(_go5){function nb(e){var _this284;_classCallCheck(this,nb);_this284=_callSuper(this,nb),_defineProperty(_assertThisInitialized(_this284),"editor",void 0),_defineProperty(_assertThisInitialized(_this284),"_balloonView",void 0),_defineProperty(_assertThisInitialized(_this284),"_showBalloonThrottled",void 0),_defineProperty(_assertThisInitialized(_this284),"_lastFocusedEditableElement",void 0),_this284.editor=e,_this284._balloonView=null,_this284._lastFocusedEditableElement=null,_this284._showBalloonThrottled=$s(_this284._showBalloon.bind(_assertThisInitialized(_this284)),50,{leading:!0}),e.on("ready",_this284._handleEditorReady.bind(_assertThisInitialized(_this284)));return _this284;}_inherits(nb,_go5);return _createClass(nb,[{key:"destroy",value:function destroy(){var e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening();}},{key:"_handleEditorReady",value:function _handleEditorReady(){var _this285=this;var e=this.editor;(!!e.config.get("ui.poweredBy.forceVisible")||"VALID"!==Ir(e.config.get("licenseKey")))&&e.ui.view&&(e.ui.focusTracker.on("change:isFocused",function(e,t,i){_this285._updateLastFocusedEditableElement(),i?_this285._showBalloon():_this285._hideBalloon();}),e.ui.focusTracker.on("change:focusedElement",function(e,t,i){_this285._updateLastFocusedEditableElement(),i&&_this285._showBalloon();}),e.ui.on("update",function(){_this285._showBalloonThrottled();}));}},{key:"_createBalloonView",value:function _createBalloonView(){var e=this.editor,t=this._balloonView=new Df(),i=rb(e),n=new sb(e.locale,i.label);t.content.add(n),t.set({"class":"ck-powered-by-balloon"}),e.ui.view.body.add(t),this._balloonView=t;}},{key:"_showBalloon",value:function _showBalloon(){if(!this._lastFocusedEditableElement)return;var e=function(e,t){var i=rb(e),n="right"===i.side?function(e,t){return ob(e,t,function(e,i){return e.left+e.width-i.width-t.horizontalOffset;});}(t,i):function(e,t){return ob(e,t,function(e){return e.left+t.horizontalOffset;});}(t,i);return{target:t,positions:[n]};}(this.editor,this._lastFocusedEditableElement);e&&(this._balloonView||this._createBalloonView(),this._balloonView.pin(e));}},{key:"_hideBalloon",value:function _hideBalloon(){this._balloonView&&this._balloonView.unpin();}},{key:"_updateLastFocusedEditableElement",value:function _updateLastFocusedEditableElement(){var e=this.editor,t=e.ui.focusTracker.isFocused,i=e.ui.focusTracker.focusedElement;if(!t||!i)return void(this._lastFocusedEditableElement=null);var n=Array.from(e.ui.getEditableElementsNames()).map(function(t){return e.ui.getEditableElement(t);});n.includes(i)?this._lastFocusedEditableElement=i:this._lastFocusedEditableElement=n[0];}}]);}(go());var sb=/*#__PURE__*/function(_lg36){function sb(e,t){var _this286;_classCallCheck(this,sb);_this286=_callSuper(this,sb,[e]);var i=new gg(),n=_this286.bindTemplate;i.set({content:'<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>\n',isColorInherited:!1}),i.extendTemplate({attributes:{style:{width:"53px",height:"10px"}}}),_this286.setTemplate({tag:"div",attributes:{"class":["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/powered-by-ckeditor/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[].concat(_toConsumableArray(t?[{tag:"span",attributes:{"class":["ck","ck-powered-by__label"]},children:[t]}]:[]),[i]),on:{dragstart:n.to(function(e){return e.preventDefault();})}}]});return _this286;}_inherits(sb,_lg36);return _createClass(sb);}(lg);function ob(e,t,i){return function(n,s){var o=new Eo(e);if(o.width<350||o.height<50)return null;var r;r="inside"===t.position?o.bottom-s.height:o.bottom-s.height/2,r-=t.verticalOffset;var a=i(o,s),l=n.clone().moveTo(a,r).getIntersection(s.clone().moveTo(a,r)).getVisible();return!l||l.getArea()<s.getArea()?null:{top:r,left:a,name:"position_".concat(t.position,"-side_").concat(t.side),config:{withArrow:!1}};};}function rb(e){var t=e.config.get("ui.poweredBy"),i=t&&t.position||"border";return _objectSpread({position:i,label:"Powered by",verticalOffset:"inside"===i?5:0,horizontalOffset:5,side:"ltr"===e.locale.contentLanguageDirection?"right":"left"},t);}var ab={POLITE:"polite",ASSERTIVE:"assertive"};var lb=/*#__PURE__*/function(){function lb(e){var _this287=this;_classCallCheck(this,lb);_defineProperty(this,"editor",void 0);_defineProperty(this,"view",void 0);this.editor=e,e.once("ready",function(){for(var _i309=0,_Object$values2=Object.values(ab);_i309<_Object$values2.length;_i309++){var _e418=_Object$values2[_i309];_this287.announce("",_e418);}});}return _createClass(lb,[{key:"announce",value:function announce(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:ab.POLITE;var i=this.editor;if(!i.ui.view)return;this.view||(this.view=new cb(i.locale),i.ui.view.body.add(this.view));var _ref87="string"==typeof t?{politeness:t}:t,n=_ref87.politeness,s=_ref87.isUnsafeHTML;var o=this.view.regionViews.find(function(e){return e.politeness===n;});o||(o=new db(i,n),this.view.regionViews.add(o)),o.announce({announcement:e,isUnsafeHTML:s});}}]);}();var cb=/*#__PURE__*/function(_lg37){function cb(e){var _this288;_classCallCheck(this,cb);_this288=_callSuper(this,cb,[e]),_defineProperty(_assertThisInitialized(_this288),"regionViews",void 0),_this288.regionViews=_this288.createCollection(),_this288.setTemplate({tag:"div",attributes:{"class":["ck","ck-aria-live-announcer"]},children:_this288.regionViews});return _this288;}_inherits(cb,_lg37);return _createClass(cb);}(lg);var db=/*#__PURE__*/function(_lg38){function db(e,t){var _this289;_classCallCheck(this,db);_this289=_callSuper(this,db,[e.locale]),_defineProperty(_assertThisInitialized(_this289),"politeness",void 0),_defineProperty(_assertThisInitialized(_this289),"_domConverter",void 0),_defineProperty(_assertThisInitialized(_this289),"_pruneAnnouncementsInterval",void 0),_this289.setTemplate({tag:"div",attributes:{"aria-live":t,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{"class":["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",function(){null!==_this289._pruneAnnouncementsInterval&&(clearInterval(_this289._pruneAnnouncementsInterval),_this289._pruneAnnouncementsInterval=null);}),_this289.politeness=t,_this289._domConverter=e.data.htmlProcessor.domConverter,_this289._pruneAnnouncementsInterval=setInterval(function(){_this289.element&&_this289._listElement.firstChild&&_this289._listElement.firstChild.remove();},5e3);return _this289;}_inherits(db,_lg38);return _createClass(db,[{key:"announce",value:function announce(_ref88){var e=_ref88.announcement,t=_ref88.isUnsafeHTML;if(!e.trim().length)return;var i=document.createElement("li");t?this._domConverter.setContentOf(i,e):i.innerText=e,this._listElement.appendChild(i);}},{key:"_listElement",get:function get(){return this.element.querySelector("ul");}}]);}(lg);var ub=/*#__PURE__*/function(_Pf3){function ub(e,t){var _this290;_classCallCheck(this,ub);_this290=_callSuper(this,ub,[e]);var i=_this290.bindTemplate;_this290.extendTemplate({attributes:{"class":["ck-menu-bar__menu__item"]},on:{mouseenter:i.to("mouseenter")}}),_this290.delegate("mouseenter").to(t);return _this290;}_inherits(ub,_Pf3);return _createClass(ub);}(Pf);var hb={toggleMenusAndFocusItemsOnHover:function toggleMenusAndFocusItemsOnHover(e){e.on("menu:mouseenter",function(t){if(e.isFocusBorderEnabled||e.isOpen){if(e.isOpen){var _iterator391=_createForOfIteratorHelper(e.menus),_step391;try{for(_iterator391.s();!(_step391=_iterator391.n()).done;){var _i310=_step391.value;var _e419=t.path[0],_n161=_e419 instanceof ub&&_e419.children.first===_i310;_i310.isOpen=(t.path.includes(_i310)||_n161)&&_i310.isEnabled;}}catch(err){_iterator391.e(err);}finally{_iterator391.f();}}t.source.focus();}});},focusCycleMenusOnArrows:function focusCycleMenusOnArrows(e){var t="rtl"===e.locale.uiLanguageDirection;function i(t,i){var n=e.children.getIndex(t),s=t.isOpen,o=e.children.length,r=e.children.get((n+o+i)%o);t.isOpen=!1,s&&(r.isOpen=!0),r.buttonView.focus();}e.on("menu:arrowright",function(e){i(e.source,t?-1:1);}),e.on("menu:arrowleft",function(e){i(e.source,t?1:-1);});},closeMenusWhenTheBarCloses:function closeMenusWhenTheBarCloses(e){e.on("change:isOpen",function(){e.isOpen||e.menus.forEach(function(e){e.isOpen=!1;});});},closeMenuWhenAnotherOnTheSameLevelOpens:function closeMenuWhenAnotherOnTheSameLevelOpens(e){e.on("menu:change:isOpen",function(t,i,n){n&&e.menus.filter(function(e){return t.source.parentMenuView===e.parentMenuView&&t.source!==e&&e.isOpen;}).forEach(function(e){e.isOpen=!1;});});},closeOnClickOutside:function closeOnClickOutside(e){cg({emitter:e,activator:function activator(){return e.isOpen;},callback:function callback(){return e.close();},contextElements:function contextElements(){return e.children.map(function(e){return e.element;});}});},enableFocusHighlightOnInteraction:function enableFocusHighlightOnInteraction(e){var t=!1;e.on("change:isOpen",function(i,n,s){s||(t||(e.isFocusBorderEnabled=!1),t=!1);}),e.listenTo(e.element,"keydown",function(){t=!0;},{useCapture:!0}),e.listenTo(e.element,"keyup",function(){t=!1;},{useCapture:!0}),e.listenTo(e.element,"focus",function(){t&&(e.isFocusBorderEnabled=!0);},{useCapture:!0});}},mb={openAndFocusPanelOnArrowDownKey:function openAndFocusPanelOnArrowDownKey(e){e.keystrokes.set("arrowdown",function(t,i){e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),i());});},openOnArrowRightKey:function openOnArrowRightKey(e){var t="rtl"===e.locale.uiLanguageDirection?"arrowleft":"arrowright";e.keystrokes.set(t,function(t,i){e.focusTracker.focusedElement===e.buttonView.element&&e.isEnabled&&(e.isOpen||(e.isOpen=!0),e.panelView.focus(),i());});},openOnButtonClick:function openOnButtonClick(e){e.buttonView.on("execute",function(){e.isOpen=!0;});},toggleOnButtonClick:function toggleOnButtonClick(e){e.buttonView.on("execute",function(){e.isOpen=!e.isOpen;});},openAndFocusOnEnterKeyPress:function openAndFocusOnEnterKeyPress(e){e.keystrokes.set("enter",function(t,i){e.focusTracker.focusedElement===e.buttonView.element&&(e.isOpen=!0,e.panelView.focus(),i());});},closeOnArrowLeftKey:function closeOnArrowLeftKey(e){var t="rtl"===e.locale.uiLanguageDirection?"arrowright":"arrowleft";e.keystrokes.set(t,function(t,i){e.isOpen&&(e.isOpen=!1,e.focus(),i());});},closeOnEscKey:function closeOnEscKey(e){e.keystrokes.set("esc",function(t,i){e.isOpen&&(e.isOpen=!1,e.focus(),i());});},closeOnParentClose:function closeOnParentClose(e){e.parentMenuView.on("change:isOpen",function(t,i,n){n||t.source!==e.parentMenuView||(e.isOpen=!1);});}},gb={southEast:function southEast(e){return{top:e.bottom,left:e.left,name:"se"};},southWest:function southWest(e,t){return{top:e.bottom,left:e.left-t.width+e.width,name:"sw"};},northEast:function northEast(e,t){return{top:e.top-t.height,left:e.left,name:"ne"};},northWest:function northWest(e,t){return{top:e.top-t.height,left:e.left-t.width+e.width,name:"nw"};},eastSouth:function eastSouth(e){return{top:e.top,left:e.right-5,name:"es"};},eastNorth:function eastNorth(e,t){return{top:e.top-t.height,left:e.right-5,name:"en"};},westSouth:function westSouth(e,t){return{top:e.top,left:e.left-t.width+5,name:"ws"};},westNorth:function westNorth(e,t){return{top:e.top-t.height,left:e.left-t.width+5,name:"wn"};}},fb=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"previewMergeFields",items:["menuBar:previewMergeFields"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable"]},{groupId:"insertInline",items:["menuBar:link","menuBar:comment","menuBar:insertMergeField"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:specialCharacters","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function pb(e){var t;return t="items"in e&&e.items?_objectSpread({items:e.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1},e):_objectSpread({items:Un(fb),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0},e),t;}function bb(_ref89){var e=_ref89.normalizedConfig,t=_ref89.locale,i=_ref89.componentFactory,n=_ref89.extraItems;var s=Un(e);return wb(e,s,n),function(e,t){var i=t.removeItems,n=[];t.items=t.items.filter(function(_ref90){var e=_ref90.menuId;return!i.includes(e)||(n.push(e),!1);}),kb(t.items,function(e){e.groups=e.groups.filter(function(_ref91){var e=_ref91.groupId;return!i.includes(e)||(n.push(e),!1);});var _iterator392=_createForOfIteratorHelper(e.groups),_step392;try{for(_iterator392.s();!(_step392=_iterator392.n()).done;){var _t254=_step392.value;_t254.items=_t254.items.filter(function(e){var t=Eb(e);return!i.includes(t)||(n.push(t),!1);});}}catch(err){_iterator392.e(err);}finally{_iterator392.f();}});var _iterator393=_createForOfIteratorHelper(i),_step393;try{for(_iterator393.s();!(_step393=_iterator393.n()).done;){var _t255=_step393.value;n.includes(_t255)||E("menu-bar-item-could-not-be-removed",{menuBarConfig:e,itemName:_t255});}}catch(err){_iterator393.e(err);}finally{_iterator393.f();}}(e,s),wb(e,s,s.addItems),function(e,t,i){kb(t.items,function(n){var _iterator394=_createForOfIteratorHelper(n.groups),_step394;try{for(_iterator394.s();!(_step394=_iterator394.n()).done;){var _s116=_step394.value;_s116.items=_s116.items.filter(function(s){var o="string"==typeof s&&!i.has(s);return o&&!t.isUsingDefaultConfig&&E("menu-bar-item-unavailable",{menuBarConfig:e,parentMenuConfig:Un(n),componentName:s}),!o;});}}catch(err){_iterator394.e(err);}finally{_iterator394.f();}});}(e,s,i),vb(e,s),function(e,t){var i=t.t,n={File:i({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:i({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:i({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:i({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:i({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:i({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:i({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:i({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:i({string:"Font",id:"MENU_BAR_MENU_FONT"})};kb(e.items,function(e){e.label in n&&(e.label=n[e.label]);});}(s,t),s;}function wb(e,t,i){var n=[];if(0!=i.length){var _iterator395=_createForOfIteratorHelper(i),_step395;try{var _loop7=function _loop7(){var e=_step395.value;var i=xb(e.position),o=Ab(e.position);if("object"==_typeof(s=e)&&"menu"in s){if(o){var _s117=t.items.findIndex(function(e){return e.menuId===o;});if(-1!=_s117)"before"===i?(t.items.splice(_s117,0,e.menu),n.push(e)):"after"===i&&(t.items.splice(_s117+1,0,e.menu),n.push(e));else{_b(t,e.menu,o,i)&&n.push(e);}}else"start"===i?(t.items.unshift(e.menu),n.push(e)):"end"===i&&(t.items.push(e.menu),n.push(e));}else if(Cb(e))kb(t.items,function(t){if(t.menuId===o)"start"===i?(t.groups.unshift(e.group),n.push(e)):"end"===i&&(t.groups.push(e.group),n.push(e));else{var _s118=t.groups.findIndex(function(e){return e.groupId===o;});-1!==_s118&&("before"===i?(t.groups.splice(_s118,0,e.group),n.push(e)):"after"===i&&(t.groups.splice(_s118+1,0,e.group),n.push(e)));}});else{_b(t,e.item,o,i)&&n.push(e);}};for(_iterator395.s();!(_step395=_iterator395.n()).done;){_loop7();}}catch(err){_iterator395.e(err);}finally{_iterator395.f();}var s;var _iterator396=_createForOfIteratorHelper(i),_step396;try{for(_iterator396.s();!(_step396=_iterator396.n()).done;){var _t256=_step396.value;n.includes(_t256)||E("menu-bar-item-could-not-be-added",{menuBarConfig:e,addedItemConfig:_t256});}}catch(err){_iterator396.e(err);}finally{_iterator396.f();}}}function _b(e,t,i,n){var s=!1;return kb(e.items,function(e){var _iterator397=_createForOfIteratorHelper(e.groups),_step397;try{for(_iterator397.s();!(_step397=_iterator397.n()).done;){var _step397$value=_step397.value,_o59=_step397$value.groupId,_r34=_step397$value.items;if(s)return;if(_o59===i)"start"===n?(_r34.unshift(t),s=!0):"end"===n&&(_r34.push(t),s=!0);else{var _e420=_r34.findIndex(function(e){return Eb(e)===i;});-1!==_e420&&("before"===n?(_r34.splice(_e420,0,t),s=!0):"after"===n&&(_r34.splice(_e420+1,0,t),s=!0));}}}catch(err){_iterator397.e(err);}finally{_iterator397.f();}}),s;}function vb(e,t){var i=t.isUsingDefaultConfig;var n=!1;t.items=t.items.filter(function(t){return!!t.groups.length||(yb(e,t,i),!1);}),t.items.length?(kb(t.items,function(t){t.groups=t.groups.filter(function(e){return!!e.items.length||(n=!0,!1);});var _iterator398=_createForOfIteratorHelper(t.groups),_step398;try{for(_iterator398.s();!(_step398=_iterator398.n()).done;){var _s119=_step398.value;_s119.items=_s119.items.filter(function(t){return!(Tb(t)&&!t.groups.length)||(yb(e,t,i),n=!0,!1);});}}catch(err){_iterator398.e(err);}finally{_iterator398.f();}}),n&&vb(e,t)):yb(e,e,i);}function yb(e,t,i){i||E("menu-bar-menu-empty",{menuBarConfig:e,emptyMenuConfig:t});}function kb(e,t){if(Array.isArray(e)){var _iterator399=_createForOfIteratorHelper(e),_step399;try{for(_iterator399.s();!(_step399=_iterator399.n()).done;){var _t257=_step399.value;i(_t257);}}catch(err){_iterator399.e(err);}finally{_iterator399.f();}}function i(e){t(e);var _iterator400=_createForOfIteratorHelper(e.groups),_step400;try{for(_iterator400.s();!(_step400=_iterator400.n()).done;){var _t258=_step400.value;var _iterator401=_createForOfIteratorHelper(_t258.items),_step401;try{for(_iterator401.s();!(_step401=_iterator401.n()).done;){var _e421=_step401.value;Tb(_e421)&&i(_e421);}}catch(err){_iterator401.e(err);}finally{_iterator401.f();}}}catch(err){_iterator400.e(err);}finally{_iterator400.f();}}}function Cb(e){return"object"==_typeof(e)&&"group"in e;}function xb(e){return e.startsWith("start")?"start":e.startsWith("end")?"end":e.startsWith("after")?"after":"before";}function Ab(e){var t=e.match(/^[^:]+:(.+)/);return t?t[1]:null;}function Eb(e){return"string"==typeof e?e:e.menuId;}function Tb(e){return"object"==_typeof(e)&&"menuId"in e;}var Pb=/*#__PURE__*/function(_Zs14){function Pb(e){var _this291;_classCallCheck(this,Pb);_this291=_callSuper(this,Pb);_defineProperty(_this291,"editor",void 0);_defineProperty(_this291,"componentFactory",void 0);_defineProperty(_this291,"focusTracker",void 0);_defineProperty(_this291,"tooltipManager",void 0);_defineProperty(_this291,"poweredBy",void 0);_defineProperty(_this291,"ariaLiveAnnouncer",void 0);_defineProperty(_this291,"isReady",!1);_defineProperty(_this291,"_editableElementsMap",new Map());_defineProperty(_this291,"_focusableToolbarDefinitions",[]);_defineProperty(_this291,"_extraMenuBarElements",[]);_defineProperty(_this291,"_lastFocusedForeignElement",null);var t=e.editing.view;_this291.editor=e,_this291.componentFactory=new Qp(e),_this291.focusTracker=new _r(),_this291.tooltipManager=new eb(e),_this291.poweredBy=new nb(e),_this291.ariaLiveAnnouncer=new lb(e),_this291.set("viewportOffset",_this291._readViewportOffsetFromConfig()),_this291.once("ready",function(){_this291._bindBodyCollectionWithFocusTracker(),_this291.isReady=!0;}),_this291.listenTo(t.document,"layoutChanged",_this291.update.bind(_this291)),_this291.listenTo(t,"scrollToTheSelection",_this291._handleScrollToTheSelection.bind(_this291)),_this291._initFocusTracking();return _this291;}_inherits(Pb,_Zs14);return _createClass(Pb,[{key:"element",get:function get(){return null;}},{key:"update",value:function update(){this.fire("update");}},{key:"destroy",value:function destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy();var _iterator402=_createForOfIteratorHelper(this._editableElementsMap.values()),_step402;try{for(_iterator402.s();!(_step402=_iterator402.n()).done;){var _e422=_step402.value;_e422.ckeditorInstance=null,this.editor.keystrokes.stopListening(_e422);}}catch(err){_iterator402.e(err);}finally{_iterator402.f();}this._editableElementsMap=new Map(),this._focusableToolbarDefinitions=[];}},{key:"setEditableElement",value:function setEditableElement(e,t){var _this292=this;this._editableElementsMap.set(e,t),t.ckeditorInstance||(t.ckeditorInstance=this.editor),this.focusTracker.add(t);var i=function i(){_this292.editor.editing.view.getDomRoot(e)||_this292.editor.keystrokes.listenTo(t);};this.isReady?i():this.once("ready",i);}},{key:"removeEditableElement",value:function removeEditableElement(e){var t=this._editableElementsMap.get(e);t&&(this._editableElementsMap["delete"](e),this.editor.keystrokes.stopListening(t),this.focusTracker.remove(t),t.ckeditorInstance=null);}},{key:"getEditableElement",value:function getEditableElement(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"main";return this._editableElementsMap.get(e);}},{key:"getEditableElementsNames",value:function getEditableElementsNames(){return this._editableElementsMap.keys();}},{key:"addToolbar",value:function addToolbar(e){var _this293=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};e.isRendered?(this.focusTracker.add(e),this.editor.keystrokes.listenTo(e.element)):e.once("render",function(){_this293.focusTracker.add(e),_this293.editor.keystrokes.listenTo(e.element);}),this._focusableToolbarDefinitions.push({toolbarView:e,options:t});}},{key:"extendMenuBar",value:function extendMenuBar(e){this._extraMenuBarElements.push(e);}},{key:"_editableElements",get:function get(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap;}},{key:"_initMenuBar",value:function _initMenuBar(e){var _this294=this;var t=e.element;this.focusTracker.add(t),this.editor.keystrokes.listenTo(t);var i=pb(this.editor.config.get("menuBar")||{});e.fillFromConfig(i,this.componentFactory,this._extraMenuBarElements),this.editor.keystrokes.set("Esc",function(e,i){t.contains(_this294.editor.ui.focusTracker.focusedElement)&&(_this294._lastFocusedForeignElement?(_this294._lastFocusedForeignElement.focus(),_this294._lastFocusedForeignElement=null):_this294.editor.editing.view.focus(),i());}),this.editor.keystrokes.set("Alt+F9",function(i,n){t.contains(_this294.editor.ui.focusTracker.focusedElement)||(_this294._saveLastFocusedForeignElement(),e.isFocusBorderEnabled=!0,e.focus(),n());});}},{key:"_readViewportOffsetFromConfig",value:function _readViewportOffsetFromConfig(){var e=this.editor,t=e.config.get("ui.viewportOffset");if(t)return t;var i=e.config.get("toolbar.viewportTopOffset");return i?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:i}):{top:0};}},{key:"_initFocusTracking",value:function _initFocusTracking(){var _this295=this;var e=this.editor;var t;e.keystrokes.set("Alt+F10",function(e,i){_this295._saveLastFocusedForeignElement();var n=_this295._getCurrentFocusedToolbarDefinition();n&&t||(t=_this295._getFocusableCandidateToolbarDefinitions());for(var _e423=0;_e423<t.length;_e423++){var _e424=t.shift();if(t.push(_e424),_e424!==n&&_this295._focusFocusableCandidateToolbar(_e424)){n&&n.options.afterBlur&&n.options.afterBlur();break;}}i();}),e.keystrokes.set("Esc",function(t,i){var n=_this295._getCurrentFocusedToolbarDefinition();n&&(_this295._lastFocusedForeignElement?(_this295._lastFocusedForeignElement.focus(),_this295._lastFocusedForeignElement=null):e.editing.view.focus(),n.options.afterBlur&&n.options.afterBlur(),i());});}},{key:"_saveLastFocusedForeignElement",value:function _saveLastFocusedForeignElement(){var e=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(e)&&!Array.from(this.editor.editing.view.domRoots.values()).includes(e)&&(this._lastFocusedForeignElement=e);}},{key:"_getFocusableCandidateToolbarDefinitions",value:function _getFocusableCandidateToolbarDefinitions(){var e=[];var _iterator403=_createForOfIteratorHelper(this._focusableToolbarDefinitions),_step403;try{for(_iterator403.s();!(_step403=_iterator403.n()).done;){var _t259=_step403.value;var _i311=_t259.toolbarView,_n162=_t259.options;(No(_i311.element)||_n162.beforeFocus)&&e.push(_t259);}}catch(err){_iterator403.e(err);}finally{_iterator403.f();}return e.sort(function(e,t){return Sb(e)-Sb(t);}),e;}},{key:"_getCurrentFocusedToolbarDefinition",value:function _getCurrentFocusedToolbarDefinition(){var _iterator404=_createForOfIteratorHelper(this._focusableToolbarDefinitions),_step404;try{for(_iterator404.s();!(_step404=_iterator404.n()).done;){var _e425=_step404.value;if(_e425.toolbarView.element&&_e425.toolbarView.element.contains(this.focusTracker.focusedElement))return _e425;}}catch(err){_iterator404.e(err);}finally{_iterator404.f();}return null;}},{key:"_focusFocusableCandidateToolbar",value:function _focusFocusableCandidateToolbar(e){var t=e.toolbarView,i=e.options.beforeFocus;return i&&i(),!!No(t.element)&&(t.focus(),!0);}},{key:"_handleScrollToTheSelection",value:function _handleScrollToTheSelection(e,t){var i=_objectSpread({top:0,bottom:0,left:0,right:0},this.viewportOffset);t.viewportOffset.top+=i.top,t.viewportOffset.bottom+=i.bottom,t.viewportOffset.left+=i.left,t.viewportOffset.right+=i.right;}},{key:"_bindBodyCollectionWithFocusTracker",value:function _bindBodyCollectionWithFocusTracker(){var _this296=this;var e=this.view.body;var _iterator405=_createForOfIteratorHelper(e),_step405;try{for(_iterator405.s();!(_step405=_iterator405.n()).done;){var _t260=_step405.value;this.focusTracker.add(_t260.element);}}catch(err){_iterator405.e(err);}finally{_iterator405.f();}e.on("add",function(e,t){_this296.focusTracker.add(t.element);}),e.on("remove",function(e,t){_this296.focusTracker.remove(t.element);});}}]);}(Zs());function Sb(e){var t=e.toolbarView,i=e.options;var n=10;return No(t.element)&&n--,i.isContextual&&n--,n;}var Ib=/*#__PURE__*/function(_lg39){function Ib(e){var _this297;_classCallCheck(this,Ib);_this297=_callSuper(this,Ib,[e]),_defineProperty(_assertThisInitialized(_this297),"body",void 0),_defineProperty(_assertThisInitialized(_this297),"menuBarView",void 0),_this297.body=new Ng(e);return _this297;}_inherits(Ib,_lg39);return _createClass(Ib,[{key:"render",value:function render(){_superPropGet(Ib,"render",this,3)([]),this.body.attachToDom();}},{key:"destroy",value:function destroy(){return this.body.detachFromDom(),_superPropGet(Ib,"destroy",this,3)([]);}}]);}(lg);var Vb=/*#__PURE__*/function(_Ib2){function Vb(e){var _this298;_classCallCheck(this,Vb);_this298=_callSuper(this,Vb,[e]),_defineProperty(_assertThisInitialized(_this298),"top",void 0),_defineProperty(_assertThisInitialized(_this298),"main",void 0),_defineProperty(_assertThisInitialized(_this298),"_voiceLabelView",void 0),_this298.top=_this298.createCollection(),_this298.main=_this298.createCollection(),_this298._voiceLabelView=_this298._createVoiceLabel(),_this298.setTemplate({tag:"div",attributes:{"class":["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":_this298._voiceLabelView.id},children:[_this298._voiceLabelView,{tag:"div",attributes:{"class":["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:_this298.top},{tag:"div",attributes:{"class":["ck","ck-editor__main"],role:"presentation"},children:_this298.main}]});return _this298;}_inherits(Vb,_Ib2);return _createClass(Vb,[{key:"_createVoiceLabel",value:function _createVoiceLabel(){var e=this.t,t=new Og();return t.text=e("Rich Text Editor"),t.extendTemplate({attributes:{"class":"ck-voice-label"}}),t;}}]);}(Ib);var Rb=/*#__PURE__*/function(_lg40){function Rb(e,t,i){var _this299;_classCallCheck(this,Rb);_this299=_callSuper(this,Rb,[e]),_defineProperty(_assertThisInitialized(_this299),"name",null),_defineProperty(_assertThisInitialized(_this299),"_editingView",void 0),_defineProperty(_assertThisInitialized(_this299),"_editableElement",void 0),_defineProperty(_assertThisInitialized(_this299),"_hasExternalElement",void 0),_this299.setTemplate({tag:"div",attributes:{"class":["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),_this299.set("isFocused",!1),_this299._editableElement=i,_this299._hasExternalElement=!!_this299._editableElement,_this299._editingView=t;return _this299;}_inherits(Rb,_lg40);return _createClass(Rb,[{key:"render",value:function render(){var _this300=this;_superPropGet(Rb,"render",this,3)([]),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",function(){return _this300._updateIsFocusedClasses();}),this._updateIsFocusedClasses();}},{key:"destroy",value:function destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),_superPropGet(Rb,"destroy",this,3)([]);}},{key:"hasExternalElement",get:function get(){return this._hasExternalElement;}},{key:"_updateIsFocusedClasses",value:function _updateIsFocusedClasses(){var e=this._editingView;function t(t){e.change(function(i){var n=e.document.getRoot(t.name);i.addClass(t.isFocused?"ck-focused":"ck-blurred",n),i.removeClass(t.isFocused?"ck-blurred":"ck-focused",n);});}e.isRenderingInProgress?function i(n){e.once("change:isRenderingInProgress",function(e,s,o){o?i(n):t(n);});}(this):t(this);}}]);}(lg);var Ob=/*#__PURE__*/function(_Rb2){function Ob(e,t,i){var _this301;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,Ob);_this301=_callSuper(this,Ob,[e,t,i]),_defineProperty(_assertThisInitialized(_this301),"_options",void 0),_this301._options=n,_this301.extendTemplate({attributes:{role:"textbox","class":"ck-editor__editable_inline"}});return _this301;}_inherits(Ob,_Rb2);return _createClass(Ob,[{key:"render",value:function render(){var _this302=this;_superPropGet(Ob,"render",this,3)([]);var e=this._editingView;e.change(function(t){var i=e.document.getRoot(_this302.name);t.setAttribute("aria-label",_this302.getEditableAriaLabel(),i);});}},{key:"getEditableAriaLabel",value:function getEditableAriaLabel(){var e=this.locale.t,t=this._options.label,i=this._editableElement,n=this.name;if("string"==typeof t)return t;if("object"==_typeof(t))return t[n];if("function"==typeof t)return t(this);if(i){var _e426=i.getAttribute("aria-label");if(_e426)return _e426;}return e("Rich Text Editor. Editing area: %0",n);}}]);}(Rb);var Bb=/*#__PURE__*/function(_lg41){function Bb(e){var _this303;_classCallCheck(this,Bb);_this303=_callSuper(this,Bb,[e]);var t=_this303.bindTemplate;_this303.setTemplate({tag:"iframe",attributes:{"class":["ck","ck-reset_all"],sandbox:"allow-same-origin allow-scripts"},on:{load:t.to("loaded")}});return _this303;}_inherits(Bb,_lg41);return _createClass(Bb,[{key:"render",value:function render(){var _this304=this;return new Promise(function(e){return _this304.on("loaded",e),_superPropGet(Bb,"render",_this304,3)([]);});}}]);}(lg);function Mb(e,t){var i=0,n=0;var _iterator406=_createForOfIteratorHelper(t),_step406;try{for(_iterator406.s();!(_step406=_iterator406.n()).done;){var _s120=_step406.value;var _t261=_s120,_o60=_t261.items,_r35=e&&!!_t261.label.match(e);_t261.labelView.highlightText(_r35?e:null);var _iterator407=_createForOfIteratorHelper(_o60),_step407;try{for(_iterator407.s();!(_step407=_iterator407.n()).done;){var _t262=_step407.value;var _i312=_t262.children.first,_n163=_i312.labelView;if(e){var _s121=!!_i312.label.match(e);_n163.highlightText(_s121?e:null),_t262.isVisible=_r35||_s121;}else _t262.isVisible=!0,_n163.highlightText(null);}}catch(err){_iterator407.e(err);}finally{_iterator407.f();}var _a20=_o60.filter(function(e){return e.isVisible;}).length;i+=_t261.items.length,n+=_r35?_t261.items.length:_a20,_t261.isVisible=_r35||!!_a20;}}catch(err){_iterator406.e(err);}finally{_iterator406.f();}return{resultsCount:n,totalItemsCount:i};}var Lb=/*#__PURE__*/function(_qr3){function Lb(){_classCallCheck(this,Lb);return _callSuper(this,Lb,arguments);}_inherits(Lb,_qr3);return _createClass(Lb,[{key:"init",value:function init(){this.on("show:warning",function(e,t){window.alert(t.message);},{priority:"lowest"});}},{key:"showSuccess",value:function showSuccess(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this._showNotification({message:e,type:"success",namespace:t.namespace,title:t.title});}},{key:"showInfo",value:function showInfo(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this._showNotification({message:e,type:"info",namespace:t.namespace,title:t.title});}},{key:"showWarning",value:function showWarning(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};this._showNotification({message:e,type:"warning",namespace:t.namespace,title:t.title});}},{key:"_showNotification",value:function _showNotification(e){var t=e.namespace?"show:".concat(e.type,":").concat(e.namespace):"show:".concat(e.type);this.fire(t,{message:e.message,type:e.type,title:e.title||""});}}],[{key:"pluginName",get:function get(){return"Notification";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(qr);var Fb=/*#__PURE__*/function(_Zs15){function Fb(e,t){var _this305;_classCallCheck(this,Fb);_this305=_callSuper(this,Fb),t&&xt(_assertThisInitialized(_this305),t),e&&_this305.set(e);return _this305;}_inherits(Fb,_Zs15);return _createClass(Fb);}(Zs());var Nb=Oo("px");var Db=/*#__PURE__*/function(_Dr9){function Db(e){var _this306;_classCallCheck(this,Db);_this306=_callSuper(this,Db,[e]),_defineProperty(_assertThisInitialized(_this306),"positionLimiter",void 0),_defineProperty(_assertThisInitialized(_this306),"visibleStack",void 0),_defineProperty(_assertThisInitialized(_this306),"_viewToStack",new Map()),_defineProperty(_assertThisInitialized(_this306),"_idToStack",new Map()),_defineProperty(_assertThisInitialized(_this306),"_view",null),_defineProperty(_assertThisInitialized(_this306),"_rotatorView",null),_defineProperty(_assertThisInitialized(_this306),"_fakePanelsView",null),_this306.positionLimiter=function(){var e=_this306.editor.editing.view,t=e.document.selection.editableElement;return t?e.domConverter.mapViewToDom(t.root):null;},_this306.decorate("getPositionOptions"),_this306.set("visibleView",null),_this306.set("_numberOfStacks",0),_this306.set("_singleViewMode",!1);return _this306;}_inherits(Db,_Dr9);return _createClass(Db,[{key:"destroy",value:function destroy(){_superPropGet(Db,"destroy",this,3)([]),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy();}},{key:"view",get:function get(){return this._view||this._createPanelView(),this._view;}},{key:"hasView",value:function hasView(e){return Array.from(this._viewToStack.keys()).includes(e);}},{key:"add",value:function add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new A("contextualballoon-add-view-exist",[this,e]);var t=e.stackId||"main";if(!this._idToStack.has(t))return this._idToStack.set(t,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(t)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!e.singleViewMode||this.showStack(t));var i=this._idToStack.get(t);e.singleViewMode&&this.showStack(t),i.set(e.view,e),this._viewToStack.set(e.view,i),i===this._visibleStack&&this._showView(e);}},{key:"remove",value:function remove(e){if(!this.hasView(e))throw new A("contextualballoon-remove-view-not-exist",[this,e]);var t=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(1===t.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(t.values())[t.size-2])),1===t.size?(this._idToStack["delete"](this._getStackId(t)),this._numberOfStacks=this._idToStack.size):t["delete"](e),this._viewToStack["delete"](e);}},{key:"updatePosition",value:function updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this.getPositionOptions()),this._fakePanelsView.updatePosition();}},{key:"getPositionOptions",value:function getPositionOptions(){var e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e;}},{key:"showStack",value:function showStack(e){this.visibleStack=e;var t=this._idToStack.get(e);if(!t)throw new A("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==t&&this._showView(Array.from(t.values()).pop());}},{key:"_createPanelView",value:function _createPanelView(){this._view=new Df(this.editor.locale),this.editor.ui.view.body.add(this._view),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView();}},{key:"_visibleStack",get:function get(){return this._viewToStack.get(this.visibleView);}},{key:"_getStackId",value:function _getStackId(e){return Array.from(this._idToStack.entries()).find(function(t){return t[1]===e;})[0];}},{key:"_showNextStack",value:function _showNextStack(){var e=Array.from(this._idToStack.values());var t=e.indexOf(this._visibleStack)+1;e[t]||(t=0),this.showStack(this._getStackId(e[t]));}},{key:"_showPrevStack",value:function _showPrevStack(){var e=Array.from(this._idToStack.values());var t=e.indexOf(this._visibleStack)-1;e[t]||(t=e.length-1),this.showStack(this._getStackId(e[t]));}},{key:"_createRotatorView",value:function _createRotatorView(){var _this307=this;var e=new zb(this.editor.locale),t=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",function(e,t){return!t&&e>1;}),e.on("change:isNavigationVisible",function(){return _this307.updatePosition();},{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",function(e,i){if(i<2)return"";var n=Array.from(_this307._idToStack.values()).indexOf(_this307._visibleStack)+1;return t("%0 of %1",[n,i]);}),e.buttonNextView.on("execute",function(){e.focusTracker.isFocused&&_this307.editor.editing.view.focus(),_this307._showNextStack();}),e.buttonPrevView.on("execute",function(){e.focusTracker.isFocused&&_this307.editor.editing.view.focus(),_this307._showPrevStack();}),e;}},{key:"_createFakePanelsView",value:function _createFakePanelsView(){var e=new Hb(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",function(e,t){return!t&&e>=2?Math.min(e-1,2):0;}),e.listenTo(this.view,"change:top",function(){return e.updatePosition();}),e.listenTo(this.view,"change:left",function(){return e.updatePosition();}),this.editor.ui.view.body.add(e),e;}},{key:"_showView",value:function _showView(_ref92){var e=_ref92.view,_ref92$balloonClassNa=_ref92.balloonClassName,t=_ref92$balloonClassNa===void 0?"":_ref92$balloonClassNa,_ref92$withArrow=_ref92.withArrow,i=_ref92$withArrow===void 0?!0:_ref92$withArrow,_ref92$singleViewMode=_ref92.singleViewMode,n=_ref92$singleViewMode===void 0?!1:_ref92$singleViewMode;this.view["class"]=t,this.view.withArrow=i,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this.getPositionOptions()),this._fakePanelsView.updatePosition(),n&&(this._singleViewMode=!0);}}],[{key:"pluginName",get:function get(){return"ContextualBalloon";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var zb=/*#__PURE__*/function(_lg42){function zb(e){var _this308;_classCallCheck(this,zb);_this308=_callSuper(this,zb,[e]);_defineProperty(_this308,"focusTracker",void 0);_defineProperty(_this308,"buttonPrevView",void 0);_defineProperty(_this308,"buttonNextView",void 0);_defineProperty(_this308,"content",void 0);var t=e.t,i=_this308.bindTemplate;_this308.set("isNavigationVisible",!0),_this308.focusTracker=new _r(),_this308.buttonPrevView=_this308._createButtonView(t("Previous"),vm.previousArrow),_this308.buttonNextView=_this308._createButtonView(t("Next"),vm.nextArrow),_this308.content=_this308.createCollection(),_this308.setTemplate({tag:"div",attributes:{"class":["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{"class":["ck-balloon-rotator__navigation",i.to("isNavigationVisible",function(e){return e?"":"ck-hidden";})]},children:[_this308.buttonPrevView,{tag:"span",attributes:{"class":["ck-balloon-rotator__counter"]},children:[{text:i.to("counter")}]},_this308.buttonNextView]},{tag:"div",attributes:{"class":"ck-balloon-rotator__content"},children:_this308.content}]});return _this308;}_inherits(zb,_lg42);return _createClass(zb,[{key:"render",value:function render(){_superPropGet(zb,"render",this,3)([]),this.focusTracker.add(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(zb,"destroy",this,3)([]),this.focusTracker.destroy();}},{key:"showView",value:function showView(e){this.hideView(),this.content.add(e);}},{key:"hideView",value:function hideView(){this.content.clear();}},{key:"_createButtonView",value:function _createButtonView(e,t){var i=new pg(this.locale);return i.set({label:e,icon:t,tooltip:!0}),i;}}]);}(lg);var Hb=/*#__PURE__*/function(_lg43){function Hb(e,t){var _this309;_classCallCheck(this,Hb);_this309=_callSuper(this,Hb,[e]);_defineProperty(_this309,"content",void 0);_defineProperty(_this309,"_balloonPanelView",void 0);var i=_this309.bindTemplate;_this309.set("top",0),_this309.set("left",0),_this309.set("height",0),_this309.set("width",0),_this309.set("numberOfPanels",0),_this309.content=_this309.createCollection(),_this309._balloonPanelView=t,_this309.setTemplate({tag:"div",attributes:{"class":["ck-fake-panel",i.to("numberOfPanels",function(e){return e?"":"ck-hidden";})],style:{top:i.to("top",Nb),left:i.to("left",Nb),width:i.to("width",Nb),height:i.to("height",Nb)}},children:_this309.content}),_this309.on("change:numberOfPanels",function(e,t,i,n){i>n?_this309._addPanels(i-n):_this309._removePanels(n-i),_this309.updatePosition();});return _this309;}_inherits(Hb,_lg43);return _createClass(Hb,[{key:"_addPanels",value:function _addPanels(e){for(;e--;){var _e427=new lg();_e427.setTemplate({tag:"div"}),this.content.add(_e427),this.registerChild(_e427);}}},{key:"_removePanels",value:function _removePanels(e){for(;e--;){var _e428=this.content.last;this.content.remove(_e428),this.deregisterChild(_e428),_e428.destroy();}}},{key:"updatePosition",value:function updatePosition(){if(this.numberOfPanels){var _this$_balloonPanelVi=this._balloonPanelView,_e429=_this$_balloonPanelVi.top,_t263=_this$_balloonPanelVi.left,_Eo2=new Eo(this._balloonPanelView.element),_i313=_Eo2.width,_n164=_Eo2.height;Object.assign(this,{top:_e429,left:_t263,width:_i313,height:_n164});}}}]);}(lg);var $b=Oo("px");var Ub=/*#__PURE__*/function(_lg44){function Ub(e){var _this310;_classCallCheck(this,Ub);_this310=_callSuper(this,Ub,[e]);_defineProperty(_this310,"content",void 0);_defineProperty(_this310,"contentPanelElement",void 0);_defineProperty(_this310,"_contentPanelPlaceholder",void 0);var t=_this310.bindTemplate;_this310.set("isActive",!1),_this310.set("isSticky",!1),_this310.set("limiterElement",null),_this310.set("limiterBottomOffset",50),_this310.set("viewportTopOffset",0),_this310.set("_marginLeft",null),_this310.set("_isStickyToTheBottomOfLimiter",!1),_this310.set("_stickyTopOffset",null),_this310.set("_stickyBottomOffset",null),_this310.content=_this310.createCollection(),_this310._contentPanelPlaceholder=new Hm({tag:"div",attributes:{"class":["ck","ck-sticky-panel__placeholder"],style:{display:t.to("isSticky",function(e){return e?"block":"none";}),height:t.to("isSticky",function(e){return e?$b(_this310._contentPanelRect.height):null;})}}}).render(),_this310.contentPanelElement=new Hm({tag:"div",attributes:{"class":["ck","ck-sticky-panel__content",t["if"]("isSticky","ck-sticky-panel__content_sticky"),t["if"]("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:t.to("isSticky",function(e){return e?$b(_this310._contentPanelPlaceholder.getBoundingClientRect().width):null;}),top:t.to("_stickyTopOffset",function(e){return e?$b(e):e;}),bottom:t.to("_stickyBottomOffset",function(e){return e?$b(e):e;}),marginLeft:t.to("_marginLeft")}},children:_this310.content}).render(),_this310.setTemplate({tag:"div",attributes:{"class":["ck","ck-sticky-panel"]},children:[_this310._contentPanelPlaceholder,_this310.contentPanelElement]});return _this310;}_inherits(Ub,_lg44);return _createClass(Ub,[{key:"render",value:function render(){var _this311=this;_superPropGet(Ub,"render",this,3)([]),this.checkIfShouldBeSticky(),this.listenTo(i.document,"scroll",function(){_this311.checkIfShouldBeSticky();},{useCapture:!0}),this.listenTo(this,"change:isActive",function(){_this311.checkIfShouldBeSticky();});}},{key:"checkIfShouldBeSticky",value:function checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive)return void this._unstick();var e=new Eo(this.limiterElement);var t=e.getVisible();if(t){var _e430=new Eo(i.window);_e430.top+=this.viewportTopOffset,_e430.height-=this.viewportTopOffset,t=t.getIntersection(_e430);}if(t&&e.top<t.top){var _i314=t.top;if(_i314+this._contentPanelRect.height+this.limiterBottomOffset>t.bottom){var _i315=Math.max(e.bottom-t.bottom,0)+this.limiterBottomOffset;e.bottom-_i315>e.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(_i315):this._unstick();}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(_i314):this._unstick();}else this._unstick();}},{key:"_stickToTopOfAncestors",value:function _stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=$b(-i.window.scrollX);}},{key:"_stickToBottomOfLimiter",value:function _stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=$b(-i.window.scrollX);}},{key:"_unstick",value:function _unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null;}},{key:"_contentPanelRect",get:function get(){return new Eo(this.contentPanelElement);}}]);}(lg);var Wb=/*#__PURE__*/function(_pf2){function Wb(e,t){var _this312;_classCallCheck(this,Wb);var i=e.t,n=Object.assign({},{showResetButton:!0,showIcon:!0,creator:cp},t);_this312=_callSuper(this,Wb,[e,n.creator]),_defineProperty(_assertThisInitialized(_this312),"iconView",void 0),_defineProperty(_assertThisInitialized(_this312),"resetButtonView",void 0),_defineProperty(_assertThisInitialized(_this312),"_viewConfig",void 0),_this312.label=t.label,_this312._viewConfig=n,_this312._viewConfig.showIcon&&(_this312.iconView=new gg(),_this312.iconView.content=vm.loupe,_this312.fieldWrapperChildren.add(_this312.iconView,0),_this312.extendTemplate({attributes:{"class":"ck-search__query_with-icon"}})),_this312._viewConfig.showResetButton&&(_this312.resetButtonView=new pg(e),_this312.resetButtonView.set({label:i("Clear"),icon:vm.cancel,"class":"ck-search__reset",isVisible:!1,tooltip:!0}),_this312.resetButtonView.on("execute",function(){_this312.reset(),_this312.focus(),_this312.fire("reset");}),_this312.resetButtonView.bind("isVisible").to(_this312.fieldView,"isEmpty",function(e){return!e;}),_this312.fieldWrapperChildren.add(_this312.resetButtonView),_this312.extendTemplate({attributes:{"class":"ck-search__query_with-reset"}}));return _this312;}_inherits(Wb,_pf2);return _createClass(Wb,[{key:"reset",value:function reset(){this.fieldView.reset(),this._viewConfig.showResetButton&&(this.resetButtonView.isVisible=!1);}}]);}(pf);var jb=/*#__PURE__*/function(_lg45){function jb(){var _this313;_classCallCheck(this,jb);_this313=_callSuper(this,jb);var e=_this313.bindTemplate;_this313.set({isVisible:!1,primaryText:"",secondaryText:""}),_this313.setTemplate({tag:"div",attributes:{"class":["ck","ck-search__info",e["if"]("isVisible","ck-hidden",function(e){return!e;})],tabindex:-1},children:[{tag:"span",children:[{text:[e.to("primaryText")]}]},{tag:"span",children:[{text:[e.to("secondaryText")]}]}]});return _this313;}_inherits(jb,_lg45);return _createClass(jb,[{key:"focus",value:function focus(){this.element.focus();}}]);}(lg);var qb=/*#__PURE__*/function(_lg46){function qb(e){var _this314;_classCallCheck(this,qb);_this314=_callSuper(this,qb,[e]),_defineProperty(_assertThisInitialized(_this314),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this314),"children",void 0),_defineProperty(_assertThisInitialized(_this314),"_focusCycler",void 0),_this314.children=_this314.createCollection(),_this314.focusTracker=new _r(),_this314.setTemplate({tag:"div",attributes:{"class":["ck","ck-search__results"],tabindex:-1},children:_this314.children}),_this314._focusCycler=new _g({focusables:_this314.children,focusTracker:_this314.focusTracker});return _this314;}_inherits(qb,_lg46);return _createClass(qb,[{key:"render",value:function render(){_superPropGet(qb,"render",this,3)([]);var _iterator408=_createForOfIteratorHelper(this.children),_step408;try{for(_iterator408.s();!(_step408=_iterator408.n()).done;){var _e431=_step408.value;this.focusTracker.add(_e431.element);}}catch(err){_iterator408.e(err);}finally{_iterator408.f();}}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"focusFirst",value:function focusFirst(){this._focusCycler.focusFirst();}},{key:"focusLast",value:function focusLast(){this._focusCycler.focusLast();}}]);}(lg);var Gb=/*#__PURE__*/function(_lg47){function Gb(e,t){var _this315;_classCallCheck(this,Gb);_this315=_callSuper(this,Gb,[e]),_defineProperty(_assertThisInitialized(_this315),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this315),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this315),"resultsView",void 0),_defineProperty(_assertThisInitialized(_this315),"filteredView",void 0),_defineProperty(_assertThisInitialized(_this315),"infoView",void 0),_defineProperty(_assertThisInitialized(_this315),"queryView",void 0),_defineProperty(_assertThisInitialized(_this315),"focusCycler",void 0),_defineProperty(_assertThisInitialized(_this315),"_config",void 0),_this315._config=t,_this315.filteredView=t.filteredView,_this315.queryView=_this315._createSearchTextQueryView(),_this315.focusTracker=new _r(),_this315.keystrokes=new Cr(),_this315.resultsView=new qb(e),_this315.children=_this315.createCollection(),_this315.focusableChildren=_this315.createCollection([_this315.queryView,_this315.resultsView]),_this315.set("isEnabled",!0),_this315.set("resultsCount",0),_this315.set("totalItemsCount",0),t.infoView&&t.infoView.instance?_this315.infoView=t.infoView.instance:(_this315.infoView=new jb(),_this315._enableDefaultInfoViewBehavior(),_this315.on("render",function(){_this315.search("");})),_this315.resultsView.children.addMany([_this315.infoView,_this315.filteredView]),_this315.focusCycler=new _g({focusables:_this315.focusableChildren,focusTracker:_this315.focusTracker,keystrokeHandler:_this315.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this315.on("search",function(e,_ref93){var t=_ref93.resultsCount,i=_ref93.totalItemsCount;_this315.resultsCount=t,_this315.totalItemsCount=i;}),_this315.setTemplate({tag:"div",attributes:{"class":["ck","ck-search",t["class"]||null],tabindex:"-1"},children:_this315.children});return _this315;}_inherits(Gb,_lg47);return _createClass(Gb,[{key:"render",value:function render(){_superPropGet(Gb,"render",this,3)([]),this.children.addMany([this.queryView,this.resultsView]);var e=function(_e432){function e(_x6){return _e432.apply(this,arguments);}e.toString=function(){return _e432.toString();};return e;}(function(e){return e.stopPropagation();});var _iterator409=_createForOfIteratorHelper(this.focusableChildren),_step409;try{for(_iterator409.s();!(_step409=_iterator409.n()).done;){var _e433=_step409.value;this.focusTracker.add(_e433.element);}}catch(err){_iterator409.e(err);}finally{_iterator409.f();}this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e);}},{key:"focus",value:function focus(){this.queryView.focus();}},{key:"reset",value:function reset(){this.queryView.reset(),this.search(""),this.filteredView.element.scrollTo(0,0);}},{key:"search",value:function search(e){var t=e?new RegExp(Rs(e),"ig"):null,i=this.filteredView.filter(t);this.fire("search",_objectSpread({query:e},i));}},{key:"_createSearchTextQueryView",value:function _createSearchTextQueryView(){var _this316=this;var e=new Wb(this.locale,this._config.queryView);return this.listenTo(e.fieldView,"input",function(){_this316.search(e.fieldView.element.value);}),e.on("reset",function(){return _this316.reset();}),e.bind("isEnabled").to(this),e;}},{key:"_enableDefaultInfoViewBehavior",value:function _enableDefaultInfoViewBehavior(){var _this317=this;var e=this.locale.t,t=this.infoView;function i(e,_ref94){var t=_ref94.query,i=_ref94.resultsCount,n=_ref94.totalItemsCount;return"function"==typeof e?e(t,i,n):e;}this.on("search",function(n,s){if(s.resultsCount)t.set({isVisible:!1});else{var _n165=_this317._config.infoView&&_this317._config.infoView.text;var _o61,_r36;s.totalItemsCount?_n165&&_n165.notFound?(_o61=_n165.notFound.primary,_r36=_n165.notFound.secondary):(_o61=e("No results found"),_r36=""):_n165&&_n165.noSearchableItems?(_o61=_n165.noSearchableItems.primary,_r36=_n165.noSearchableItems.secondary):(_o61=e("No searchable items"),_r36=""),t.set({primaryText:i(_o61,s),secondaryText:i(_r36,s),isVisible:!0});}});}}]);}(lg);var Kb=/*#__PURE__*/function(_Gb2){function Kb(e,t){var _this318;_classCallCheck(this,Kb);_this318=_callSuper(this,Kb,[e,t]),_defineProperty(_assertThisInitialized(_this318),"_config",void 0),_assertThisInitialized(_this318),_this318._config=t;var n=Oo("px");_this318.extendTemplate({attributes:{"class":["ck-autocomplete"]}});var s=_this318.resultsView.bindTemplate;_this318.resultsView.set("isVisible",!1),_this318.resultsView.set("_position","s"),_this318.resultsView.set("_width",0),_this318.resultsView.extendTemplate({attributes:{"class":[s["if"]("isVisible","ck-hidden",function(e){return!e;}),s.to("_position",function(e){return"ck-search__results_".concat(e);})],style:{width:s.to("_width",n)}}}),_this318.focusTracker.on("change:isFocused",function(e,i,n){_this318._updateResultsVisibility(),n?_this318.resultsView.element.scrollTop=0:t.resetOnBlur&&_this318.queryView.reset();}),_this318.on("search",function(){_this318._updateResultsVisibility(),_this318._updateResultsViewWidthAndPosition();}),_this318.keystrokes.set("esc",function(e,t){_this318.resultsView.isVisible&&(_this318.queryView.focus(),_this318.resultsView.isVisible=!1,t());}),_this318.listenTo(i.document,"scroll",function(){_this318._updateResultsViewWidthAndPosition();}),_this318.on("change:isEnabled",function(){_this318._updateResultsVisibility();}),_this318.filteredView.on("execute",function(e,_ref95){var t=_ref95.value;_this318.focus(),_this318.reset(),_this318.queryView.fieldView.value=_this318.queryView.fieldView.element.value=t,_this318.resultsView.isVisible=!1;}),_this318.resultsView.on("change:isVisible",function(){_this318._updateResultsViewWidthAndPosition();});return _this318;}_inherits(Kb,_Gb2);return _createClass(Kb,[{key:"_updateResultsViewWidthAndPosition",value:function _updateResultsViewWidthAndPosition(){if(!this.resultsView.isVisible)return;this.resultsView._width=new Eo(this.queryView.fieldView.element).width;var e=Kb._getOptimalPosition({element:this.resultsView.element,target:this.queryView.element,fitInViewport:!0,positions:Kb.defaultResultsPositions});this.resultsView._position=e?e.name:"s";}},{key:"_updateResultsVisibility",value:function _updateResultsVisibility(){var e=void 0===this._config.queryMinChars?0:this._config.queryMinChars,t=this.queryView.fieldView.element.value.length;this.resultsView.isVisible=this.focusTracker.isFocused&&this.isEnabled&&t>=e;}}]);}(Gb);_defineProperty(Kb,"defaultResultsPositions",[function(e){return{top:e.bottom,left:e.left,name:"s"};},function(e,t){return{top:e.top-t.height,left:e.left,name:"n"};}]);_defineProperty(Kb,"_getOptimalPosition",Do);var Zb=/*#__PURE__*/function(_lg48){function Zb(){var _this319;_classCallCheck(this,Zb);_this319=_callSuper(this,Zb),_this319.set("text",void 0),_this319.setTemplate({tag:"span",attributes:{"class":["ck","ck-highlighted-text"]}}),_this319.on("render",function(){_this319.on("change:text",function(){_this319._updateInnerHTML(_this319.text);}),_this319._updateInnerHTML(_this319.text);});return _this319;}_inherits(Zb,_lg48);return _createClass(Zb,[{key:"highlightText",value:function highlightText(e){this._updateInnerHTML(function(e,t){if(!t)return Ss(e);var i=[];var n=0,s=t.exec(e);for(;null!==s;){var _o62=s.index;_o62!==n&&i.push({text:e.substring(n,_o62),isMatch:!1}),i.push({text:s[0],isMatch:!0}),n=t.lastIndex,s=t.exec(e);}n!==e.length&&i.push({text:e.substring(n),isMatch:!1});return i.map(function(e){return e.text=Ss(e.text),e;}).map(function(e){return e.isMatch?"<mark>".concat(e.text,"</mark>"):e.text;}).join("");}(this.text||"",e));}},{key:"_updateInnerHTML",value:function _updateInnerHTML(e){this.element.innerHTML=e||"";}}]);}(lg);var Jb=/*#__PURE__*/function(_Zb){function Jb(){var _this320;_classCallCheck(this,Jb);_this320=_callSuper(this,Jb),_this320.set({style:void 0,text:void 0,id:void 0});var e=_this320.bindTemplate;_this320.extendTemplate({attributes:{"class":["ck-button__label"],style:e.to("style"),id:e.to("id")}});return _this320;}_inherits(Jb,_Zb);return _createClass(Jb);}(Zb);var Qb=/*#__PURE__*/function(_Zb2){function Qb(){var _this321;_classCallCheck(this,Qb);_this321=_callSuper(this,Qb),_defineProperty(_assertThisInitialized(_this321),"id",void 0),_this321.set("for",void 0);var e=_this321.bindTemplate;_this321.id="ck-editor__label_".concat(k()),_this321.extendTemplate({attributes:{"class":["ck","ck-label"],id:_this321.id,"for":e.to("for")}});return _this321;}_inherits(Qb,_Zb2);return _createClass(Qb);}(Zb);var Yb=/*#__PURE__*/function(_lg49){function Yb(){var _this322;_classCallCheck(this,Yb);_this322=_callSuper(this,Yb),_this322.set("isVisible",!1);var e=_this322.bindTemplate;_this322.setTemplate({tag:"span",attributes:{"class":["ck","ck-spinner-container",e["if"]("isVisible","ck-hidden",function(e){return!e;})]},children:[{tag:"span",attributes:{"class":["ck","ck-spinner"]}}]});return _this322;}_inherits(Yb,_lg49);return _createClass(Yb);}(lg);var Xb=Oo("px");var ew=/*#__PURE__*/function(_Dr10){function ew(e){var _this323;_classCallCheck(this,ew);_this323=_callSuper(this,ew,[e]),_defineProperty(_assertThisInitialized(_this323),"toolbarView",void 0),_defineProperty(_assertThisInitialized(_this323),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this323),"_balloonConfig",void 0),_defineProperty(_assertThisInitialized(_this323),"_resizeObserver",null),_defineProperty(_assertThisInitialized(_this323),"_balloon",void 0),_defineProperty(_assertThisInitialized(_this323),"_fireSelectionChangeDebounced",void 0),_this323._balloonConfig=qf(e.config.get("balloonToolbar")),_this323.toolbarView=_this323._createToolbarView(),_this323.focusTracker=new _r(),_this323._trackFocusableEditableElements(),_this323.focusTracker.add(_this323.toolbarView),e.ui.addToolbar(_this323.toolbarView,{beforeFocus:function beforeFocus(){return _this323.show(!0);},afterBlur:function afterBlur(){return _this323.hide();},isContextual:!0}),_this323._balloon=e.plugins.get(Db),_this323._fireSelectionChangeDebounced=vs(function(){return _this323.fire("_selectionChangeDebounced");},200),_this323.decorate("show");return _this323;}_inherits(ew,_Dr10);return _createClass(ew,[{key:"init",value:function init(){var _this324=this;var e=this.editor,t=e.model.document.selection;this.listenTo(this.focusTracker,"change:isFocused",function(e,t,i){var n=_this324._balloon.visibleView===_this324.toolbarView;!i&&n?_this324.hide():i&&_this324.show();}),this.listenTo(t,"change:range",function(e,i){(i.directChange||t.isCollapsed)&&_this324.hide(),_this324._fireSelectionChangeDebounced();}),this.listenTo(this,"_selectionChangeDebounced",function(){_this324.editor.editing.view.document.isFocused&&_this324.show();}),this._balloonConfig.shouldNotGroupWhenFull||this.listenTo(e,"ready",function(){var t=e.ui.view.editable.element;_this324._resizeObserver=new Vo(t,function(e){_this324.toolbarView.maxWidth=Xb(.9*e.contentRect.width);});}),this.listenTo(this.toolbarView,"groupedItemsUpdate",function(){_this324._updatePosition();}),e.ui.once("ready",function(){_this324.toolbarView.fillFromConfig(_this324._balloonConfig,_this324.editor.ui.componentFactory);});}},{key:"_createToolbarView",value:function _createToolbarView(){var e=this.editor.locale.t,t=!this._balloonConfig.shouldNotGroupWhenFull,i=new Kf(this.editor.locale,{shouldGroupWhenFull:t,isFloating:!0});return i.ariaLabel=e("Editor contextual toolbar"),i.render(),i;}},{key:"show",value:function show(){var _this325=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var t=this.editor,i=t.model.document.selection,n=t.model.schema;this._balloon.hasView(this.toolbarView)||i.isCollapsed&&!e||function(e,t){if(1===e.rangeCount)return!1;return _toConsumableArray(e.getRanges()).every(function(e){var i=e.getContainedElement();return i&&t.isSelectable(i);});}(i,n)||Array.from(this.toolbarView.items).every(function(e){return void 0!==e.isEnabled&&!e.isEnabled;})||(this.listenTo(this.editor.ui,"update",function(){_this325._updatePosition();}),this._balloon.add({view:this.toolbarView,position:this._getBalloonPositionData(),balloonClassName:"ck-toolbar-container"}));}},{key:"hide",value:function hide(){this._balloon.hasView(this.toolbarView)&&(this.stopListening(this.editor.ui,"update"),this._balloon.remove(this.toolbarView));}},{key:"_trackFocusableEditableElements",value:function _trackFocusableEditableElements(){var e=this.editor,t=this.focusTracker,i=e.editing;i.view.addObserver(/*#__PURE__*/function(_Al8){function _class9(){_classCallCheck(this,_class9);return _callSuper(this,_class9,arguments);}_inherits(_class9,_Al8);return _createClass(_class9,[{key:"observe",value:function observe(e){t.add(e);}},{key:"stopObserving",value:function stopObserving(e){t.remove(e);}}]);}(Al));}},{key:"_getBalloonPositionData",value:function _getBalloonPositionData(){var e=this.editor.editing.view,t=e.document,i=t.selection,n=t.selection.isBackward;return{target:function target(){var t=n?i.getFirstRange():i.getLastRange(),s=Eo.getDomRangeRects(e.domConverter.viewRangeToDom(t));return n?s[0]:(s.length>1&&0===s[s.length-1].width&&s.pop(),s[s.length-1]);},positions:this._getBalloonPositions(n)};}},{key:"_updatePosition",value:function _updatePosition(){this._balloon.updatePosition(this._getBalloonPositionData());}},{key:"destroy",value:function destroy(){_superPropGet(ew,"destroy",this,3)([]),this.stopListening(),this._fireSelectionChangeDebounced.cancel(),this.toolbarView.destroy(),this.focusTracker.destroy(),this._resizeObserver&&this._resizeObserver.destroy();}},{key:"_getBalloonPositions",value:function _getBalloonPositions(e){var t=o.isSafari&&o.isiOS?Df.generatePositions({heightOffset:Math.max(Df.arrowHeightOffset,Math.round(20/i.window.visualViewport.scale))}):Df.defaultPositions;return e?[t.northWestArrowSouth,t.northWestArrowSouthWest,t.northWestArrowSouthEast,t.northWestArrowSouthMiddleEast,t.northWestArrowSouthMiddleWest,t.southWestArrowNorth,t.southWestArrowNorthWest,t.southWestArrowNorthEast,t.southWestArrowNorthMiddleWest,t.southWestArrowNorthMiddleEast]:[t.southEastArrowNorth,t.southEastArrowNorthEast,t.southEastArrowNorthWest,t.southEastArrowNorthMiddleEast,t.southEastArrowNorthMiddleWest,t.northEastArrowSouth,t.northEastArrowSouthEast,t.northEastArrowSouthWest,t.northEastArrowSouthMiddleEast,t.northEastArrowSouthMiddleWest];}}],[{key:"pluginName",get:function get(){return"BalloonToolbar";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Db];}}]);}(Dr);var tw=Oo("px");var iw=/*#__PURE__*/function(_pg7){function iw(e){var _this326;_classCallCheck(this,iw);_this326=_callSuper(this,iw,[e]);var t=_this326.bindTemplate;_this326.isVisible=!1,_this326.isToggleable=!0,_this326.set("top",0),_this326.set("left",0),_this326.extendTemplate({attributes:{"class":"ck-block-toolbar-button",style:{top:t.to("top",function(e){return tw(e);}),left:t.to("left",function(e){return tw(e);})}}});return _this326;}_inherits(iw,_pg7);return _createClass(iw);}(pg);var nw=Oo("px");var sw=/*#__PURE__*/function(_Dr11){function sw(e){var _this327;_classCallCheck(this,sw);_this327=_callSuper(this,sw,[e]),_defineProperty(_assertThisInitialized(_this327),"toolbarView",void 0),_defineProperty(_assertThisInitialized(_this327),"panelView",void 0),_defineProperty(_assertThisInitialized(_this327),"buttonView",void 0),_defineProperty(_assertThisInitialized(_this327),"_resizeObserver",null),_defineProperty(_assertThisInitialized(_this327),"_blockToolbarConfig",void 0),_this327._blockToolbarConfig=qf(_this327.editor.config.get("blockToolbar")),_this327.toolbarView=_this327._createToolbarView(),_this327.panelView=_this327._createPanelView(),_this327.buttonView=_this327._createButtonView(),cg({emitter:_this327.panelView,contextElements:[_this327.panelView.element,_this327.buttonView.element],activator:function activator(){return _this327.panelView.isVisible;},callback:function callback(){return _this327._hidePanel();}});return _this327;}_inherits(sw,_Dr11);return _createClass(sw,[{key:"init",value:function init(){var _this328=this;var e=this.editor,t=e.t,i=t("Click to edit block"),n=t("Drag to move"),s=t("Edit block"),o=e.plugins.has("DragDropBlockToolbar"),r=o?"".concat(i,"\n").concat(n):s;this.buttonView.label=r,o&&(this.buttonView.element.dataset.ckeTooltipClass="ck-tooltip_multi-line"),this.listenTo(e.model.document.selection,"change:range",function(e,t){t.directChange&&_this328._hidePanel();}),this.listenTo(e.ui,"update",function(){return _this328._updateButton();}),this.listenTo(e,"change:isReadOnly",function(){return _this328._updateButton();},{priority:"low"}),this.listenTo(e.ui.focusTracker,"change:isFocused",function(){return _this328._updateButton();}),this.listenTo(this.buttonView,"change:isVisible",function(e,t,i){i?_this328.buttonView.listenTo(window,"resize",function(){return _this328._updateButton();}):(_this328.buttonView.stopListening(window,"resize"),_this328._hidePanel());}),this._repositionButtonOnScroll(),e.ui.addToolbar(this.toolbarView,{beforeFocus:function beforeFocus(){return _this328._showPanel();},afterBlur:function afterBlur(){return _this328._hidePanel();}}),e.ui.once("ready",function(){_this328.toolbarView.fillFromConfig(_this328._blockToolbarConfig,_this328.editor.ui.componentFactory);var _iterator410=_createForOfIteratorHelper(_this328.toolbarView.items),_step410;try{for(_iterator410.s();!(_step410=_iterator410.n()).done;){var _e434=_step410.value;_e434.on("execute",function(){return _this328._hidePanel(!0);},{priority:"high"});}}catch(err){_iterator410.e(err);}finally{_iterator410.f();}});}},{key:"destroy",value:function destroy(){_superPropGet(sw,"destroy",this,3)([]),this.panelView.destroy(),this.buttonView.destroy(),this.toolbarView.destroy(),this._resizeObserver&&this._resizeObserver.destroy();}},{key:"_createToolbarView",value:function _createToolbarView(){var e=this.editor.locale.t,t=!this._blockToolbarConfig.shouldNotGroupWhenFull,i=new Kf(this.editor.locale,{shouldGroupWhenFull:t,isFloating:!0});return i.ariaLabel=e("Editor block content toolbar"),i;}},{key:"_createPanelView",value:function _createPanelView(){var _this329=this;var e=this.editor,t=new Df(e.locale);return t.content.add(this.toolbarView),t["class"]="ck-toolbar-container",e.ui.view.body.add(t),this.toolbarView.keystrokes.set("Esc",function(e,t){_this329._hidePanel(!0),t();}),t;}},{key:"_createButtonView",value:function _createButtonView(){var _this330=this;var e=this.editor,t=e.t,i=new iw(e.locale),n=this._blockToolbarConfig.icon,s=Gf[n]||n||Gf.dragIndicator;return i.set({label:t("Edit block"),icon:s,withText:!1}),i.bind("isOn").to(this.panelView,"isVisible"),i.bind("tooltip").to(this.panelView,"isVisible",function(e){return!e;}),this.listenTo(i,"execute",function(){_this330.panelView.isVisible?_this330._hidePanel(!0):_this330._showPanel();}),this.listenTo(i,"change:isEnabled",function(e,t,i){!i&&_this330.panelView.isVisible&&_this330._hidePanel(!1);}),e.ui.view.body.add(i),i;}},{key:"_updateButton",value:function _updateButton(){var e=this.editor,t=e.model,i=e.editing.view;if(!e.ui.focusTracker.isFocused)return void this._hideButton();if(!e.model.canEditAt(e.model.document.selection))return void this._hideButton();var n=Array.from(t.document.selection.getSelectedBlocks())[0];if(!n||Array.from(this.toolbarView.items).every(function(e){return!e.isEnabled;}))return void this._hideButton();var s=i.domConverter.mapViewToDom(e.editing.mapper.toViewElement(n));this.buttonView.isVisible=!0,this._setupToolbarResize(),this._attachButtonToElement(s),this.panelView.isVisible&&this._showPanel();}},{key:"_hideButton",value:function _hideButton(){this.buttonView.isVisible=!1;}},{key:"_showPanel",value:function _showPanel(){if(!this.buttonView.isVisible)return;var e=this.panelView.isVisible;this.panelView.show();var t=this._getSelectedEditableElement();this.toolbarView.maxWidth=this._getToolbarMaxWidth(t),this.panelView.pin({target:this.buttonView.element,limiter:t}),e||this.toolbarView.items.get(0).focus();}},{key:"_getSelectedEditableElement",value:function _getSelectedEditableElement(){var e=this.editor.model.document.selection.getFirstRange().root.rootName;return this.editor.ui.getEditableElement(e);}},{key:"_hidePanel",value:function _hidePanel(e){this.panelView.isVisible=!1,e&&this.editor.editing.view.focus();}},{key:"_repositionButtonOnScroll",value:function _repositionButtonOnScroll(){var _this331=this;var e=this.buttonView;var t=!1;var n=function n(e,_n166){if(t)return;var s=_this331._getSelectedEditableElement();(_n166.target===i.document||wo(s).includes(_n166.target))&&(t=!0,i.window.requestAnimationFrame(function(){_this331._updateButton(),t=!1;}));};e.on("change:isVisible",function(t,s,o){o?e.listenTo(i.document,"scroll",n,{useCapture:!0,usePassive:!0}):e.stopListening(i.document,"scroll",n);});}},{key:"_attachButtonToElement",value:function _attachButtonToElement(e){var t=this.buttonView.element,i=this._getSelectedEditableElement(),n=window.getComputedStyle(e),s=new Eo(i),o=parseInt(n.paddingTop,10),r=parseInt(n.lineHeight,10)||1.2*parseInt(n.fontSize,10),a=new Eo(t),l=new Eo(e);var c;c="ltr"===this.editor.locale.uiLanguageDirection?s.left-a.width:s.right;var d=l.top+o+(r-a.height)/2;a.moveTo(c,d);var u=a.toAbsoluteRect();this.buttonView.top=u.top,this.buttonView.left=u.left,this._clipButtonToViewport(this.buttonView,i);}},{key:"_clipButtonToViewport",value:function _clipButtonToViewport(e,t){var i=new Eo(e.element),n=new Eo(t).getVisible(),s=function s(){for(var _len51=arguments.length,t=new Array(_len51),_key51=0;_key51<_len51;_key51++){t[_key51]=arguments[_key51];}e.element.style.clipPath=t.length?"polygon(".concat(t.join(","),")"):"";},o=function o(t){e.isEnabled=!t,e.element.style.pointerEvents=t?"none":"";};if(n&&n.bottom<i.bottom){var _e435=Math.min(i.height,i.bottom-n.bottom);o(_e435>=i.height),s("0 0","100% 0","100% calc(100% - ".concat(nw(_e435),")"),"0 calc(100% - ".concat(nw(_e435)));}else if(n&&n.top>i.top){var _e436=Math.min(i.height,n.top-i.top);o(_e436>=i.height),s("0 ".concat(nw(_e436)),"100% ".concat(nw(_e436)),"100% 100%","0 100%");}else o(!1),s();}},{key:"_setupToolbarResize",value:function _setupToolbarResize(){var _this332=this;var e=this._getSelectedEditableElement();this._blockToolbarConfig.shouldNotGroupWhenFull||(this._resizeObserver&&this._resizeObserver.element!==e&&(this._resizeObserver.destroy(),this._resizeObserver=null),this._resizeObserver||(this._resizeObserver=new Vo(e,function(){_this332.toolbarView.maxWidth=_this332._getToolbarMaxWidth(e);})));}},{key:"_getToolbarMaxWidth",value:function _getToolbarMaxWidth(e){var t=new Eo(e),i=new Eo(this.buttonView.element),n="rtl"===this.editor.locale.uiLanguageDirection?i.left-t.right+i.width:t.left-i.left;return nw(t.width+n);}}],[{key:"pluginName",get:function get(){return"BlockToolbar";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ow=/*#__PURE__*/function(_Ig4){function ow(e){var _this333;_classCallCheck(this,ow);_this333=_callSuper(this,ow,[e]);_defineProperty(_this333,"arrowView",void 0);var t=_this333.bindTemplate;_this333.set({withText:!0,role:"menuitem"}),_this333.arrowView=_this333._createArrowView(),_this333.extendTemplate({attributes:{"class":["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":_this333.bindTemplate.to("isOn",function(e){return String(e);}),"data-cke-tooltip-disabled":t.to("isOn")},on:{mouseenter:t.to("mouseenter")}});return _this333;}_inherits(ow,_Ig4);return _createClass(ow,[{key:"render",value:function render(){_superPropGet(ow,"render",this,3)([]),this.children.add(this.arrowView);}},{key:"_createArrowView",value:function _createArrowView(){var e=new gg();return e.content=Wg,e.extendTemplate({attributes:{"class":"ck-menu-bar__menu__button__arrow"}}),e;}}]);}(Ig);var rw=/*#__PURE__*/function(_lg50){function rw(e){var _this334;_classCallCheck(this,rw);_this334=_callSuper(this,rw,[e]);_defineProperty(_this334,"children",void 0);var t=_this334.bindTemplate;_this334.set("isVisible",!1),_this334.set("position","se"),_this334.children=_this334.createCollection(),_this334.setTemplate({tag:"div",attributes:{"class":["ck","ck-reset","ck-menu-bar__menu__panel",t.to("position",function(e){return"ck-menu-bar__menu__panel_position_".concat(e);}),t["if"]("isVisible","ck-hidden",function(e){return!e;})],tabindex:"-1"},children:_this334.children,on:{selectstart:t.to(function(e){"input"!==e.target.tagName.toLocaleLowerCase()&&e.preventDefault();})}});return _this334;}_inherits(rw,_lg50);return _createClass(rw,[{key:"focus",value:function focus(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;this.children.length&&(1===e?this.children.first.focus():this.children.last.focus());}}]);}(lg);var aw=/*#__PURE__*/function(_lg51){function aw(e){var _this335;_classCallCheck(this,aw);_this335=_callSuper(this,aw,[e]);_defineProperty(_this335,"buttonView",void 0);_defineProperty(_this335,"panelView",void 0);_defineProperty(_this335,"focusTracker",void 0);_defineProperty(_this335,"keystrokes",void 0);var t=_this335.bindTemplate;_this335.buttonView=new ow(e),_this335.buttonView.delegate("mouseenter").to(_this335),_this335.buttonView.bind("isOn","isEnabled").to(_this335,"isOpen","isEnabled"),_this335.panelView=new rw(e),_this335.panelView.bind("isVisible").to(_this335,"isOpen"),_this335.keystrokes=new Cr(),_this335.focusTracker=new _r(),_this335.set("isOpen",!1),_this335.set("isEnabled",!0),_this335.set("panelPosition","w"),_this335.set("class",void 0),_this335.set("parentMenuView",null),_this335.setTemplate({tag:"div",attributes:{"class":["ck","ck-menu-bar__menu",t.to("class"),t["if"]("isEnabled","ck-disabled",function(e){return!e;}),t["if"]("parentMenuView","ck-menu-bar__menu_top-level",function(e){return!e;})]},children:[_this335.buttonView,_this335.panelView]});return _this335;}_inherits(aw,_lg51);return _createClass(aw,[{key:"render",value:function render(){_superPropGet(aw,"render",this,3)([]),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),mb.closeOnEscKey(this),this._repositionPanelOnOpen();}},{key:"_attachBehaviors",value:function _attachBehaviors(){this.parentMenuView?(mb.openOnButtonClick(this),mb.openOnArrowRightKey(this),mb.closeOnArrowLeftKey(this),mb.openAndFocusOnEnterKeyPress(this),mb.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),mb.openAndFocusPanelOnArrowDownKey(this),mb.toggleOnButtonClick(this));}},{key:"_propagateArrowKeystrokeEvents",value:function _propagateArrowKeystrokeEvents(){var _this336=this;this.keystrokes.set("arrowright",function(e,t){_this336.fire("arrowright"),t();}),this.keystrokes.set("arrowleft",function(e,t){_this336.fire("arrowleft"),t();});}},{key:"_repositionPanelOnOpen",value:function _repositionPanelOnOpen(){var _this337=this;this.on("change:isOpen",function(e,t,i){if(!i)return;var n=aw._getOptimalPosition({element:_this337.panelView.element,target:_this337.buttonView.element,fitInViewport:!0,positions:_this337._panelPositions});_this337.panelView.position=n?n.name:_this337._panelPositions[0].name;});}},{key:"focus",value:function focus(){this.buttonView.focus();}},{key:"_panelPositions",get:function get(){var e=gb.southEast,t=gb.southWest,i=gb.northEast,n=gb.northWest,s=gb.westSouth,o=gb.eastSouth,r=gb.westNorth,a=gb.eastNorth;return"ltr"===this.locale.uiLanguageDirection?this.parentMenuView?[o,a,s,r]:[e,t,i,n]:this.parentMenuView?[s,r,o,a]:[t,e,n,i];}}]);}(lg);_defineProperty(aw,"_getOptimalPosition",Do);var lw=/*#__PURE__*/function(_Vf3){function lw(e){var _this338;_classCallCheck(this,lw);_this338=_callSuper(this,lw,[e]),_this338.role="menu",_this338.items.on("change",_this338._setItemsCheckSpace.bind(_assertThisInitialized(_this338)));return _this338;}_inherits(lw,_Vf3);return _createClass(lw,[{key:"_setItemsCheckSpace",value:function _setItemsCheckSpace(){var e=Array.from(this.items).some(function(e){var t=cw(e);return t&&t.isToggleable;});this.items.forEach(function(t){var i=cw(t);i&&(i.hasCheckSpace=e);});}}]);}(Vf);function cw(e){return e instanceof Pf?e.children.map(function(e){return function(e){return"object"==_typeof(e)&&"buttonView"in e&&e.buttonView instanceof pg;}(e)?e.buttonView:e;}).find(function(e){return e instanceof Ig;}):null;}var dw=/*#__PURE__*/function(_Hg){function dw(e){var _this339;_classCallCheck(this,dw);_this339=_callSuper(this,dw,[e]),_this339.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),_this339.extendTemplate({attributes:{"class":["ck-menu-bar__menu__item__button"]}});return _this339;}_inherits(dw,_Hg);return _createClass(dw);}(Hg);var uw=["mouseenter","arrowleft","arrowright","change:isOpen"];var hw=/*#__PURE__*/function(_lg52){function hw(e){var _this340;_classCallCheck(this,hw);_this340=_callSuper(this,hw,[e]);_defineProperty(_this340,"children",void 0);_defineProperty(_this340,"menus",[]);var t=e.t,i=_this340.bindTemplate;_this340.set({isOpen:!1,isFocusBorderEnabled:!1}),_this340._setupIsOpenUpdater(),_this340.children=_this340.createCollection(),_this340.setTemplate({tag:"div",attributes:{"class":["ck","ck-menu-bar",i["if"]("isFocusBorderEnabled","ck-menu-bar_focus-border-enabled")],"aria-label":t("Editor menu bar"),role:"menubar"},children:_this340.children});return _this340;}_inherits(hw,_lg52);return _createClass(hw,[{key:"fillFromConfig",value:function fillFromConfig(e,t){var _this341=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var n=bb({normalizedConfig:e,locale:this.locale,componentFactory:t,extraItems:i}).items.map(function(e){return _this341._createMenu({componentFactory:t,menuDefinition:e});});this.children.addMany(n);}},{key:"render",value:function render(){_superPropGet(hw,"render",this,3)([]),hb.toggleMenusAndFocusItemsOnHover(this),hb.closeMenusWhenTheBarCloses(this),hb.closeMenuWhenAnotherOnTheSameLevelOpens(this),hb.focusCycleMenusOnArrows(this),hb.closeOnClickOutside(this),hb.enableFocusHighlightOnInteraction(this);}},{key:"focus",value:function focus(){this.children.first&&this.children.first.focus();}},{key:"close",value:function close(){var _iterator411=_createForOfIteratorHelper(this.children),_step411;try{for(_iterator411.s();!(_step411=_iterator411.n()).done;){var _e437=_step411.value;_e437.isOpen=!1;}}catch(err){_iterator411.e(err);}finally{_iterator411.f();}}},{key:"registerMenu",value:function registerMenu(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;t?(e.delegate.apply(e,uw).to(t),e.parentMenuView=t):e.delegate.apply(e,uw).to(this,function(e){return"menu:"+e;}),e._attachBehaviors(),this.menus.push(e);}},{key:"_createMenu",value:function _createMenu(_ref96){var _this342=this;var e=_ref96.componentFactory,t=_ref96.menuDefinition,i=_ref96.parentMenuView;var n=this.locale,s=new aw(n);return this.registerMenu(s,i),s.buttonView.set({label:t.label}),s.once("change:isOpen",function(){var i=new lw(n);i.ariaLabel=t.label,s.panelView.children.add(i),i.items.addMany(_this342._createMenuItems({menuDefinition:t,parentMenuView:s,componentFactory:e}));}),s;}},{key:"_createMenuItems",value:function _createMenuItems(_ref97){var e=_ref97.menuDefinition,t=_ref97.parentMenuView,i=_ref97.componentFactory;var n=this.locale,s=[];var _iterator412=_createForOfIteratorHelper(e.groups),_step412;try{for(_iterator412.s();!(_step412=_iterator412.n()).done;){var _o63=_step412.value;var _iterator413=_createForOfIteratorHelper(_o63.items),_step413;try{for(_iterator413.s();!(_step413=_iterator413.n()).done;){var _e438=_step413.value;var _o64=new ub(n,t);if(ue(_e438))_o64.children.add(this._createMenu({componentFactory:i,menuDefinition:_e438,parentMenuView:t}));else{var _n167=this._createMenuItemContentFromFactory({componentName:_e438,componentFactory:i,parentMenuView:t});if(!_n167)continue;_o64.children.add(_n167);}s.push(_o64);}}catch(err){_iterator413.e(err);}finally{_iterator413.f();}_o63!==e.groups[e.groups.length-1]&&s.push(new Sf(n));}}catch(err){_iterator412.e(err);}finally{_iterator412.f();}return s;}},{key:"_createMenuItemContentFromFactory",value:function _createMenuItemContentFromFactory(_ref98){var _this343=this;var e=_ref98.componentName,t=_ref98.parentMenuView,i=_ref98.componentFactory;var n=i.create(e);return n instanceof aw||n instanceof Rg||n instanceof dw?(this._registerMenuTree(n,t),n.on("execute",function(){_this343.close();}),n):(E("menu-bar-component-unsupported",{componentName:e,componentView:n}),null);}},{key:"_registerMenuTree",value:function _registerMenuTree(e,t){if(!(e instanceof aw))return void e.delegate("mouseenter").to(t);this.registerMenu(e,t);var i=e.panelView.children.filter(function(e){return e instanceof lw;})[0];if(!i)return void e.delegate("mouseenter").to(t);var n=i.items.filter(function(e){return e instanceof Pf;});var _iterator414=_createForOfIteratorHelper(n),_step414;try{for(_iterator414.s();!(_step414=_iterator414.n()).done;){var _t264=_step414.value;this._registerMenuTree(_t264.children.get(0),e);}}catch(err){_iterator414.e(err);}finally{_iterator414.f();}}},{key:"_setupIsOpenUpdater",value:function _setupIsOpenUpdater(){var _this344=this;var e;this.on("menu:change:isOpen",function(t,i,n){clearTimeout(e),n?_this344.isOpen=!0:e=setTimeout(function(){_this344.isOpen=Array.from(_this344.children).some(function(e){return e.isOpen;});},0);});}}]);}(lg);var mw=function(){return new Map([["left",vm.alignLeft],["right",vm.alignRight],["center",vm.alignCenter],["justify",vm.alignJustify]]);}();var gw=/*#__PURE__*/function(_Dr12){function gw(){_classCallCheck(this,gw);return _callSuper(this,gw,arguments);}_inherits(gw,_Dr12);return _createClass(gw,[{key:"localizedOptionTitles",get:function get(){var e=this.editor.t;return{left:e("Align left"),right:e("Align right"),center:e("Align center"),justify:e("Justify")};}},{key:"init",value:function init(){var _this345=this;var e=Lm(this.editor.config.get("alignment.options"));e.map(function(e){return e.name;}).filter(Bm).forEach(function(e){return _this345._addButton(e);}),this._addToolbarDropdown(e),this._addMenuBarMenu(e);}},{key:"_addButton",value:function _addButton(e){var _this346=this;this.editor.ui.componentFactory.add("alignment:".concat(e),function(t){return _this346._createButton(t,e);});}},{key:"_createButton",value:function _createButton(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=this.editor,s=n.commands.get("alignment"),o=new pg(e);return o.set(_objectSpread({label:this.localizedOptionTitles[t],icon:mw.get(t),tooltip:!0,isToggleable:!0},i)),o.bind("isEnabled").to(s),o.bind("isOn").to(s,"value",function(e){return e===t;}),this.listenTo(o,"execute",function(){n.execute("alignment",{value:t}),n.editing.view.focus();}),o;}},{key:"_addToolbarDropdown",value:function _addToolbarDropdown(e){var _this347=this;var t=this.editor;t.ui.componentFactory.add("alignment",function(i){var n=Xf(i),s="rtl"===i.uiLanguageDirection?"w":"e",o=i.t;ip(n,function(){return e.map(function(e){return _this347._createButton(i,e.name,{tooltipPosition:s});});},{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:o("Text alignment toolbar")}),n.buttonView.set({label:o("Text alignment"),tooltip:!0}),n.extendTemplate({attributes:{"class":"ck-alignment-dropdown"}});var r="rtl"===i.contentLanguageDirection?mw.get("right"):mw.get("left"),a=t.commands.get("alignment");return n.buttonView.bind("icon").to(a,"value",function(e){return mw.get(e)||r;}),n.bind("isEnabled").to(a,"isEnabled"),_this347.listenTo(n,"execute",function(){t.editing.view.focus();}),n;});}},{key:"_addMenuBarMenu",value:function _addMenuBarMenu(e){var _this348=this;var t=this.editor;t.ui.componentFactory.add("menuBar:alignment",function(i){var n=t.commands.get("alignment"),s=i.t,o=new aw(i),r=new lw(i);o.bind("isEnabled").to(n),r.set({ariaLabel:s("Text alignment"),role:"menu"}),o.buttonView.set({label:s("Text alignment")});var _iterator415=_createForOfIteratorHelper(e),_step415;try{var _loop8=function _loop8(){var s=_step415.value;var e=new ub(i,o),a=new Rg(i);a.delegate("execute").to(o),a.set({label:_this348.localizedOptionTitles[s.name],icon:mw.get(s.name),role:"menuitemcheckbox",isToggleable:!0}),a.on("execute",function(){t.execute("alignment",{value:s.name}),t.editing.view.focus();}),a.bind("isOn").to(n,"value",function(e){return e===s.name;}),a.bind("isEnabled").to(n,"isEnabled"),e.children.add(a),r.items.add(e);};for(_iterator415.s();!(_step415=_iterator415.n()).done;){_loop8();}}catch(err){_iterator415.e(err);}finally{_iterator415.f();}return o.panelView.children.add(r),o;});}}],[{key:"pluginName",get:function get(){return"AlignmentUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var fw=/*#__PURE__*/function(_Dr13){function fw(){_classCallCheck(this,fw);return _callSuper(this,fw,arguments);}_inherits(fw,_Dr13);return _createClass(fw,null,[{key:"requires",get:function get(){return[Dm,gw];}},{key:"pluginName",get:function get(){return"Alignment";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pw=/*#__PURE__*/function(){function pw(e){var _this349=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:20;_classCallCheck(this,pw);_defineProperty(this,"model",void 0);_defineProperty(this,"limit",void 0);_defineProperty(this,"_isLocked",void 0);_defineProperty(this,"_size",void 0);_defineProperty(this,"_batch",null);_defineProperty(this,"_changeCallback",void 0);_defineProperty(this,"_selectionChangeCallback",void 0);this.model=e,this._size=0,this.limit=t,this._isLocked=!1,this._changeCallback=function(e,t){t.isLocal&&t.isUndoable&&t!==_this349._batch&&_this349._reset(!0);},this._selectionChangeCallback=function(){_this349._reset();},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback);}return _createClass(pw,[{key:"batch",get:function get(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch;}},{key:"size",get:function get(){return this._size;}},{key:"input",value:function input(e){this._size+=e,this._size>=this.limit&&this._reset(!0);}},{key:"isLocked",get:function get(){return this._isLocked;}},{key:"lock",value:function lock(){this._isLocked=!0;}},{key:"unlock",value:function unlock(){this._isLocked=!1;}},{key:"destroy",value:function destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback);}},{key:"_reset",value:function _reset(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.isLocked&&!e||(this._batch=null,this._size=0);}}]);}();var bw=/*#__PURE__*/function(_Hr4){function bw(e,t){var _this350;_classCallCheck(this,bw);_this350=_callSuper(this,bw,[e]),_defineProperty(_assertThisInitialized(_this350),"_buffer",void 0),_this350._buffer=new pw(e.model,t),_this350._isEnabledBasedOnSelection=!1;return _this350;}_inherits(bw,_Hr4);return _createClass(bw,[{key:"buffer",get:function get(){return this._buffer;}},{key:"destroy",value:function destroy(){_superPropGet(bw,"destroy",this,3)([]),this._buffer.destroy();}},{key:"execute",value:function execute(){var _this351=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document,n=e.text||"",s=n.length;var o=i.selection;if(e.selection?o=e.selection:e.range&&(o=t.createSelection(e.range)),!t.canEditAt(o))return;var r=e.resultRange;t.enqueueChange(this._buffer.batch,function(e){_this351._buffer.lock();var a=Array.from(i.selection.getAttributes());t.deleteContent(o),n&&t.insertContent(e.createText(n,a),o),r?e.setSelection(r):o.is("documentSelection")||e.setSelection(o),_this351._buffer.unlock(),_this351._buffer.input(s);});}}]);}(Hr);var ww=["insertText","insertReplacementText"],_w=[].concat(ww,["insertCompositionText"]);var vw=/*#__PURE__*/function(_Al9){function vw(e){var _this352;_classCallCheck(this,vw);_this352=_callSuper(this,vw,[e]),_defineProperty(_assertThisInitialized(_this352),"focusObserver",void 0),_this352.focusObserver=e.getObserver(Rl);var t=o.isAndroid?_w:ww,i=e.document;i.on("beforeinput",function(n,s){if(!_this352.isEnabled)return;var o=s.data,r=s.targetRanges,a=s.inputType,l=s.domEvent;if(!t.includes(a))return;_this352.focusObserver.flush();var c=new v(i,"insertText");i.fire(c,new El(e,l,{text:o,selection:e.createSelection(r)})),c.stop.called&&n.stop();}),o.isAndroid||i.on("compositionend",function(t,_ref99){var n=_ref99.data,s=_ref99.domEvent;_this352.isEnabled&&n&&i.fire("insertText",new El(e,s,{text:n}));},{priority:"lowest"});return _this352;}_inherits(vw,_Al9);return _createClass(vw,[{key:"observe",value:function observe(){}},{key:"stopObserving",value:function stopObserving(){}}]);}(Al);var yw=/*#__PURE__*/function(_Dr14){function yw(){var _this353;_classCallCheck(this,yw);for(var _len52=arguments.length,args=new Array(_len52),_key52=0;_key52<_len52;_key52++){args[_key52]=arguments[_key52];}_this353=_callSuper(this,yw,[].concat(args));_defineProperty(_this353,"_compositionQueue",void 0);return _this353;}_inherits(yw,_Dr14);return _createClass(yw,[{key:"init",value:function init(){var _this354=this;var e=this.editor,t=e.model,i=e.editing.view,n=e.editing.mapper,s=t.document.selection;this._compositionQueue=new kw(e),i.addObserver(vw);var r=new bw(e,e.config.get("typing.undoStep")||20);e.commands.add("insertText",r),e.commands.add("input",r),this.listenTo(i.document,"insertText",function(r,a){i.document.isComposing||a.preventDefault(),o.isAndroid&&i.document.isComposing&&_this354._compositionQueue.flush("next beforeinput");var l=a.text,c=a.selection;var d;d=c?Array.from(c.getRanges()).map(function(e){return n.toModelRange(e);}):Array.from(s.getRanges());var u=l;if(o.isAndroid){var _e439=Array.from(d[0].getItems()).reduce(function(e,t){return e+(t.is("$textProxy")?t.data:"");},"");if(_e439&&(_e439.length<=u.length?u.startsWith(_e439)&&(u=u.substring(_e439.length),d[0].start=d[0].start.getShiftedBy(_e439.length)):_e439.startsWith(u)&&(d[0].start=d[0].start.getShiftedBy(u.length),u="")),0==u.length&&d[0].isCollapsed)return;}var h={text:u,selection:t.createSelection(d)};o.isAndroid&&i.document.isComposing?_this354._compositionQueue.push(h):(e.execute("insertText",h),i.scrollToTheSelection());}),o.isAndroid?this.listenTo(i.document,"keydown",function(e,n){!s.isCollapsed&&229==n.keyCode&&i.document.isComposing&&Cw(t,r);}):this.listenTo(i.document,"compositionstart",function(){s.isCollapsed||Cw(t,r);}),o.isAndroid?(this.listenTo(i.document,"mutations",function(e,_ref100){var t=_ref100.mutations;if(i.document.isComposing){var _iterator416=_createForOfIteratorHelper(t),_step416;try{for(_iterator416.s();!(_step416=_iterator416.n()).done;){var _e440=_step416.value.node;var _t265=xw(_e440,n),_i316=n.toModelElement(_t265);if(_this354._compositionQueue.isComposedElement(_i316))return void _this354._compositionQueue.flush("mutations");}}catch(err){_iterator416.e(err);}finally{_iterator416.f();}}}),this.listenTo(i.document,"compositionend",function(){_this354._compositionQueue.flush("composition end");}),this.listenTo(i.document,"compositionend",function(){var e=[];var _iterator417=_createForOfIteratorHelper(_this354._compositionQueue.flushComposedElements()),_step417;try{for(_iterator417.s();!(_step417=_iterator417.n()).done;){var _t266=_step417.value;var _i317=n.toViewElement(_t266);_i317&&e.push({type:"children",node:_i317});}}catch(err){_iterator417.e(err);}finally{_iterator417.f();}e.length&&i.document.fire("mutations",{mutations:e});},{priority:"lowest"})):this.listenTo(i.document,"compositionend",function(){i.document.fire("mutations",{mutations:[]});},{priority:"lowest"});}},{key:"destroy",value:function destroy(){_superPropGet(yw,"destroy",this,3)([]),this._compositionQueue.destroy();}}],[{key:"pluginName",get:function get(){return"Input";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var kw=/*#__PURE__*/function(){function kw(e){var _this355=this;_classCallCheck(this,kw);_defineProperty(this,"editor",void 0);_defineProperty(this,"flushDebounced",vs(function(){return _this355.flush("timeout");},50));_defineProperty(this,"_queue",[]);_defineProperty(this,"_compositionElements",new Set());this.editor=e;}return _createClass(kw,[{key:"destroy",value:function destroy(){for(this.flushDebounced.cancel(),this._compositionElements.clear();this._queue.length;)this.shift();}},{key:"length",get:function get(){return this._queue.length;}},{key:"push",value:function push(e){var t={text:e.text};if(e.selection){t.selectionRanges=[];var _iterator418=_createForOfIteratorHelper(e.selection.getRanges()),_step418;try{for(_iterator418.s();!(_step418=_iterator418.n()).done;){var _i318=_step418.value;t.selectionRanges.push(fc.fromRange(_i318)),this._compositionElements.add(_i318.start.parent);}}catch(err){_iterator418.e(err);}finally{_iterator418.f();}}this._queue.push(t),this.flushDebounced();}},{key:"shift",value:function shift(){var e=this._queue.shift(),t={text:e.text};if(e.selectionRanges){var _i319=e.selectionRanges.map(function(e){return function(e){var t=e.toRange();if(e.detach(),"$graveyard"==t.root.rootName)return null;return t;}(e);}).filter(function(e){return!!e;});_i319.length&&(t.selection=this.editor.model.createSelection(_i319));}return t;}},{key:"flush",value:function flush(e){var _this356=this;var t=this.editor,i=t.model,n=t.editing.view;if(this.flushDebounced.cancel(),!this._queue.length)return;var s=t.commands.get("insertText").buffer;i.enqueueChange(s.batch,function(){for(s.lock();_this356._queue.length;){var _e441=_this356.shift();t.execute("insertText",_e441);}s.unlock();}),n.scrollToTheSelection();}},{key:"isComposedElement",value:function isComposedElement(e){return this._compositionElements.has(e);}},{key:"flushComposedElements",value:function flushComposedElements(){var e=Array.from(this._compositionElements);return this._compositionElements.clear(),e;}}]);}();function Cw(e,t){if(!t.isEnabled)return;var i=t.buffer;i.lock(),e.enqueueChange(i.batch,function(){e.deleteContent(e.document.selection);}),i.unlock();}function xw(e,t){var i=e.is("$text")?e.parent:e;for(;!t.toModelElement(i);)i=i.parent;return i;}var Aw=/*#__PURE__*/function(_Hr5){function Aw(e,t){var _this357;_classCallCheck(this,Aw);_this357=_callSuper(this,Aw,[e]),_defineProperty(_assertThisInitialized(_this357),"direction",void 0),_defineProperty(_assertThisInitialized(_this357),"_buffer",void 0),_this357.direction=t,_this357._buffer=new pw(e.model,e.config.get("typing.undoStep")),_this357._isEnabledBasedOnSelection=!1;return _this357;}_inherits(Aw,_Hr5);return _createClass(Aw,[{key:"buffer",get:function get(){return this._buffer;}},{key:"execute",value:function execute(){var _this358=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document;t.enqueueChange(this._buffer.batch,function(n){_this358._buffer.lock();var s=n.createSelection(e.selection||i.selection);if(!t.canEditAt(s))return;var o=e.sequence||1,r=s.isCollapsed;if(s.isCollapsed&&t.modifySelection(s,{direction:_this358.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),_this358._shouldEntireContentBeReplacedWithParagraph(o))return void _this358._replaceEntireContentWithParagraph(n);if(_this358._shouldReplaceFirstBlockWithParagraph(s,o))return void _this358.editor.execute("paragraph",{selection:s});if(s.isCollapsed)return;var a=0;s.getFirstRange().getMinimalFlatRanges().forEach(function(e){a+=no(e.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}));}),t.deleteContent(s,{doNotResetEntireContent:r,direction:_this358.direction}),_this358._buffer.input(a),n.setSelection(s),_this358._buffer.unlock();});}},{key:"_shouldEntireContentBeReplacedWithParagraph",value:function _shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;var t=this.editor.model,i=t.document.selection,n=t.schema.getLimitElement(i);if(!(i.isCollapsed&&i.containsEntireContent(n)))return!1;if(!t.schema.checkChild(n,"paragraph"))return!1;var s=n.getChild(0);return!s||!s.is("element","paragraph");}},{key:"_replaceEntireContentWithParagraph",value:function _replaceEntireContentWithParagraph(e){var t=this.editor.model,i=t.document.selection,n=t.schema.getLimitElement(i),s=e.createElement("paragraph");e.remove(e.createRangeIn(n)),e.insert(s,n),e.setSelection(s,0);}},{key:"_shouldReplaceFirstBlockWithParagraph",value:function _shouldReplaceFirstBlockWithParagraph(e,t){var i=this.editor.model;if(t>1||"backward"!=this.direction)return!1;if(!e.isCollapsed)return!1;var n=e.getFirstPosition(),s=i.schema.getLimitElement(n),o=s.getChild(0);return n.parent==o&&!!e.containsEntireContent(o)&&!!i.schema.checkChild(s,"paragraph")&&"paragraph"!=o.name;}}]);}(Hr);var Ew="word",Tw="selection",Pw="backward",Sw="forward",Iw={deleteContent:{unit:Tw,direction:Pw},deleteContentBackward:{unit:"codePoint",direction:Pw},deleteWordBackward:{unit:Ew,direction:Pw},deleteHardLineBackward:{unit:Tw,direction:Pw},deleteSoftLineBackward:{unit:Tw,direction:Pw},deleteContentForward:{unit:"character",direction:Sw},deleteWordForward:{unit:Ew,direction:Sw},deleteHardLineForward:{unit:Tw,direction:Sw},deleteSoftLineForward:{unit:Tw,direction:Sw}};var Vw=/*#__PURE__*/function(_Al10){function Vw(e){var _this359;_classCallCheck(this,Vw);_this359=_callSuper(this,Vw,[e]);var t=e.document;var i=0;t.on("keydown",function(){i++;}),t.on("keyup",function(){i=0;}),t.on("beforeinput",function(n,s){if(!_this359.isEnabled)return;var r=s.targetRanges,a=s.domEvent,l=s.inputType,c=Iw[l];if(!c)return;var d={direction:c.direction,unit:c.unit,sequence:i};d.unit==Tw&&(d.selectionToRemove=e.createSelection(r[0])),"deleteContentBackward"===l&&(o.isAndroid&&(d.sequence=1),function(e){if(1!=e.length||e[0].isCollapsed)return!1;var t=e[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});var i=0;var _iterator419=_createForOfIteratorHelper(t),_step419;try{for(_iterator419.s();!(_step419=_iterator419.n()).done;){var _step419$value=_step419.value,_e442=_step419$value.nextPosition,_n168=_step419$value.item;if(_e442.parent.is("$text")){var _t267=_e442.parent.data,_n169=_e442.offset;if(Br(_t267,_n169)||Mr(_t267,_n169)||Fr(_t267,_n169))continue;i++;}else(_n168.is("containerElement")||_n168.is("emptyElement"))&&i++;if(i>1)return!0;}}catch(err){_iterator419.e(err);}finally{_iterator419.f();}return!1;}(r)&&(d.unit=Tw,d.selectionToRemove=e.createSelection(r)));var u=new Ta(t,"delete",r[0]);t.fire(u,new El(e,a,d)),u.stop.called&&n.stop();}),o.isBlink&&function(e){var t=e.view,i=t.document;var n=null,s=!1;function o(e){return e==nr.backspace||e==nr["delete"];}function r(e){return e==nr.backspace?Pw:Sw;}i.on("keydown",function(e,_ref101){var t=_ref101.keyCode;n=t,s=!1;}),i.on("keyup",function(a,_ref102){var l=_ref102.keyCode,c=_ref102.domEvent;var d=i.selection,u=e.isEnabled&&l==n&&o(l)&&!d.isCollapsed&&!s;if(n=null,u){var _e443=d.getFirstRange(),_n170=new Ta(i,"delete",_e443),_s122={unit:Tw,direction:r(l),selectionToRemove:d};i.fire(_n170,new El(t,c,_s122));}}),i.on("beforeinput",function(e,_ref103){var t=_ref103.inputType;var i=Iw[t];o(n)&&i&&i.direction==r(n)&&(s=!0);},{priority:"high"}),i.on("beforeinput",function(e,_ref104){var t=_ref104.inputType,i=_ref104.data;n==nr["delete"]&&"insertText"==t&&""==i&&e.stop();},{priority:"high"});}(_this359);return _this359;}_inherits(Vw,_Al10);return _createClass(Vw,[{key:"observe",value:function observe(){}},{key:"stopObserving",value:function stopObserving(){}}]);}(Al);var Rw=/*#__PURE__*/function(_Dr15){function Rw(){var _this360;_classCallCheck(this,Rw);for(var _len53=arguments.length,args=new Array(_len53),_key53=0;_key53<_len53;_key53++){args[_key53]=arguments[_key53];}_this360=_callSuper(this,Rw,[].concat(args));_defineProperty(_this360,"_undoOnBackspace",void 0);return _this360;}_inherits(Rw,_Dr15);return _createClass(Rw,[{key:"init",value:function init(){var _this361=this;var e=this.editor,t=e.editing.view,i=t.document,n=e.model.document;t.addObserver(Vw),this._undoOnBackspace=!1;var s=new Aw(e,"forward");e.commands.add("deleteForward",s),e.commands.add("forwardDelete",s),e.commands.add("delete",new Aw(e,"backward")),this.listenTo(i,"delete",function(n,s){i.isComposing||s.preventDefault();var o=s.direction,r=s.sequence,a=s.selectionToRemove,l=s.unit,c="forward"===o?"deleteForward":"delete",d={sequence:r};if("selection"==l){var _t268=Array.from(a.getRanges()).map(function(t){return e.editing.mapper.toModelRange(t);});d.selection=e.model.createSelection(_t268);}else d.unit=l;e.execute(c,d),t.scrollToTheSelection();},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(i,"delete",function(t,i){_this361._undoOnBackspace&&"backward"==i.direction&&1==i.sequence&&"codePoint"==i.unit&&(_this361._undoOnBackspace=!1,e.execute("undo"),i.preventDefault(),t.stop());},{context:"$capture"}),this.listenTo(n,"change",function(){_this361._undoOnBackspace=!1;}));}},{key:"requestUndoOnBackspace",value:function requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0);}}],[{key:"pluginName",get:function get(){return"Delete";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Ow=/*#__PURE__*/function(_Dr16){function Ow(){_classCallCheck(this,Ow);return _callSuper(this,Ow,arguments);}_inherits(Ow,_Dr16);return _createClass(Ow,null,[{key:"requires",get:function get(){return[yw,Rw];}},{key:"pluginName",get:function get(){return"Typing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function Bw(e,t){var i=e.start;return{text:Array.from(e.getWalker({ignoreElementEnd:!1})).reduce(function(e,_ref105){var n=_ref105.item;return n.is("$text")||n.is("$textProxy")?e+n.data:(i=t.createPositionAfter(n),"");},""),range:t.createRange(i,e.end)};}var Mw=/*#__PURE__*/function(_Zs16){function Mw(e,t){var _this362;_classCallCheck(this,Mw);_this362=_callSuper(this,Mw),_defineProperty(_assertThisInitialized(_this362),"model",void 0),_defineProperty(_assertThisInitialized(_this362),"testCallback",void 0),_defineProperty(_assertThisInitialized(_this362),"_hasMatch",void 0),_this362.model=e,_this362.testCallback=t,_this362._hasMatch=!1,_this362.set("isEnabled",!0),_this362.on("change:isEnabled",function(){_this362.isEnabled?_this362._startListening():(_this362.stopListening(e.document.selection),_this362.stopListening(e.document));}),_this362._startListening();return _this362;}_inherits(Mw,_Zs16);return _createClass(Mw,[{key:"hasMatch",get:function get(){return this._hasMatch;}},{key:"_startListening",value:function _startListening(){var _this363=this;var e=this.model.document;this.listenTo(e.selection,"change:range",function(t,_ref106){var i=_ref106.directChange;i&&(e.selection.isCollapsed?_this363._evaluateTextBeforeSelection("selection"):_this363.hasMatch&&(_this363.fire("unmatched"),_this363._hasMatch=!1));}),this.listenTo(e,"change:data",function(e,t){!t.isUndo&&t.isLocal&&_this363._evaluateTextBeforeSelection("data",{batch:t});});}},{key:"_evaluateTextBeforeSelection",value:function _evaluateTextBeforeSelection(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.model,n=i.document.selection,s=i.createRange(i.createPositionAt(n.focus.parent,0),n.focus),_Bw=Bw(s,i),o=_Bw.text,r=_Bw.range,a=this.testCallback(o);if(!a&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!a,a){var _i320=Object.assign(t,{text:o,range:r});"object"==_typeof(a)&&Object.assign(_i320,a),this.fire("matched:".concat(e),_i320);}}}]);}(Zs());var Lw=/*#__PURE__*/function(_Dr17){function Lw(e){var _this364;_classCallCheck(this,Lw);_this364=_callSuper(this,Lw,[e]),_defineProperty(_assertThisInitialized(_this364),"attributes",void 0),_defineProperty(_assertThisInitialized(_this364),"_overrideUid",void 0),_defineProperty(_assertThisInitialized(_this364),"_isNextGravityRestorationSkipped",!1),_this364.attributes=new Set(),_this364._overrideUid=null;return _this364;}_inherits(Lw,_Dr17);return _createClass(Lw,[{key:"init",value:function init(){var _this365=this;var e=this.editor,t=e.model,i=e.editing.view,n=e.locale,s=t.document.selection;this.listenTo(i.document,"arrowKey",function(e,t){if(!s.isCollapsed)return;if(t.shiftKey||t.altKey||t.ctrlKey)return;var i=t.keyCode==nr.arrowright,o=t.keyCode==nr.arrowleft;if(!i&&!o)return;var r=n.contentLanguageDirection;var a=!1;a="ltr"===r&&i||"rtl"===r&&o?_this365._handleForwardMovement(t):_this365._handleBackwardMovement(t),!0===a&&e.stop();},{context:"$text",priority:"highest"}),this.listenTo(s,"change:range",function(e,t){_this365._isNextGravityRestorationSkipped?_this365._isNextGravityRestorationSkipped=!1:_this365._isGravityOverridden&&(!t.directChange&&$w(s.getFirstPosition(),_this365.attributes)||_this365._restoreGravity());}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode();}},{key:"registerAttribute",value:function registerAttribute(e){this.attributes.add(e);}},{key:"_handleForwardMovement",value:function _handleForwardMovement(e){var t=this.attributes,i=this.editor.model,n=i.document.selection,s=n.getFirstPosition();return!this._isGravityOverridden&&(!s.isAtStart||!Fw(n,t))&&!!$w(s,t)&&(zw(e),Fw(n,t)&&$w(s,t,!0)?Dw(i,t):this._overrideGravity(),!0);}},{key:"_handleBackwardMovement",value:function _handleBackwardMovement(e){var t=this.attributes,i=this.editor.model,n=i.document.selection,s=n.getFirstPosition();return this._isGravityOverridden?(zw(e),this._restoreGravity(),$w(s,t,!0)?Dw(i,t):Nw(i,t,s),!0):s.isAtStart?!!Fw(n,t)&&(zw(e),Nw(i,t,s),!0):!Fw(n,t)&&$w(s,t,!0)?(zw(e),Nw(i,t,s),!0):!!Hw(s,t)&&(s.isAtEnd&&!Fw(n,t)&&$w(s,t)?(zw(e),Nw(i,t,s),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1));}},{key:"_enableClickingAfterNode",value:function _enableClickingAfterNode(){var _this366=this;var e=this.editor,t=e.model,i=t.document.selection,n=e.editing.view.document;e.editing.view.addObserver(Wu);var s=!1;this.listenTo(n,"mousedown",function(){s=!0;}),this.listenTo(n,"selectionChange",function(){var e=_this366.attributes;if(!s)return;if(s=!1,!i.isCollapsed)return;if(!Fw(i,e))return;var n=i.getFirstPosition();$w(n,e)&&(n.isAtStart||$w(n,e,!0)?Dw(t,e):_this366._isGravityOverridden||_this366._overrideGravity());});}},{key:"_enableInsertContentSelectionAttributesFixer",value:function _enableInsertContentSelectionAttributesFixer(){var e=this.editor.model,t=e.document.selection,i=this.attributes;this.listenTo(e,"insertContent",function(){var n=t.getFirstPosition();Fw(t,i)&&$w(n,i)&&Dw(e,i);},{priority:"low"});}},{key:"_handleDeleteContentAfterNode",value:function _handleDeleteContentAfterNode(){var _this367=this;var e=this.editor,t=e.model,i=t.document.selection,n=e.editing.view;var s=!1,o=!1;this.listenTo(n.document,"delete",function(e,t){s="backward"===t.direction;},{priority:"high"}),this.listenTo(t,"deleteContent",function(){if(!s)return;var e=i.getFirstPosition();o=Fw(i,_this367.attributes)&&!Hw(e,_this367.attributes);},{priority:"high"}),this.listenTo(t,"deleteContent",function(){s&&(s=!1,o||e.model.enqueueChange(function(){var e=i.getFirstPosition();Fw(i,_this367.attributes)&&$w(e,_this367.attributes)&&(e.isAtStart||$w(e,_this367.attributes,!0)?Dw(t,_this367.attributes):_this367._isGravityOverridden||_this367._overrideGravity());}));},{priority:"low"});}},{key:"_isGravityOverridden",get:function get(){return!!this._overrideUid;}},{key:"_overrideGravity",value:function _overrideGravity(){this._overrideUid=this.editor.model.change(function(e){return e.overrideSelectionGravity();});}},{key:"_restoreGravity",value:function _restoreGravity(){var _this368=this;this.editor.model.change(function(e){e.restoreSelectionGravity(_this368._overrideUid),_this368._overrideUid=null;});}}],[{key:"pluginName",get:function get(){return"TwoStepCaretMovement";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function Fw(e,t){var _iterator420=_createForOfIteratorHelper(t),_step420;try{for(_iterator420.s();!(_step420=_iterator420.n()).done;){var _i321=_step420.value;if(e.hasAttribute(_i321))return!0;}}catch(err){_iterator420.e(err);}finally{_iterator420.f();}return!1;}function Nw(e,t,i){var n=i.nodeBefore;e.change(function(i){if(n){var _t269=[],_s123=e.schema.isObject(n)&&e.schema.isInline(n);var _iterator421=_createForOfIteratorHelper(n.getAttributes()),_step421;try{for(_iterator421.s();!(_step421=_iterator421.n()).done;){var _step421$value=_slicedToArray(_step421.value,2),_i322=_step421$value[0],_o65=_step421$value[1];!e.schema.checkAttribute("$text",_i322)||_s123&&!1===e.schema.getAttributeProperties(_i322).copyFromObject||_t269.push([_i322,_o65]);}}catch(err){_iterator421.e(err);}finally{_iterator421.f();}i.setSelectionAttribute(_t269);}else i.removeSelectionAttribute(t);});}function Dw(e,t){e.change(function(e){e.removeSelectionAttribute(t);});}function zw(e){e.preventDefault();}function Hw(e,t){return $w(e.getShiftedBy(-1),t);}function $w(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=e.nodeBefore,s=e.nodeAfter;var _iterator422=_createForOfIteratorHelper(t),_step422;try{for(_iterator422.s();!(_step422=_iterator422.n()).done;){var _e444=_step422.value;var _t270=n?n.getAttribute(_e444):void 0,_o66=s?s.getAttribute(_e444):void 0;if((!i||void 0!==_t270&&void 0!==_o66)&&_o66!==_t270)return!0;}}catch(err){_iterator422.e(err);}finally{_iterator422.f();}return!1;}var Uw={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:Jw('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:Jw("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:Jw("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:Jw('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:Jw('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:Jw("'"),to:[null,"‚",null,"’"]}},Ww={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},jw=["symbols","mathematical","typography","quotes"];var qw=/*#__PURE__*/function(_Dr18){function qw(e){var _this369;_classCallCheck(this,qw);_this369=_callSuper(this,qw,[e]),e.config.define("typing",{transformations:{include:jw}});return _this369;}_inherits(qw,_Dr18);return _createClass(qw,[{key:"init",value:function init(){var _this370=this;var e=this.editor.model.document.selection;e.on("change:range",function(){_this370.isEnabled=!e.anchor.parent.is("element","codeBlock");}),this._enableTransformationWatchers();}},{key:"_enableTransformationWatchers",value:function _enableTransformationWatchers(){var e=this.editor,t=e.model,i=e.plugins.get("Delete"),n=function(e){var t=e.extra||[],i=e.remove||[],n=function n(e){return!i.includes(e);};return function(e){var t=new Set();var _iterator423=_createForOfIteratorHelper(e),_step423;try{for(_iterator423.s();!(_step423=_iterator423.n()).done;){var _i323=_step423.value;if("string"==typeof _i323&&Ww[_i323]){var _iterator424=_createForOfIteratorHelper(Ww[_i323]),_step424;try{for(_iterator424.s();!(_step424=_iterator424.n()).done;){var _e445=_step424.value;t.add(_e445);}}catch(err){_iterator424.e(err);}finally{_iterator424.f();}}else t.add(_i323);}}catch(err){_iterator423.e(err);}finally{_iterator423.f();}return Array.from(t);}(e.include.concat(t).filter(n)).filter(n).map(function(e){return"string"==typeof e&&Uw[e]?Uw[e]:e;}).filter(function(e){return"object"==_typeof(e);}).map(function(e){return{from:Gw(e.from),to:Kw(e.to)};});}(e.config.get("typing.transformations")),s=new Mw(e.model,function(e){var _iterator425=_createForOfIteratorHelper(n),_step425;try{for(_iterator425.s();!(_step425=_iterator425.n()).done;){var _t271=_step425.value;if(_t271.from.test(e))return{normalizedTransformation:_t271};}}catch(err){_iterator425.e(err);}finally{_iterator425.f();}});s.on("matched:data",function(e,n){if(!n.batch.isTyping)return;var _n$normalizedTransfor=n.normalizedTransformation,s=_n$normalizedTransfor.from,o=_n$normalizedTransfor.to,r=s.exec(n.text),a=o(r.slice(1)),l=n.range;var c=r.index;t.enqueueChange(function(e){for(var _i324=1;_i324<r.length;_i324++){var _n171=r[_i324],_s124=a[_i324-1];if(null==_s124){c+=_n171.length;continue;}var _o67=l.start.getShiftedBy(c),_d5=t.createRange(_o67,_o67.getShiftedBy(_n171.length)),_u5=Zw(_o67);t.insertContent(e.createText(_s124,_u5),_d5),c+=_s124.length;}t.enqueueChange(function(){i.requestUndoOnBackspace();});});}),s.bind("isEnabled").to(this);}}],[{key:"requires",get:function get(){return["Delete","Input"];}},{key:"pluginName",get:function get(){return"TextTransformation";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function Gw(e){return"string"==typeof e?new RegExp("(".concat(Rs(e),")$")):e;}function Kw(e){return"string"==typeof e?function(){return[e];}:e instanceof Array?function(){return e;}:e;}function Zw(e){return(e.textNode?e.textNode:e.nodeAfter).getAttributes();}function Jw(e){return new RegExp("(^|\\s)(".concat(e,")([^").concat(e,"]*)(").concat(e,")$"));}function Qw(e,t,i,n){return n.createRange(Yw(e,t,i,!0,n),Yw(e,t,i,!1,n));}function Yw(e,t,i,n,s){var o=e.textNode||(n?e.nodeBefore:e.nodeAfter),r=null;for(;o&&o.getAttribute(t)==i;)r=o,o=n?o.previousSibling:o.nextSibling;return r?s.createPositionAt(r,n?"before":"after"):e;}function Xw(e,t,i,n){var s=e.editing.view,o=new Set();s.document.registerPostFixer(function(s){var r=e.model.document.selection;var a=!1;if(r.hasAttribute(t)){var _l13=Qw(r.getFirstPosition(),t,r.getAttribute(t),e.model),_c11=e.editing.mapper.toViewRange(_l13);var _iterator426=_createForOfIteratorHelper(_c11.getItems()),_step426;try{for(_iterator426.s();!(_step426=_iterator426.n()).done;){var _e446=_step426.value;_e446.is("element",i)&&!_e446.hasClass(n)&&(s.addClass(n,_e446),o.add(_e446),a=!0);}}catch(err){_iterator426.e(err);}finally{_iterator426.f();}}return a;}),e.conversion["for"]("editingDowncast").add(function(e){function t(){s.change(function(e){var _iterator427=_createForOfIteratorHelper(o.values()),_step427;try{for(_iterator427.s();!(_step427=_iterator427.n()).done;){var _t272=_step427.value;e.removeClass(n,_t272),o["delete"](_t272);}}catch(err){_iterator427.e(err);}finally{_iterator427.f();}});}e.on("insert",t,{priority:"highest"}),e.on("remove",t,{priority:"highest"}),e.on("attribute",t,{priority:"highest"}),e.on("selection",t,{priority:"highest"});});}function e_(e,t,i,n){var s,o=null;"function"==typeof n?s=n:(o=e.commands.get(n),s=function s(){e.execute(n);}),e.model.document.on("change:data",function(r,a){if(o&&!o.isEnabled||!t.isEnabled)return;var l=wr(e.model.document.selection.getRanges());if(!l.isCollapsed)return;if(a.isUndo||!a.isLocal)return;var c=Array.from(e.model.document.differ.getChanges()),d=c[0];if(1!=c.length||"insert"!==d.type||"$text"!=d.name||1!=d.length)return;var u=d.position.parent;if(u.is("element","codeBlock"))return;if(u.is("element","listItem")&&"function"!=typeof n&&!["numberedList","bulletedList","todoList"].includes(n))return;if(o&&!0===o.value)return;var h=u.getChild(0),m=e.model.createRangeOn(h);if(!m.containsRange(l)&&!l.end.isEqual(m.end))return;var g=i.exec(h.data.substr(0,l.end.offset));g&&e.model.enqueueChange(function(t){var i=t.createPositionAt(u,0),n=t.createPositionAt(u,g[0].length),o=new fc(i,n);if(!1!==s({match:g})){t.remove(o);var _i325=e.model.document.selection.getFirstRange(),_n172=t.createRangeIn(u);!u.isEmpty||_n172.isEqual(_i325)||_n172.containsRange(_i325,!0)||t.remove(u);}o.detach(),e.model.enqueueChange(function(){e.plugins.get("Delete").requestUndoOnBackspace();});});});}function t_(e,t,i,n){var s,o;i instanceof RegExp?s=i:o=i,o=o||function(e){var t;var i=[],n=[];for(;null!==(t=s.exec(e))&&!(t&&t.length<4);){var _t273=t,_e447=_t273.index,_s125=_t273[1],_o68=_t273[2],_r37=_t273[3];var _a21=_s125+_o68+_r37;_e447+=t[0].length-_a21.length;var _l14=[_e447,_e447+_s125.length],_c12=[_e447+_s125.length+_o68.length,_e447+_s125.length+_o68.length+_r37.length];i.push(_l14),i.push(_c12),n.push([_e447+_s125.length,_e447+_s125.length+_o68.length]);}return{remove:i,format:n};},e.model.document.on("change:data",function(i,s){if(s.isUndo||!s.isLocal||!t.isEnabled)return;var r=e.model,a=r.document.selection;if(!a.isCollapsed)return;var l=Array.from(r.document.differ.getChanges()),c=l[0];if(1!=l.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;var d=a.focus,u=d.parent,_ref107=function(e,t){var i=e.start;var n=Array.from(e.getItems()).reduce(function(e,n){return!n.is("$text")&&!n.is("$textProxy")||n.getAttribute("code")?(i=t.createPositionAfter(n),""):e+n.data;},"");return{text:n,range:t.createRange(i,e.end)};}(r.createRange(r.createPositionAt(u,0),d),r),h=_ref107.text,m=_ref107.range,g=o(h),f=i_(m.start,g.format,r),p=i_(m.start,g.remove,r);f.length&&p.length&&r.enqueueChange(function(t){if(!1!==n(t,f)){var _iterator428=_createForOfIteratorHelper(p.reverse()),_step428;try{for(_iterator428.s();!(_step428=_iterator428.n()).done;){var _e448=_step428.value;t.remove(_e448);}}catch(err){_iterator428.e(err);}finally{_iterator428.f();}r.enqueueChange(function(){e.plugins.get("Delete").requestUndoOnBackspace();});}});});}function i_(e,t,i){return t.filter(function(e){return void 0!==e[0]&&void 0!==e[1];}).map(function(t){return i.createRange(e.getShiftedBy(t[0]),e.getShiftedBy(t[1]));});}var n_=/*#__PURE__*/function(_Dr19){function n_(){_classCallCheck(this,n_);return _callSuper(this,n_,arguments);}_inherits(n_,_Dr19);return _createClass(n_,[{key:"afterInit",value:function afterInit(){var e=this.editor,t=this.editor.t;this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats(),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Revert autoformatting action"),keystroke:"Backspace"}]});}},{key:"_addListAutoformats",value:function _addListAutoformats(){var _this371=this;var e=this.editor.commands;e.get("bulletedList")&&e_(this.editor,this,/^[*-]\s$/,"bulletedList"),e.get("numberedList")&&e_(this.editor,this,/^1[.|)]\s$/,"numberedList"),e.get("todoList")&&e_(this.editor,this,/^\[\s?\]\s$/,"todoList"),e.get("checkTodoList")&&e_(this.editor,this,/^\[\s?x\s?\]\s$/,function(){_this371.editor.execute("todoList"),_this371.editor.execute("checkTodoList");});}},{key:"_addBasicStylesAutoformats",value:function _addBasicStylesAutoformats(){var e=this.editor.commands;if(e.get("bold")){var _e449=s_(this.editor,"bold");t_(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,_e449),t_(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,_e449);}if(e.get("italic")){var _e450=s_(this.editor,"italic");t_(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,_e450),t_(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,_e450);}if(e.get("code")){var _e451=s_(this.editor,"code");t_(this.editor,this,/(`)([^`]+)(`)$/g,_e451);}if(e.get("strikethrough")){var _e452=s_(this.editor,"strikethrough");t_(this.editor,this,/(~~)([^~]+)(~~)$/g,_e452);}}},{key:"_addHeadingAutoformats",value:function _addHeadingAutoformats(){var _this372=this;var e=this.editor.commands.get("heading");e&&e.modelElements.filter(function(e){return e.match(/^heading[1-6]$/);}).forEach(function(t){var i=t[7],n=new RegExp("^(#{".concat(i,"})\\s$"));e_(_this372.editor,_this372,n,function(){if(!e.isEnabled||e.value===t)return!1;_this372.editor.execute("heading",{value:t});});});}},{key:"_addBlockQuoteAutoformats",value:function _addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&e_(this.editor,this,/^>\s$/,"blockQuote");}},{key:"_addCodeBlockAutoformats",value:function _addCodeBlockAutoformats(){var _this373=this;var e=this.editor,t=e.model.document.selection;e.commands.get("codeBlock")&&e_(e,this,/^```$/,function(){if(t.getFirstPosition().parent.is("element","listItem"))return!1;_this373.editor.execute("codeBlock",{usePreviousLanguageChoice:!0});});}},{key:"_addHorizontalLineAutoformats",value:function _addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&e_(this.editor,this,/^---$/,"horizontalLine");}}],[{key:"requires",get:function get(){return[Rw];}},{key:"pluginName",get:function get(){return"Autoformat";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function s_(e,t){return function(i,n){if(!e.commands.get(t).isEnabled)return!1;var s=e.model.schema.getValidRanges(n,t);var _iterator429=_createForOfIteratorHelper(s),_step429;try{for(_iterator429.s();!(_step429=_iterator429.n()).done;){var _e453=_step429.value;i.setAttribute(t,!0,_e453);}}catch(err){_iterator429.e(err);}finally{_iterator429.f();}i.removeSelectionAttribute(t);};}var o_=/*#__PURE__*/function(_Dr20){function o_(e){var _this374;_classCallCheck(this,o_);_this374=_callSuper(this,o_,[e]);_defineProperty(_this374,"adapter",void 0);_defineProperty(_this374,"_debouncedSave",void 0);_defineProperty(_this374,"_lastDocumentVersion",void 0);_defineProperty(_this374,"_savePromise",void 0);_defineProperty(_this374,"_domEmitter",void 0);_defineProperty(_this374,"_config",void 0);_defineProperty(_this374,"_pendingActions",void 0);_defineProperty(_this374,"_makeImmediateSave",void 0);_defineProperty(_this374,"_action",null);var t=e.config.get("autosave")||{},i=t.waitingTime||1e3;_this374.set("state","synchronized"),_this374._debouncedSave=vs(_this374._save.bind(_this374),i),_this374._lastDocumentVersion=e.model.document.version,_this374._savePromise=null,_this374._domEmitter=new(go())(),_this374._config=t,_this374._pendingActions=e.plugins.get(_m),_this374._makeImmediateSave=!1;return _this374;}_inherits(o_,_Dr20);return _createClass(o_,[{key:"init",value:function init(){var _this375=this;var e=this.editor,t=e.model.document;this.listenTo(e,"ready",function(){_this375.listenTo(t,"change:data",function(e,t){_this375._saveCallbacks.length&&t.isLocal&&("synchronized"===_this375.state&&(_this375.state="waiting",_this375._setPendingAction()),"waiting"===_this375.state&&_this375._debouncedSave());});}),this.listenTo(e,"destroy",function(){return _this375._flush();},{priority:"highest"}),this._domEmitter.listenTo(window,"beforeunload",function(e,t){_this375._pendingActions.hasAny&&(t.returnValue=_this375._pendingActions.first.message);});}},{key:"destroy",value:function destroy(){this._domEmitter.stopListening(),_superPropGet(o_,"destroy",this,3)([]);}},{key:"save",value:function save(){return this._debouncedSave.cancel(),this._save();}},{key:"_flush",value:function _flush(){this._debouncedSave.flush();}},{key:"_save",value:function _save(){var _this376=this;return this._savePromise?(this._makeImmediateSave=this.editor.model.document.version>this._lastDocumentVersion,this._savePromise):(this._setPendingAction(),this.state="saving",this._lastDocumentVersion=this.editor.model.document.version,this._savePromise=Promise.resolve().then(function(){return Promise.all(_this376._saveCallbacks.map(function(e){return e(_this376.editor);}));})["finally"](function(){_this376._savePromise=null;}).then(function(){if(_this376._makeImmediateSave)return _this376._makeImmediateSave=!1,_this376._save();_this376.editor.model.document.version>_this376._lastDocumentVersion?(_this376.state="waiting",_this376._debouncedSave()):(_this376.state="synchronized",_this376._pendingActions.remove(_this376._action),_this376._action=null);})["catch"](function(e){throw _this376.state="error",_this376.state="saving",_this376._debouncedSave(),e;}),this._savePromise);}},{key:"_setPendingAction",value:function _setPendingAction(){var e=this.editor.t;this._action||(this._action=this._pendingActions.add(e("Saving changes")));}},{key:"_saveCallbacks",get:function get(){var e=[];return this.adapter&&this.adapter.save&&e.push(this.adapter.save),this._config.save&&e.push(this._config.save),e;}}],[{key:"pluginName",get:function get(){return"Autosave";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[_m];}}]);}(Dr);var r_=/*#__PURE__*/function(_Hr6){function r_(e,t){var _this377;_classCallCheck(this,r_);_this377=_callSuper(this,r_,[e]),_defineProperty(_assertThisInitialized(_this377),"attributeKey",void 0),_this377.attributeKey=t;return _this377;}_inherits(r_,_Hr6);return _createClass(r_,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey);}},{key:"execute",value:function execute(){var _this378=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document.selection,n=void 0===e.forceValue?!this.value:e.forceValue;t.change(function(e){if(i.isCollapsed)n?e.setSelectionAttribute(_this378.attributeKey,!0):e.removeSelectionAttribute(_this378.attributeKey);else{var _s126=t.schema.getValidRanges(i.getRanges(),_this378.attributeKey);var _iterator430=_createForOfIteratorHelper(_s126),_step430;try{for(_iterator430.s();!(_step430=_iterator430.n()).done;){var _t274=_step430.value;n?e.setAttribute(_this378.attributeKey,n,_t274):e.removeAttribute(_this378.attributeKey,_t274);}}catch(err){_iterator430.e(err);}finally{_iterator430.f();}}});}},{key:"_getValueFromFirstAllowedNode",value:function _getValueFromFirstAllowedNode(){var e=this.editor.model,t=e.schema,i=e.document.selection;if(i.isCollapsed)return i.hasAttribute(this.attributeKey);var _iterator431=_createForOfIteratorHelper(i.getRanges()),_step431;try{for(_iterator431.s();!(_step431=_iterator431.n()).done;){var _e454=_step431.value;var _iterator432=_createForOfIteratorHelper(_e454.getItems()),_step432;try{for(_iterator432.s();!(_step432=_iterator432.n()).done;){var _i326=_step432.value;if(t.checkAttribute(_i326,this.attributeKey))return _i326.hasAttribute(this.attributeKey);}}catch(err){_iterator432.e(err);}finally{_iterator432.f();}}}catch(err){_iterator431.e(err);}finally{_iterator431.f();}return!1;}}]);}(Hr);var a_="bold";var l_=/*#__PURE__*/function(_Dr21){function l_(){_classCallCheck(this,l_);return _callSuper(this,l_,arguments);}_inherits(l_,_Dr21);return _createClass(l_,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:a_}),e.model.schema.setAttributeProperties(a_,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:a_,view:"strong",upcastAlso:["b",function(e){var t=e.getStyle("font-weight");return t&&("bold"==t||Number(t)>=600)?{name:!0,styles:["font-weight"]}:null;}]}),e.commands.add(a_,new r_(e,a_)),e.keystrokes.set("CTRL+B",a_),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Bold text"),keystroke:"CTRL+B"}]});}}],[{key:"pluginName",get:function get(){return"BoldEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function c_(_ref108){var e=_ref108.editor,t=_ref108.commandName,i=_ref108.plugin,n=_ref108.icon,s=_ref108.label,o=_ref108.keystroke;return function(r){var a=e.commands.get(t),l=new r(e.locale);return l.set({label:s,icon:n,keystroke:o,isToggleable:!0}),l.bind("isEnabled").to(a,"isEnabled"),l.bind("isOn").to(a,"value"),l instanceof Rg?l.set({role:"menuitemcheckbox"}):l.set({tooltip:!0}),i.listenTo(l,"execute",function(){e.execute(t),e.editing.view.focus();}),l;};}var d_="bold";var u_=/*#__PURE__*/function(_Dr22){function u_(){_classCallCheck(this,u_);return _callSuper(this,u_,arguments);}_inherits(u_,_Dr22);return _createClass(u_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:d_,plugin:this,icon:vm.bold,label:t("Bold"),keystroke:"CTRL+B"});e.ui.componentFactory.add(d_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+d_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"BoldUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var h_=/*#__PURE__*/function(_Dr23){function h_(){_classCallCheck(this,h_);return _callSuper(this,h_,arguments);}_inherits(h_,_Dr23);return _createClass(h_,null,[{key:"requires",get:function get(){return[l_,u_];}},{key:"pluginName",get:function get(){return"Bold";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var m_="code";var g_=/*#__PURE__*/function(_Dr24){function g_(){_classCallCheck(this,g_);return _callSuper(this,g_,arguments);}_inherits(g_,_Dr24);return _createClass(g_,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:m_}),e.model.schema.setAttributeProperties(m_,{isFormatting:!0,copyOnEnter:!1}),e.conversion.attributeToElement({model:m_,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),e.commands.add(m_,new r_(e,m_)),e.plugins.get(Lw).registerAttribute(m_),Xw(e,m_,"code","ck-code_selected"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Move out of an inline code style"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]});}}],[{key:"pluginName",get:function get(){return"CodeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Lw];}}]);}(Dr);var f_="code";var p_=/*#__PURE__*/function(_Dr25){function p_(){_classCallCheck(this,p_);return _callSuper(this,p_,arguments);}_inherits(p_,_Dr25);return _createClass(p_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:f_,plugin:this,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>',label:t("Code")});e.ui.componentFactory.add(f_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+f_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"CodeUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var b_=/*#__PURE__*/function(_Dr26){function b_(){_classCallCheck(this,b_);return _callSuper(this,b_,arguments);}_inherits(b_,_Dr26);return _createClass(b_,null,[{key:"requires",get:function get(){return[g_,p_];}},{key:"pluginName",get:function get(){return"Code";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var w_="italic";var __=/*#__PURE__*/function(_Dr27){function __(){_classCallCheck(this,__);return _callSuper(this,__,arguments);}_inherits(__,_Dr27);return _createClass(__,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:w_}),e.model.schema.setAttributeProperties(w_,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:w_,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),e.commands.add(w_,new r_(e,w_)),e.keystrokes.set("CTRL+I",w_),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Italic text"),keystroke:"CTRL+I"}]});}}],[{key:"pluginName",get:function get(){return"ItalicEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var v_="italic";var y_=/*#__PURE__*/function(_Dr28){function y_(){_classCallCheck(this,y_);return _callSuper(this,y_,arguments);}_inherits(y_,_Dr28);return _createClass(y_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:v_,plugin:this,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>',keystroke:"CTRL+I",label:t("Italic")});e.ui.componentFactory.add(v_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+v_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"ItalicUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var k_=/*#__PURE__*/function(_Dr29){function k_(){_classCallCheck(this,k_);return _callSuper(this,k_,arguments);}_inherits(k_,_Dr29);return _createClass(k_,null,[{key:"requires",get:function get(){return[__,y_];}},{key:"pluginName",get:function get(){return"Italic";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var C_="strikethrough";var x_=/*#__PURE__*/function(_Dr30){function x_(){_classCallCheck(this,x_);return _callSuper(this,x_,arguments);}_inherits(x_,_Dr30);return _createClass(x_,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:C_}),e.model.schema.setAttributeProperties(C_,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:C_,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),e.commands.add(C_,new r_(e,C_)),e.keystrokes.set("CTRL+SHIFT+X","strikethrough"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Strikethrough text"),keystroke:"CTRL+SHIFT+X"}]});}}],[{key:"pluginName",get:function get(){return"StrikethroughEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var A_="strikethrough";var E_=/*#__PURE__*/function(_Dr31){function E_(){_classCallCheck(this,E_);return _callSuper(this,E_,arguments);}_inherits(E_,_Dr31);return _createClass(E_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:A_,plugin:this,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>',keystroke:"CTRL+SHIFT+X",label:t("Strikethrough")});e.ui.componentFactory.add(A_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+A_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"StrikethroughUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var T_=/*#__PURE__*/function(_Dr32){function T_(){_classCallCheck(this,T_);return _callSuper(this,T_,arguments);}_inherits(T_,_Dr32);return _createClass(T_,null,[{key:"requires",get:function get(){return[x_,E_];}},{key:"pluginName",get:function get(){return"Strikethrough";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var P_="subscript";var S_=/*#__PURE__*/function(_Dr33){function S_(){_classCallCheck(this,S_);return _callSuper(this,S_,arguments);}_inherits(S_,_Dr33);return _createClass(S_,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:P_}),e.model.schema.setAttributeProperties(P_,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:P_,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),e.commands.add(P_,new r_(e,P_));}}],[{key:"pluginName",get:function get(){return"SubscriptEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var I_="subscript";var V_=/*#__PURE__*/function(_Dr34){function V_(){_classCallCheck(this,V_);return _callSuper(this,V_,arguments);}_inherits(V_,_Dr34);return _createClass(V_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:I_,plugin:this,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.03 10.349 3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>',label:t("Subscript")});e.ui.componentFactory.add(I_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+I_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"SubscriptUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var R_=/*#__PURE__*/function(_Dr35){function R_(){_classCallCheck(this,R_);return _callSuper(this,R_,arguments);}_inherits(R_,_Dr35);return _createClass(R_,null,[{key:"requires",get:function get(){return[S_,V_];}},{key:"pluginName",get:function get(){return"Subscript";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var O_="superscript";var B_=/*#__PURE__*/function(_Dr36){function B_(){_classCallCheck(this,B_);return _callSuper(this,B_,arguments);}_inherits(B_,_Dr36);return _createClass(B_,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:O_}),e.model.schema.setAttributeProperties(O_,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:O_,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),e.commands.add(O_,new r_(e,O_));}}],[{key:"pluginName",get:function get(){return"SuperscriptEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var M_="superscript";var L_=/*#__PURE__*/function(_Dr37){function L_(){_classCallCheck(this,L_);return _callSuper(this,L_,arguments);}_inherits(L_,_Dr37);return _createClass(L_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:M_,plugin:this,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>',label:t("Superscript")});e.ui.componentFactory.add(M_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+M_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"SuperscriptUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var F_=/*#__PURE__*/function(_Dr38){function F_(){_classCallCheck(this,F_);return _callSuper(this,F_,arguments);}_inherits(F_,_Dr38);return _createClass(F_,null,[{key:"requires",get:function get(){return[B_,L_];}},{key:"pluginName",get:function get(){return"Superscript";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var N_="underline";var D_=/*#__PURE__*/function(_Dr39){function D_(){_classCallCheck(this,D_);return _callSuper(this,D_,arguments);}_inherits(D_,_Dr39);return _createClass(D_,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.model.schema.extend("$text",{allowAttributes:N_}),e.model.schema.setAttributeProperties(N_,{isFormatting:!0,copyOnEnter:!0}),e.conversion.attributeToElement({model:N_,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),e.commands.add(N_,new r_(e,N_)),e.keystrokes.set("CTRL+U","underline"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Underline text"),keystroke:"CTRL+U"}]});}}],[{key:"pluginName",get:function get(){return"UnderlineEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var z_="underline";var H_=/*#__PURE__*/function(_Dr40){function H_(){_classCallCheck(this,H_);return _callSuper(this,H_,arguments);}_inherits(H_,_Dr40);return _createClass(H_,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=c_({editor:e,commandName:z_,plugin:this,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>',label:t("Underline"),keystroke:"CTRL+U"});e.ui.componentFactory.add(z_,function(){return i(pg);}),e.ui.componentFactory.add("menuBar:"+z_,function(){return i(Rg);});}}],[{key:"pluginName",get:function get(){return"UnderlineUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var $_=/*#__PURE__*/function(_Dr41){function $_(){_classCallCheck(this,$_);return _callSuper(this,$_,arguments);}_inherits($_,_Dr41);return _createClass($_,null,[{key:"requires",get:function get(){return[D_,H_];}},{key:"pluginName",get:function get(){return"Underline";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function U_(e,t){var _iterator433,_step433,_i327;return _regeneratorRuntime().wrap(function U_$(_context40){while(1)switch(_context40.prev=_context40.next){case 0:_iterator433=_createForOfIteratorHelper(t);_context40.prev=1;_iterator433.s();case 3:if((_step433=_iterator433.n()).done){_context40.next=11;break;}_i327=_step433.value;_context40.t0=_i327&&e.getAttributeProperties(_i327[0]).copyOnEnter;if(!_context40.t0){_context40.next=9;break;}_context40.next=9;return _i327;case 9:_context40.next=3;break;case 11:_context40.next=16;break;case 13:_context40.prev=13;_context40.t1=_context40["catch"](1);_iterator433.e(_context40.t1);case 16:_context40.prev=16;_iterator433.f();return _context40.finish(16);case 19:case"end":return _context40.stop();}},_marked4,null,[[1,13,16,19]]);}var W_=/*#__PURE__*/function(_Hr7){function W_(){_classCallCheck(this,W_);return _callSuper(this,W_,arguments);}_inherits(W_,_Hr7);return _createClass(W_,[{key:"execute",value:function execute(){var _this379=this;this.editor.model.change(function(e){_this379.enterBlock(e),_this379.fire("afterExecute",{writer:e});});}},{key:"enterBlock",value:function enterBlock(e){var t=this.editor.model,i=t.document.selection,n=t.schema,s=i.isCollapsed,o=i.getFirstRange(),r=o.start.parent,a=o.end.parent;if(n.isLimit(r)||n.isLimit(a))return s||r!=a||t.deleteContent(i),!1;if(s){var _t275=U_(e.model.schema,i.getAttributes());return j_(e,o.start),e.setSelectionAttribute(_t275),!0;}{var _n173=!(o.start.isAtStart&&o.end.isAtEnd),_s127=r==a;if(t.deleteContent(i,{leaveUnmerged:_n173}),_n173){if(_s127)return j_(e,i.focus),!0;e.setSelection(a,0);}}return!1;}}]);}(Hr);function j_(e,t){e.split(t),e.setSelection(t.parent.nextSibling,0);}var q_={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};var G_=/*#__PURE__*/function(_Al11){function G_(e){var _this380;_classCallCheck(this,G_);_this380=_callSuper(this,G_,[e]);var t=_this380.document;var i=!1;t.on("keydown",function(e,t){i=t.shiftKey;}),t.on("beforeinput",function(n,s){if(!_this380.isEnabled)return;var r=s.inputType;o.isSafari&&i&&"insertParagraph"==r&&(r="insertLineBreak");var a=s.domEvent,l=q_[r];if(!l)return;var c=new Ta(t,"enter",s.targetRanges[0]);t.fire(c,new El(e,a,{isSoft:l.isSoft})),c.stop.called&&n.stop();});return _this380;}_inherits(G_,_Al11);return _createClass(G_,[{key:"observe",value:function observe(){}},{key:"stopObserving",value:function stopObserving(){}}]);}(Al);var K_=/*#__PURE__*/function(_Dr42){function K_(){_classCallCheck(this,K_);return _callSuper(this,K_,arguments);}_inherits(K_,_Dr42);return _createClass(K_,[{key:"init",value:function init(){var e=this.editor,t=e.editing.view,i=t.document,n=this.editor.t;t.addObserver(G_),e.commands.add("enter",new W_(e)),this.listenTo(i,"enter",function(n,s){i.isComposing||s.preventDefault(),s.isSoft||(e.execute("enter"),t.scrollToTheSelection());},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:n("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]});}}],[{key:"pluginName",get:function get(){return"Enter";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Z_=/*#__PURE__*/function(_Hr8){function Z_(){_classCallCheck(this,Z_);return _callSuper(this,Z_,arguments);}_inherits(Z_,_Hr8);return _createClass(Z_,[{key:"execute",value:function execute(){var _this381=this;var e=this.editor.model,t=e.document;e.change(function(i){!function(e,t,i){var n=i.isCollapsed,s=i.getFirstRange(),o=s.start.parent,r=s.end.parent,a=o==r;if(n){var _n174=U_(e.schema,i.getAttributes());J_(e,t,s.end),t.removeSelectionAttribute(i.getAttributeKeys()),t.setSelectionAttribute(_n174);}else{var _n175=!(s.start.isAtStart&&s.end.isAtEnd);e.deleteContent(i,{leaveUnmerged:_n175}),a?J_(e,t,i.focus):_n175&&t.setSelection(r,0);}}(e,i,t.selection),_this381.fire("afterExecute",{writer:i});});}},{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.isEnabled=function(e,t){if(t.rangeCount>1)return!1;var i=t.anchor;if(!i||!e.checkChild(i,"softBreak"))return!1;var n=t.getFirstRange(),s=n.start.parent,o=n.end.parent;if((Q_(s,e)||Q_(o,e))&&s!==o)return!1;return!0;}(e.schema,t.selection);}}]);}(Hr);function J_(e,t,i){var n=t.createElement("softBreak");e.insertContent(n,i),t.setSelection(n,"after");}function Q_(e,t){return!e.is("rootElement")&&(t.isLimit(e)||Q_(e.parent,t));}var Y_=/*#__PURE__*/function(_Dr43){function Y_(){_classCallCheck(this,Y_);return _callSuper(this,Y_,arguments);}_inherits(Y_,_Dr43);return _createClass(Y_,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.conversion,n=e.editing.view,s=n.document,o=this.editor.t;t.register("softBreak",{allowWhere:"$text",isInline:!0}),i["for"]("upcast").elementToElement({model:"softBreak",view:"br"}),i["for"]("downcast").elementToElement({model:"softBreak",view:function view(e,_ref109){var t=_ref109.writer;return t.createEmptyElement("br");}}),n.addObserver(G_),e.commands.add("shiftEnter",new Z_(e)),this.listenTo(s,"enter",function(t,i){s.isComposing||i.preventDefault(),i.isSoft&&(e.execute("shiftEnter"),n.scrollToTheSelection());},{priority:"low"}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:o("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]});}}],[{key:"pluginName",get:function get(){return"ShiftEnter";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var X_=/*#__PURE__*/function(_Hr9){function X_(){_classCallCheck(this,X_);return _callSuper(this,X_,arguments);}_inherits(X_,_Hr9);return _createClass(X_,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this382=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.schema,n=t.document.selection,s=Array.from(n.getSelectedBlocks()),o=void 0===e.forceValue?!this.value:e.forceValue;t.change(function(e){if(o){var _t276=s.filter(function(e){return ev(e)||iv(i,e);});_this382._applyQuote(e,_t276);}else _this382._removeQuote(e,s.filter(ev));});}},{key:"_getValue",value:function _getValue(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());return!(!e||!ev(e));}},{key:"_checkEnabled",value:function _checkEnabled(){if(this.value)return!0;var e=this.editor.model.document.selection,t=this.editor.model.schema,i=wr(e.getSelectedBlocks());return!!i&&iv(t,i);}},{key:"_removeQuote",value:function _removeQuote(e,t){tv(e,t).reverse().forEach(function(t){if(t.start.isAtStart&&t.end.isAtEnd)return void e.unwrap(t.start.parent);if(t.start.isAtStart){var _i328=e.createPositionBefore(t.start.parent);return void e.move(t,_i328);}t.end.isAtEnd||e.split(t.end);var i=e.createPositionAfter(t.end.parent);e.move(t,i);});}},{key:"_applyQuote",value:function _applyQuote(e,t){var i=[];tv(e,t).reverse().forEach(function(t){var n=ev(t.start);n||(n=e.createElement("blockQuote"),e.wrap(t,n)),i.push(n);}),i.reverse().reduce(function(t,i){return t.nextSibling==i?(e.merge(e.createPositionAfter(t)),t):i;});}}]);}(Hr);function ev(e){return"blockQuote"==e.parent.name?e.parent:null;}function tv(e,t){var i,n=0;var s=[];for(;n<t.length;){var _o69=t[n],_r38=t[n+1];i||(i=e.createPositionBefore(_o69)),_r38&&_o69.nextSibling==_r38||(s.push(e.createRange(i,e.createPositionAfter(_o69))),i=null),n++;}return s;}function iv(e,t){var i=e.checkChild(t.parent,"blockQuote"),n=e.checkChild(["$root","blockQuote"],t);return i&&n;}var nv=/*#__PURE__*/function(_Dr44){function nv(){_classCallCheck(this,nv);return _callSuper(this,nv,arguments);}_inherits(nv,_Dr44);return _createClass(nv,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema;e.commands.add("blockQuote",new X_(e)),t.register("blockQuote",{inheritAllFrom:"$container"}),e.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),e.model.document.registerPostFixer(function(i){var n=e.model.document.differ.getChanges();var _iterator434=_createForOfIteratorHelper(n),_step434;try{for(_iterator434.s();!(_step434=_iterator434.n()).done;){var _e455=_step434.value;if("insert"==_e455.type){var _n176=_e455.position.nodeAfter;if(!_n176)continue;if(_n176.is("element","blockQuote")&&_n176.isEmpty)return i.remove(_n176),!0;if(_n176.is("element","blockQuote")&&!t.checkChild(_e455.position,_n176))return i.unwrap(_n176),!0;if(_n176.is("element")){var _e456=i.createRangeIn(_n176);var _iterator435=_createForOfIteratorHelper(_e456.getItems()),_step435;try{for(_iterator435.s();!(_step435=_iterator435.n()).done;){var _n177=_step435.value;if(_n177.is("element","blockQuote")&&!t.checkChild(i.createPositionBefore(_n177),_n177))return i.unwrap(_n177),!0;}}catch(err){_iterator435.e(err);}finally{_iterator435.f();}}}else if("remove"==_e455.type){var _t277=_e455.position.parent;if(_t277.is("element","blockQuote")&&_t277.isEmpty)return i.remove(_t277),!0;}}}catch(err){_iterator434.e(err);}finally{_iterator434.f();}return!1;});var i=this.editor.editing.view.document,n=e.model.document.selection,s=e.commands.get("blockQuote");this.listenTo(i,"enter",function(t,i){if(!n.isCollapsed||!s.value)return;n.getLastPosition().parent.isEmpty&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop());},{context:"blockquote"}),this.listenTo(i,"delete",function(t,i){if("backward"!=i.direction||!n.isCollapsed||!s.value)return;var o=n.getLastPosition().parent;o.isEmpty&&!o.previousSibling&&(e.execute("blockQuote"),e.editing.view.scrollToTheSelection(),i.preventDefault(),t.stop());},{context:"blockquote"});}}],[{key:"pluginName",get:function get(){return"BlockQuoteEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[K_,Rw];}}]);}(Dr);var sv=/*#__PURE__*/function(_Dr45){function sv(){_classCallCheck(this,sv);return _callSuper(this,sv,arguments);}_inherits(sv,_Dr45);return _createClass(sv,[{key:"init",value:function init(){var _this383=this;var e=this.editor;e.ui.componentFactory.add("blockQuote",function(){var e=_this383._createButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:blockQuote",function(){var e=_this383._createButton(Rg);return e.set({role:"menuitemcheckbox"}),e;});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get("blockQuote"),s=new e(t.locale),o=i.t;return s.set({label:o("Block quote"),icon:vm.quote,isToggleable:!0}),s.bind("isEnabled").to(n,"isEnabled"),s.bind("isOn").to(n,"value"),this.listenTo(s,"execute",function(){t.execute("blockQuote"),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"BlockQuoteUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ov=/*#__PURE__*/function(_Dr46){function ov(){_classCallCheck(this,ov);return _callSuper(this,ov,arguments);}_inherits(ov,_Dr46);return _createClass(ov,null,[{key:"requires",get:function get(){return[nv,sv];}},{key:"pluginName",get:function get(){return"BlockQuote";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var rv=/*#__PURE__*/function(_Dr47){function rv(){_classCallCheck(this,rv);return _callSuper(this,rv,arguments);}_inherits(rv,_Dr47);return _createClass(rv,[{key:"afterInit",value:function afterInit(){var _this384=this;var e=this.editor;e.commands.get("ckbox")&&(e.ui.componentFactory.add("ckbox",function(){return _this384._createFileToolbarButton();}),e.ui.componentFactory.add("menuBar:ckbox",function(){return _this384._createFileMenuBarButton();}),e.plugins.has("ImageInsertUI")&&e.plugins.get("ImageInsertUI").registerIntegration({name:"assetManager",observable:function observable(){return e.commands.get("ckbox");},buttonViewCreator:function buttonViewCreator(){return _this384._createImageToolbarButton();},formViewCreator:function formViewCreator(){return _this384._createImageDropdownButton();},menuBarButtonViewCreator:function menuBarButtonViewCreator(e){return _this384._createImageMenuBarButton(e?"insertOnly":"insertNested");}}));}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=new e(t.locale),n=t.commands.get("ckbox");return i.bind("isOn","isEnabled").to(n,"value","isEnabled"),i.on("execute",function(){t.execute("ckbox");}),i;}},{key:"_createFileToolbarButton",value:function _createFileToolbarButton(){var e=this.editor.locale.t,t=this._createButton(pg);return t.icon=vm.browseFiles,t.label=e("Open file manager"),t.tooltip=!0,t;}},{key:"_createImageToolbarButton",value:function _createImageToolbarButton(){var e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(pg);return i.icon=vm.imageAssetManager,i.bind("label").to(t,"isImageSelected",function(t){return e(t?"Replace image with file manager":"Insert image with file manager");}),i.tooltip=!0,i;}},{key:"_createImageDropdownButton",value:function _createImageDropdownButton(){var e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(pg);return i.icon=vm.imageAssetManager,i.withText=!0,i.bind("label").to(t,"isImageSelected",function(t){return e(t?"Replace with file manager":"Insert with file manager");}),i.on("execute",function(){t.dropdownView.isOpen=!1;}),i;}},{key:"_createFileMenuBarButton",value:function _createFileMenuBarButton(){var e=this.editor.locale.t,t=this._createButton(Rg);return t.icon=vm.browseFiles,t.withText=!0,t.label=e("File"),t;}},{key:"_createImageMenuBarButton",value:function _createImageMenuBarButton(e){var t=this.editor.locale.t,i=this.editor.locale.t,n=this._createButton(Rg);switch(n.icon=vm.imageAssetManager,n.withText=!0,e){case"insertOnly":n.label=t("Image");break;case"insertNested":n.label=i("With file manager");}return n;}}],[{key:"pluginName",get:function get(){return"CKBoxUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var av=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","#","$","%","*","+",",","-",".",":",";","=","?","@","[","]","^","_","{","|","}","~"],lv=function lv(e){var t=0;for(var _i329=0;_i329<e.length;_i329++){var _n178=e[_i329];t=83*t+av.indexOf(_n178);}return t;},cv=function cv(e){var t=e/255;return t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);},dv=function dv(e){var t=Math.max(0,Math.min(1,e));return t<=.0031308?Math.trunc(12.92*t*255+.5):Math.trunc(255*(1.055*Math.pow(t,.4166666666666667)-.055)+.5);},uv=function uv(e,t){return function(e){return e<0?-1:1;}(e)*Math.pow(Math.abs(e),t);},hv=/*#__PURE__*/function(_Error2){function hv(e){var _this385;_classCallCheck(this,hv);_this385=_callSuper(this,hv,[e]),_this385.name="ValidationError",_this385.message=e;return _this385;}_inherits(hv,_Error2);return _createClass(hv);}(/*#__PURE__*/_wrapNativeSuper(Error)),mv=function mv(e){var t=e>>8&255,i=255&e;return[cv(e>>16),cv(t),cv(i)];},gv=function gv(e,t){var i=Math.floor(e/361),n=Math.floor(e/19)%19,s=e%19;return[uv((i-9)/9,2)*t,uv((n-9)/9,2)*t,uv((s-9)/9,2)*t];},fv=function fv(e,t,i,n){(function(e){if(!e||e.length<6)throw new hv("The blurhash string must be at least 6 characters");var t=lv(e[0]),i=Math.floor(t/9)+1,n=t%9+1;if(e.length!==4+2*n*i)throw new hv("blurhash length mismatch: length is ".concat(e.length," but it should be ").concat(4+2*n*i));})(e),n|=1;var s=lv(e[0]),o=Math.floor(s/9)+1,r=s%9+1,a=(lv(e[1])+1)/166,l=new Array(r*o);for(var _t278=0;_t278<l.length;_t278++)if(0===_t278){var _i330=lv(e.substring(2,6));l[_t278]=mv(_i330);}else{var _i331=lv(e.substring(4+2*_t278,6+2*_t278));l[_t278]=gv(_i331,a*n);}var c=4*t,d=new Uint8ClampedArray(c*i);for(var _e457=0;_e457<i;_e457++)for(var _n179=0;_n179<t;_n179++){var _s128=0,_a22=0,_u6=0;for(var _c13=0;_c13<o;_c13++)for(var _o70=0;_o70<r;_o70++){var _d6=Math.cos(Math.PI*_n179*_o70/t)*Math.cos(Math.PI*_e457*_c13/i),_h3=l[_o70+_c13*r];_s128+=_h3[0]*_d6,_a22+=_h3[1]*_d6,_u6+=_h3[2]*_d6;}var _h4=dv(_s128),_m3=dv(_a22),_g3=dv(_u6);d[4*_n179+0+_e457*c]=_h4,d[4*_n179+1+_e457*c]=_m3,d[4*_n179+2+_e457*c]=_g3,d[4*_n179+3+_e457*c]=255;}return d;};function pv(e){var t=[];var i=0;for(var _n180 in e){var _s129=parseInt(_n180,10);isNaN(_s129)||(_s129>i&&(i=_s129),t.push("".concat(e[_n180]," ").concat(_n180,"w")));}var n=[{srcset:t.join(","),sizes:"(max-width: ".concat(i,"px) 100vw, ").concat(i,"px"),type:"image/webp"}];return{imageFallbackUrl:e["default"],imageSources:n};}function bv(_ref110){var e=_ref110.url,_ref110$method=_ref110.method,t=_ref110$method===void 0?"GET":_ref110$method,i=_ref110.data,n=_ref110.onUploadProgress,s=_ref110.signal,o=_ref110.authorization;var r=new XMLHttpRequest();r.open(t,e.toString()),r.setRequestHeader("Authorization",o),r.setRequestHeader("CKBox-Version","CKEditor 5"),r.responseType="json";var a=function a(){r.abort();};return new Promise(function(e,t){s.throwIfAborted(),s.addEventListener("abort",a),r.addEventListener("loadstart",function(){s.addEventListener("abort",a);}),r.addEventListener("loadend",function(){s.removeEventListener("abort",a);}),r.addEventListener("error",function(){t();}),r.addEventListener("abort",function(){t();}),r.addEventListener("load",function(){var i=r.response;if(!i||i.statusCode>=400)return t(i&&i.message);e(i);}),n&&r.upload.addEventListener("progress",function(e){n(e);}),r.send(i);});}var wv={"image/gif":"gif","image/jpeg":"jpg","image/png":"png","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"};var _v=/*#__PURE__*/function(_Hr10){function _v(e){var _this386;_classCallCheck(this,_v);_this386=_callSuper(this,_v,[e]),_defineProperty(_assertThisInitialized(_this386),"_chosenAssets",new Set()),_defineProperty(_assertThisInitialized(_this386),"_wrapper",null),_this386._initListeners();return _this386;}_inherits(_v,_Hr10);return _createClass(_v,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){this.fire("ckbox:open");}},{key:"_getValue",value:function _getValue(){return null!==this._wrapper;}},{key:"_checkEnabled",value:function _checkEnabled(){var e=this.editor.commands.get("insertImage"),t=this.editor.commands.get("link");return!(!e.isEnabled&&!t.isEnabled);}},{key:"_prepareOptions",value:function _prepareOptions(){var _this387=this;var e=this.editor.config.get("ckbox"),t=e.dialog,i=e.categories,n=e.view,s=e.upload;return{theme:e.theme,language:e.language,tokenUrl:e.tokenUrl,serviceOrigin:e.serviceOrigin,forceDemoLabel:e.forceDemoLabel,choosableFileExtensions:e.choosableFileExtensions,assets:{onChoose:function onChoose(e){return _this387.fire("ckbox:choose",e);}},dialog:{onClose:function onClose(){return _this387.fire("ckbox:close");},width:t&&t.width,height:t&&t.height},categories:i&&{icons:i.icons},view:n&&{openLastView:n.openLastView,startupFolderId:n.startupFolderId,startupCategoryId:n.startupCategoryId,hideMaximizeButton:n.hideMaximizeButton},upload:s&&{componentsHideTimeout:s.componentsHideTimeout,dialogMinimizeTimeout:s.dialogMinimizeTimeout}};}},{key:"_initListeners",value:function _initListeners(){var _this388=this;var e=this.editor,t=e.model,i=!e.config.get("ckbox.ignoreDataId");this.on("ckbox",function(){_this388.refresh();},{priority:"low"}),this.on("ckbox:open",function(){_this388.isEnabled&&!_this388.value&&(_this388._wrapper=ro(document,"div",{"class":"ck ckbox-wrapper"}),document.body.appendChild(_this388._wrapper),window.CKBox.mount(_this388._wrapper,_this388._prepareOptions()));}),this.on("ckbox:close",function(){_this388.value&&(_this388._wrapper.remove(),_this388._wrapper=null,e.editing.view.focus());}),this.on("ckbox:choose",function(n,s){if(!_this388.isEnabled)return;var o=e.commands.get("insertImage"),r=e.commands.get("link"),a=function(_ref111){var e=_ref111.assets,t=_ref111.isImageAllowed,i=_ref111.isLinkAllowed;return e.map(function(e){return function(e){var t=e.data.metadata;if(!t)return!1;return t.width&&t.height;}(e)?{id:e.data.id,type:"image",attributes:vv(e)}:{id:e.data.id,type:"link",attributes:yv(e)};}).filter(function(e){return"image"===e.type?t:i;});}({assets:s,isImageAllowed:o.isEnabled,isLinkAllowed:r.isEnabled}),l=a.length;0!==l&&(t.change(function(e){var _iterator436=_createForOfIteratorHelper(a),_step436;try{var _loop9=function _loop9(){var t=_step436.value;var n=t===a[l-1],s=1===l;_this388._insertAsset(t,n,e,s),i&&(setTimeout(function(){return _this388._chosenAssets["delete"](t);},1e3),_this388._chosenAssets.add(t));};for(_iterator436.s();!(_step436=_iterator436.n()).done;){_loop9();}}catch(err){_iterator436.e(err);}finally{_iterator436.f();}}),e.editing.view.focus());}),this.listenTo(e,"destroy",function(){_this388.fire("ckbox:close"),_this388._chosenAssets.clear();});}},{key:"_insertAsset",value:function _insertAsset(e,t,i,n){var s=this.editor.model.document.selection;i.removeSelectionAttribute("linkHref"),"image"===e.type?this._insertImage(e):this._insertLink(e,i,n),t||i.setSelection(s.getLastPosition());}},{key:"_insertImage",value:function _insertImage(e){var t=this.editor,_e$attributes=e.attributes,i=_e$attributes.imageFallbackUrl,n=_e$attributes.imageSources,s=_e$attributes.imageTextAlternative,o=_e$attributes.imageWidth,r=_e$attributes.imageHeight,a=_e$attributes.imagePlaceholder;t.execute("insertImage",{source:_objectSpread({src:i,sources:n,alt:s,width:o,height:r},a?{placeholder:a}:null)});}},{key:"_insertLink",value:function _insertLink(e,t,i){var n=this.editor,s=n.model,o=s.document.selection,_e$attributes2=e.attributes,r=_e$attributes2.linkName,a=_e$attributes2.linkHref;if(o.isCollapsed){var _e458=xr(o.getAttributes()),_l15=t.createText(r,_e458);if(!i){var _e459=o.getLastPosition(),_i332=_e459.parent;"paragraph"===_i332.name&&_i332.isEmpty||n.execute("insertParagraph",{position:_e459});var _r39=s.insertContent(_l15);return t.setSelection(_r39),void n.execute("link",a);}var _c14=s.insertContent(_l15);t.setSelection(_c14);}n.execute("link",a);}}]);}(Hr);function vv(e){var _pv=pv(e.data.imageUrls),t=_pv.imageFallbackUrl,i=_pv.imageSources,_e$data$metadata=e.data.metadata,n=_e$data$metadata.description,s=_e$data$metadata.width,o=_e$data$metadata.height,r=_e$data$metadata.blurHash,a=function(e){if(e)try{var _t279="32px",_i333=document.createElement("canvas");_i333.setAttribute("width",_t279),_i333.setAttribute("height",_t279);var _n181=_i333.getContext("2d");if(!_n181)return;var _s130=_n181.createImageData(32,32),_o71=fv(e,32,32);return _s130.data.set(_o71),_n181.putImageData(_s130,0,0),_i333.toDataURL();}catch(e){return;}}(r);return _objectSpread({imageFallbackUrl:t,imageSources:i,imageTextAlternative:n||"",imageWidth:s,imageHeight:o},a?{imagePlaceholder:a}:null);}function yv(e){return{linkName:e.data.name,linkHref:kv(e)};}function kv(e){var t=new URL(e.data.url);return t.searchParams.set("download","true"),t.toString();}var Cv=/*#__PURE__*/function(_Dr48){function Cv(){var _this389;_classCallCheck(this,Cv);for(var _len54=arguments.length,args=new Array(_len54),_key54=0;_key54<_len54;_key54++){args[_key54]=arguments[_key54];}_this389=_callSuper(this,Cv,[].concat(args));_defineProperty(_this389,"_token",void 0);return _this389;}_inherits(Cv,_Dr48);return _createClass(Cv,[{key:"init",value:function init(){var e=this.editor,t=!!e.config.get("ckbox"),i=!!window.CKBox;if(!t&&!i)return;e.config.define("ckbox",{serviceOrigin:"https://api.ckbox.io",defaultUploadCategories:null,ignoreDataId:!1,language:e.locale.uiLanguage,theme:"lark",tokenUrl:e.config.get("cloudServices.tokenUrl")});var n=e.plugins.get("CloudServices"),s=e.config.get("cloudServices.tokenUrl"),o=e.config.get("ckbox.tokenUrl");if(!o)throw new A("ckbox-plugin-missing-token-url",this);this._token=o==s?Promise.resolve(n.token):n.registerTokenUrl(o);}},{key:"getToken",value:function getToken(){return this._token;}},{key:"getWorkspaceId",value:function(){var _getWorkspaceId=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(){var e,t,i;return _regeneratorRuntime().wrap(function _callee9$(_context41){while(1)switch(_context41.prev=_context41.next){case 0:e=(0,this.editor.t)("Cannot access default workspace.");t=this.editor.config.get("ckbox.defaultUploadWorkspaceId");_context41.t0=function(e,t){var _e$value$split=e.value.split("."),_e$value$split2=_slicedToArray(_e$value$split,2),i=_e$value$split2[1],n=JSON.parse(atob(i)),s=n.auth&&n.auth.ckbox&&n.auth.ckbox.workspaces||[n.aud];return t?"superadmin"==(n.auth&&n.auth.ckbox&&n.auth.ckbox.role)||s.includes(t)?t:null:s[0];};_context41.next=5;return this._token;case 5:_context41.t1=_context41.sent;_context41.t2=t;i=(0,_context41.t0)(_context41.t1,_context41.t2);if(!(null==i)){_context41.next=10;break;}throw T("ckbox-access-default-workspace-error"),e;case 10:return _context41.abrupt("return",i);case 11:case"end":return _context41.stop();}},_callee9,this);}));function getWorkspaceId(){return _getWorkspaceId.apply(this,arguments);}return getWorkspaceId;}()},{key:"getCategoryIdForFile",value:function(){var _getCategoryIdForFile=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(e,t){var i,n,s,o,r,a,_e460,_t280,l;return _regeneratorRuntime().wrap(function _callee11$(_context43){while(1)switch(_context43.prev=_context43.next){case 0:i=(0,this.editor.t)("Cannot determine a category for the uploaded file.");n=this.editor.config.get("ckbox.defaultUploadCategories");s=this._getAvailableCategories(t);if(!("string"==typeof e)){_context43.next=10;break;}_context43.next=6;return function(){var _ref112=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10(e,t){var _i334;return _regeneratorRuntime().wrap(function _callee10$(_context42){while(1)switch(_context42.prev=_context42.next){case 0:_context42.prev=0;_context42.next=3;return fetch(e,_objectSpread({method:"HEAD",cache:"force-cache"},t));case 3:_i334=_context42.sent;return _context42.abrupt("return",_i334.ok&&_i334.headers.get("content-type")||"");case 7:_context42.prev=7;_context42.t0=_context42["catch"](0);return _context42.abrupt("return","");case 10:case"end":return _context42.stop();}},_callee10,null,[[0,7]]);}));return function(_x9,_x10){return _ref112.apply(this,arguments);};}()(e,t);case 6:r=_context43.sent;_context43.t0=wv[r];_context43.next=11;break;case 10:_context43.t0=e.name.match(/*#__PURE__*/_wrapRegExp(/\.([^.]+)$/,{ext:1})).groups.ext.toLowerCase();case 11:o=_context43.t0;_context43.next=14;return s;case 14:a=_context43.sent;if(a){_context43.next=17;break;}throw i;case 17:if(!n){_context43.next=24;break;}_e460=Object.keys(n).find(function(e){return n[e].find(function(e){return e.toLowerCase()==o;});});if(!_e460){_context43.next=24;break;}_t280=a.find(function(t){return t.id===_e460||t.name===_e460;});if(_t280){_context43.next=23;break;}throw i;case 23:return _context43.abrupt("return",_t280.id);case 24:l=a.find(function(e){return e.extensions.find(function(e){return e.toLowerCase()==o;});});if(l){_context43.next=27;break;}throw i;case 27:return _context43.abrupt("return",l.id);case 28:case"end":return _context43.stop();}},_callee11,this);}));function getCategoryIdForFile(_x7,_x8){return _getCategoryIdForFile.apply(this,arguments);}return getCategoryIdForFile;}()},{key:"_getAvailableCategories",value:function(){var _getAvailableCategories2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee13(e){var t,i,n,s,o,_e461,_t281,_i335,_n182,r,_r40;return _regeneratorRuntime().wrap(function _callee13$(_context45){while(1)switch(_context45.prev=_context45.next){case 0:_r40=function _r42(){_r40=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12(e){var t;return _regeneratorRuntime().wrap(function _callee12$(_context44){while(1)switch(_context44.prev=_context44.next){case 0:t=new URL("categories",s);t.searchParams.set("limit",String(50));t.searchParams.set("offset",String(e));t.searchParams.set("workspaceId",o);_context44.t0=bv;_context44.t1=t;_context44.t2=n;_context44.next=9;return i;case 9:_context44.t3=_context44.sent.value;_context44.t4={url:_context44.t1,signal:_context44.t2,authorization:_context44.t3};return _context44.abrupt("return",(0,_context44.t0)(_context44.t4));case 12:case"end":return _context44.stop();}},_callee12);}));return _r40.apply(this,arguments);};r=function _r41(_x12){return _r40.apply(this,arguments);};t=this.editor;i=this._token;n=e.signal;s=t.config.get("ckbox.serviceOrigin");_context45.next=8;return this.getWorkspaceId();case 8:o=_context45.sent;_context45.prev=9;_e461=[];_i335=0;case 12:_context45.next=14;return r(_i335);case 14:_n182=_context45.sent;_e461.push.apply(_e461,_toConsumableArray(_n182.items)),_t281=_n182.totalCount-(_i335+50),_i335+=50;case 16:if(_t281>0){_context45.next=12;break;}case 17:return _context45.abrupt("return",_e461);case 20:_context45.prev=20;_context45.t0=_context45["catch"](9);return _context45.abrupt("return",(n.throwIfAborted(),void T("ckbox-fetch-category-http-error")));case 23:case"end":return _context45.stop();}},_callee13,this,[[9,20]]);}));function _getAvailableCategories(_x11){return _getAvailableCategories2.apply(this,arguments);}return _getAvailableCategories;}()}],[{key:"pluginName",get:function get(){return"CKBoxUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return["CloudServices"];}}]);}(Dr);var xv=/*#__PURE__*/function(_Dr49){function xv(){_classCallCheck(this,xv);return _callSuper(this,xv,arguments);}_inherits(xv,_Dr49);return _createClass(xv,[{key:"afterInit",value:function(){var _afterInit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee14(){var e,t,i,n,s,o,r;return _regeneratorRuntime().wrap(function _callee14$(_context46){while(1)switch(_context46.prev=_context46.next){case 0:e=this.editor,t=!!e.config.get("ckbox"),i=!!window.CKBox;if(!(!t&&!i)){_context46.next=3;break;}return _context46.abrupt("return");case 3:n=e.plugins.get(km),s=e.plugins.get(Cv);n.createUploadAdapter=function(t){return new Av(t,e,s);};o=!e.config.get("ckbox.ignoreDataId"),r=e.plugins.get("ImageUploadEditing");o&&r.on("uploadComplete",function(t,_ref113){var i=_ref113.imageElement,n=_ref113.data;e.model.change(function(e){e.setAttribute("ckboxImageId",n.ckboxImageId,i);});});case 7:case"end":return _context46.stop();}},_callee14,this);}));function afterInit(){return _afterInit.apply(this,arguments);}return afterInit;}()}],[{key:"requires",get:function get(){return["ImageUploadEditing","ImageUploadProgress",km,Tv];}},{key:"pluginName",get:function get(){return"CKBoxUploadAdapter";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Av=/*#__PURE__*/function(){function Av(e,t,i){_classCallCheck(this,Av);_defineProperty(this,"loader",void 0);_defineProperty(this,"token",void 0);_defineProperty(this,"editor",void 0);_defineProperty(this,"controller",void 0);_defineProperty(this,"serviceOrigin",void 0);_defineProperty(this,"ckboxUtils",void 0);this.loader=e,this.token=i.getToken(),this.ckboxUtils=i,this.editor=t,this.controller=new AbortController(),this.serviceOrigin=t.config.get("ckbox.serviceOrigin");}return _createClass(Av,[{key:"upload",value:function(){var _upload=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee16(){var _this390=this;var e,t,i,n,s,o;return _regeneratorRuntime().wrap(function _callee16$(_context48){while(1)switch(_context48.prev=_context48.next){case 0:e=this.ckboxUtils;t=this.editor.t;_context48.next=4;return this.loader.file;case 4:i=_context48.sent;_context48.next=7;return e.getCategoryIdForFile(i,{signal:this.controller.signal});case 7:n=_context48.sent;s=new URL("assets",this.serviceOrigin);o=new FormData();_context48.t0=s.searchParams;_context48.next=13;return e.getWorkspaceId();case 13:_context48.t1=_context48.sent;_context48.t0.set.call(_context48.t0,"workspaceId",_context48.t1);o.append("categoryId",n);o.append("file",i);_context48.t2=bv;_context48.t3=s;_context48.t4=o;_context48.t5=function onUploadProgress(e){e.lengthComputable&&(_this390.loader.uploadTotal=e.total,_this390.loader.uploaded=e.loaded);};_context48.t6=this.controller.signal;_context48.next=24;return this.token;case 24:_context48.t7=_context48.sent.value;_context48.t8={method:"POST",url:_context48.t3,data:_context48.t4,onUploadProgress:_context48.t5,signal:_context48.t6,authorization:_context48.t7};return _context48.abrupt("return",(0,_context48.t2)(_context48.t8).then(/*#__PURE__*/function(){var _ref114=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee15(e){var t;return _regeneratorRuntime().wrap(function _callee15$(_context47){while(1)switch(_context47.prev=_context47.next){case 0:t=pv(e.imageUrls);return _context47.abrupt("return",{ckboxImageId:e.id,"default":t.imageFallbackUrl,sources:t.imageSources});case 2:case"end":return _context47.stop();}},_callee15);}));return function(_x13){return _ref114.apply(this,arguments);};}())["catch"](function(){var e=t("Cannot upload file:")+" ".concat(i.name,".");return Promise.reject(e);}));case 27:case"end":return _context48.stop();}},_callee16,this);}));function upload(){return _upload.apply(this,arguments);}return upload;}()},{key:"abort",value:function abort(){this.controller.abort();}}]);}();var Ev="NoPermission";var Tv=/*#__PURE__*/function(_Dr50){function Tv(){_classCallCheck(this,Tv);return _callSuper(this,Tv,arguments);}_inherits(Tv,_Dr50);return _createClass(Tv,[{key:"init",value:function init(){var _this391=this;var e=this.editor;this._shouldBeInitialised()&&(this._checkImagePlugins(),Vv()&&e.commands.add("ckbox",new _v(e)),function(){var _ref115=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee17(e){var t,i,n,_yield$t$getToken,s,o;return _regeneratorRuntime().wrap(function _callee17$(_context49){while(1)switch(_context49.prev=_context49.next){case 0:t=e.plugins.get(Cv);i=e.config.get("ckbox.serviceOrigin");n=new URL("permissions",i);_context49.next=5;return t.getToken();case 5:_yield$t$getToken=_context49.sent;s=_yield$t$getToken.value;_context49.next=9;return bv({url:n,authorization:s,signal:new AbortController().signal});case 9:o=_context49.sent;return _context49.abrupt("return",Object.values(o).some(function(e){return e["asset:create"];}));case 11:case"end":return _context49.stop();}},_callee17);}));return function(_x14){return _ref115.apply(this,arguments);};}()(e).then(function(e){e||_this391._blockImageCommands();}));}},{key:"afterInit",value:function afterInit(){var e=this.editor;this._shouldBeInitialised()&&(e.config.get("ckbox.ignoreDataId")||(this._initSchema(),this._initConversion(),this._initFixers()));}},{key:"_shouldBeInitialised",value:function _shouldBeInitialised(){return!!this.editor.config.get("ckbox")||Vv();}},{key:"_blockImageCommands",value:function _blockImageCommands(){var e=this.editor,t=e.commands.get("uploadImage"),i=e.commands.get("ckboxImageEdit");t&&(t.isAccessAllowed=!1,t.forceDisabled(Ev)),i&&i.forceDisabled(Ev);}},{key:"_checkImagePlugins",value:function _checkImagePlugins(){var e=this.editor;e.plugins.has("ImageBlockEditing")||e.plugins.has("ImageInlineEditing")||T("ckbox-plugin-image-feature-missing",e);}},{key:"_initSchema",value:function _initSchema(){var e=this.editor.model.schema;e.extend("$text",{allowAttributes:"ckboxLinkId"}),e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["ckboxImageId","ckboxLinkId"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["ckboxImageId","ckboxLinkId"]}),e.addAttributeCheck(function(e){if(!e.last.getAttribute("linkHref"))return!1;},"ckboxLinkId");}},{key:"_initConversion",value:function _initConversion(){var e=this.editor;e.conversion["for"]("downcast").add(function(e){e.on("attribute:ckboxLinkId:imageBlock",function(e,t,i){var n=i.writer,s=i.mapper,o=i.consumable;if(!o.consume(t.item,e.name))return;var r=_toConsumableArray(s.toViewElement(t.item).getChildren()).find(function(e){return"a"===e.name;});r&&(t.item.hasAttribute("ckboxLinkId")?n.setAttribute("data-ckbox-resource-id",t.item.getAttribute("ckboxLinkId"),r):n.removeAttribute("data-ckbox-resource-id",r));},{priority:"low"}),e.on("attribute:ckboxLinkId",function(e,t,i){var n=i.writer,s=i.mapper,o=i.consumable;if(o.consume(t.item,e.name)){if(t.attributeOldValue){var _e462=Sv(n,t.attributeOldValue);n.unwrap(s.toViewRange(t.range),_e462);}if(t.attributeNewValue){var _e463=Sv(n,t.attributeNewValue);if(t.item.is("selection")){var _t282=n.document.selection;n.wrap(_t282.getFirstRange(),_e463);}else n.wrap(s.toViewRange(t.range),_e463);}}},{priority:"low"});}),e.conversion["for"]("upcast").add(function(e){e.on("element:a",function(e,t,i){var n=i.writer,s=i.consumable;if(!t.viewItem.getAttribute("href"))return;if(!s.consume(t.viewItem,{attributes:["data-ckbox-resource-id"]}))return;var o=t.viewItem.getAttribute("data-ckbox-resource-id");if(o)if(t.modelRange){var _iterator437=_createForOfIteratorHelper(t.modelRange.getItems()),_step437;try{for(_iterator437.s();!(_step437=_iterator437.n()).done;){var _e464=_step437.value;_e464.is("$textProxy")&&(_e464=_e464.textNode),Iv(_e464)&&n.setAttribute("ckboxLinkId",o,_e464);}}catch(err){_iterator437.e(err);}finally{_iterator437.f();}}else{var _e465=t.modelCursor.nodeBefore||t.modelCursor.parent;n.setAttribute("ckboxLinkId",o,_e465);}},{priority:"low"});}),e.conversion["for"]("downcast").attributeToAttribute({model:"ckboxImageId",view:"data-ckbox-resource-id"}),e.conversion["for"]("upcast").elementToAttribute({model:{key:"ckboxImageId",value:function value(e){return e.getAttribute("data-ckbox-resource-id");}},view:{attributes:{"data-ckbox-resource-id":/[\s\S]+/}}});var t=e.commands.get("replaceImageSource");t&&this.listenTo(t,"cleanupImage",function(e,_ref116){var _ref117=_slicedToArray(_ref116,2),t=_ref117[0],i=_ref117[1];t.removeAttribute("ckboxImageId",i);});}},{key:"_initFixers",value:function _initFixers(){var e=this.editor,t=e.model,i=t.document.selection;t.document.registerPostFixer(function(e){return function(t){var i=!1;var n=e.model,s=e.commands.get("ckbox");if(!s)return i;var _iterator438=_createForOfIteratorHelper(n.document.differ.getChanges()),_step438;try{for(_iterator438.s();!(_step438=_iterator438.n()).done;){var _e466=_step438.value;if("insert"!==_e466.type&&"attribute"!==_e466.type)continue;var _n183="insert"===_e466.type?new tc(_e466.position,_e466.position.getShiftedBy(_e466.length)):_e466.range,_o72="attribute"===_e466.type&&"linkHref"===_e466.attributeKey&&null===_e466.attributeNewValue;var _iterator439=_createForOfIteratorHelper(_n183.getItems()),_step439;try{for(_iterator439.s();!(_step439=_iterator439.n()).done;){var _e467=_step439.value;if(_o72&&_e467.hasAttribute("ckboxLinkId")){t.removeAttribute("ckboxLinkId",_e467),i=!0;continue;}var _n184=Pv(_e467,s._chosenAssets);var _iterator440=_createForOfIteratorHelper(_n184),_step440;try{for(_iterator440.s();!(_step440=_iterator440.n()).done;){var _s131=_step440.value;var _n185="image"===_s131.type?"ckboxImageId":"ckboxLinkId";_s131.id!==_e467.getAttribute(_n185)&&(t.setAttribute(_n185,_s131.id,_e467),i=!0);}}catch(err){_iterator440.e(err);}finally{_iterator440.f();}}}catch(err){_iterator439.e(err);}finally{_iterator439.f();}}}catch(err){_iterator438.e(err);}finally{_iterator438.f();}return i;};}(e)),t.document.registerPostFixer(function(e){return function(t){return!(e.hasAttribute("linkHref")||!e.hasAttribute("ckboxLinkId"))&&(t.removeSelectionAttribute("ckboxLinkId"),!0);};}(i));}}],[{key:"pluginName",get:function get(){return"CKBoxEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return["LinkEditing","PictureEditing",xv,Cv];}}]);}(Dr);function Pv(e,t){var i=e.is("element","imageInline")||e.is("element","imageBlock"),n=e.hasAttribute("linkHref");return _toConsumableArray(t).filter(function(t){return"image"===t.type&&i?t.attributes.imageFallbackUrl===e.getAttribute("src"):"link"===t.type&&n?t.attributes.linkHref===e.getAttribute("linkHref"):void 0;});}function Sv(e,t){var i=e.createAttributeElement("a",{"data-ckbox-resource-id":t},{priority:5});return e.setCustomProperty("link",!0,i),i;}function Iv(e){return!!e.is("$text")||!(!e.is("element","imageInline")&&!e.is("element","imageBlock"));}function Vv(){return!!window.CKBox;}var Rv=/*#__PURE__*/function(_Dr51){function Rv(){_classCallCheck(this,Rv);return _callSuper(this,Rv,arguments);}_inherits(Rv,_Dr51);return _createClass(Rv,null,[{key:"pluginName",get:function get(){return"CKBox";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Tv,rv];}}]);}(Dr);function Ov(e){if(Array.isArray(e)){var _t283=e.map(Ov);return function(e){return _t283.some(function(t){return t(e);});};}if("origin"==e){var _e468=i.window.location.origin;return function(t){return new URL(t,i.document.baseURI).origin==_e468;};}return"function"==typeof e?e:e instanceof RegExp?function(t){return!(!t.match(e)&&!t.replace(/^https?:\/\//,"").match(e));}:function(){return!1;};}var Bv=/*#__PURE__*/function(_Hr11){function Bv(e){var _this392;_classCallCheck(this,Bv);_this392=_callSuper(this,Bv,[e]),_defineProperty(_assertThisInitialized(_this392),"_wrapper",null),_defineProperty(_assertThisInitialized(_this392),"_processInProgress",new Set()),_defineProperty(_assertThisInitialized(_this392),"_canEdit",void 0),_defineProperty(_assertThisInitialized(_this392),"_prepareOptions",void 0),_defineProperty(_assertThisInitialized(_this392),"_updateUiDelayed",Sr(function(){return _this392.editor.ui.update();},0)),_this392.value=!1,_this392._canEdit=function(e){var t=Ov(e);return function(e){return!(!e.is("element","imageInline")&&!e.is("element","imageBlock"))&&(!!e.hasAttribute("ckboxImageId")||!!e.hasAttribute("src")&&t(e.getAttribute("src")));};}(e.config.get("ckbox.allowExternalImagesEditing")),_this392._prepareOptions=io(function(e,t){return _this392._prepareOptionsAbortable(e,t);}),_this392._prepareListeners();return _this392;}_inherits(Bv,_Hr11);return _createClass(Bv,[{key:"refresh",value:function refresh(){var e=this.editor;this.value=this._getValue();var t=e.model.document.selection.getSelectedElement();this.isEnabled=!!t&&this._canEdit(t)&&!this._checkIfElementIsBeingProcessed(t);}},{key:"execute",value:function execute(){var _this393=this;if(this._getValue())return;var e=ro(document,"div",{"class":"ck ckbox-wrapper"});this._wrapper=e,this.value=!0,document.body.appendChild(this._wrapper);var t={element:this.editor.model.document.selection.getSelectedElement(),controller:new AbortController()};this._prepareOptions(t).then(function(t){return window.CKBox.mountImageEditor(e,t);},function(e){var t=_this393.editor,i=t.t;t.plugins.get(Lb).showWarning(i("Failed to determine category of edited image."),{namespace:"ckbox"}),console.error(e),_this393._handleImageEditorClose();});}},{key:"destroy",value:function destroy(){this._handleImageEditorClose(),this._prepareOptions.abort(),this._updateUiDelayed.cancel();var _iterator441=_createForOfIteratorHelper(this._processInProgress.values()),_step441;try{for(_iterator441.s();!(_step441=_iterator441.n()).done;){var _e469=_step441.value;_e469.controller.abort();}}catch(err){_iterator441.e(err);}finally{_iterator441.f();}_superPropGet(Bv,"destroy",this,3)([]);}},{key:"_getValue",value:function _getValue(){return null!==this._wrapper;}},{key:"_prepareOptionsAbortable",value:function(){var _prepareOptionsAbortable2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee18(e,t){var _this394=this;var i,n,s,o,r,a,_t284;return _regeneratorRuntime().wrap(function _callee18$(_context50){while(1)switch(_context50.prev=_context50.next){case 0:i=this.editor,n=i.config.get("ckbox"),s=i.plugins.get(Cv),o=t.element;a=o.getAttribute("ckboxImageId");if(!a){_context50.next=6;break;}r={assetId:a};_context50.next=12;break;case 6:_t284=new URL(o.getAttribute("src"),document.baseURI).href;_context50.t0=_t284;_context50.next=10;return s.getCategoryIdForFile(_t284,{signal:e});case 10:_context50.t1=_context50.sent;r={imageUrl:_context50.t0,uploadCategoryId:_context50.t1};case 12:return _context50.abrupt("return",_objectSpread(_objectSpread(_objectSpread({},r),{},{imageEditing:{allowOverwrite:!1},tokenUrl:n.tokenUrl},n.serviceOrigin&&{serviceOrigin:n.serviceOrigin}),{},{onClose:function onClose(){return _this394._handleImageEditorClose();},onSave:function onSave(e){return _this394._handleImageEditorSave(t,e);}}));case 13:case"end":return _context50.stop();}},_callee18,this);}));function _prepareOptionsAbortable(_x15,_x16){return _prepareOptionsAbortable2.apply(this,arguments);}return _prepareOptionsAbortable;}()},{key:"_prepareListeners",value:function _prepareListeners(){var _this395=this;this.listenTo(this.editor.model.document,"change:data",function(){_this395._getProcessingStatesOfDeletedImages().forEach(function(e){e.controller.abort();});});}},{key:"_getProcessingStatesOfDeletedImages",value:function _getProcessingStatesOfDeletedImages(){var e=[];var _iterator442=_createForOfIteratorHelper(this._processInProgress.values()),_step442;try{for(_iterator442.s();!(_step442=_iterator442.n()).done;){var _t285=_step442.value;"$graveyard"==_t285.element.root.rootName&&e.push(_t285);}}catch(err){_iterator442.e(err);}finally{_iterator442.f();}return e;}},{key:"_checkIfElementIsBeingProcessed",value:function _checkIfElementIsBeingProcessed(e){var _iterator443=_createForOfIteratorHelper(this._processInProgress),_step443;try{for(_iterator443.s();!(_step443=_iterator443.n()).done;){var _t286=_step443.value.element;if(Ls(_t286,e))return!0;}}catch(err){_iterator443.e(err);}finally{_iterator443.f();}return!1;}},{key:"_handleImageEditorClose",value:function _handleImageEditorClose(){this._wrapper&&(this._wrapper.remove(),this._wrapper=null,this.editor.editing.view.focus(),this._updateUiDelayed(),this.refresh());}},{key:"_handleImageEditorSave",value:function _handleImageEditorSave(e,t){var _this396=this;var i=this.editor.locale.t,n=this.editor.plugins.get(Lb),s=this.editor.plugins.get(_m),o=s.add(i("Processing the edited image."));this._processInProgress.add(e),this._showImageProcessingIndicator(e.element,t),this.refresh(),this._waitForAssetProcessed(t.data.id,e.controller.signal).then(function(t){_this396._replaceImage(e.element,t);},function(t){_this396.editor.editing.reconvertItem(e.element),e.controller.signal.aborted||(!t||t instanceof A?n.showWarning(i("Server failed to process the image."),{namespace:"ckbox"}):console.error(t));})["finally"](function(){_this396._processInProgress["delete"](e),s.remove(o),_this396.refresh();});}},{key:"_getAssetStatusFromServer",value:function(){var _getAssetStatusFromServer2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee19(e,t){var i,n,s,o;return _regeneratorRuntime().wrap(function _callee19$(_context51){while(1)switch(_context51.prev=_context51.next){case 0:i=this.editor.plugins.get(Cv);n=new URL("assets/"+e,this.editor.config.get("ckbox.serviceOrigin"));_context51.t0=bv;_context51.t1=n;_context51.t2=t;_context51.next=7;return i.getToken();case 7:_context51.t3=_context51.sent.value;_context51.t4={url:_context51.t1,signal:_context51.t2,authorization:_context51.t3};_context51.next=11;return(0,_context51.t0)(_context51.t4);case 11:s=_context51.sent;o=s.metadata.metadataProcessingStatus;if(!(!o||"queued"==o)){_context51.next=15;break;}throw new A("ckbox-image-not-processed");case 15:return _context51.abrupt("return",{data:_objectSpread({},s)});case 16:case"end":return _context51.stop();}},_callee19,this);}));function _getAssetStatusFromServer(_x17,_x18){return _getAssetStatusFromServer2.apply(this,arguments);}return _getAssetStatusFromServer;}()},{key:"_waitForAssetProcessed",value:function(){var _waitForAssetProcessed2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee20(e,t){var _this397=this;var i;return _regeneratorRuntime().wrap(function _callee20$(_context52){while(1)switch(_context52.prev=_context52.next){case 0:_context52.next=2;return Er(function(){return _this397._getAssetStatusFromServer(e,t);},{signal:t,maxAttempts:5});case 2:i=_context52.sent;if(!("success"!=i.data.metadata.metadataProcessingStatus)){_context52.next=5;break;}throw new A("ckbox-image-processing-failed");case 5:return _context52.abrupt("return",i);case 6:case"end":return _context52.stop();}},_callee20);}));function _waitForAssetProcessed(_x19,_x20){return _waitForAssetProcessed2.apply(this,arguments);}return _waitForAssetProcessed;}()},{key:"_showImageProcessingIndicator",value:function _showImageProcessingIndicator(e,t){var _this398=this;var i=this.editor;i.editing.view.change(function(n){var s=i.editing.mapper.toViewElement(e),o=_this398.editor.plugins.get("ImageUtils").findViewImgElement(s);n.removeStyle("aspect-ratio",o),n.setAttribute("width",t.data.metadata.width,o),n.setAttribute("height",t.data.metadata.height,o),n.setStyle("width","".concat(t.data.metadata.width,"px"),o),n.setStyle("height","".concat(t.data.metadata.height,"px"),o),n.addClass("image-processing",s);});}},{key:"_replaceImage",value:function _replaceImage(e,t){var i=this.editor,_vv=vv(t),n=_vv.imageFallbackUrl,s=_vv.imageSources,o=_vv.imageWidth,r=_vv.imageHeight,a=_vv.imagePlaceholder,l=Array.from(i.model.document.selection.getRanges());i.model.change(function(c){c.setSelection(e,"on"),i.execute("insertImage",{imageType:e.is("element","imageInline")?"imageInline":null,source:_objectSpread(_objectSpread({src:n,sources:s,width:o,height:r},a?{placeholder:a}:null),e.hasAttribute("alt")?{alt:e.getAttribute("alt")}:null)});var d=e.getChildren();e=i.model.document.selection.getSelectedElement();var _iterator444=_createForOfIteratorHelper(d),_step444;try{for(_iterator444.s();!(_step444=_iterator444.n()).done;){var _t287=_step444.value;c.append(c.cloneElement(_t287),e);}}catch(err){_iterator444.e(err);}finally{_iterator444.f();}c.setAttribute("ckboxImageId",t.data.id,e),c.setSelection(l);});}}]);}(Hr);var Mv=/*#__PURE__*/function(_Dr52){function Mv(){_classCallCheck(this,Mv);return _callSuper(this,Mv,arguments);}_inherits(Mv,_Dr52);return _createClass(Mv,[{key:"init",value:function init(){var e=this.editor;e.commands.add("ckboxImageEdit",new Bv(e));}}],[{key:"pluginName",get:function get(){return"CKBoxImageEditEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Tv,Cv,_m,Lb,"ImageUtils","ImageEditing"];}}]);}(Dr);var Lv=/*#__PURE__*/function(_Dr53){function Lv(){_classCallCheck(this,Lv);return _callSuper(this,Lv,arguments);}_inherits(Lv,_Dr53);return _createClass(Lv,[{key:"init",value:function init(){var _this399=this;var e=this.editor;e.ui.componentFactory.add("ckboxImageEdit",function(t){var i=e.commands.get("ckboxImageEdit"),n=e.commands.get("uploadImage"),s=new pg(t),o=t.t;return s.set({icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037H5.06l5.058-5.078L6.617 9.15a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v4.354a3.478 3.478 0 0 1 1.5.049V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.147 2.147 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.642-3.11 2.129 2.129 0 0 0-1.873-.978ZM8.089 17.635v2.388h2.389l7.046-7.046-2.39-2.39-7.045 7.048Zm11.282-6.507a.637.637 0 0 0 .139-.692.603.603 0 0 0-.139-.205l-1.49-1.488a.63.63 0 0 0-.899 0l-1.166 1.163 2.39 2.39 1.165-1.168Z"/></svg>',tooltip:!0}),s.bind("label").to(n,"isAccessAllowed",function(e){return o(e?"Edit image":"You have no image editing permissions.");}),s.bind("isOn").to(i,"value",i,"isEnabled",function(e,t){return e&&t;}),s.bind("isEnabled").to(i),_this399.listenTo(s,"execute",function(){e.execute("ckboxImageEdit"),e.editing.view.focus();}),s;});}}],[{key:"pluginName",get:function get(){return"CKBoxImageEditUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Fv=/*#__PURE__*/function(_Dr54){function Fv(){_classCallCheck(this,Fv);return _callSuper(this,Fv,arguments);}_inherits(Fv,_Dr54);return _createClass(Fv,null,[{key:"pluginName",get:function get(){return"CKBoxImageEdit";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Mv,Lv];}}]);}(Dr);var Nv=/*#__PURE__*/function(_Dr55){function Nv(){_classCallCheck(this,Nv);return _callSuper(this,Nv,arguments);}_inherits(Nv,_Dr55);return _createClass(Nv,[{key:"init",value:function init(){var _this400=this;var e=this.editor;e.ui.componentFactory.add("ckfinder",function(){return _this400._createFileToolbarButton();}),e.ui.componentFactory.add("menuBar:ckfinder",function(){return _this400._createFileMenuBarButton();}),e.plugins.has("ImageInsertUI")&&e.plugins.get("ImageInsertUI").registerIntegration({name:"assetManager",observable:function observable(){return e.commands.get("ckfinder");},buttonViewCreator:function buttonViewCreator(){return _this400._createImageToolbarButton();},formViewCreator:function formViewCreator(){return _this400._createImageDropdownButton();},menuBarButtonViewCreator:function menuBarButtonViewCreator(e){return _this400._createImageMenuBarButton(e?"insertOnly":"insertNested");}});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=new e(t.locale),n=t.commands.get("ckfinder");return i.bind("isEnabled").to(n),i.on("execute",function(){t.execute("ckfinder"),t.editing.view.focus();}),i;}},{key:"_createFileToolbarButton",value:function _createFileToolbarButton(){var e=this.editor.locale.t,t=this._createButton(pg);return t.icon=vm.browseFiles,t.label=e("Insert image or file"),t.tooltip=!0,t;}},{key:"_createImageToolbarButton",value:function _createImageToolbarButton(){var e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(pg);return i.icon=vm.imageAssetManager,i.bind("label").to(t,"isImageSelected",function(t){return e(t?"Replace image with file manager":"Insert image with file manager");}),i.tooltip=!0,i;}},{key:"_createImageDropdownButton",value:function _createImageDropdownButton(){var e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(pg);return i.icon=vm.imageAssetManager,i.withText=!0,i.bind("label").to(t,"isImageSelected",function(t){return e(t?"Replace with file manager":"Insert with file manager");}),i.on("execute",function(){t.dropdownView.isOpen=!1;}),i;}},{key:"_createFileMenuBarButton",value:function _createFileMenuBarButton(){var e=this.editor.locale.t,t=this._createButton(Rg);return t.icon=vm.browseFiles,t.withText=!0,t.label=e("File"),t;}},{key:"_createImageMenuBarButton",value:function _createImageMenuBarButton(e){var t=this.editor.locale.t,i=this.editor.locale.t,n=this._createButton(Rg);switch(n.icon=vm.imageAssetManager,n.withText=!0,e){case"insertOnly":n.label=t("Image");break;case"insertNested":n.label=i("With file manager");}return n;}}],[{key:"pluginName",get:function get(){return"CKFinderUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Dv=/*#__PURE__*/function(_Hr12){function Dv(e){var _this401;_classCallCheck(this,Dv);_this401=_callSuper(this,Dv,[e]),_this401.affectsData=!1,_this401.stopListening(_this401.editor.model.document,"change"),_this401.listenTo(_this401.editor.model.document,"change",function(){return _this401.refresh();},{priority:"low"});return _this401;}_inherits(Dv,_Hr12);return _createClass(Dv,[{key:"refresh",value:function refresh(){var e=this.editor.commands.get("insertImage"),t=this.editor.commands.get("link");this.isEnabled=e.isEnabled||t.isEnabled;}},{key:"execute",value:function execute(){var e=this.editor,t=this.editor.config.get("ckfinder.openerMethod")||"modal";if("popup"!=t&&"modal"!=t)throw new A("ckfinder-unknown-openermethod",e);var i=this.editor.config.get("ckfinder.options")||{};i.chooseFiles=!0;var n=i.onInit;i.language||(i.language=e.locale.uiLanguage),i.onInit=function(t){n&&n(t),t.on("files:choose",function(i){var n=i.data.files.toArray(),s=n.filter(function(e){return!e.isImage();}),o=n.filter(function(e){return e.isImage();});var _iterator445=_createForOfIteratorHelper(s),_step445;try{for(_iterator445.s();!(_step445=_iterator445.n()).done;){var _t288=_step445.value;e.execute("link",_t288.getUrl());}}catch(err){_iterator445.e(err);}finally{_iterator445.f();}var r=[];var _iterator446=_createForOfIteratorHelper(o),_step446;try{for(_iterator446.s();!(_step446=_iterator446.n()).done;){var _e470=_step446.value;var _i336=_e470.getUrl();r.push(_i336||t.request("file:getProxyUrl",{file:_e470}));}}catch(err){_iterator446.e(err);}finally{_iterator446.f();}r.length&&zv(e,r);}),t.on("file:choose:resizedImage",function(t){var i=t.data.resizedUrl;if(i)zv(e,[i]);else{var _t289=e.plugins.get("Notification"),_i337=e.locale.t;_t289.showWarning(_i337("Could not obtain resized image URL."),{title:_i337("Selecting resized image failed"),namespace:"ckfinder"});}});},window.CKFinder[t](i);}}]);}(Hr);function zv(e,t){if(e.commands.get("insertImage").isEnabled)e.execute("insertImage",{source:t});else{var _t290=e.plugins.get("Notification"),_i338=e.locale.t;_t290.showWarning(_i338("Could not insert image at the current position."),{title:_i338("Inserting image failed"),namespace:"ckfinder"});}}var Hv=/*#__PURE__*/function(_Dr56){function Hv(){_classCallCheck(this,Hv);return _callSuper(this,Hv,arguments);}_inherits(Hv,_Dr56);return _createClass(Hv,[{key:"init",value:function init(){var e=this.editor;if(!e.plugins.has("ImageBlockEditing")&&!e.plugins.has("ImageInlineEditing"))throw new A("ckfinder-missing-image-plugin",e);e.commands.add("ckfinder",new Dv(e));}}],[{key:"pluginName",get:function get(){return"CKFinderEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Lb,"LinkEditing"];}}]);}(Dr);var $v=/*#__PURE__*/function(_Dr57){function $v(){_classCallCheck(this,$v);return _callSuper(this,$v,arguments);}_inherits($v,_Dr57);return _createClass($v,null,[{key:"pluginName",get:function get(){return"CKFinder";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return["Link","CKFinderUploadAdapter",Hv,Nv];}}]);}(Dr);var Uv=/*#__PURE__*/function(_Tl8){function Uv(e){var _this402;_classCallCheck(this,Uv);_this402=_callSuper(this,Uv,[e]);_defineProperty(_this402,"domEventType",["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"]);var t=_this402.document;function i(e){return function(i,n){n.preventDefault();var s=n.dropRange?[n.dropRange]:null,o=new v(t,e);t.fire(o,{dataTransfer:n.dataTransfer,method:i.name,targetRanges:s,target:n.target,domEvent:n.domEvent}),o.stop.called&&n.stopPropagation();};}_this402.listenTo(t,"paste",i("clipboardInput"),{priority:"low"}),_this402.listenTo(t,"drop",i("clipboardInput"),{priority:"low"}),_this402.listenTo(t,"dragover",i("dragging"),{priority:"low"});return _this402;}_inherits(Uv,_Tl8);return _createClass(Uv,[{key:"onDomEvent",value:function onDomEvent(e){var t="clipboardData"in e?e.clipboardData:e.dataTransfer,i="drop"==e.type||"paste"==e.type,n={dataTransfer:new Ml(t,{cacheFiles:i})};if("drop"==e.type||"dragover"==e.type){var _t291=yo(e);n.dropRange=_t291&&this.view.domConverter.domRangeToView(_t291);}this.fire(e.type,e,n);}}]);}(Tl);function Wv(e){return((e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;")).includes("</p><p>")||e.includes("<br>"))&&(e="<p>".concat(e,"</p>")),e;}var jv=["figcaption","li"],qv=["ol","ul"];function Gv(e){if(e.is("$text")||e.is("$textProxy"))return e.data;if(e.is("element","img")&&e.hasAttribute("alt"))return e.getAttribute("alt");if(e.is("element","br"))return"\n";var t="",i=null;var _iterator447=_createForOfIteratorHelper(e.getChildren()),_step447;try{for(_iterator447.s();!(_step447=_iterator447.n()).done;){var _n186=_step447.value;t+=Kv(_n186,i)+Gv(_n186),i=_n186;}}catch(err){_iterator447.e(err);}finally{_iterator447.f();}return t;}function Kv(e,t){return t?e.is("element","li")&&!e.isEmpty&&e.getChild(0).is("containerElement")||qv.includes(e.name)&&qv.includes(t.name)?"\n\n":e.is("containerElement")||t.is("containerElement")?jv.includes(e.name)||jv.includes(t.name)?"\n":e.is("element")&&e.getCustomProperty("dataPipeline:transparentRendering")||t.is("element")&&t.getCustomProperty("dataPipeline:transparentRendering")?"":"\n\n":"":"";}var Zv=/*#__PURE__*/function(_Dr58){function Zv(){var _this403;_classCallCheck(this,Zv);for(var _len55=arguments.length,args=new Array(_len55),_key55=0;_key55<_len55;_key55++){args[_key55]=arguments[_key55];}_this403=_callSuper(this,Zv,[].concat(args));_defineProperty(_this403,"_markersToCopy",new Map());return _this403;}_inherits(Zv,_Dr58);return _createClass(Zv,[{key:"_registerMarkerToCopy",value:function _registerMarkerToCopy(e,t){this._markersToCopy.set(e,t);}},{key:"_copySelectedFragmentWithMarkers",value:function _copySelectedFragmentWithMarkers(e,t){var _this404=this;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:function(e){return e.model.getSelectedContent(e.model.document.selection);};return this.editor.model.change(function(n){var s=n.model.document.selection;n.setSelection(t);var o=_this404._insertFakeMarkersIntoSelection(n,n.model.document.selection,e),r=i(n),a=_this404._removeFakeMarkersInsideElement(n,r);for(var _i339=0,_Object$entries5=Object.entries(o);_i339<_Object$entries5.length;_i339++){var _Object$entries5$_i=_slicedToArray(_Object$entries5[_i339],2),_e471=_Object$entries5$_i[0],_t292=_Object$entries5$_i[1];a[_e471]||(a[_e471]=n.createRangeIn(r));var _iterator448=_createForOfIteratorHelper(_t292),_step448;try{for(_iterator448.s();!(_step448=_iterator448.n()).done;){var _e472=_step448.value;n.remove(_e472);}}catch(err){_iterator448.e(err);}finally{_iterator448.f();}}r.markers.clear();for(var _i340=0,_Object$entries6=Object.entries(a);_i340<_Object$entries6.length;_i340++){var _Object$entries6$_i=_slicedToArray(_Object$entries6[_i340],2),_e473=_Object$entries6$_i[0],_t293=_Object$entries6$_i[1];r.markers.set(_e473,_t293);}return n.setSelection(s),r;});}},{key:"_pasteMarkersIntoTransformedElement",value:function _pasteMarkersIntoTransformedElement(e,t){var _this405=this;var i=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(function(e){var n=_this405._insertFakeMarkersElements(e,i),s=t(e),o=_this405._removeFakeMarkersInsideElement(e,s);var _iterator449=_createForOfIteratorHelper(Object.values(n).flat()),_step449;try{for(_iterator449.s();!(_step449=_iterator449.n()).done;){var _t295=_step449.value;e.remove(_t295);}}catch(err){_iterator449.e(err);}finally{_iterator449.f();}for(var _i341=0,_Object$entries7=Object.entries(o);_i341<_Object$entries7.length;_i341++){var _Object$entries7$_i=_slicedToArray(_Object$entries7[_i341],2),_t294=_Object$entries7$_i[0],_i342=_Object$entries7$_i[1];e.model.markers.has(_t294)||e.addMarker(_t294,{usingOperation:!0,affectsData:!0,range:_i342});}return s;});}},{key:"_pasteFragmentWithMarkers",value:function _pasteFragmentWithMarkers(e){var t=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();var _iterator450=_createForOfIteratorHelper(t),_step450;try{for(_iterator450.s();!(_step450=_iterator450.n()).done;){var _i343=_step450.value;e.markers.set(_i343.name,_i343.range);}}catch(err){_iterator450.e(err);}finally{_iterator450.f();}return this.editor.model.insertContent(e);}},{key:"_forceMarkersCopy",value:function _forceMarkersCopy(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0};var n=this._markersToCopy.get(e);this._markersToCopy.set(e,i),t(),n?this._markersToCopy.set(e,n):this._markersToCopy["delete"](e);}},{key:"_isMarkerCopyable",value:function _isMarkerCopyable(e,t){var i=this._getMarkerClipboardConfig(e);if(!i)return!1;if(!t)return!0;var n=i.allowedActions;return"all"===n||n.includes(t);}},{key:"_hasMarkerConfiguration",value:function _hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e);}},{key:"_getMarkerClipboardConfig",value:function _getMarkerClipboardConfig(e){var _e$split=e.split(":"),_e$split2=_slicedToArray(_e$split,1),t=_e$split2[0];return this._markersToCopy.get(t)||null;}},{key:"_insertFakeMarkersIntoSelection",value:function _insertFakeMarkersIntoSelection(e,t,i){var n=this._getCopyableMarkersFromSelection(e,t,i);return this._insertFakeMarkersElements(e,n);}},{key:"_getCopyableMarkersFromSelection",value:function _getCopyableMarkersFromSelection(e,t,i){var _this406=this;var n=Array.from(t.getRanges()),s=new Set(n.flatMap(function(t){return Array.from(e.model.markers.getMarkersIntersectingRange(t));}));return Array.from(s).filter(function(e){if(!_this406._isMarkerCopyable(e.name,i))return!1;var _this406$_getMarkerCl=_this406._getMarkerClipboardConfig(e.name),t=_this406$_getMarkerCl.copyPartiallySelected;if(!t){var _t296=e.getRange();return n.some(function(e){return e.containsRange(_t296,!0);});}return!0;}).map(function(e){return{name:"dragstart"===i?_this406._getUniqueMarkerName(e.name):e.name,range:e.getRange()};});}},{key:"_getPasteMarkersFromRangeMap",value:function _getPasteMarkersFromRangeMap(e){var _this407=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=this.editor.model;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(function(_ref118){var _ref119=_slicedToArray(_ref118,2),e=_ref119[0],n=_ref119[1];if(!_this407._hasMarkerConfiguration(e))return[{name:e,range:n}];if(_this407._isMarkerCopyable(e,t)){var _t297=_this407._getMarkerClipboardConfig(e),_s132=i.markers.has(e)&&"$graveyard"===i.markers.get(e).getRange().root.rootName;return(_t297.duplicateOnPaste||_s132)&&(e=_this407._getUniqueMarkerName(e)),[{name:e,range:n}];}return[];});}},{key:"_insertFakeMarkersElements",value:function _insertFakeMarkersElements(e,t){var i={},n=t.flatMap(function(e){var _e$range=e.range,t=_e$range.start,i=_e$range.end;return[{position:t,marker:e,type:"start"},{position:i,marker:e,type:"end"}];}).sort(function(_ref120,_ref121){var e=_ref120.position;var t=_ref121.position;return e.isBefore(t)?1:-1;});var _iterator451=_createForOfIteratorHelper(n),_step451;try{for(_iterator451.s();!(_step451=_iterator451.n()).done;){var _step451$value=_step451.value,_t298=_step451$value.position,_s133=_step451$value.marker,_o73=_step451$value.type;var _n187=e.createElement("$marker",{"data-name":_s133.name,"data-type":_o73});i[_s133.name]||(i[_s133.name]=[]),i[_s133.name].push(_n187),e.insert(_n187,_t298);}}catch(err){_iterator451.e(err);}finally{_iterator451.f();}return i;}},{key:"_removeFakeMarkersInsideElement",value:function _removeFakeMarkersInsideElement(e,t){var _this408=this;var i=this._getAllFakeMarkersFromElement(e,t).reduce(function(t,i){var n=i.markerElement&&e.createPositionBefore(i.markerElement);var s=t[i.name],o=!1;if(s&&s.start&&s.end){_this408._getMarkerClipboardConfig(i.name).duplicateOnPaste?t[_this408._getUniqueMarkerName(i.name)]=t[i.name]:o=!0,s=null;}return o||(t[i.name]=_objectSpread(_objectSpread({},s),{},_defineProperty({},i.type,n))),i.markerElement&&e.remove(i.markerElement),t;},{});return n=i,o={},s=hs(s=function s(i){return new tc(i.start||e.createPositionFromPath(t,[0]),i.end||e.createPositionAt(t,"end"));}),gs(n,function(e,t,i){ze(o,t,s(e,t,i));}),o;var n,s,o;}},{key:"_getAllFakeMarkersFromElement",value:function _getAllFakeMarkersFromElement(e,t){var i=Array.from(e.createRangeIn(t)).flatMap(function(_ref122){var e=_ref122.item;if(!e.is("element","$marker"))return[];var t=e.getAttribute("data-name"),i=e.getAttribute("data-type");return[{markerElement:e,name:t,type:i}];}),n=[],s=[];var _iterator452=_createForOfIteratorHelper(i),_step452;try{var _loop10=function _loop10(){var e=_step452.value;if("end"===e.type){i.some(function(t){return t.name===e.name&&"start"===t.type;})||n.push({markerElement:null,name:e.name,type:"start"});}if("start"===e.type){i.some(function(t){return t.name===e.name&&"end"===t.type;})||s.unshift({markerElement:null,name:e.name,type:"end"});}};for(_iterator452.s();!(_step452=_iterator452.n()).done;){_loop10();}}catch(err){_iterator452.e(err);}finally{_iterator452.f();}return[].concat(n,_toConsumableArray(i),s);}},{key:"_getUniqueMarkerName",value:function _getUniqueMarkerName(e){var t=e.split(":"),i=k().substring(1,6);return 3===t.length?"".concat(t.slice(0,2).join(":"),":").concat(i):"".concat(t.join(":"),":").concat(i);}}],[{key:"pluginName",get:function get(){return"ClipboardMarkersUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Jv=/*#__PURE__*/function(_Dr59){function Jv(){_classCallCheck(this,Jv);return _callSuper(this,Jv,arguments);}_inherits(Jv,_Dr59);return _createClass(Jv,[{key:"init",value:function init(){this.editor.editing.view.addObserver(Uv),this._setupPasteDrop(),this._setupCopyCut();}},{key:"_fireOutputTransformationEvent",value:function _fireOutputTransformationEvent(e,t,i){var _this409=this;var n=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:"cut"===i},function(){var s=n._copySelectedFragmentWithMarkers(i,t);_this409.fire("outputTransformation",{dataTransfer:e,content:s,method:i});});}},{key:"_setupPasteDrop",value:function _setupPasteDrop(){var _this410=this;var e=this.editor,t=e.model,i=e.editing.view,n=i.document,s=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(n,"clipboardInput",function(t,i){"paste"!=i.method||e.model.canEditAt(e.model.document.selection)||t.stop();},{priority:"highest"}),this.listenTo(n,"clipboardInput",function(e,t){var n=t.dataTransfer;var s;if(t.content)s=t.content;else{var _e474="";n.getData("text/html")?_e474=function(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,function(e,t){return 1==t.length?" ":t;}).replace(/<!--[\s\S]*?-->/g,"");}(n.getData("text/html")):n.getData("text/plain")&&(_e474=Wv(n.getData("text/plain"))),s=_this410.editor.data.htmlProcessor.toView(_e474);}var o=new v(_this410,"inputTransformation");_this410.fire(o,{content:s,dataTransfer:n,targetRanges:t.targetRanges,method:t.method}),o.stop.called&&e.stop(),i.scrollToTheSelection();},{priority:"low"}),this.listenTo(this,"inputTransformation",function(e,i){if(i.content.isEmpty)return;var n=_this410.editor.data.toModel(i.content,"$clipboardHolder");0!=n.childCount&&(e.stop(),t.change(function(){_this410.fire("contentInsertion",{content:n,method:i.method,dataTransfer:i.dataTransfer,targetRanges:i.targetRanges});}));},{priority:"low"}),this.listenTo(this,"contentInsertion",function(e,t){t.resultRange=s._pasteFragmentWithMarkers(t.content);},{priority:"low"});}},{key:"_setupCopyCut",value:function _setupCopyCut(){var _this411=this;var e=this.editor,t=e.model.document,i=e.editing.view.document,n=function n(e,i){var n=i.dataTransfer;i.preventDefault(),_this411._fireOutputTransformationEvent(n,t.selection,e.name);};this.listenTo(i,"copy",n,{priority:"low"}),this.listenTo(i,"cut",function(t,i){e.model.canEditAt(e.model.document.selection)?n(t,i):i.preventDefault();},{priority:"low"}),this.listenTo(this,"outputTransformation",function(t,n){var s=e.data.toView(n.content);i.fire("clipboardOutput",{dataTransfer:n.dataTransfer,content:s,method:n.method});},{priority:"low"}),this.listenTo(i,"clipboardOutput",function(i,n){n.content.isEmpty||(n.dataTransfer.setData("text/html",_this411.editor.data.htmlProcessor.toData(n.content)),n.dataTransfer.setData("text/plain",Gv(n.content))),"cut"==n.method&&e.model.deleteContent(t.selection);},{priority:"low"});}}],[{key:"pluginName",get:function get(){return"ClipboardPipeline";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Zv];}}]);}(Dr);var Qv=/*#__PURE__*/function(_L22){function Qv(){var _this412;_classCallCheck(this,Qv);for(var _len56=arguments.length,args=new Array(_len56),_key56=0;_key56<_len56;_key56++){args[_key56]=arguments[_key56];}_this412=_callSuper(this,Qv,[].concat(args));_defineProperty(_this412,"_stack",[]);return _this412;}_inherits(Qv,_L22);return _createClass(Qv,[{key:"add",value:function add(e,t){var i=this._stack,n=i[0];this._insertDescriptor(e);var s=i[0];n===s||Yv(n,s)||this.fire("change:top",{oldDescriptor:n,newDescriptor:s,writer:t});}},{key:"remove",value:function remove(e,t){var i=this._stack,n=i[0];this._removeDescriptor(e);var s=i[0];n===s||Yv(n,s)||this.fire("change:top",{oldDescriptor:n,newDescriptor:s,writer:t});}},{key:"_insertDescriptor",value:function _insertDescriptor(e){var t=this._stack,i=t.findIndex(function(t){return t.id===e.id;});if(Yv(e,t[i]))return;i>-1&&t.splice(i,1);var n=0;for(;t[n]&&Xv(t[n],e);)n++;t.splice(n,0,e);}},{key:"_removeDescriptor",value:function _removeDescriptor(e){var t=this._stack,i=t.findIndex(function(t){return t.id===e;});i>-1&&t.splice(i,1);}}]);}(L());function Yv(e,t){return e&&t&&e.priority==t.priority&&ey(e.classes)==ey(t.classes);}function Xv(e,t){return e.priority>t.priority||!(e.priority<t.priority)&&ey(e.classes)>ey(t.classes);}function ey(e){return Array.isArray(e)?e.sort().join(","):e;}var ty='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';var iy="ck-widget",ny="ck-widget_selected";function sy(e){return!!e.is("element")&&!!e.getCustomProperty("widget");}function oy(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};if(!e.is("containerElement"))throw new A("widget-to-widget-wrong-element-type",null,{element:e});return t.setAttribute("contenteditable","false",e),t.addClass(iy,e),t.setCustomProperty("widget",!0,e),e.getFillerOffset=gy,t.setCustomProperty("widgetLabel",[],e),i.label&&cy(e,i.label),i.hasSelectionHandle&&function(e,t){var i=t.createUIElement("div",{"class":"ck ck-widget__selection-handle"},function(e){var t=this.toDomElement(e),i=new gg();return i.set("content",ty),i.render(),t.appendChild(i.element),t;});t.insert(t.createPositionAt(e,0),i),t.addClass(["ck-widget_with-selection-handle"],e);}(e,t),ly(e,t),e;}function ry(e,t,i){if(t.classes&&i.addClass(gr(t.classes),e),t.attributes)for(var _n188 in t.attributes)i.setAttribute(_n188,t.attributes[_n188],e);}function ay(e,t,i){if(t.classes&&i.removeClass(gr(t.classes),e),t.attributes)for(var _n189 in t.attributes)i.removeAttribute(_n189,e);}function ly(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:ry;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:ay;var s=new Qv();s.on("change:top",function(t,s){s.oldDescriptor&&n(e,s.oldDescriptor,s.writer),s.newDescriptor&&i(e,s.newDescriptor,s.writer);});t.setCustomProperty("addHighlight",function(e,t,i){return s.add(t,i);},e),t.setCustomProperty("removeHighlight",function(e,t,i){return s.remove(t,i);},e);}function cy(e,t){e.getCustomProperty("widgetLabel").push(t);}function dy(e){return e.getCustomProperty("widgetLabel").reduce(function(e,t){return"function"==typeof t?e?e+". "+t():t():e?e+". "+t:t;},"");}function uy(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],e),t.setAttribute("role","textbox",e),t.setAttribute("tabindex","-1",e),i.label&&t.setAttribute("aria-label",i.label,e),t.setAttribute("contenteditable",e.isReadOnly?"false":"true",e),e.on("change:isReadOnly",function(i,n,s){t.setAttribute("contenteditable",s?"false":"true",e);}),e.on("change:isFocused",function(i,n,s){s?t.addClass("ck-editor__nested-editable_focused",e):t.removeClass("ck-editor__nested-editable_focused",e);}),ly(e,t),e;}function hy(e,t){var i=e.getSelectedElement();if(i){var _n190=_y(e);if(_n190)return t.createRange(t.createPositionAt(i,_n190));}return t.schema.findOptimalInsertionRange(e);}function my(e,t){return function(i,n){var s=n.mapper,o=n.viewPosition,r=s.findMappedViewAncestor(o);if(!t(r))return;var a=s.toModelElement(r);n.modelPosition=e.createPositionAt(a,o.isAtStart?"before":"after");};}function gy(){return null;}function fy(e){var t=function t(e){var _e$ownerDocument$defa=e.ownerDocument.defaultView.getComputedStyle(e),t=_e$ownerDocument$defa.width,i=_e$ownerDocument$defa.paddingLeft,n=_e$ownerDocument$defa.paddingRight;return parseFloat(t)-(parseFloat(i)||0)-(parseFloat(n)||0);},i=e.parentElement;if(!i)return 0;var n=t(i);var s=0,o=i;for(;isNaN(n);){if(o=o.parentElement,++s>5)return 0;n=t(o);}return n;}function py(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:new Eo(e);var i=fy(e);return i?t.width/i*100:0;}var by="widget-type-around";function wy(e,t,i){return!!e&&sy(e)&&!i.isInline(t);}function _y(e){return e.getAttribute(by);}var vy=["before","after"],yy=new DOMParser().parseFromString('<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',"image/svg+xml").firstChild,ky="ck-widget__type-around_disabled";var Cy=/*#__PURE__*/function(_Dr60){function Cy(){var _this413;_classCallCheck(this,Cy);for(var _len57=arguments.length,args=new Array(_len57),_key57=0;_key57<_len57;_key57++){args[_key57]=arguments[_key57];}_this413=_callSuper(this,Cy,[].concat(args));_defineProperty(_this413,"_currentFakeCaretModelElement",null);return _this413;}_inherits(Cy,_Dr60);return _createClass(Cy,[{key:"init",value:function init(){var e=this.editor,t=e.editing.view;this.on("change:isEnabled",function(i,n,s){t.change(function(e){var _iterator453=_createForOfIteratorHelper(t.document.roots),_step453;try{for(_iterator453.s();!(_step453=_iterator453.n()).done;){var _i344=_step453.value;s?e.removeClass(ky,_i344):e.addClass(ky,_i344);}}catch(err){_iterator453.e(err);}finally{_iterator453.f();}}),s||e.model.change(function(e){e.removeSelectionAttribute(by);});}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration();}},{key:"destroy",value:function destroy(){_superPropGet(Cy,"destroy",this,3)([]),this._currentFakeCaretModelElement=null;}},{key:"_insertParagraph",value:function _insertParagraph(e,t){var i=this.editor,n=i.editing.view,s=i.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);i.execute("insertParagraph",{position:i.model.createPositionAt(e,t),attributes:s}),n.focus(),n.scrollToTheSelection();}},{key:"_listenToIfEnabled",value:function _listenToIfEnabled(e,t,i,n){var _this414=this;this.listenTo(e,t,function(){_this414.isEnabled&&i.apply(void 0,arguments);},n);}},{key:"_insertParagraphAccordingToFakeCaretPosition",value:function _insertParagraphAccordingToFakeCaretPosition(){var e=this.editor.model.document.selection,t=_y(e);if(!t)return!1;var i=e.getSelectedElement();return this._insertParagraph(i,t),!0;}},{key:"_enableTypeAroundUIInjection",value:function _enableTypeAroundUIInjection(){var _this415=this;var e=this.editor,t=e.model.schema,i=e.locale.t,n={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",function(e,s,o){var r=o.mapper.toViewElement(s.item);if(r&&wy(r,s.item,t)){!function(e,t,i){var n=e.createUIElement("div",{"class":"ck ck-reset_all ck-widget__type-around"},function(e){var i=this.toDomElement(e);return function(e,t){for(var _i345=0,_vy=vy;_i345<_vy.length;_i345++){var _i346=_vy[_i345];var _n191=new Hm({tag:"div",attributes:{"class":["ck","ck-widget__type-around__button","ck-widget__type-around__button_".concat(_i346)],title:t[_i346],"aria-hidden":"true"},children:[e.ownerDocument.importNode(yy,!0)]});e.appendChild(_n191.render());}}(i,t),function(e){var t=new Hm({tag:"div",attributes:{"class":["ck","ck-widget__type-around__fake-caret"]}});e.appendChild(t.render());}(i),i;});e.insert(e.createPositionAt(i,"end"),n);}(o.writer,n,r);r.getCustomProperty("widgetLabel").push(function(){return _this415.isEnabled?i("Press Enter to type after or press Shift + Enter to type before the widget"):"";});}},{priority:"low"});}},{key:"_enableTypeAroundFakeCaretActivationUsingKeyboardArrows",value:function _enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){var _this416=this;var e=this.editor,t=e.model,i=t.document.selection,n=t.schema,s=e.editing.view;function o(e){return"ck-widget_type-around_show-fake-caret_".concat(e);}this._listenToIfEnabled(s.document,"arrowKey",function(e,t){_this416._handleArrowKeyPress(e,t);},{context:[sy,"$text"],priority:"high"}),this._listenToIfEnabled(i,"change:range",function(t,i){i.directChange&&e.model.change(function(e){e.removeSelectionAttribute(by);});}),this._listenToIfEnabled(t.document,"change:data",function(){var t=i.getSelectedElement();if(t){if(wy(e.editing.mapper.toViewElement(t),t,n))return;}e.model.change(function(e){e.removeSelectionAttribute(by);});}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",function(e,t,i){var s=i.writer;if(_this416._currentFakeCaretModelElement){var _e475=i.mapper.toViewElement(_this416._currentFakeCaretModelElement);_e475&&(s.removeClass(vy.map(o),_e475),_this416._currentFakeCaretModelElement=null);}var r=t.selection.getSelectedElement();if(!r)return;var a=i.mapper.toViewElement(r);if(!wy(a,r,n))return;var l=_y(t.selection);l&&(s.addClass(o(l),a),_this416._currentFakeCaretModelElement=r);}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",function(t,i,n){n||e.model.change(function(e){e.removeSelectionAttribute(by);});});}},{key:"_handleArrowKeyPress",value:function _handleArrowKeyPress(e,t){var i=this.editor,n=i.model,s=n.document.selection,o=n.schema,r=i.editing.view,a=dr(t.keyCode,i.locale.contentLanguageDirection),l=r.document.selection.getSelectedElement();var c;wy(l,i.editing.mapper.toModelElement(l),o)?c=this._handleArrowKeyPressOnSelectedWidget(a):s.isCollapsed?c=this._handleArrowKeyPressWhenSelectionNextToAWidget(a):t.shiftKey||(c=this._handleArrowKeyPressWhenNonCollapsedSelection(a)),c&&(t.preventDefault(),e.stop());}},{key:"_handleArrowKeyPressOnSelectedWidget",value:function _handleArrowKeyPressOnSelectedWidget(e){var t=this.editor.model,i=_y(t.document.selection);return t.change(function(t){if(!i)return t.setSelectionAttribute(by,e?"after":"before"),!0;if(!(i===(e?"after":"before")))return t.removeSelectionAttribute(by),!0;return!1;});}},{key:"_handleArrowKeyPressWhenSelectionNextToAWidget",value:function _handleArrowKeyPressWhenSelectionNextToAWidget(e){var t=this.editor,i=t.model,n=i.schema,s=t.plugins.get("Widget"),o=s._getObjectElementNextToSelection(e);return!!wy(t.editing.mapper.toViewElement(o),o,n)&&(i.change(function(t){s._setSelectionOverElement(o),t.setSelectionAttribute(by,e?"before":"after");}),!0);}},{key:"_handleArrowKeyPressWhenNonCollapsedSelection",value:function _handleArrowKeyPressWhenNonCollapsedSelection(e){var t=this.editor,i=t.model,n=i.schema,s=t.editing.mapper,o=i.document.selection,r=e?o.getLastPosition().nodeBefore:o.getFirstPosition().nodeAfter;return!!wy(s.toViewElement(r),r,n)&&(i.change(function(t){t.setSelection(r,"on"),t.setSelectionAttribute(by,e?"after":"before");}),!0);}},{key:"_enableInsertingParagraphsOnButtonClick",value:function _enableInsertingParagraphsOnButtonClick(){var _this417=this;var e=this.editor,t=e.editing.view;this._listenToIfEnabled(t.document,"mousedown",function(i,n){var s=n.domTarget.closest(".ck-widget__type-around__button");if(!s)return;var o=function(e){return e.classList.contains("ck-widget__type-around__button_before")?"before":"after";}(s),r=function(e,t){var i=e.closest(".ck-widget");return t.mapDomToView(i);}(s,t.domConverter),a=e.editing.mapper.toModelElement(r);_this417._insertParagraph(a,o),n.preventDefault(),i.stop();});}},{key:"_enableInsertingParagraphsOnEnterKeypress",value:function _enableInsertingParagraphsOnEnterKeypress(){var _this418=this;var e=this.editor,t=e.model.document.selection,i=e.editing.view;this._listenToIfEnabled(i.document,"enter",function(i,n){if("atTarget"!=i.eventPhase)return;var s=t.getSelectedElement(),o=e.editing.mapper.toViewElement(s),r=e.model.schema;var a;_this418._insertParagraphAccordingToFakeCaretPosition()?a=!0:wy(o,s,r)&&(_this418._insertParagraph(s,n.isSoft?"before":"after"),a=!0),a&&(n.preventDefault(),i.stop());},{context:sy});}},{key:"_enableInsertingParagraphsOnTypingKeystroke",value:function _enableInsertingParagraphsOnTypingKeystroke(){var _this419=this;var e=this.editor.editing.view.document;this._listenToIfEnabled(e,"insertText",function(t,i){_this419._insertParagraphAccordingToFakeCaretPosition()&&(i.selection=e.selection);},{priority:"high"}),o.isAndroid?this._listenToIfEnabled(e,"keydown",function(e,t){229==t.keyCode&&_this419._insertParagraphAccordingToFakeCaretPosition();}):this._listenToIfEnabled(e,"compositionstart",function(){_this419._insertParagraphAccordingToFakeCaretPosition();},{priority:"high"});}},{key:"_enableDeleteIntegration",value:function _enableDeleteIntegration(){var e=this.editor,t=e.editing.view,i=e.model,n=i.schema;this._listenToIfEnabled(t.document,"delete",function(t,s){if("atTarget"!=t.eventPhase)return;var o=_y(i.document.selection);if(!o)return;var r=s.direction,a=i.document.selection.getSelectedElement(),l="forward"==r;if("before"===o===l)e.execute("delete",{selection:i.createSelection(a,"on")});else{var _t299=n.getNearestSelectionRange(i.createPositionAt(a,o),r);if(_t299)if(_t299.isCollapsed){var _s134=i.createSelection(_t299.start);if(i.modifySelection(_s134,{direction:r}),_s134.focus.isEqual(_t299.start)){var _e476=function(e,t){var i=t;var _iterator454=_createForOfIteratorHelper(t.getAncestors({parentFirst:!0})),_step454;try{for(_iterator454.s();!(_step454=_iterator454.n()).done;){var _n192=_step454.value;if(_n192.childCount>1||e.isLimit(_n192))break;i=_n192;}}catch(err){_iterator454.e(err);}finally{_iterator454.f();}return i;}(n,_t299.start.parent);i.deleteContent(i.createSelection(_e476,"on"),{doNotAutoparagraph:!0});}else i.change(function(i){i.setSelection(_t299),e.execute(l?"deleteForward":"delete");});}else i.change(function(i){i.setSelection(_t299),e.execute(l?"deleteForward":"delete");});}s.preventDefault(),t.stop();},{context:sy});}},{key:"_enableInsertContentIntegration",value:function _enableInsertContentIntegration(){var e=this.editor,t=this.editor.model,i=t.document.selection;this._listenToIfEnabled(e.model,"insertContent",function(e,_ref123){var _ref124=_slicedToArray(_ref123,2),n=_ref124[0],s=_ref124[1];if(s&&!s.is("documentSelection"))return;var o=_y(i);return o?(e.stop(),t.change(function(e){var s=i.getSelectedElement(),r=t.createPositionAt(s,o),a=e.createSelection(r),l=t.insertContent(n,a);return e.setSelection(a),l;})):void 0;},{priority:"high"});}},{key:"_enableInsertObjectIntegration",value:function _enableInsertObjectIntegration(){var e=this.editor,t=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",function(e,i){var _i347=_slicedToArray(i,3),n=_i347[1],_i347$=_i347[2],s=_i347$===void 0?{}:_i347$;if(n&&!n.is("documentSelection"))return;var o=_y(t);o&&(s.findOptimalPosition=o,i[3]=s);},{priority:"high"});}},{key:"_enableDeleteContentIntegration",value:function _enableDeleteContentIntegration(){var e=this.editor,t=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",function(e,_ref125){var _ref126=_slicedToArray(_ref125,1),i=_ref126[0];if(i&&!i.is("documentSelection"))return;_y(t)&&e.stop();},{priority:"high"});}}],[{key:"pluginName",get:function get(){return"WidgetTypeAround";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[K_,Rw];}}]);}(Dr);function xy(e){var t=e.model;return function(i,n){var s=n.keyCode==nr.arrowup,o=n.keyCode==nr.arrowdown,r=n.shiftKey,a=t.document.selection;if(!s&&!o)return;var l=o;if(r&&function(e,t){return!e.isCollapsed&&e.isBackward==t;}(a,l))return;var c=function(e,t,i){var n=e.model;if(i){var _e477=t.isCollapsed?t.focus:t.getLastPosition(),_i348=Ay(n,_e477,"forward");if(!_i348)return null;var _s135=n.createRange(_e477,_i348),_o74=Ey(n.schema,_s135,"backward");return _o74?n.createRange(_e477,_o74):null;}{var _e478=t.isCollapsed?t.focus:t.getFirstPosition(),_i349=Ay(n,_e478,"backward");if(!_i349)return null;var _s136=n.createRange(_i349,_e478),_o75=Ey(n.schema,_s136,"forward");return _o75?n.createRange(_o75,_e478):null;}}(e,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return;}(c.isCollapsed||function(e,t,i){var n=e.model,s=e.view.domConverter;if(i){var _e479=n.createSelection(t.start);n.modifySelection(_e479),_e479.focus.isAtEnd||t.start.isEqual(_e479.focus)||(t=n.createRange(_e479.focus,t.end));}var o=e.mapper.toViewRange(t),r=s.viewRangeToDom(o),a=Eo.getDomRangeRects(r);var l;var _iterator455=_createForOfIteratorHelper(a),_step455;try{for(_iterator455.s();!(_step455=_iterator455.n()).done;){var _e480=_step455.value;if(void 0!==l){if(Math.round(_e480.top)>=l)return!1;l=Math.max(l,Math.round(_e480.bottom));}else l=Math.round(_e480.bottom);}}catch(err){_iterator455.e(err);}finally{_iterator455.f();}return!0;}(e,c,l))&&(t.change(function(e){var i=l?c.end:c.start;if(r){var _n193=t.createSelection(a.anchor);_n193.setFocus(i),e.setSelection(_n193);}else e.setSelection(i);}),i.stop(),n.preventDefault(),n.stopPropagation());}};}function Ay(e,t,i){var n=e.schema,s=e.createRangeIn(t.root),o="forward"==i?"elementStart":"elementEnd";var _iterator456=_createForOfIteratorHelper(s.getWalker({startPosition:t,direction:i})),_step456;try{for(_iterator456.s();!(_step456=_iterator456.n()).done;){var _step456$value=_step456.value,_e481=_step456$value.previousPosition,r=_step456$value.item,_a23=_step456$value.type;if(n.isLimit(r)&&!n.isInline(r))return _e481;if(_a23==o&&n.isBlock(r))return null;}}catch(err){_iterator456.e(err);}finally{_iterator456.f();}return null;}function Ey(e,t,i){var n="backward"==i?t.end:t.start;if(e.checkChild(n,"$text"))return n;var _iterator457=_createForOfIteratorHelper(t.getWalker({direction:i})),_step457;try{for(_iterator457.s();!(_step457=_iterator457.n()).done;){var _n194=_step457.value.nextPosition;if(e.checkChild(_n194,"$text"))return _n194;}}catch(err){_iterator457.e(err);}finally{_iterator457.f();}return null;}var Ty=/*#__PURE__*/function(_Dr61){function Ty(){var _this420;_classCallCheck(this,Ty);for(var _len58=arguments.length,args=new Array(_len58),_key58=0;_key58<_len58;_key58++){args[_key58]=arguments[_key58];}_this420=_callSuper(this,Ty,[].concat(args));_defineProperty(_this420,"_previouslySelected",new Set());return _this420;}_inherits(Ty,_Dr61);return _createClass(Ty,[{key:"init",value:function init(){var _this421=this;var e=this.editor,t=e.editing.view,i=t.document,n=e.t;this.editor.editing.downcastDispatcher.on("selection",function(t,i,n){var s=n.writer,o=i.selection;if(o.isCollapsed)return;var r=o.getSelectedElement();if(!r)return;var a=e.editing.mapper.toViewElement(r);sy(a)&&n.consumable.consume(o,"selection")&&s.setSelection(s.createRangeOn(a),{fake:!0,label:dy(a)});}),this.editor.editing.downcastDispatcher.on("selection",function(e,t,i){_this421._clearPreviouslySelectedWidgets(i.writer);var n=i.writer,s=n.document.selection;var o=null;var _iterator458=_createForOfIteratorHelper(s.getRanges()),_step458;try{for(_iterator458.s();!(_step458=_iterator458.n()).done;){var _e482=_step458.value;var _iterator459=_createForOfIteratorHelper(_e482),_step459;try{for(_iterator459.s();!(_step459=_iterator459.n()).done;){var _t300=_step459.value;var _e483=_t300.item;sy(_e483)&&!Py(_e483,o)&&(n.addClass(ny,_e483),_this421._previouslySelected.add(_e483),o=_e483);}}catch(err){_iterator459.e(err);}finally{_iterator459.f();}}}catch(err){_iterator458.e(err);}finally{_iterator458.f();}},{priority:"low"}),t.addObserver(Wu),this.listenTo(i,"mousedown",function(){return _this421._onMousedown.apply(_this421,arguments);}),this.listenTo(i,"arrowKey",function(){_this421._handleSelectionChangeOnArrowKeyPress.apply(_this421,arguments);},{context:[sy,"$text"]}),this.listenTo(i,"arrowKey",function(){_this421._preventDefaultOnArrowKeyPress.apply(_this421,arguments);},{context:"$root"}),this.listenTo(i,"arrowKey",xy(this.editor.editing),{context:"$text"}),this.listenTo(i,"delete",function(e,t){_this421._handleDelete("forward"==t.direction)&&(t.preventDefault(),e.stop());},{context:"$root"}),this.listenTo(i,"tab",function(e,t){"atTarget"==e.eventPhase&&(t.shiftKey||_this421._selectFirstNestedEditable()&&(t.preventDefault(),e.stop()));},{context:sy,priority:"low"}),this.listenTo(i,"tab",function(e,t){t.shiftKey&&_this421._selectAncestorWidget()&&(t.preventDefault(),e.stop());},{priority:"low"}),this.listenTo(i,"keydown",function(e,t){t.keystroke==nr.esc&&_this421._selectAncestorWidget()&&(t.preventDefault(),e.stop());},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:n("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:n("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:n("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:n("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:n("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:n("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]});}},{key:"_onMousedown",value:function _onMousedown(e,t){var i=this.editor,n=i.editing.view,s=n.document;var r=t.target;if(!r)return;if(t.domEvent.detail>=3)return void(this._selectBlockContent(r)&&t.preventDefault());if(!sy(r)){var _e484=function(e){var t=e;for(;t;){if(t.is("editableElement")||sy(t))return t;t=t.parent;}return null;}(r);if(!_e484)return;if(sy(_e484))r=_e484;else{var _e485=function(e,t){var i=yo(t.domEvent);var n=null;n=i?e.domConverter.domRangeToView(i):e.createRange(e.createPositionAt(t.target,0));if(!n)return null;var s=n.start;if(!s.parent)return null;var o=s.parent;s.parent.is("editableElement")&&(s.isAtEnd&&s.nodeBefore?o=s.nodeBefore:s.isAtStart&&s.nodeAfter&&(o=s.nodeAfter));if(o.is("$text"))return o.parent;return o;}(n,t);if(!_e485||!sy(_e485))return;r=_e485;}}o.isAndroid&&t.preventDefault(),s.isFocused||n.focus();var a=i.editing.mapper.toModelElement(r);this._setSelectionOverElement(a);}},{key:"_selectBlockContent",value:function _selectBlockContent(e){var t=this.editor,i=t.model,n=t.editing.mapper,s=i.schema,o=n.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),r=function(e,t){var _iterator460=_createForOfIteratorHelper(e.getAncestors({includeSelf:!0,parentFirst:!0})),_step460;try{for(_iterator460.s();!(_step460=_iterator460.n()).done;){var _i350=_step460.value;if(t.checkChild(_i350,"$text"))return _i350;if(t.isLimit(_i350)&&!t.isObject(_i350))break;}}catch(err){_iterator460.e(err);}finally{_iterator460.f();}return null;}(n.toModelElement(o),i.schema);return!!r&&(i.change(function(e){var t=s.isLimit(r)?null:function(e,t){var i=new Gl({startPosition:e});var _iterator461=_createForOfIteratorHelper(i),_step461;try{for(_iterator461.s();!(_step461=_iterator461.n()).done;){var _e486=_step461.value.item;if(t.isLimit(_e486)||!_e486.is("element"))return null;if(t.checkChild(_e486,"$text"))return _e486;}}catch(err){_iterator461.e(err);}finally{_iterator461.f();}return null;}(e.createPositionAfter(r),s),i=e.createPositionAt(r,0),n=t?e.createPositionAt(t,0):e.createPositionAt(r,"end");e.setSelection(e.createRange(i,n));}),!0);}},{key:"_handleSelectionChangeOnArrowKeyPress",value:function _handleSelectionChangeOnArrowKeyPress(e,t){var i=t.keyCode,n=this.editor.model,s=n.schema,o=n.document.selection,r=o.getSelectedElement(),a=cr(i,this.editor.locale.contentLanguageDirection),l="down"==a||"right"==a,c="up"==a||"down"==a;if(r&&s.isObject(r)){var _i351=l?o.getLastPosition():o.getFirstPosition(),_r43=s.getNearestSelectionRange(_i351,l?"forward":"backward");return void(_r43&&(n.change(function(e){e.setSelection(_r43);}),t.preventDefault(),e.stop()));}if(!o.isCollapsed&&!t.shiftKey){var _i352=o.getFirstPosition(),_r44=o.getLastPosition(),_a24=_i352.nodeAfter,_c15=_r44.nodeBefore;return void((_a24&&s.isObject(_a24)||_c15&&s.isObject(_c15))&&(n.change(function(e){e.setSelection(l?_r44:_i352);}),t.preventDefault(),e.stop()));}if(!o.isCollapsed)return;var d=this._getObjectElementNextToSelection(l);if(d&&s.isObject(d)){if(s.isInline(d)&&c)return;this._setSelectionOverElement(d),t.preventDefault(),e.stop();}}},{key:"_preventDefaultOnArrowKeyPress",value:function _preventDefaultOnArrowKeyPress(e,t){var i=this.editor.model,n=i.schema,s=i.document.selection.getSelectedElement();s&&n.isObject(s)&&(t.preventDefault(),e.stop());}},{key:"_handleDelete",value:function _handleDelete(e){var _this422=this;var t=this.editor.model.document.selection;if(!this.editor.model.canEditAt(t))return;if(!t.isCollapsed)return;var i=this._getObjectElementNextToSelection(e);return i?(this.editor.model.change(function(e){var n=t.anchor.parent;for(;n.isEmpty;){var _t301=n;n=_t301.parent,e.remove(_t301);}_this422._setSelectionOverElement(i);}),!0):void 0;}},{key:"_setSelectionOverElement",value:function _setSelectionOverElement(e){this.editor.model.change(function(t){t.setSelection(t.createRangeOn(e));});}},{key:"_getObjectElementNextToSelection",value:function _getObjectElementNextToSelection(e){var t=this.editor.model,i=t.schema,n=t.document.selection,s=t.createSelection(n);if(t.modifySelection(s,{direction:e?"forward":"backward"}),s.isEqual(n))return null;var o=e?s.focus.nodeBefore:s.focus.nodeAfter;return o&&i.isObject(o)?o:null;}},{key:"_clearPreviouslySelectedWidgets",value:function _clearPreviouslySelectedWidgets(e){var _iterator462=_createForOfIteratorHelper(this._previouslySelected),_step462;try{for(_iterator462.s();!(_step462=_iterator462.n()).done;){var _t302=_step462.value;e.removeClass(ny,_t302);}}catch(err){_iterator462.e(err);}finally{_iterator462.f();}this._previouslySelected.clear();}},{key:"_selectFirstNestedEditable",value:function _selectFirstNestedEditable(){var e=this.editor,t=this.editor.editing.view.document;var _iterator463=_createForOfIteratorHelper(t.selection.getFirstRange().getItems()),_step463;try{var _loop11=function _loop11(){var i=_step463.value;if(i.is("editableElement")){var _t303=e.editing.mapper.toModelElement(i);if(!_t303)return 0;// continue
var _n195=e.model.createPositionAt(_t303,0),_s137=e.model.schema.getNearestSelectionRange(_n195,"forward");return{v:(e.model.change(function(e){e.setSelection(_s137);}),!0)};}},_ret2;for(_iterator463.s();!(_step463=_iterator463.n()).done;){_ret2=_loop11();if(_ret2===0)continue;if(_ret2)return _ret2.v;}}catch(err){_iterator463.e(err);}finally{_iterator463.f();}return!1;}},{key:"_selectAncestorWidget",value:function _selectAncestorWidget(){var e=this.editor,t=e.editing.mapper,i=e.editing.view.document.selection.getFirstPosition().parent,n=(i.is("$text")?i.parent:i).findAncestor(sy);if(!n)return!1;var s=t.toModelElement(n);return!!s&&(e.model.change(function(e){e.setSelection(s,"on");}),!0);}}],[{key:"pluginName",get:function get(){return"Widget";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Cy,Rw];}}]);}(Dr);function Py(e,t){return!!t&&Array.from(e.getAncestors()).includes(t);}var Sy=/*#__PURE__*/function(_Dr62){function Sy(){var _this423;_classCallCheck(this,Sy);for(var _len59=arguments.length,args=new Array(_len59),_key59=0;_key59<_len59;_key59++){args[_key59]=arguments[_key59];}_this423=_callSuper(this,Sy,[].concat(args));_defineProperty(_this423,"_toolbarDefinitions",new Map());_defineProperty(_this423,"_balloon",void 0);return _this423;}_inherits(Sy,_Dr62);return _createClass(Sy,[{key:"init",value:function init(){var _this424=this;var e=this.editor;if(e.plugins.has("BalloonToolbar")){var _t304=e.plugins.get("BalloonToolbar");this.listenTo(_t304,"show",function(t){(function(e){var t=e.getSelectedElement();return!(!t||!sy(t));})(e.editing.view.document.selection)&&t.stop();},{priority:"high"});}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",function(){_this424._updateToolbarsVisibility();}),this.listenTo(e.ui,"update",function(){_this424._updateToolbarsVisibility();}),this.listenTo(e.ui.focusTracker,"change:isFocused",function(){_this424._updateToolbarsVisibility();},{priority:"low"});}},{key:"destroy",value:function destroy(){_superPropGet(Sy,"destroy",this,3)([]);var _iterator464=_createForOfIteratorHelper(this._toolbarDefinitions.values()),_step464;try{for(_iterator464.s();!(_step464=_iterator464.n()).done;){var _e487=_step464.value;_e487.view.destroy();}}catch(err){_iterator464.e(err);}finally{_iterator464.f();}}},{key:"register",value:function register(e,_ref127){var _this425=this;var t=_ref127.ariaLabel,i=_ref127.items,n=_ref127.getRelatedElement,_ref127$balloonClassN=_ref127.balloonClassName,s=_ref127$balloonClassN===void 0?"ck-toolbar-container":_ref127$balloonClassN;if(!i.length)return void E("widget-toolbar-no-items",{toolbarId:e});var o=this.editor,r=o.t,a=new Kf(o.locale);if(a.ariaLabel=t||r("Widget toolbar"),this._toolbarDefinitions.has(e))throw new A("widget-toolbar-duplicated",this,{toolbarId:e});var l={view:a,getRelatedElement:n,balloonClassName:s,itemsConfig:i,initialized:!1};o.ui.addToolbar(a,{isContextual:!0,beforeFocus:function beforeFocus(){var e=n(o.editing.view.document.selection);e&&_this425._showToolbar(l,e);},afterBlur:function afterBlur(){_this425._hideToolbar(l);}}),this._toolbarDefinitions.set(e,l);}},{key:"_updateToolbarsVisibility",value:function _updateToolbarsVisibility(){var e=0,t=null,i=null;var _iterator465=_createForOfIteratorHelper(this._toolbarDefinitions.values()),_step465;try{for(_iterator465.s();!(_step465=_iterator465.n()).done;){var _n196=_step465.value;var _s138=_n196.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&_s138){if(this.editor.ui.focusTracker.isFocused){var _o76=_s138.getAncestors().length;_o76>e&&(e=_o76,t=_s138,i=_n196);}else this._isToolbarVisible(_n196)&&this._hideToolbar(_n196);}else this._isToolbarInBalloon(_n196)&&this._hideToolbar(_n196);}}catch(err){_iterator465.e(err);}finally{_iterator465.f();}i&&this._showToolbar(i,t);}},{key:"_hideToolbar",value:function _hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView");}},{key:"_showToolbar",value:function _showToolbar(e,t){var _this426=this;this._isToolbarVisible(e)?Iy(this.editor,t):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:Vy(this.editor,t),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",function(){var _iterator466=_createForOfIteratorHelper(_this426._toolbarDefinitions.values()),_step466;try{for(_iterator466.s();!(_step466=_iterator466.n()).done;){var _e488=_step466.value;if(_this426._isToolbarVisible(_e488)){var _t305=_e488.getRelatedElement(_this426.editor.editing.view.document.selection);Iy(_this426.editor,_t305);}}}catch(err){_iterator466.e(err);}finally{_iterator466.f();}}));}},{key:"_isToolbarVisible",value:function _isToolbarVisible(e){return this._balloon.visibleView===e.view;}},{key:"_isToolbarInBalloon",value:function _isToolbarInBalloon(e){return this._balloon.hasView(e.view);}}],[{key:"requires",get:function get(){return[Db];}},{key:"pluginName",get:function get(){return"WidgetToolbarRepository";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function Iy(e,t){var i=e.plugins.get("ContextualBalloon"),n=Vy(e,t);i.updatePosition(n);}function Vy(e,t){var i=e.editing.view,n=Df.defaultPositions;return{target:i.domConverter.mapViewToDom(t),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]};}var Ry=/*#__PURE__*/function(_Zs17){function Ry(e){var _this427;_classCallCheck(this,Ry);_this427=_callSuper(this,Ry),_defineProperty(_assertThisInitialized(_this427),"_referenceCoordinates",void 0),_defineProperty(_assertThisInitialized(_this427),"_options",void 0),_defineProperty(_assertThisInitialized(_this427),"_originalWidth",void 0),_defineProperty(_assertThisInitialized(_this427),"_originalHeight",void 0),_defineProperty(_assertThisInitialized(_this427),"_originalWidthPercents",void 0),_defineProperty(_assertThisInitialized(_this427),"_aspectRatio",void 0),_this427.set("activeHandlePosition",null),_this427.set("proposedWidthPercents",null),_this427.set("proposedWidth",null),_this427.set("proposedHeight",null),_this427.set("proposedHandleHostWidth",null),_this427.set("proposedHandleHostHeight",null),_this427._options=e,_this427._referenceCoordinates=null;return _this427;}_inherits(Ry,_Zs17);return _createClass(Ry,[{key:"originalWidth",get:function get(){return this._originalWidth;}},{key:"originalHeight",get:function get(){return this._originalHeight;}},{key:"originalWidthPercents",get:function get(){return this._originalWidthPercents;}},{key:"aspectRatio",get:function get(){return this._aspectRatio;}},{key:"begin",value:function begin(e,t,i){var n=new Eo(t);this.activeHandlePosition=function(e){var t=["top-left","top-right","bottom-right","bottom-left"];for(var _i353=0,_t306=t;_i353<_t306.length;_i353++){var _i354=_t306[_i353];if(e.classList.contains(Oy(_i354)))return _i354;}}(e),this._referenceCoordinates=function(e,t){var i=new Eo(e),n=t.split("-"),s={x:"right"==n[1]?i.right:i.left,y:"bottom"==n[0]?i.bottom:i.top};return s.x+=e.ownerDocument.defaultView.scrollX,s.y+=e.ownerDocument.defaultView.scrollY,s;}(t,function(e){var t=e.split("-"),i={top:"bottom",bottom:"top",left:"right",right:"left"};return"".concat(i[t[0]],"-").concat(i[t[1]]);}(this.activeHandlePosition)),this._originalWidth=n.width,this._originalHeight=n.height,this._aspectRatio=n.width/n.height;var s=i.style.width;s&&s.match(/^\d+(\.\d*)?%$/)?this._originalWidthPercents=parseFloat(s):this._originalWidthPercents=py(i,n);}},{key:"update",value:function update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight;}}]);}(Zs());function Oy(e){return"ck-widget__resizer__handle-".concat(e);}var By=/*#__PURE__*/function(_lg53){function By(){var _this428;_classCallCheck(this,By);_this428=_callSuper(this,By);var e=_this428.bindTemplate;_this428.setTemplate({tag:"div",attributes:{"class":["ck","ck-size-view",e.to("_viewPosition",function(e){return e?"ck-orientation-".concat(e):"";})],style:{display:e["if"]("_isVisible","none",function(e){return!e;})}},children:[{text:e.to("_label")}]});return _this428;}_inherits(By,_lg53);return _createClass(By,[{key:"_bindToState",value:function _bindToState(e,t){this.bind("_isVisible").to(t,"proposedWidth",t,"proposedHeight",function(e,t){return null!==e&&null!==t;}),this.bind("_label").to(t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",t,"proposedWidthPercents",function(t,i,n){return"px"===e.unit?"".concat(t,"\xD7").concat(i):"".concat(n,"%");}),this.bind("_viewPosition").to(t,"activeHandlePosition",t,"proposedHandleHostWidth",t,"proposedHandleHostHeight",function(e,t,i){return t<50||i<50?"above-center":e;});}},{key:"_dismiss",value:function _dismiss(){this.unbind(),this._isVisible=!1;}}]);}(lg);var My=/*#__PURE__*/function(_Zs18){function My(e){var _this429;_classCallCheck(this,My);_this429=_callSuper(this,My),_defineProperty(_assertThisInitialized(_this429),"_state",void 0),_defineProperty(_assertThisInitialized(_this429),"_sizeView",void 0),_defineProperty(_assertThisInitialized(_this429),"_options",void 0),_defineProperty(_assertThisInitialized(_this429),"_viewResizerWrapper",null),_defineProperty(_assertThisInitialized(_this429),"_initialViewWidth",void 0),_this429._options=e,_this429.set("isEnabled",!0),_this429.set("isSelected",!1),_this429.bind("isVisible").to(_assertThisInitialized(_this429),"isEnabled",_this429,"isSelected",function(e,t){return e&&t;}),_this429.decorate("begin"),_this429.decorate("cancel"),_this429.decorate("commit"),_this429.decorate("updateSize"),_this429.on("commit",function(e){_this429.state.proposedWidth||_this429.state.proposedWidthPercents||(_this429._cleanup(),e.stop());},{priority:"high"});return _this429;}_inherits(My,_Zs18);return _createClass(My,[{key:"state",get:function get(){return this._state;}},{key:"show",value:function show(){var _this430=this;this._options.editor.editing.view.change(function(e){e.removeClass("ck-hidden",_this430._viewResizerWrapper);});}},{key:"hide",value:function hide(){var _this431=this;this._options.editor.editing.view.change(function(e){e.addClass("ck-hidden",_this431._viewResizerWrapper);});}},{key:"attach",value:function attach(){var _this432=this;var e=this,t=this._options.viewElement;this._options.editor.editing.view.change(function(i){var n=i.createUIElement("div",{"class":"ck ck-reset_all ck-widget__resizer"},function(t){var i=this.toDomElement(t);return e._appendHandles(i),e._appendSizeUI(i),i;});i.insert(i.createPositionAt(t,"end"),n),i.addClass("ck-widget_with-resizer",t),_this432._viewResizerWrapper=n,_this432.isVisible||_this432.hide();}),this.on("change:isVisible",function(){_this432.isVisible?(_this432.show(),_this432.redraw()):_this432.hide();});}},{key:"begin",value:function begin(e){this._state=new Ry(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost());}},{key:"updateSize",value:function updateSize(e){var _this433=this;var t=this._proposeNewSize(e);this._options.editor.editing.view.change(function(e){var i=_this433._options.unit||"%",n=("%"===i?t.widthPercents:t.width)+i;e.setStyle("width",n,_this433._options.viewElement);});var i=this._getHandleHost(),n=new Eo(i),s=Math.round(n.width),o=Math.round(n.height),r=new Eo(i);t.width=Math.round(r.width),t.height=Math.round(r.height),this.redraw(n),this.state.update(_objectSpread(_objectSpread({},t),{},{handleHostWidth:s,handleHostHeight:o}));}},{key:"commit",value:function commit(){var _this434=this;var e=this._options.unit||"%",t=("%"===e?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change(function(){_this434._cleanup(),_this434._options.onCommit(t);});}},{key:"cancel",value:function cancel(){this._cleanup();}},{key:"destroy",value:function destroy(){this.cancel();}},{key:"redraw",value:function redraw(e){var t=this._domResizerWrapper;if(!((i=t)&&i.ownerDocument&&i.ownerDocument.contains(i)))return;var i;var n=t.parentElement,s=this._getHandleHost(),o=this._viewResizerWrapper,r=[o.getStyle("width"),o.getStyle("height"),o.getStyle("left"),o.getStyle("top")];var a;if(n.isSameNode(s)){var _t307=e||new Eo(s);a=[_t307.width+"px",_t307.height+"px",void 0,void 0];}else a=[s.offsetWidth+"px",s.offsetHeight+"px",s.offsetLeft+"px",s.offsetTop+"px"];"same"!==so(r,a)&&this._options.editor.editing.view.change(function(e){e.setStyle({width:a[0],height:a[1],left:a[2],top:a[3]},o);});}},{key:"containsHandle",value:function containsHandle(e){return this._domResizerWrapper.contains(e);}},{key:"_cleanup",value:function _cleanup(){var _this435=this;this._sizeView._dismiss();this._options.editor.editing.view.change(function(e){e.setStyle("width",_this435._initialViewWidth,_this435._options.viewElement);});}},{key:"_proposeNewSize",value:function _proposeNewSize(e){var t=this.state,i={x:(n=e).pageX,y:n.pageY};var n;var s=!this._options.isCentered||this._options.isCentered(this),o={x:t._referenceCoordinates.x-(i.x+t.originalWidth),y:i.y-t.originalHeight-t._referenceCoordinates.y};s&&t.activeHandlePosition.endsWith("-right")&&(o.x=i.x-(t._referenceCoordinates.x+t.originalWidth)),s&&(o.x*=2);var r=Math.abs(t.originalWidth+o.x),a=Math.abs(t.originalHeight+o.y);return"width"==(r/t.aspectRatio>a?"width":"height")?a=r/t.aspectRatio:r=a*t.aspectRatio,{width:Math.round(r),height:Math.round(a),widthPercents:Math.min(Math.round(t.originalWidthPercents/t.originalWidth*r*100)/100,100)};}},{key:"_getResizeHost",value:function _getResizeHost(){var e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e);}},{key:"_getHandleHost",value:function _getHandleHost(){var e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e);}},{key:"_domResizerWrapper",get:function get(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper);}},{key:"_appendHandles",value:function _appendHandles(e){var t=["top-left","top-right","bottom-right","bottom-left"];for(var _i355=0,_t308=t;_i355<_t308.length;_i355++){var _n197=_t308[_i355];e.appendChild(new Hm({tag:"div",attributes:{"class":"ck-widget__resizer__handle "+(i=_n197,"ck-widget__resizer__handle-".concat(i))}}).render());}var i;}},{key:"_appendSizeUI",value:function _appendSizeUI(e){this._sizeView=new By(),this._sizeView.render(),e.appendChild(this._sizeView.element);}}],[{key:"isResizeHandle",value:function isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle");}}]);}(Zs());var Ly=/*#__PURE__*/function(_Dr63){function Ly(){var _this436;_classCallCheck(this,Ly);for(var _len60=arguments.length,args=new Array(_len60),_key60=0;_key60<_len60;_key60++){args[_key60]=arguments[_key60];}_this436=_callSuper(this,Ly,[].concat(args));_defineProperty(_this436,"_resizers",new Map());_defineProperty(_this436,"_observer",void 0);_defineProperty(_this436,"_redrawSelectedResizerThrottled",void 0);return _this436;}_inherits(Ly,_Dr63);return _createClass(Ly,[{key:"init",value:function init(){var _this437=this;var e=this.editor.editing,t=i.window.document;this.set("selectedResizer",null),this.set("_activeResizer",null),e.view.addObserver(Wu),this._observer=new(go())(),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(t,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(t,"mouseup",this._mouseUpListener.bind(this)),this._redrawSelectedResizerThrottled=$s(function(){return _this437.redrawSelectedResizer();},200),this.editor.ui.on("update",this._redrawSelectedResizerThrottled),this.editor.model.document.on("change",function(){var _iterator467=_createForOfIteratorHelper(_this437._resizers),_step467;try{for(_iterator467.s();!(_step467=_iterator467.n()).done;){var _step467$value=_slicedToArray(_step467.value,2),_e489=_step467$value[0],_t309=_step467$value[1];_e489.isAttached()||(_this437._resizers["delete"](_e489),_t309.destroy());}}catch(err){_iterator467.e(err);}finally{_iterator467.f();}},{priority:"lowest"}),this._observer.listenTo(i.window,"resize",this._redrawSelectedResizerThrottled);var n=this.editor.editing.view.document.selection;n.on("change",function(){var e=n.getSelectedElement(),t=_this437.getResizerByViewElement(e)||null;t?_this437.select(t):_this437.deselect();});}},{key:"redrawSelectedResizer",value:function redrawSelectedResizer(){this.selectedResizer&&this.selectedResizer.isVisible&&this.selectedResizer.redraw();}},{key:"destroy",value:function destroy(){_superPropGet(Ly,"destroy",this,3)([]),this._observer.stopListening();var _iterator468=_createForOfIteratorHelper(this._resizers.values()),_step468;try{for(_iterator468.s();!(_step468=_iterator468.n()).done;){var _e490=_step468.value;_e490.destroy();}}catch(err){_iterator468.e(err);}finally{_iterator468.f();}this._redrawSelectedResizerThrottled.cancel();}},{key:"select",value:function select(e){this.deselect(),this.selectedResizer=e,this.selectedResizer.isSelected=!0;}},{key:"deselect",value:function deselect(){this.selectedResizer&&(this.selectedResizer.isSelected=!1),this.selectedResizer=null;}},{key:"attachTo",value:function attachTo(e){var t=new My(e),i=this.editor.plugins;if(t.attach(),i.has("WidgetToolbarRepository")){var _e491=i.get("WidgetToolbarRepository");t.on("begin",function(){_e491.forceDisabled("resize");},{priority:"lowest"}),t.on("cancel",function(){_e491.clearForceDisabled("resize");},{priority:"highest"}),t.on("commit",function(){_e491.clearForceDisabled("resize");},{priority:"highest"});}this._resizers.set(e.viewElement,t);var n=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(n)==t&&this.select(t),t;}},{key:"getResizerByViewElement",value:function getResizerByViewElement(e){return this._resizers.get(e);}},{key:"_getResizerByHandle",value:function _getResizerByHandle(e){var _iterator469=_createForOfIteratorHelper(this._resizers.values()),_step469;try{for(_iterator469.s();!(_step469=_iterator469.n()).done;){var _t310=_step469.value;if(_t310.containsHandle(e))return _t310;}}catch(err){_iterator469.e(err);}finally{_iterator469.f();}}},{key:"_mouseDownListener",value:function _mouseDownListener(e,t){var i=t.domTarget;My.isResizeHandle(i)&&(this._activeResizer=this._getResizerByHandle(i)||null,this._activeResizer&&(this._activeResizer.begin(i),e.stop(),t.preventDefault()));}},{key:"_mouseMoveListener",value:function _mouseMoveListener(e,t){this._activeResizer&&this._activeResizer.updateSize(t);}},{key:"_mouseUpListener",value:function _mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null);}}],[{key:"pluginName",get:function get(){return"WidgetResize";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Fy=Oo("px");var Ny=/*#__PURE__*/function(_lg54){function Ny(){var _this438;_classCallCheck(this,Ny);_this438=_callSuper(this,Ny);var e=_this438.bindTemplate;_this438.set({isVisible:!1,left:null,top:null,width:null}),_this438.setTemplate({tag:"div",attributes:{"class":["ck","ck-clipboard-drop-target-line",e["if"]("isVisible","ck-hidden",function(e){return!e;})],style:{left:e.to("left",function(e){return Fy(e);}),top:e.to("top",function(e){return Fy(e);}),width:e.to("width",function(e){return Fy(e);})}}});return _this438;}_inherits(Ny,_lg54);return _createClass(Ny);}(lg);var Dy=/*#__PURE__*/function(_Dr64){function Dy(){var _this439;_classCallCheck(this,Dy);for(var _len61=arguments.length,args=new Array(_len61),_key61=0;_key61<_len61;_key61++){args[_key61]=arguments[_key61];}_this439=_callSuper(this,Dy,[].concat(args));_defineProperty(_this439,"removeDropMarkerDelayed",Sr(function(){return _this439.removeDropMarker();},40));_defineProperty(_this439,"_updateDropMarkerThrottled",$s(function(e){return _this439._updateDropMarker(e);},40));_defineProperty(_this439,"_reconvertMarkerThrottled",$s(function(){_this439.editor.model.markers.has("drop-target")&&_this439.editor.editing.reconvertMarker("drop-target");},0));_defineProperty(_this439,"_dropTargetLineView",new Ny());_defineProperty(_this439,"_domEmitter",new(go())());_defineProperty(_this439,"_scrollables",new Map());return _this439;}_inherits(Dy,_Dr64);return _createClass(Dy,[{key:"init",value:function init(){this._setupDropMarker();}},{key:"destroy",value:function destroy(){this._domEmitter.stopListening();var _iterator470=_createForOfIteratorHelper(this._scrollables.values()),_step470;try{for(_iterator470.s();!(_step470=_iterator470.n()).done;){var _e492=_step470.value.resizeObserver;_e492.destroy();}}catch(err){_iterator470.e(err);}finally{_iterator470.f();}return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),_superPropGet(Dy,"destroy",this,3)([]);}},{key:"updateDropMarker",value:function updateDropMarker(e,t,i,n,s,o){this.removeDropMarkerDelayed.cancel();var r=zy(this.editor,e,t,i,n,s,o);if(r)return o&&o.containsRange(r)?this.removeDropMarker():void this._updateDropMarkerThrottled(r);}},{key:"getFinalDropRange",value:function getFinalDropRange(e,t,i,n,s,o){var r=zy(this.editor,e,t,i,n,s,o);return this.removeDropMarker(),r;}},{key:"removeDropMarker",value:function removeDropMarker(){var e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(function(e){e.removeMarker("drop-target");});}},{key:"_setupDropMarker",value:function _setupDropMarker(){var _this440=this;var e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion["for"]("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion["for"]("editingDowncast").markerToElement({model:"drop-target",view:function view(t,_ref128){var i=_ref128.writer;if(e.model.schema.checkChild(t.markerRange.start,"$text"))return _this440._dropTargetLineView.isVisible=!1,_this440._createDropTargetPosition(i);t.markerRange.isCollapsed?_this440._updateDropTargetLine(t.markerRange):_this440._dropTargetLineView.isVisible=!1;}});}},{key:"_updateDropMarker",value:function _updateDropMarker(e){var t=this.editor,i=t.model.markers;t.model.change(function(t){i.has("drop-target")?i.get("drop-target").getRange().isEqual(e)||t.updateMarker("drop-target",{range:e}):t.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1});});}},{key:"_createDropTargetPosition",value:function _createDropTargetPosition(e){return e.createUIElement("span",{"class":"ck ck-clipboard-drop-target-position"},function(e){var t=this.toDomElement(e);return t.append("⁠",e.createElement("span"),"⁠"),t;});}},{key:"_updateDropTargetLine",value:function _updateDropTargetLine(e){var t=this.editor.editing,n=e.start.nodeBefore,s=e.start.nodeAfter,o=e.start.parent,r=n?t.mapper.toViewElement(n):null,a=r?t.view.domConverter.mapViewToDom(r):null,l=s?t.mapper.toViewElement(s):null,c=l?t.view.domConverter.mapViewToDom(l):null,d=t.mapper.toViewElement(o);if(!d)return;var u=t.view.domConverter.mapViewToDom(d),h=this._getScrollableRect(d),_i$window3=i.window,m=_i$window3.scrollX,g=_i$window3.scrollY,f=a?new Eo(a):null,p=c?new Eo(c):null,b=new Eo(u).excludeScrollbarsAndBorders(),w=f?f.bottom:b.top,_=p?p.top:b.bottom,v=i.window.getComputedStyle(u),y=w<=_?(w+_)/2:_;if(h.top<y&&y<h.bottom){var _e493=b.left+parseFloat(v.paddingLeft),_t311=b.right-parseFloat(v.paddingRight),_i356=Math.max(_e493+m,h.left),_n198=Math.min(_t311+m,h.right);this._dropTargetLineView.set({isVisible:!0,left:_i356,top:y+g,width:_n198-_i356});}else this._dropTargetLineView.isVisible=!1;}},{key:"_getScrollableRect",value:function _getScrollableRect(e){var t=e.root.rootName;var n;if(this._scrollables.has(t))n=this._scrollables.get(t).domElement;else{n=function(e){var t=e;do{t=t.parentElement;var _e494=i.window.getComputedStyle(t).overflowY;if("auto"==_e494||"scroll"==_e494)break;}while("BODY"!=t.tagName);return t;}(this.editor.editing.view.domConverter.mapViewToDom(e)),this._domEmitter.listenTo(n,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});var _s139=new Vo(n,this._reconvertMarkerThrottled);this._scrollables.set(t,{domElement:n,resizeObserver:_s139});}return new Eo(n).excludeScrollbarsAndBorders();}}],[{key:"pluginName",get:function get(){return"DragDropTarget";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function zy(e,t,i,n,s,o,r){var a=e.model,l=e.editing.mapper;var c=Wy(e,t);var _loop12=function _loop12(){if(!o)if(a.schema.checkChild(c,"$text")){if(i){var _t312=i[0].start,_o77=l.toModelPosition(_t312);if(!r||Array.from(r.getItems()).every(function(e){return a.schema.checkChild(_o77,e);})){if(a.schema.checkChild(_o77,"$text"))return{v:a.createRange(_o77)};if(_t312)return{v:$y(e,Wy(e,_t312.parent),n,s)};}}}else if(a.schema.isInline(c))return{v:$y(e,c,n,s)};if(a.schema.isBlock(c))return{v:$y(e,c,n,s)};if(a.schema.checkChild(c,"$block")){var _t313=Array.from(c.getChildren()).filter(function(t){return t.is("element")&&!Hy(e,t);});var _i357=0,_o78=_t313.length;if(0==_o78)return{v:a.createRange(a.createPositionAt(c,"end"))};for(;_i357<_o78-1;){var _r45=Math.floor((_i357+_o78)/2);"before"==Uy(e,_t313[_r45],n,s)?_o78=_r45:_i357=_r45;}return{v:$y(e,_t313[_i357],n,s)};}c=c.parent;},_ret3;for(;c;){_ret3=_loop12();if(_ret3)return _ret3.v;}return null;}function Hy(e,t){var n=e.editing.mapper,s=e.editing.view.domConverter,o=n.toViewElement(t);if(!o)return!0;var r=s.mapViewToDom(o);return"none"!=i.window.getComputedStyle(r)["float"];}function $y(e,t,i,n){var s=e.model;return s.createRange(s.createPositionAt(t,Uy(e,t,i,n)));}function Uy(e,t,i,n){var s=e.editing.mapper,o=e.editing.view.domConverter,r=s.toViewElement(t),a=o.mapViewToDom(r),l=new Eo(a);return e.model.schema.isInline(t)?i<(l.left+l.right)/2?"before":"after":n<(l.top+l.bottom)/2?"before":"after";}function Wy(e,t){var i=e.editing.mapper,n=e.editing.view,s=i.toModelElement(t);if(s)return s;var o=n.createPositionBefore(t),r=i.findMappedViewAncestor(o);return i.toModelElement(r);}var jy=/*#__PURE__*/function(_Dr65){function jy(){var _this441;_classCallCheck(this,jy);for(var _len62=arguments.length,args=new Array(_len62),_key62=0;_key62<_len62;_key62++){args[_key62]=arguments[_key62];}_this441=_callSuper(this,jy,[].concat(args));_defineProperty(_this441,"_isBlockDragging",!1);_defineProperty(_this441,"_domEmitter",new(go())());return _this441;}_inherits(jy,_Dr65);return _createClass(jy,[{key:"init",value:function init(){var _this442=this;var e=this.editor;if(this.listenTo(e,"change:isReadOnly",function(e,t,i){i?(_this442.forceDisabled("readOnlyMode"),_this442._isBlockDragging=!1):_this442.clearForceDisabled("readOnlyMode");}),o.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){var _t314=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(_t314,"dragstart",function(e,t){return _this442._handleBlockDragStart(t);}),this._domEmitter.listenTo(i.document,"dragover",function(e,t){return _this442._handleBlockDragging(t);}),this._domEmitter.listenTo(i.document,"drop",function(e,t){return _this442._handleBlockDragging(t);}),this._domEmitter.listenTo(i.document,"dragend",function(){return _this442._handleBlockDragEnd();},{useCapture:!0}),this.isEnabled&&_t314.setAttribute("draggable","true"),this.on("change:isEnabled",function(e,i,n){_t314.setAttribute("draggable",n?"true":"false");});}}},{key:"destroy",value:function destroy(){return this._domEmitter.stopListening(),_superPropGet(jy,"destroy",this,3)([]);}},{key:"_handleBlockDragStart",value:function _handleBlockDragStart(e){if(!this.isEnabled)return;var t=this.editor.model,i=t.document.selection,n=this.editor.editing.view,s=Array.from(i.getSelectedBlocks()),o=t.createRange(t.createPositionBefore(s[0]),t.createPositionAfter(s[s.length-1]));t.change(function(e){return e.setSelection(o);}),this._isBlockDragging=!0,n.focus(),n.getObserver(Uv).onDomEvent(e);}},{key:"_handleBlockDragging",value:function _handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;var t=e.clientX+("ltr"==this.editor.locale.contentLanguageDirection?100:-100),i=e.clientY,n=document.elementFromPoint(t,i),s=this.editor.editing.view;n&&n.closest(".ck-editor__editable")&&s.getObserver(Uv).onDomEvent(_objectSpread(_objectSpread({},e),{},{type:e.type,dataTransfer:e.dataTransfer,target:n,clientX:t,clientY:i,preventDefault:function preventDefault(){return e.preventDefault();},stopPropagation:function stopPropagation(){return e.stopPropagation();}}));}},{key:"_handleBlockDragEnd",value:function _handleBlockDragEnd(){this._isBlockDragging=!1;}}],[{key:"pluginName",get:function get(){return"DragDropBlockToolbar";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var qy=/*#__PURE__*/function(_Dr66){function qy(){var _this443;_classCallCheck(this,qy);for(var _len63=arguments.length,args=new Array(_len63),_key63=0;_key63<_len63;_key63++){args[_key63]=arguments[_key63];}_this443=_callSuper(this,qy,[].concat(args));_defineProperty(_this443,"_draggedRange",void 0);_defineProperty(_this443,"_draggingUid",void 0);_defineProperty(_this443,"_draggableElement",void 0);_defineProperty(_this443,"_clearDraggableAttributesDelayed",Sr(function(){return _this443._clearDraggableAttributes();},40));_defineProperty(_this443,"_blockMode",!1);_defineProperty(_this443,"_domEmitter",new(go())());_defineProperty(_this443,"_previewContainer",void 0);return _this443;}_inherits(qy,_Dr66);return _createClass(qy,[{key:"init",value:function init(){var _this444=this;var e=this.editor,t=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,t.addObserver(Uv),t.addObserver(Wu),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",function(e,t,i){i?_this444.forceDisabled("readOnlyMode"):_this444.clearForceDisabled("readOnlyMode");}),this.on("change:isEnabled",function(e,t,i){i||_this444._finalizeDragging(!1);}),o.isAndroid&&this.forceDisabled("noAndroidSupport");}},{key:"destroy",value:function destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),_superPropGet(qy,"destroy",this,3)([]);}},{key:"_setupDragging",value:function _setupDragging(){var _this445=this;var e=this.editor,t=e.model,n=e.editing.view,s=n.document,r=e.plugins.get(Dy);this.listenTo(s,"dragstart",function(e,i){if(i.target&&i.target.is("editableElement"))return void i.preventDefault();if(_this445._prepareDraggedRange(i.target),!_this445._draggedRange)return void i.preventDefault();_this445._draggingUid=k(),i.dataTransfer.effectAllowed=_this445.isEnabled?"copyMove":"copy",i.dataTransfer.setData("application/ckeditor5-dragging-uid",_this445._draggingUid);var n=t.createSelection(_this445._draggedRange.toRange());_this445.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(i.dataTransfer,n,"dragstart");var s=i.dataTransfer,o=i.domTarget,r=i.domEvent,a=r.clientX;_this445._updatePreview({dataTransfer:s,domTarget:o,clientX:a}),i.stopPropagation(),_this445.isEnabled||(_this445._draggedRange.detach(),_this445._draggedRange=null,_this445._draggingUid="");},{priority:"low"}),this.listenTo(s,"dragend",function(e,t){_this445._finalizeDragging(!t.dataTransfer.isCanceled&&"move"==t.dataTransfer.dropEffect);},{priority:"low"}),this._domEmitter.listenTo(i.document,"dragend",function(){_this445._blockMode=!1;},{useCapture:!0}),this.listenTo(s,"dragenter",function(){_this445.isEnabled&&n.focus();}),this.listenTo(s,"dragleave",function(){r.removeDropMarkerDelayed();}),this.listenTo(s,"dragging",function(e,t){if(!_this445.isEnabled)return void(t.dataTransfer.dropEffect="none");var _t$domEvent=t.domEvent,i=_t$domEvent.clientX,n=_t$domEvent.clientY;r.updateDropMarker(t.target,t.targetRanges,i,n,_this445._blockMode,_this445._draggedRange),_this445._draggedRange||(t.dataTransfer.dropEffect="copy"),o.isGecko||("copy"==t.dataTransfer.effectAllowed?t.dataTransfer.dropEffect="copy":["all","copyMove"].includes(t.dataTransfer.effectAllowed)&&(t.dataTransfer.dropEffect="move")),e.stop();},{priority:"low"});}},{key:"_setupClipboardInputIntegration",value:function _setupClipboardInputIntegration(){var _this446=this;var e=this.editor,t=e.editing.view.document,i=e.plugins.get(Dy);this.listenTo(t,"clipboardInput",function(t,n){if("drop"!=n.method)return;var _n$domEvent=n.domEvent,s=_n$domEvent.clientX,o=_n$domEvent.clientY,r=i.getFinalDropRange(n.target,n.targetRanges,s,o,_this446._blockMode,_this446._draggedRange);if(!r)return _this446._finalizeDragging(!1),void t.stop();_this446._draggedRange&&_this446._draggingUid!=n.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(_this446._draggedRange.detach(),_this446._draggedRange=null,_this446._draggingUid="");if("move"==Gy(n.dataTransfer)&&_this446._draggedRange&&_this446._draggedRange.containsRange(r,!0))return _this446._finalizeDragging(!1),void t.stop();n.targetRanges=[e.editing.mapper.toViewRange(r)];},{priority:"high"});}},{key:"_setupContentInsertionIntegration",value:function _setupContentInsertionIntegration(){var _this447=this;var e=this.editor.plugins.get(Jv);e.on("contentInsertion",function(e,t){if(!_this447.isEnabled||"drop"!==t.method)return;var i=t.targetRanges.map(function(e){return _this447.editor.editing.mapper.toModelRange(e);});_this447.editor.model.change(function(e){return e.setSelection(i);});},{priority:"high"}),e.on("contentInsertion",function(e,t){if(!_this447.isEnabled||"drop"!==t.method)return;var i="move"==Gy(t.dataTransfer),n=!t.resultRange||!t.resultRange.isCollapsed;_this447._finalizeDragging(n&&i);},{priority:"lowest"});}},{key:"_setupDraggableAttributeHandling",value:function _setupDraggableAttributeHandling(){var _this448=this;var e=this.editor,t=e.editing.view,i=t.document;this.listenTo(i,"mousedown",function(n,s){if(o.isAndroid||!s)return;_this448._clearDraggableAttributesDelayed.cancel();var r=Ky(s.target);if(o.isBlink&&!e.isReadOnly&&!r&&!i.selection.isCollapsed){var _e495=i.selection.getSelectedElement();_e495&&sy(_e495)||(r=i.selection.editableElement);}r&&(t.change(function(e){e.setAttribute("draggable","true",r);}),_this448._draggableElement=e.editing.mapper.toModelElement(r));}),this.listenTo(i,"mouseup",function(){o.isAndroid||_this448._clearDraggableAttributesDelayed();});}},{key:"_clearDraggableAttributes",value:function _clearDraggableAttributes(){var _this449=this;var e=this.editor.editing;e.view.change(function(t){_this449._draggableElement&&"$graveyard"!=_this449._draggableElement.root.rootName&&t.removeAttribute("draggable",e.mapper.toViewElement(_this449._draggableElement)),_this449._draggableElement=null;});}},{key:"_finalizeDragging",value:function _finalizeDragging(e){var _this450=this;var t=this.editor,i=t.model;if(t.plugins.get(Dy).removeDropMarker(),this._clearDraggableAttributes(),t.plugins.has("WidgetToolbarRepository")){t.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop");}this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&i.change(function(e){var t=i.createSelection(_this450._draggedRange);i.deleteContent(t,{doNotAutoparagraph:!0});var n=t.getFirstPosition().parent;n.isEmpty&&!i.schema.checkChild(n,"$text")&&i.schema.checkChild(n,"paragraph")&&e.insertElement("paragraph",n,0);}),this._draggedRange.detach(),this._draggedRange=null);}},{key:"_prepareDraggedRange",value:function _prepareDraggedRange(e){var _this451=this;var t=this.editor,i=t.model,n=i.document.selection,s=e?Ky(e):null;if(s){var _e496=t.editing.mapper.toModelElement(s);if(this._draggedRange=fc.fromRange(i.createRangeOn(_e496)),this._blockMode=i.schema.isBlock(_e496),t.plugins.has("WidgetToolbarRepository")){t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");}return;}if(n.isCollapsed&&!n.getFirstPosition().parent.isEmpty)return;var o=Array.from(n.getSelectedBlocks()),r=n.getFirstRange();if(0==o.length)return void(this._draggedRange=fc.fromRange(r));var a=Zy(i,o);if(o.length>1)this._draggedRange=fc.fromRange(a),this._blockMode=!0;else if(1==o.length){var _e497=r.start.isTouching(a.start)&&r.end.isTouching(a.end);this._draggedRange=fc.fromRange(_e497?a:r),this._blockMode=_e497;}i.change(function(e){return e.setSelection(_this451._draggedRange.toRange());});}},{key:"_updatePreview",value:function _updatePreview(_ref129){var e=_ref129.dataTransfer,t=_ref129.domTarget,n=_ref129.clientX;var s=this.editor.editing.view,r=s.document.selection.editableElement,a=s.domConverter.mapViewToDom(r),l=i.window.getComputedStyle(a);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=ro(i.document,"div",{style:"position: fixed; left: -999999px;"}),i.document.body.appendChild(this._previewContainer));var c=new Eo(a);if(a.contains(t))return;var d=parseFloat(l.paddingLeft),u=ro(i.document,"div");u.className="ck ck-content",u.style.width=l.width,u.style.paddingLeft="".concat(c.left-n+d,"px"),o.isiOS&&(u.style.backgroundColor="white"),s.domConverter.setContentOf(u,e.getData("text/html")),e.setDragImage(u,0,0),this._previewContainer.appendChild(u);}}],[{key:"pluginName",get:function get(){return"DragDrop";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Jv,Ty,Dy,jy];}}]);}(Dr);function Gy(e){return o.isGecko?e.dropEffect:["all","copyMove"].includes(e.effectAllowed)?"move":"copy";}function Ky(e){if(e.is("editableElement"))return null;if(e.hasClass("ck-widget__selection-handle"))return e.findAncestor(sy);if(sy(e))return e;var t=e.findAncestor(function(e){return sy(e)||e.is("editableElement");});return sy(t)?t:null;}function Zy(e,t){var i=t[0],n=t[t.length-1],s=i.getCommonAncestor(n),o=e.createPositionBefore(i),r=e.createPositionAfter(n);if(s&&s.is("element")&&!e.schema.isLimit(s)){var _t315=e.createRangeOn(s),_i358=o.isTouching(_t315.start),_n199=r.isTouching(_t315.end);if(_i358&&_n199)return Zy(e,[s]);}return e.createRange(o,r);}var Jy=/*#__PURE__*/function(_Dr67){function Jy(){_classCallCheck(this,Jy);return _callSuper(this,Jy,arguments);}_inherits(Jy,_Dr67);return _createClass(Jy,[{key:"init",value:function init(){var e=this.editor,t=e.model,i=e.editing.view,n=t.document.selection;i.addObserver(Uv),e.plugins.get(Jv).on("contentInsertion",function(e,i){(function(e,t){var i=t.createRangeIn(e);if(1==e.childCount){var _n200=e.getChild(0);_n200.is("element")&&t.schema.isBlock(_n200)&&!t.schema.isObject(_n200)&&!t.schema.isLimit(_n200)&&(i=t.createRangeIn(_n200));}var _iterator471=_createForOfIteratorHelper(i.getItems()),_step471;try{for(_iterator471.s();!(_step471=_iterator471.n()).done;){var _e498=_step471.value;if(!t.schema.isInline(_e498))return!1;if(Array.from(_e498.getAttributeKeys()).find(function(e){return t.schema.getAttributeProperties(e).isFormatting;}))return!1;}}catch(err){_iterator471.e(err);}finally{_iterator471.f();}return!0;})(i.content,t)&&t.change(function(e){var s=Array.from(n.getAttributes()).filter(function(_ref130){var _ref131=_slicedToArray(_ref130,1),e=_ref131[0];return t.schema.getAttributeProperties(e).isFormatting;});n.isCollapsed||t.deleteContent(n,{doNotAutoparagraph:!0}),s.push.apply(s,_toConsumableArray(n.getAttributes()));var o=e.createRangeIn(i.content);var _iterator472=_createForOfIteratorHelper(o.getItems()),_step472;try{for(_iterator472.s();!(_step472=_iterator472.n()).done;){var _i359=_step472.value;var _iterator473=_createForOfIteratorHelper(s),_step473;try{for(_iterator473.s();!(_step473=_iterator473.n()).done;){var _n201=_step473.value;t.schema.checkAttribute(_i359,_n201[0])&&e.setAttribute(_n201[0],_n201[1],_i359);}}catch(err){_iterator473.e(err);}finally{_iterator473.f();}}}catch(err){_iterator472.e(err);}finally{_iterator472.f();}});});}}],[{key:"pluginName",get:function get(){return"PastePlainText";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Jv];}}]);}(Dr);var Qy=/*#__PURE__*/function(_Dr68){function Qy(){_classCallCheck(this,Qy);return _callSuper(this,Qy,arguments);}_inherits(Qy,_Dr68);return _createClass(Qy,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Copy selected content"),keystroke:"CTRL+C"},{label:t("Paste content"),keystroke:"CTRL+V"},{label:t("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]});}}],[{key:"pluginName",get:function get(){return"Clipboard";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Zv,Jv,qy,Jy];}}]);}(Dr);var Yy={autoRefresh:!0},Xy=36e5;var ek=/*#__PURE__*/function(_Zs19){function ek(e){var _this452;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,ek);if(_this452=_callSuper(this,ek),_defineProperty(_assertThisInitialized(_this452),"_refresh",void 0),_defineProperty(_assertThisInitialized(_this452),"_options",void 0),_defineProperty(_assertThisInitialized(_this452),"_tokenRefreshTimeout",void 0),!e)throw new A("token-missing-token-url",_assertThisInitialized(_this452));t.initValue&&_this452._validateTokenValue(t.initValue),_this452.set("value",t.initValue),_this452._refresh="function"==typeof e?e:function(){return t=e,new Promise(function(e,i){var n=new XMLHttpRequest();n.open("GET",t),n.addEventListener("load",function(){var t=n.status,s=n.response;return t<200||t>299?i(new A("token-cannot-download-new-token",null)):e(s);}),n.addEventListener("error",function(){return i(new Error("Network Error"));}),n.addEventListener("abort",function(){return i(new Error("Abort"));}),n.send();});var t;},_this452._options=_objectSpread(_objectSpread({},Yy),t);return _this452;}_inherits(ek,_Zs19);return _createClass(ek,[{key:"init",value:function init(){var _this453=this;return new Promise(function(e,t){_this453.value?(_this453._options.autoRefresh&&_this453._registerRefreshTokenTimeout(),e(_this453)):_this453.refreshToken().then(e)["catch"](t);});}},{key:"refreshToken",value:function refreshToken(){var _this454=this;var e=this._options.autoRefresh;return this._refresh().then(function(t){return _this454._validateTokenValue(t),_this454.set("value",t),e&&_this454._registerRefreshTokenTimeout(),_this454;})["catch"](function(t){throw E("token-refresh-failed",{autoRefresh:e}),e&&_this454._registerRefreshTokenTimeout(5e3),t;});}},{key:"destroy",value:function destroy(){clearTimeout(this._tokenRefreshTimeout);}},{key:"_validateTokenValue",value:function _validateTokenValue(e){var t="string"==typeof e,i=!/^".*"$/.test(e),n=t&&3===e.split(".").length;if(!i||!n)throw new A("token-not-in-jwt-format",this);}},{key:"_registerRefreshTokenTimeout",value:function _registerRefreshTokenTimeout(e){var _this455=this;var t=e||this._getTokenRefreshTimeoutTime();clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=setTimeout(function(){_this455.refreshToken();},t);}},{key:"_getTokenRefreshTimeoutTime",value:function _getTokenRefreshTimeoutTime(){try{var _this$value$split=this.value.split("."),_this$value$split2=_slicedToArray(_this$value$split,2),_e499=_this$value$split2[1],_JSON$parse=JSON.parse(atob(_e499)),_t316=_JSON$parse.exp;if(!_t316)return Xy;return Math.floor((1e3*_t316-Date.now())/2);}catch(e){return Xy;}}}],[{key:"create",value:function create(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new ek(e,t).init();}}]);}(Zs());var tk=/^data:(\S*?);base64,/;var ik=/*#__PURE__*/function(_L23){function ik(e,t,i){var _this456;_classCallCheck(this,ik);if(_this456=_callSuper(this,ik),_defineProperty(_assertThisInitialized(_this456),"file",void 0),_defineProperty(_assertThisInitialized(_this456),"xhr",void 0),_defineProperty(_assertThisInitialized(_this456),"_token",void 0),_defineProperty(_assertThisInitialized(_this456),"_apiAddress",void 0),!e)throw new A("fileuploader-missing-file",null);if(!t)throw new A("fileuploader-missing-token",null);if(!i)throw new A("fileuploader-missing-api-address",null);_this456.file=function(e){if("string"!=typeof e)return!1;var t=e.match(tk);return!(!t||!t.length);}(e)?function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:512;try{var _i360=e.match(tk)[1],_n202=atob(e.replace(tk,"")),_s140=[];for(var _e500=0;_e500<_n202.length;_e500+=t){var _i361=_n202.slice(_e500,_e500+t),_o79=new Array(_i361.length);for(var _e501=0;_e501<_i361.length;_e501++)_o79[_e501]=_i361.charCodeAt(_e501);_s140.push(new Uint8Array(_o79));}return new Blob(_s140,{type:_i360});}catch(e){throw new A("fileuploader-decoding-image-data-error",null);}}(e):e,_this456._token=t,_this456._apiAddress=i;return _this456;}_inherits(ik,_L23);return _createClass(ik,[{key:"onProgress",value:function onProgress(e){return this.on("progress",function(t,i){return e(i);}),this;}},{key:"onError",value:function onError(e){return this.once("error",function(t,i){return e(i);}),this;}},{key:"abort",value:function abort(){this.xhr.abort();}},{key:"send",value:function send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest();}},{key:"_prepareRequest",value:function _prepareRequest(){var e=new XMLHttpRequest();e.open("POST",this._apiAddress),e.setRequestHeader("Authorization",this._token.value),e.responseType="json",this.xhr=e;}},{key:"_attachXHRListeners",value:function _attachXHRListeners(){var _this457=this;var e=this.xhr,t=function t(e){return function(){return _this457.fire("error",e);};};e.addEventListener("error",t("Network Error")),e.addEventListener("abort",t("Abort")),e.upload&&e.upload.addEventListener("progress",function(e){e.lengthComputable&&_this457.fire("progress",{total:e.total,uploaded:e.loaded});}),e.addEventListener("load",function(){var t=e.status,i=e.response;if(t<200||t>299)return _this457.fire("error",i.message||i.error);});}},{key:"_sendRequest",value:function _sendRequest(){var _this458=this;var e=new FormData(),t=this.xhr;return e.append("file",this.file),new Promise(function(i,n){t.addEventListener("load",function(){var e=t.status,s=t.response;return e<200||e>299?s.message?n(new A("fileuploader-uploading-data-failed",_this458,{message:s.message})):n(s.error):i(s);}),t.addEventListener("error",function(){return n(new Error("Network Error"));}),t.addEventListener("abort",function(){return n(new Error("Abort"));}),t.send(e);});}}]);}(L());var nk=/*#__PURE__*/function(){function nk(e,t){_classCallCheck(this,nk);_defineProperty(this,"_token",void 0);_defineProperty(this,"_apiAddress",void 0);if(!e)throw new A("uploadgateway-missing-token",null);if(!t)throw new A("uploadgateway-missing-api-address",null);this._token=e,this._apiAddress=t;}return _createClass(nk,[{key:"upload",value:function upload(e){return new ik(e,this._token,this._apiAddress);}}]);}();var sk=/*#__PURE__*/function(_qr4){function sk(){_classCallCheck(this,sk);return _callSuper(this,sk,arguments);}_inherits(sk,_qr4);return _createClass(sk,[{key:"createToken",value:function createToken(e,t){return new ek(e,t);}},{key:"createUploadGateway",value:function createUploadGateway(e,t){return new nk(e,t);}}],[{key:"pluginName",get:function get(){return"CloudServicesCore";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(qr);var ok=/*#__PURE__*/function(_qr5){function ok(){var _this459;_classCallCheck(this,ok);for(var _len64=arguments.length,args=new Array(_len64),_key64=0;_key64<_len64;_key64++){args[_key64]=arguments[_key64];}_this459=_callSuper(this,ok,[].concat(args));_defineProperty(_this459,"tokenUrl",void 0);_defineProperty(_this459,"uploadUrl",void 0);_defineProperty(_this459,"webSocketUrl",void 0);_defineProperty(_this459,"bundleVersion",void 0);_defineProperty(_this459,"token",null);_defineProperty(_this459,"_tokens",new Map());return _this459;}_inherits(ok,_qr5);return _createClass(ok,[{key:"init",value:function(){var _init=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee21(){var e,_i362,_Object$entries8,_Object$entries8$_i,_t317,_i363,t;return _regeneratorRuntime().wrap(function _callee21$(_context53){while(1)switch(_context53.prev=_context53.next){case 0:e=this.context.config.get("cloudServices")||{};for(_i362=0,_Object$entries8=Object.entries(e);_i362<_Object$entries8.length;_i362++){_Object$entries8$_i=_slicedToArray(_Object$entries8[_i362],2),_t317=_Object$entries8$_i[0],_i363=_Object$entries8$_i[1];this[_t317]=_i363;}if(this.tokenUrl){_context53.next=4;break;}return _context53.abrupt("return",void(this.token=null));case 4:t=this.context.plugins.get("CloudServicesCore");_context53.next=7;return t.createToken(this.tokenUrl).init();case 7:this.token=_context53.sent;this._tokens.set(this.tokenUrl,this.token);case 9:case"end":return _context53.stop();}},_callee21,this);}));function init(){return _init.apply(this,arguments);}return init;}()},{key:"registerTokenUrl",value:function(){var _registerTokenUrl=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee22(e){var t,i;return _regeneratorRuntime().wrap(function _callee22$(_context54){while(1)switch(_context54.prev=_context54.next){case 0:if(!this._tokens.has(e)){_context54.next=2;break;}return _context54.abrupt("return",this.getTokenFor(e));case 2:t=this.context.plugins.get("CloudServicesCore");_context54.next=5;return t.createToken(e).init();case 5:i=_context54.sent;return _context54.abrupt("return",(this._tokens.set(e,i),i));case 7:case"end":return _context54.stop();}},_callee22,this);}));function registerTokenUrl(_x21){return _registerTokenUrl.apply(this,arguments);}return registerTokenUrl;}()},{key:"getTokenFor",value:function getTokenFor(e){var t=this._tokens.get(e);if(!t)throw new A("cloudservices-token-not-registered",this);return t;}},{key:"destroy",value:function destroy(){_superPropGet(ok,"destroy",this,3)([]);var _iterator474=_createForOfIteratorHelper(this._tokens.values()),_step474;try{for(_iterator474.s();!(_step474=_iterator474.n()).done;){var _e502=_step474.value;_e502.destroy();}}catch(err){_iterator474.e(err);}finally{_iterator474.f();}}}],[{key:"pluginName",get:function get(){return"CloudServices";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[sk];}}]);}(qr);function rk(e){var t=e.t,i=e.config.get("codeBlock.languages");var _iterator475=_createForOfIteratorHelper(i),_step475;try{for(_iterator475.s();!(_step475=_iterator475.n()).done;){var _e503=_step475.value;"Plain text"===_e503.label&&(_e503.label=t("Plain text")),void 0===_e503["class"]&&(_e503["class"]="language-".concat(_e503.language));}}catch(err){_iterator475.e(err);}finally{_iterator475.f();}return i;}function ak(e,t,i){var n={};var _iterator476=_createForOfIteratorHelper(e),_step476;try{for(_iterator476.s();!(_step476=_iterator476.n()).done;){var _s141=_step476.value;if("class"===t){n[_s141[t].split(" ").shift()]=_s141[i];}else n[_s141[t]]=_s141[i];}}catch(err){_iterator476.e(err);}finally{_iterator476.f();}return n;}function lk(e){return e.data.match(/^(\s*)/)[0];}function ck(e){var t=e.document.selection,i=[];if(t.isCollapsed)return[t.anchor];var n=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});var _iterator477=_createForOfIteratorHelper(n),_step477;try{var _loop13=function _loop13(){var t=_step477.value.item;var n=t.is("$textProxy")?t.textNode:t;var s=n.parent;if(!s.is("element","codeBlock")||n.is("element","softBreak"))return 1;// continue
for(;n.previousSibling&&!n.previousSibling.is("element","softBreak");)n=n.previousSibling;var o=n.is("$text")?n.startOffset+lk(n).length:n.startOffset,r=e.createPositionAt(s,o);i.every(function(e){return!e.isEqual(r);})&&i.push(r);};for(_iterator477.s();!(_step477=_iterator477.n()).done;){if(_loop13())continue;}}catch(err){_iterator477.e(err);}finally{_iterator477.f();}return i;}function dk(e){var t=wr(e.getSelectedBlocks());return!!t&&t.is("element","codeBlock");}function uk(e,t){return!t.is("rootElement")&&!e.isLimit(t)&&e.checkChild(t.parent,"codeBlock");}function hk(e,t,i,n){var s=ak(t,"language","label"),o=i.getAttribute("language");if(o in s){var _t318=s[o];return e("enter"===n?"Entering %0 code snippet":"Leaving %0 code snippet",_t318);}return e("enter"===n?"Entering code snippet":"Leaving code snippet");}function mk(e,t){for(e.textNode&&(e=t.createPositionBefore(e.textNode));e.nodeBefore&&!e.nodeBefore.is("element","softBreak");)e=t.createPositionBefore(e.nodeBefore);var i=e.nodeAfter;return i&&i.is("$text")?i:null;}var gk=/*#__PURE__*/function(_Hr13){function gk(e){var _this460;_classCallCheck(this,gk);_this460=_callSuper(this,gk,[e]),_defineProperty(_assertThisInitialized(_this460),"_lastLanguage",void 0),_this460._lastLanguage=null;return _this460;}_inherits(gk,_Hr13);return _createClass(gk,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this461=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor,i=t.model,n=i.document.selection,s=rk(t)[0],o=Array.from(n.getSelectedBlocks()),r=null==e.forceValue?!this.value:e.forceValue,a=function(e,t,i){if(e.language)return e.language;if(e.usePreviousLanguageChoice&&t)return t;return i;}(e,this._lastLanguage,s.language);i.change(function(e){r?_this461._applyCodeBlock(e,o,a):_this461._removeCodeBlock(e,o);});}},{key:"_getValue",value:function _getValue(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());return!!!(!e||!e.is("element","codeBlock"))&&e.getAttribute("language");}},{key:"_checkEnabled",value:function _checkEnabled(){if(this.value)return!0;var e=this.editor.model.document.selection,t=this.editor.model.schema,i=wr(e.getSelectedBlocks());return!!i&&uk(t,i);}},{key:"_applyCodeBlock",value:function _applyCodeBlock(e,t,i){this._lastLanguage=i;var n=this.editor.model.schema,s=t.filter(function(e){return uk(n,e);});var _iterator478=_createForOfIteratorHelper(s),_step478;try{var _loop14=function _loop14(){var t=_step478.value;e.rename(t,"codeBlock"),e.setAttribute("language",i,t),n.removeDisallowedAttributes([t],e),Array.from(t.getChildren()).filter(function(e){return!n.checkChild(t,e);}).forEach(function(t){return e.remove(t);});};for(_iterator478.s();!(_step478=_iterator478.n()).done;){_loop14();}}catch(err){_iterator478.e(err);}finally{_iterator478.f();}s.reverse().forEach(function(t,i){var n=s[i+1];t.previousSibling===n&&(e.appendElement("softBreak",n),e.merge(e.createPositionBefore(t)));});}},{key:"_removeCodeBlock",value:function _removeCodeBlock(e,t){var i=t.filter(function(e){return e.is("element","codeBlock");});var _iterator479=_createForOfIteratorHelper(i),_step479;try{for(_iterator479.s();!(_step479=_iterator479.n()).done;){var _t319=_step479.value;var _i364=e.createRangeOn(_t319);var _iterator480=_createForOfIteratorHelper(Array.from(_i364.getItems()).reverse()),_step480;try{for(_iterator480.s();!(_step480=_iterator480.n()).done;){var _t320=_step480.value;if(_t320.is("element","softBreak")&&_t320.parent.is("element","codeBlock")){var _e$split3=e.split(e.createPositionBefore(_t320)),_i365=_e$split3.position,_n203=_i365.nodeAfter;e.rename(_n203,"paragraph"),e.removeAttribute("language",_n203),e.remove(_t320);}}}catch(err){_iterator480.e(err);}finally{_iterator480.f();}e.rename(_t319,"paragraph"),e.removeAttribute("language",_t319);}}catch(err){_iterator479.e(err);}finally{_iterator479.f();}}}]);}(Hr);var fk=/*#__PURE__*/function(_Hr14){function fk(e){var _this462;_classCallCheck(this,fk);_this462=_callSuper(this,fk,[e]),_defineProperty(_assertThisInitialized(_this462),"_indentSequence",void 0),_this462._indentSequence=e.config.get("codeBlock.indentSequence");return _this462;}_inherits(fk,_Hr14);return _createClass(fk,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this463=this;var e=this.editor.model;e.change(function(t){var i=ck(e);var _iterator481=_createForOfIteratorHelper(i),_step481;try{for(_iterator481.s();!(_step481=_iterator481.n()).done;){var _n204=_step481.value;var _i366=t.createText(_this463._indentSequence);e.insertContent(_i366,_n204);}}catch(err){_iterator481.e(err);}finally{_iterator481.f();}});}},{key:"_checkEnabled",value:function _checkEnabled(){return!!this._indentSequence&&dk(this.editor.model.document.selection);}}]);}(Hr);var pk=/*#__PURE__*/function(_Hr15){function pk(e){var _this464;_classCallCheck(this,pk);_this464=_callSuper(this,pk,[e]),_defineProperty(_assertThisInitialized(_this464),"_indentSequence",void 0),_this464._indentSequence=e.config.get("codeBlock.indentSequence");return _this464;}_inherits(pk,_Hr15);return _createClass(pk,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this465=this;var e=this.editor.model;e.change(function(){var t=ck(e);var _iterator482=_createForOfIteratorHelper(t),_step482;try{for(_iterator482.s();!(_step482=_iterator482.n()).done;){var _i367=_step482.value;var _t321=bk(e,_i367,_this465._indentSequence);_t321&&e.deleteContent(e.createSelection(_t321));}}catch(err){_iterator482.e(err);}finally{_iterator482.f();}});}},{key:"_checkEnabled",value:function _checkEnabled(){var _this466=this;if(!this._indentSequence)return!1;var e=this.editor.model;return!!dk(e.document.selection)&&ck(e).some(function(t){return bk(e,t,_this466._indentSequence);});}}]);}(Hr);function bk(e,t,i){var n=mk(t,e);if(!n)return null;var s=lk(n),o=s.lastIndexOf(i);if(o+i.length!==s.length)return null;if(-1===o)return null;var r=n.parent,a=n.startOffset;return e.createRange(e.createPositionAt(r,a+o),e.createPositionAt(r,a+o+i.length));}function wk(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=ak(t,"language","class"),s=ak(t,"language","label");return function(t,o,r){var a=r.writer,l=r.mapper,c=r.consumable;if(!c.consume(o.item,"insert"))return;var d=o.item.getAttribute("language"),u=l.toViewPosition(e.createPositionBefore(o.item)),h={};i&&(h["data-language"]=s[d],h.spellcheck="false");var m=n[d]?{"class":n[d]}:void 0,g=a.createContainerElement("code",m),f=a.createContainerElement("pre",h,g);a.insert(u,f),l.bindElements(o.item,g);};}var _k="paragraph";var vk=/*#__PURE__*/function(_Dr69){function vk(e){var _this467;_classCallCheck(this,vk);_this467=_callSuper(this,vk,[e]),e.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"\t"});return _this467;}_inherits(vk,_Dr69);return _createClass(vk,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.model,n=e.editing.view,s=rk(e);e.commands.add("codeBlock",new gk(e)),e.commands.add("indentCodeBlock",new fk(e)),e.commands.add("outdentCodeBlock",new pk(e)),this.listenTo(n.document,"tab",function(t,i){var n=i.shiftKey?"outdentCodeBlock":"indentCodeBlock";e.commands.get(n).isEnabled&&(e.execute(n),i.stopPropagation(),i.preventDefault(),t.stop());},{context:"pre"}),t.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",disallowChildren:"$inlineObject",allowAttributes:["language"],allowAttributesOf:"$listItem",isBlock:!0}),t.addAttributeCheck(function(e,i){var n=e.getItem(e.length-2);if(t.getAttributeProperties(i).isFormatting&&n&&"codeBlock"==n.name)return!1;}),e.editing.downcastDispatcher.on("insert:codeBlock",wk(i,s,!0)),e.data.downcastDispatcher.on("insert:codeBlock",wk(i,s)),e.data.downcastDispatcher.on("insert:softBreak",function(e){return function(t,i,n){if("codeBlock"!==i.item.parent.name)return;var s=n.writer,o=n.mapper,r=n.consumable;if(!r.consume(i.item,"insert"))return;var a=o.toViewPosition(e.createPositionBefore(i.item));s.insert(a,s.createText("\n"));};}(i),{priority:"high"}),e.data.upcastDispatcher.on("element:code",function(e,t){var i=ak(t,"class","language"),n=t[0].language;return function(e,t,s){var o=t.viewItem,r=o.parent;if(!r||!r.is("element","pre"))return;if(t.modelCursor.findAncestor("codeBlock"))return;var a=s.consumable,l=s.writer;if(!a.test(o,{name:!0}))return;var c=l.createElement("codeBlock"),d=_toConsumableArray(o.getClassNames());d.length||d.push("");var _iterator483=_createForOfIteratorHelper(d),_step483;try{for(_iterator483.s();!(_step483=_iterator483.n()).done;){var _e504=_step483.value;var _t322=i[_e504];if(_t322){l.setAttribute("language",_t322,c);break;}}}catch(err){_iterator483.e(err);}finally{_iterator483.f();}c.hasAttribute("language")||l.setAttribute("language",n,c),s.convertChildren(o,c),s.safeInsert(c,t.modelCursor)&&(a.consume(o,{name:!0}),s.updateConversionResult(c,t));};}(0,s)),e.data.upcastDispatcher.on("text",function(e,t,_ref132){var i=_ref132.consumable,n=_ref132.writer;var s=t.modelCursor;if(!i.test(t.viewItem))return;if(!s.findAncestor("codeBlock"))return;i.consume(t.viewItem);var o=t.viewItem.data.split("\n").map(function(e){return n.createText(e);}),r=o[o.length-1];var _iterator484=_createForOfIteratorHelper(o),_step484;try{for(_iterator484.s();!(_step484=_iterator484.n()).done;){var _e505=_step484.value;if(n.insert(_e505,s),s=s.getShiftedBy(_e505.offsetSize),_e505!==r){var _e506=n.createElement("softBreak");n.insert(_e506,s),s=n.createPositionAfter(_e506);}}}catch(err){_iterator484.e(err);}finally{_iterator484.f();}t.modelRange=n.createRange(t.modelCursor,s),t.modelCursor=s;}),e.data.upcastDispatcher.on("element:pre",function(e,t,_ref133){var i=_ref133.consumable;var n=t.viewItem;if(n.findAncestor("pre"))return;var s=Array.from(n.getChildren()),o=s.find(function(e){return e.is("element","code");});if(o){var _iterator485=_createForOfIteratorHelper(s),_step485;try{for(_iterator485.s();!(_step485=_iterator485.n()).done;){var _e507=_step485.value;_e507!==o&&_e507.is("$text")&&i.consume(_e507,{name:!0});}}catch(err){_iterator485.e(err);}finally{_iterator485.f();}}},{priority:"high"}),this.listenTo(e.editing.view.document,"clipboardInput",function(t,n){var s=i.createRange(i.document.selection.anchor);if(n.targetRanges&&(s=e.editing.mapper.toModelRange(n.targetRanges[0])),!s.start.parent.is("element","codeBlock"))return;var o=n.dataTransfer.getData("text/plain"),r=new ju(e.editing.view.document);n.content=function(e,t){var i=e.createDocumentFragment(),n=t.split("\n"),s=n.reduce(function(t,i,s){return t.push(i),s<n.length-1&&t.push(e.createElement("br")),t;},[]);return e.appendChild(s,i),i;}(r,o);}),e.plugins.has("ClipboardPipeline")&&e.plugins.get(Jv).on("contentInsertion",function(i,n){var s=e.model,o=s.document.selection;o.anchor.parent.is("element","codeBlock")&&s.change(function(e){var i=e.createRangeIn(n.content);for(var _i368=0,_arr4=_toConsumableArray(i.getItems());_i368<_arr4.length;_i368++){var _n205=_arr4[_i368];_n205.is("node")&&!t.checkChild(o.anchor,_n205)&&e.remove(_n205);}});}),this.listenTo(i,"getSelectedContent",function(e,_ref134){var _ref135=_slicedToArray(_ref134,1),n=_ref135[0];var s=n.anchor;!n.isCollapsed&&s.parent.is("element","codeBlock")&&s.hasSameParentAs(n.focus)&&i.change(function(i){var o=e["return"];if(s.parent.is("element")&&(o.childCount>1||n.containsEntireContent(s.parent))){var _t323=i.createElement("codeBlock",s.parent.getAttributes());i.append(o,_t323);var _n206=i.createDocumentFragment();return i.append(_t323,_n206),void(e["return"]=_n206);}var r=o.getChild(0);t.checkAttribute(r,"code")&&i.setAttribute("code",!0,r);});});}},{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.commands,i=t.get("indent"),n=t.get("outdent");i&&i.registerChildCommand(t.get("indentCodeBlock"),{priority:"highest"}),n&&n.registerChildCommand(t.get("outdentCodeBlock")),this.listenTo(e.editing.view.document,"enter",function(t,i){e.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(function(e,t){var i=e.model,n=i.document,s=e.editing.view,o=n.selection.getLastPosition(),r=o.nodeAfter;if(t||!n.selection.isCollapsed||!o.isAtStart)return!1;if(!kk(r))return!1;return e.model.change(function(t){e.execute("enter");var i=n.selection.anchor.parent.previousSibling;t.rename(i,_k),t.setSelection(i,"in"),e.model.schema.removeDisallowedAttributes([i],t),t.remove(r);}),s.scrollToTheSelection(),!0;}(e,i.isSoft)||function(e,t){var i=e.model,n=i.document,s=e.editing.view,o=n.selection.getLastPosition(),r=o.nodeBefore;var a;if(t||!n.selection.isCollapsed||!o.isAtEnd||!r||!r.previousSibling)return!1;if(kk(r)&&kk(r.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling),i.createPositionAfter(r));else if(yk(r)&&kk(r.previousSibling)&&kk(r.previousSibling.previousSibling))a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling),i.createPositionAfter(r));else{if(!(yk(r)&&kk(r.previousSibling)&&yk(r.previousSibling.previousSibling)&&r.previousSibling.previousSibling&&kk(r.previousSibling.previousSibling.previousSibling)))return!1;a=i.createRange(i.createPositionBefore(r.previousSibling.previousSibling.previousSibling),i.createPositionAfter(r));}return e.model.change(function(t){t.remove(a),e.execute("enter");var i=n.selection.anchor.parent;t.rename(i,_k),e.model.schema.removeDisallowedAttributes([i],t);}),s.scrollToTheSelection(),!0;}(e,i.isSoft)||function(e){var t=e.model,i=t.document;var n;var s=mk(i.selection.getLastPosition(),t);s&&s.is("$text")&&(n=lk(s));e.model.change(function(t){e.execute("shiftEnter"),n&&t.insertText(n,i.selection.anchor);});}(e),i.preventDefault(),t.stop());},{context:"pre"}),this._initAriaAnnouncements();}},{key:"_initAriaAnnouncements",value:function _initAriaAnnouncements(){var _this$editor=this.editor,e=_this$editor.model,t=_this$editor.ui,i=_this$editor.t,n=rk(this.editor);var s=null;e.document.selection.on("change:range",function(){var o=e.document.selection.focus.parent;t&&s!==o&&o.is("element")&&(s&&s.is("element","codeBlock")&&t.ariaLiveAnnouncer.announce(hk(i,n,s,"leave")),o.is("element","codeBlock")&&t.ariaLiveAnnouncer.announce(hk(i,n,o,"enter")),s=o);});}}],[{key:"pluginName",get:function get(){return"CodeBlockEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Y_];}}]);}(Dr);function yk(e){return e&&e.is("$text")&&!e.data.match(/\S/);}function kk(e){return e&&e.is("element","softBreak");}var Ck=/*#__PURE__*/function(_Dr70){function Ck(){_classCallCheck(this,Ck);return _callSuper(this,Ck,arguments);}_inherits(Ck,_Dr70);return _createClass(Ck,[{key:"init",value:function init(){var e=this.editor,t=e.t,i=e.ui.componentFactory,n=rk(e),s=this._getLanguageListItemDefinitions(n),o=e.commands.get("codeBlock");i.add("codeBlock",function(i){var n=Xf(i,Yf),r=n.buttonView,a=t("Insert code block");return r.set({label:a,tooltip:!0,icon:vm.codeBlock,isToggleable:!0}),r.bind("isOn").to(o,"value",function(e){return!!e;}),r.on("execute",function(){e.execute("codeBlock",{usePreviousLanguageChoice:!0}),e.editing.view.focus();}),n.on("execute",function(t){e.execute("codeBlock",{language:t.source._codeBlockLanguage,forceValue:!0}),e.editing.view.focus();}),n["class"]="ck-code-block-dropdown",n.bind("isEnabled").to(o),sp(n,s,{role:"menu",ariaLabel:a}),n;}),i.add("menuBar:codeBlock",function(i){var n=new aw(i);n.buttonView.set({role:"menuitem",label:t("Code block"),icon:vm.codeBlock}),n.bind("isEnabled").to(o);var r=new lw(i);r.set({ariaLabel:t("Insert code block")});var _iterator486=_createForOfIteratorHelper(s),_step486;try{var _loop15=function _loop15(){var t=_step486.value;var s=new ub(i,n),a=new Rg(i);a.bind.apply(a,_toConsumableArray(Object.keys(t.model))).to(t.model),a.set({isToggleable:!0,role:"menuitemcheckbox"}),a.delegate("execute").to(n),a.on("execute",function(){e.execute("codeBlock",{language:t.model._codeBlockLanguage,forceValue:o.value!=t.model._codeBlockLanguage}),e.editing.view.focus();}),s.children.add(a),r.items.add(s);};for(_iterator486.s();!(_step486=_iterator486.n()).done;){_loop15();}}catch(err){_iterator486.e(err);}finally{_iterator486.f();}return n.panelView.children.add(r),n;});}},{key:"_getLanguageListItemDefinitions",value:function _getLanguageListItemDefinitions(e){var t=this.editor.commands.get("codeBlock"),i=new br();var _iterator487=_createForOfIteratorHelper(e),_step487;try{var _loop16=function _loop16(){var n=_step487.value;var e={type:"button",model:new Fb({_codeBlockLanguage:n.language,label:n.label,role:"menuitemradio",withText:!0})};e.model.bind("isOn").to(t,"value",function(t){return t===e.model._codeBlockLanguage;}),i.add(e);};for(_iterator487.s();!(_step487=_iterator487.n()).done;){_loop16();}}catch(err){_iterator487.e(err);}finally{_iterator487.f();}return i;}}],[{key:"pluginName",get:function get(){return"CodeBlockUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var xk=/*#__PURE__*/function(_Dr71){function xk(){_classCallCheck(this,xk);return _callSuper(this,xk,arguments);}_inherits(xk,_Dr71);return _createClass(xk,null,[{key:"requires",get:function get(){return[vk,Ck];}},{key:"pluginName",get:function get(){return"CodeBlock";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Ak=/*#__PURE__*/function(_Dr72){function Ak(){var _this468;_classCallCheck(this,Ak);for(var _len65=arguments.length,args=new Array(_len65),_key65=0;_key65<_len65;_key65++){args[_key65]=arguments[_key65];}_this468=_callSuper(this,Ak,[].concat(args));_defineProperty(_this468,"_uploadGateway",void 0);return _this468;}_inherits(Ak,_Dr72);return _createClass(Ak,[{key:"init",value:function init(){var _this469=this;var e=this.editor,t=e.plugins.get("CloudServices"),i=t.token,n=t.uploadUrl;if(!i)return;var s=e.plugins.get("CloudServicesCore");this._uploadGateway=s.createUploadGateway(i,n),e.plugins.get(km).createUploadAdapter=function(e){return new Ek(_this469._uploadGateway,e);};}}],[{key:"pluginName",get:function get(){return"CloudServicesUploadAdapter";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return["CloudServices",km];}}]);}(Dr);var Ek=/*#__PURE__*/function(){function Ek(e,t){_classCallCheck(this,Ek);_defineProperty(this,"uploadGateway",void 0);_defineProperty(this,"loader",void 0);_defineProperty(this,"fileUploader",void 0);this.uploadGateway=e,this.loader=t;}return _createClass(Ek,[{key:"upload",value:function upload(){var _this470=this;return this.loader.file.then(function(e){return _this470.fileUploader=_this470.uploadGateway.upload(e),_this470.fileUploader.on("progress",function(e,t){_this470.loader.uploadTotal=t.total,_this470.loader.uploaded=t.uploaded;}),_this470.fileUploader.send();});}},{key:"abort",value:function abort(){this.fileUploader.abort();}}]);}();var Tk=/*#__PURE__*/function(_Dr73){function Tk(){_classCallCheck(this,Tk);return _callSuper(this,Tk,arguments);}_inherits(Tk,_Dr73);return _createClass(Tk,[{key:"init",value:function init(){var e=this.editor;e.plugins.has("ImageBlockEditing")||e.plugins.has("ImageInlineEditing")||E("easy-image-image-feature-missing",e);}}],[{key:"pluginName",get:function get(){return"EasyImage";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Ak,"ImageUpload"];}}]);}(Dr);var Pk=/*#__PURE__*/function(_Pb2){function Pk(e,t){var _this471;_classCallCheck(this,Pk);_this471=_callSuper(this,Pk,[e]),_defineProperty(_assertThisInitialized(_this471),"view",void 0),_this471.view=t;return _this471;}_inherits(Pk,_Pb2);return _createClass(Pk,[{key:"element",get:function get(){return this.view.editable.element;}},{key:"init",value:function init(){var e=this.editor,t=this.view,i=e.editing.view,n=t.editable,s=i.document.getRoot();n.name=s.rootName,t.render();var o=n.element;this.setEditableElement(n.name,o),n.bind("isFocused").to(this.focusTracker),i.attachDomRoot(o),this._initPlaceholder(),this._initMenuBar(this.view.menuBarView),this.fire("ready");}},{key:"destroy",value:function destroy(){_superPropGet(Pk,"destroy",this,3)([]);var e=this.view,t=this.editor.editing.view;t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy();}},{key:"_initPlaceholder",value:function _initPlaceholder(){var e=this.editor,t=e.editing.view,i=t.document.getRoot(),n=e.config.get("placeholder");if(n){var _e508="string"==typeof n?n:n[i.rootName];_e508&&(i.placeholder=_e508);}Zr({view:t,element:i,isDirectHost:!1,keepOnFocus:!0});}}]);}(Pb);var Sk=/*#__PURE__*/function(_Ib3){function Sk(e,t,i,n){var _this472;_classCallCheck(this,Sk);_this472=_callSuper(this,Sk,[e]),_defineProperty(_assertThisInitialized(_this472),"editable",void 0),_defineProperty(_assertThisInitialized(_this472),"menuBarView",void 0),_this472.editable=new Ob(e,t,i,{label:n}),_this472.menuBarView=new hw(e),_this472.menuBarView.extendTemplate({attributes:{"class":["ck-reset_all","ck-rounded-corners"],dir:e.uiLanguageDirection}});return _this472;}_inherits(Sk,_Ib3);return _createClass(Sk,[{key:"render",value:function render(){_superPropGet(Sk,"render",this,3)([]),this.registerChild(this.editable),this.registerChild(this.menuBarView);}}]);}(Ib);var Ik=/*#__PURE__*/function(_bm){function Ik(e){var _this473;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Ik);if(!Vk(e)&&void 0!==t.initialData)throw new A("editor-create-initial-data",null);_this473=_callSuper(this,Ik,[t]),_defineProperty(_assertThisInitialized(_this473),"ui",void 0),void 0===_this473.config.get("initialData")&&_this473.config.set("initialData",function(e){return Vk(e)?_o(e):e;}(e)),Vk(e)&&(_this473.sourceElement=e,wm(_assertThisInitialized(_this473),e));var i=_this473.config.get("plugins");i.push(ew),_this473.config.set("plugins",i),_this473.config.define("balloonToolbar",_this473.config.get("toolbar")),_this473.model.document.createRoot();var n=new Sk(_this473.locale,_this473.editing.view,_this473.sourceElement,_this473.config.get("label"));_this473.ui=new Pk(_this473,n),fm(_this473);return _this473;}_inherits(Ik,_bm);return _createClass(Ik,[{key:"destroy",value:function destroy(){var _this474=this;var e=this.getData();return this.ui.destroy(),_superPropGet(Ik,"destroy",this,3)([]).then(function(){_this474.sourceElement&&_this474.updateSourceElement(e);});}}],[{key:"create",value:function create(e){var _this475=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(i){if(Vk(e)&&"TEXTAREA"===e.tagName)throw new A("editor-wrong-element",null);var n=new _this475(e,t);i(n.initPlugins().then(function(){return n.ui.init();}).then(function(){return n.data.init(n.config.get("initialData"));}).then(function(){return n.fire("ready");}).then(function(){return n;}));});}}]);}(bm(gm));function Vk(e){return Ms(e);}var Rk=/*#__PURE__*/function(_Pb3){function Rk(e,t){var _this476;_classCallCheck(this,Rk);_this476=_callSuper(this,Rk,[e]),_defineProperty(_assertThisInitialized(_this476),"view",void 0),_defineProperty(_assertThisInitialized(_this476),"_toolbarConfig",void 0),_defineProperty(_assertThisInitialized(_this476),"_elementReplacer",void 0),_this476.view=t,_this476._toolbarConfig=qf(e.config.get("toolbar")),_this476._elementReplacer=new to(),_this476.listenTo(e.editing.view,"scrollToTheSelection",_this476._handleScrollToTheSelectionWithStickyPanel.bind(_assertThisInitialized(_this476)));return _this476;}_inherits(Rk,_Pb3);return _createClass(Rk,[{key:"element",get:function get(){return this.view.element;}},{key:"init",value:function init(e){var t=this.editor,i=this.view,n=t.editing.view,s=i.editable,o=n.document.getRoot();s.name=o.rootName,i.render();var r=s.element;this.setEditableElement(s.name,r),i.editable.bind("isFocused").to(this.focusTracker),n.attachDomRoot(r),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),i.menuBarView&&this._initMenuBar(i.menuBarView),this._initDialogPluginIntegration(),this._initContextualBalloonIntegration(),this.fire("ready");}},{key:"destroy",value:function destroy(){_superPropGet(Rk,"destroy",this,3)([]);var e=this.view,t=this.editor.editing.view;this._elementReplacer.restore(),t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy();}},{key:"_initToolbar",value:function _initToolbar(){var e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",function(_ref136){var e=_ref136.top;return e||0;}),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar);}},{key:"_initPlaceholder",value:function _initPlaceholder(){var e=this.editor,t=e.editing.view,i=t.document.getRoot(),n=e.sourceElement;var s;var o=e.config.get("placeholder");o&&(s="string"==typeof o?o:o[this.view.editable.name]),!s&&n&&"textarea"===n.tagName.toLowerCase()&&(s=n.getAttribute("placeholder")),s&&(i.placeholder=s),Zr({view:t,element:i,isDirectHost:!1,keepOnFocus:!0});}},{key:"_initContextualBalloonIntegration",value:function _initContextualBalloonIntegration(){if(!this.editor.plugins.has("ContextualBalloon"))return;var e=this.view.stickyPanel,t=this.editor.plugins.get("ContextualBalloon");t.on("getPositionOptions",function(t){var i=t["return"];if(!i||!e.isSticky||!e.element)return;var n=new Eo(e.element).height,s="function"==typeof i.target?i.target():i.target,o="function"==typeof i.limiter?i.limiter():i.limiter;if(s&&o&&new Eo(s).height>=new Eo(o).height-n)return;var r=_objectSpread({},i.viewportOffsetConfig),a=(r.top||0)+n;t["return"]=_objectSpread(_objectSpread({},i),{},{viewportOffsetConfig:_objectSpread(_objectSpread({},r),{},{top:a})});},{priority:"low"});var i=function i(){t.visibleView&&t.updatePosition();};this.listenTo(e,"change:isSticky",i),this.listenTo(this.editor.ui,"change:viewportOffset",i);}},{key:"_handleScrollToTheSelectionWithStickyPanel",value:function _handleScrollToTheSelectionWithStickyPanel(e,t,i){var _this477=this;var n=this.view.stickyPanel;if(n.isSticky){var _e509=new Eo(n.element).height;t.viewportOffset.top+=_e509;}else{var _e510=function _e510(){_this477.editor.editing.view.scrollToTheSelection(i);};this.listenTo(n,"change:isSticky",_e510),setTimeout(function(){_this477.stopListening(n,"change:isSticky",_e510);},20);}}},{key:"_initDialogPluginIntegration",value:function _initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;var e=this.view.stickyPanel,t=this.editor.plugins.get("Dialog");t.on("show",function(){var i=t.view;i.on("moveTo",function(t,n){if(!e.isSticky||i.wasMoved)return;var s=new Eo(e.contentPanelElement);n[1]<s.bottom+Pg.defaultOffset&&(n[1]=s.bottom+Pg.defaultOffset);},{priority:"high"});},{priority:"low"});}}]);}(Pb);var Ok=/*#__PURE__*/function(_Vb2){function Ok(e,t){var _this478;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};_classCallCheck(this,Ok);_this478=_callSuper(this,Ok,[e]),_defineProperty(_assertThisInitialized(_this478),"stickyPanel",void 0),_defineProperty(_assertThisInitialized(_this478),"toolbar",void 0),_defineProperty(_assertThisInitialized(_this478),"editable",void 0),_this478.stickyPanel=new Ub(e),_this478.toolbar=new Kf(e,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),i.useMenuBar&&(_this478.menuBarView=new hw(e)),_this478.editable=new Ob(e,t,void 0,{label:i.label});return _this478;}_inherits(Ok,_Vb2);return _createClass(Ok,[{key:"render",value:function render(){_superPropGet(Ok,"render",this,3)([]),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable);}}]);}(Vb);var Bk=/*#__PURE__*/function(_bm2){function Bk(e){var _this479;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Bk);if(!Mk(e)&&void 0!==t.initialData)throw new A("editor-create-initial-data",null);_this479=_callSuper(this,Bk,[t]),_defineProperty(_assertThisInitialized(_this479),"ui",void 0),_this479.config.define("menuBar.isVisible",!1),void 0===_this479.config.get("initialData")&&_this479.config.set("initialData",function(e){return Mk(e)?_o(e):e;}(e)),Mk(e)&&(_this479.sourceElement=e),_this479.model.document.createRoot();var i=!_this479.config.get("toolbar.shouldNotGroupWhenFull"),n=_this479.config.get("menuBar"),s=new Ok(_this479.locale,_this479.editing.view,{shouldToolbarGroupWhenFull:i,useMenuBar:n.isVisible,label:_this479.config.get("label")});_this479.ui=new Rk(_this479,s),fm(_this479);return _this479;}_inherits(Bk,_bm2);return _createClass(Bk,[{key:"destroy",value:function destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),_superPropGet(Bk,"destroy",this,3)([]);}}],[{key:"create",value:function create(e){var _this480=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(i){var n=new _this480(e,t);i(n.initPlugins().then(function(){return n.ui.init(Mk(e)?e:null);}).then(function(){return n.data.init(n.config.get("initialData"));}).then(function(){return n.fire("ready");}).then(function(){return n;}));});}}]);}(bm(gm));function Mk(e){return Ms(e);}var Lk=/*#__PURE__*/function(_Pb4){function Lk(e,t){var _this481;_classCallCheck(this,Lk);_this481=_callSuper(this,Lk,[e]),_defineProperty(_assertThisInitialized(_this481),"view",void 0),_this481.view=t;return _this481;}_inherits(Lk,_Pb4);return _createClass(Lk,[{key:"init",value:function init(){var e=this.editor,t=this.view,i=e.editing.view,n=t.editable,s=i.document.getRoot();n.name=s.rootName,t.render();var o=n.element;this.setEditableElement(n.name,o),t.editable.bind("isFocused").to(this.focusTracker),i.attachDomRoot(o),this._initPlaceholder(),this._initToolbar(),this._initMenuBar(this.view.menuBarView),this.fire("ready");}},{key:"destroy",value:function destroy(){_superPropGet(Lk,"destroy",this,3)([]);var e=this.view,t=this.editor.editing.view;t.getDomRoot(e.editable.name)&&t.detachDomRoot(e.editable.name),e.destroy();}},{key:"_initToolbar",value:function _initToolbar(){var e=this.editor,t=this.view;t.toolbar.fillFromConfig(e.config.get("toolbar"),this.componentFactory),this.addToolbar(t.toolbar);}},{key:"_initPlaceholder",value:function _initPlaceholder(){var e=this.editor,t=e.editing.view,i=t.document.getRoot(),n=e.config.get("placeholder");if(n){var _e511="string"==typeof n?n:n[i.rootName];_e511&&(i.placeholder=_e511);}Zr({view:t,element:i,isDirectHost:!1,keepOnFocus:!0});}}]);}(Pb);var Fk=/*#__PURE__*/function(_Ib4){function Fk(e,t){var _this482;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};_classCallCheck(this,Fk);_this482=_callSuper(this,Fk,[e]),_defineProperty(_assertThisInitialized(_this482),"toolbar",void 0),_defineProperty(_assertThisInitialized(_this482),"editable",void 0),_defineProperty(_assertThisInitialized(_this482),"menuBarView",void 0),_this482.toolbar=new Kf(e,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),_this482.menuBarView=new hw(e),_this482.editable=new Ob(e,t,i.editableElement,{label:i.label}),_this482.toolbar.extendTemplate({attributes:{"class":["ck-reset_all","ck-rounded-corners"],dir:e.uiLanguageDirection}}),_this482.menuBarView.extendTemplate({attributes:{"class":["ck-reset_all","ck-rounded-corners"],dir:e.uiLanguageDirection}});return _this482;}_inherits(Fk,_Ib4);return _createClass(Fk,[{key:"render",value:function render(){_superPropGet(Fk,"render",this,3)([]),this.registerChild([this.menuBarView,this.toolbar,this.editable]);}}]);}(Ib);var Nk=/*#__PURE__*/function(_bm3){function Nk(e){var _this483;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Nk);if(!Dk(e)&&void 0!==t.initialData)throw new A("editor-create-initial-data",null);_this483=_callSuper(this,Nk,[t]),_defineProperty(_assertThisInitialized(_this483),"ui",void 0),void 0===_this483.config.get("initialData")&&_this483.config.set("initialData",function(e){return Dk(e)?_o(e):e;}(e)),Dk(e)&&(_this483.sourceElement=e,wm(_assertThisInitialized(_this483),e)),_this483.model.document.createRoot();var i=!_this483.config.get("toolbar.shouldNotGroupWhenFull"),n=new Fk(_this483.locale,_this483.editing.view,{editableElement:_this483.sourceElement,shouldToolbarGroupWhenFull:i,label:_this483.config.get("label")});_this483.ui=new Lk(_this483,n);return _this483;}_inherits(Nk,_bm3);return _createClass(Nk,[{key:"destroy",value:function destroy(){var _this484=this;var e=this.getData();return this.ui.destroy(),_superPropGet(Nk,"destroy",this,3)([]).then(function(){_this484.sourceElement&&_this484.updateSourceElement(e);});}}],[{key:"create",value:function create(e){var _this485=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(i){if(Dk(e)&&"TEXTAREA"===e.tagName)throw new A("editor-wrong-element",null);var n=new _this485(e,t);i(n.initPlugins().then(function(){return n.ui.init();}).then(function(){return n.data.init(n.config.get("initialData"));}).then(function(){return n.fire("ready");}).then(function(){return n;}));});}}]);}(bm(gm));function Dk(e){return Ms(e);}var zk=/*#__PURE__*/function(_Pb5){function zk(e,t){var _this486;_classCallCheck(this,zk);_this486=_callSuper(this,zk,[e]),_defineProperty(_assertThisInitialized(_this486),"view",void 0),_defineProperty(_assertThisInitialized(_this486),"_toolbarConfig",void 0),_this486.view=t,_this486._toolbarConfig=qf(e.config.get("toolbar"));return _this486;}_inherits(zk,_Pb5);return _createClass(zk,[{key:"element",get:function get(){return this.view.editable.element;}},{key:"init",value:function init(){var e=this.editor,t=this.view,i=e.editing.view,n=t.editable,s=i.document.getRoot();n.name=s.rootName,t.render();var o=n.element;this.setEditableElement(n.name,o),n.bind("isFocused").to(this.focusTracker),i.attachDomRoot(o),this._initPlaceholder(),this._initToolbar(),t.menuBarView&&this._initMenuBar(t.menuBarView),this.fire("ready");}},{key:"destroy",value:function destroy(){_superPropGet(zk,"destroy",this,3)([]);var e=this.view;this.editor.editing.view.detachDomRoot(e.editable.name),e.destroy();}},{key:"_initToolbar",value:function _initToolbar(){var e=this.editor,t=this.view,i=t.editable.element,n=t.toolbar;t.panel.bind("isVisible").to(this.focusTracker,"isFocused"),t.bind("viewportTopOffset").to(this,"viewportOffset",function(_ref137){var e=_ref137.top;return e||0;}),t.listenTo(e.ui,"update",function(){t.panel.isVisible&&t.panel.pin({target:i,positions:t.panelPositions});}),n.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(n);}},{key:"_initPlaceholder",value:function _initPlaceholder(){var e=this.editor,t=e.editing.view,i=t.document.getRoot(),n=e.config.get("placeholder");if(n){var _e512="string"==typeof n?n:n[i.rootName];_e512&&(i.placeholder=_e512);}Zr({view:t,element:i,isDirectHost:!1,keepOnFocus:!0});}}]);}(Pb);var Hk=Oo("px");var $k=/*#__PURE__*/function(_Ib5){function $k(e,t,i){var _this487;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,$k);_this487=_callSuper(this,$k,[e]),_defineProperty(_assertThisInitialized(_this487),"toolbar",void 0),_defineProperty(_assertThisInitialized(_this487),"panel",void 0),_defineProperty(_assertThisInitialized(_this487),"panelPositions",void 0),_defineProperty(_assertThisInitialized(_this487),"editable",void 0),_defineProperty(_assertThisInitialized(_this487),"_resizeObserver",void 0),_this487.toolbar=new Kf(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull,isFloating:!0}),n.useMenuBar&&(_this487.menuBarView=new hw(e)),_this487.set("viewportTopOffset",0),_this487.panel=new Df(e),_this487.panelPositions=_this487._getPanelPositions(),_this487.panel.extendTemplate({attributes:{"class":"ck-toolbar-container"}}),_this487.editable=new Ob(e,t,i,{label:n.label}),_this487._resizeObserver=null;return _this487;}_inherits($k,_Ib5);return _createClass($k,[{key:"render",value:function render(){var _this488=this;_superPropGet($k,"render",this,3)([]),this.body.add(this.panel),this.registerChild(this.editable),this.menuBarView?this.panel.content.addMany([this.menuBarView,this.toolbar]):this.panel.content.add(this.toolbar);if(this.toolbar.options.shouldGroupWhenFull){var _e513=this.editable.element;this._resizeObserver=new Vo(_e513,function(){_this488.toolbar.maxWidth=Hk(new Eo(_e513).width);});}}},{key:"destroy",value:function destroy(){_superPropGet($k,"destroy",this,3)([]),this._resizeObserver&&this._resizeObserver.destroy();}},{key:"_getPanelPositionTop",value:function _getPanelPositionTop(e,t){var i;return i=e.top>t.height+this.viewportTopOffset?e.top-t.height:e.bottom>t.height+this.viewportTopOffset+50?this.viewportTopOffset:e.bottom,i;}},{key:"_getPanelPositions",value:function _getPanelPositions(){var _this489=this;var e=[function(e,t){return{top:_this489._getPanelPositionTop(e,t),left:e.left,name:"toolbar_west",config:{withArrow:!1}};},function(e,t){return{top:_this489._getPanelPositionTop(e,t),left:e.left+e.width-t.width,name:"toolbar_east",config:{withArrow:!1}};}];return"ltr"===this.locale.uiLanguageDirection?e:e.reverse();}}]);}(Ib);var Uk=/*#__PURE__*/function(_bm4){function Uk(e){var _this490;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Uk);if(!Wk(e)&&void 0!==t.initialData)throw new A("editor-create-initial-data",null);_this490=_callSuper(this,Uk,[t]),_defineProperty(_assertThisInitialized(_this490),"ui",void 0),_this490.config.define("menuBar.isVisible",!1),void 0===_this490.config.get("initialData")&&_this490.config.set("initialData",function(e){return Wk(e)?_o(e):e;}(e)),_this490.model.document.createRoot(),Wk(e)&&(_this490.sourceElement=e,wm(_assertThisInitialized(_this490),e));var i=!_this490.config.get("toolbar.shouldNotGroupWhenFull"),n=_this490.config.get("menuBar"),s=new $k(_this490.locale,_this490.editing.view,_this490.sourceElement,{shouldToolbarGroupWhenFull:i,useMenuBar:n.isVisible,label:_this490.config.get("label")});_this490.ui=new zk(_this490,s),fm(_this490);return _this490;}_inherits(Uk,_bm4);return _createClass(Uk,[{key:"destroy",value:function destroy(){var _this491=this;var e=this.getData();return this.ui.destroy(),_superPropGet(Uk,"destroy",this,3)([]).then(function(){_this491.sourceElement&&_this491.updateSourceElement(e);});}}],[{key:"create",value:function create(e){var _this492=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(i){if(Wk(e)&&"TEXTAREA"===e.tagName)throw new A("editor-wrong-element",null);var n=new _this492(e,t);i(n.initPlugins().then(function(){return n.ui.init();}).then(function(){return n.data.init(n.config.get("initialData"));}).then(function(){return n.fire("ready");}).then(function(){return n;}));});}}]);}(bm(gm));function Wk(e){return Ms(e);}var jk=/*#__PURE__*/function(_Pb6){function jk(e,t){var _this493;_classCallCheck(this,jk);_this493=_callSuper(this,jk,[e]),_defineProperty(_assertThisInitialized(_this493),"view",void 0),_defineProperty(_assertThisInitialized(_this493),"_lastFocusedEditableElement",void 0),_this493.view=t,_this493._lastFocusedEditableElement=null;return _this493;}_inherits(jk,_Pb6);return _createClass(jk,[{key:"init",value:function init(){var _this494=this;this.view.render(),this.focusTracker.on("change:focusedElement",function(e,t,i){for(var _i369=0,_Object$values3=Object.values(_this494.view.editables);_i369<_Object$values3.length;_i369++){var _e514=_Object$values3[_i369];i===_e514.element&&(_this494._lastFocusedEditableElement=_e514.element);}}),this.focusTracker.on("change:isFocused",function(e,t,i){i||(_this494._lastFocusedEditableElement=null);});for(var _i370=0,_Object$values4=Object.values(this.view.editables);_i370<_Object$values4.length;_i370++){var _e515=_Object$values4[_i370];this.addEditable(_e515);}this._initToolbar(),this._initMenuBar(this.view.menuBarView),this.fire("ready");}},{key:"addEditable",value:function addEditable(e,t){var _this495=this;var i=e.element;this.editor.editing.view.attachDomRoot(i,e.name),this.setEditableElement(e.name,i),e.bind("isFocused").to(this.focusTracker,"isFocused",this.focusTracker,"focusedElement",function(e,t){return!!e&&(t===i||_this495._lastFocusedEditableElement===i);}),this._initPlaceholder(e,t);}},{key:"removeEditable",value:function removeEditable(e){this.editor.editing.view.detachDomRoot(e.name),e.unbind("isFocused"),this.removeEditableElement(e.name);}},{key:"destroy",value:function destroy(){_superPropGet(jk,"destroy",this,3)([]);for(var _i371=0,_Object$values5=Object.values(this.view.editables);_i371<_Object$values5.length;_i371++){var _e516=_Object$values5[_i371];this.removeEditable(_e516);}this.view.destroy();}},{key:"_initToolbar",value:function _initToolbar(){var e=this.editor,t=this.view;t.toolbar.fillFromConfig(e.config.get("toolbar"),this.componentFactory),this.addToolbar(t.toolbar);}},{key:"_initPlaceholder",value:function _initPlaceholder(e,t){if(!t){var _i372=this.editor.config.get("placeholder");_i372&&(t="string"==typeof _i372?_i372:_i372[e.name]);}var i=this.editor.editing.view,n=i.document.getRoot(e.name);t&&(n.placeholder=t),Zr({view:i,element:n,isDirectHost:!1,keepOnFocus:!0});}}]);}(Pb);var qk=/*#__PURE__*/function(_Ib6){function qk(e,t,i){var _this496;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};_classCallCheck(this,qk);_this496=_callSuper(this,qk,[e]),_defineProperty(_assertThisInitialized(_this496),"toolbar",void 0),_defineProperty(_assertThisInitialized(_this496),"editables",void 0),_defineProperty(_assertThisInitialized(_this496),"editable",void 0),_defineProperty(_assertThisInitialized(_this496),"menuBarView",void 0),_defineProperty(_assertThisInitialized(_this496),"_editingView",void 0),_this496._editingView=t,_this496.toolbar=new Kf(e,{shouldGroupWhenFull:n.shouldToolbarGroupWhenFull}),_this496.menuBarView=new hw(e),_this496.editables={};var _iterator488=_createForOfIteratorHelper(i),_step488;try{for(_iterator488.s();!(_step488=_iterator488.n()).done;){var _e517=_step488.value;var _t324=n.editableElements?n.editableElements[_e517]:void 0;var _i373=n.label;"object"==_typeof(_i373)&&(_i373=_i373[_e517]),_this496.createEditable(_e517,_t324,_i373);}}catch(err){_iterator488.e(err);}finally{_iterator488.f();}_this496.editable=Object.values(_this496.editables)[0],_this496.toolbar.extendTemplate({attributes:{"class":["ck-reset_all","ck-rounded-corners"],dir:e.uiLanguageDirection}}),_this496.menuBarView.extendTemplate({attributes:{"class":["ck-reset_all","ck-rounded-corners"],dir:e.uiLanguageDirection}});return _this496;}_inherits(qk,_Ib6);return _createClass(qk,[{key:"createEditable",value:function createEditable(e,t,i){var n=new Ob(this.locale,this._editingView,t,{label:i});return this.editables[e]=n,n.name=e,this.isRendered&&this.registerChild(n),n;}},{key:"removeEditable",value:function removeEditable(e){var t=this.editables[e];this.isRendered&&this.deregisterChild(t),delete this.editables[e],t.destroy();}},{key:"render",value:function render(){_superPropGet(qk,"render",this,3)([]),this.registerChild(Object.values(this.editables)),this.registerChild(this.toolbar),this.registerChild(this.menuBarView);}}]);}(Ib);var Gk=/*#__PURE__*/function(_gm2){function Gk(e){var _this497;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,Gk);var i=Object.keys(e),n=0===i.length||"string"==typeof e[i[0]];if(n&&void 0!==t.initialData&&Object.keys(t.initialData).length>0)throw new A("editor-create-initial-data",null);if(_this497=_callSuper(this,Gk,[t]),_defineProperty(_assertThisInitialized(_this497),"ui",void 0),_defineProperty(_assertThisInitialized(_this497),"sourceElements",void 0),_defineProperty(_assertThisInitialized(_this497),"_registeredRootsAttributesKeys",new Set()),_defineProperty(_assertThisInitialized(_this497),"_readOnlyRootLocks",new Map()),_this497.sourceElements=n?{}:e,void 0===_this497.config.get("initialData")){var _t325={};var _iterator489=_createForOfIteratorHelper(i),_step489;try{for(_iterator489.s();!(_step489=_iterator489.n()).done;){var _n207=_step489.value;_t325[_n207]=Kk(s=e[_n207])?_o(s):s;}}catch(err){_iterator489.e(err);}finally{_iterator489.f();}_this497.config.set("initialData",_t325);}var s;if(!n){var _iterator490=_createForOfIteratorHelper(i),_step490;try{for(_iterator490.s();!(_step490=_iterator490.n()).done;){var _t326=_step490.value;wm(_this497,e[_t326]);}}catch(err){_iterator490.e(err);}finally{_iterator490.f();}}_this497.editing.view.document.roots.on("add",function(e,t){t.unbind("isReadOnly"),t.bind("isReadOnly").to(_this497.editing.view.document,"isReadOnly",function(e){return e||_this497._readOnlyRootLocks.has(t.rootName);}),t.on("change:isReadOnly",function(e,i,n){var s=_this497.editing.view.createRangeIn(t);var _iterator491=_createForOfIteratorHelper(s.getItems()),_step491;try{for(_iterator491.s();!(_step491=_iterator491.n()).done;){var _e518=_step491.value;_e518.is("editableElement")&&(_e518.unbind("isReadOnly"),_e518.isReadOnly=n);}}catch(err){_iterator491.e(err);}finally{_iterator491.f();}});});for(var _i375=0,_i374=i;_i375<_i374.length;_i375++){var _e519=_i374[_i375];_this497.model.document.createRoot("$root",_e519);}if(_this497.config.get("lazyRoots")){var _iterator492=_createForOfIteratorHelper(_this497.config.get("lazyRoots")),_step492;try{for(_iterator492.s();!(_step492=_iterator492.n()).done;){var _e520=_step492.value;_this497.model.document.createRoot("$root",_e520)._isLoaded=!1;}}catch(err){_iterator492.e(err);}finally{_iterator492.f();}}if(_this497.config.get("rootsAttributes")){var _e521=_this497.config.get("rootsAttributes");for(var _i376=0,_Object$entries9=Object.entries(_e521);_i376<_Object$entries9.length;_i376++){var _Object$entries9$_i=_slicedToArray(_Object$entries9[_i376],2),_t327=_Object$entries9$_i[0],_i377=_Object$entries9$_i[1];if(!_this497.model.document.getRoot(_t327))throw new A("multi-root-editor-root-attributes-no-root",null);for(var _i378=0,_Object$keys9=Object.keys(_i377);_i378<_Object$keys9.length;_i378++){var _e522=_Object$keys9[_i378];_this497.registerRootAttribute(_e522);}}_this497.data.on("init",function(){_this497.model.enqueueChange({isUndoable:!1},function(t){for(var _i379=0,_Object$entries10=Object.entries(_e521);_i379<_Object$entries10.length;_i379++){var _Object$entries10$_i=_slicedToArray(_Object$entries10[_i379],2),_i380=_Object$entries10$_i[0],_n208=_Object$entries10$_i[1];var _e523=_this497.model.document.getRoot(_i380);for(var _i381=0,_Object$entries11=Object.entries(_n208);_i381<_Object$entries11.length;_i381++){var _Object$entries11$_i=_slicedToArray(_Object$entries11[_i381],2),_i382=_Object$entries11$_i[0],_s142=_Object$entries11$_i[1];null!==_s142&&t.setAttribute(_i382,_s142,_e523);}}});});}var o={shouldToolbarGroupWhenFull:!_this497.config.get("toolbar.shouldNotGroupWhenFull"),editableElements:n?void 0:e,label:_this497.config.get("label")},r=new qk(_this497.locale,_this497.editing.view,i,o);_this497.ui=new jk(_this497,r),_this497.model.document.on("change:data",function(){var e=_this497.model.document.differ.getChangedRoots();var _iterator493=_createForOfIteratorHelper(e),_step493;try{for(_iterator493.s();!(_step493=_iterator493.n()).done;){var _t328=_step493.value;var _e524=_this497.model.document.getRoot(_t328.name);"detached"==_t328.state&&_this497.fire("detachRoot",_e524);}}catch(err){_iterator493.e(err);}finally{_iterator493.f();}var _iterator494=_createForOfIteratorHelper(e),_step494;try{for(_iterator494.s();!(_step494=_iterator494.n()).done;){var _t329=_step494.value;var _e525=_this497.model.document.getRoot(_t329.name);"attached"==_t329.state&&_this497.fire("addRoot",_e525);}}catch(err){_iterator494.e(err);}finally{_iterator494.f();}}),_this497.listenTo(_this497.model,"canEditAt",function(e,_ref138){var _ref139=_slicedToArray(_ref138,1),t=_ref139[0];if(!t)return;var i=!1;var _iterator495=_createForOfIteratorHelper(t.getRanges()),_step495;try{for(_iterator495.s();!(_step495=_iterator495.n()).done;){var _e526=_step495.value;var _t330=_e526.root;if(_this497._readOnlyRootLocks.has(_t330.rootName)){i=!0;break;}}}catch(err){_iterator495.e(err);}finally{_iterator495.f();}i&&(e["return"]=!1,e.stop());},{priority:"high"}),_this497.decorate("loadRoot"),_this497.on("loadRoot",function(e,_ref140){var _ref141=_slicedToArray(_ref140,1),t=_ref141[0];var i=_this497.model.document.getRoot(t);if(!i)throw new A("multi-root-editor-load-root-no-root",_this497,{rootName:t});i._isLoaded&&(E("multi-root-editor-load-root-already-loaded"),e.stop());},{priority:"highest"});return _this497;}_inherits(Gk,_gm2);return _createClass(Gk,[{key:"destroy",value:function destroy(){var _this498=this;var e=this.config.get("updateSourceElementOnDestroy"),t={};for(var _i383=0,_Object$keys10=Object.keys(this.sourceElements);_i383<_Object$keys10.length;_i383++){var _i384=_Object$keys10[_i383];t[_i384]=e?this.getData({rootName:_i384}):"";}return this.ui.destroy(),_superPropGet(Gk,"destroy",this,3)([]).then(function(){for(var _i385=0,_Object$keys11=Object.keys(_this498.sourceElements);_i385<_Object$keys11.length;_i385++){var _e527=_Object$keys11[_i385];Ro(_this498.sourceElements[_e527],t[_e527]);}});}},{key:"addRoot",value:function addRoot(e){var _this499=this;var _ref142=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref142$data=_ref142.data,t=_ref142$data===void 0?"":_ref142$data,_ref142$attributes=_ref142.attributes,i=_ref142$attributes===void 0?{}:_ref142$attributes,_ref142$elementName=_ref142.elementName,n=_ref142$elementName===void 0?"$root":_ref142$elementName,_ref142$isUndoable=_ref142.isUndoable,s=_ref142$isUndoable===void 0?!1:_ref142$isUndoable;var o=function o(s){var o=s.addRoot(e,n);t&&s.insert(_this499.data.parse(t,o),o,0);for(var _i386=0,_Object$keys12=Object.keys(i);_i386<_Object$keys12.length;_i386++){var _e528=_Object$keys12[_i386];_this499.registerRootAttribute(_e528),s.setAttribute(_e528,i[_e528],o);}};s?this.model.change(o):this.model.enqueueChange({isUndoable:!1},o);}},{key:"detachRoot",value:function detachRoot(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;t?this.model.change(function(t){return t.detachRoot(e);}):this.model.enqueueChange({isUndoable:!1},function(t){return t.detachRoot(e);});}},{key:"createEditable",value:function createEditable(e,t,i){var n=this.ui.view.createEditable(e.rootName,void 0,i);return this.ui.addEditable(n,t),this.editing.view.forceRender(),n.element;}},{key:"detachEditable",value:function detachEditable(e){var t=e.rootName,i=this.ui.view.editables[t];return this.ui.removeEditable(i),this.ui.view.removeEditable(t),i.element;}},{key:"loadRoot",value:function loadRoot(e){var _this500=this;var _ref143=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref143$data=_ref143.data,t=_ref143$data===void 0?"":_ref143$data,_ref143$attributes=_ref143.attributes,i=_ref143$attributes===void 0?{}:_ref143$attributes;var n=this.model.document.getRoot(e);this.model.enqueueChange({isUndoable:!1},function(e){t&&e.insert(_this500.data.parse(t,n),n,0);for(var _i387=0,_Object$keys13=Object.keys(i);_i387<_Object$keys13.length;_i387++){var _t331=_Object$keys13[_i387];_this500.registerRootAttribute(_t331),e.setAttribute(_t331,i[_t331],n);}n._isLoaded=!0,_this500.model.document.differ._bufferRootLoad(n);});}},{key:"getFullData",value:function getFullData(e){var t={};var _iterator496=_createForOfIteratorHelper(this.model.document.getRootNames()),_step496;try{for(_iterator496.s();!(_step496=_iterator496.n()).done;){var _i388=_step496.value;t[_i388]=this.data.get(_objectSpread(_objectSpread({},e),{},{rootName:_i388}));}}catch(err){_iterator496.e(err);}finally{_iterator496.f();}return t;}},{key:"getRootsAttributes",value:function getRootsAttributes(){var e={};var _iterator497=_createForOfIteratorHelper(this.model.document.getRootNames()),_step497;try{for(_iterator497.s();!(_step497=_iterator497.n()).done;){var _t332=_step497.value;e[_t332]=this.getRootAttributes(_t332);}}catch(err){_iterator497.e(err);}finally{_iterator497.f();}return e;}},{key:"getRootAttributes",value:function getRootAttributes(e){var t={},i=this.model.document.getRoot(e);var _iterator498=_createForOfIteratorHelper(this._registeredRootsAttributesKeys),_step498;try{for(_iterator498.s();!(_step498=_iterator498.n()).done;){var _e529=_step498.value;t[_e529]=i.hasAttribute(_e529)?i.getAttribute(_e529):null;}}catch(err){_iterator498.e(err);}finally{_iterator498.f();}return t;}},{key:"registerRootAttribute",value:function registerRootAttribute(e){this._registeredRootsAttributesKeys.has(e)||(this._registeredRootsAttributesKeys.add(e),this.editing.model.schema.extend("$root",{allowAttributes:e}));}},{key:"disableRoot",value:function disableRoot(e,t){if("$graveyard"==e)throw new A("multi-root-editor-cannot-disable-graveyard-root",this);var i=this._readOnlyRootLocks.get(e);if(i)i.add(t);else{this._readOnlyRootLocks.set(e,new Set([t]));this.editing.view.document.getRoot(e).isReadOnly=!0,Array.from(this.commands.commands()).forEach(function(e){return e.affectsData&&e.refresh();});}}},{key:"enableRoot",value:function enableRoot(e,t){var i=this._readOnlyRootLocks.get(e);if(i&&i.has(t))if(1===i.size){this._readOnlyRootLocks["delete"](e);this.editing.view.document.getRoot(e).isReadOnly=this.isReadOnly,Array.from(this.commands.commands()).forEach(function(e){return e.affectsData&&e.refresh();});}else i["delete"](t);}},{key:"_verifyRootsWithInitialData",value:function _verifyRootsWithInitialData(){var e=this.config.get("initialData");var _iterator499=_createForOfIteratorHelper(this.model.document.getRootNames()),_step499;try{for(_iterator499.s();!(_step499=_iterator499.n()).done;){var _t334=_step499.value;if(!(_t334 in e))throw new A("multi-root-editor-root-initial-data-mismatch",null);}}catch(err){_iterator499.e(err);}finally{_iterator499.f();}for(var _i389=0,_Object$keys14=Object.keys(e);_i389<_Object$keys14.length;_i389++){var _t333=_Object$keys14[_i389];var _e530=this.model.document.getRoot(_t333);if(!_e530||!_e530.isAttached())throw new A("multi-root-editor-root-initial-data-mismatch",null);}}}],[{key:"create",value:function create(e){var _this501=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new Promise(function(i){for(var _i390=0,_Object$values6=Object.values(e);_i390<_Object$values6.length;_i390++){var _t335=_Object$values6[_i390];if(Kk(_t335)&&"TEXTAREA"===_t335.tagName)throw new A("editor-wrong-element",null);}var n=new _this501(e,t);i(n.initPlugins().then(function(){return n.ui.init();}).then(function(){return n._verifyRootsWithInitialData(),n.data.init(n.config.get("initialData"));}).then(function(){return n.fire("ready");}).then(function(){return n;}));});}}]);}(gm);function Kk(e){return Ms(e);}var Zk=/*#__PURE__*/function(_Hr16){function Zk(e){var _this502;_classCallCheck(this,Zk);_this502=_callSuper(this,Zk,[e]),_this502.affectsData=!1;return _this502;}_inherits(Zk,_Hr16);return _createClass(Zk,[{key:"execute",value:function execute(){var e=this.editor.model,t=e.document.selection;var i=e.schema.getLimitElement(t);if(t.containsEntireContent(i)||!Jk(e.schema,i))do{if(i=i.parent,!i)return;}while(!Jk(e.schema,i));e.change(function(e){e.setSelection(i,"in");});}}]);}(Hr);function Jk(e,t){return e.isLimit(t)&&(e.checkChild(t,"$text")||e.checkChild(t,"paragraph"));}var Qk=rr("Ctrl+A");var Yk=/*#__PURE__*/function(_Dr74){function Yk(){_classCallCheck(this,Yk);return _callSuper(this,Yk,arguments);}_inherits(Yk,_Dr74);return _createClass(Yk,[{key:"init",value:function init(){var e=this.editor,t=e.t,i=e.editing.view.document;e.commands.add("selectAll",new Zk(e)),this.listenTo(i,"keydown",function(t,i){or(i)===Qk&&(e.execute("selectAll"),i.preventDefault());}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Select all"),keystroke:"CTRL+A"}]});}}],[{key:"pluginName",get:function get(){return"SelectAllEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Xk=/*#__PURE__*/function(_Dr75){function Xk(){_classCallCheck(this,Xk);return _callSuper(this,Xk,arguments);}_inherits(Xk,_Dr75);return _createClass(Xk,[{key:"init",value:function init(){var _this503=this;var e=this.editor;e.ui.componentFactory.add("selectAll",function(){var e=_this503._createButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:selectAll",function(){return _this503._createButton(Rg);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get("selectAll"),s=new e(t.locale),o=i.t;return s.set({label:o("Select all"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',keystroke:"Ctrl+A"}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",function(){t.execute("selectAll"),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"SelectAllUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var eC=/*#__PURE__*/function(_Dr76){function eC(){_classCallCheck(this,eC);return _callSuper(this,eC,arguments);}_inherits(eC,_Dr76);return _createClass(eC,null,[{key:"requires",get:function get(){return[Yk,Xk];}},{key:"pluginName",get:function get(){return"SelectAll";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var tC=/*#__PURE__*/function(_Hr17){function tC(e){var _this504;_classCallCheck(this,tC);_this504=_callSuper(this,tC,[e]),_defineProperty(_assertThisInitialized(_this504),"_stack",[]),_defineProperty(_assertThisInitialized(_this504),"_createdBatches",new WeakSet()),_this504.refresh(),_this504._isEnabledBasedOnSelection=!1,_this504.listenTo(e.data,"set",function(e,t){t[1]=_objectSpread({},t[1]);var i=t[1];i.batchType||(i.batchType={isUndoable:!1});},{priority:"high"}),_this504.listenTo(e.data,"set",function(e,t){t[1].batchType.isUndoable||_this504.clearStack();});return _this504;}_inherits(tC,_Hr17);return _createClass(tC,[{key:"refresh",value:function refresh(){this.isEnabled=this._stack.length>0;}},{key:"createdBatches",get:function get(){return this._createdBatches;}},{key:"addBatch",value:function addBatch(e){var t=this.editor.model.document.selection,i={ranges:t.hasOwnRange?Array.from(t.getRanges()):[],isBackward:t.isBackward};this._stack.push({batch:e,selection:i}),this.refresh();}},{key:"clearStack",value:function clearStack(){this._stack=[],this.refresh();}},{key:"_restoreSelection",value:function _restoreSelection(e,t,i){var n=this.editor.model,s=n.document,o=[],r=e.map(function(e){return e.getTransformedByOperations(i);}),a=r.flat();var _iterator500=_createForOfIteratorHelper(r),_step500;try{for(_iterator500.s();!(_step500=_iterator500.n()).done;){var _e531=_step500.value;var _t336=_e531.filter(function(e){return e.root!=s.graveyard;}).filter(function(e){return!nC(e,a);});_t336.length&&(iC(_t336),o.push(_t336[0]));}}catch(err){_iterator500.e(err);}finally{_iterator500.f();}o.length&&n.change(function(e){e.setSelection(o,{backward:t});});}},{key:"_undo",value:function _undo(e,t){var i=this.editor.model,n=i.document;this._createdBatches.add(t);var s=e.operations.slice().filter(function(e){return e.isDocumentOperation;});s.reverse();var _iterator501=_createForOfIteratorHelper(s),_step501;try{for(_iterator501.s();!(_step501=_iterator501.n()).done;){var _e532=_step501.value;var _s143=_e532.baseVersion+1,_o80=Array.from(n.history.getOperations(_s143)),r=Jd([_e532.getReversed()],_o80,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;var _iterator502=_createForOfIteratorHelper(r),_step502;try{for(_iterator502.s();!(_step502=_iterator502.n()).done;){var _s144=_step502.value;var _o81=_s144.affectedSelectable;_o81&&!i.canEditAt(_o81)&&(_s144=new zd(_s144.baseVersion)),t.addOperation(_s144),i.applyOperation(_s144),n.history.setOperationAsUndone(_e532,_s144);}}catch(err){_iterator502.e(err);}finally{_iterator502.f();}}}catch(err){_iterator501.e(err);}finally{_iterator501.f();}}}]);}(Hr);function iC(e){e.sort(function(e,t){return e.start.isBefore(t.start)?-1:1;});for(var _t337=1;_t337<e.length;_t337++){var _i391=e[_t337-1].getJoined(e[_t337],!0);_i391&&(_t337--,e.splice(_t337,2,_i391));}}function nC(e,t){return t.some(function(t){return t!==e&&t.containsRange(e,!0);});}var sC=/*#__PURE__*/function(_tC2){function sC(){_classCallCheck(this,sC);return _callSuper(this,sC,arguments);}_inherits(sC,_tC2);return _createClass(sC,[{key:"execute",value:function execute(){var _this505=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var t=e?this._stack.findIndex(function(t){return t.batch==e;}):this._stack.length-1,i=this._stack.splice(t,1)[0],n=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(n,function(){_this505._undo(i.batch,n);var e=_this505.editor.model.document.history.getOperations(i.batch.baseVersion);_this505._restoreSelection(i.selection.ranges,i.selection.isBackward,e);}),this.fire("revert",i.batch,n),this.refresh();}}]);}(tC);var oC=/*#__PURE__*/function(_tC3){function oC(){_classCallCheck(this,oC);return _callSuper(this,oC,arguments);}_inherits(oC,_tC3);return _createClass(oC,[{key:"execute",value:function execute(){var _this506=this;var e=this._stack.pop(),t=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(t,function(){var i=e.batch.operations[e.batch.operations.length-1].baseVersion+1,n=_this506.editor.model.document.history.getOperations(i);_this506._restoreSelection(e.selection.ranges,e.selection.isBackward,n),_this506._undo(e.batch,t);}),this.refresh();}}]);}(tC);var rC=/*#__PURE__*/function(_Dr77){function rC(){var _this507;_classCallCheck(this,rC);for(var _len66=arguments.length,args=new Array(_len66),_key66=0;_key66<_len66;_key66++){args[_key66]=arguments[_key66];}_this507=_callSuper(this,rC,[].concat(args));_defineProperty(_this507,"_undoCommand",void 0);_defineProperty(_this507,"_redoCommand",void 0);_defineProperty(_this507,"_batchRegistry",new WeakSet());return _this507;}_inherits(rC,_Dr77);return _createClass(rC,[{key:"init",value:function init(){var _this508=this;var e=this.editor,t=e.t;this._undoCommand=new sC(e),this._redoCommand=new oC(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",function(e,t){var i=t[0];if(!i.isDocumentOperation)return;var n=i.batch,s=_this508._redoCommand.createdBatches.has(n),o=_this508._undoCommand.createdBatches.has(n);_this508._batchRegistry.has(n)||(_this508._batchRegistry.add(n),n.isUndoable&&(s?_this508._undoCommand.addBatch(n):o||(_this508._undoCommand.addBatch(n),_this508._redoCommand.clearStack())));},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",function(e,t,i){_this508._redoCommand.addBatch(i);}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Undo"),keystroke:"CTRL+Z"},{label:t("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]});}}],[{key:"pluginName",get:function get(){return"UndoEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var aC=/*#__PURE__*/function(_Dr78){function aC(){_classCallCheck(this,aC);return _callSuper(this,aC,arguments);}_inherits(aC,_Dr78);return _createClass(aC,[{key:"init",value:function init(){var e=this.editor,t=e.locale,i=e.t,n="ltr"==t.uiLanguageDirection?vm.undo:vm.redo,s="ltr"==t.uiLanguageDirection?vm.redo:vm.undo;this._addButtonsToFactory("undo",i("Undo"),"CTRL+Z",n),this._addButtonsToFactory("redo",i("Redo"),"CTRL+Y",s);}},{key:"_addButtonsToFactory",value:function _addButtonsToFactory(e,t,i,n){var _this509=this;var s=this.editor;s.ui.componentFactory.add(e,function(){var s=_this509._createButton(pg,e,t,i,n);return s.set({tooltip:!0}),s;}),s.ui.componentFactory.add("menuBar:"+e,function(){return _this509._createButton(Rg,e,t,i,n);});}},{key:"_createButton",value:function _createButton(e,t,i,n,s){var o=this.editor,r=o.locale,a=o.commands.get(t),l=new e(r);return l.set({label:i,icon:s,keystroke:n}),l.bind("isEnabled").to(a,"isEnabled"),this.listenTo(l,"execute",function(){o.execute(t),o.editing.view.focus();}),l;}}],[{key:"pluginName",get:function get(){return"UndoUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var lC=/*#__PURE__*/function(_Dr79){function lC(){_classCallCheck(this,lC);return _callSuper(this,lC,arguments);}_inherits(lC,_Dr79);return _createClass(lC,null,[{key:"requires",get:function get(){return[rC,aC];}},{key:"pluginName",get:function get(){return"Undo";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var cC=/*#__PURE__*/function(_Dr80){function cC(){_classCallCheck(this,cC);return _callSuper(this,cC,arguments);}_inherits(cC,_Dr80);return _createClass(cC,null,[{key:"requires",get:function get(){return[Fg,Qy,K_,eC,Y_,Ow,lC];}},{key:"pluginName",get:function get(){return"Essentials";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var dC=/*#__PURE__*/function(_lg55){function dC(e){var _this510;_classCallCheck(this,dC);_this510=_callSuper(this,dC,[e]);_defineProperty(_this510,"children",void 0);_defineProperty(_this510,"_findInputView",void 0);_defineProperty(_this510,"_replaceInputView",void 0);_defineProperty(_this510,"_findButtonView",void 0);_defineProperty(_this510,"_findPrevButtonView",void 0);_defineProperty(_this510,"_findNextButtonView",void 0);_defineProperty(_this510,"_advancedOptionsCollapsibleView",void 0);_defineProperty(_this510,"_matchCaseSwitchView",void 0);_defineProperty(_this510,"_wholeWordsOnlySwitchView",void 0);_defineProperty(_this510,"_replaceButtonView",void 0);_defineProperty(_this510,"_replaceAllButtonView",void 0);_defineProperty(_this510,"_inputsDivView",void 0);_defineProperty(_this510,"_actionButtonsDivView",void 0);_defineProperty(_this510,"_focusTracker",void 0);_defineProperty(_this510,"_keystrokes",void 0);_defineProperty(_this510,"_focusables",void 0);_defineProperty(_this510,"focusCycler",void 0);var t=e.t;_this510.children=_this510.createCollection(),_this510.set("matchCount",0),_this510.set("highlightOffset",0),_this510.set("isDirty",!1),_this510.set("_areCommandsEnabled",{}),_this510.set("_resultsCounterText",""),_this510.set("_matchCase",!1),_this510.set("_wholeWordsOnly",!1),_this510.bind("_searchResultsFound").to(_this510,"matchCount",_this510,"isDirty",function(e,t){return e>0&&!t;}),_this510._findInputView=_this510._createInputField(t("Find in text…")),_this510._findPrevButtonView=_this510._createButton({label:t("Previous result"),"class":"ck-button-prev",icon:vm.previousArrow,keystroke:"Shift+F3",tooltip:!0}),_this510._findNextButtonView=_this510._createButton({label:t("Next result"),"class":"ck-button-next",icon:vm.previousArrow,keystroke:"F3",tooltip:!0}),_this510._replaceInputView=_this510._createInputField(t("Replace with…"),"ck-labeled-field-replace"),_this510._inputsDivView=_this510._createInputsDiv(),_this510._matchCaseSwitchView=_this510._createMatchCaseSwitch(),_this510._wholeWordsOnlySwitchView=_this510._createWholeWordsOnlySwitch(),_this510._advancedOptionsCollapsibleView=_this510._createAdvancedOptionsCollapsible(),_this510._replaceAllButtonView=_this510._createButton({label:t("Replace all"),"class":"ck-button-replaceall",withText:!0}),_this510._replaceButtonView=_this510._createButton({label:t("Replace"),"class":"ck-button-replace",withText:!0}),_this510._findButtonView=_this510._createButton({label:t("Find"),"class":"ck-button-find ck-button-action",withText:!0}),_this510._actionButtonsDivView=_this510._createActionButtonsDiv(),_this510._focusTracker=new _r(),_this510._keystrokes=new Cr(),_this510._focusables=new zm(),_this510.focusCycler=new _g({focusables:_this510._focusables,focusTracker:_this510._focusTracker,keystrokeHandler:_this510._keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this510.children.addMany([_this510._inputsDivView,_this510._advancedOptionsCollapsibleView,_this510._actionButtonsDivView]),_this510.setTemplate({tag:"form",attributes:{"class":["ck","ck-find-and-replace-form"],tabindex:"-1"},children:_this510.children});return _this510;}_inherits(dC,_lg55);return _createClass(dC,[{key:"render",value:function render(){_superPropGet(dC,"render",this,3)([]),hg({view:this}),this._initFocusCycling(),this._initKeystrokeHandling();}},{key:"destroy",value:function destroy(){_superPropGet(dC,"destroy",this,3)([]),this._focusTracker.destroy(),this._keystrokes.destroy();}},{key:"focus",value:function focus(e){-1===e?this.focusCycler.focusLast():this.focusCycler.focusFirst();}},{key:"reset",value:function reset(){this._findInputView.errorText=null,this.isDirty=!0;}},{key:"_textToFind",get:function get(){return this._findInputView.fieldView.element.value;}},{key:"_textToReplace",get:function get(){return this._replaceInputView.fieldView.element.value;}},{key:"_createInputsDiv",value:function _createInputsDiv(){var _this511=this;var e=this.locale,t=e.t,i=new lg(e);return this._findInputView.fieldView.on("input",function(){_this511.isDirty=!0;}),this._findPrevButtonView.delegate("execute").to(this,"findPrevious"),this._findNextButtonView.delegate("execute").to(this,"findNext"),this._findPrevButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",function(_ref144){var e=_ref144.findPrevious;return e;}),this._findNextButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",function(_ref145){var e=_ref145.findNext;return e;}),this._injectFindResultsCounter(),this._replaceInputView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",function(_ref146,t){var e=_ref146.replace;return e&&t;}),this._replaceInputView.bind("infoText").to(this._replaceInputView,"isEnabled",this._replaceInputView,"isFocused",function(e,i){return e||!i?"":t("Tip: Find some text first in order to replace it.");}),i.setTemplate({tag:"div",attributes:{"class":["ck","ck-find-and-replace-form__inputs"]},children:[this._findInputView,this._findPrevButtonView,this._findNextButtonView,this._replaceInputView]}),i;}},{key:"_onFindButtonExecute",value:function _onFindButtonExecute(){if(this._textToFind)this.isDirty=!1,this.fire("findNext",{searchText:this._textToFind,matchCase:this._matchCase,wholeWords:this._wholeWordsOnly});else{var _e533=this.t;this._findInputView.errorText=_e533("Text to find must not be empty.");}}},{key:"_injectFindResultsCounter",value:function _injectFindResultsCounter(){var _this512=this;var e=this.locale,t=e.t,i=this.bindTemplate,n=new lg(this.locale);this.bind("_resultsCounterText").to(this,"highlightOffset",this,"matchCount",function(e,i){return t("%0 of %1",[e,i]);}),n.setTemplate({tag:"span",attributes:{"class":["ck","ck-results-counter",i["if"]("isDirty","ck-hidden")]},children:[{text:i.to("_resultsCounterText")}]});var s=function s(){var t=_this512._findInputView.fieldView.element;if(!t||!No(t))return;var i=new Eo(n.element).width,s="ltr"===e.uiLanguageDirection?"paddingRight":"paddingLeft";t.style[s]=i?"calc( 2 * var(--ck-spacing-standard) + ".concat(i,"px )"):"";};this.on("change:_resultsCounterText",s,{priority:"low"}),this.on("change:isDirty",s,{priority:"low"}),this._findInputView.template.children[0].children.push(n);}},{key:"_createAdvancedOptionsCollapsible",value:function _createAdvancedOptionsCollapsible(){var e=this.locale.t,t=new jg(this.locale,[this._matchCaseSwitchView,this._wholeWordsOnlySwitchView]);return t.set({label:e("Advanced options"),isCollapsed:!0}),t;}},{key:"_createActionButtonsDiv",value:function _createActionButtonsDiv(){var _this513=this;var e=new lg(this.locale);return this._replaceButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",function(_ref147,t){var e=_ref147.replace;return e&&t;}),this._replaceAllButtonView.bind("isEnabled").to(this,"_areCommandsEnabled",this,"_searchResultsFound",function(_ref148,t){var e=_ref148.replaceAll;return e&&t;}),this._replaceButtonView.on("execute",function(){_this513.fire("replace",{searchText:_this513._textToFind,replaceText:_this513._textToReplace});}),this._replaceAllButtonView.on("execute",function(){_this513.fire("replaceAll",{searchText:_this513._textToFind,replaceText:_this513._textToReplace}),_this513.focus();}),this._findButtonView.on("execute",this._onFindButtonExecute.bind(this)),e.setTemplate({tag:"div",attributes:{"class":["ck","ck-find-and-replace-form__actions"]},children:[this._replaceAllButtonView,this._replaceButtonView,this._findButtonView]}),e;}},{key:"_createMatchCaseSwitch",value:function _createMatchCaseSwitch(){var _this514=this;var e=this.locale.t,t=new Dg(this.locale);return t.set({label:e("Match case"),withText:!0}),t.bind("isOn").to(this,"_matchCase"),t.on("execute",function(){_this514._matchCase=!_this514._matchCase,_this514.isDirty=!0;}),t;}},{key:"_createWholeWordsOnlySwitch",value:function _createWholeWordsOnlySwitch(){var _this515=this;var e=this.locale.t,t=new Dg(this.locale);return t.set({label:e("Whole words only"),withText:!0}),t.bind("isOn").to(this,"_wholeWordsOnly"),t.on("execute",function(){_this515._wholeWordsOnly=!_this515._wholeWordsOnly,_this515.isDirty=!0;}),t;}},{key:"_initFocusCycling",value:function _initFocusCycling(){var _this516=this;[this._findInputView,this._findPrevButtonView,this._findNextButtonView,this._replaceInputView,this._advancedOptionsCollapsibleView.buttonView,this._matchCaseSwitchView,this._wholeWordsOnlySwitchView,this._replaceAllButtonView,this._replaceButtonView,this._findButtonView].forEach(function(e){_this516._focusables.add(e),_this516._focusTracker.add(e.element);});}},{key:"_initKeystrokeHandling",value:function _initKeystrokeHandling(){var _this517=this;var e=function(_e534){function e(_x22){return _e534.apply(this,arguments);}e.toString=function(){return _e534.toString();};return e;}(function(e){return e.stopPropagation();}),t=function t(e){e.stopPropagation(),e.preventDefault();};this._keystrokes.listenTo(this.element),this._keystrokes.set("f3",function(e){t(e),_this517._findNextButtonView.fire("execute");}),this._keystrokes.set("shift+f3",function(e){t(e),_this517._findPrevButtonView.fire("execute");}),this._keystrokes.set("enter",function(e){var i=e.target;i===_this517._findInputView.fieldView.element?(_this517._areCommandsEnabled.findNext?_this517._findNextButtonView.fire("execute"):_this517._findButtonView.fire("execute"),t(e)):i!==_this517._replaceInputView.fieldView.element||_this517.isDirty||(_this517._replaceButtonView.fire("execute"),t(e));}),this._keystrokes.set("shift+enter",function(e){e.target===_this517._findInputView.fieldView.element&&(_this517._areCommandsEnabled.findPrevious?_this517._findPrevButtonView.fire("execute"):_this517._findButtonView.fire("execute"),t(e));}),this._keystrokes.set("arrowright",e),this._keystrokes.set("arrowleft",e),this._keystrokes.set("arrowup",e),this._keystrokes.set("arrowdown",e);}},{key:"_createButton",value:function _createButton(e){var t=new pg(this.locale);return t.set(e),t;}},{key:"_createInputField",value:function _createInputField(e,t){var i=new pf(this.locale,cp);return i.label=e,i["class"]=t,i;}}]);}(lg);var uC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 13.786 1.532-1.286 3.857 4.596a1 1 0 1 1-1.532 1.286l-3.857-4.596z"/><path d="M16.004 8.5a6.5 6.5 0 0 1-9.216 5.905c-1.154-.53-.863-1.415-.663-1.615.194-.194.564-.592 1.635-.141a4.5 4.5 0 0 0 5.89-5.904l-.104-.227 1.332-1.331c.045-.046.196-.041.224.007a6.47 6.47 0 0 1 .902 3.306zm-3.4-5.715c.562.305.742 1.106.354 1.494-.388.388-.995.414-1.476.178a4.5 4.5 0 0 0-6.086 5.882l.114.236-1.348 1.349c-.038.037-.17.022-.198-.023a6.5 6.5 0 0 1 5.54-9.9 6.469 6.469 0 0 1 3.1.784z"/><path d="M4.001 11.93.948 8.877a.2.2 0 0 1 .141-.341h6.106a.2.2 0 0 1 .141.341L4.283 11.93a.2.2 0 0 1-.282 0zm11.083-6.789 3.053 3.053a.2.2 0 0 1-.14.342H11.89a.2.2 0 0 1-.14-.342l3.052-3.053a.2.2 0 0 1 .282 0z"/></svg>';var hC=/*#__PURE__*/function(_Dr81){function hC(e){var _this518;_classCallCheck(this,hC);_this518=_callSuper(this,hC,[e]),_defineProperty(_assertThisInitialized(_this518),"formView",void 0),e.config.define("findAndReplace.uiType","dialog"),_this518.formView=null;return _this518;}_inherits(hC,_Dr81);return _createClass(hC,[{key:"init",value:function init(){var _this519=this;var e=this.editor,t="dropdown"===e.config.get("findAndReplace.uiType"),i=e.commands.get("find"),n=this.editor.t;e.ui.componentFactory.add("findAndReplace",function(){var n;return t?(n=_this519._createDropdown(),n.bind("isEnabled").to(i)):n=_this519._createDialogButtonForToolbar(),e.keystrokes.set("Ctrl+F",function(t,s){if(i.isEnabled){if(n instanceof xf){var _e535=n.buttonView;_e535.isOn||_e535.fire("execute");}else n.isOn?e.plugins.get("Dialog").view.focus():n.fire("execute");s();}}),n;}),t||e.ui.componentFactory.add("menuBar:findAndReplace",function(){return _this519._createDialogButtonForMenuBar();}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:n("Find in the document"),keystroke:"CTRL+F"}]});}},{key:"_createDropdown",value:function _createDropdown(){var _this520=this;var e=this.editor,t=e.locale.t,i=Xf(e.locale);return i.once("change:isOpen",function(){_this520.formView=_this520._createFormView(),_this520.formView.children.add(new wg(e.locale,{label:t("Find and replace")}),0),i.panelView.children.add(_this520.formView);}),i.on("change:isOpen",function(e,t,i){i?_this520._setupFormView():_this520.fire("searchReseted");},{priority:"low"}),i.buttonView.set({icon:uC,label:t("Find and replace"),keystroke:"CTRL+F",tooltip:!0}),i;}},{key:"_createDialogButtonForToolbar",value:function _createDialogButtonForToolbar(){var _this521=this;var e=this.editor,t=this._createButton(pg),i=e.plugins.get("Dialog");return t.set({tooltip:!0}),t.bind("isOn").to(i,"id",function(e){return"findAndReplace"===e;}),t.on("execute",function(){t.isOn?i.hide():_this521._showDialog();}),t;}},{key:"_createDialogButtonForMenuBar",value:function _createDialogButtonForMenuBar(){var _this522=this;var e=this._createButton(Rg),t=this.editor.plugins.get("Dialog"),i=this.editor.plugins.get("Dialog");return e.set({role:"menuitemcheckbox",isToggleable:!0}),e.bind("isOn").to(i,"id",function(e){return"findAndReplace"===e;}),e.on("execute",function(){"findAndReplace"!==t.id?_this522._showDialog():t.hide();}),e;}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.commands.get("find"),n=new e(t.locale),s=t.locale.t;return n.bind("isEnabled").to(i),n.set({icon:uC,label:s("Find and replace"),keystroke:"CTRL+F"}),n;}},{key:"_showDialog",value:function _showDialog(){var _this523=this;var e=this.editor,t=e.plugins.get("Dialog"),i=e.locale.t;this.formView||(this.formView=this._createFormView()),t.show({id:"findAndReplace",title:i("Find and replace"),content:this.formView,position:Eg.EDITOR_TOP_SIDE,onShow:function onShow(){_this523._setupFormView();},onHide:function onHide(){_this523.fire("searchReseted");}});}},{key:"_createFormView",value:function _createFormView(){var _this524=this;var e=this.editor,t=new(ug(dC))(e.locale),i=e.commands,n=this.editor.plugins.get("FindAndReplaceEditing").state;t.bind("highlightOffset").to(n,"highlightedOffset"),t.listenTo(n.results,"change",function(){t.matchCount=n.results.length;});var s=i.get("findNext"),o=i.get("findPrevious"),r=i.get("replace"),a=i.get("replaceAll");return t.bind("_areCommandsEnabled").to(s,"isEnabled",o,"isEnabled",r,"isEnabled",a,"isEnabled",function(e,t,i,n){return{findNext:e,findPrevious:t,replace:i,replaceAll:n};}),t.delegate("findNext","findPrevious","replace","replaceAll").to(this),t.on("change:isDirty",function(e,t,i){i&&_this524.fire("searchReseted");}),t;}},{key:"_setupFormView",value:function _setupFormView(){this.formView.disableCssTransitions(),this.formView.reset(),this.formView._findInputView.fieldView.select(),this.formView.enableCssTransitions();}}],[{key:"requires",get:function get(){return[Sg];}},{key:"pluginName",get:function get(){return"FindAndReplaceUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var mC=/*#__PURE__*/function(_Hr18){function mC(e,t){var _this525;_classCallCheck(this,mC);_this525=_callSuper(this,mC,[e]),_defineProperty(_assertThisInitialized(_this525),"_state",void 0),_this525.isEnabled=!0,_this525.affectsData=!1,_this525._state=t;return _this525;}_inherits(mC,_Hr18);return _createClass(mC,[{key:"execute",value:function execute(e){var _ref149=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},t=_ref149.matchCase,i=_ref149.wholeWords;var n=this.editor,s=n.model,o=n.plugins.get("FindAndReplaceUtils");var r,a="";r="string"==typeof e?function(){return{results:o.findByTextCallback(e,{matchCase:t,wholeWords:i}).apply(void 0,arguments),searchText:e};}:e;var l=r;r=function r(){var t=l.apply(void 0,arguments);return t&&"searchText"in t&&(a=t.searchText),t;};var c=s.document.getRootNames().reduce(function(e,t){return o.updateFindResultFromRange(s.createRangeIn(s.document.getRoot(t)),s,r,e);},null);return this._state.clear(s),this._state.results.addMany(c),this._state.highlightedResult=c.get(0),this._state.searchText=a,r&&(this._state.lastSearchCallback=r),this._state.matchCase=!!t,this._state.matchWholeWords=!!i,{results:c,findCallback:r};}}]);}(Hr);var gC=/*#__PURE__*/function(_Hr19){function gC(e,t){var _this526;_classCallCheck(this,gC);_this526=_callSuper(this,gC,[e]),_defineProperty(_assertThisInitialized(_this526),"_state",void 0),_this526.isEnabled=!0,_this526._state=t,_this526._isEnabledBasedOnSelection=!1;return _this526;}_inherits(gC,_Hr19);return _createClass(gC,[{key:"_replace",value:function _replace(e,t){var _this527=this;var i=this.editor.model,n=t.marker.getRange();i.canEditAt(n)&&i.change(function(s){if("$graveyard"===n.root.rootName)return void _this527._state.results.remove(t);var o={};var _iterator503=_createForOfIteratorHelper(n.getItems()),_step503;try{for(_iterator503.s();!(_step503=_iterator503.n()).done;){var _e536=_step503.value;if(_e536.is("$text")||_e536.is("$textProxy")){o=_e536.getAttributes();break;}}}catch(err){_iterator503.e(err);}finally{_iterator503.f();}i.insertContent(s.createText(e,o),n),_this527._state.results.has(t)&&_this527._state.results.remove(t);});}}]);}(Hr);var fC=/*#__PURE__*/function(_gC2){function fC(){_classCallCheck(this,fC);return _callSuper(this,fC,arguments);}_inherits(fC,_gC2);return _createClass(fC,[{key:"execute",value:function execute(e,t){this._replace(e,t);}}]);}(gC);var pC=/*#__PURE__*/function(_gC3){function pC(){_classCallCheck(this,pC);return _callSuper(this,pC,arguments);}_inherits(pC,_gC3);return _createClass(pC,[{key:"execute",value:function execute(e,t){var _this528=this;var i=this.editor,n=i.model,s=i.plugins.get("FindAndReplaceUtils"),o=t instanceof br?t:n.document.getRootNames().reduce(function(e,i){return s.updateFindResultFromRange(n.createRangeIn(n.document.getRoot(i)),n,s.findByTextCallback(t,_this528._state),e);},null);o.length&&n.change(function(){_toConsumableArray(o).forEach(function(t){_this528._replace(e,t);});});}}]);}(gC);var bC=/*#__PURE__*/function(_Hr20){function bC(e,t){var _this529;_classCallCheck(this,bC);_this529=_callSuper(this,bC,[e]),_defineProperty(_assertThisInitialized(_this529),"_state",void 0),_this529.affectsData=!1,_this529._state=t,_this529.isEnabled=!1,_this529.listenTo(_this529._state.results,"change",function(){_this529.isEnabled=_this529._state.results.length>1;});return _this529;}_inherits(bC,_Hr20);return _createClass(bC,[{key:"refresh",value:function refresh(){this.isEnabled=this._state.results.length>1;}},{key:"execute",value:function execute(){var e=this._state.results,t=e.getIndex(this._state.highlightedResult),i=t+1>=e.length?0:t+1;this._state.highlightedResult=this._state.results.get(i);}}]);}(Hr);var wC=/*#__PURE__*/function(_bC2){function wC(){_classCallCheck(this,wC);return _callSuper(this,wC,arguments);}_inherits(wC,_bC2);return _createClass(wC,[{key:"execute",value:function execute(){var e=this._state.results.getIndex(this._state.highlightedResult),t=e-1<0?this._state.results.length-1:e-1;this._state.highlightedResult=this._state.results.get(t);}}]);}(bC);var _C=/*#__PURE__*/function(_Zs20){function _C(e){var _this530;_classCallCheck(this,_C);_this530=_callSuper(this,_C),_this530.set("results",new br()),_this530.set("highlightedResult",null),_this530.set("highlightedOffset",0),_this530.set("searchText",""),_this530.set("replaceText",""),_this530.set("lastSearchCallback",null),_this530.set("matchCase",!1),_this530.set("matchWholeWords",!1),_this530.results.on("change",function(t,_ref150){var i=_ref150.removed,n=_ref150.index;if(Array.from(i).length){var _t338=!1;if(e.change(function(n){var _iterator504=_createForOfIteratorHelper(i),_step504;try{for(_iterator504.s();!(_step504=_iterator504.n()).done;){var _s145=_step504.value;_this530.highlightedResult===_s145&&(_t338=!0),e.markers.has(_s145.marker.name)&&n.removeMarker(_s145.marker);}}catch(err){_iterator504.e(err);}finally{_iterator504.f();}}),_t338){var _e537=n>=_this530.results.length?0:n;_this530.highlightedResult=_this530.results.get(_e537);}}}),_this530.on("change:highlightedResult",function(){_this530.refreshHighlightOffset();});return _this530;}_inherits(_C,_Zs20);return _createClass(_C,[{key:"clear",value:function clear(e){var _this531=this;this.searchText="",e.change(function(t){if(_this531.highlightedResult){var _i392=_this531.highlightedResult.marker.name.split(":")[1],_n209=e.markers.get("findResultHighlighted:".concat(_i392));_n209&&t.removeMarker(_n209);}_toConsumableArray(_this531.results).forEach(function(_ref151){var e=_ref151.marker;t.removeMarker(e);});}),this.results.clear();}},{key:"refreshHighlightOffset",value:function refreshHighlightOffset(){var e=this.highlightedResult,t=this.results,i={before:-1,same:0,after:1,different:1};this.highlightedOffset=e?Array.from(t).sort(function(e,t){return i[e.marker.getStart().compareWith(t.marker.getStart())];}).indexOf(e)+1:0;}}]);}(Zs());var vC=/*#__PURE__*/function(_Dr82){function vC(){_classCallCheck(this,vC);return _callSuper(this,vC,arguments);}_inherits(vC,_Dr82);return _createClass(vC,[{key:"updateFindResultFromRange",value:function updateFindResultFromRange(e,t,i,n){var _this532=this;var s=n||new br();return t.change(function(n){_toConsumableArray(e).forEach(function(_ref152){var e=_ref152.type,o=_ref152.item;if("elementStart"===e&&t.schema.checkChild(o,"$text")){var _e538=i({item:o,text:_this532.rangeToText(t.createRangeIn(o))});if(!_e538)return;"results"in _e538&&(_e538=_e538.results),_e538.forEach(function(e){var t="findResult:".concat(k()),i=n.addMarker(t,{usingOperation:!1,affectsData:!1,range:n.createRange(n.createPositionAt(o,e.start),n.createPositionAt(o,e.end))}),r=function(e,t){var i=e.find(function(_ref153){var e=_ref153.marker;return t.getStart().isBefore(e.getStart());});return i?e.getIndex(i):e.length;}(s,i);(function(e){return s.find(function(t){var i=t.marker,n=i.getRange(),s=e.getRange();return n.isEqual(s);});})(i)||s.add({id:t,label:e.label,marker:i},r);});}});}),s;}},{key:"rangeToText",value:function rangeToText(e){return Array.from(e.getItems()).reduce(function(e,t){return t.is("$text")||t.is("$textProxy")?e+t.data:"".concat(e,"\n");},"");}},{key:"findByTextCallback",value:function findByTextCallback(e,t){var i="gu";t.matchCase||(i+="i");var n="(".concat(Rs(e),")");if(t.wholeWords){var _t339="[^a-zA-ZÀ-ɏḀ-ỿ]";new RegExp("^"+_t339).test(e)||(n="(^|".concat(_t339,"|_)").concat(n)),new RegExp(_t339+"$").test(e)||(n="".concat(n,"(?=_|").concat(_t339,"|$)"));}var s=new RegExp(n,i);return function(_ref154){var e=_ref154.text;return _toConsumableArray(e.matchAll(s)).map(yC);};}}],[{key:"pluginName",get:function get(){return"FindAndReplaceUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function yC(e){var t=e.length-1;var i=e.index;return 3===e.length&&(i+=e[1].length),{label:e[t],start:i,end:i+e[t].length};}var kC=/*#__PURE__*/function(_Dr83){function kC(){var _this533;_classCallCheck(this,kC);for(var _len67=arguments.length,args=new Array(_len67),_key67=0;_key67<_len67;_key67++){args[_key67]=arguments[_key67];}_this533=_callSuper(this,kC,[].concat(args));_defineProperty(_this533,"state",void 0);_defineProperty(_this533,"_onDocumentChange",function(){var e=new Set(),t=new Set(),i=_this533.editor.model,n=_this533.state.results,s=i.document.differ.getChanges(),o=i.document.differ.getChangedMarkers();s.forEach(function(n){n.position&&("$text"===n.name||n.position.nodeAfter&&i.schema.isInline(n.position.nodeAfter)?(e.add(n.position.parent),_toConsumableArray(i.markers.getMarkersAtPosition(n.position)).forEach(function(e){t.add(e.name);})):"insert"===n.type&&n.position.nodeAfter&&e.add(n.position.nodeAfter));}),o.forEach(function(_ref155){var e=_ref155.name,i=_ref155.data.newRange;i&&"$graveyard"===i.start.root.rootName&&t.add(e);}),e.forEach(function(e){_toConsumableArray(i.markers.getMarkersIntersectingRange(i.createRangeIn(e))).forEach(function(e){return t.add(e.name);});}),t.forEach(function(e){n.has(e)&&(n.get(e)===_this533.state.highlightedResult&&(_this533.state.highlightedResult=null),n.remove(e));});var r=[],a=_this533.editor.plugins.get("FindAndReplaceUtils");e.forEach(function(e){var t=a.updateFindResultFromRange(i.createRangeOn(e),i,_this533.state.lastSearchCallback,n);r.push.apply(r,_toConsumableArray(t));}),o.forEach(function(e){if(e.data.newRange){var _t340=a.updateFindResultFromRange(e.data.newRange,i,_this533.state.lastSearchCallback,n);r.push.apply(r,_toConsumableArray(_t340));}}),!_this533.state.highlightedResult&&r.length?_this533.state.highlightedResult=r[0]:_this533.state.refreshHighlightOffset();});return _this533;}_inherits(kC,_Dr83);return _createClass(kC,[{key:"init",value:function init(){var _this534=this;this.state=new _C(this.editor.model),this.set("_isSearchActive",!1),this._defineConverters(),this._defineCommands(),this.listenTo(this.state,"change:highlightedResult",function(e,t,i,n){var s=_this534.editor.model;s.change(function(e){if(n){var _t341=n.marker.name.split(":")[1],_i393=s.markers.get("findResultHighlighted:".concat(_t341));_i393&&e.removeMarker(_i393);}if(i){var _t342=i.marker.name.split(":")[1];e.addMarker("findResultHighlighted:".concat(_t342),{usingOperation:!1,affectsData:!1,range:i.marker.getRange()});}});});var e=vs(function(e,t,i){if(i){var _e539=_this534.editor.editing.view.domConverter,_t343=_this534.editor.editing.mapper.toViewRange(i.marker.getRange());Uo({target:_e539.viewRangeToDom(_t343),viewportOffset:40});}}.bind(this),32);this.listenTo(this.state,"change:highlightedResult",e,{priority:"low"}),this.listenTo(this.editor,"destroy",e.cancel),this.on("change:_isSearchActive",function(e,t,i){i?_this534.listenTo(_this534.editor.model.document,"change:data",_this534._onDocumentChange):_this534.stopListening(_this534.editor.model.document,"change:data",_this534._onDocumentChange);});}},{key:"find",value:function find(e,t){return this._isSearchActive=!0,this.editor.execute("find",e,t),this.state.results;}},{key:"stop",value:function stop(){this.state.clear(this.editor.model),this._isSearchActive=!1;}},{key:"_defineCommands",value:function _defineCommands(){this.editor.commands.add("find",new mC(this.editor,this.state)),this.editor.commands.add("findNext",new bC(this.editor,this.state)),this.editor.commands.add("findPrevious",new wC(this.editor,this.state)),this.editor.commands.add("replace",new fC(this.editor,this.state)),this.editor.commands.add("replaceAll",new pC(this.editor,this.state));}},{key:"_defineConverters",value:function _defineConverters(){var e=this.editor;e.conversion["for"]("editingDowncast").markerToHighlight({model:"findResult",view:function view(_ref156){var e=_ref156.markerName;var _e$split4=e.split(":"),_e$split5=_slicedToArray(_e$split4,2),t=_e$split5[1];return{name:"span",classes:["ck-find-result"],attributes:{"data-find-result":t}};}}),e.conversion["for"]("editingDowncast").markerToHighlight({model:"findResultHighlighted",view:function view(_ref157){var e=_ref157.markerName;var _e$split6=e.split(":"),_e$split7=_slicedToArray(_e$split6,2),t=_e$split7[1];return{name:"span",classes:["ck-find-result_selected"],attributes:{"data-find-result":t}};}});}}],[{key:"requires",get:function get(){return[vC];}},{key:"pluginName",get:function get(){return"FindAndReplaceEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var CC=/*#__PURE__*/function(_Dr84){function CC(){_classCallCheck(this,CC);return _callSuper(this,CC,arguments);}_inherits(CC,_Dr84);return _createClass(CC,[{key:"init",value:function init(){var _this535=this;var e=this.editor.plugins.get("FindAndReplaceUI"),t=this.editor.plugins.get("FindAndReplaceEditing"),i=t.state;e.on("findNext",function(e,n){n?(i.searchText=n.searchText,t.find(n.searchText,n)):_this535.editor.execute("findNext");}),e.on("findPrevious",function(e,n){n&&i.searchText!==n.searchText?t.find(n.searchText):_this535.editor.execute("findPrevious");}),e.on("replace",function(e,n){i.searchText!==n.searchText&&t.find(n.searchText);var s=i.highlightedResult;s&&_this535.editor.execute("replace",n.replaceText,s);}),e.on("replaceAll",function(e,n){i.searchText!==n.searchText&&t.find(n.searchText),_this535.editor.execute("replaceAll",n.replaceText,i.results);}),e.on("searchReseted",function(){i.clear(_this535.editor.model),t.stop();});}}],[{key:"requires",get:function get(){return[kC,hC];}},{key:"pluginName",get:function get(){return"FindAndReplace";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var xC=/*#__PURE__*/function(_Hr21){function xC(e,t){var _this536;_classCallCheck(this,xC);_this536=_callSuper(this,xC,[e]),_defineProperty(_assertThisInitialized(_this536),"attributeKey",void 0),_this536.attributeKey=t;return _this536;}_inherits(xC,_Hr21);return _createClass(xC,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.value=t.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,this.attributeKey);}},{key:"execute",value:function execute(){var _this537=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document.selection,n=e.value,s=e.batch,o=function o(e){if(i.isCollapsed)n?e.setSelectionAttribute(_this537.attributeKey,n):e.removeSelectionAttribute(_this537.attributeKey);else{var _s146=t.schema.getValidRanges(i.getRanges(),_this537.attributeKey);var _iterator505=_createForOfIteratorHelper(_s146),_step505;try{for(_iterator505.s();!(_step505=_iterator505.n()).done;){var _t344=_step505.value;n?e.setAttribute(_this537.attributeKey,n,_t344):e.removeAttribute(_this537.attributeKey,_t344);}}catch(err){_iterator505.e(err);}finally{_iterator505.f();}}};s?t.enqueueChange(s,function(e){o(e);}):t.change(function(e){o(e);});}}]);}(Hr);var AC="fontSize",EC="fontFamily",TC="fontColor",PC="fontBackgroundColor";function SC(e,t){var i={model:{key:e,values:[]},view:{},upcastAlso:{}};var _iterator506=_createForOfIteratorHelper(t),_step506;try{for(_iterator506.s();!(_step506=_iterator506.n()).done;){var _e540=_step506.value;i.model.values.push(_e540.model),i.view[_e540.model]=_e540.view,_e540.upcastAlso&&(i.upcastAlso[_e540.model]=_e540.upcastAlso);}}catch(err){_iterator506.e(err);}finally{_iterator506.f();}return i;}function IC(e){return function(t){return t.getStyle(e).replace(/\s/g,"");};}function VC(e){return function(t,_ref158){var i=_ref158.writer;return i.createAttributeElement("span",{style:"".concat(e,":").concat(t)},{priority:7});};}var RC=/*#__PURE__*/function(_xC2){function RC(e){_classCallCheck(this,RC);return _callSuper(this,RC,[e,EC]);}_inherits(RC,_xC2);return _createClass(RC);}(xC);function OC(e){return e.map(BC).filter(function(e){return void 0!==e;});}function BC(e){return"object"==_typeof(e)?e:"default"===e?{title:"Default",model:void 0}:"string"==typeof e?function(e){var t=e.replace(/"|'/g,"").split(","),i=t[0],n=t.map(MC).join(", ");return{title:i,model:n,view:{name:"span",styles:{"font-family":n},priority:7}};}(e):void 0;}function MC(e){return(e=e.trim()).indexOf(" ")>0&&(e="'".concat(e,"'")),e;}var LC=/*#__PURE__*/function(_Dr85){function LC(e){var _this538;_classCallCheck(this,LC);_this538=_callSuper(this,LC,[e]),e.config.define(EC,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1});return _this538;}_inherits(LC,_Dr85);return _createClass(LC,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:EC}),e.model.schema.setAttributeProperties(EC,{isFormatting:!0,copyOnEnter:!0});var t=OC(e.config.get("fontFamily.options")).filter(function(e){return e.model;}),i=SC(EC,t);e.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(i),e.commands.add(EC,new RC(e));}},{key:"_prepareAnyValueConverters",value:function _prepareAnyValueConverters(){var e=this.editor;e.conversion["for"]("downcast").attributeToElement({model:EC,view:function view(e,_ref159){var t=_ref159.writer;return t.createAttributeElement("span",{style:"font-family:"+e},{priority:7});}}),e.conversion["for"]("upcast").elementToAttribute({model:{key:EC,value:function value(e){return e.getStyle("font-family");}},view:{name:"span",styles:{"font-family":/.*/}}});}},{key:"_prepareCompatibilityConverter",value:function _prepareCompatibilityConverter(){this.editor.conversion["for"]("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:EC,value:function value(e){return e.getAttribute("face");}}});}}],[{key:"pluginName",get:function get(){return"FontFamilyEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var FC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';var NC=/*#__PURE__*/function(_Dr86){function NC(){_classCallCheck(this,NC);return _callSuper(this,NC,arguments);}_inherits(NC,_Dr86);return _createClass(NC,[{key:"init",value:function init(){var _this539=this;var e=this.editor,t=e.t,i=this._getLocalizedOptions(),n=e.commands.get(EC),s=t("Font Family"),o=function(e,t){var i=new br();var _iterator507=_createForOfIteratorHelper(e),_step507;try{var _loop17=function _loop17(){var n=_step507.value;var e={type:"button",model:new Fb({commandName:EC,commandParam:n.model,label:n.title,role:"menuitemradio",withText:!0})};e.model.bind("isOn").to(t,"value",function(e){return e===n.model||!(!e||!n.model)&&e.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase();}),n.view&&"string"!=typeof n.view&&n.view.styles&&e.model.set("labelStyle","font-family: ".concat(n.view.styles["font-family"])),i.add(e);};for(_iterator507.s();!(_step507=_iterator507.n()).done;){_loop17();}}catch(err){_iterator507.e(err);}finally{_iterator507.f();}return i;}(i,n);e.ui.componentFactory.add(EC,function(t){var i=Xf(t);return sp(i,o,{role:"menu",ariaLabel:s}),i.buttonView.set({label:s,icon:FC,tooltip:!0}),i.extendTemplate({attributes:{"class":"ck-font-family-dropdown"}}),i.bind("isEnabled").to(n),_this539.listenTo(i,"execute",function(t){e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus();}),i;}),e.ui.componentFactory.add("menuBar:".concat(EC),function(t){var i=new aw(t);i.buttonView.set({label:s,icon:FC}),i.bind("isEnabled").to(n);var r=new lw(t);var _iterator508=_createForOfIteratorHelper(o),_step508;try{var _loop18=function _loop18(){var n=_step508.value;var s=new ub(t,i),o=new Rg(t);o.set({role:"menuitemradio",isToggleable:!0}),o.bind.apply(o,_toConsumableArray(Object.keys(n.model))).to(n.model),o.delegate("execute").to(i),o.on("execute",function(){e.execute(n.model.commandName,{value:n.model.commandParam}),e.editing.view.focus();}),s.children.add(o),r.items.add(s);};for(_iterator508.s();!(_step508=_iterator508.n()).done;){_loop18();}}catch(err){_iterator508.e(err);}finally{_iterator508.f();}return i.panelView.children.add(r),i;});}},{key:"_getLocalizedOptions",value:function _getLocalizedOptions(){var e=this.editor,t=e.t;return OC(e.config.get(EC).options).map(function(e){return"Default"===e.title&&(e.title=t("Default")),e;});}}],[{key:"pluginName",get:function get(){return"FontFamilyUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var DC=/*#__PURE__*/function(_Dr87){function DC(){_classCallCheck(this,DC);return _callSuper(this,DC,arguments);}_inherits(DC,_Dr87);return _createClass(DC,null,[{key:"requires",get:function get(){return[LC,NC];}},{key:"pluginName",get:function get(){return"FontFamily";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var zC=/*#__PURE__*/function(_xC3){function zC(e){_classCallCheck(this,zC);return _callSuper(this,zC,[e,AC]);}_inherits(zC,_xC3);return _createClass(zC);}(xC);function HC(e){return e.map(function(e){return function(e){"number"==typeof e&&(e=String(e));if("object"==_typeof(e)&&(t=e,t.title&&t.model&&t.view))return UC(e);var t;var i=function(e){return"string"==typeof e?$C[e]:$C[e.model];}(e);if(i)return UC(i);if("default"===e)return{model:void 0,title:"Default"};if(function(e){var t;if("object"==_typeof(e)){if(!e.model)throw new A("font-size-invalid-definition",null,e);t=parseFloat(e.model);}else t=parseFloat(e);return isNaN(t);}(e))return;return function(e){"string"==typeof e&&(e={title:e,model:"".concat(parseFloat(e),"px")});return e.view={name:"span",styles:{"font-size":e.model}},UC(e);}(e);}(e);}).filter(function(e){return void 0!==e;});}var $C={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}};},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}};},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}};},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}};}};function UC(e){return e.view&&"string"!=typeof e.view&&!e.view.priority&&(e.view.priority=7),e;}var WC=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];var jC=/*#__PURE__*/function(_Dr88){function jC(e){var _this540;_classCallCheck(this,jC);_this540=_callSuper(this,jC,[e]),e.config.define(AC,{options:["tiny","small","default","big","huge"],supportAllValues:!1});return _this540;}_inherits(jC,_Dr88);return _createClass(jC,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:AC}),e.model.schema.setAttributeProperties(AC,{isFormatting:!0,copyOnEnter:!0});var t=e.config.get("fontSize.supportAllValues"),i=HC(this.editor.config.get("fontSize.options")).filter(function(e){return e.model;}),n=SC(AC,i);t?(this._prepareAnyValueConverters(n),this._prepareCompatibilityConverter()):e.conversion.attributeToElement(n),e.commands.add(AC,new zC(e));}},{key:"_prepareAnyValueConverters",value:function _prepareAnyValueConverters(e){var t=this.editor,i=e.model.values.filter(function(e){return!nh(String(e))&&!oh(String(e));});if(i.length)throw new A("font-size-invalid-use-of-named-presets",null,{presets:i});t.conversion["for"]("downcast").attributeToElement({model:AC,view:function view(e,_ref160){var t=_ref160.writer;if(e)return t.createAttributeElement("span",{style:"font-size:"+e},{priority:7});}}),t.conversion["for"]("upcast").elementToAttribute({model:{key:AC,value:function value(e){return e.getStyle("font-size");}},view:{name:"span",styles:{"font-size":/.*/}}});}},{key:"_prepareCompatibilityConverter",value:function _prepareCompatibilityConverter(){this.editor.conversion["for"]("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:AC,value:function value(e){var t=e.getAttribute("size"),i="-"===t[0]||"+"===t[0];var n=parseInt(t,10);i&&(n=3+n);var s=WC.length-1,o=Math.min(Math.max(n,0),s);return WC[o];}}});}}],[{key:"pluginName",get:function get(){return"FontSizeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var qC='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';var GC=/*#__PURE__*/function(_Dr89){function GC(){_classCallCheck(this,GC);return _callSuper(this,GC,arguments);}_inherits(GC,_Dr89);return _createClass(GC,[{key:"init",value:function init(){var _this541=this;var e=this.editor,t=e.t,i=this._getLocalizedOptions(),n=e.commands.get(AC),s=t("Font Size"),o=function(e,t){var i=new br();var _iterator509=_createForOfIteratorHelper(e),_step509;try{var _loop19=function _loop19(){var n=_step509.value;var e={type:"button",model:new Fb({commandName:AC,commandParam:n.model,label:n.title,"class":"ck-fontsize-option",role:"menuitemradio",withText:!0})};n.view&&"string"!=typeof n.view&&(n.view.styles&&e.model.set("labelStyle","font-size:".concat(n.view.styles["font-size"])),n.view.classes&&e.model.set("class","".concat(e.model["class"]," ").concat(n.view.classes))),e.model.bind("isOn").to(t,"value",function(e){return e===n.model;}),i.add(e);};for(_iterator509.s();!(_step509=_iterator509.n()).done;){_loop19();}}catch(err){_iterator509.e(err);}finally{_iterator509.f();}return i;}(i,n);e.ui.componentFactory.add(AC,function(t){var i=Xf(t);return sp(i,o,{role:"menu",ariaLabel:s}),i.buttonView.set({label:s,icon:qC,tooltip:!0}),i.extendTemplate({attributes:{"class":["ck-font-size-dropdown"]}}),i.bind("isEnabled").to(n),_this541.listenTo(i,"execute",function(t){e.execute(t.source.commandName,{value:t.source.commandParam}),e.editing.view.focus();}),i;}),e.ui.componentFactory.add("menuBar:".concat(AC),function(t){var i=new aw(t);i.buttonView.set({label:s,icon:qC}),i.bind("isEnabled").to(n);var r=new lw(t);var _iterator510=_createForOfIteratorHelper(o),_step510;try{var _loop20=function _loop20(){var n=_step510.value;var s=new ub(t,i),o=new Rg(t);o.set({role:"menuitemradio",isToggleable:!0}),o.bind.apply(o,_toConsumableArray(Object.keys(n.model))).to(n.model),o.delegate("execute").to(i),o.on("execute",function(){e.execute(n.model.commandName,{value:n.model.commandParam}),e.editing.view.focus();}),s.children.add(o),r.items.add(s);};for(_iterator510.s();!(_step510=_iterator510.n()).done;){_loop20();}}catch(err){_iterator510.e(err);}finally{_iterator510.f();}return i.panelView.children.add(r),i;});}},{key:"_getLocalizedOptions",value:function _getLocalizedOptions(){var e=this.editor,t=e.t,i={Default:t("Default"),Tiny:t("Tiny"),Small:t("Small"),Big:t("Big"),Huge:t("Huge")};return HC(e.config.get(AC).options).map(function(e){var t=i[e.title];return t&&t!=e.title&&(e=Object.assign({},e,{title:t})),e;});}}],[{key:"pluginName",get:function get(){return"FontSizeUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var KC=/*#__PURE__*/function(_Dr90){function KC(){_classCallCheck(this,KC);return _callSuper(this,KC,arguments);}_inherits(KC,_Dr90);return _createClass(KC,[{key:"normalizeSizeOptions",value:function normalizeSizeOptions(e){return HC(e);}}],[{key:"requires",get:function get(){return[jC,GC];}},{key:"pluginName",get:function get(){return"FontSize";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ZC=/*#__PURE__*/function(_xC4){function ZC(e){_classCallCheck(this,ZC);return _callSuper(this,ZC,[e,TC]);}_inherits(ZC,_xC4);return _createClass(ZC);}(xC);var JC=/*#__PURE__*/function(_Dr91){function JC(e){var _this542;_classCallCheck(this,JC);_this542=_callSuper(this,JC,[e]),e.config.define(TC,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.conversion["for"]("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:TC,value:IC("color")}}),e.conversion["for"]("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:TC,value:function value(e){return e.getAttribute("color");}}}),e.conversion["for"]("downcast").attributeToElement({model:TC,view:VC("color")}),e.commands.add(TC,new ZC(e)),e.model.schema.extend("$text",{allowAttributes:TC}),e.model.schema.setAttributeProperties(TC,{isFormatting:!0,copyOnEnter:!0});return _this542;}_inherits(JC,_Dr91);return _createClass(JC,null,[{key:"pluginName",get:function get(){return"FontColorEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var QC=/*#__PURE__*/function(_Dr92){function QC(e,_ref161){var _this543;var t=_ref161.commandName,i=_ref161.componentName,n=_ref161.icon,s=_ref161.dropdownLabel;_classCallCheck(this,QC);_this543=_callSuper(this,QC,[e]),_defineProperty(_assertThisInitialized(_this543),"commandName",void 0),_defineProperty(_assertThisInitialized(_this543),"componentName",void 0),_defineProperty(_assertThisInitialized(_this543),"icon",void 0),_defineProperty(_assertThisInitialized(_this543),"dropdownLabel",void 0),_defineProperty(_assertThisInitialized(_this543),"columns",void 0),_this543.commandName=t,_this543.componentName=i,_this543.icon=n,_this543.dropdownLabel=s,_this543.columns=e.config.get("".concat(_this543.componentName,".columns"));return _this543;}_inherits(QC,_Dr92);return _createClass(QC,[{key:"init",value:function init(){var _this544=this;var e=this.editor,t=e.locale,i=t.t,n=e.commands.get(this.commandName),s=e.config.get(this.componentName),o=qg(t,Gg(s.colors)),r=s.documentColors,a=!1!==s.colorPicker;e.ui.componentFactory.add(this.componentName,function(t){var l=Xf(t);var c=!1;var d=function(_ref162){var e=_ref162.dropdownView,t=_ref162.colors,i=_ref162.columns,n=_ref162.removeButtonLabel,s=_ref162.colorPickerLabel,o=_ref162.documentColorsLabel,r=_ref162.documentColorsCount,a=_ref162.colorPickerViewConfig;var l=e.locale,c=new Jp(l,{colors:t,columns:i,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:o,documentColorsCount:r,colorPickerViewConfig:a});return e.colorSelectorView=c,e.panelView.children.add(c),c;}({dropdownView:l,colors:o.map(function(e){return{label:e.label,color:e.model,options:{hasBorder:e.hasBorder}};}),columns:_this544.columns,removeButtonLabel:i("Remove color"),colorPickerLabel:i("Color picker"),documentColorsLabel:0!==r?i("Document colors"):"",documentColorsCount:void 0===r?_this544.columns:r,colorPickerViewConfig:!!a&&(s.colorPicker||{})});return d.bind("selectedColor").to(n,"value"),l.buttonView.set({label:_this544.dropdownLabel,icon:_this544.icon,tooltip:!0}),l.extendTemplate({attributes:{"class":"ck-color-ui-dropdown"}}),l.bind("isEnabled").to(n),d.on("execute",function(t,i){l.isOpen&&e.execute(_this544.commandName,{value:i.value,batch:_this544._undoStepBatch}),"colorPicker"!==i.source&&e.editing.view.focus(),"colorPickerSaveButton"===i.source&&(l.isOpen=!1);}),d.on("colorPicker:show",function(){_this544._undoStepBatch=e.model.createBatch();}),d.on("colorPicker:cancel",function(){_this544._undoStepBatch.operations.length&&(l.isOpen=!1,e.execute("undo",_this544._undoStepBatch)),e.editing.view.focus();}),l.on("change:isOpen",function(t,i,n){c||(c=!0,l.colorSelectorView.appendUI()),n&&(0!==r&&d.updateDocumentColors(e.model,_this544.componentName),d.updateSelectedColors(),d.showColorGridsFragment());}),rp(l,function(){return l.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(function(e){return e.isOn;});}),l;}),e.ui.componentFactory.add("menuBar:".concat(this.componentName),function(t){var s=new aw(t);s.buttonView.set({label:_this544.dropdownLabel,icon:_this544.icon}),s.bind("isEnabled").to(n);var a=!1;var l=new Jp(t,{colors:o.map(function(e){return{label:e.label,color:e.model,options:{hasBorder:e.hasBorder}};}),columns:_this544.columns,removeButtonLabel:i("Remove color"),colorPickerLabel:i("Color picker"),documentColorsLabel:0!==r?i("Document colors"):"",documentColorsCount:void 0===r?_this544.columns:r,colorPickerViewConfig:!1});return l.bind("selectedColor").to(n,"value"),l.delegate("execute").to(s),l.on("execute",function(t,i){e.execute(_this544.commandName,{value:i.value,batch:_this544._undoStepBatch}),e.editing.view.focus();}),s.on("change:isOpen",function(t,i,n){a||(a=!0,l.appendUI()),n&&(0!==r&&l.updateDocumentColors(e.model,_this544.componentName),l.updateSelectedColors(),l.showColorGridsFragment());}),s.panelView.children.add(l),s;});}}]);}(Dr);var YC=/*#__PURE__*/function(_QC2){function YC(e){_classCallCheck(this,YC);var t=e.locale.t;return _callSuper(this,YC,[e,{commandName:TC,componentName:TC,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>',dropdownLabel:t("Font Color")}]);}_inherits(YC,_QC2);return _createClass(YC,null,[{key:"pluginName",get:function get(){return"FontColorUI";}}]);}(QC);var XC=/*#__PURE__*/function(_Dr93){function XC(){_classCallCheck(this,XC);return _callSuper(this,XC,arguments);}_inherits(XC,_Dr93);return _createClass(XC,null,[{key:"requires",get:function get(){return[JC,YC];}},{key:"pluginName",get:function get(){return"FontColor";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ex=/*#__PURE__*/function(_xC5){function ex(e){_classCallCheck(this,ex);return _callSuper(this,ex,[e,PC]);}_inherits(ex,_xC5);return _createClass(ex);}(xC);var tx=/*#__PURE__*/function(_Dr94){function tx(e){var _this545;_classCallCheck(this,tx);_this545=_callSuper(this,tx,[e]),e.config.define(PC,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),e.data.addStyleProcessorRules(_h),e.conversion["for"]("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:PC,value:IC("background-color")}}),e.conversion["for"]("downcast").attributeToElement({model:PC,view:VC("background-color")}),e.commands.add(PC,new ex(e)),e.model.schema.extend("$text",{allowAttributes:PC}),e.model.schema.setAttributeProperties(PC,{isFormatting:!0,copyOnEnter:!0});return _this545;}_inherits(tx,_Dr94);return _createClass(tx,null,[{key:"pluginName",get:function get(){return"FontBackgroundColorEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ix=/*#__PURE__*/function(_QC3){function ix(e){_classCallCheck(this,ix);var t=e.locale.t;return _callSuper(this,ix,[e,{commandName:PC,componentName:PC,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>',dropdownLabel:t("Font Background Color")}]);}_inherits(ix,_QC3);return _createClass(ix,null,[{key:"pluginName",get:function get(){return"FontBackgroundColorUI";}}]);}(QC);var nx=/*#__PURE__*/function(_Dr95){function nx(){_classCallCheck(this,nx);return _callSuper(this,nx,arguments);}_inherits(nx,_Dr95);return _createClass(nx,null,[{key:"requires",get:function get(){return[tx,ix];}},{key:"pluginName",get:function get(){return"FontBackgroundColor";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var sx=/*#__PURE__*/function(_Dr96){function sx(){_classCallCheck(this,sx);return _callSuper(this,sx,arguments);}_inherits(sx,_Dr96);return _createClass(sx,null,[{key:"requires",get:function get(){return[DC,KC,XC,nx];}},{key:"pluginName",get:function get(){return"Font";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ox=/*#__PURE__*/function(_Hr22){function ox(e){var _this546;_classCallCheck(this,ox);_this546=_callSuper(this,ox,[e]),_this546._isEnabledBasedOnSelection=!1;return _this546;}_inherits(ox,_Hr22);return _createClass(ox,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=wr(e.document.selection.getSelectedBlocks());this.value=!!t&&t.is("element","paragraph"),this.isEnabled=!!t&&rx(t,e.schema);}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document,n=e.selection||i.selection;t.canEditAt(n)&&t.change(function(e){var i=n.getSelectedBlocks();var _iterator511=_createForOfIteratorHelper(i),_step511;try{for(_iterator511.s();!(_step511=_iterator511.n()).done;){var _n210=_step511.value;!_n210.is("element","paragraph")&&rx(_n210,t.schema)&&e.rename(_n210,"paragraph");}}catch(err){_iterator511.e(err);}finally{_iterator511.f();}});}}]);}(Hr);function rx(e,t){return t.checkChild(e.parent,"paragraph")&&!t.isObject(e);}var ax=/*#__PURE__*/function(_Hr23){function ax(e){var _this547;_classCallCheck(this,ax);_this547=_callSuper(this,ax,[e]),_this547._isEnabledBasedOnSelection=!1;return _this547;}_inherits(ax,_Hr23);return _createClass(ax,[{key:"execute",value:function execute(e){var _this548=this;var t=this.editor.model,i=e.attributes;var n=e.position;t.canEditAt(n)&&t.change(function(e){if(n=_this548._findPositionToInsertParagraph(n,e),!n)return;var s=e.createElement("paragraph");i&&t.schema.setAllowedAttributes(s,i,e),t.insertContent(s,n),e.setSelection(s,"in");});}},{key:"_findPositionToInsertParagraph",value:function _findPositionToInsertParagraph(e,t){var i=this.editor.model;if(i.schema.checkChild(e,"paragraph"))return e;var n=i.schema.findAllowedParent(e,"paragraph");if(!n)return null;var s=e.parent,o=i.schema.checkChild(s,"$text");return s.isEmpty||o&&e.isAtEnd?i.createPositionAfter(s):!s.isEmpty&&o&&e.isAtStart?i.createPositionBefore(s):t.split(e,n).position;}}]);}(Hr);var lx=/*#__PURE__*/function(_Dr97){function lx(){_classCallCheck(this,lx);return _callSuper(this,lx,arguments);}_inherits(lx,_Dr97);return _createClass(lx,[{key:"init",value:function init(){var e=this.editor,t=e.model;e.commands.add("paragraph",new ox(e)),e.commands.add("insertParagraph",new ax(e)),t.schema.register("paragraph",{inheritAllFrom:"$block"}),e.conversion.elementToElement({model:"paragraph",view:"p"}),e.conversion["for"]("upcast").elementToElement({model:function model(e,_ref163){var t=_ref163.writer;return lx.paragraphLikeElements.has(e.name)?e.isEmpty?null:t.createElement("paragraph"):null;},view:/.+/,converterPriority:"low"});}}],[{key:"pluginName",get:function get(){return"Paragraph";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);_defineProperty(lx,"paragraphLikeElements",new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]));var cx=/*#__PURE__*/function(_Dr98){function cx(){_classCallCheck(this,cx);return _callSuper(this,cx,arguments);}_inherits(cx,_Dr98);return _createClass(cx,[{key:"init",value:function init(){var e=this.editor,t=e.t;e.ui.componentFactory.add("paragraph",function(i){var n=new pg(i),s=e.commands.get("paragraph");return n.label=t("Paragraph"),n.icon=vm.paragraph,n.tooltip=!0,n.isToggleable=!0,n.bind("isEnabled").to(s),n.bind("isOn").to(s,"value"),n.on("execute",function(){e.execute("paragraph");}),n;});}}],[{key:"requires",get:function get(){return[lx];}}]);}(Dr);var dx=/*#__PURE__*/function(_Hr24){function dx(e,t){var _this549;_classCallCheck(this,dx);_this549=_callSuper(this,dx,[e]),_defineProperty(_assertThisInitialized(_this549),"modelElements",void 0),_this549.modelElements=t;return _this549;}_inherits(dx,_Hr24);return _createClass(dx,[{key:"refresh",value:function refresh(){var _this550=this;var e=wr(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(function(t){return ux(e,t,_this550.editor.model.schema);});}},{key:"execute",value:function execute(e){var t=this.editor.model,i=t.document,n=e.value;t.change(function(e){var s=Array.from(i.selection.getSelectedBlocks()).filter(function(e){return ux(e,n,t.schema);});var _iterator512=_createForOfIteratorHelper(s),_step512;try{for(_iterator512.s();!(_step512=_iterator512.n()).done;){var _t345=_step512.value;_t345.is("element",n)||e.rename(_t345,n);}}catch(err){_iterator512.e(err);}finally{_iterator512.f();}});}}]);}(Hr);function ux(e,t,i){return i.checkChild(e.parent,t)&&!i.isObject(e);}var hx="paragraph";var mx=/*#__PURE__*/function(_Dr99){function mx(e){var _this551;_classCallCheck(this,mx);_this551=_callSuper(this,mx,[e]),e.config.define("heading",{options:[{model:"paragraph",title:"Paragraph","class":"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1","class":"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2","class":"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3","class":"ck-heading_heading3"}]});return _this551;}_inherits(mx,_Dr99);return _createClass(mx,[{key:"init",value:function init(){var e=this.editor,t=e.config.get("heading.options"),i=[];var _iterator513=_createForOfIteratorHelper(t),_step513;try{for(_iterator513.s();!(_step513=_iterator513.n()).done;){var _n211=_step513.value;"paragraph"!==_n211.model&&(e.model.schema.register(_n211.model,{inheritAllFrom:"$block"}),e.conversion.elementToElement(_n211),i.push(_n211.model));}}catch(err){_iterator513.e(err);}finally{_iterator513.f();}this._addDefaultH1Conversion(e),e.commands.add("heading",new dx(e,i));}},{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.commands.get("enter"),i=e.config.get("heading.options");t&&this.listenTo(t,"afterExecute",function(t,n){var s=e.model.document.selection.getFirstPosition().parent;i.some(function(e){return s.is("element",e.model);})&&!s.is("element",hx)&&0===s.childCount&&n.writer.rename(s,hx);});}},{key:"_addDefaultH1Conversion",value:function _addDefaultH1Conversion(e){e.conversion["for"]("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:C.low+1});}}],[{key:"pluginName",get:function get(){return"HeadingEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[lx];}}]);}(Dr);function gx(e){var t=e.t,i={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return e.config.get("heading.options").map(function(e){var t=i[e.title];return t&&t!=e.title&&(e.title=t),e;});}var fx=/*#__PURE__*/function(_Dr100){function fx(){_classCallCheck(this,fx);return _callSuper(this,fx,arguments);}_inherits(fx,_Dr100);return _createClass(fx,[{key:"init",value:function init(){var _this552=this;var e=this.editor,t=e.t,i=gx(e),n=t("Choose heading"),s=t("Heading");e.ui.componentFactory.add("heading",function(t){var o={},r=new br(),a=e.commands.get("heading"),l=e.commands.get("paragraph"),c=[a];var _iterator514=_createForOfIteratorHelper(i),_step514;try{var _loop21=function _loop21(){var e=_step514.value;var t={type:"button",model:new Fb({label:e.title,"class":e["class"],role:"menuitemradio",withText:!0})};"paragraph"===e.model?(t.model.bind("isOn").to(l,"value"),t.model.set("commandName","paragraph"),c.push(l)):(t.model.bind("isOn").to(a,"value",function(t){return t===e.model;}),t.model.set({commandName:"heading",commandValue:e.model})),r.add(t),o[e.model]=e.title;};for(_iterator514.s();!(_step514=_iterator514.n()).done;){_loop21();}}catch(err){_iterator514.e(err);}finally{_iterator514.f();}var d=Xf(t);return sp(d,r,{ariaLabel:s,role:"menu"}),d.buttonView.set({ariaLabel:s,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:s}),d.extendTemplate({attributes:{"class":["ck-heading-dropdown"]}}),d.bind("isEnabled").toMany(c,"isEnabled",function(){for(var _len68=arguments.length,e=new Array(_len68),_key68=0;_key68<_len68;_key68++){e[_key68]=arguments[_key68];}return e.some(function(e){return e;});}),d.buttonView.bind("label").to(a,"value",l,"value",function(e,t){var i=t?"paragraph":e;return"boolean"==typeof i?n:o[i]?o[i]:n;}),d.buttonView.bind("ariaLabel").to(a,"value",l,"value",function(e,t){var i=t?"paragraph":e;return"boolean"==typeof i?s:o[i]?"".concat(o[i],", ").concat(s):s;}),_this552.listenTo(d,"execute",function(t){var _t$source=t.source,i=_t$source.commandName,n=_t$source.commandValue;e.execute(i,n?{value:n}:void 0),e.editing.view.focus();}),d;}),e.ui.componentFactory.add("menuBar:heading",function(n){var s=new aw(n),o=e.commands.get("heading"),r=e.commands.get("paragraph"),a=[o],l=new lw(n);s.set({"class":"ck-heading-dropdown"}),l.set({ariaLabel:t("Heading"),role:"menu"}),s.buttonView.set({label:t("Heading")}),s.panelView.children.add(l);var _iterator515=_createForOfIteratorHelper(i),_step515;try{var _loop22=function _loop22(){var t=_step515.value;var i=new ub(n,s),c=new Rg(n);i.children.add(c),l.items.add(i),c.set({isToggleable:!0,label:t.title,role:"menuitemradio","class":t["class"]}),c.delegate("execute").to(s),c.on("execute",function(){var i="paragraph"===t.model?"paragraph":"heading";e.execute(i,{value:t.model}),e.editing.view.focus();}),"paragraph"===t.model?(c.bind("isOn").to(r,"value"),a.push(r)):c.bind("isOn").to(o,"value",function(e){return e===t.model;});};for(_iterator515.s();!(_step515=_iterator515.n()).done;){_loop22();}}catch(err){_iterator515.e(err);}finally{_iterator515.f();}return s.bind("isEnabled").toMany(a,"isEnabled",function(){for(var _len69=arguments.length,e=new Array(_len69),_key69=0;_key69<_len69;_key69++){e[_key69]=arguments[_key69];}return e.some(function(e){return e;});}),s;});}}],[{key:"pluginName",get:function get(){return"HeadingUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var px=/*#__PURE__*/function(_Dr101){function px(){_classCallCheck(this,px);return _callSuper(this,px,arguments);}_inherits(px,_Dr101);return _createClass(px,null,[{key:"requires",get:function get(){return[mx,fx];}},{key:"pluginName",get:function get(){return"Heading";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var bx=function(){return{heading1:vm.heading1,heading2:vm.heading2,heading3:vm.heading3,heading4:vm.heading4,heading5:vm.heading5,heading6:vm.heading6};}();var wx=/*#__PURE__*/function(_Dr102){function wx(){_classCallCheck(this,wx);return _callSuper(this,wx,arguments);}_inherits(wx,_Dr102);return _createClass(wx,[{key:"init",value:function init(){var _this553=this;gx(this.editor).filter(function(e){return"paragraph"!==e.model;}).map(function(e){return _this553._createButton(e);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor;t.ui.componentFactory.add(e.model,function(i){var n=new pg(i),s=t.commands.get("heading");return n.label=e.title,n.icon=e.icon||bx[e.model],n.tooltip=!0,n.isToggleable=!0,n.bind("isEnabled").to(s),n.bind("isOn").to(s,"value",function(t){return t==e.model;}),n.on("execute",function(){t.execute("heading",{value:e.model}),t.editing.view.focus();}),n;});}}]);}(Dr);var _x=new Set(["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"]);var vx=/*#__PURE__*/function(_Dr103){function vx(){var _this554;_classCallCheck(this,vx);for(var _len70=arguments.length,args=new Array(_len70),_key70=0;_key70<_len70;_key70++){args[_key70]=arguments[_key70];}_this554=_callSuper(this,vx,[].concat(args));_defineProperty(_this554,"_bodyPlaceholder",new Map());return _this554;}_inherits(vx,_Dr103);return _createClass(vx,[{key:"init",value:function init(){var _this555=this;var e=this.editor,t=e.model;t.schema.register("title",{isBlock:!0,allowIn:"$root"}),t.schema.register("title-content",{isBlock:!0,allowIn:"title",allowAttributes:["alignment"]}),t.schema.extend("$text",{allowIn:"title-content"}),t.schema.addAttributeCheck(function(e){if(e.endsWith("title-content $text"))return!1;}),e.editing.mapper.on("modelToViewPosition",kx(e.editing.view)),e.data.mapper.on("modelToViewPosition",kx(e.editing.view)),e.conversion["for"]("downcast").elementToElement({model:"title-content",view:"h1"}),e.conversion["for"]("downcast").add(function(e){return e.on("insert:title",function(e,t,i){i.consumable.consume(t.item,e.name);});}),e.data.upcastDispatcher.on("element:h1",yx,{priority:"high"}),e.data.upcastDispatcher.on("element:h2",yx,{priority:"high"}),e.data.upcastDispatcher.on("element:h3",yx,{priority:"high"}),t.document.registerPostFixer(function(e){return _this555._fixTitleContent(e);}),t.document.registerPostFixer(function(e){return _this555._fixTitleElement(e);}),t.document.registerPostFixer(function(e){return _this555._fixBodyElement(e);}),t.document.registerPostFixer(function(e){return _this555._fixExtraParagraph(e);}),this._attachPlaceholders(),this._attachTabPressHandling();}},{key:"getTitle",value:function getTitle(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=e.rootName?e.rootName:void 0,i=this._getTitleElement(t).getChild(0);return this.editor.data.stringify(i,e);}},{key:"getBody",value:function getBody(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor,i=t.data,n=t.model,s=e.rootName?e.rootName:void 0,o=t.model.document.getRoot(s),r=t.editing.view,a=new qa(r.document),l=n.createRangeIn(o),c=a.createDocumentFragment(),d=n.createPositionAfter(o.getChild(0)),u=n.createRange(d,n.createPositionAt(o,"end")),h=new Map();var _iterator516=_createForOfIteratorHelper(n.markers),_step516;try{for(_iterator516.s();!(_step516=_iterator516.n()).done;){var _e541=_step516.value;var _t346=u.getIntersection(_e541.getRange());_t346&&h.set(_e541.name,_t346);}}catch(err){_iterator516.e(err);}finally{_iterator516.f();}return i.mapper.clearBindings(),i.mapper.bindElements(o,c),i.downcastDispatcher.convert(l,h,a,e),a.remove(a.createRangeOn(c.getChild(0))),t.data.processor.toData(c);}},{key:"_getTitleElement",value:function _getTitleElement(e){var t=this.editor.model.document.getRoot(e);var _iterator517=_createForOfIteratorHelper(t.getChildren()),_step517;try{for(_iterator517.s();!(_step517=_iterator517.n()).done;){var _e542=_step517.value;if(Cx(_e542))return _e542;}}catch(err){_iterator517.e(err);}finally{_iterator517.f();}}},{key:"_fixTitleContent",value:function _fixTitleContent(e){var t=!1;var _iterator518=_createForOfIteratorHelper(this.editor.model.document.getRootNames()),_step518;try{for(_iterator518.s();!(_step518=_iterator518.n()).done;){var _i394=_step518.value;var _n212=this._getTitleElement(_i394);if(!_n212||1===_n212.maxOffset)continue;var _s147=Array.from(_n212.getChildren());_s147.shift();for(var _i395=0,_s148=_s147;_i395<_s148.length;_i395++){var _t347=_s148[_i395];e.move(e.createRangeOn(_t347),_n212,"after"),e.rename(_t347,"paragraph");}t=!0;}}catch(err){_iterator518.e(err);}finally{_iterator518.f();}return t;}},{key:"_fixTitleElement",value:function _fixTitleElement(e){var t=!1;var i=this.editor.model;var _iterator519=_createForOfIteratorHelper(this.editor.model.document.getRoots()),_step519;try{for(_iterator519.s();!(_step519=_iterator519.n()).done;){var _n213=_step519.value;var _s149=Array.from(_n213.getChildren()).filter(Cx),_o82=_s149[0],r=_n213.getChild(0);if(r.is("element","title"))_s149.length>1&&(Ax(_s149,e,i),t=!0);else if(_o82||_x.has(r.name))_x.has(r.name)?xx(r,e,i):e.move(e.createRangeOn(_o82),_n213,0),Ax(_s149,e,i),t=!0;else{var _i396=e.createElement("title");e.insert(_i396,_n213),e.insertElement("title-content",_i396),t=!0;}}}catch(err){_iterator519.e(err);}finally{_iterator519.f();}return t;}},{key:"_fixBodyElement",value:function _fixBodyElement(e){var t=!1;var _iterator520=_createForOfIteratorHelper(this.editor.model.document.getRootNames()),_step520;try{for(_iterator520.s();!(_step520=_iterator520.n()).done;){var _i397=_step520.value;var _n214=this.editor.model.document.getRoot(_i397);if(_n214.childCount<2){var _s150=e.createElement("paragraph");e.insert(_s150,_n214,1),this._bodyPlaceholder.set(_i397,_s150),t=!0;}}}catch(err){_iterator520.e(err);}finally{_iterator520.f();}return t;}},{key:"_fixExtraParagraph",value:function _fixExtraParagraph(e){var t=!1;var _iterator521=_createForOfIteratorHelper(this.editor.model.document.getRootNames()),_step521;try{for(_iterator521.s();!(_step521=_iterator521.n()).done;){var _i398=_step521.value;var _n215=this.editor.model.document.getRoot(_i398),_s151=this._bodyPlaceholder.get(_i398);Tx(_s151,_n215)&&(this._bodyPlaceholder["delete"](_i398),e.remove(_s151),t=!0);}}catch(err){_iterator521.e(err);}finally{_iterator521.f();}return t;}},{key:"_attachPlaceholders",value:function _attachPlaceholders(){var e=this.editor,t=e.t,i=e.editing.view,n=e.sourceElement,s=e.config.get("title.placeholder")||t("Type your title"),o=e.config.get("placeholder")||n&&"textarea"===n.tagName.toLowerCase()&&n.getAttribute("placeholder")||t("Type or paste your content here.");e.editing.downcastDispatcher.on("insert:title-content",function(e,t,n){var o=n.mapper.toViewElement(t.item);o.placeholder=s,Zr({view:i,element:o,keepOnFocus:!0});});var r=new Map();i.document.registerPostFixer(function(e){var t=!1;var _iterator522=_createForOfIteratorHelper(i.document.roots),_step522;try{for(_iterator522.s();!(_step522=_iterator522.n()).done;){var _n216=_step522.value;if(_n216.isEmpty)continue;var _i399=_n216.getChild(1),_s152=r.get(_n216.rootName);_i399!==_s152&&(_s152&&(Yr(e,_s152),e.removeAttribute("data-placeholder",_s152)),e.setAttribute("data-placeholder",o,_i399),r.set(_n216.rootName,_i399),t=!0),t=Xr(_i399,!0)&&2===_n216.childCount&&"p"===_i399.name?!!Qr(e,_i399)||t:!!Yr(e,_i399)||t;}}catch(err){_iterator522.e(err);}finally{_iterator522.f();}return t;});}},{key:"_attachTabPressHandling",value:function _attachTabPressHandling(){var e=this.editor,t=e.model;e.keystrokes.set("TAB",function(e,i){t.change(function(e){var n=t.document.selection,s=Array.from(n.getSelectedBlocks());if(1===s.length&&s[0].is("element","title-content")){var _t348=n.getFirstPosition().root.getChild(1);e.setSelection(_t348,0),i();}});}),e.keystrokes.set("SHIFT + TAB",function(i,n){t.change(function(i){var s=t.document.selection;if(!s.isCollapsed)return;var o=wr(s.getSelectedBlocks()),r=s.getFirstPosition(),a=e.model.document.getRoot(r.root.rootName),l=a.getChild(0);o===a.getChild(1)&&r.isAtStart&&(i.setSelection(l.getChild(0),0),n());});});}}],[{key:"pluginName",get:function get(){return"Title";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return["Paragraph"];}}]);}(Dr);function yx(e,t,i){var n=t.modelCursor,s=t.viewItem;if(!n.isAtStart||!n.parent.is("element","$root"))return;if(!i.consumable.consume(s,{name:!0}))return;var o=i.writer,r=o.createElement("title"),a=o.createElement("title-content");o.append(a,r),o.insert(r,n),i.convertChildren(s,a),i.updateConversionResult(r,t);}function kx(e){return function(t,i){var n=i.modelPosition.parent;if(!n.is("element","title"))return;var s=n.parent,o=i.mapper.toViewElement(s);i.viewPosition=e.createPositionAt(o,0),t.stop();};}function Cx(e){return e.is("element","title");}function xx(e,t,i){var n=t.createElement("title");t.insert(n,e,"before"),t.insert(e,n,0),t.rename(e,"title-content"),i.schema.removeDisallowedAttributes([e],t);}function Ax(e,t,i){var n=!1;var _iterator523=_createForOfIteratorHelper(e),_step523;try{for(_iterator523.s();!(_step523=_iterator523.n()).done;){var _s153=_step523.value;0!==_s153.index&&(Ex(_s153,t,i),n=!0);}}catch(err){_iterator523.e(err);}finally{_iterator523.f();}return n;}function Ex(e,t,i){var n=e.getChild(0);n.isEmpty?t.remove(e):(t.move(t.createRangeOn(n),e,"before"),t.rename(n,"paragraph"),t.remove(e),i.schema.removeDisallowedAttributes([n],t));}function Tx(e,t){return!(!e||!e.is("element","paragraph")||e.childCount)&&!(t.childCount<=2||t.getChild(t.childCount-1)!==e);}var Px=/*#__PURE__*/function(_Hr25){function Px(){_classCallCheck(this,Px);return _callSuper(this,Px,arguments);}_inherits(Px,_Hr25);return _createClass(Px,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.value=t.selection.getAttribute("highlight"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"highlight");}},{key:"execute",value:function execute(){var _this556=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document.selection,n=e.value;t.change(function(e){if(i.isCollapsed){var _t349=i.getFirstPosition();if(i.hasAttribute("highlight")){var _i400=function _i400(e){return e.item.hasAttribute("highlight")&&e.item.getAttribute("highlight")===_this556.value;},_s154=_t349.getLastMatchingPosition(_i400,{direction:"backward"}),_o83=_t349.getLastMatchingPosition(_i400),r=e.createRange(_s154,_o83);n&&_this556.value!==n?(_t349.isEqual(_o83)||e.setAttribute("highlight",n,r),e.setSelectionAttribute("highlight",n)):(_t349.isEqual(_o83)||e.removeAttribute("highlight",r),e.removeSelectionAttribute("highlight"));}else n&&e.setSelectionAttribute("highlight",n);}else{var _s155=t.schema.getValidRanges(i.getRanges(),"highlight");var _iterator524=_createForOfIteratorHelper(_s155),_step524;try{for(_iterator524.s();!(_step524=_iterator524.n()).done;){var _t350=_step524.value;n?e.setAttribute("highlight",n,_t350):e.removeAttribute("highlight",_t350);}}catch(err){_iterator524.e(err);}finally{_iterator524.f();}}});}}]);}(Hr);var Sx=/*#__PURE__*/function(_Dr104){function Sx(e){var _this557;_classCallCheck(this,Sx);_this557=_callSuper(this,Sx,[e]),e.config.define("highlight",{options:[{model:"yellowMarker","class":"marker-yellow",title:"Yellow marker",color:"var(--ck-highlight-marker-yellow)",type:"marker"},{model:"greenMarker","class":"marker-green",title:"Green marker",color:"var(--ck-highlight-marker-green)",type:"marker"},{model:"pinkMarker","class":"marker-pink",title:"Pink marker",color:"var(--ck-highlight-marker-pink)",type:"marker"},{model:"blueMarker","class":"marker-blue",title:"Blue marker",color:"var(--ck-highlight-marker-blue)",type:"marker"},{model:"redPen","class":"pen-red",title:"Red pen",color:"var(--ck-highlight-pen-red)",type:"pen"},{model:"greenPen","class":"pen-green",title:"Green pen",color:"var(--ck-highlight-pen-green)",type:"pen"}]});return _this557;}_inherits(Sx,_Dr104);return _createClass(Sx,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:"highlight"});var t=e.config.get("highlight.options");e.conversion.attributeToElement(function(e){var t={model:{key:"highlight",values:[]},view:{}};var _iterator525=_createForOfIteratorHelper(e),_step525;try{for(_iterator525.s();!(_step525=_iterator525.n()).done;){var _i401=_step525.value;t.model.values.push(_i401.model),t.view[_i401.model]={name:"mark",classes:_i401["class"]};}}catch(err){_iterator525.e(err);}finally{_iterator525.f();}return t;}(t)),e.commands.add("highlight",new Px(e));}}],[{key:"pluginName",get:function get(){return"HighlightEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Ix=/*#__PURE__*/function(_Dr105){function Ix(){_classCallCheck(this,Ix);return _callSuper(this,Ix,arguments);}_inherits(Ix,_Dr105);return _createClass(Ix,[{key:"localizedOptionTitles",get:function get(){var e=this.editor.t;return{"Yellow marker":e("Yellow marker"),"Green marker":e("Green marker"),"Pink marker":e("Pink marker"),"Blue marker":e("Blue marker"),"Red pen":e("Red pen"),"Green pen":e("Green pen")};}},{key:"init",value:function init(){var e=this.editor.config.get("highlight.options");var _iterator526=_createForOfIteratorHelper(e),_step526;try{for(_iterator526.s();!(_step526=_iterator526.n()).done;){var _t351=_step526.value;this._addHighlighterButton(_t351);}}catch(err){_iterator526.e(err);}finally{_iterator526.f();}this._addRemoveHighlightButton(),this._addDropdown(e),this._addMenuBarButton(e);}},{key:"_addRemoveHighlightButton",value:function _addRemoveHighlightButton(){var e=this.editor.t,t=this.editor.commands.get("highlight");this._addButton("removeHighlight",e("Remove highlight"),vm.eraser,null,function(e){e.bind("isEnabled").to(t,"isEnabled");});}},{key:"_addHighlighterButton",value:function _addHighlighterButton(e){var t=this.editor.commands.get("highlight");this._addButton("highlight:"+e.model,e.title,Vx(e.type),e.model,function(i){i.bind("isEnabled").to(t,"isEnabled"),i.bind("isOn").to(t,"value",function(t){return t===e.model;}),i.iconView.fillColor=e.color,i.isToggleable=!0;});}},{key:"_addButton",value:function _addButton(e,t,i,n,s){var _this558=this;var o=this.editor;o.ui.componentFactory.add(e,function(e){var r=new pg(e),a=_this558.localizedOptionTitles[t]?_this558.localizedOptionTitles[t]:t;return r.set({label:a,icon:i,tooltip:!0}),r.on("execute",function(){o.execute("highlight",{value:n}),o.editing.view.focus();}),s(r),r;});}},{key:"_addDropdown",value:function _addDropdown(e){var _this559=this;var t=this.editor,i=t.t,n=t.ui.componentFactory,s=e[0],o=e.reduce(function(e,t){return e[t.model]=t,e;},{});n.add("highlight",function(r){var a=t.commands.get("highlight"),l=Xf(r,Yf),c=l.buttonView;c.set({label:i("Highlight"),tooltip:!0,lastExecuted:s.model,commandValue:s.model,isToggleable:!0}),c.bind("icon").to(a,"value",function(e){return Vx(d(e,"type"));}),c.bind("color").to(a,"value",function(e){return d(e,"color");}),c.bind("commandValue").to(a,"value",function(e){return d(e,"model");}),c.bind("isOn").to(a,"value",function(e){return!!e;}),c.delegate("execute").to(l);function d(e,t){var i=e&&e!==c.lastExecuted?e:c.lastExecuted;return o[i][t];}return l.bind("isEnabled").to(a,"isEnabled"),ip(l,function(){var t=e.map(function(e){var t=n.create("highlight:"+e.model);return _this559.listenTo(t,"execute",function(){l.buttonView.set({lastExecuted:e.model});}),t;});return t.push(new Wf()),t.push(n.create("removeHighlight")),t;},{enableActiveItemFocusOnDropdownOpen:!0,ariaLabel:i("Text highlight toolbar")}),function(e){var t=e.buttonView.actionView;t.iconView.bind("fillColor").to(e.buttonView,"color");}(l),c.on("execute",function(){t.execute("highlight",{value:c.commandValue});}),_this559.listenTo(l,"execute",function(){t.editing.view.focus();}),l;});}},{key:"_addMenuBarButton",value:function _addMenuBarButton(e){var t=this.editor,i=t.t,n=t.commands.get("highlight");t.ui.componentFactory.add("menuBar:highlight",function(s){var o=new aw(s);o.buttonView.set({label:i("Highlight"),icon:Vx("marker")}),o.bind("isEnabled").to(n),o.buttonView.iconView.fillColor="transparent";var r=new lw(s);var _iterator527=_createForOfIteratorHelper(e),_step527;try{var _loop23=function _loop23(){var i=_step527.value;var e=new ub(s,o),a=new Rg(s);a.set({label:i.title,icon:Vx(i.type),role:"menuitemradio",isToggleable:!0}),a.iconView.fillColor=i.color,a.delegate("execute").to(o),a.bind("isOn").to(n,"value",function(e){return e===i.model;}),a.on("execute",function(){t.execute("highlight",{value:i.model}),t.editing.view.focus();}),e.children.add(a),r.items.add(e);};for(_iterator527.s();!(_step527=_iterator527.n()).done;){_loop23();}}catch(err){_iterator527.e(err);}finally{_iterator527.f();}r.items.add(new Sf(s));var a=new ub(s,o),l=new Rg(s);return l.set({label:i("Remove highlight"),icon:vm.eraser}),l.delegate("execute").to(o),l.on("execute",function(){t.execute("highlight",{value:null}),t.editing.view.focus();}),a.children.add(l),r.items.add(a),o.panelView.children.add(r),o;});}}],[{key:"pluginName",get:function get(){return"HighlightUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function Vx(e){return"marker"===e?'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.798 1.59 3.002 12.875l1.895 1.852 2.521 1.402 6.997-12.194z"/><path d="m2.556 16.727.234-.348c-.297-.151-.462-.293-.498-.426-.036-.137.002-.416.115-.837.094-.25.15-.449.169-.595a4.495 4.495 0 0 0 0-.725c-.209-.621-.303-1.041-.284-1.26.02-.218.178-.506.475-.862l6.77-9.414c.539-.91 1.605-.85 3.199.18 1.594 1.032 2.188 1.928 1.784 2.686l-5.877 10.36c-.158.412-.333.673-.526.782-.193.108-.604.179-1.232.21-.362.131-.608.237-.738.318-.13.081-.305.238-.526.47-.293.265-.504.397-.632.397-.096 0-.27-.075-.524-.226l-.31.41-1.6-1.12zm-.279.415 1.575 1.103-.392.515H1.19l1.087-1.618zm8.1-13.656-4.953 6.9L8.75 12.57l4.247-7.574c.175-.25-.188-.647-1.092-1.192-.903-.546-1.412-.652-1.528-.32zM8.244 18.5 9.59 17h9.406v1.5H8.245z"/></svg>':'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M10.126 2.268 2.002 13.874l1.895 1.852 2.521 1.402L14.47 5.481l-1.543-2.568-2.801-.645z"/><path d="m4.5 18.088-2.645-1.852-.04-2.95-.006-.005.006-.008v-.025l.011.008L8.73 2.97c.165-.233.356-.417.567-.557l-1.212.308L4.604 7.9l-.83-.558 3.694-5.495 2.708-.69 1.65 1.145.046.018.85-1.216 2.16 1.512-.856 1.222c.828.967 1.144 2.141.432 3.158L7.55 17.286l.006.005-3.055.797H4.5zm-.634.166-1.976.516-.026-1.918 2.002 1.402zM9.968 3.817l-.006-.004-6.123 9.184 3.277 2.294 6.108-9.162.005.003c.317-.452-.16-1.332-1.064-1.966-.891-.624-1.865-.776-2.197-.349zM8.245 18.5 9.59 17h9.406v1.5H8.245z"/></svg>';}var Rx=/*#__PURE__*/function(_Dr106){function Rx(){_classCallCheck(this,Rx);return _callSuper(this,Rx,arguments);}_inherits(Rx,_Dr106);return _createClass(Rx,null,[{key:"requires",get:function get(){return[Sx,Ix];}},{key:"pluginName",get:function get(){return"Highlight";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Ox=/*#__PURE__*/function(_Hr26){function Ox(){_classCallCheck(this,Ox);return _callSuper(this,Ox,arguments);}_inherits(Ox,_Hr26);return _createClass(Ox,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.schema,i=e.document.selection;this.isEnabled=function(e,t,i){var n=function(e,t){var i=hy(e,t),n=i.start.parent;if(n.isEmpty&&!n.is("element","$root"))return n.parent;return n;}(e,i);return t.checkChild(n,"horizontalLine");}(i,t,e);}},{key:"execute",value:function execute(){var e=this.editor.model;e.change(function(t){var i=t.createElement("horizontalLine");e.insertObject(i,null,null,{setSelection:"after"});});}}]);}(Hr);var Bx=/*#__PURE__*/function(_Dr107){function Bx(){_classCallCheck(this,Bx);return _callSuper(this,Bx,arguments);}_inherits(Bx,_Dr107);return _createClass(Bx,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.t,n=e.conversion;t.register("horizontalLine",{inheritAllFrom:"$blockObject"}),n["for"]("dataDowncast").elementToElement({model:"horizontalLine",view:function view(e,_ref164){var t=_ref164.writer;return t.createEmptyElement("hr");}}),n["for"]("editingDowncast").elementToStructure({model:"horizontalLine",view:function view(e,_ref165){var t=_ref165.writer;var n=i("Horizontal line"),s=t.createContainerElement("div",null,t.createEmptyElement("hr"));return t.addClass("ck-horizontal-line",s),t.setCustomProperty("hr",!0,s),function(e,t,i){return t.setCustomProperty("horizontalLine",!0,e),oy(e,t,{label:i});}(s,t,n);}}),n["for"]("upcast").elementToElement({view:"hr",model:"horizontalLine"}),e.commands.add("horizontalLine",new Ox(e));}}],[{key:"pluginName",get:function get(){return"HorizontalLineEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Mx=/*#__PURE__*/function(_Dr108){function Mx(){_classCallCheck(this,Mx);return _callSuper(this,Mx,arguments);}_inherits(Mx,_Dr108);return _createClass(Mx,[{key:"init",value:function init(){var _this560=this;var e=this.editor;e.ui.componentFactory.add("horizontalLine",function(){var e=_this560._createButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:horizontalLine",function(){return _this560._createButton(Rg);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get("horizontalLine"),s=new e(t.locale),o=i.t;return s.set({label:o("Horizontal line"),icon:vm.horizontalLine}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",function(){t.execute("horizontalLine"),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"HorizontalLineUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Lx=/*#__PURE__*/function(_Dr109){function Lx(){_classCallCheck(this,Lx);return _callSuper(this,Lx,arguments);}_inherits(Lx,_Dr109);return _createClass(Lx,null,[{key:"requires",get:function get(){return[Bx,Mx,Ty];}},{key:"pluginName",get:function get(){return"HorizontalLine";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var Fx=/*#__PURE__*/function(_Hr27){function Fx(){_classCallCheck(this,Fx);return _callSuper(this,Fx,arguments);}_inherits(Fx,_Hr27);return _createClass(Fx,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.schema,i=e.document.selection,n=Nx(i);this.isEnabled=function(e,t,i){var n=function(e,t){var i=hy(e,t),n=i.start.parent;if(n.isEmpty&&!n.is("rootElement"))return n.parent;return n;}(e,i);return t.checkChild(n,"rawHtml");}(i,t,e),this.value=n?n.getAttribute("value")||"":null;}},{key:"execute",value:function execute(e){var _this561=this;var t=this.editor.model,i=t.document.selection;t.change(function(n){var s;null!==_this561.value?s=Nx(i):(s=n.createElement("rawHtml"),t.insertObject(s,null,null,{setSelection:"on"})),n.setAttribute("value",e,s);});}}]);}(Hr);function Nx(e){var t=e.getSelectedElement();return t&&t.is("element","rawHtml")?t:null;}var Dx=/*#__PURE__*/function(_Dr110){function Dx(e){var _this562;_classCallCheck(this,Dx);_this562=_callSuper(this,Dx,[e]),_defineProperty(_assertThisInitialized(_this562),"_widgetButtonViewReferences",new Set()),e.config.define("htmlEmbed",{showPreviews:!1,sanitizeHtml:function sanitizeHtml(e){return E("html-embed-provide-sanitize-function"),{html:e,hasChanged:!1};}});return _this562;}_inherits(Dx,_Dr110);return _createClass(Dx,[{key:"init",value:function init(){var e=this.editor;e.model.schema.register("rawHtml",{inheritAllFrom:"$blockObject",allowAttributes:["value"]}),e.commands.add("htmlEmbed",new Fx(e)),this._setupConversion();}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.t,i=e.editing.view,n=this._widgetButtonViewReferences,s=e.config.get("htmlEmbed");function o(_ref166){var e=_ref166.editor,i=_ref166.domElement,s=_ref166.state,o=_ref166.props;i.textContent="";var a=i.ownerDocument;var l;if(s.isEditable){var _e543={isDisabled:!1,placeholder:o.textareaPlaceholder};l=r({domDocument:a,state:s,props:_e543}),i.append(l);}else if(s.showPreviews){var _n217={sanitizeHtml:o.sanitizeHtml};i.append(function(_ref167){var e=_ref167.editor,i=_ref167.domDocument,n=_ref167.state,s=_ref167.props;var o=s.sanitizeHtml(n.getRawHtmlValue()),r=n.getRawHtmlValue().length>0?t("No preview available"):t("Empty snippet content"),a=ro(i,"div",{"class":"ck ck-reset_all raw-html-embed__preview-placeholder"},r),l=ro(i,"div",{"class":"raw-html-embed__preview-content",dir:e.locale.contentLanguageDirection}),c=i.createRange(),d=c.createContextualFragment(o.html);l.appendChild(d);var u=ro(i,"div",{"class":"raw-html-embed__preview"},[a,l]);return u;}({domDocument:a,state:s,props:_n217,editor:e}));}else{var _e544={isDisabled:!0,placeholder:o.textareaPlaceholder};i.append(r({domDocument:a,state:s,props:_e544}));}var c={onEditClick:o.onEditClick,onSaveClick:function onSaveClick(){o.onSaveClick(l.value);},onCancelClick:o.onCancelClick};i.prepend(function(_ref168){var e=_ref168.editor,t=_ref168.domDocument,i=_ref168.state,s=_ref168.props;var o=ro(t,"div",{"class":"raw-html-embed__buttons-wrapper"});if(i.isEditable){var _t352=zx(e,"save",s.onSaveClick),_i402=zx(e,"cancel",s.onCancelClick);o.append(_t352.element,_i402.element),n.add(_t352).add(_i402);}else{var _t353=zx(e,"edit",s.onEditClick);o.append(_t353.element),n.add(_t353);}return o;}({editor:e,domDocument:a,state:s,props:c}));}function r(_ref169){var e=_ref169.domDocument,t=_ref169.state,i=_ref169.props;var n=ro(e,"textarea",{placeholder:i.placeholder,"class":"ck ck-reset ck-input ck-input-text raw-html-embed__source"});return n.disabled=i.isDisabled,n.value=t.getRawHtmlValue(),n;}this.editor.editing.view.on("render",function(){var _iterator528=_createForOfIteratorHelper(n),_step528;try{for(_iterator528.s();!(_step528=_iterator528.n()).done;){var _e545=_step528.value;if(_e545.element&&_e545.element.isConnected)return;_e545.destroy(),n["delete"](_e545);}}catch(err){_iterator528.e(err);}finally{_iterator528.f();}},{priority:"lowest"}),e.data.registerRawContentMatcher({name:"div",classes:"raw-html-embed"}),e.conversion["for"]("upcast").elementToElement({view:{name:"div",classes:"raw-html-embed"},model:function model(e,_ref170){var t=_ref170.writer;return t.createElement("rawHtml",{value:e.getCustomProperty("$rawContent")});}}),e.conversion["for"]("dataDowncast").elementToElement({model:"rawHtml",view:function view(e,_ref171){var t=_ref171.writer;return t.createRawElement("div",{"class":"raw-html-embed"},function(t){t.innerHTML=e.getAttribute("value")||"";});}}),e.conversion["for"]("editingDowncast").elementToStructure({model:{name:"rawHtml",attributes:["value"]},view:function view(n,_ref172){var r=_ref172.writer;var a,l,c;var d=r.createRawElement("div",{"class":"raw-html-embed__content-wrapper"},function(t){a=t,o({editor:e,domElement:t,state:l,props:c}),a.addEventListener("mousedown",function(){if(l.isEditable){var _t354=e.model;_t354.document.selection.getSelectedElement()!==n&&_t354.change(function(e){return e.setSelection(n,"on");});}},!0);}),u={makeEditable:function makeEditable(){l=Object.assign({},l,{isEditable:!0}),o({domElement:a,editor:e,state:l,props:c}),i.change(function(e){e.setAttribute("data-cke-ignore-events","true",d);}),a.querySelector("textarea").focus();},save:function save(t){t!==l.getRawHtmlValue()?(e.execute("htmlEmbed",t),e.editing.view.focus()):this.cancel();},cancel:function cancel(){l=Object.assign({},l,{isEditable:!1}),o({domElement:a,editor:e,state:l,props:c}),e.editing.view.focus(),i.change(function(e){e.removeAttribute("data-cke-ignore-events",d);});}};l={showPreviews:s.showPreviews,isEditable:!1,getRawHtmlValue:function getRawHtmlValue(){return n.getAttribute("value")||"";}},c={sanitizeHtml:s.sanitizeHtml,textareaPlaceholder:t("Paste raw HTML here..."),onEditClick:function onEditClick(){u.makeEditable();},onSaveClick:function onSaveClick(e){u.save(e);},onCancelClick:function onCancelClick(){u.cancel();}};var h=r.createContainerElement("div",{"class":"raw-html-embed","data-html-embed-label":t("HTML snippet"),dir:e.locale.uiLanguageDirection},d);return r.setCustomProperty("rawHtmlApi",u,h),r.setCustomProperty("rawHtml",!0,h),oy(h,r,{label:t("HTML snippet"),hasSelectionHandle:!0});}});}}],[{key:"pluginName",get:function get(){return"HtmlEmbedEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function zx(e,t,i){var n=e.locale.t,s=new pg(e.locale),o=e.commands.get("htmlEmbed");return s.set({"class":"raw-html-embed__".concat(t,"-button"),icon:vm.pencil,tooltip:!0,tooltipPosition:"rtl"===e.locale.uiLanguageDirection?"e":"w"}),s.render(),"edit"===t?(s.set({icon:vm.pencil,label:n("Edit source")}),s.bind("isEnabled").to(o)):"save"===t?(s.set({icon:vm.check,label:n("Save changes")}),s.bind("isEnabled").to(o)):s.set({icon:vm.cancel,label:n("Cancel")}),s.on("execute",i),s;}var Hx=/*#__PURE__*/function(_Dr111){function Hx(){_classCallCheck(this,Hx);return _callSuper(this,Hx,arguments);}_inherits(Hx,_Dr111);return _createClass(Hx,[{key:"init",value:function init(){var _this563=this;var e=this.editor,t=e.locale.t;e.ui.componentFactory.add("htmlEmbed",function(){var e=_this563._createButton(pg);return e.set({tooltip:!0,label:t("Insert HTML")}),e;}),e.ui.componentFactory.add("menuBar:htmlEmbed",function(){var e=_this563._createButton(Rg);return e.set({label:t("HTML snippet")}),e;});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.commands.get("htmlEmbed"),n=new e(t.locale);return n.set({icon:vm.html}),n.bind("isEnabled").to(i,"isEnabled"),this.listenTo(n,"execute",function(){t.execute("htmlEmbed"),t.editing.view.focus();t.editing.view.document.selection.getSelectedElement().getCustomProperty("rawHtmlApi").makeEditable();}),n;}}],[{key:"pluginName",get:function get(){return"HtmlEmbedUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var $x=/*#__PURE__*/function(_Dr112){function $x(){_classCallCheck(this,$x);return _callSuper(this,$x,arguments);}_inherits($x,_Dr112);return _createClass($x,null,[{key:"requires",get:function get(){return[Dx,Hx,Ty];}},{key:"pluginName",get:function get(){return"HtmlEmbed";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function Ux(e,t,i,n){t&&function(e,t,i){if(t.attributes)for(var _i403=0,_Object$entries12=Object.entries(t.attributes);_i403<_Object$entries12.length;_i403++){var _Object$entries12$_i=_slicedToArray(_Object$entries12[_i403],1),_n218=_Object$entries12$_i[0];e.removeAttribute(_n218,i);}if(t.styles)for(var _i404=0,_Object$keys15=Object.keys(t.styles);_i404<_Object$keys15.length;_i404++){var _n219=_Object$keys15[_i404];e.removeStyle(_n219,i);}t.classes&&e.removeClass(t.classes,i);}(e,t,n),i&&Wx(e,i,n);}function Wx(e,t,i){if(t.attributes)for(var _i405=0,_Object$entries13=Object.entries(t.attributes);_i405<_Object$entries13.length;_i405++){var _Object$entries13$_i=_slicedToArray(_Object$entries13[_i405],2),_n220=_Object$entries13$_i[0],_s156=_Object$entries13$_i[1];e.setAttribute(_n220,_s156,i);}t.styles&&e.setStyle(t.styles,i),t.classes&&e.addClass(t.classes,i);}function jx(e,t,i,n,s){var o=t.getAttribute(i),r={};for(var _i406=0,_arr5=["attributes","styles","classes"];_i406<_arr5.length;_i406++){var _e546=_arr5[_i406];if(_e546!=n){o&&o[_e546]&&(r[_e546]=o[_e546]);continue;}if("classes"==n){var _t355=new Set(o&&o.classes||[]);s(_t355),_t355.size&&(r[_e546]=Array.from(_t355));continue;}var _t356=new Map(Object.entries(o&&o[_e546]||{}));s(_t356),_t356.size&&(r[_e546]=Object.fromEntries(_t356));}Object.keys(r).length?t.is("documentSelection")?e.setSelectionAttribute(i,r):e.setAttribute(i,r,t):o&&(t.is("documentSelection")?e.removeSelectionAttribute(i):e.removeAttribute(i,t));}function qx(e){return"html".concat((t=e,Hs(t).replace(/ /g,"")),"Attributes");var t;}function Gx(_ref173){var e=_ref173.model;return function(t,i){return i.writer.createElement(e,{htmlContent:t.getCustomProperty("$rawContent")});};}function Kx(e,_ref174){var t=_ref174.view,i=_ref174.isInline;var n=e.t;return function(e,_ref175){var s=_ref175.writer;var o=n("HTML object"),r=Zx(t,e,s),a=e.getAttribute(qx(t));s.addClass("html-object-embed__content",r),a&&Wx(s,a,r);return oy(s.createContainerElement(i?"span":"div",{"class":"html-object-embed","data-html-object-embed-label":o},r),s,{label:o});};}function Zx(e,t,i){return i.createRawElement(e,null,function(e,i){i.setContentOf(e,t.getAttribute("htmlContent"));});}function Jx(_ref176,n){var e=_ref176.view,t=_ref176.model,i=_ref176.allowEmpty;return function(t){t.on("element:".concat(e),function(e,t,o){var r=n.processViewAttributes(t.viewItem,o);if(r||o.consumable.test(t.viewItem,{name:!0})){if(r=r||{},o.consumable.consume(t.viewItem,{name:!0}),t.modelRange||(t=Object.assign(t,o.convertChildren(t.viewItem,t.modelCursor))),i&&t.modelRange.isCollapsed&&Object.keys(r).length){var _e547=o.writer.createElement("htmlEmptyElement");if(!o.safeInsert(_e547,t.modelCursor))return;var _i407=o.getSplitParts(_e547);return t.modelRange=o.writer.createRange(t.modelRange.start,o.writer.createPositionAfter(_i407[_i407.length-1])),o.updateConversionResult(_e547,t),void s(_e547,r,o);}var _iterator529=_createForOfIteratorHelper(t.modelRange.getItems()),_step529;try{for(_iterator529.s();!(_step529=_iterator529.n()).done;){var _e548=_step529.value;s(_e548,r,o);}}catch(err){_iterator529.e(err);}finally{_iterator529.f();}}},{priority:"low"});};function s(e,i,n){if(n.schema.checkAttribute(e,t)){var _s157=function(e,t){var i=Un(e);var n="attributes";for(n in t)i[n]="classes"==n?Array.from(new Set([].concat(_toConsumableArray(e[n]||[]),_toConsumableArray(t[n])))):_objectSpread(_objectSpread({},e[n]),t[n]);return i;}(i,e.getAttribute(t)||{});n.writer.setAttribute(t,_s157,e);}}}function Qx(_ref177,i){var e=_ref177.model,t=_ref177.view;return function(n,_ref178){var s=_ref178.writer,o=_ref178.consumable;if(!n.hasAttribute(e))return null;var r=s.createContainerElement(t),a=n.getAttribute(e);return o.consume(n,"attribute:".concat(e)),Wx(s,a,r),r.getFillerOffset=function(){return null;},i?oy(r,s):r;};}function Yx(_ref179){var e=_ref179.priority,t=_ref179.view;return function(i,n){if(!i)return;var s=n.writer,o=s.createAttributeElement(t,null,{priority:e});return Wx(s,i,o),o;};}function Xx(_ref180,t){var e=_ref180.view;return function(i){i.on("element:".concat(e),function(e,i,n){if(!i.modelRange||i.modelRange.isCollapsed)return;var s=t.processViewAttributes(i.viewItem,n);s&&n.writer.setAttribute(qx(i.viewItem.name),s,i.modelRange);},{priority:"low"});};}function eA(_ref181){var e=_ref181.view,t=_ref181.model;return function(i){i.on("attribute:".concat(qx(e),":").concat(t),function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=t.attributeOldValue,s=t.attributeNewValue;Ux(i.writer,n,s,i.mapper.toViewElement(t.item));});};}var tA=[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6","$text"],allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowIn:["$root","$container"],allowChildren:["paragraph","htmlP","htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}}],iA=[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref"},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}];var nA=/*#__PURE__*/function(_Dr113){function nA(){var _this564;_classCallCheck(this,nA);for(var _len71=arguments.length,args=new Array(_len71),_key71=0;_key71<_len71;_key71++){args[_key71]=arguments[_key71];}_this564=_callSuper(this,nA,[].concat(args));_defineProperty(_this564,"_definitions",[]);return _this564;}_inherits(nA,_Dr113);return _createClass(nA,[{key:"init",value:function init(){for(var _i408=0,_tA=tA;_i408<_tA.length;_i408++){var _e549=_tA[_i408];this.registerBlockElement(_e549);}for(var _i409=0,_iA=iA;_i409<_iA.length;_i409++){var _e550=_iA[_i409];this.registerInlineElement(_e550);}}},{key:"registerBlockElement",value:function registerBlockElement(e){this._definitions.push(_objectSpread(_objectSpread({},e),{},{isBlock:!0}));}},{key:"registerInlineElement",value:function registerInlineElement(e){this._definitions.push(_objectSpread(_objectSpread({},e),{},{isInline:!0}));}},{key:"extendBlockElement",value:function extendBlockElement(e){this._extendDefinition(_objectSpread(_objectSpread({},e),{},{isBlock:!0}));}},{key:"extendInlineElement",value:function extendInlineElement(e){this._extendDefinition(_objectSpread(_objectSpread({},e),{},{isInline:!0}));}},{key:"getDefinitionsForView",value:function getDefinitionsForView(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=new Set();var _iterator530=_createForOfIteratorHelper(this._getMatchingViewDefinitions(e)),_step530;try{for(_iterator530.s();!(_step530=_iterator530.n()).done;){var _n221=_step530.value;if(t){var _iterator531=_createForOfIteratorHelper(this._getReferences(_n221.model)),_step531;try{for(_iterator531.s();!(_step531=_iterator531.n()).done;){var _e551=_step531.value;i.add(_e551);}}catch(err){_iterator531.e(err);}finally{_iterator531.f();}}i.add(_n221);}}catch(err){_iterator530.e(err);}finally{_iterator530.f();}return i;}},{key:"getDefinitionsForModel",value:function getDefinitionsForModel(e){return this._definitions.filter(function(t){return t.model==e;});}},{key:"_getMatchingViewDefinitions",value:function _getMatchingViewDefinitions(e){return this._definitions.filter(function(t){return t.view&&function(e,t){if("string"==typeof e)return e===t;if(e instanceof RegExp)return e.test(t);return!1;}(e,t.view);});}},{key:"_getReferences",value:/*#__PURE__*/_regeneratorRuntime().mark(function _getReferences(e){var _this565=this;var t,i,_iterator532,_step532,_n222,_iterator533,_step533,_i410,_iterator534,_step534,_loop24;return _regeneratorRuntime().wrap(function _getReferences$(_context56){while(1)switch(_context56.prev=_context56.next){case 0:t=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],i=this._definitions.filter(function(t){return t.model==e;});_iterator532=_createForOfIteratorHelper(i);_context56.prev=2;_iterator532.s();case 4:if((_step532=_iterator532.n()).done){_context56.next=40;break;}_n222=_step532.value.modelSchema;if(!_n222){_context56.next=38;break;}_iterator533=_createForOfIteratorHelper(t);_context56.prev=8;_iterator533.s();case 10:if((_step533=_iterator533.n()).done){_context56.next=30;break;}_i410=_step533.value;_iterator534=_createForOfIteratorHelper(gr(_n222[_i410]||[]));_context56.prev=13;_loop24=/*#__PURE__*/_regeneratorRuntime().mark(function _loop24(){var t,i,_iterator535,_step535,_n223;return _regeneratorRuntime().wrap(function _loop24$(_context55){while(1)switch(_context55.prev=_context55.next){case 0:t=_step534.value;i=_this565._definitions.filter(function(e){return e.model==t;});_iterator535=_createForOfIteratorHelper(i);_context55.prev=3;_iterator535.s();case 5:if((_step535=_iterator535.n()).done){_context55.next=14;break;}_n223=_step535.value;_context55.t0=t!==e;if(!_context55.t0){_context55.next=12;break;}return _context55.delegateYield(_this565._getReferences(_n223.model),"t1",10);case 10:_context55.next=12;return _n223;case 12:_context55.next=5;break;case 14:_context55.next=19;break;case 16:_context55.prev=16;_context55.t2=_context55["catch"](3);_iterator535.e(_context55.t2);case 19:_context55.prev=19;_iterator535.f();return _context55.finish(19);case 22:case"end":return _context55.stop();}},_loop24,null,[[3,16,19,22]]);});_iterator534.s();case 16:if((_step534=_iterator534.n()).done){_context56.next=20;break;}return _context56.delegateYield(_loop24(),"t0",18);case 18:_context56.next=16;break;case 20:_context56.next=25;break;case 22:_context56.prev=22;_context56.t1=_context56["catch"](13);_iterator534.e(_context56.t1);case 25:_context56.prev=25;_iterator534.f();return _context56.finish(25);case 28:_context56.next=10;break;case 30:_context56.next=35;break;case 32:_context56.prev=32;_context56.t2=_context56["catch"](8);_iterator533.e(_context56.t2);case 35:_context56.prev=35;_iterator533.f();return _context56.finish(35);case 38:_context56.next=4;break;case 40:_context56.next=45;break;case 42:_context56.prev=42;_context56.t3=_context56["catch"](2);_iterator532.e(_context56.t3);case 45:_context56.prev=45;_iterator532.f();return _context56.finish(45);case 48:case"end":return _context56.stop();}},_getReferences,this,[[2,42,45,48],[8,32,35,38],[13,22,25,28]]);})},{key:"_extendDefinition",value:function _extendDefinition(e){var t=Array.from(this._definitions.entries()).filter(function(_ref182){var _ref183=_slicedToArray(_ref182,2),t=_ref183[1];return t.model==e.model;});if(0!=t.length){var _iterator536=_createForOfIteratorHelper(t),_step536;try{for(_iterator536.s();!(_step536=_iterator536.n()).done;){var _step536$value=_slicedToArray(_step536.value,2),_i411=_step536$value[0],_n224=_step536$value[1];this._definitions[_i411]=As({},_n224,e,function(e,t){return Array.isArray(e)?e.concat(t):void 0;});}}catch(err){_iterator536.e(err);}finally{_iterator536.f();}}else this._definitions.push(e);}}],[{key:"pluginName",get:function get(){return"DataSchema";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var sA=/*#__PURE__*/function(_Dr114){function sA(e){var _this566;_classCallCheck(this,sA);_this566=_callSuper(this,sA,[e]),_defineProperty(_assertThisInitialized(_this566),"_dataSchema",void 0),_defineProperty(_assertThisInitialized(_this566),"_allowedAttributes",void 0),_defineProperty(_assertThisInitialized(_this566),"_disallowedAttributes",void 0),_defineProperty(_assertThisInitialized(_this566),"_allowedElements",void 0),_defineProperty(_assertThisInitialized(_this566),"_disallowedElements",void 0),_defineProperty(_assertThisInitialized(_this566),"_dataInitialized",void 0),_defineProperty(_assertThisInitialized(_this566),"_coupledAttributes",void 0),_this566._dataSchema=e.plugins.get("DataSchema"),_this566._allowedAttributes=new aa(),_this566._disallowedAttributes=new aa(),_this566._allowedElements=new Set(),_this566._disallowedElements=new Set(),_this566._dataInitialized=!1,_this566._coupledAttributes=null,_this566._registerElementsAfterInit(),_this566._registerElementHandlers(),_this566._registerCoupledAttributesPostFixer(),_this566._registerAssociatedHtmlAttributesPostFixer();return _this566;}_inherits(sA,_Dr114);return _createClass(sA,[{key:"loadAllowedConfig",value:function loadAllowedConfig(e){var _this567=this;var _iterator537=_createForOfIteratorHelper(e),_step537;try{for(_iterator537.s();!(_step537=_iterator537.n()).done;){var _t357=_step537.value;var _e552=_t357.name||/[\s\S]+/,_i412=cA(_t357);this.allowElement(_e552),_i412.forEach(function(e){return _this567.allowAttributes(e);});}}catch(err){_iterator537.e(err);}finally{_iterator537.f();}}},{key:"loadDisallowedConfig",value:function loadDisallowedConfig(e){var _this568=this;var _iterator538=_createForOfIteratorHelper(e),_step538;try{for(_iterator538.s();!(_step538=_iterator538.n()).done;){var _t358=_step538.value;var _e553=_t358.name||/[\s\S]+/,_i413=cA(_t358);0==_i413.length?this.disallowElement(_e553):_i413.forEach(function(e){return _this568.disallowAttributes(e);});}}catch(err){_iterator538.e(err);}finally{_iterator538.f();}}},{key:"loadAllowedEmptyElementsConfig",value:function loadAllowedEmptyElementsConfig(e){var _iterator539=_createForOfIteratorHelper(e),_step539;try{for(_iterator539.s();!(_step539=_iterator539.n()).done;){var _t359=_step539.value;this.allowEmptyElement(_t359);}}catch(err){_iterator539.e(err);}finally{_iterator539.f();}}},{key:"allowElement",value:function allowElement(e){var _iterator540=_createForOfIteratorHelper(this._dataSchema.getDefinitionsForView(e,!0)),_step540;try{for(_iterator540.s();!(_step540=_iterator540.n()).done;){var _t360=_step540.value;this._addAllowedElement(_t360),this._coupledAttributes=null;}}catch(err){_iterator540.e(err);}finally{_iterator540.f();}}},{key:"disallowElement",value:function disallowElement(e){var _iterator541=_createForOfIteratorHelper(this._dataSchema.getDefinitionsForView(e,!1)),_step541;try{for(_iterator541.s();!(_step541=_iterator541.n()).done;){var _t361=_step541.value;this._disallowedElements.add(_t361.view);}}catch(err){_iterator541.e(err);}finally{_iterator541.f();}}},{key:"allowEmptyElement",value:function allowEmptyElement(e){var _iterator542=_createForOfIteratorHelper(this._dataSchema.getDefinitionsForView(e,!0)),_step542;try{for(_iterator542.s();!(_step542=_iterator542.n()).done;){var _t362=_step542.value;_t362.isInline&&this._dataSchema.extendInlineElement(_objectSpread(_objectSpread({},_t362),{},{allowEmpty:!0}));}}catch(err){_iterator542.e(err);}finally{_iterator542.f();}}},{key:"allowAttributes",value:function allowAttributes(e){this._allowedAttributes.add(e);}},{key:"disallowAttributes",value:function disallowAttributes(e){this._disallowedAttributes.add(e);}},{key:"processViewAttributes",value:function processViewAttributes(e,t){var i=t.consumable;return oA(e,this._disallowedAttributes,i),function(e,_ref184){var t=_ref184.attributes,i=_ref184.classes,n=_ref184.styles;if(!t.length&&!i.length&&!n.length)return null;return _objectSpread(_objectSpread(_objectSpread({},t.length&&{attributes:rA(e,t)}),n.length&&{styles:aA(e,n)}),i.length&&{classes:i});}(e,oA(e,this._allowedAttributes,i));}},{key:"_addAllowedElement",value:function _addAllowedElement(e){var _this569=this;if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&"string"==typeof e.appliesToBlock){var _iterator543=_createForOfIteratorHelper(this._dataSchema.getDefinitionsForModel(e.appliesToBlock)),_step543;try{for(_iterator543.s();!(_step543=_iterator543.n()).done;){var _t363=_step543.value;_t363.isBlock&&this._addAllowedElement(_t363);}}catch(err){_iterator543.e(err);}finally{_iterator543.f();}}this._dataInitialized&&this.editor.data.once("set",function(){_this569._fireRegisterEvent(e);},{priority:C.highest+1});}}},{key:"_registerElementsAfterInit",value:function _registerElementsAfterInit(){var _this570=this;this.editor.data.on("init",function(){_this570._dataInitialized=!0;var _iterator544=_createForOfIteratorHelper(_this570._allowedElements),_step544;try{for(_iterator544.s();!(_step544=_iterator544.n()).done;){var _e554=_step544.value;_this570._fireRegisterEvent(_e554);}}catch(err){_iterator544.e(err);}finally{_iterator544.f();}},{priority:C.highest+1});}},{key:"_registerElementHandlers",value:function _registerElementHandlers(){var _this571=this;this.on("register",function(e,t){var i=_this571.editor.model.schema;if(t.isObject&&!i.isRegistered(t.model))_this571._registerObjectElement(t);else if(t.isBlock)_this571._registerBlockElement(t);else{if(!t.isInline)throw new A("data-filter-invalid-definition",null,t);_this571._registerInlineElement(t);}e.stop();},{priority:"lowest"});}},{key:"_registerCoupledAttributesPostFixer",value:function _registerCoupledAttributesPostFixer(){var _this572=this;var e=this.editor.model,t=e.document.selection;e.document.registerPostFixer(function(t){var i=e.document.differ.getChanges();var n=!1;var s=_this572._getCoupledAttributesMap();var _iterator545=_createForOfIteratorHelper(i),_step545;try{for(_iterator545.s();!(_step545=_iterator545.n()).done;){var _e555=_step545.value;if("attribute"!=_e555.type||null!==_e555.attributeNewValue)continue;var _i414=s.get(_e555.attributeKey);if(_i414){var _iterator546=_createForOfIteratorHelper(_e555.range.getWalker()),_step546;try{for(_iterator546.s();!(_step546=_iterator546.n()).done;){var _s158=_step546.value.item;var _iterator547=_createForOfIteratorHelper(_i414),_step547;try{for(_iterator547.s();!(_step547=_iterator547.n()).done;){var _e556=_step547.value;_s158.hasAttribute(_e556)&&(t.removeAttribute(_e556,_s158),n=!0);}}catch(err){_iterator547.e(err);}finally{_iterator547.f();}}}catch(err){_iterator546.e(err);}finally{_iterator546.f();}}}}catch(err){_iterator545.e(err);}finally{_iterator545.f();}return n;}),this.listenTo(t,"change:attribute",function(i,_ref185){var n=_ref185.attributeKeys;var s=new Set(),o=_this572._getCoupledAttributesMap();var _iterator548=_createForOfIteratorHelper(n),_step548;try{for(_iterator548.s();!(_step548=_iterator548.n()).done;){var _e557=_step548.value;if(t.hasAttribute(_e557))continue;var _i415=o.get(_e557);if(_i415){var _iterator550=_createForOfIteratorHelper(_i415),_step550;try{for(_iterator550.s();!(_step550=_iterator550.n()).done;){var _e558=_step550.value;t.hasAttribute(_e558)&&s.add(_e558);}}catch(err){_iterator550.e(err);}finally{_iterator550.f();}}}}catch(err){_iterator548.e(err);}finally{_iterator548.f();}0!=s.size&&e.change(function(e){var _iterator549=_createForOfIteratorHelper(s),_step549;try{for(_iterator549.s();!(_step549=_iterator549.n()).done;){var _t364=_step549.value;e.removeSelectionAttribute(_t364);}}catch(err){_iterator549.e(err);}finally{_iterator549.f();}});});}},{key:"_registerAssociatedHtmlAttributesPostFixer",value:function _registerAssociatedHtmlAttributesPostFixer(){var e=this.editor.model;e.document.registerPostFixer(function(t){var i=e.document.differ.getChanges();var n=!1;var _iterator551=_createForOfIteratorHelper(i),_step551;try{for(_iterator551.s();!(_step551=_iterator551.n()).done;){var _s159=_step551.value;if("insert"===_s159.type&&"$text"!==_s159.name){var _iterator552=_createForOfIteratorHelper(_s159.attributes.keys()),_step552;try{for(_iterator552.s();!(_step552=_iterator552.n()).done;){var _i416=_step552.value;_i416.startsWith("html")&&_i416.endsWith("Attributes")&&(e.schema.checkAttribute(_s159.name,_i416)||(t.removeAttribute(_i416,_s159.position.nodeAfter),n=!0));}}catch(err){_iterator552.e(err);}finally{_iterator552.f();}}}}catch(err){_iterator551.e(err);}finally{_iterator551.f();}return n;});}},{key:"_getCoupledAttributesMap",value:function _getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map();var _iterator553=_createForOfIteratorHelper(this._allowedElements),_step553;try{for(_iterator553.s();!(_step553=_iterator553.n()).done;){var _e559=_step553.value;if(_e559.coupledAttribute&&_e559.model){var _t365=this._coupledAttributes.get(_e559.coupledAttribute);_t365?_t365.push(_e559.model):this._coupledAttributes.set(_e559.coupledAttribute,[_e559.model]);}}}catch(err){_iterator553.e(err);}finally{_iterator553.f();}return this._coupledAttributes;}},{key:"_fireRegisterEvent",value:function _fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?"register:".concat(e.view):"register",e);}},{key:"_registerObjectElement",value:function _registerObjectElement(e){var t=this.editor,i=t.model.schema,n=t.conversion,s=e.view,o=e.model;i.register(o,e.modelSchema),s&&(i.extend(e.model,{allowAttributes:[qx(s),"htmlContent"]}),t.data.registerRawContentMatcher({name:s}),n["for"]("upcast").elementToElement({view:s,model:Gx(e),converterPriority:C.low+2}),n["for"]("upcast").add(Xx(e,this)),n["for"]("editingDowncast").elementToStructure({model:{name:o,attributes:[qx(s)]},view:Kx(t,e)}),n["for"]("dataDowncast").elementToElement({model:o,view:function view(e,_ref186){var t=_ref186.writer;return Zx(s,e,t);}}),n["for"]("dataDowncast").add(eA(e)));}},{key:"_registerBlockElement",value:function _registerBlockElement(e){var t=this.editor,i=t.model.schema,n=t.conversion,s=e.view,o=e.model;if(!i.isRegistered(e.model)){if(i.register(e.model,e.modelSchema),!s)return;n["for"]("upcast").elementToElement({model:o,view:s,converterPriority:C.low+2}),n["for"]("downcast").elementToElement({model:o,view:s});}s&&(i.extend(e.model,{allowAttributes:qx(s)}),n["for"]("upcast").add(Xx(e,this)),n["for"]("downcast").add(eA(e)));}},{key:"_registerInlineElement",value:function _registerInlineElement(e){var t=this.editor,i=t.model.schema,n=t.conversion,s=e.model;e.appliesToBlock||(i.extend("$text",{allowAttributes:s}),e.attributeProperties&&i.setAttributeProperties(s,e.attributeProperties),n["for"]("upcast").add(Jx(e,this)),n["for"]("downcast").attributeToElement({model:s,view:Yx(e)}),e.allowEmpty&&(i.setAttributeProperties(s,{copyFromObject:!1}),i.isRegistered("htmlEmptyElement")||i.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"}),t.data.htmlProcessor.domConverter.registerInlineObjectMatcher(function(t){return t.name==e.view&&t.isEmpty&&Array.from(t.getAttributeKeys()).length?{name:!0}:null;}),n["for"]("editingDowncast").elementToElement({model:"htmlEmptyElement",view:Qx(e,!0)}),n["for"]("dataDowncast").elementToElement({model:"htmlEmptyElement",view:Qx(e)})));}}],[{key:"pluginName",get:function get(){return"DataFilter";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[nA,Ty];}}]);}(Dr);function oA(e,t,i){var n=t.matchAll(e)||[],s=e.document.stylesProcessor;return n.reduce(function(t,_ref187){var n=_ref187.match;var _iterator554=_createForOfIteratorHelper(n.styles||[]),_step554;try{var _loop25=function _loop25(){var o=_step554.value;var n=s.getRelatedStyles(o).filter(function(e){return e.split("-").length>o.split("-").length;}).sort(function(e,t){return t.split("-").length-e.split("-").length;});var _iterator557=_createForOfIteratorHelper(n),_step557;try{for(_iterator557.s();!(_step557=_iterator557.n()).done;){var _s160=_step557.value;i.consume(e,{styles:[_s160]})&&t.styles.push(_s160);}}catch(err){_iterator557.e(err);}finally{_iterator557.f();}i.consume(e,{styles:[o]})&&t.styles.push(o);};for(_iterator554.s();!(_step554=_iterator554.n()).done;){_loop25();}}catch(err){_iterator554.e(err);}finally{_iterator554.f();}var _iterator555=_createForOfIteratorHelper(n.classes||[]),_step555;try{for(_iterator555.s();!(_step555=_iterator555.n()).done;){var _s161=_step555.value;i.consume(e,{classes:[_s161]})&&t.classes.push(_s161);}}catch(err){_iterator555.e(err);}finally{_iterator555.f();}var _iterator556=_createForOfIteratorHelper(n.attributes||[]),_step556;try{for(_iterator556.s();!(_step556=_iterator556.n()).done;){var _s162=_step556.value;i.consume(e,{attributes:[_s162]})&&t.attributes.push(_s162);}}catch(err){_iterator556.e(err);}finally{_iterator556.f();}return t;},{attributes:[],classes:[],styles:[]});}function rA(e,t){var i={};var _iterator558=_createForOfIteratorHelper(t),_step558;try{for(_iterator558.s();!(_step558=_iterator558.n()).done;){var _n225=_step558.value;var _t366=e.getAttribute(_n225);void 0!==_t366&&Fo(_n225)&&(i[_n225]=_t366);}}catch(err){_iterator558.e(err);}finally{_iterator558.f();}return i;}function aA(e,t){var i=new da(e.document.stylesProcessor);var _iterator559=_createForOfIteratorHelper(t),_step559;try{for(_iterator559.s();!(_step559=_iterator559.n()).done;){var _n226=_step559.value;var _t367=e.getStyle(_n226);void 0!==_t367&&i.set(_n226,_t367);}}catch(err){_iterator559.e(err);}finally{_iterator559.f();}return Object.fromEntries(i.getStylesEntries());}function lA(e,t){var i=e.name,n=e[t];return ei(n)?Object.entries(n).map(function(_ref188){var _ref189=_slicedToArray(_ref188,2),e=_ref189[0],n=_ref189[1];return _defineProperty({name:i},t,_defineProperty({},e,n));}):Array.isArray(n)?n.map(function(e){return _defineProperty({name:i},t,[e]);}):[e];}function cA(e){var t=e.name,i=e.attributes,n=e.classes,s=e.styles,o=[];return i&&o.push.apply(o,_toConsumableArray(lA({name:t,attributes:i},"attributes"))),n&&o.push.apply(o,_toConsumableArray(lA({name:t,classes:n},"classes"))),s&&o.push.apply(o,_toConsumableArray(lA({name:t,styles:s},"styles"))),o;}var dA=/*#__PURE__*/function(_Dr115){function dA(){_classCallCheck(this,dA);return _callSuper(this,dA,arguments);}_inherits(dA,_Dr115);return _createClass(dA,[{key:"init",value:function init(){var _this573=this;if(!this.editor.plugins.has("CodeBlockEditing"))return;var e=this.editor.plugins.get(sA);e.on("register:pre",function(t,i){if("codeBlock"!==i.model)return;var n=_this573.editor,s=n.model.schema,o=n.conversion;s.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),o["for"]("upcast").add(function(e){return function(t){t.on("element:code",function(t,i,n){var s=i.viewItem,o=s.parent;function r(t,s){var o=e.processViewAttributes(t,n);o&&n.writer.setAttribute(s,o,i.modelRange);}o&&o.is("element","pre")&&(r(o,"htmlPreAttributes"),r(s,"htmlContentAttributes"));},{priority:"low"});};}(e)),o["for"]("downcast").add(function(e){e.on("attribute:htmlPreAttributes:codeBlock",function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=t.attributeOldValue,s=t.attributeNewValue,o=i.mapper.toViewElement(t.item).parent;Ux(i.writer,n,s,o);}),e.on("attribute:htmlContentAttributes:codeBlock",function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=t.attributeOldValue,s=t.attributeNewValue,o=i.mapper.toViewElement(t.item);Ux(i.writer,n,s,o);});}),t.stop();});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"CodeBlockElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var uA=/*#__PURE__*/function(_Dr116){function uA(){_classCallCheck(this,uA);return _callSuper(this,uA,arguments);}_inherits(uA,_Dr116);return _createClass(uA,[{key:"init",value:function init(){var _this574=this;this.editor.plugins.get(sA).on("register",function(e,t){var i=t,n=_this574.editor,s=n.model.schema,o=n.conversion;if(!i.paragraphLikeModel)return;if(s.isRegistered(i.model)||s.isRegistered(i.paragraphLikeModel))return;var r={model:i.paragraphLikeModel,view:i.view};s.register(i.model,i.modelSchema),s.register(r.model,{inheritAllFrom:"$block"}),o["for"]("upcast").elementToElement({view:i.view,model:function model(e,_ref192){var t=_ref192.writer;return _this574._hasBlockContent(e)?t.createElement(i.model):t.createElement(r.model);},converterPriority:C.low+.5}),o["for"]("downcast").elementToElement({view:i.view,model:i.model}),_this574._addAttributeConversion(i),o["for"]("downcast").elementToElement({view:r.view,model:r.model}),_this574._addAttributeConversion(r),e.stop();});}},{key:"_hasBlockContent",value:function _hasBlockContent(e){var t=this.editor.editing.view,i=t.domConverter.blockElements;var _iterator560=_createForOfIteratorHelper(t.createRangeIn(e).getItems()),_step560;try{for(_iterator560.s();!(_step560=_iterator560.n()).done;){var _n227=_step560.value;if(_n227.is("element")&&i.includes(_n227.name))return!0;}}catch(err){_iterator560.e(err);}finally{_iterator560.f();}return!1;}},{key:"_addAttributeConversion",value:function _addAttributeConversion(e){var t=this.editor,i=t.conversion,n=t.plugins.get(sA);t.model.schema.extend(e.model,{allowAttributes:qx(e.view)}),i["for"]("upcast").add(Xx(e,n)),i["for"]("downcast").add(eA(e));}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"DualContentModelElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var hA=/*#__PURE__*/function(_Dr117){function hA(){_classCallCheck(this,hA);return _callSuper(this,hA,arguments);}_inherits(hA,_Dr117);return _createClass(hA,[{key:"init",value:function init(){var e=this.editor;if(!e.plugins.has("HeadingEditing"))return;var t=e.config.get("heading.options");this.registerHeadingElements(e,t);}},{key:"registerHeadingElements",value:function registerHeadingElements(e,t){var i=e.plugins.get(nA),n=[];var _iterator561=_createForOfIteratorHelper(t),_step561;try{for(_iterator561.s();!(_step561=_iterator561.n()).done;){var _e560=_step561.value;"model"in _e560&&"view"in _e560&&(i.registerBlockElement({view:_e560.view,model:_e560.model}),n.push(_e560.model));}}catch(err){_iterator561.e(err);}finally{_iterator561.f();}i.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:n}}),i.extendBlockElement({model:"htmlSummary",modelSchema:{allowChildren:n}});}}],[{key:"requires",get:function get(){return[nA,K_];}},{key:"pluginName",get:function get(){return"HeadingElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function mA(e,t,i){var n=e.createRangeOn(t);var _iterator562=_createForOfIteratorHelper(n.getWalker()),_step562;try{for(_iterator562.s();!(_step562=_iterator562.n()).done;){var _e561=_step562.value.item;if(_e561.is("element",i))return _e561;}}catch(err){_iterator562.e(err);}finally{_iterator562.f();}}var gA=/*#__PURE__*/function(_Dr118){function gA(){_classCallCheck(this,gA);return _callSuper(this,gA,arguments);}_inherits(gA,_Dr118);return _createClass(gA,[{key:"init",value:function init(){var e=this.editor;if(!e.plugins.has("ImageInlineEditing")&&!e.plugins.has("ImageBlockEditing"))return;var t=e.model.schema,i=e.conversion,n=e.plugins.get(sA);n.on("register:figure",function(){i["for"]("upcast").add(function(e){return function(t){t.on("element:figure",function(t,i,n){var s=i.viewItem;if(!i.modelRange||!s.hasClass("image"))return;var o=e.processViewAttributes(s,n);o&&n.writer.setAttribute("htmlFigureAttributes",o,i.modelRange);},{priority:"low"});};}(n));}),n.on("register:img",function(s,o){"imageBlock"!==o.model&&"imageInline"!==o.model||(t.isRegistered("imageBlock")&&t.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),t.isRegistered("imageInline")&&t.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),i["for"]("upcast").add(function(e){return function(t){t.on("element:img",function(t,i,n){if(!i.modelRange)return;var s=i.viewItem,o=e.processViewAttributes(s,n);o&&n.writer.setAttribute("htmlImgAttributes",o,i.modelRange);},{priority:"low"});};}(n)),i["for"]("downcast").add(function(e){function t(t){e.on("attribute:".concat(t,":imageInline"),function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=t.attributeOldValue,s=t.attributeNewValue,o=i.mapper.toViewElement(t.item);Ux(i.writer,n,s,o);},{priority:"low"});}function i(t,i){e.on("attribute:".concat(i,":imageBlock"),function(e,i,n){if(!n.consumable.test(i.item,e.name))return;var s=i.attributeOldValue,o=i.attributeNewValue,r=n.mapper.toViewElement(i.item),a=mA(n.writer,r,t);a&&(Ux(n.writer,s,o,a),n.consumable.consume(i.item,e.name));},{priority:"low"}),"a"===t&&e.on("attribute:linkHref:imageBlock",function(e,t,i){if(!i.consumable.consume(t.item,"attribute:htmlLinkAttributes:imageBlock"))return;var n=i.mapper.toViewElement(t.item),s=mA(i.writer,n,"a");Wx(i.writer,t.item.getAttribute("htmlLinkAttributes"),s);},{priority:"low"});}t("htmlImgAttributes"),i("img","htmlImgAttributes"),i("figure","htmlFigureAttributes"),i("a","htmlLinkAttributes");}),e.plugins.has("LinkImage")&&i["for"]("upcast").add(function(e,t){var i=t.plugins.get("ImageUtils");return function(t){t.on("element:a",function(t,n,s){var o=n.viewItem;if(!i.findViewImgElement(o))return;var r=n.modelCursor.parent;if(!r.is("element","imageBlock"))return;var a=e.processViewAttributes(o,s);a&&s.writer.setAttribute("htmlLinkAttributes",a,r);},{priority:"low"});};}(n,e)),s.stop());});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"ImageElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var fA=/*#__PURE__*/function(_Dr119){function fA(){_classCallCheck(this,fA);return _callSuper(this,fA,arguments);}_inherits(fA,_Dr119);return _createClass(fA,[{key:"init",value:function init(){var e=this.editor;if(!e.plugins.has("MediaEmbed")||e.config.get("mediaEmbed.previewsInData"))return;var t=e.model.schema,i=e.conversion,n=this.editor.plugins.get(sA),s=this.editor.plugins.get(nA),o=e.config.get("mediaEmbed.elementName");s.registerBlockElement({model:"media",view:o}),n.on("register:figure",function(){i["for"]("upcast").add(function(e){return function(t){t.on("element:figure",function(t,i,n){var s=i.viewItem;if(!i.modelRange||!s.hasClass("media"))return;var o=e.processViewAttributes(s,n);o&&n.writer.setAttribute("htmlFigureAttributes",o,i.modelRange);},{priority:"low"});};}(n));}),n.on("register:".concat(o),function(e,s){"media"===s.model&&(t.extend("media",{allowAttributes:[qx(o),"htmlFigureAttributes"]}),i["for"]("upcast").add(function(e,t){var i=function i(_i417,n,s){function o(t,i){var o=e.processViewAttributes(t,s);o&&s.writer.setAttribute(i,o,n.modelRange);}o(n.viewItem,qx(t));};return function(e){e.on("element:".concat(t),i,{priority:"low"});};}(n,o)),i["for"]("dataDowncast").add(function(e){return function(t){function i(e,i){t.on("attribute:".concat(i,":media"),function(t,i,n){if(!n.consumable.consume(i.item,t.name))return;var s=i.attributeOldValue,o=i.attributeNewValue,r=n.mapper.toViewElement(i.item),a=mA(n.writer,r,e);Ux(n.writer,s,o,a);});}i(e,qx(e)),i("figure","htmlFigureAttributes");};}(o)),e.stop());});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"MediaEmbedElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pA=/*#__PURE__*/function(_Dr120){function pA(){_classCallCheck(this,pA);return _callSuper(this,pA,arguments);}_inherits(pA,_Dr120);return _createClass(pA,[{key:"init",value:function init(){var _this575=this;var e=this.editor.plugins.get(sA);e.on("register:script",function(t,i){var n=_this575.editor,s=n.model.schema,o=n.conversion;s.register("htmlScript",i.modelSchema),s.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),n.data.registerRawContentMatcher({name:"script"}),o["for"]("upcast").elementToElement({view:"script",model:Gx(i)}),o["for"]("upcast").add(Xx(i,e)),o["for"]("downcast").elementToElement({model:"htmlScript",view:function view(e,_ref193){var t=_ref193.writer;return Zx("script",e,t);}}),o["for"]("downcast").add(eA(i)),t.stop();});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"ScriptElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var bA=/*#__PURE__*/function(_Dr121){function bA(){_classCallCheck(this,bA);return _callSuper(this,bA,arguments);}_inherits(bA,_Dr121);return _createClass(bA,[{key:"init",value:function init(){var e=this.editor;if(!e.plugins.has("TableEditing"))return;var t=e.model.schema,i=e.conversion,n=e.plugins.get(sA),s=e.plugins.get("TableUtils");n.on("register:figure",function(){i["for"]("upcast").add(function(e){return function(t){t.on("element:figure",function(t,i,n){var s=i.viewItem;if(!i.modelRange||!s.hasClass("table"))return;var o=e.processViewAttributes(s,n);o&&n.writer.setAttribute("htmlFigureAttributes",o,i.modelRange);},{priority:"low"});};}(n));}),n.on("register:table",function(o,r){"table"===r.model&&(t.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),i["for"]("upcast").add(function(e){return function(t){t.on("element:table",function(t,i,n){if(!i.modelRange)return;var s=i.viewItem;o(s,"htmlTableAttributes");var _iterator563=_createForOfIteratorHelper(s.getChildren()),_step563;try{for(_iterator563.s();!(_step563=_iterator563.n()).done;){var _e562=_step563.value;_e562.is("element","thead")&&o(_e562,"htmlTheadAttributes"),_e562.is("element","tbody")&&o(_e562,"htmlTbodyAttributes");}}catch(err){_iterator563.e(err);}finally{_iterator563.f();}function o(t,s){var o=e.processViewAttributes(t,n);o&&n.writer.setAttribute(s,o,i.modelRange);}},{priority:"low"});};}(n)),i["for"]("downcast").add(function(e){function t(t,i){e.on("attribute:".concat(i,":table"),function(e,i,n){if(!n.consumable.test(i.item,e.name))return;var s=n.mapper.toViewElement(i.item),o=mA(n.writer,s,t);o&&(n.consumable.consume(i.item,e.name),Ux(n.writer,i.attributeOldValue,i.attributeNewValue,o));});}t("table","htmlTableAttributes"),t("figure","htmlFigureAttributes"),t("thead","htmlTheadAttributes"),t("tbody","htmlTbodyAttributes");}),e.model.document.registerPostFixer(function(e,t){return function(i){var n=e.document.differ.getChanges();var s=!1;var _iterator564=_createForOfIteratorHelper(n),_step564;try{for(_iterator564.s();!(_step564=_iterator564.n()).done;){var _e563=_step564.value;if("attribute"!=_e563.type||"headingRows"!=_e563.attributeKey)continue;var _n228=_e563.range.start.nodeAfter,_o84=_n228.getAttribute("htmlTheadAttributes"),_r46=_n228.getAttribute("htmlTbodyAttributes");_o84&&!_e563.attributeNewValue?(i.removeAttribute("htmlTheadAttributes",_n228),s=!0):_r46&&_e563.attributeNewValue==t.getRows(_n228)&&(i.removeAttribute("htmlTbodyAttributes",_n228),s=!0);}}catch(err){_iterator564.e(err);}finally{_iterator564.f();}return s;};}(e.model,s)),o.stop());});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"TableElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var wA=/*#__PURE__*/function(_Dr122){function wA(){_classCallCheck(this,wA);return _callSuper(this,wA,arguments);}_inherits(wA,_Dr122);return _createClass(wA,[{key:"init",value:function init(){var _this576=this;var e=this.editor.plugins.get(sA);e.on("register:style",function(t,i){var n=_this576.editor,s=n.model.schema,o=n.conversion;s.register("htmlStyle",i.modelSchema),s.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),n.data.registerRawContentMatcher({name:"style"}),o["for"]("upcast").elementToElement({view:"style",model:Gx(i)}),o["for"]("upcast").add(Xx(i,e)),o["for"]("downcast").elementToElement({model:"htmlStyle",view:function view(e,_ref194){var t=_ref194.writer;return Zx("style",e,t);}}),o["for"]("downcast").add(eA(i)),t.stop();});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"StyleElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var _A=/*#__PURE__*/function(_Dr123){function _A(){_classCallCheck(this,_A);return _callSuper(this,_A,arguments);}_inherits(_A,_Dr123);return _createClass(_A,[{key:"init",value:function init(){var e=this.editor;if(!e.plugins.has("ListEditing"))return;var t=e.model.schema,i=e.conversion,n=e.plugins.get(sA),s=e.plugins.get("ListEditing"),o=e.plugins.get("ListUtils"),r=["ul","ol","li"];s.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:Wx}),s.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:Wx}),s.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:Wx}),n.on("register",function(e,s){if(!r.includes(s.view))return;if(e.stop(),t.checkAttribute("$block","htmlLiAttributes"))return;var o=r.map(function(e){return qx(e);});t.extend("$listItem",{allowAttributes:o}),i["for"]("upcast").add(function(e){e.on("element:ul",vA("htmlUlAttributes",n),{priority:"low"}),e.on("element:ol",vA("htmlOlAttributes",n),{priority:"low"}),e.on("element:li",vA("htmlLiAttributes",n),{priority:"low"});});}),s.on("postFixer",function(e,_ref195){var t=_ref195.listNodes,i=_ref195.writer;var _iterator565=_createForOfIteratorHelper(t),_step565;try{for(_iterator565.s();!(_step565=_iterator565.n()).done;){var _step565$value=_step565.value,_n229=_step565$value.node,_s163=_step565$value.previousNodeInList;if(_s163){if(_s163.getAttribute("listType")==_n229.getAttribute("listType")){var _t369=yA(_s163.getAttribute("listType")),_o85=_s163.getAttribute(_t369);!Ls(_n229.getAttribute(_t369),_o85)&&i.model.schema.checkAttribute(_n229,_t369)&&(i.setAttribute(_t369,_o85,_n229),e["return"]=!0);}if(_s163.getAttribute("listItemId")==_n229.getAttribute("listItemId")){var _t370=_s163.getAttribute("htmlLiAttributes");!Ls(_n229.getAttribute("htmlLiAttributes"),_t370)&&i.model.schema.checkAttribute(_n229,"htmlLiAttributes")&&(i.setAttribute("htmlLiAttributes",_t370,_n229),e["return"]=!0);}}}}catch(err){_iterator565.e(err);}finally{_iterator565.f();}}),s.on("postFixer",function(e,_ref196){var t=_ref196.listNodes,i=_ref196.writer;var _iterator566=_createForOfIteratorHelper(t),_step566;try{for(_iterator566.s();!(_step566=_iterator566.n()).done;){var _n230=_step566.value.node;var _t371=_n230.getAttribute("listType");!o.isNumberedListType(_t371)&&_n230.getAttribute("htmlOlAttributes")&&(i.removeAttribute("htmlOlAttributes",_n230),e["return"]=!0),o.isNumberedListType(_t371)&&_n230.getAttribute("htmlUlAttributes")&&(i.removeAttribute("htmlUlAttributes",_n230),e["return"]=!0);}}catch(err){_iterator566.e(err);}finally{_iterator566.f();}});}},{key:"afterInit",value:function afterInit(){var e=this.editor;if(!e.commands.get("indentList"))return;var t=e.commands.get("indentList");this.listenTo(t,"afterExecute",function(t,i){e.model.change(function(t){var _iterator567=_createForOfIteratorHelper(i),_step567;try{for(_iterator567.s();!(_step567=_iterator567.n()).done;){var _n231=_step567.value;var _i418=yA(_n231.getAttribute("listType"));e.model.schema.checkAttribute(_n231,_i418)&&t.setAttribute(_i418,{},_n231);}}catch(err){_iterator567.e(err);}finally{_iterator567.f();}});});}}],[{key:"requires",get:function get(){return[sA];}},{key:"pluginName",get:function get(){return"ListElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function vA(e,t){return function(i,n,s){var o=n.viewItem;n.modelRange||Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor));var r=t.processViewAttributes(o,s);var _iterator568=_createForOfIteratorHelper(n.modelRange.getItems({shallow:!0})),_step568;try{for(_iterator568.s();!(_step568=_iterator568.n()).done;){var _t372=_step568.value;_t372.hasAttribute("listItemId")&&(_t372.hasAttribute("htmlUlAttributes")||_t372.hasAttribute("htmlOlAttributes")||s.writer.model.schema.checkAttribute(_t372,e)&&s.writer.setAttribute(e,r||{},_t372));}}catch(err){_iterator568.e(err);}finally{_iterator568.f();}};}function yA(e){return"numbered"===e||"customNumbered"==e?"htmlOlAttributes":"htmlUlAttributes";}var kA=/*#__PURE__*/function(_Dr124){function kA(){_classCallCheck(this,kA);return _callSuper(this,kA,arguments);}_inherits(kA,_Dr124);return _createClass(kA,[{key:"init",value:function init(){var _this577=this;var e=this.editor.plugins.get(sA),t=this.editor.plugins.get(nA);e.on("register:$customElement",function(i,n){i.stop();var s=_this577.editor,o=s.model.schema,r=s.conversion,a=s.editing.view.domConverter.unsafeElements,l=s.data.htmlProcessor.domConverter.preElements;o.register(n.model,n.modelSchema),o.extend(n.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),s.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),r["for"]("upcast").elementToElement({view:/.*/,model:function model(i,o){if("$comment"==i.name)return null;if(!function(e){try{document.createElement(e);}catch(e){return!1;}return!0;}(i.name))return null;if(t.getDefinitionsForView(i.name).size)return null;a.includes(i.name)||a.push(i.name),l.includes(i.name)||l.push(i.name);var r=o.writer.createElement(n.model,{htmlElementName:i.name}),c=e.processViewAttributes(i,o);var d;if(c&&o.writer.setAttribute("htmlCustomElementAttributes",c,r),i.is("element","template")&&i.getCustomProperty("$rawContent"))d=i.getCustomProperty("$rawContent");else{var _e564=new ju(i.document).createDocumentFragment(i),_t373=s.data.htmlProcessor.domConverter.viewToDom(_e564),_n232=_t373.firstChild;for(;_n232.firstChild;)_t373.appendChild(_n232.firstChild);_n232.remove(),d=s.data.htmlProcessor.htmlWriter.getHtml(_t373);}o.writer.setAttribute("htmlContent",d,r);var _iterator569=_createForOfIteratorHelper(s.editing.view.createRangeIn(i)),_step569;try{for(_iterator569.s();!(_step569=_iterator569.n()).done;){var _e565=_step569.value.item;o.consumable.consume(_e565,{name:!0});}}catch(err){_iterator569.e(err);}finally{_iterator569.f();}return r;},converterPriority:"low"}),r["for"]("editingDowncast").elementToElement({model:{name:n.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:function view(e,_ref197){var t=_ref197.writer;var i=e.getAttribute("htmlElementName"),n=t.createRawElement(i);return e.hasAttribute("htmlCustomElementAttributes")&&Wx(t,e.getAttribute("htmlCustomElementAttributes"),n),n;}}),r["for"]("dataDowncast").elementToElement({model:{name:n.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:function view(e,_ref198){var t=_ref198.writer;var i=e.getAttribute("htmlElementName"),n=e.getAttribute("htmlContent"),s=t.createRawElement(i,null,function(e,t){t.setContentOf(e,n);});return e.hasAttribute("htmlCustomElementAttributes")&&Wx(t,e.getAttribute("htmlCustomElementAttributes"),s),s;}});});}}],[{key:"requires",get:function get(){return[sA,nA];}},{key:"pluginName",get:function get(){return"CustomElementSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var CA=/*#__PURE__*/function(_Dr125){function CA(){_classCallCheck(this,CA);return _callSuper(this,CA,arguments);}_inherits(CA,_Dr125);return _createClass(CA,[{key:"init",value:function init(){var e=this.editor,t=e.plugins.get(sA);t.loadAllowedEmptyElementsConfig(e.config.get("htmlSupport.allowEmpty")||[]),t.loadAllowedConfig(e.config.get("htmlSupport.allow")||[]),t.loadDisallowedConfig(e.config.get("htmlSupport.disallow")||[]);}},{key:"getGhsAttributeNameForElement",value:function getGhsAttributeNameForElement(e){var t=this.editor.plugins.get("DataSchema"),i=Array.from(t.getDefinitionsForView(e,!1)),n=i.find(function(e){return e.isInline&&!i[0].isObject;});return n?n.model:qx(e);}},{key:"addModelHtmlClass",value:function addModelHtmlClass(e,t,i){var n=this.editor.model,s=this.getGhsAttributeNameForElement(e);n.change(function(e){var _iterator570=_createForOfIteratorHelper(xA(n,i,s)),_step570;try{for(_iterator570.s();!(_step570=_iterator570.n()).done;){var _o86=_step570.value;jx(e,_o86,s,"classes",function(e){var _iterator571=_createForOfIteratorHelper(gr(t)),_step571;try{for(_iterator571.s();!(_step571=_iterator571.n()).done;){var _i419=_step571.value;e.add(_i419);}}catch(err){_iterator571.e(err);}finally{_iterator571.f();}});}}catch(err){_iterator570.e(err);}finally{_iterator570.f();}});}},{key:"removeModelHtmlClass",value:function removeModelHtmlClass(e,t,i){var n=this.editor.model,s=this.getGhsAttributeNameForElement(e);n.change(function(e){var _iterator572=_createForOfIteratorHelper(xA(n,i,s)),_step572;try{for(_iterator572.s();!(_step572=_iterator572.n()).done;){var _o87=_step572.value;jx(e,_o87,s,"classes",function(e){var _iterator573=_createForOfIteratorHelper(gr(t)),_step573;try{for(_iterator573.s();!(_step573=_iterator573.n()).done;){var _i420=_step573.value;e["delete"](_i420);}}catch(err){_iterator573.e(err);}finally{_iterator573.f();}});}}catch(err){_iterator572.e(err);}finally{_iterator572.f();}});}},{key:"setModelHtmlAttributes",value:function setModelHtmlAttributes(e,t,i){var n=this.editor.model,s=this.getGhsAttributeNameForElement(e);n.change(function(e){var _iterator574=_createForOfIteratorHelper(xA(n,i,s)),_step574;try{for(_iterator574.s();!(_step574=_iterator574.n()).done;){var _o88=_step574.value;jx(e,_o88,s,"attributes",function(e){for(var _i421=0,_Object$entries14=Object.entries(t);_i421<_Object$entries14.length;_i421++){var _Object$entries14$_i=_slicedToArray(_Object$entries14[_i421],2),_i422=_Object$entries14$_i[0],_n233=_Object$entries14$_i[1];e.set(_i422,_n233);}});}}catch(err){_iterator574.e(err);}finally{_iterator574.f();}});}},{key:"removeModelHtmlAttributes",value:function removeModelHtmlAttributes(e,t,i){var n=this.editor.model,s=this.getGhsAttributeNameForElement(e);n.change(function(e){var _iterator575=_createForOfIteratorHelper(xA(n,i,s)),_step575;try{for(_iterator575.s();!(_step575=_iterator575.n()).done;){var _o89=_step575.value;jx(e,_o89,s,"attributes",function(e){var _iterator576=_createForOfIteratorHelper(gr(t)),_step576;try{for(_iterator576.s();!(_step576=_iterator576.n()).done;){var _i423=_step576.value;e["delete"](_i423);}}catch(err){_iterator576.e(err);}finally{_iterator576.f();}});}}catch(err){_iterator575.e(err);}finally{_iterator575.f();}});}},{key:"setModelHtmlStyles",value:function setModelHtmlStyles(e,t,i){var n=this.editor.model,s=this.getGhsAttributeNameForElement(e);n.change(function(e){var _iterator577=_createForOfIteratorHelper(xA(n,i,s)),_step577;try{for(_iterator577.s();!(_step577=_iterator577.n()).done;){var _o90=_step577.value;jx(e,_o90,s,"styles",function(e){for(var _i424=0,_Object$entries15=Object.entries(t);_i424<_Object$entries15.length;_i424++){var _Object$entries15$_i=_slicedToArray(_Object$entries15[_i424],2),_i425=_Object$entries15$_i[0],_n234=_Object$entries15$_i[1];e.set(_i425,_n234);}});}}catch(err){_iterator577.e(err);}finally{_iterator577.f();}});}},{key:"removeModelHtmlStyles",value:function removeModelHtmlStyles(e,t,i){var n=this.editor.model,s=this.getGhsAttributeNameForElement(e);n.change(function(e){var _iterator578=_createForOfIteratorHelper(xA(n,i,s)),_step578;try{for(_iterator578.s();!(_step578=_iterator578.n()).done;){var _o91=_step578.value;jx(e,_o91,s,"styles",function(e){var _iterator579=_createForOfIteratorHelper(gr(t)),_step579;try{for(_iterator579.s();!(_step579=_iterator579.n()).done;){var _i426=_step579.value;e["delete"](_i426);}}catch(err){_iterator579.e(err);}finally{_iterator579.f();}});}}catch(err){_iterator578.e(err);}finally{_iterator578.f();}});}}],[{key:"pluginName",get:function get(){return"GeneralHtmlSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[sA,dA,uA,hA,gA,fA,pA,bA,wA,_A,kA];}}]);}(Dr);function xA(e,t,i){var _iterator580,_step580,_n235;return _regeneratorRuntime().wrap(function xA$(_context57){while(1)switch(_context57.prev=_context57.next){case 0:if(!t){_context57.next=24;break;}if(!(!(Symbol.iterator in t)&&t.is("documentSelection")&&t.isCollapsed)){_context57.next=8;break;}_context57.t0=e.schema.checkAttributeInSelection(t,i);if(!_context57.t0){_context57.next=6;break;}_context57.next=6;return t;case 6:_context57.next=24;break;case 8:_iterator580=_createForOfIteratorHelper(function(e,t,i){return!(Symbol.iterator in t)&&(t.is("node")||t.is("$text")||t.is("$textProxy"))?e.schema.checkAttribute(t,i)?[e.createRangeOn(t)]:[]:e.schema.getValidRanges(e.createSelection(t).getRanges(),i);}(e,t,i));_context57.prev=9;_iterator580.s();case 11:if((_step580=_iterator580.n()).done){_context57.next=16;break;}_n235=_step580.value;return _context57.delegateYield(_n235.getItems({shallow:!0}),"t1",14);case 14:_context57.next=11;break;case 16:_context57.next=21;break;case 18:_context57.prev=18;_context57.t2=_context57["catch"](9);_iterator580.e(_context57.t2);case 21:_context57.prev=21;_iterator580.f();return _context57.finish(21);case 24:case"end":return _context57.stop();}},_marked5,null,[[9,18,21,24]]);}var AA=/*#__PURE__*/function(_Dr126){function AA(){_classCallCheck(this,AA);return _callSuper(this,AA,arguments);}_inherits(AA,_Dr126);return _createClass(AA,[{key:"init",value:function init(){var _this578=this;var e=this.editor,t=new Map();e.data.processor.skipComments=!1,e.model.schema.addAttributeCheck(function(e,t){if(e.endsWith("$root")&&t.startsWith("$comment"))return!0;}),e.conversion["for"]("upcast").elementToMarker({view:"$comment",model:function model(e){var i="$comment:".concat(k()),n=e.getCustomProperty("$rawContent");return t.set(i,n),i;}}),e.conversion["for"]("dataDowncast").markerToElement({model:"$comment",view:function view(e,_ref199){var t=_ref199.writer;var i;var _iterator581=_createForOfIteratorHelper(_this578.editor.model.document.getRootNames()),_step581;try{for(_iterator581.s();!(_step581=_iterator581.n()).done;){var _t374=_step581.value;if(i=_this578.editor.model.document.getRoot(_t374),i.hasAttribute(e.markerName))break;}}catch(err){_iterator581.e(err);}finally{_iterator581.f();}var n=e.markerName,s=i.getAttribute(n),o=t.createUIElement("$comment");return t.setCustomProperty("$rawContent",s,o),o;}}),e.model.document.registerPostFixer(function(i){var n=!1;var s=e.model.document.differ.getChangedMarkers().filter(function(e){return e.name.startsWith("$comment:");});var _iterator582=_createForOfIteratorHelper(s),_step582;try{for(_iterator582.s();!(_step582=_iterator582.n()).done;){var _e566=_step582.value;var _e566$data=_e566.data,_s164=_e566$data.oldRange,_o92=_e566$data.newRange;if(!_s164||!_o92||_s164.root!=_o92.root){if(_s164){var _t375=_s164.root;_t375.hasAttribute(_e566.name)&&(i.removeAttribute(_e566.name,_t375),n=!0);}if(_o92){var _s165=_o92.root;"$graveyard"==_s165.rootName?(i.removeMarker(_e566.name),n=!0):_s165.hasAttribute(_e566.name)||(i.setAttribute(_e566.name,t.get(_e566.name)||"",_s165),n=!0);}}}}catch(err){_iterator582.e(err);}finally{_iterator582.f();}return n;}),e.data.on("set",function(){var _iterator583=_createForOfIteratorHelper(e.model.markers.getMarkersGroup("$comment")),_step583;try{for(_iterator583.s();!(_step583=_iterator583.n()).done;){var _t376=_step583.value;_this578.removeHtmlComment(_t376.name);}}catch(err){_iterator583.e(err);}finally{_iterator583.f();}},{priority:"high"}),e.model.on("deleteContent",function(t,_ref200){var _ref201=_slicedToArray(_ref200,1),i=_ref201[0];var _iterator584=_createForOfIteratorHelper(i.getRanges()),_step584;try{for(_iterator584.s();!(_step584=_iterator584.n()).done;){var _t377=_step584.value;var _i427=e.model.schema.getLimitElement(_t377),_n236=e.model.createPositionAt(_i427,0),_s166=e.model.createPositionAt(_i427,"end");var _o93=void 0;_o93=_n236.isTouching(_t377.start)&&_s166.isTouching(_t377.end)?_this578.getHtmlCommentsInRange(e.model.createRange(_n236,_s166)):_this578.getHtmlCommentsInRange(_t377,{skipBoundaries:!0});var _iterator585=_createForOfIteratorHelper(_o93),_step585;try{for(_iterator585.s();!(_step585=_iterator585.n()).done;){var _e567=_step585.value;_this578.removeHtmlComment(_e567);}}catch(err){_iterator585.e(err);}finally{_iterator585.f();}}}catch(err){_iterator584.e(err);}finally{_iterator584.f();}},{priority:"high"});}},{key:"createHtmlComment",value:function createHtmlComment(e,t){var i=k(),n=this.editor.model,s=n.document.getRoot(e.root.rootName),o="$comment:".concat(i);return n.change(function(i){var n=i.createRange(e);return i.addMarker(o,{usingOperation:!0,affectsData:!0,range:n}),i.setAttribute(o,t,s),o;});}},{key:"removeHtmlComment",value:function removeHtmlComment(e){var t=this.editor,i=t.model.markers.get(e);return!!i&&(t.model.change(function(e){e.removeMarker(i);}),!0);}},{key:"getHtmlCommentData",value:function getHtmlCommentData(e){var t=this.editor.model.markers.get(e);if(!t)return null;var i="";var _iterator586=_createForOfIteratorHelper(this.editor.model.document.getRoots()),_step586;try{for(_iterator586.s();!(_step586=_iterator586.n()).done;){var _t378=_step586.value;if(_t378.hasAttribute(e)){i=_t378.getAttribute(e);break;}}}catch(err){_iterator586.e(err);}finally{_iterator586.f();}return{content:i,position:t.getStart()};}},{key:"getHtmlCommentsInRange",value:function getHtmlCommentsInRange(e){var _ref202=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},_ref202$skipBoundarie=_ref202.skipBoundaries,t=_ref202$skipBoundarie===void 0?!1:_ref202$skipBoundarie;var i=!t;return Array.from(this.editor.model.markers.getMarkersGroup("$comment")).filter(function(t){return function(e,t){var n=e.getRange().start;return(n.isAfter(t.start)||i&&n.isEqual(t.start))&&(n.isBefore(t.end)||i&&n.isEqual(t.end));}(t,e);}).map(function(e){return e.name;});}}],[{key:"pluginName",get:function get(){return"HtmlComment";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var EA=/*#__PURE__*/function(_vd2){function EA(){_classCallCheck(this,EA);return _callSuper(this,EA,arguments);}_inherits(EA,_vd2);return _createClass(EA,[{key:"toView",value:function toView(e){if(!/<(?:html|body|head|meta)(?:\s[^>]*)?>/i.test(e.trim().slice(0,1e4)))return _superPropGet(EA,"toView",this,3)([e]);var t="",i="";e=(e=e.trim().replace(/<\?xml\s[^?]*\?>/i,function(e){return i=e,"";})).trim().replace(/^<!DOCTYPE\s[^>]*?>/i,function(e){return t=e,"";});var n=this._toDom(e),s=this.domConverter.domToView(n,{skipComments:this.skipComments}),o=new ju(s.document);return o.setCustomProperty("$fullPageDocument",n.ownerDocument.documentElement.outerHTML,s),t&&o.setCustomProperty("$fullPageDocType",t,s),i&&o.setCustomProperty("$fullPageXmlDeclaration",i,s),s;}},{key:"toData",value:function toData(e){var t=_superPropGet(EA,"toData",this,3)([e]);var i=e.getCustomProperty("$fullPageDocument"),n=e.getCustomProperty("$fullPageDocType"),s=e.getCustomProperty("$fullPageXmlDeclaration");return i&&(t=i.replace(/<\/body\s*>/,t+"$&"),n&&(t=n+"\n"+t),s&&(t=s+"\n"+t)),t;}}]);}(vd);var TA=/*#__PURE__*/function(_Dr127){function TA(){_classCallCheck(this,TA);return _callSuper(this,TA,arguments);}_inherits(TA,_Dr127);return _createClass(TA,[{key:"init",value:function init(){var e=this.editor,t=["$fullPageDocument","$fullPageDocType","$fullPageXmlDeclaration"];e.data.processor=new EA(e.data.viewDocument),e.model.schema.extend("$root",{allowAttributes:t}),e.data.on("toModel",function(i,_ref203){var _ref204=_slicedToArray(_ref203,1),n=_ref204[0];var s=e.model.document.getRoot();e.model.change(function(e){for(var _i428=0,_t379=t;_i428<_t379.length;_i428++){var _i429=_t379[_i428];var _t380=n.getCustomProperty(_i429);_t380&&e.setAttribute(_i429,_t380,s);}});},{priority:"low"}),e.data.on("toView",function(e,_ref205){var _ref206=_slicedToArray(_ref205,1),i=_ref206[0];if(!i.is("rootElement"))return;var n=i,s=e["return"];if(!n.hasAttribute("$fullPageDocument"))return;var o=new ju(s.document);for(var _i430=0,_t381=t;_i430<_t381.length;_i430++){var _e568=_t381[_i430];var _t382=n.getAttribute(_e568);_t382&&o.setCustomProperty(_e568,_t382,s);}},{priority:"low"}),e.data.on("set",function(){var i=e.model.document.getRoot();e.model.change(function(e){for(var _i431=0,_t383=t;_i431<_t383.length;_i431++){var _n237=_t383[_i431];i.hasAttribute(_n237)&&e.removeAttribute(_n237,i);}});},{priority:"high"}),e.data.on("get",function(e,t){t[0]||(t[0]={}),t[0].trim=!1;},{priority:"high"});}}],[{key:"pluginName",get:function get(){return"FullPage";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function PA(e){return e.createContainerElement("figure",{"class":"image"},[e.createEmptyElement("img"),e.createSlot("children")]);}function SA(e,t){var i=e.plugins.get("ImageUtils"),n=e.plugins.has("ImageInlineEditing")&&e.plugins.has("ImageBlockEditing");return function(e){if(!i.isInlineImageView(e))return null;if(!n)return s(e);return("block"==e.getStyle("display")||e.findAncestor(i.isBlockImageView)?"imageBlock":"imageInline")!==t?null:s(e);};function s(e){var t={name:!0};return e.hasAttribute("src")&&(t.attributes=["src"]),t;}}function IA(e,t){var i=wr(t.getSelectedBlocks());return!i||e.isObject(i)||i.isEmpty&&"listItem"!=i.name?"imageBlock":"imageInline";}function VA(e){return e&&e.endsWith("px")?parseInt(e):null;}function RA(e){var t=VA(e.getStyle("width")),i=VA(e.getStyle("height"));return!(!t||!i);}var OA=/^(image|image-inline)$/;var BA=/*#__PURE__*/function(_Dr128){function BA(){var _this579;_classCallCheck(this,BA);for(var _len72=arguments.length,args=new Array(_len72),_key72=0;_key72<_len72;_key72++){args[_key72]=arguments[_key72];}_this579=_callSuper(this,BA,[].concat(args));_defineProperty(_this579,"_domEmitter",new(go())());return _this579;}_inherits(BA,_Dr128);return _createClass(BA,[{key:"isImage",value:function isImage(e){return this.isInlineImage(e)||this.isBlockImage(e);}},{key:"isInlineImageView",value:function isInlineImageView(e){return!!e&&e.is("element","img");}},{key:"isBlockImageView",value:function isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image");}},{key:"insertImage",value:function insertImage(){var _this580=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var s=this.editor,o=s.model,r=o.document.selection,a=MA(s,t||r,i);e=_objectSpread(_objectSpread({},Object.fromEntries(r.getAttributes())),e);for(var _t384 in e)o.schema.checkAttribute(a,_t384)||delete e[_t384];return o.change(function(i){var _n$setImageSizes=n.setImageSizes,s=_n$setImageSizes===void 0?!0:_n$setImageSizes,r=i.createElement(a,e);return o.insertObject(r,t,null,{setSelection:"on",findOptimalPosition:t||"imageInline"==a?void 0:"auto"}),r.parent?(s&&_this580.setImageNaturalSizeAttributes(r),r):null;});}},{key:"setImageNaturalSizeAttributes",value:function setImageNaturalSizeAttributes(e){var _this581=this;var t=e.getAttribute("src");t&&(e.getAttribute("width")||e.getAttribute("height")||this.editor.model.change(function(n){var s=new i.window.Image();_this581._domEmitter.listenTo(s,"load",function(){e.getAttribute("width")||e.getAttribute("height")||_this581.editor.model.enqueueChange(n.batch,function(t){t.setAttribute("width",s.naturalWidth,e),t.setAttribute("height",s.naturalHeight,e);}),_this581._domEmitter.stopListening(s,"load");}),s.src=t;}));}},{key:"getClosestSelectedImageWidget",value:function getClosestSelectedImageWidget(e){var t=e.getFirstPosition();if(!t)return null;var i=e.getSelectedElement();if(i&&this.isImageWidget(i))return i;var n=t.parent;for(;n;){if(n.is("element")&&this.isImageWidget(n))return n;n=n.parent;}return null;}},{key:"getClosestSelectedImageElement",value:function getClosestSelectedImageElement(e){var t=e.getSelectedElement();return this.isImage(t)?t:e.getFirstPosition().findAncestor("imageBlock");}},{key:"getImageWidgetFromImageView",value:function getImageWidgetFromImageView(e){return e.findAncestor({classes:OA});}},{key:"isImageAllowed",value:function isImageAllowed(){var e=this.editor.model.document.selection;return function(e,t){var i=MA(e,t,null);if("imageBlock"==i){var _i432=function(e,t){var i=hy(e,t),n=i.start.parent;if(n.isEmpty&&!n.is("element","$root"))return n.parent;return n;}(t,e.model);if(e.model.schema.checkChild(_i432,"imageBlock"))return!0;}else if(e.model.schema.checkChild(t.focus,"imageInline"))return!0;return!1;}(this.editor,e)&&function(e){return _toConsumableArray(e.focus.getAncestors()).every(function(e){return!e.is("element","imageBlock");});}(e);}},{key:"toImageWidget",value:function toImageWidget(e,t,i){var _this582=this;t.setCustomProperty("image",!0,e);return oy(e,t,{label:function label(){var t=_this582.findViewImgElement(e).getAttribute("alt");return t?"".concat(t," ").concat(i):i;}});}},{key:"isImageWidget",value:function isImageWidget(e){return!!e.getCustomProperty("image")&&sy(e);}},{key:"isBlockImage",value:function isBlockImage(e){return!!e&&e.is("element","imageBlock");}},{key:"isInlineImage",value:function isInlineImage(e){return!!e&&e.is("element","imageInline");}},{key:"findViewImgElement",value:function findViewImgElement(e){if(this.isInlineImageView(e))return e;var t=this.editor.editing.view;var _iterator587=_createForOfIteratorHelper(t.createRangeIn(e)),_step587;try{for(_iterator587.s();!(_step587=_iterator587.n()).done;){var _i433=_step587.value.item;if(this.isInlineImageView(_i433))return _i433;}}catch(err){_iterator587.e(err);}finally{_iterator587.f();}}},{key:"destroy",value:function destroy(){return this._domEmitter.stopListening(),_superPropGet(BA,"destroy",this,3)([]);}}],[{key:"pluginName",get:function get(){return"ImageUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function MA(e,t,i){var n=e.model.schema,s=e.config.get("image.insert.type");return e.plugins.has("ImageBlockEditing")?e.plugins.has("ImageInlineEditing")?i||("inline"===s?"imageInline":"auto"!==s?"imageBlock":t.is("selection")?IA(n,t):n.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline";}var LA=new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source));var FA=/*#__PURE__*/function(_Dr129){function FA(e){var _this583;_classCallCheck(this,FA);_this583=_callSuper(this,FA,[e]),_defineProperty(_assertThisInitialized(_this583),"_timeoutId",void 0),_defineProperty(_assertThisInitialized(_this583),"_positionToInsert",void 0),_this583._timeoutId=null,_this583._positionToInsert=null;return _this583;}_inherits(FA,_Dr129);return _createClass(FA,[{key:"init",value:function init(){var _this584=this;var e=this.editor,t=e.model.document,n=e.plugins.get("ClipboardPipeline");this.listenTo(n,"inputTransformation",function(){var e=t.selection.getFirstRange(),i=su.fromPosition(e.start);i.stickiness="toPrevious";var n=su.fromPosition(e.end);n.stickiness="toNext",t.once("change:data",function(){_this584._embedImageBetweenPositions(i,n),i.detach(),n.detach();},{priority:"high"});}),e.commands.get("undo").on("execute",function(){_this584._timeoutId&&(i.window.clearTimeout(_this584._timeoutId),_this584._positionToInsert.detach(),_this584._timeoutId=null,_this584._positionToInsert=null);},{priority:"high"});}},{key:"_embedImageBetweenPositions",value:function _embedImageBetweenPositions(e,t){var _this585=this;var i=this.editor,n=new fc(e,t),s=n.getWalker({ignoreElementEnd:!0}),o=Object.fromEntries(i.model.document.selection.getAttributes()),r=this.editor.plugins.get("ImageUtils");var a="";var _iterator588=_createForOfIteratorHelper(s),_step588;try{for(_iterator588.s();!(_step588=_iterator588.n()).done;){var _e569=_step588.value;_e569.item.is("$textProxy")&&(a+=_e569.item.data);}}catch(err){_iterator588.e(err);}finally{_iterator588.f();}a=a.trim(),a.match(LA)?(this._positionToInsert=su.fromPosition(e),this._timeoutId=setTimeout(function(){if(!i.commands.get("insertImage").isEnabled)return void n.detach();i.model.change(function(e){var t;_this585._timeoutId=null,e.remove(n),n.detach(),"$graveyard"!==_this585._positionToInsert.root.rootName&&(t=_this585._positionToInsert.toPosition()),r.insertImage(_objectSpread(_objectSpread({},o),{},{src:a}),t),_this585._positionToInsert.detach(),_this585._positionToInsert=null;});i.plugins.get("Delete").requestUndoOnBackspace();},100)):n.detach();}}],[{key:"requires",get:function get(){return[Qy,BA,lC,Rw];}},{key:"pluginName",get:function get(){return"AutoImage";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var NA=/*#__PURE__*/function(_Hr28){function NA(){_classCallCheck(this,NA);return _callSuper(this,NA,arguments);}_inherits(NA,_Hr28);return _createClass(NA,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!e,this.isEnabled&&e.hasAttribute("alt")?this.value=e.getAttribute("alt"):this.value=!1;}},{key:"execute",value:function execute(e){var t=this.editor,i=t.plugins.get("ImageUtils"),n=t.model,s=i.getClosestSelectedImageElement(n.document.selection);n.change(function(t){t.setAttribute("alt",e.newValue,s);});}}]);}(Hr);var DA=/*#__PURE__*/function(_Dr130){function DA(){_classCallCheck(this,DA);return _callSuper(this,DA,arguments);}_inherits(DA,_Dr130);return _createClass(DA,[{key:"init",value:function init(){this.editor.commands.add("imageTextAlternative",new NA(this.editor));}}],[{key:"requires",get:function get(){return[BA];}},{key:"pluginName",get:function get(){return"ImageTextAlternativeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var zA=/*#__PURE__*/function(_lg56){function zA(e){var _this586;_classCallCheck(this,zA);_this586=_callSuper(this,zA,[e]);_defineProperty(_this586,"focusTracker",void 0);_defineProperty(_this586,"keystrokes",void 0);_defineProperty(_this586,"labeledInput",void 0);_defineProperty(_this586,"saveButtonView",void 0);_defineProperty(_this586,"cancelButtonView",void 0);_defineProperty(_this586,"_focusables",void 0);_defineProperty(_this586,"_focusCycler",void 0);var t=_this586.locale.t;_this586.focusTracker=new _r(),_this586.keystrokes=new Cr(),_this586.labeledInput=_this586._createLabeledInputView(),_this586.saveButtonView=_this586._createButton(t("Save"),vm.check,"ck-button-save"),_this586.saveButtonView.type="submit",_this586.cancelButtonView=_this586._createButton(t("Cancel"),vm.cancel,"ck-button-cancel","cancel"),_this586._focusables=new zm(),_this586._focusCycler=new _g({focusables:_this586._focusables,focusTracker:_this586.focusTracker,keystrokeHandler:_this586.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this586.setTemplate({tag:"form",attributes:{"class":["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[_this586.labeledInput,_this586.saveButtonView,_this586.cancelButtonView]});return _this586;}_inherits(zA,_lg56);return _createClass(zA,[{key:"render",value:function render(){var _this587=this;_superPropGet(zA,"render",this,3)([]),this.keystrokes.listenTo(this.element),hg({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(function(e){_this587._focusables.add(e),_this587.focusTracker.add(e.element);});}},{key:"destroy",value:function destroy(){_superPropGet(zA,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"_createButton",value:function _createButton(e,t,i,n){var s=new pg(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.extendTemplate({attributes:{"class":i}}),n&&s.delegate("execute").to(this,n),s;}},{key:"_createLabeledInputView",value:function _createLabeledInputView(){var e=this.locale.t,t=new pf(this.locale,cp);return t.label=e("Text alternative"),t;}}]);}(lg);function HA(e){var t=e.editing.view,i=Df.defaultPositions,n=e.plugins.get("ImageUtils");return{target:t.domConverter.mapViewToDom(n.getClosestSelectedImageWidget(t.document.selection)),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]};}var $A=/*#__PURE__*/function(_Dr131){function $A(){var _this588;_classCallCheck(this,$A);for(var _len73=arguments.length,args=new Array(_len73),_key73=0;_key73<_len73;_key73++){args[_key73]=arguments[_key73];}_this588=_callSuper(this,$A,[].concat(args));_defineProperty(_this588,"_balloon",void 0);_defineProperty(_this588,"_form",void 0);return _this588;}_inherits($A,_Dr131);return _createClass($A,[{key:"init",value:function init(){this._createButton();}},{key:"destroy",value:function destroy(){_superPropGet($A,"destroy",this,3)([]),this._form&&this._form.destroy();}},{key:"_createButton",value:function _createButton(){var _this589=this;var e=this.editor,t=e.t;e.ui.componentFactory.add("imageTextAlternative",function(i){var n=e.commands.get("imageTextAlternative"),s=new pg(i);return s.set({label:t("Change image text alternative"),icon:vm.textAlternative,tooltip:!0}),s.bind("isEnabled").to(n,"isEnabled"),s.bind("isOn").to(n,"value",function(e){return!!e;}),_this589.listenTo(s,"execute",function(){_this589._showForm();}),s;});}},{key:"_createForm",value:function _createForm(){var _this590=this;var e=this.editor,t=e.editing.view.document,i=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(ug(zA))(e.locale),this._form.render(),this.listenTo(this._form,"submit",function(){e.execute("imageTextAlternative",{newValue:_this590._form.labeledInput.fieldView.element.value}),_this590._hideForm(!0);}),this.listenTo(this._form,"cancel",function(){_this590._hideForm(!0);}),this._form.keystrokes.set("Esc",function(e,t){_this590._hideForm(!0),t();}),this.listenTo(e.ui,"update",function(){i.getClosestSelectedImageWidget(t.selection)?_this590._isVisible&&function(e){var t=e.plugins.get("ContextualBalloon");if(e.plugins.get("ImageUtils").getClosestSelectedImageWidget(e.editing.view.document.selection)){var _i434=HA(e);t.updatePosition(_i434);}}(e):_this590._hideForm(!0);}),cg({emitter:this._form,activator:function activator(){return _this590._isVisible;},contextElements:function contextElements(){return[_this590._balloon.view.element];},callback:function callback(){return _this590._hideForm();}});}},{key:"_showForm",value:function _showForm(){if(this._isVisible)return;this._form||this._createForm();var e=this.editor,t=e.commands.get("imageTextAlternative"),i=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:HA(e)}),i.fieldView.value=i.fieldView.element.value=t.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions();}},{key:"_hideForm",value:function _hideForm(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus());}},{key:"_isVisible",get:function get(){return!!this._balloon&&this._balloon.visibleView===this._form;}},{key:"_isInBalloon",get:function get(){return!!this._balloon&&this._balloon.hasView(this._form);}}],[{key:"requires",get:function get(){return[Db];}},{key:"pluginName",get:function get(){return"ImageTextAlternativeUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var UA=/*#__PURE__*/function(_Dr132){function UA(){_classCallCheck(this,UA);return _callSuper(this,UA,arguments);}_inherits(UA,_Dr132);return _createClass(UA,null,[{key:"requires",get:function get(){return[DA,$A];}},{key:"pluginName",get:function get(){return"ImageTextAlternative";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function WA(e,t){var i=function i(t,_i435,n){if(!n.consumable.consume(_i435.item,t.name))return;var s=n.writer,o=n.mapper.toViewElement(_i435.item),r=e.findViewImgElement(o);null===_i435.attributeNewValue?(s.removeAttribute("srcset",r),s.removeAttribute("sizes",r)):_i435.attributeNewValue&&(s.setAttribute("srcset",_i435.attributeNewValue,r),s.setAttribute("sizes","100vw",r));};return function(e){e.on("attribute:srcset:".concat(t),i);};}function jA(e,t,i){var n=function n(t,i,_n238){if(!_n238.consumable.consume(i.item,t.name))return;var s=_n238.writer,o=_n238.mapper.toViewElement(i.item),r=e.findViewImgElement(o);s.setAttribute(i.attributeKey,i.attributeNewValue||"",r);};return function(e){e.on("attribute:".concat(i,":").concat(t),n);};}var qA=/*#__PURE__*/function(_Al12){function qA(){_classCallCheck(this,qA);return _callSuper(this,qA,arguments);}_inherits(qA,_Al12);return _createClass(qA,[{key:"observe",value:function observe(e){var _this591=this;this.listenTo(e,"load",function(e,t){var i=t.target;_this591.checkShouldIgnoreEventFromTarget(i)||"IMG"==i.tagName&&_this591._fireEvents(t);},{useCapture:!0});}},{key:"stopObserving",value:function stopObserving(e){this.stopListening(e);}},{key:"_fireEvents",value:function _fireEvents(e){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",e));}}]);}(Al);var GA=/*#__PURE__*/function(_Hr29){function GA(e){var _this592;_classCallCheck(this,GA);_this592=_callSuper(this,GA,[e]);var t=e.config.get("image.insert.type");e.plugins.has("ImageBlockEditing")||"block"===t&&E("image-block-plugin-required"),e.plugins.has("ImageInlineEditing")||"inline"===t&&E("image-inline-plugin-required");return _this592;}_inherits(GA,_Hr29);return _createClass(GA,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("ImageUtils");this.isEnabled=e.isImageAllowed();}},{key:"execute",value:function execute(e){var _this593=this;var t=gr(e.source),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),s=Object.fromEntries(i.getAttributes());t.forEach(function(t,o){var r=i.getSelectedElement();if("string"==typeof t&&(t={src:t}),o&&r&&n.isImage(r)){var _i436=_this593.editor.model.createPositionAfter(r);n.insertImage(_objectSpread(_objectSpread({},t),s),_i436,e.imageType);}else n.insertImage(_objectSpread(_objectSpread({},t),s),null,e.imageType);});}}]);}(Hr);var KA=/*#__PURE__*/function(_Hr30){function KA(e){var _this594;_classCallCheck(this,KA);_this594=_callSuper(this,KA,[e]),_this594.decorate("cleanupImage");return _this594;}_inherits(KA,_Hr30);return _createClass(KA,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("ImageUtils"),t=this.editor.model.document.selection.getSelectedElement();this.isEnabled=e.isImage(t),this.value=this.isEnabled?t.getAttribute("src"):null;}},{key:"execute",value:function execute(e){var _this595=this;var t=this.editor.model.document.selection.getSelectedElement(),i=this.editor.plugins.get("ImageUtils");this.editor.model.change(function(n){n.setAttribute("src",e.source,t),_this595.cleanupImage(n,t),i.setImageNaturalSizeAttributes(t);});}},{key:"cleanupImage",value:function cleanupImage(e,t){e.removeAttribute("srcset",t),e.removeAttribute("sizes",t),e.removeAttribute("sources",t),e.removeAttribute("width",t),e.removeAttribute("height",t),e.removeAttribute("alt",t);}}]);}(Hr);var ZA=/*#__PURE__*/function(_Dr133){function ZA(){_classCallCheck(this,ZA);return _callSuper(this,ZA,arguments);}_inherits(ZA,_Dr133);return _createClass(ZA,[{key:"init",value:function init(){var e=this.editor,t=e.conversion;e.editing.view.addObserver(qA),t["for"]("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:"srcset"});var i=new GA(e),n=new KA(e);e.commands.add("insertImage",i),e.commands.add("replaceImageSource",n),e.commands.add("imageInsert",i);}}],[{key:"requires",get:function get(){return[BA];}},{key:"pluginName",get:function get(){return"ImageEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var JA=/*#__PURE__*/function(_Dr134){function JA(){_classCallCheck(this,JA);return _callSuper(this,JA,arguments);}_inherits(JA,_Dr134);return _createClass(JA,[{key:"afterInit",value:function afterInit(){this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline");}},{key:"_registerSchema",value:function _registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["width","height"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["width","height"]});}},{key:"_registerConverters",value:function _registerConverters(e){var t=this.editor,i=t.plugins.get("ImageUtils"),n="imageBlock"===e?"figure":"img";function s(t,n,s,o){t.on("attribute:".concat(n,":").concat(e),function(t,n,r){if(!r.consumable.consume(n.item,t.name))return;var a=r.writer,l=r.mapper.toViewElement(n.item),c=i.findViewImgElement(l);if(null!==n.attributeNewValue?a.setAttribute(s,n.attributeNewValue,c):a.removeAttribute(s,c),n.item.hasAttribute("sources"))return;var d=n.item.hasAttribute("resizedWidth");if("imageInline"===e&&!d&&!o)return;var u=n.item.getAttribute("width"),h=n.item.getAttribute("height");u&&h&&a.setStyle("aspect-ratio","".concat(u,"/").concat(h),c);});}t.conversion["for"]("upcast").attributeToAttribute({view:{name:n,styles:{width:/.+/}},model:{key:"width",value:function value(e){return RA(e)?VA(e.getStyle("width")):null;}}}).attributeToAttribute({view:{name:n,key:"width"},model:"width"}).attributeToAttribute({view:{name:n,styles:{height:/.+/}},model:{key:"height",value:function value(e){return RA(e)?VA(e.getStyle("height")):null;}}}).attributeToAttribute({view:{name:n,key:"height"},model:"height"}),t.conversion["for"]("editingDowncast").add(function(e){s(e,"width","width",!0),s(e,"height","height",!0);}),t.conversion["for"]("dataDowncast").add(function(e){s(e,"width","width",!1),s(e,"height","height",!1);});}}],[{key:"requires",get:function get(){return[BA];}},{key:"pluginName",get:function get(){return"ImageSizeAttributes";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var QA=/*#__PURE__*/function(_Hr31){function QA(e,t){var _this596;_classCallCheck(this,QA);_this596=_callSuper(this,QA,[e]),_defineProperty(_assertThisInitialized(_this596),"_modelElementName",void 0),_this596._modelElementName=t;return _this596;}_inherits(QA,_Hr31);return _createClass(QA,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("ImageUtils"),t=e.getClosestSelectedImageElement(this.editor.model.document.selection);"imageBlock"===this._modelElementName?this.isEnabled=e.isInlineImage(t):this.isEnabled=e.isBlockImage(t);}},{key:"execute",value:function execute(){var _this597=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor,i=this.editor.model,n=t.plugins.get("ImageUtils"),s=n.getClosestSelectedImageElement(i.document.selection),o=Object.fromEntries(s.getAttributes());return o.src||o.uploadId?i.change(function(t){var _e$setImageSizes=e.setImageSizes,r=_e$setImageSizes===void 0?!0:_e$setImageSizes,a=Array.from(i.markers).filter(function(e){return e.getRange().containsItem(s);}),l=n.insertImage(o,i.createSelection(s,"on"),_this597._modelElementName,{setImageSizes:r});if(!l)return null;var c=t.createRangeOn(l);var _iterator589=_createForOfIteratorHelper(a),_step589;try{for(_iterator589.s();!(_step589=_iterator589.n()).done;){var _e570=_step589.value;var _i437=_e570.getRange(),_n239="$graveyard"!=_i437.root.rootName?_i437.getJoined(c,!0):c;t.updateMarker(_e570,{range:_n239});}}catch(err){_iterator589.e(err);}finally{_iterator589.f();}return{oldElement:s,newElement:l};}):null;}}]);}(Hr);var YA=/*#__PURE__*/function(_Dr135){function YA(){_classCallCheck(this,YA);return _callSuper(this,YA,arguments);}_inherits(YA,_Dr135);return _createClass(YA,[{key:"afterInit",value:function afterInit(){this._setupSchema(),this._setupConversion(),this._setupLoadListener();}},{key:"_setupSchema",value:function _setupSchema(){var e=this.editor.model.schema;e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["placeholder"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["placeholder"]});}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.conversion,i=e.plugins.get("ImageUtils");t["for"]("editingDowncast").add(function(e){e.on("attribute:placeholder",function(e,t,n){if(!n.consumable.test(t.item,e.name))return;if(!t.item.is("element","imageBlock")&&!t.item.is("element","imageInline"))return;n.consumable.consume(t.item,e.name);var s=n.writer,o=n.mapper.toViewElement(t.item),r=i.findViewImgElement(o);t.attributeNewValue?(s.addClass("image_placeholder",r),s.setStyle("background-image","url(".concat(t.attributeNewValue,")"),r),s.setCustomProperty("editingPipeline:doNotReuseOnce",!0,r)):(s.removeClass("image_placeholder",r),s.removeStyle("background-image",r));});});}},{key:"_setupLoadListener",value:function _setupLoadListener(){var e=this.editor,t=e.model,i=e.editing,n=i.view,s=e.plugins.get("ImageUtils");n.addObserver(qA),this.listenTo(n.document,"imageLoaded",function(e,o){var r=n.domConverter.mapDomToView(o.target);if(!r)return;var a=s.getImageWidgetFromImageView(r);if(!a)return;var l=i.mapper.toModelElement(a);l&&l.hasAttribute("placeholder")&&t.enqueueChange({isUndoable:!1},function(e){e.removeAttribute("placeholder",l);});});}}],[{key:"requires",get:function get(){return[BA];}},{key:"pluginName",get:function get(){return"ImagePlaceholder";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var XA=/*#__PURE__*/function(_Dr136){function XA(){_classCallCheck(this,XA);return _callSuper(this,XA,arguments);}_inherits(XA,_Dr136);return _createClass(XA,[{key:"init",value:function init(){var e=this.editor;e.model.schema.register("imageBlock",{inheritAllFrom:"$blockObject",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),e.plugins.has("ImageInlineEditing")&&(e.commands.add("imageTypeBlock",new QA(this.editor,"imageBlock")),this._setupClipboardIntegration());}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.t,i=e.conversion,n=e.plugins.get("ImageUtils");i["for"]("dataDowncast").elementToStructure({model:"imageBlock",view:function view(e,_ref207){var t=_ref207.writer;return PA(t);}}),i["for"]("editingDowncast").elementToStructure({model:"imageBlock",view:function view(e,_ref208){var i=_ref208.writer;return n.toImageWidget(PA(i),i,t("image widget"));}}),i["for"]("downcast").add(jA(n,"imageBlock","src")).add(jA(n,"imageBlock","alt")).add(WA(n,"imageBlock")),i["for"]("upcast").elementToElement({view:SA(e,"imageBlock"),model:function model(e,_ref209){var t=_ref209.writer;return t.createElement("imageBlock",e.hasAttribute("src")?{src:e.getAttribute("src")}:void 0);}}).add(function(e){var t=function t(_t385,i,n){if(!n.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;var s=e.findViewImgElement(i.viewItem);if(!s||!n.consumable.test(s,{name:!0}))return;n.consumable.consume(i.viewItem,{name:!0,classes:"image"});var o=wr(n.convertItem(s,i.modelCursor).modelRange.getItems());o?(n.convertChildren(i.viewItem,o),n.updateConversionResult(o,i)):n.consumable.revert(i.viewItem,{name:!0,classes:"image"});};return function(e){e.on("element:figure",t);};}(n));}},{key:"_setupClipboardIntegration",value:function _setupClipboardIntegration(){var e=this.editor,t=e.model,i=e.editing.view,n=e.plugins.get("ImageUtils"),s=e.plugins.get("ClipboardPipeline");this.listenTo(s,"inputTransformation",function(s,o){var r=Array.from(o.content.getChildren());var a;if(!r.every(n.isInlineImageView))return;a=o.targetRanges?e.editing.mapper.toModelRange(o.targetRanges[0]):t.document.selection.getFirstRange();var l=t.createSelection(a);if("imageBlock"===IA(t.schema,l)){var _e571=new ju(i.document),_t386=r.map(function(t){return _e571.createElement("figure",{"class":"image"},t);});o.content=_e571.createDocumentFragment(_t386);}}),this.listenTo(s,"contentInsertion",function(e,i){"paste"===i.method&&t.change(function(e){var t=e.createRangeIn(i.content);var _iterator590=_createForOfIteratorHelper(t.getItems()),_step590;try{for(_iterator590.s();!(_step590=_iterator590.n()).done;){var _e572=_step590.value;_e572.is("element","imageBlock")&&n.setImageNaturalSizeAttributes(_e572);}}catch(err){_iterator590.e(err);}finally{_iterator590.f();}});});}}],[{key:"requires",get:function get(){return[ZA,JA,BA,YA,Jv];}},{key:"pluginName",get:function get(){return"ImageBlockEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var eE=/*#__PURE__*/function(_lg57){function eE(e){var _this598;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];_classCallCheck(this,eE);_this598=_callSuper(this,eE,[e]),_defineProperty(_assertThisInitialized(_this598),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this598),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this598),"_focusables",void 0),_defineProperty(_assertThisInitialized(_this598),"_focusCycler",void 0),_defineProperty(_assertThisInitialized(_this598),"children",void 0),_this598.focusTracker=new _r(),_this598.keystrokes=new Cr(),_this598._focusables=new zm(),_this598.children=_this598.createCollection(),_this598._focusCycler=new _g({focusables:_this598._focusables,focusTracker:_this598.focusTracker,keystrokeHandler:_this598.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});var _iterator591=_createForOfIteratorHelper(t),_step591;try{for(_iterator591.s();!(_step591=_iterator591.n()).done;){var _e573=_step591.value;_this598.children.add(_e573),_this598._focusables.add(_e573),_e573 instanceof jg&&_this598._focusables.addMany(_e573.children);}}catch(err){_iterator591.e(err);}finally{_iterator591.f();}_this598.setTemplate({tag:"form",attributes:{"class":["ck","ck-image-insert-form"],tabindex:-1},children:_this598.children});return _this598;}_inherits(eE,_lg57);return _createClass(eE,[{key:"render",value:function render(){_superPropGet(eE,"render",this,3)([]),hg({view:this});var _iterator592=_createForOfIteratorHelper(this._focusables),_step592;try{for(_iterator592.s();!(_step592=_iterator592.n()).done;){var _e575=_step592.value;this.focusTracker.add(_e575.element);}}catch(err){_iterator592.e(err);}finally{_iterator592.f();}this.keystrokes.listenTo(this.element);var e=function(_e574){function e(_x23){return _e574.apply(this,arguments);}e.toString=function(){return _e574.toString();};return e;}(function(e){return e.stopPropagation();});this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e);}},{key:"destroy",value:function destroy(){_superPropGet(eE,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}}]);}(lg);var tE=/*#__PURE__*/function(_Dr137){function tE(e){var _this599;_classCallCheck(this,tE);_this599=_callSuper(this,tE,[e]),_defineProperty(_assertThisInitialized(_this599),"dropdownView",void 0),_defineProperty(_assertThisInitialized(_this599),"_integrations",new Map()),e.config.define("image.insert.integrations",["upload","assetManager","url"]);return _this599;}_inherits(tE,_Dr137);return _createClass(tE,[{key:"init",value:function init(){var _this600=this;var e=this.editor,t=e.model.document.selection,i=e.plugins.get("ImageUtils");this.set("isImageSelected",!1),this.listenTo(e.model.document,"change",function(){_this600.isImageSelected=i.isImage(t.getSelectedElement());});var n=function n(e){return _this600._createToolbarComponent(e);};e.ui.componentFactory.add("insertImage",n),e.ui.componentFactory.add("imageInsert",n),e.ui.componentFactory.add("menuBar:insertImage",function(e){return _this600._createMenuBarComponent(e);});}},{key:"registerIntegration",value:function registerIntegration(_ref210){var e=_ref210.name,t=_ref210.observable,i=_ref210.buttonViewCreator,n=_ref210.formViewCreator,s=_ref210.menuBarButtonViewCreator,_ref210$requiresForm=_ref210.requiresForm,o=_ref210$requiresForm===void 0?!1:_ref210$requiresForm;this._integrations.has(e)&&E("image-insert-integration-exists",{name:e}),this._integrations.set(e,{observable:t,buttonViewCreator:i,menuBarButtonViewCreator:s,formViewCreator:n,requiresForm:o});}},{key:"_createToolbarComponent",value:function _createToolbarComponent(e){var t=this.editor,i=e.t,n=this._prepareIntegrations();if(!n.length)return null;var s;var o=n[0];if(1==n.length){if(!o.requiresForm)return o.buttonViewCreator(!0);s=o.buttonViewCreator(!0);}else{var _t387=o.buttonViewCreator(!1);s=new Yf(e,_t387),s.tooltip=!0,s.bind("label").to(this,"isImageSelected",function(e){return i(e?"Replace image":"Insert image");});}var r=this.dropdownView=Xf(e,s),a=n.map(function(_ref211){var e=_ref211.observable;return"function"==typeof e?e():e;});return r.bind("isEnabled").toMany(a,"isEnabled",function(){for(var _len74=arguments.length,e=new Array(_len74),_key74=0;_key74<_len74;_key74++){e[_key74]=arguments[_key74];}return e.some(function(e){return e;});}),r.once("change:isOpen",function(){var e=n.map(function(_ref212){var e=_ref212.formViewCreator;return e(1==n.length);}),i=new eE(t.locale,e);r.panelView.children.add(i);}),r;}},{key:"_createMenuBarComponent",value:function _createMenuBarComponent(e){var t=e.t,i=this._prepareIntegrations();if(!i.length)return null;var n;var s=i[0];if(1==i.length)n=s.menuBarButtonViewCreator(!0);else{n=new aw(e);var _s167=new lw(e);n.panelView.children.add(_s167),n.buttonView.set({icon:vm.image,label:t("Image")});var _iterator593=_createForOfIteratorHelper(i),_step593;try{for(_iterator593.s();!(_step593=_iterator593.n()).done;){var _t388=_step593.value;var _i438=new ub(e,n),_o94=_t388.menuBarButtonViewCreator(!1);_i438.children.add(_o94),_s167.items.add(_i438);}}catch(err){_iterator593.e(err);}finally{_iterator593.f();}}return n;}},{key:"_prepareIntegrations",value:function _prepareIntegrations(){var e=this.editor.config.get("image.insert.integrations"),t=[];if(!e.length)return E("image-insert-integrations-not-specified"),t;var _iterator594=_createForOfIteratorHelper(e),_step594;try{for(_iterator594.s();!(_step594=_iterator594.n()).done;){var _i439=_step594.value;this._integrations.has(_i439)?t.push(this._integrations.get(_i439)):["upload","assetManager","url"].includes(_i439)||E("image-insert-unknown-integration",{item:_i439});}}catch(err){_iterator594.e(err);}finally{_iterator594.f();}return t.length||E("image-insert-integrations-not-registered"),t;}}],[{key:"pluginName",get:function get(){return"ImageInsertUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[BA];}}]);}(Dr);var iE=/*#__PURE__*/function(_Dr138){function iE(){_classCallCheck(this,iE);return _callSuper(this,iE,arguments);}_inherits(iE,_Dr138);return _createClass(iE,null,[{key:"requires",get:function get(){return[XA,Ty,UA,tE];}},{key:"pluginName",get:function get(){return"ImageBlock";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var nE=/*#__PURE__*/function(_Dr139){function nE(){_classCallCheck(this,nE);return _callSuper(this,nE,arguments);}_inherits(nE,_Dr139);return _createClass(nE,[{key:"init",value:function init(){var e=this.editor;e.model.schema.register("imageInline",{inheritAllFrom:"$inlineObject",allowAttributes:["alt","src","srcset"],disallowIn:["caption"]}),this._setupConversion(),e.plugins.has("ImageBlockEditing")&&(e.commands.add("imageTypeInline",new QA(this.editor,"imageInline")),this._setupClipboardIntegration());}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.t,i=e.conversion,n=e.plugins.get("ImageUtils");i["for"]("dataDowncast").elementToElement({model:"imageInline",view:function view(e,_ref213){var t=_ref213.writer;return t.createEmptyElement("img");}}),i["for"]("editingDowncast").elementToStructure({model:"imageInline",view:function view(e,_ref214){var i=_ref214.writer;return n.toImageWidget(function(e){return e.createContainerElement("span",{"class":"image-inline"},e.createEmptyElement("img"));}(i),i,t("image widget"));}}),i["for"]("downcast").add(jA(n,"imageInline","src")).add(jA(n,"imageInline","alt")).add(WA(n,"imageInline")),i["for"]("upcast").elementToElement({view:SA(e,"imageInline"),model:function model(e,_ref215){var t=_ref215.writer;return t.createElement("imageInline",e.hasAttribute("src")?{src:e.getAttribute("src")}:void 0);}});}},{key:"_setupClipboardIntegration",value:function _setupClipboardIntegration(){var e=this.editor,t=e.model,i=e.editing.view,n=e.plugins.get("ImageUtils"),s=e.plugins.get("ClipboardPipeline");this.listenTo(s,"inputTransformation",function(s,o){var r=Array.from(o.content.getChildren());var a;if(!r.every(n.isBlockImageView))return;a=o.targetRanges?e.editing.mapper.toModelRange(o.targetRanges[0]):t.document.selection.getFirstRange();var l=t.createSelection(a);if("imageInline"===IA(t.schema,l)){var _e576=new ju(i.document),_t389=r.map(function(t){return 1===t.childCount?(Array.from(t.getAttributes()).forEach(function(i){return _e576.setAttribute.apply(_e576,_toConsumableArray(i).concat([n.findViewImgElement(t)]));}),t.getChild(0)):t;});o.content=_e576.createDocumentFragment(_t389);}}),this.listenTo(s,"contentInsertion",function(e,i){"paste"===i.method&&t.change(function(e){var t=e.createRangeIn(i.content);var _iterator595=_createForOfIteratorHelper(t.getItems()),_step595;try{for(_iterator595.s();!(_step595=_iterator595.n()).done;){var _e577=_step595.value;_e577.is("element","imageInline")&&n.setImageNaturalSizeAttributes(_e577);}}catch(err){_iterator595.e(err);}finally{_iterator595.f();}});});}}],[{key:"requires",get:function get(){return[ZA,JA,BA,YA,Jv];}},{key:"pluginName",get:function get(){return"ImageInlineEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var sE=/*#__PURE__*/function(_Dr140){function sE(){_classCallCheck(this,sE);return _callSuper(this,sE,arguments);}_inherits(sE,_Dr140);return _createClass(sE,null,[{key:"requires",get:function get(){return[nE,Ty,UA,tE];}},{key:"pluginName",get:function get(){return"ImageInline";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var oE=/*#__PURE__*/function(_Dr141){function oE(){_classCallCheck(this,oE);return _callSuper(this,oE,arguments);}_inherits(oE,_Dr141);return _createClass(oE,null,[{key:"requires",get:function get(){return[iE,sE];}},{key:"pluginName",get:function get(){return"Image";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var rE=/*#__PURE__*/function(_Dr142){function rE(){_classCallCheck(this,rE);return _callSuper(this,rE,arguments);}_inherits(rE,_Dr142);return _createClass(rE,[{key:"getCaptionFromImageModelElement",value:function getCaptionFromImageModelElement(e){var _iterator596=_createForOfIteratorHelper(e.getChildren()),_step596;try{for(_iterator596.s();!(_step596=_iterator596.n()).done;){var _t390=_step596.value;if(_t390&&_t390.is("element","caption"))return _t390;}}catch(err){_iterator596.e(err);}finally{_iterator596.f();}return null;}},{key:"getCaptionFromModelSelection",value:function getCaptionFromModelSelection(e){var t=this.editor.plugins.get("ImageUtils"),i=e.getFirstPosition().findAncestor("caption");return i&&t.isBlockImage(i.parent)?i:null;}},{key:"matchImageCaptionViewElement",value:function matchImageCaptionViewElement(e){var t=this.editor.plugins.get("ImageUtils");return"figcaption"==e.name&&t.isBlockImageView(e.parent)?{name:!0}:null;}}],[{key:"pluginName",get:function get(){return"ImageCaptionUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[BA];}}]);}(Dr);var aE=/*#__PURE__*/function(_Hr32){function aE(){_classCallCheck(this,aE);return _callSuper(this,aE,arguments);}_inherits(aE,_Hr32);return _createClass(aE,[{key:"refresh",value:function refresh(){var e=this.editor,t=e.plugins.get("ImageCaptionUtils"),i=e.plugins.get("ImageUtils");if(!e.plugins.has(XA))return this.isEnabled=!1,void(this.value=!1);var n=e.model.document.selection,s=n.getSelectedElement();if(!s){var _e578=t.getCaptionFromModelSelection(n);return this.isEnabled=!!_e578,void(this.value=!!_e578);}this.isEnabled=i.isImage(s),this.isEnabled?this.value=!!t.getCaptionFromImageModelElement(s):this.value=!1;}},{key:"execute",value:function execute(){var _this601=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=e.focusCaptionOnShow;this.editor.model.change(function(e){_this601.value?_this601._hideImageCaption(e):_this601._showImageCaption(e,t);});}},{key:"_showImageCaption",value:function _showImageCaption(e,t){var i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageCaptionEditing"),s=this.editor.plugins.get("ImageUtils");var o=i.getSelectedElement();var r=n._getSavedCaption(o);s.isInlineImage(o)&&(this.editor.execute("imageTypeBlock"),o=i.getSelectedElement());var a=r||e.createElement("caption");e.append(a,o),t&&e.setSelection(a,"in");}},{key:"_hideImageCaption",value:function _hideImageCaption(e){var t=this.editor,i=t.model.document.selection,n=t.plugins.get("ImageCaptionEditing"),s=t.plugins.get("ImageCaptionUtils");var o,r=i.getSelectedElement();r?o=s.getCaptionFromImageModelElement(r):(o=s.getCaptionFromModelSelection(i),r=o.parent),n._saveCaption(r,o),e.setSelection(r,"on"),e.remove(o);}}]);}(Hr);var lE=/*#__PURE__*/function(_Dr143){function lE(e){var _this602;_classCallCheck(this,lE);_this602=_callSuper(this,lE,[e]),_defineProperty(_assertThisInitialized(_this602),"_savedCaptionsMap",void 0),_this602._savedCaptionsMap=new WeakMap();return _this602;}_inherits(lE,_Dr143);return _createClass(lE,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema;t.isRegistered("caption")?t.extend("caption",{allowIn:"imageBlock"}):t.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new aE(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration(),this._registerCaptionReconversion();}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils"),n=e.plugins.get("ImageCaptionUtils"),s=e.t;e.conversion["for"]("upcast").elementToElement({view:function view(e){return n.matchImageCaptionViewElement(e);},model:"caption"}),e.conversion["for"]("dataDowncast").elementToElement({model:"caption",view:function view(e,_ref216){var t=_ref216.writer;return i.isBlockImage(e.parent)?t.createContainerElement("figcaption"):null;}}),e.conversion["for"]("editingDowncast").elementToElement({model:"caption",view:function view(e,_ref217){var n=_ref217.writer;if(!i.isBlockImage(e.parent))return null;var o=n.createEditableElement("figcaption");n.setCustomProperty("imageCaption",!0,o),o.placeholder=s("Enter image caption"),Zr({view:t,element:o,keepOnFocus:!0});var r=e.parent.getAttribute("alt");return uy(o,n,{label:r?s("Caption for image: %0",[r]):s("Caption for the image")});}});}},{key:"_setupImageTypeCommandsIntegration",value:function _setupImageTypeCommandsIntegration(){var _this603=this;var e=this.editor,t=e.plugins.get("ImageUtils"),i=e.plugins.get("ImageCaptionUtils"),n=e.commands.get("imageTypeInline"),s=e.commands.get("imageTypeBlock"),o=function o(e){if(!e["return"])return;var _e$return=e["return"],n=_e$return.oldElement,s=_e$return.newElement;if(!n)return;if(t.isBlockImage(n)){var _e579=i.getCaptionFromImageModelElement(n);if(_e579)return void _this603._saveCaption(s,_e579);}var o=_this603._getSavedCaption(n);o&&_this603._saveCaption(s,o);};n&&this.listenTo(n,"execute",o,{priority:"low"}),s&&this.listenTo(s,"execute",o,{priority:"low"});}},{key:"_getSavedCaption",value:function _getSavedCaption(e){var t=this._savedCaptionsMap.get(e);return t?ql.fromJSON(t):null;}},{key:"_saveCaption",value:function _saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON());}},{key:"_registerCaptionReconversion",value:function _registerCaptionReconversion(){var e=this.editor,t=e.model,i=e.plugins.get("ImageUtils"),n=e.plugins.get("ImageCaptionUtils");t.document.on("change:data",function(){var s=t.document.differ.getChanges();var _iterator597=_createForOfIteratorHelper(s),_step597;try{for(_iterator597.s();!(_step597=_iterator597.n()).done;){var _t391=_step597.value;if("alt"!==_t391.attributeKey)continue;var _s168=_t391.range.start.nodeAfter;if(i.isBlockImage(_s168)){var _t392=n.getCaptionFromImageModelElement(_s168);if(!_t392)return;e.editing.reconvertItem(_t392);}}}catch(err){_iterator597.e(err);}finally{_iterator597.f();}});}}],[{key:"requires",get:function get(){return[BA,rE];}},{key:"pluginName",get:function get(){return"ImageCaptionEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var cE=/*#__PURE__*/function(_Dr144){function cE(){_classCallCheck(this,cE);return _callSuper(this,cE,arguments);}_inherits(cE,_Dr144);return _createClass(cE,[{key:"init",value:function init(){var _this604=this;var e=this.editor,t=e.editing.view,i=e.plugins.get("ImageCaptionUtils"),n=e.t;e.ui.componentFactory.add("toggleImageCaption",function(s){var o=e.commands.get("toggleImageCaption"),r=new pg(s);return r.set({icon:vm.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.bind("label").to(o,"value",function(e){return n(e?"Toggle caption off":"Toggle caption on");}),_this604.listenTo(r,"execute",function(){e.execute("toggleImageCaption",{focusCaptionOnShow:!0});var n=i.getCaptionFromModelSelection(e.model.document.selection);if(n){var _i440=e.editing.mapper.toViewElement(n);t.scrollToTheSelection(),t.change(function(e){e.addClass("image__caption_highlighted",_i440);});}e.editing.view.focus();}),r;});}}],[{key:"requires",get:function get(){return[rE];}},{key:"pluginName",get:function get(){return"ImageCaptionUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var dE=/*#__PURE__*/function(_Dr145){function dE(){_classCallCheck(this,dE);return _callSuper(this,dE,arguments);}_inherits(dE,_Dr145);return _createClass(dE,null,[{key:"requires",get:function get(){return[lE,cE];}},{key:"pluginName",get:function get(){return"ImageCaption";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function uE(e){var t=e.map(function(e){return e.replace("+","\\+");});return new RegExp("^image\\/(".concat(t.join("|"),")$"));}function hE(e){return new Promise(function(t,n){var s=e.getAttribute("src");fetch(s).then(function(e){return e.blob();}).then(function(e){var i=mE(e,s),n=i.replace("image/",""),o=new File([e],"image.".concat(n),{type:i});t(o);})["catch"](function(e){return e&&"TypeError"===e.name?function(e){return function(e){return new Promise(function(t,n){var s=i.document.createElement("img");s.addEventListener("load",function(){var e=i.document.createElement("canvas");e.width=s.width,e.height=s.height;e.getContext("2d").drawImage(s,0,0),e.toBlob(function(e){return e?t(e):n();});}),s.addEventListener("error",function(){return n();}),s.src=e;});}(e).then(function(t){var i=mE(t,e),n=i.replace("image/","");return new File([t],"image.".concat(n),{type:i});});}(s).then(t)["catch"](n):n(e);});});}function mE(e,t){return e.type?e.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg";}var gE=/*#__PURE__*/function(_Dr146){function gE(){_classCallCheck(this,gE);return _callSuper(this,gE,arguments);}_inherits(gE,_Dr146);return _createClass(gE,[{key:"init",value:function init(){var _this605=this;var e=this.editor;e.ui.componentFactory.add("uploadImage",function(){return _this605._createToolbarButton();}),e.ui.componentFactory.add("imageUpload",function(){return _this605._createToolbarButton();}),e.ui.componentFactory.add("menuBar:uploadImage",function(){return _this605._createMenuBarButton("standalone");}),e.plugins.has("ImageInsertUI")&&e.plugins.get("ImageInsertUI").registerIntegration({name:"upload",observable:function observable(){return e.commands.get("uploadImage");},buttonViewCreator:function buttonViewCreator(){return _this605._createToolbarButton();},formViewCreator:function formViewCreator(){return _this605._createDropdownButton();},menuBarButtonViewCreator:function menuBarButtonViewCreator(e){return _this605._createMenuBarButton(e?"insertOnly":"insertNested");}});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get("uploadImage"),s=t.config.get("image.upload.types"),o=uE(s),r=new e(t.locale),a=i.t;return r.set({acceptedType:s.map(function(e){return"image/".concat(e);}).join(","),allowMultipleFiles:!0,label:a("Upload from computer"),icon:vm.imageUpload}),r.bind("isEnabled").to(n),r.on("done",function(e,i){var n=Array.from(i).filter(function(e){return o.test(e.type);});n.length&&(t.execute("uploadImage",{file:n}),t.editing.view.focus());}),r;}},{key:"_createToolbarButton",value:function _createToolbarButton(){var e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),i=this.editor.commands.get("uploadImage"),n=this._createButton(zg);return n.tooltip=!0,n.bind("label").to(t,"isImageSelected",i,"isAccessAllowed",function(t,i){return e(i?t?"Replace image from computer":"Upload image from computer":"You have no image upload permissions.");}),n;}},{key:"_createDropdownButton",value:function _createDropdownButton(){var e=this.editor.locale.t,t=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(zg);return i.withText=!0,i.bind("label").to(t,"isImageSelected",function(t){return e(t?"Replace from computer":"Upload from computer");}),i.on("execute",function(){t.dropdownView.isOpen=!1;}),i;}},{key:"_createMenuBarButton",value:function _createMenuBarButton(e){var t=this.editor.locale.t,i=this._createButton(dw);switch(i.withText=!0,e){case"standalone":i.label=t("Image from computer");break;case"insertOnly":i.label=t("Image");break;case"insertNested":i.label=t("From computer");}return i;}}],[{key:"pluginName",get:function get(){return"ImageUploadUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var fE=/*#__PURE__*/function(_Dr147){function fE(_e580){var _this606;_classCallCheck(this,fE);_this606=_callSuper(this,fE,[_e580]),_defineProperty(_assertThisInitialized(_this606),"placeholder",void 0),_defineProperty(_assertThisInitialized(_this606),"uploadStatusChange",function(e,t,i){var n=_this606.editor,s=t.item,o=s.getAttribute("uploadId");if(!i.consumable.consume(t.item,e.name))return;var r=n.plugins.get("ImageUtils"),a=n.plugins.get(km),l=o?t.attributeNewValue:null,c=_this606.placeholder,d=n.editing.mapper.toViewElement(s),u=i.writer;if("reading"==l)return pE(d,u),void bE(r,c,d,u);if("uploading"==l){var _e581=a.loaders.get(o);return pE(d,u),void(_e581?(wE(d,u),function(e,t,i,n){var s=function(e){var t=e.createUIElement("div",{"class":"ck-progress-bar"});return e.setCustomProperty("progressBar",!0,t),t;}(t);t.insert(t.createPositionAt(e,"end"),s),i.on("change:uploadedPercent",function(e,t,i){n.change(function(e){e.setStyle("width",i+"%",s);});});}(d,u,_e581,n.editing.view),function(e,t,i,n){if(n.data){var _s169=e.findViewImgElement(t);i.setAttribute("src",n.data,_s169);}}(r,d,u,_e581)):bE(r,c,d,u));}"complete"==l&&a.loaders.get(o)&&function(e,t,i){var n=t.createUIElement("div",{"class":"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(e,"end"),n),setTimeout(function(){i.change(function(e){return e.remove(e.createRangeOn(n));});},3e3);}(d,u,n.editing.view),function(e,t){vE(e,t,"progressBar");}(d,u),wE(d,u),function(e,t){t.removeClass("ck-appear",e);}(d,u);}),_this606.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";return _this606;}_inherits(fE,_Dr147);return _createClass(fE,[{key:"init",value:function init(){var e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",this.uploadStatusChange),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",this.uploadStatusChange);}}],[{key:"pluginName",get:function get(){return"ImageUploadProgress";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function pE(e,t){e.hasClass("ck-appear")||t.addClass("ck-appear",e);}function bE(e,t,i,n){i.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",i);var s=e.findViewImgElement(i);s.getAttribute("src")!==t&&n.setAttribute("src",t,s),_E(i,"placeholder")||n.insert(n.createPositionAfter(s),function(e){var t=e.createUIElement("div",{"class":"ck-upload-placeholder-loader"});return e.setCustomProperty("placeholder",!0,t),t;}(n));}function wE(e,t){e.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",e),vE(e,t,"placeholder");}function _E(e,t){var _iterator598=_createForOfIteratorHelper(e.getChildren()),_step598;try{for(_iterator598.s();!(_step598=_iterator598.n()).done;){var _i441=_step598.value;if(_i441.getCustomProperty(t))return _i441;}}catch(err){_iterator598.e(err);}finally{_iterator598.f();}}function vE(e,t,i){var n=_E(e,i);n&&t.remove(t.createRangeOn(n));}var yE=/*#__PURE__*/function(_Hr33){function yE(e){var _this607;_classCallCheck(this,yE);_this607=_callSuper(this,yE,[e]),_this607.set("isAccessAllowed",!0);return _this607;}_inherits(yE,_Hr33);return _createClass(yE,[{key:"refresh",value:function refresh(){var e=this.editor,t=e.plugins.get("ImageUtils"),i=e.model.document.selection.getSelectedElement();this.isEnabled=t.isImageAllowed()||t.isImage(i);}},{key:"execute",value:function execute(e){var _this608=this;var t=gr(e.file),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),s=Object.fromEntries(i.getAttributes());t.forEach(function(e,t){var o=i.getSelectedElement();if(t&&o&&n.isImage(o)){var _t393=_this608.editor.model.createPositionAfter(o);_this608._uploadImage(e,s,_t393);}else _this608._uploadImage(e,s);});}},{key:"_uploadImage",value:function _uploadImage(e,t,i){var n=this.editor,s=n.plugins.get(km).createLoader(e),o=n.plugins.get("ImageUtils");s&&o.insertImage(_objectSpread(_objectSpread({},t),{},{uploadId:s.id}),i);}}]);}(Hr);var kE=/*#__PURE__*/function(_Dr148){function kE(e){var _this609;_classCallCheck(this,kE);_this609=_callSuper(this,kE,[e]),_defineProperty(_assertThisInitialized(_this609),"_uploadImageElements",void 0),e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),_this609._uploadImageElements=new Map();return _this609;}_inherits(kE,_Dr148);return _createClass(kE,[{key:"init",value:function init(){var _this610=this;var e=this.editor,t=e.model.document,i=e.conversion,n=e.plugins.get(km),s=e.plugins.get("ImageUtils"),o=e.plugins.get("ClipboardPipeline"),r=uE(e.config.get("image.upload.types")),a=new yE(e);e.commands.add("uploadImage",a),e.commands.add("imageUpload",a),i["for"]("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",function(t,i){if(n=i.dataTransfer,Array.from(n.types).includes("text/html")&&""!==n.getData("text/html"))return;var n;var s=Array.from(i.dataTransfer.files).filter(function(e){return!!e&&r.test(e.type);});if(!s.length)return;t.stop(),e.model.change(function(t){i.targetRanges&&t.setSelection(i.targetRanges.map(function(t){return e.editing.mapper.toModelRange(t);})),e.execute("uploadImage",{file:s});});if(!e.commands.get("uploadImage").isAccessAllowed){var _t394=e.plugins.get("Notification"),_i442=e.locale.t;_t394.showWarning(_i442("You have no image upload permissions."),{namespace:"image"});}}),this.listenTo(o,"inputTransformation",function(t,i){var o=Array.from(e.editing.view.createRangeIn(i.content)).map(function(e){return e.item;}).filter(function(e){return function(e,t){return!(!e.isInlineImageView(t)||!t.getAttribute("src")||!t.getAttribute("src").match(/^data:image\/\w+;base64,/g)&&!t.getAttribute("src").match(/^blob:/g));}(s,e)&&!e.getAttribute("uploadProcessed");}).map(function(e){return{promise:hE(e),imageElement:e};});if(!o.length)return;var r=new ju(e.editing.view.document);var _iterator599=_createForOfIteratorHelper(o),_step599;try{for(_iterator599.s();!(_step599=_iterator599.n()).done;){var _e582=_step599.value;r.setAttribute("uploadProcessed",!0,_e582.imageElement);var _t395=n.createLoader(_e582.promise);_t395&&(r.setAttribute("src","",_e582.imageElement),r.setAttribute("uploadId",_t395.id,_e582.imageElement));}}catch(err){_iterator599.e(err);}finally{_iterator599.f();}}),e.editing.view.document.on("dragover",function(e,t){t.preventDefault();}),t.on("change",function(){var i=t.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),s=new Set();var _iterator600=_createForOfIteratorHelper(i),_step600;try{for(_iterator600.s();!(_step600=_iterator600.n()).done;){var _t396=_step600.value;if("insert"==_t396.type&&"$text"!=_t396.name){var _i443=_t396.position.nodeAfter,_o95="$graveyard"==_t396.position.root.rootName;var _iterator601=_createForOfIteratorHelper(CE(e,_i443)),_step601;try{for(_iterator601.s();!(_step601=_iterator601.n()).done;){var _t397=_step601.value;var _e583=_t397.getAttribute("uploadId");if(!_e583)continue;var _i444=n.loaders.get(_e583);_i444&&(_o95?s.has(_e583)||_i444.abort():(s.add(_e583),_this610._uploadImageElements.set(_e583,_t397),"idle"==_i444.status&&_this610._readAndUpload(_i444)));}}catch(err){_iterator601.e(err);}finally{_iterator601.f();}}}}catch(err){_iterator600.e(err);}finally{_iterator600.f();}}),this.on("uploadComplete",function(e,_ref218){var t=_ref218.imageElement,i=_ref218.data;var n=i.urls?i.urls:i;_this610.editor.model.change(function(e){e.setAttribute("src",n["default"],t),_this610._parseAndSetSrcsetAttributeOnImage(n,t,e),s.setImageNaturalSizeAttributes(t);});},{priority:"low"});}},{key:"afterInit",value:function afterInit(){var e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]});}},{key:"_readAndUpload",value:function _readAndUpload(e){var _this611=this;var t=this.editor,i=t.model,n=t.locale.t,s=t.plugins.get(km),r=t.plugins.get(Lb),a=t.plugins.get("ImageUtils"),l=this._uploadImageElements;return i.enqueueChange({isUndoable:!1},function(t){t.setAttribute("uploadStatus","reading",l.get(e.id));}),e.read().then(function(){var s=e.upload(),r=l.get(e.id);if(o.isSafari){var _e584=t.editing.mapper.toViewElement(r),_i445=a.findViewImgElement(_e584);t.editing.view.once("render",function(){if(!_i445.parent)return;var e=t.editing.view.domConverter.mapViewToDom(_i445.parent);if(!e)return;var n=e.style.display;e.style.display="none",e._ckHack=e.offsetHeight,e.style.display=n;});}return t.ui&&t.ui.ariaLiveAnnouncer.announce(n("Uploading image")),i.enqueueChange({isUndoable:!1},function(e){e.setAttribute("uploadStatus","uploading",r);}),s;}).then(function(s){i.enqueueChange({isUndoable:!1},function(i){var o=l.get(e.id);i.setAttribute("uploadStatus","complete",o),t.ui&&t.ui.ariaLiveAnnouncer.announce(n("Image upload complete")),_this611.fire("uploadComplete",{data:s,imageElement:o});}),c();})["catch"](function(s){if(t.ui&&t.ui.ariaLiveAnnouncer.announce(n("Error during image upload")),"error"!==e.status&&"aborted"!==e.status)throw s;"error"==e.status&&s&&r.showWarning(s,{title:n("Upload failed"),namespace:"upload"}),i.enqueueChange({isUndoable:!1},function(t){t.remove(l.get(e.id));}),c();});function c(){i.enqueueChange({isUndoable:!1},function(t){var i=l.get(e.id);t.removeAttribute("uploadId",i),t.removeAttribute("uploadStatus",i),l["delete"](e.id);}),s.destroyLoader(e);}}},{key:"_parseAndSetSrcsetAttributeOnImage",value:function _parseAndSetSrcsetAttributeOnImage(e,t,i){var n=0;var s=Object.keys(e).filter(function(e){var t=parseInt(e,10);if(!isNaN(t))return n=Math.max(n,t),!0;}).map(function(t){return"".concat(e[t]," ").concat(t,"w");}).join(", ");if(""!=s){var _e585={srcset:s};t.hasAttribute("width")||t.hasAttribute("height")||(_e585.width=n),i.setAttributes(_e585,t);}}}],[{key:"requires",get:function get(){return[km,Lb,Jv,BA];}},{key:"pluginName",get:function get(){return"ImageUploadEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function CE(e,t){var i=e.plugins.get("ImageUtils");return Array.from(e.model.createRangeOn(t)).filter(function(e){return i.isImage(e.item);}).map(function(e){return e.item;});}var xE=/*#__PURE__*/function(_Dr149){function xE(){_classCallCheck(this,xE);return _callSuper(this,xE,arguments);}_inherits(xE,_Dr149);return _createClass(xE,null,[{key:"pluginName",get:function get(){return"ImageUpload";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[kE,gE,fE];}}]);}(Dr);var AE=/*#__PURE__*/function(_lg58){function AE(e){var _this612;_classCallCheck(this,AE);_this612=_callSuper(this,AE,[e]),_defineProperty(_assertThisInitialized(_this612),"urlInputView",void 0),_defineProperty(_assertThisInitialized(_this612),"keystrokes",void 0),_this612.set("imageURLInputValue",""),_this612.set("isImageSelected",!1),_this612.set("isEnabled",!0),_this612.keystrokes=new Cr(),_this612.urlInputView=_this612._createUrlInputView(),_this612.setTemplate({tag:"div",attributes:{"class":["ck","ck-image-insert-url"]},children:[_this612.urlInputView,{tag:"div",attributes:{"class":["ck","ck-image-insert-url__action-row"]}}]});return _this612;}_inherits(AE,_lg58);return _createClass(AE,[{key:"render",value:function render(){_superPropGet(AE,"render",this,3)([]),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(AE,"destroy",this,3)([]),this.keystrokes.destroy();}},{key:"_createUrlInputView",value:function _createUrlInputView(){var _this613=this;var e=this.locale,t=e.t,i=new pf(e,cp);return i.bind("label").to(this,"isImageSelected",function(e){return t(e?"Update image URL":"Insert image via URL");}),i.bind("isEnabled").to(this),i.fieldView.inputMode="url",i.fieldView.placeholder="https://example.com/image.png",i.fieldView.bind("value").to(this,"imageURLInputValue",function(e){return e||"";}),i.fieldView.on("input",function(){_this613.imageURLInputValue=i.fieldView.element.value.trim();}),i;}},{key:"focus",value:function focus(){this.urlInputView.focus();}}]);}(lg);var EE=/*#__PURE__*/function(_Dr150){function EE(){var _this614;_classCallCheck(this,EE);for(var _len75=arguments.length,args=new Array(_len75),_key75=0;_key75<_len75;_key75++){args[_key75]=arguments[_key75];}_this614=_callSuper(this,EE,[].concat(args));_defineProperty(_this614,"_imageInsertUI",void 0);_defineProperty(_this614,"_formView",void 0);return _this614;}_inherits(EE,_Dr150);return _createClass(EE,[{key:"init",value:function init(){var _this615=this;this.editor.ui.componentFactory.add("insertImageViaUrl",function(){return _this615._createToolbarButton();}),this.editor.ui.componentFactory.add("menuBar:insertImageViaUrl",function(){return _this615._createMenuBarButton("standalone");});}},{key:"afterInit",value:function afterInit(){var _this616=this;this._imageInsertUI=this.editor.plugins.get("ImageInsertUI"),this._imageInsertUI.registerIntegration({name:"url",observable:function observable(){return _this616.editor.commands.get("insertImage");},buttonViewCreator:function buttonViewCreator(){return _this616._createToolbarButton();},formViewCreator:function formViewCreator(){return _this616._createDropdownButton();},menuBarButtonViewCreator:function menuBarButtonViewCreator(e){return _this616._createMenuBarButton(e?"insertOnly":"insertNested");}});}},{key:"_createInsertUrlButton",value:function _createInsertUrlButton(e){var _this617=this;var t=new e(this.editor.locale);return t.icon=vm.imageUrl,t.on("execute",function(){_this617._showModal();}),t;}},{key:"_createToolbarButton",value:function _createToolbarButton(){var e=this.editor.locale.t,t=this._createInsertUrlButton(pg);return t.tooltip=!0,t.bind("label").to(this._imageInsertUI,"isImageSelected",function(t){return e(t?"Update image URL":"Insert image via URL");}),t;}},{key:"_createDropdownButton",value:function _createDropdownButton(){var e=this.editor.locale.t,t=this._createInsertUrlButton(pg);return t.withText=!0,t.bind("label").to(this._imageInsertUI,"isImageSelected",function(t){return e(t?"Update image URL":"Insert via URL");}),t;}},{key:"_createMenuBarButton",value:function _createMenuBarButton(e){var t=this.editor.locale.t,i=this._createInsertUrlButton(Rg);switch(i.withText=!0,e){case"standalone":i.label=t("Image via URL");break;case"insertOnly":i.label=t("Image");break;case"insertNested":i.label=t("Via URL");}return i;}},{key:"_createInsertUrlView",value:function _createInsertUrlView(){var e=this.editor,t=e.locale,i=e.commands.get("replaceImageSource"),n=e.commands.get("insertImage"),s=new AE(t);return s.bind("isImageSelected").to(this._imageInsertUI),s.bind("isEnabled").toMany([n,i],"isEnabled",function(){for(var _len76=arguments.length,e=new Array(_len76),_key76=0;_key76<_len76;_key76++){e[_key76]=arguments[_key76];}return e.some(function(e){return e;});}),s;}},{key:"_showModal",value:function _showModal(){var _this618=this;var e=this.editor,t=e.locale.t,i=e.plugins.get("Dialog");this._formView||(this._formView=this._createInsertUrlView(),this._formView.on("submit",function(){return _this618._handleSave();}));var n=e.commands.get("replaceImageSource");this._formView.imageURLInputValue=n.value||"",i.show({id:"insertImageViaUrl",title:this._imageInsertUI.isImageSelected?t("Update image URL"):t("Insert image via URL"),isModal:!0,content:this._formView,actionButtons:[{label:t("Cancel"),withText:!0,onExecute:function onExecute(){return i.hide();}},{label:t("Accept"),"class":"ck-button-action",withText:!0,onExecute:function onExecute(){return _this618._handleSave();}}]});}},{key:"_handleSave",value:function _handleSave(){this.editor.commands.get("replaceImageSource").isEnabled?this.editor.execute("replaceImageSource",{source:this._formView.imageURLInputValue}):this.editor.execute("insertImage",{source:this._formView.imageURLInputValue}),this.editor.plugins.get("Dialog").hide();}}],[{key:"pluginName",get:function get(){return"ImageInsertViaUrlUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[tE,Sg];}}]);}(Dr);var TE=/*#__PURE__*/function(_Dr151){function TE(){_classCallCheck(this,TE);return _callSuper(this,TE,arguments);}_inherits(TE,_Dr151);return _createClass(TE,null,[{key:"pluginName",get:function get(){return"ImageInsertViaUrl";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[EE,tE];}}]);}(Dr);var PE=/*#__PURE__*/function(_Dr152){function PE(){_classCallCheck(this,PE);return _callSuper(this,PE,arguments);}_inherits(PE,_Dr152);return _createClass(PE,null,[{key:"pluginName",get:function get(){return"ImageInsert";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[xE,TE,tE];}}]);}(Dr);var SE=/*#__PURE__*/function(_Hr34){function SE(){_classCallCheck(this,SE);return _callSuper(this,SE,arguments);}_inherits(SE,_Hr34);return _createClass(SE,[{key:"refresh",value:function refresh(){var e=this.editor,t=e.plugins.get("ImageUtils").getClosestSelectedImageElement(e.model.document.selection);this.isEnabled=!!t,t&&t.hasAttribute("resizedWidth")?this.value={width:t.getAttribute("resizedWidth"),height:null}:this.value=null;}},{key:"execute",value:function execute(e){var t=this.editor,i=t.model,n=t.plugins.get("ImageUtils"),s=n.getClosestSelectedImageElement(i.document.selection);this.value={width:e.width,height:null},s&&i.change(function(t){t.setAttribute("resizedWidth",e.width,s),t.removeAttribute("resizedHeight",s),n.setImageNaturalSizeAttributes(s);});}}]);}(Hr);var IE=/*#__PURE__*/function(_Dr153){function IE(e){var _this619;_classCallCheck(this,IE);_this619=_callSuper(this,IE,[e]),e.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:custom",value:"custom",icon:"custom"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]});return _this619;}_inherits(IE,_Dr153);return _createClass(IE,[{key:"init",value:function init(){var e=this.editor,t=new SE(e);this._registerConverters("imageBlock"),this._registerConverters("imageInline"),e.commands.add("resizeImage",t),e.commands.add("imageResize",t);}},{key:"afterInit",value:function afterInit(){this._registerSchema();}},{key:"_registerSchema",value:function _registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["resizedWidth","resizedHeight"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["resizedWidth","resizedHeight"]});}},{key:"_registerConverters",value:function _registerConverters(e){var t=this.editor,i=t.plugins.get("ImageUtils");t.conversion["for"]("downcast").add(function(t){return t.on("attribute:resizedWidth:".concat(e),function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=i.writer,s=i.mapper.toViewElement(t.item);null!==t.attributeNewValue?(n.setStyle("width",t.attributeNewValue,s),n.addClass("image_resized",s)):(n.removeStyle("width",s),n.removeClass("image_resized",s));});}),t.conversion["for"]("dataDowncast").attributeToAttribute({model:{name:e,key:"resizedHeight"},view:function view(e){return{key:"style",value:{height:e}};}}),t.conversion["for"]("editingDowncast").add(function(t){return t.on("attribute:resizedHeight:".concat(e),function(t,n,s){if(!s.consumable.consume(n.item,t.name))return;var o=s.writer,r=s.mapper.toViewElement(n.item),a="imageInline"===e?i.findViewImgElement(r):r;null!==n.attributeNewValue?o.setStyle("height",n.attributeNewValue,a):o.removeStyle("height",a);});}),t.conversion["for"]("upcast").attributeToAttribute({view:{name:"imageBlock"===e?"figure":"img",styles:{width:/.+/}},model:{key:"resizedWidth",value:function value(e){return RA(e)?null:e.getStyle("width");}}}),t.conversion["for"]("upcast").attributeToAttribute({view:{name:"imageBlock"===e?"figure":"img",styles:{height:/.+/}},model:{key:"resizedHeight",value:function value(e){return RA(e)?null:e.getStyle("height");}}});}}],[{key:"requires",get:function get(){return[BA];}},{key:"pluginName",get:function get(){return"ImageResizeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var VE=function(){return{small:vm.objectSizeSmall,medium:vm.objectSizeMedium,large:vm.objectSizeLarge,custom:vm.objectSizeCustom,original:vm.objectSizeFull};}();var RE=/*#__PURE__*/function(_Dr154){function RE(e){var _this620;_classCallCheck(this,RE);_this620=_callSuper(this,RE,[e]),_defineProperty(_assertThisInitialized(_this620),"_resizeUnit",void 0),_this620._resizeUnit=e.config.get("image.resizeUnit");return _this620;}_inherits(RE,_Dr154);return _createClass(RE,[{key:"init",value:function init(){var e=this.editor,t=e.config.get("image.resizeOptions"),i=e.commands.get("resizeImage");this.bind("isEnabled").to(i);var _iterator602=_createForOfIteratorHelper(t),_step602;try{for(_iterator602.s();!(_step602=_iterator602.n()).done;){var _e586=_step602.value;this._registerImageResizeButton(_e586);}}catch(err){_iterator602.e(err);}finally{_iterator602.f();}this._registerImageResizeDropdown(t);}},{key:"_registerImageResizeButton",value:function _registerImageResizeButton(e){var _this621=this;var t=this.editor,i=e.name,n=e.value,s=e.icon;t.ui.componentFactory.add(i,function(i){var o=new pg(i),r=t.commands.get("resizeImage"),a=_this621._getOptionLabelValue(e,!0);if(!VE[s])throw new A("imageresizebuttons-missing-icon",t,e);if(o.set({label:a,icon:VE[s],tooltip:a,isToggleable:!0}),o.bind("isEnabled").to(_this621),t.plugins.has("ImageCustomResizeUI")&&OE(e)){var _e587=t.plugins.get("ImageCustomResizeUI");_this621.listenTo(o,"execute",function(){_e587._showForm(_this621._resizeUnit);});}else{var _e588=n?n+_this621._resizeUnit:null;o.bind("isOn").to(r,"value",BE(_e588)),_this621.listenTo(o,"execute",function(){t.execute("resizeImage",{width:_e588});});}return o;});}},{key:"_registerImageResizeDropdown",value:function _registerImageResizeDropdown(e){var _this622=this;var t=this.editor,i=t.t,n=e.find(function(e){return!e.value;}),s=function s(_s170){var o=t.commands.get("resizeImage"),r=Xf(_s170,Af),a=r.buttonView,l=i("Resize image");return a.set({tooltip:l,commandValue:n.value,icon:VE.medium,isToggleable:!0,label:_this622._getOptionLabelValue(n),withText:!0,"class":"ck-resize-image-button",ariaLabel:l,ariaLabelledBy:void 0}),a.bind("label").to(o,"value",function(e){return e&&e.width?e.width:_this622._getOptionLabelValue(n);}),r.bind("isEnabled").to(_this622),sp(r,function(){return _this622._getResizeDropdownListItemDefinitions(e,o);},{ariaLabel:i("Image resize list"),role:"menu"}),_this622.listenTo(r,"execute",function(e){"onClick"in e.source?e.source.onClick():(t.execute(e.source.commandName,{width:e.source.commandValue}),t.editing.view.focus());}),r;};t.ui.componentFactory.add("resizeImage",s),t.ui.componentFactory.add("imageResize",s);}},{key:"_getOptionLabelValue",value:function _getOptionLabelValue(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var i=this.editor.t;return e.label?e.label:t?OE(e)?i("Custom image size"):e.value?i("Resize image to %0",e.value+this._resizeUnit):i("Resize image to the original size"):OE(e)?i("Custom"):e.value?e.value+this._resizeUnit:i("Original");}},{key:"_getResizeDropdownListItemDefinitions",value:function _getResizeDropdownListItemDefinitions(e,t){var _this623=this;var i=this.editor,n=new br(),s=e.map(function(e){return OE(e)?_objectSpread(_objectSpread({},e),{},{valueWithUnits:"custom"}):e.value?_objectSpread(_objectSpread({},e),{},{valueWithUnits:"".concat(e.value).concat(_this623._resizeUnit)}):_objectSpread(_objectSpread({},e),{},{valueWithUnits:null});});var _iterator603=_createForOfIteratorHelper(s),_step603;try{var _loop26=function _loop26(){var e=_step603.value;var a=null;if(i.plugins.has("ImageCustomResizeUI")&&OE(e)){var _n240=i.plugins.get("ImageCustomResizeUI");a={type:"button",model:new Fb({label:_this623._getOptionLabelValue(e),role:"menuitemradio",withText:!0,icon:null,onClick:function onClick(){_n240._showForm(_this623._resizeUnit);}})};var _l16=(r="valueWithUnits",(se(o=s)?ne:Os)(o,hs(r)));a.model.bind("isOn").to(t,"value",ME(_l16));}else a={type:"button",model:new Fb({commandName:"resizeImage",commandValue:e.valueWithUnits,label:_this623._getOptionLabelValue(e),role:"menuitemradio",withText:!0,icon:null})},a.model.bind("isOn").to(t,"value",BE(e.valueWithUnits));a.model.bind("isEnabled").to(t,"isEnabled"),n.add(a);};for(_iterator603.s();!(_step603=_iterator603.n()).done;){_loop26();}}catch(err){_iterator603.e(err);}finally{_iterator603.f();}var o,r;return n;}}],[{key:"requires",get:function get(){return[IE];}},{key:"pluginName",get:function get(){return"ImageResizeButtons";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function OE(e){return"custom"===e.value;}function BE(e){return function(t){return null===e&&t===e||null!==t&&t.width===e;};}function ME(e){return function(t){return!e.some(function(e){return BE(e)(t);});};}var LE="image_resized";var FE=/*#__PURE__*/function(_Dr155){function FE(){_classCallCheck(this,FE);return _callSuper(this,FE,arguments);}_inherits(FE,_Dr155);return _createClass(FE,[{key:"init",value:function init(){var e=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(e),this._setupResizerCreator();}},{key:"_setupResizerCreator",value:function _setupResizerCreator(){var _this624=this;var e=this.editor,t=e.editing.view,i=e.plugins.get("ImageUtils");t.addObserver(qA),this.listenTo(t.document,"imageLoaded",function(n,s){if(!s.target.matches("figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img"))return;var o=e.editing.view.domConverter,r=o.domToView(s.target),a=i.getImageWidgetFromImageView(r);var l=_this624.editor.plugins.get(Ly).getResizerByViewElement(a);if(l)return void l.redraw();var c=e.editing.mapper,d=c.toModelElement(a);l=e.plugins.get(Ly).attachTo({unit:e.config.get("image.resizeUnit"),modelElement:d,viewElement:a,editor:e,getHandleHost:function getHandleHost(e){return e.querySelector("img");},getResizeHost:function getResizeHost(){return o.mapViewToDom(c.toViewElement(d));},isCentered:function isCentered(){return"alignCenter"==d.getAttribute("imageStyle");},onCommit:function onCommit(i){t.change(function(e){e.removeClass(LE,a);}),e.execute("resizeImage",{width:i});}}),l.on("updateSize",function(){a.hasClass(LE)||t.change(function(e){e.addClass(LE,a);});var e="imageInline"===d.name?r:a;e.getStyle("height")&&t.change(function(t){t.removeStyle("height",e);});}),l.bind("isEnabled").to(_this624);});}}],[{key:"requires",get:function get(){return[Ly,BA];}},{key:"pluginName",get:function get(){return"ImageResizeHandles";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function NE(e){if(!e)return null;var _ref219=e.trim().match(/([.,\d]+)(%|px)$/)||[],_ref220=_slicedToArray(_ref219,3),t=_ref220[1],i=_ref220[2],n=Number.parseFloat(t);return Number.isNaN(n)?null:{value:n,unit:i};}function DE(e,t,i){return"px"===i?{value:t.value,unit:"px"}:{value:t.value/e*100,unit:"%"};}function zE(e){var t=e.editing,i=e.plugins.get("ImageUtils").getClosestSelectedImageElement(e.model.document.selection);if(!i)return null;var n=t.mapper.toViewElement(i);return{model:i,view:n,dom:t.view.domConverter.mapViewToDom(n)};}var HE=/*#__PURE__*/function(_lg59){function HE(e,t,i){var _this625;_classCallCheck(this,HE);_this625=_callSuper(this,HE,[e]);_defineProperty(_this625,"focusTracker",void 0);_defineProperty(_this625,"keystrokes",void 0);_defineProperty(_this625,"unit",void 0);_defineProperty(_this625,"labeledInput",void 0);_defineProperty(_this625,"saveButtonView",void 0);_defineProperty(_this625,"cancelButtonView",void 0);_defineProperty(_this625,"_focusables",void 0);_defineProperty(_this625,"_focusCycler",void 0);_defineProperty(_this625,"_validators",void 0);var n=_this625.locale.t;_this625.focusTracker=new _r(),_this625.keystrokes=new Cr(),_this625.unit=t,_this625.labeledInput=_this625._createLabeledInputView(),_this625.saveButtonView=_this625._createButton(n("Save"),vm.check,"ck-button-save"),_this625.saveButtonView.type="submit",_this625.cancelButtonView=_this625._createButton(n("Cancel"),vm.cancel,"ck-button-cancel","cancel"),_this625._focusables=new zm(),_this625._validators=i,_this625._focusCycler=new _g({focusables:_this625._focusables,focusTracker:_this625.focusTracker,keystrokeHandler:_this625.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this625.setTemplate({tag:"form",attributes:{"class":["ck","ck-image-custom-resize-form","ck-responsive-form"],tabindex:"-1"},children:[_this625.labeledInput,_this625.saveButtonView,_this625.cancelButtonView]});return _this625;}_inherits(HE,_lg59);return _createClass(HE,[{key:"render",value:function render(){var _this626=this;_superPropGet(HE,"render",this,3)([]),this.keystrokes.listenTo(this.element),hg({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(function(e){_this626._focusables.add(e),_this626.focusTracker.add(e.element);});}},{key:"destroy",value:function destroy(){_superPropGet(HE,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"_createButton",value:function _createButton(e,t,i,n){var s=new pg(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.extendTemplate({attributes:{"class":i}}),n&&s.delegate("execute").to(this,n),s;}},{key:"_createLabeledInputView",value:function _createLabeledInputView(){var e=this.locale.t,t=new pf(this.locale,dp);return t.label=e("Resize image (in %0)",this.unit),t.fieldView.set({step:.1}),t;}},{key:"isValid",value:function isValid(){this.resetFormStatus();var _iterator604=_createForOfIteratorHelper(this._validators),_step604;try{for(_iterator604.s();!(_step604=_iterator604.n()).done;){var _e589=_step604.value;var _t398=_e589(this);if(_t398)return this.labeledInput.errorText=_t398,!1;}}catch(err){_iterator604.e(err);}finally{_iterator604.f();}return!0;}},{key:"resetFormStatus",value:function resetFormStatus(){this.labeledInput.errorText=null;}},{key:"rawSize",get:function get(){var e=this.labeledInput.fieldView.element;return e?e.value:null;}},{key:"parsedSize",get:function get(){var e=this.rawSize;if(null===e)return null;var t=Number.parseFloat(e);return Number.isNaN(t)?null:t;}},{key:"sizeWithUnits",get:function get(){var e=this.parsedSize,t=this.unit;return null===e?null:"".concat(e).concat(t);}}]);}(lg);var $E=/*#__PURE__*/function(_Dr156){function $E(){var _this627;_classCallCheck(this,$E);for(var _len77=arguments.length,args=new Array(_len77),_key77=0;_key77<_len77;_key77++){args[_key77]=arguments[_key77];}_this627=_callSuper(this,$E,[].concat(args));_defineProperty(_this627,"_balloon",void 0);_defineProperty(_this627,"_form",void 0);return _this627;}_inherits($E,_Dr156);return _createClass($E,[{key:"destroy",value:function destroy(){_superPropGet($E,"destroy",this,3)([]),this._form&&this._form.destroy();}},{key:"_createForm",value:function _createForm(e){var _this628=this;var t=this.editor;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(ug(HE))(t.locale,e,function(e){var t=e.t;return[function(e){return""===e.rawSize.trim()?t("The value must not be empty."):null===e.parsedSize?t("The value should be a plain number."):void 0;}];}(t)),this._form.render(),this.listenTo(this._form,"submit",function(){_this628._form.isValid()&&(t.execute("resizeImage",{width:_this628._form.sizeWithUnits}),_this628._hideForm(!0));}),this.listenTo(this._form.labeledInput,"change:errorText",function(){t.ui.update();}),this.listenTo(this._form,"cancel",function(){_this628._hideForm(!0);}),this._form.keystrokes.set("Esc",function(e,t){_this628._hideForm(!0),t();}),cg({emitter:this._form,activator:function activator(){return _this628._isVisible;},contextElements:function contextElements(){return[_this628._balloon.view.element];},callback:function callback(){return _this628._hideForm();}});}},{key:"_showForm",value:function _showForm(e){if(this._isVisible)return;this._form||this._createForm(e);var t=this.editor,i=this._form.labeledInput;this._form.disableCssTransitions(),this._form.resetFormStatus(),this._isInBalloon||this._balloon.add({view:this._form,position:HA(t)});var n=function(e,t){var i=zE(e);if(!i)return null;var n=NE(i.model.getAttribute("resizedWidth")||null);return n?n.unit===t?n:DE(fy(i.dom),{unit:"px",value:new Eo(i.dom).width},t):null;}(t,e),s=n?n.value.toFixed(1):"",o=function(e,t){var i=zE(e);if(!i)return null;var n=fy(i.dom),s=NE(window.getComputedStyle(i.dom).minWidth)||{value:1,unit:"px"};return{unit:t,lower:Math.max(.1,DE(n,s,t).value),upper:"px"===t?n:100};}(t,e);i.fieldView.value=i.fieldView.element.value=s,o&&Object.assign(i.fieldView,{min:o.lower.toFixed(1),max:Math.ceil(o.upper).toFixed(1)}),this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions();}},{key:"_hideForm",value:function _hideForm(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus());}},{key:"_isVisible",get:function get(){return!!this._balloon&&this._balloon.visibleView===this._form;}},{key:"_isInBalloon",get:function get(){return!!this._balloon&&this._balloon.hasView(this._form);}}],[{key:"requires",get:function get(){return[Db];}},{key:"pluginName",get:function get(){return"ImageCustomResizeUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var UE=/*#__PURE__*/function(_Dr157){function UE(){_classCallCheck(this,UE);return _callSuper(this,UE,arguments);}_inherits(UE,_Dr157);return _createClass(UE,null,[{key:"requires",get:function get(){return[IE,FE,$E,RE];}},{key:"pluginName",get:function get(){return"ImageResize";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var WE=/*#__PURE__*/function(_Hr35){function WE(e,t){var _this629;_classCallCheck(this,WE);_this629=_callSuper(this,WE,[e]),_defineProperty(_assertThisInitialized(_this629),"_defaultStyles",void 0),_defineProperty(_assertThisInitialized(_this629),"_styles",void 0),_this629._defaultStyles={imageBlock:!1,imageInline:!1},_this629._styles=new Map(t.map(function(e){if(e.isDefault){var _iterator605=_createForOfIteratorHelper(e.modelElements),_step605;try{for(_iterator605.s();!(_step605=_iterator605.n()).done;){var _t399=_step605.value;_this629._defaultStyles[_t399]=e.name;}}catch(err){_iterator605.e(err);}finally{_iterator605.f();}}return[e.name,e];}));return _this629;}_inherits(WE,_Hr35);return _createClass(WE,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!e,this.isEnabled?e.hasAttribute("imageStyle")?this.value=e.getAttribute("imageStyle"):this.value=this._defaultStyles[e.name]:this.value=!1;}},{key:"execute",value:function execute(){var _this630=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor,i=t.model,n=t.plugins.get("ImageUtils");i.change(function(t){var s=e.value,_e$setImageSizes2=e.setImageSizes,o=_e$setImageSizes2===void 0?!0:_e$setImageSizes2;var r=n.getClosestSelectedImageElement(i.document.selection);s&&_this630.shouldConvertImageType(s,r)&&(_this630.editor.execute(n.isBlockImage(r)?"imageTypeInline":"imageTypeBlock",{setImageSizes:o}),r=n.getClosestSelectedImageElement(i.document.selection)),!s||_this630._styles.get(s).isDefault?t.removeAttribute("imageStyle",r):t.setAttribute("imageStyle",s,r),o&&n.setImageNaturalSizeAttributes(r);});}},{key:"shouldConvertImageType",value:function shouldConvertImageType(e,t){return!this._styles.get(e).modelElements.includes(t.name);}}]);}(Hr);var jE={get inline(){return{name:"inline",title:"In line",icon:vm.objectInline,modelElements:["imageInline"],isDefault:!0};},get alignLeft(){return{name:"alignLeft",title:"Left aligned image",icon:vm.objectLeft,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"};},get alignBlockLeft(){return{name:"alignBlockLeft",title:"Left aligned image",icon:vm.objectBlockLeft,modelElements:["imageBlock"],className:"image-style-block-align-left"};},get alignCenter(){return{name:"alignCenter",title:"Centered image",icon:vm.objectCenter,modelElements:["imageBlock"],className:"image-style-align-center"};},get alignRight(){return{name:"alignRight",title:"Right aligned image",icon:vm.objectRight,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"};},get alignBlockRight(){return{name:"alignBlockRight",title:"Right aligned image",icon:vm.objectBlockRight,modelElements:["imageBlock"],className:"image-style-block-align-right"};},get block(){return{name:"block",title:"Centered image",icon:vm.objectCenter,modelElements:["imageBlock"],isDefault:!0};},get side(){return{name:"side",title:"Side image",icon:vm.objectRight,modelElements:["imageBlock"],className:"image-style-side"};}},qE=function(){return{full:vm.objectFullWidth,left:vm.objectBlockLeft,right:vm.objectBlockRight,center:vm.objectCenter,inlineLeft:vm.objectLeft,inlineRight:vm.objectRight,inline:vm.objectInline};}(),GE=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function KE(e){E("image-style-configuration-definition-invalid",e);}var ZE={normalizeStyles:function normalizeStyles(e){return(e.configuredStyles.options||[]).map(function(e){return function(e){e="string"==typeof e?jE[e]?_objectSpread({},jE[e]):{name:e}:function(e,t){var i=_objectSpread({},t);for(var _n241 in e)Object.prototype.hasOwnProperty.call(t,_n241)||(i[_n241]=e[_n241]);return i;}(jE[e.name],e);"string"==typeof e.icon&&(e.icon=qE[e.icon]||e.icon);return e;}(e);}).filter(function(t){return function(e,_ref221){var t=_ref221.isBlockPluginLoaded,i=_ref221.isInlinePluginLoaded;var n=e.modelElements,s=e.name;if(!(n&&n.length&&s))return KE({style:e}),!1;{var _s171=[t?"imageBlock":null,i?"imageInline":null];if(!n.some(function(e){return _s171.includes(e);}))return E("image-style-missing-dependency",{style:e,missingPlugins:n.map(function(e){return"imageBlock"===e?"ImageBlockEditing":"ImageInlineEditing";})}),!1;}return!0;}(t,e);});},getDefaultStylesConfiguration:function getDefaultStylesConfiguration(e,t){return e&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:e?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{};},getDefaultDropdownDefinitions:function getDefaultDropdownDefinitions(e){return e.has("ImageBlockEditing")&&e.has("ImageInlineEditing")?[].concat(GE):[];},warnInvalidStyle:KE,DEFAULT_OPTIONS:jE,DEFAULT_ICONS:qE,DEFAULT_DROPDOWN_DEFINITIONS:GE};function JE(e,t){var _iterator606=_createForOfIteratorHelper(t),_step606;try{for(_iterator606.s();!(_step606=_iterator606.n()).done;){var _i446=_step606.value;if(_i446.name===e)return _i446;}}catch(err){_iterator606.e(err);}finally{_iterator606.f();}}var QE=/*#__PURE__*/function(_Dr158){function QE(){var _this631;_classCallCheck(this,QE);for(var _len78=arguments.length,args=new Array(_len78),_key78=0;_key78<_len78;_key78++){args[_key78]=arguments[_key78];}_this631=_callSuper(this,QE,[].concat(args));_defineProperty(_this631,"normalizedStyles",void 0);return _this631;}_inherits(QE,_Dr158);return _createClass(QE,[{key:"init",value:function init(){var e=ZE.normalizeStyles,t=ZE.getDefaultStylesConfiguration,i=this.editor,n=i.plugins.has("ImageBlockEditing"),s=i.plugins.has("ImageInlineEditing");i.config.define("image.styles",t(n,s)),this.normalizedStyles=e({configuredStyles:i.config.get("image.styles"),isBlockPluginLoaded:n,isInlinePluginLoaded:s}),this._setupConversion(n,s),this._setupPostFixer(),i.commands.add("imageStyle",new WE(i,this.normalizedStyles));}},{key:"_setupConversion",value:function _setupConversion(e,t){var i=this.editor,n=i.model.schema,s=(o=this.normalizedStyles,function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=JE(t.attributeNewValue,o),s=JE(t.attributeOldValue,o),r=i.mapper.toViewElement(t.item),a=i.writer;s&&a.removeClass(s.className,r),n&&a.addClass(n.className,r);});var o;var r=function(e){var t={imageInline:e.filter(function(e){return!e.isDefault&&e.modelElements.includes("imageInline");}),imageBlock:e.filter(function(e){return!e.isDefault&&e.modelElements.includes("imageBlock");})};return function(e,i,n){if(!i.modelRange)return;var s=i.viewItem,o=wr(i.modelRange.getItems());if(o&&n.schema.checkAttribute(o,"imageStyle")){var _iterator607=_createForOfIteratorHelper(t[o.name]),_step607;try{for(_iterator607.s();!(_step607=_iterator607.n()).done;){var _e590=_step607.value;n.consumable.consume(s,{classes:_e590.className})&&n.writer.setAttribute("imageStyle",_e590.name,o);}}catch(err){_iterator607.e(err);}finally{_iterator607.f();}}};}(this.normalizedStyles);i.editing.downcastDispatcher.on("attribute:imageStyle",s),i.data.downcastDispatcher.on("attribute:imageStyle",s),e&&(n.extend("imageBlock",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:figure",r,{priority:"low"})),t&&(n.extend("imageInline",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:img",r,{priority:"low"}));}},{key:"_setupPostFixer",value:function _setupPostFixer(){var e=this.editor,t=e.model.document,i=e.plugins.get(BA),n=new Map(this.normalizedStyles.map(function(e){return[e.name,e];}));t.registerPostFixer(function(e){var s=!1;var _iterator608=_createForOfIteratorHelper(t.differ.getChanges()),_step608;try{for(_iterator608.s();!(_step608=_iterator608.n()).done;){var _o96=_step608.value;if("insert"==_o96.type||"attribute"==_o96.type&&"imageStyle"==_o96.attributeKey){var _t400="insert"==_o96.type?_o96.position.nodeAfter:_o96.range.start.nodeAfter;if(_t400&&_t400.is("element","paragraph")&&_t400.childCount>0&&(_t400=_t400.getChild(0)),!i.isImage(_t400))continue;var r=_t400.getAttribute("imageStyle");if(!r)continue;var _a25=n.get(r);_a25&&_a25.modelElements.includes(_t400.name)||(e.removeAttribute("imageStyle",_t400),s=!0);}}}catch(err){_iterator608.e(err);}finally{_iterator608.f();}return s;});}}],[{key:"pluginName",get:function get(){return"ImageStyleEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[BA];}}]);}(Dr);var YE=/*#__PURE__*/function(_Dr159){function YE(){_classCallCheck(this,YE);return _callSuper(this,YE,arguments);}_inherits(YE,_Dr159);return _createClass(YE,[{key:"localizedDefaultStylesTitles",get:function get(){var e=this.editor.t;return{"Wrap text":e("Wrap text"),"Break text":e("Break text"),"In line":e("In line"),"Full size image":e("Full size image"),"Side image":e("Side image"),"Left aligned image":e("Left aligned image"),"Centered image":e("Centered image"),"Right aligned image":e("Right aligned image")};}},{key:"init",value:function init(){var e=this.editor.plugins,t=this.editor.config.get("image.toolbar")||[],i=XE(e.get("ImageStyleEditing").normalizedStyles,this.localizedDefaultStylesTitles);var _iterator609=_createForOfIteratorHelper(i),_step609;try{for(_iterator609.s();!(_step609=_iterator609.n()).done;){var _e591=_step609.value;this._createButton(_e591);}}catch(err){_iterator609.e(err);}finally{_iterator609.f();}var n=XE([].concat(_toConsumableArray(t.filter(ue)),_toConsumableArray(ZE.getDefaultDropdownDefinitions(e))),this.localizedDefaultStylesTitles);var _iterator610=_createForOfIteratorHelper(n),_step610;try{for(_iterator610.s();!(_step610=_iterator610.n()).done;){var _e592=_step610.value;this._createDropdown(_e592,i);}}catch(err){_iterator610.e(err);}finally{_iterator610.f();}}},{key:"_createDropdown",value:function _createDropdown(e,t){var _this632=this;var i=this.editor.ui.componentFactory;i.add(e.name,function(n){var s;var o=e.defaultItem,r=e.items,a=e.title,l=r.filter(function(e){return t.find(function(_ref222){var t=_ref222.name;return eT(t)===e;});}).map(function(e){var t=i.create(e);return e===o&&(s=t),t;});r.length!==l.length&&ZE.warnInvalidStyle({dropdown:e});var c=Xf(n,Yf),d=c.buttonView,u=d.arrowView;return ip(c,l,{enableActiveItemFocusOnDropdownOpen:!0}),d.set({label:tT(a,s.label),"class":null,tooltip:!0}),u.unbind("label"),u.set({label:a}),d.bind("icon").toMany(l,"isOn",function(){for(var _len79=arguments.length,e=new Array(_len79),_key79=0;_key79<_len79;_key79++){e[_key79]=arguments[_key79];}var t=e.findIndex(be);return t<0?s.icon:l[t].icon;}),d.bind("label").toMany(l,"isOn",function(){for(var _len80=arguments.length,e=new Array(_len80),_key80=0;_key80<_len80;_key80++){e[_key80]=arguments[_key80];}var t=e.findIndex(be);return tT(a,t<0?s.label:l[t].label);}),d.bind("isOn").toMany(l,"isOn",function(){for(var _len81=arguments.length,e=new Array(_len81),_key81=0;_key81<_len81;_key81++){e[_key81]=arguments[_key81];}return e.some(be);}),d.bind("class").toMany(l,"isOn",function(){for(var _len82=arguments.length,e=new Array(_len82),_key82=0;_key82<_len82;_key82++){e[_key82]=arguments[_key82];}return e.some(be)?"ck-splitbutton_flatten":void 0;}),d.on("execute",function(){l.some(function(_ref223){var e=_ref223.isOn;return e;})?c.isOpen=!c.isOpen:s.fire("execute");}),c.bind("isEnabled").toMany(l,"isEnabled",function(){for(var _len83=arguments.length,e=new Array(_len83),_key83=0;_key83<_len83;_key83++){e[_key83]=arguments[_key83];}return e.some(be);}),_this632.listenTo(c,"execute",function(){_this632.editor.editing.view.focus();}),c;});}},{key:"_createButton",value:function _createButton(e){var _this633=this;var t=e.name;this.editor.ui.componentFactory.add(eT(t),function(i){var n=_this633.editor.commands.get("imageStyle"),s=new pg(i);return s.set({label:e.title,icon:e.icon,tooltip:!0,isToggleable:!0}),s.bind("isEnabled").to(n,"isEnabled"),s.bind("isOn").to(n,"value",function(e){return e===t;}),s.on("execute",_this633._executeCommand.bind(_this633,t)),s;});}},{key:"_executeCommand",value:function _executeCommand(e){this.editor.execute("imageStyle",{value:e}),this.editor.editing.view.focus();}}],[{key:"requires",get:function get(){return[QE];}},{key:"pluginName",get:function get(){return"ImageStyleUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function XE(e,t){var _iterator611=_createForOfIteratorHelper(e),_step611;try{for(_iterator611.s();!(_step611=_iterator611.n()).done;){var _i447=_step611.value;t[_i447.title]&&(_i447.title=t[_i447.title]);}}catch(err){_iterator611.e(err);}finally{_iterator611.f();}return e;}function eT(e){return"imageStyle:".concat(e);}function tT(e,t){return(e?e+": ":"")+t;}var iT=/*#__PURE__*/function(_Dr160){function iT(){_classCallCheck(this,iT);return _callSuper(this,iT,arguments);}_inherits(iT,_Dr160);return _createClass(iT,null,[{key:"requires",get:function get(){return[QE,YE];}},{key:"pluginName",get:function get(){return"ImageStyle";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var nT=/*#__PURE__*/function(_Dr161){function nT(){_classCallCheck(this,nT);return _callSuper(this,nT,arguments);}_inherits(nT,_Dr161);return _createClass(nT,[{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.t,i=e.plugins.get(Sy),n=e.plugins.get("ImageUtils");var s;i.register("image",{ariaLabel:t("Image toolbar"),items:(s=e.config.get("image.toolbar")||[],s.map(function(e){return ue(e)?e.name:e;})),getRelatedElement:function getRelatedElement(e){return n.getClosestSelectedImageWidget(e);}});}}],[{key:"requires",get:function get(){return[Sy,BA];}},{key:"pluginName",get:function get(){return"ImageToolbar";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var sT=/*#__PURE__*/function(_Dr162){function sT(){_classCallCheck(this,sT);return _callSuper(this,sT,arguments);}_inherits(sT,_Dr162);return _createClass(sT,[{key:"afterInit",value:function afterInit(){var e=this.editor;e.plugins.has("ImageBlockEditing")&&e.model.schema.extend("imageBlock",{allowAttributes:["sources"]}),e.plugins.has("ImageInlineEditing")&&e.model.schema.extend("imageInline",{allowAttributes:["sources"]}),this._setupConversion(),this._setupImageUploadEditingIntegration();}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.conversion,i=e.plugins.get("ImageUtils");t["for"]("upcast").add(function(e){var t=["srcset","media","type","sizes"],i=function i(_i450,n,s){var o=n.viewItem;if(!s.consumable.test(o,{name:!0}))return;var r=new Map();var _iterator612=_createForOfIteratorHelper(o.getChildren()),_step612;try{for(_iterator612.s();!(_step612=_iterator612.n()).done;){var _e594=_step612.value;if(_e594.is("element","source")){var _i448={};for(var _i449=0,_t401=t;_i449<_t401.length;_i449++){var _n242=_t401[_i449];_e594.hasAttribute(_n242)&&s.consumable.test(_e594,{attributes:_n242})&&(_i448[_n242]=_e594.getAttribute(_n242));}Object.keys(_i448).length&&r.set(_e594,_i448);}}}catch(err){_iterator612.e(err);}finally{_iterator612.f();}var a=e.findViewImgElement(o);if(!a)return;var l=n.modelCursor.parent;if(!l.is("element","imageBlock")){var _e593=s.convertItem(a,n.modelCursor);n.modelRange=_e593.modelRange,n.modelCursor=_e593.modelCursor,l=wr(_e593.modelRange.getItems());}s.consumable.consume(o,{name:!0});var _iterator613=_createForOfIteratorHelper(r),_step613;try{for(_iterator613.s();!(_step613=_iterator613.n()).done;){var _step613$value=_slicedToArray(_step613.value,2),_e595=_step613$value[0],_t402=_step613$value[1];s.consumable.consume(_e595,{attributes:Object.keys(_t402)});}}catch(err){_iterator613.e(err);}finally{_iterator613.f();}r.size&&s.writer.setAttribute("sources",Array.from(r.values()),l),s.convertChildren(o,l);};return function(e){e.on("element:picture",i);};}(i)),t["for"]("downcast").add(function(e){var t=function t(_t405,i,n){if(!n.consumable.consume(i.item,_t405.name))return;var s=n.writer,o=n.mapper.toViewElement(i.item),r=e.findViewImgElement(o),a=i.attributeNewValue;if(a&&a.length){var _e596=[];var _t403=r.parent;for(;_t403&&_t403.is("attributeElement");){var _i451=_t403.parent;s.unwrap(s.createRangeOn(r),_t403),_e596.unshift(_t403),_t403=_i451;}var _i452=r.parent.is("element","picture"),_n243=_i452?r.parent:s.createContainerElement("picture",null);_i452||s.insert(s.createPositionBefore(r),_n243),s.remove(s.createRangeIn(_n243)),s.insert(s.createPositionAt(_n243,"end"),a.map(function(e){return s.createEmptyElement("source",e);})),s.move(s.createRangeOn(r),s.createPositionAt(_n243,"end"));for(var _i453=0,_e597=_e596;_i453<_e597.length;_i453++){var _t404=_e597[_i453];s.wrap(s.createRangeOn(_n243),_t404);}}else if(r.parent.is("element","picture")){var _e598=r.parent;s.move(s.createRangeOn(r),s.createPositionBefore(_e598)),s.remove(_e598);}};return function(e){e.on("attribute:sources:imageBlock",t),e.on("attribute:sources:imageInline",t);};}(i));}},{key:"_setupImageUploadEditingIntegration",value:function _setupImageUploadEditingIntegration(){var e=this.editor;if(!e.plugins.has("ImageUploadEditing"))return;var t=e.plugins.get("ImageUploadEditing");this.listenTo(t,"uploadComplete",function(t,_ref224){var i=_ref224.imageElement,n=_ref224.data;var s=n.sources;s&&e.model.change(function(e){e.setAttributes({sources:s},i);});});}}],[{key:"requires",get:function get(){return[ZA,BA];}},{key:"pluginName",get:function get(){return"PictureEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var oT=/*#__PURE__*/function(_Dr163){function oT(){_classCallCheck(this,oT);return _callSuper(this,oT,arguments);}_inherits(oT,_Dr163);return _createClass(oT,[{key:"init",value:function init(){var e=this.editor;e.commands.add("indent",new Ur(e)),e.commands.add("outdent",new Ur(e));}}],[{key:"pluginName",get:function get(){return"IndentEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var rT=/*#__PURE__*/function(_Dr164){function rT(){_classCallCheck(this,rT);return _callSuper(this,rT,arguments);}_inherits(rT,_Dr164);return _createClass(rT,[{key:"init",value:function init(){var e=this.editor,t=e.locale,i=e.t,n="ltr"==t.uiLanguageDirection?vm.indent:vm.outdent,s="ltr"==t.uiLanguageDirection?vm.outdent:vm.indent;this._defineButton("indent",i("Increase indent"),n),this._defineButton("outdent",i("Decrease indent"),s);}},{key:"_defineButton",value:function _defineButton(e,t,i){var _this634=this;var n=this.editor;n.ui.componentFactory.add(e,function(){var n=_this634._createButton(pg,e,t,i);return n.set({tooltip:!0}),n;}),n.ui.componentFactory.add("menuBar:"+e,function(){return _this634._createButton(Rg,e,t,i);});}},{key:"_createButton",value:function _createButton(e,t,i,n){var s=this.editor,o=s.commands.get(t),r=new e(s.locale);return r.set({label:i,icon:n}),r.bind("isEnabled").to(o,"isEnabled"),this.listenTo(r,"execute",function(){s.execute(t),s.editing.view.focus();}),r;}}],[{key:"pluginName",get:function get(){return"IndentUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var aT=/*#__PURE__*/function(_Dr165){function aT(){_classCallCheck(this,aT);return _callSuper(this,aT,arguments);}_inherits(aT,_Dr165);return _createClass(aT,null,[{key:"pluginName",get:function get(){return"Indent";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[oT,rT];}}]);}(Dr);var lT=/*#__PURE__*/function(_Hr36){function lT(e,t){var _this635;_classCallCheck(this,lT);_this635=_callSuper(this,lT,[e]),_defineProperty(_assertThisInitialized(_this635),"_indentBehavior",void 0),_this635._indentBehavior=t;return _this635;}_inherits(lT,_Hr36);return _createClass(lT,[{key:"refresh",value:function refresh(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());e&&this._isIndentationChangeAllowed(e)?this.isEnabled=this._indentBehavior.checkEnabled(e.getAttribute("blockIndent")):this.isEnabled=!1;}},{key:"execute",value:function execute(){var _this636=this;var e=this.editor.model,t=this._getBlocksToChange();e.change(function(e){var _iterator614=_createForOfIteratorHelper(t),_step614;try{for(_iterator614.s();!(_step614=_iterator614.n()).done;){var _i454=_step614.value;var _t406=_i454.getAttribute("blockIndent"),_n244=_this636._indentBehavior.getNextIndent(_t406);_n244?e.setAttribute("blockIndent",_n244,_i454):e.removeAttribute("blockIndent",_i454);}}catch(err){_iterator614.e(err);}finally{_iterator614.f();}});}},{key:"_getBlocksToChange",value:function _getBlocksToChange(){var _this637=this;var e=this.editor.model.document.selection;return Array.from(e.getSelectedBlocks()).filter(function(e){return _this637._isIndentationChangeAllowed(e);});}},{key:"_isIndentationChangeAllowed",value:function _isIndentationChangeAllowed(e){var t=this.editor;if(!t.model.schema.checkAttribute(e,"blockIndent"))return!1;if(!t.plugins.has("ListUtils"))return!0;if(!this._indentBehavior.isForward)return!0;return!t.plugins.get("ListUtils").isListItemBlock(e);}}]);}(Hr);var cT=/*#__PURE__*/function(){function cT(e){_classCallCheck(this,cT);_defineProperty(this,"isForward",void 0);_defineProperty(this,"offset",void 0);_defineProperty(this,"unit",void 0);this.isForward="forward"===e.direction,this.offset=e.offset,this.unit=e.unit;}return _createClass(cT,[{key:"checkEnabled",value:function checkEnabled(e){var t=parseFloat(e||"0");return this.isForward||t>0;}},{key:"getNextIndent",value:function getNextIndent(e){var t=parseFloat(e||"0");if(!(!e||e.endsWith(this.unit)))return this.isForward?this.offset+this.unit:void 0;var i=t+(this.isForward?this.offset:-this.offset);return i>0?i+this.unit:void 0;}}]);}();var dT=/*#__PURE__*/function(){function dT(e){_classCallCheck(this,dT);_defineProperty(this,"isForward",void 0);_defineProperty(this,"classes",void 0);this.isForward="forward"===e.direction,this.classes=e.classes;}return _createClass(dT,[{key:"checkEnabled",value:function checkEnabled(e){var t=this.classes.indexOf(e);return this.isForward?t<this.classes.length-1:t>=0;}},{key:"getNextIndent",value:function getNextIndent(e){var t=this.classes.indexOf(e),i=this.isForward?1:-1;return this.classes[t+i];}}]);}();var uT=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];var hT=/*#__PURE__*/function(_Dr166){function hT(e){var _this638;_classCallCheck(this,hT);_this638=_callSuper(this,hT,[e]),e.config.define("indentBlock",{offset:40,unit:"px"});return _this638;}_inherits(hT,_Dr166);return _createClass(hT,[{key:"init",value:function init(){var e=this.editor,t=e.config.get("indentBlock");t.classes&&t.classes.length?(this._setupConversionUsingClasses(t.classes),e.commands.add("indentBlock",new lT(e,new dT({direction:"forward",classes:t.classes}))),e.commands.add("outdentBlock",new lT(e,new dT({direction:"backward",classes:t.classes})))):(e.data.addStyleProcessorRules(Ih),this._setupConversionUsingOffset(),e.commands.add("indentBlock",new lT(e,new cT({direction:"forward",offset:t.offset,unit:t.unit}))),e.commands.add("outdentBlock",new lT(e,new cT({direction:"backward",offset:t.offset,unit:t.unit}))));}},{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.model.schema,i=e.commands.get("indent"),n=e.commands.get("outdent"),s=e.config.get("heading.options");(s&&s.map(function(e){return e.model;})||uT).forEach(function(e){t.isRegistered(e)&&t.extend(e,{allowAttributes:"blockIndent"});}),t.setAttributeProperties("blockIndent",{isFormatting:!0}),i.registerChildCommand(e.commands.get("indentBlock")),n.registerChildCommand(e.commands.get("outdentBlock"));}},{key:"_setupConversionUsingOffset",value:function _setupConversionUsingOffset(){var e=this.editor.conversion,t="rtl"===this.editor.locale.contentLanguageDirection?"margin-right":"margin-left";e["for"]("upcast").attributeToAttribute({view:{styles:_defineProperty({},t,/[\s\S]+/)},model:{key:"blockIndent",value:function value(e){if(!e.is("element","li"))return e.getStyle(t);}}}),e["for"]("downcast").attributeToAttribute({model:"blockIndent",view:function view(e){return{key:"style",value:_defineProperty({},t,e)};}});}},{key:"_setupConversionUsingClasses",value:function _setupConversionUsingClasses(e){var t={model:{key:"blockIndent",values:[]},view:{}};var _iterator615=_createForOfIteratorHelper(e),_step615;try{for(_iterator615.s();!(_step615=_iterator615.n()).done;){var _i455=_step615.value;t.model.values.push(_i455),t.view[_i455]={key:"class",value:[_i455]};}}catch(err){_iterator615.e(err);}finally{_iterator615.f();}this.editor.conversion.attributeToAttribute(t);}}],[{key:"pluginName",get:function get(){return"IndentBlock";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function mT(e,t){return"".concat(e,":").concat(t=t||mr(e));}var gT=/*#__PURE__*/function(_Hr37){function gT(){_classCallCheck(this,gT);return _callSuper(this,gT,arguments);}_inherits(gT,_Hr37);return _createClass(gT,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"language");}},{key:"execute",value:function execute(){var _ref225=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},e=_ref225.languageCode,t=_ref225.textDirection;var i=this.editor.model,n=i.document.selection,s=!!e&&mT(e,t);i.change(function(e){if(n.isCollapsed)s?e.setSelectionAttribute("language",s):e.removeSelectionAttribute("language");else{var _t407=i.schema.getValidRanges(n.getRanges(),"language");var _iterator616=_createForOfIteratorHelper(_t407),_step616;try{for(_iterator616.s();!(_step616=_iterator616.n()).done;){var _i456=_step616.value;s?e.setAttribute("language",s,_i456):e.removeAttribute("language",_i456);}}catch(err){_iterator616.e(err);}finally{_iterator616.f();}}});}},{key:"_getValueFromFirstAllowedNode",value:function _getValueFromFirstAllowedNode(){var e=this.editor.model,t=e.schema,i=e.document.selection;if(i.isCollapsed)return i.getAttribute("language")||!1;var _iterator617=_createForOfIteratorHelper(i.getRanges()),_step617;try{for(_iterator617.s();!(_step617=_iterator617.n()).done;){var _e599=_step617.value;var _iterator618=_createForOfIteratorHelper(_e599.getItems()),_step618;try{for(_iterator618.s();!(_step618=_iterator618.n()).done;){var _i457=_step618.value;if(t.checkAttribute(_i457,"language"))return _i457.getAttribute("language")||!1;}}catch(err){_iterator618.e(err);}finally{_iterator618.f();}}}catch(err){_iterator617.e(err);}finally{_iterator617.f();}return!1;}}]);}(Hr);var fT=/*#__PURE__*/function(_Dr167){function fT(e){var _this639;_classCallCheck(this,fT);_this639=_callSuper(this,fT,[e]),e.config.define("language",{textPartLanguage:[{title:"Arabic",languageCode:"ar"},{title:"French",languageCode:"fr"},{title:"Spanish",languageCode:"es"}]});return _this639;}_inherits(fT,_Dr167);return _createClass(fT,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:"language"}),e.model.schema.setAttributeProperties("language",{copyOnEnter:!0}),this._defineConverters(),e.commands.add("textPartLanguage",new gT(e));}},{key:"_defineConverters",value:function _defineConverters(){var e=this.editor.conversion;e["for"]("upcast").elementToAttribute({model:{key:"language",value:function value(e){return mT(e.getAttribute("lang"),e.getAttribute("dir"));}},view:{name:"span",attributes:{lang:/[\s\S]+/}}}),e["for"]("downcast").attributeToElement({model:"language",view:function view(e,_ref226,i){var t=_ref226.writer;if(!e)return;if(!i.item.is("$textProxy")&&!i.item.is("documentSelection"))return;var _ref227=function(e){var _e$split8=e.split(":"),_e$split9=_slicedToArray(_e$split8,2),t=_e$split9[0],i=_e$split9[1];return{languageCode:t,textDirection:i};}(e),n=_ref227.languageCode,s=_ref227.textDirection;return t.createAttributeElement("span",{lang:n,dir:s});}});}}],[{key:"pluginName",get:function get(){return"TextPartLanguageEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pT=/*#__PURE__*/function(_Dr168){function pT(){_classCallCheck(this,pT);return _callSuper(this,pT,arguments);}_inherits(pT,_Dr168);return _createClass(pT,[{key:"init",value:function init(){var _this640=this;var e=this.editor,t=e.t,i=t("Choose language"),n=t("Language");e.ui.componentFactory.add("textPartLanguage",function(t){var _this640$_getItemMeta=_this640._getItemMetadata(),s=_this640$_getItemMeta.definitions,o=_this640$_getItemMeta.titles,r=e.commands.get("textPartLanguage"),a=Xf(t);return sp(a,s,{ariaLabel:n,role:"menu"}),a.buttonView.set({ariaLabel:n,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:n}),a.extendTemplate({attributes:{"class":["ck-text-fragment-language-dropdown"]}}),a.bind("isEnabled").to(r,"isEnabled"),a.buttonView.bind("label").to(r,"value",function(e){return e&&o[e]||i;}),a.buttonView.bind("ariaLabel").to(r,"value",function(e){var t=e&&o[e];return t?"".concat(t,", ").concat(n):n;}),_this640.listenTo(a,"execute",function(t){r.execute({languageCode:t.source.languageCode,textDirection:t.source.textDirection}),e.editing.view.focus();}),a;}),e.ui.componentFactory.add("menuBar:textPartLanguage",function(i){var _this640$_getItemMeta2=_this640._getItemMetadata(),s=_this640$_getItemMeta2.definitions,o=e.commands.get("textPartLanguage"),r=new aw(i);r.buttonView.set({label:n});var a=new lw(i);a.set({ariaLabel:t("Language"),role:"menu"});var _iterator619=_createForOfIteratorHelper(s),_step619;try{for(_iterator619.s();!(_step619=_iterator619.n()).done;){var _e600=_step619.value;if("button"!=_e600.type){a.items.add(new Sf(i));continue;}var _t408=new ub(i,r),_n245=new Rg(i);_n245.set({role:"menuitemradio",isToggleable:!0}),_n245.bind.apply(_n245,_toConsumableArray(Object.keys(_e600.model))).to(_e600.model),_n245.delegate("execute").to(r),_t408.children.add(_n245),a.items.add(_t408);}}catch(err){_iterator619.e(err);}finally{_iterator619.f();}return r.bind("isEnabled").to(o,"isEnabled"),r.panelView.children.add(a),r.on("execute",function(t){o.execute({languageCode:t.source.languageCode,textDirection:t.source.textDirection}),e.editing.view.focus();}),r;});}},{key:"_getItemMetadata",value:function _getItemMetadata(){var e=this.editor,t=new br(),i={},n=e.commands.get("textPartLanguage"),s=e.config.get("language.textPartLanguage"),o=(0,e.locale.t)("Remove language");t.add({type:"button",model:new Fb({label:o,languageCode:!1,withText:!0})}),t.add({type:"separator"});var _iterator620=_createForOfIteratorHelper(s),_step620;try{var _loop27=function _loop27(){var e=_step620.value;var s={type:"button",model:new Fb({label:e.title,languageCode:e.languageCode,role:"menuitemradio",textDirection:e.textDirection,withText:!0})},o=mT(e.languageCode,e.textDirection);s.model.bind("isOn").to(n,"value",function(e){return e===o;}),t.add(s),i[o]=e.title;};for(_iterator620.s();!(_step620=_iterator620.n()).done;){_loop27();}}catch(err){_iterator620.e(err);}finally{_iterator620.f();}return{definitions:t,titles:i};}}],[{key:"pluginName",get:function get(){return"TextPartLanguageUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var bT=/*#__PURE__*/function(_Dr169){function bT(){_classCallCheck(this,bT);return _callSuper(this,bT,arguments);}_inherits(bT,_Dr169);return _createClass(bT,null,[{key:"requires",get:function get(){return[fT,pT];}},{key:"pluginName",get:function get(){return"TextPartLanguage";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var wT=/*#__PURE__*/function(){function wT(){_classCallCheck(this,wT);_defineProperty(this,"_definitions",new Set());}return _createClass(wT,[{key:"length",get:function get(){return this._definitions.size;}},{key:"add",value:function add(e){var _this641=this;Array.isArray(e)?e.forEach(function(e){return _this641._definitions.add(e);}):this._definitions.add(e);}},{key:"getDispatcher",value:function getDispatcher(){var _this642=this;return function(e){e.on("attribute:linkHref",function(e,t,i){if(!i.consumable.test(t.item,"attribute:linkHref"))return;if(!t.item.is("selection")&&!i.schema.isInline(t.item))return;var n=i.writer,s=n.document.selection;var _iterator621=_createForOfIteratorHelper(_this642._definitions),_step621;try{for(_iterator621.s();!(_step621=_iterator621.n()).done;){var _e601=_step621.value;var _o97=n.createAttributeElement("a",_e601.attributes,{priority:5});_e601.classes&&n.addClass(_e601.classes,_o97);for(var _t409 in _e601.styles)n.setStyle(_t409,_e601.styles[_t409],_o97);n.setCustomProperty("link",!0,_o97),_e601.callback(t.attributeNewValue)?t.item.is("selection")?n.wrap(s.getFirstRange(),_o97):n.wrap(i.mapper.toViewRange(t.range),_o97):n.unwrap(i.mapper.toViewRange(t.range),_o97);}}catch(err){_iterator621.e(err);}finally{_iterator621.f();}},{priority:"high"});};}},{key:"getDispatcherForLinkedImage",value:function getDispatcherForLinkedImage(){var _this643=this;return function(e){e.on("attribute:linkHref:imageBlock",function(e,t,_ref228){var i=_ref228.writer,n=_ref228.mapper;var s=n.toViewElement(t.item),o=Array.from(s.getChildren()).find(function(e){return e.is("element","a");});if(o){var _iterator622=_createForOfIteratorHelper(_this643._definitions),_step622;try{for(_iterator622.s();!(_step622=_iterator622.n()).done;){var _e602=_step622.value;var _n246=xr(_e602.attributes);if(_e602.callback(t.attributeNewValue)){var _iterator623=_createForOfIteratorHelper(_n246),_step623;try{for(_iterator623.s();!(_step623=_iterator623.n()).done;){var _step623$value=_slicedToArray(_step623.value,2),_e603=_step623$value[0],_t411=_step623$value[1];"class"===_e603?i.addClass(_t411,o):i.setAttribute(_e603,_t411,o);}}catch(err){_iterator623.e(err);}finally{_iterator623.f();}_e602.classes&&i.addClass(_e602.classes,o);for(var _t410 in _e602.styles)i.setStyle(_t410,_e602.styles[_t410],o);}else{var _iterator624=_createForOfIteratorHelper(_n246),_step624;try{for(_iterator624.s();!(_step624=_iterator624.n()).done;){var _step624$value=_slicedToArray(_step624.value,2),_e604=_step624$value[0],_t413=_step624$value[1];"class"===_e604?i.removeClass(_t413,o):i.removeAttribute(_e604,o);}}catch(err){_iterator624.e(err);}finally{_iterator624.f();}_e602.classes&&i.removeClass(_e602.classes,o);for(var _t412 in _e602.styles)i.removeStyle(_t412,o);}}}catch(err){_iterator622.e(err);}finally{_iterator622.f();}}});};}}]);}();var _T=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,vT=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,yT=/^((\w+:(\/{2,})?)|(\W))/i,kT=["https?","ftps?","mailto"],CT="Ctrl+K";function xT(e,_ref229){var t=_ref229.writer;var i=t.createAttributeElement("a",{href:e},{priority:5});return t.setCustomProperty("link",!0,i),i;}function AT(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:kT;var i=String(e),n=t.join("|");return function(e,t){var i=e.replace(_T,"");return!!i.match(t);}(i,new RegExp("".concat("^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))".replace("<protocols>",n)),"i"))?i:"#";}function ET(e,t){return!!e&&t.checkAttribute(e.name,"linkHref");}function TT(e,t){var i=(n=e,vT.test(n)?"mailto:":t);var n;var s=!!i&&!PT(e);return e&&s?i+e:e;}function PT(e){return yT.test(e);}function ST(e){window.open(e,"_blank","noopener");}var IT=/*#__PURE__*/function(_Hr38){function IT(){var _this644;_classCallCheck(this,IT);for(var _len84=arguments.length,args=new Array(_len84),_key84=0;_key84<_len84;_key84++){args[_key84]=arguments[_key84];}_this644=_callSuper(this,IT,[].concat(args));_defineProperty(_this644,"manualDecorators",new br());_defineProperty(_this644,"automaticDecorators",new wT());return _this644;}_inherits(IT,_Hr38);return _createClass(IT,[{key:"restoreManualDecoratorStates",value:function restoreManualDecoratorStates(){var _iterator625=_createForOfIteratorHelper(this.manualDecorators),_step625;try{for(_iterator625.s();!(_step625=_iterator625.n()).done;){var _e605=_step625.value;_e605.value=this._getDecoratorStateFromModel(_e605.id);}}catch(err){_iterator625.e(err);}finally{_iterator625.f();}}},{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document.selection,i=t.getSelectedElement()||wr(t.getSelectedBlocks());ET(i,e.schema)?(this.value=i.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(i,"linkHref")):(this.value=t.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref"));var _iterator626=_createForOfIteratorHelper(this.manualDecorators),_step626;try{for(_iterator626.s();!(_step626=_iterator626.n()).done;){var _e606=_step626.value;_e606.value=this._getDecoratorStateFromModel(_e606.id);}}catch(err){_iterator626.e(err);}finally{_iterator626.f();}}},{key:"execute",value:function execute(e){var _this645=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.editor.model,n=i.document.selection,s=[],o=[];for(var _e607 in t)t[_e607]?s.push(_e607):o.push(_e607);i.change(function(t){if(n.isCollapsed){var r=n.getFirstPosition();if(n.hasAttribute("linkHref")){var _a26=VT(n);var _l17=Qw(r,"linkHref",n.getAttribute("linkHref"),i);n.getAttribute("linkHref")===_a26&&(_l17=_this645._updateLinkContent(i,t,_l17,e)),t.setAttribute("linkHref",e,_l17),s.forEach(function(e){t.setAttribute(e,!0,_l17);}),o.forEach(function(e){t.removeAttribute(e,_l17);}),t.setSelection(t.createPositionAfter(_l17.end.nodeBefore));}else if(""!==e){var _o98=xr(n.getAttributes());_o98.set("linkHref",e),s.forEach(function(e){_o98.set(e,!0);});var _i$insertContent=i.insertContent(t.createText(e,_o98),r),_a27=_i$insertContent.end;t.setSelection(_a27);}["linkHref"].concat(s,o).forEach(function(e){t.removeSelectionAttribute(e);});}else{var _r47=i.schema.getValidRanges(n.getRanges(),"linkHref"),_a28=[];var _iterator627=_createForOfIteratorHelper(n.getSelectedBlocks()),_step627;try{for(_iterator627.s();!(_step627=_iterator627.n()).done;){var _e608=_step627.value;i.schema.checkAttribute(_e608,"linkHref")&&_a28.push(t.createRangeOn(_e608));}}catch(err){_iterator627.e(err);}finally{_iterator627.f();}var _l18=_a28.slice();var _iterator628=_createForOfIteratorHelper(_r47),_step628;try{for(_iterator628.s();!(_step628=_iterator628.n()).done;){var _e609=_step628.value;_this645._isRangeToUpdate(_e609,_a28)&&_l18.push(_e609);}}catch(err){_iterator628.e(err);}finally{_iterator628.f();}var _iterator629=_createForOfIteratorHelper(_l18),_step629;try{var _loop28=function _loop28(){var r=_step629.value;var a=r;if(1===_l18.length){var _s172=VT(n);n.getAttribute("linkHref")===_s172&&(a=_this645._updateLinkContent(i,t,r,e),t.setSelection(t.createSelection(a)));}t.setAttribute("linkHref",e,a),s.forEach(function(e){t.setAttribute(e,!0,a);}),o.forEach(function(e){t.removeAttribute(e,a);});};for(_iterator629.s();!(_step629=_iterator629.n()).done;){_loop28();}}catch(err){_iterator629.e(err);}finally{_iterator629.f();}}});}},{key:"_getDecoratorStateFromModel",value:function _getDecoratorStateFromModel(e){var t=this.editor.model,i=t.document.selection,n=i.getSelectedElement();return ET(n,t.schema)?n.getAttribute(e):i.getAttribute(e);}},{key:"_isRangeToUpdate",value:function _isRangeToUpdate(e,t){var _iterator630=_createForOfIteratorHelper(t),_step630;try{for(_iterator630.s();!(_step630=_iterator630.n()).done;){var _i458=_step630.value;if(_i458.containsRange(e))return!1;}}catch(err){_iterator630.e(err);}finally{_iterator630.f();}return!0;}},{key:"_updateLinkContent",value:function _updateLinkContent(e,t,i,n){var s=t.createText(n,{linkHref:n});return e.insertContent(s,i);}}]);}(Hr);function VT(e){if(e.isCollapsed){var _t414=e.getFirstPosition();return _t414.textNode&&_t414.textNode.data;}{var _t415=Array.from(e.getFirstRange().getItems());if(_t415.length>1)return null;var _i459=_t415[0];return _i459.is("$text")||_i459.is("$textProxy")?_i459.data:null;}}var RT=/*#__PURE__*/function(_Hr39){function RT(){_classCallCheck(this,RT);return _callSuper(this,RT,arguments);}_inherits(RT,_Hr39);return _createClass(RT,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document.selection,i=t.getSelectedElement();ET(i,e.schema)?this.isEnabled=e.schema.checkAttribute(i,"linkHref"):this.isEnabled=e.schema.checkAttributeInSelection(t,"linkHref");}},{key:"execute",value:function execute(){var e=this.editor,t=this.editor.model,i=t.document.selection,n=e.commands.get("link");t.change(function(e){var s=i.isCollapsed?[Qw(i.getFirstPosition(),"linkHref",i.getAttribute("linkHref"),t)]:t.schema.getValidRanges(i.getRanges(),"linkHref");var _iterator631=_createForOfIteratorHelper(s),_step631;try{for(_iterator631.s();!(_step631=_iterator631.n()).done;){var _t416=_step631.value;if(e.removeAttribute("linkHref",_t416),n){var _iterator632=_createForOfIteratorHelper(n.manualDecorators),_step632;try{for(_iterator632.s();!(_step632=_iterator632.n()).done;){var _i460=_step632.value;e.removeAttribute(_i460.id,_t416);}}catch(err){_iterator632.e(err);}finally{_iterator632.f();}}}}catch(err){_iterator631.e(err);}finally{_iterator631.f();}});}}]);}(Hr);var OT=/*#__PURE__*/function(_Zs21){function OT(_ref230){var _this646;var e=_ref230.id,t=_ref230.label,i=_ref230.attributes,n=_ref230.classes,s=_ref230.styles,o=_ref230.defaultValue;_classCallCheck(this,OT);_this646=_callSuper(this,OT),_defineProperty(_assertThisInitialized(_this646),"id",void 0),_defineProperty(_assertThisInitialized(_this646),"defaultValue",void 0),_defineProperty(_assertThisInitialized(_this646),"label",void 0),_defineProperty(_assertThisInitialized(_this646),"attributes",void 0),_defineProperty(_assertThisInitialized(_this646),"classes",void 0),_defineProperty(_assertThisInitialized(_this646),"styles",void 0),_this646.id=e,_this646.set("value",void 0),_this646.defaultValue=o,_this646.label=t,_this646.attributes=i,_this646.classes=n,_this646.styles=s;return _this646;}_inherits(OT,_Zs21);return _createClass(OT,[{key:"_createPattern",value:function _createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles};}}]);}(Zs());var BT="automatic",MT=/^(https?:)?\/\//;var LT=/*#__PURE__*/function(_Dr170){function LT(e){var _this647;_classCallCheck(this,LT);_this647=_callSuper(this,LT,[e]),e.config.define("link",{allowCreatingEmptyLinks:!1,addTargetToExternalLinks:!1});return _this647;}_inherits(LT,_Dr170);return _createClass(LT,[{key:"init",value:function init(){var e=this.editor,t=this.editor.config.get("link.allowedProtocols");e.model.schema.extend("$text",{allowAttributes:"linkHref"}),e.conversion["for"]("dataDowncast").attributeToElement({model:"linkHref",view:xT}),e.conversion["for"]("editingDowncast").attributeToElement({model:"linkHref",view:function view(e,i){return xT(AT(e,t),i);}}),e.conversion["for"]("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:function value(e){return e.getAttribute("href");}}}),e.commands.add("link",new IT(e)),e.commands.add("unlink",new RT(e));var i=function(e,t){var i={"Open in a new tab":e("Open in a new tab"),Downloadable:e("Downloadable")};return t.forEach(function(e){return"label"in e&&i[e.label]&&(e.label=i[e.label]),e;}),t;}(e.t,function(e){var t=[];if(e)for(var _i461=0,_Object$entries16=Object.entries(e);_i461<_Object$entries16.length;_i461++){var _Object$entries16$_i=_slicedToArray(_Object$entries16[_i461],2),_i462=_Object$entries16$_i[0],_n247=_Object$entries16$_i[1];var _e610=Object.assign({},_n247,{id:"link".concat(wi(_i462))});t.push(_e610);}return t;}(e.config.get("link.decorators")));this._enableAutomaticDecorators(i.filter(function(e){return e.mode===BT;})),this._enableManualDecorators(i.filter(function(e){return"manual"===e.mode;}));e.plugins.get(Lw).registerAttribute("linkHref"),Xw(e,"linkHref","a","ck-link_selected"),this._enableLinkOpen(),this._enableSelectionAttributesFixer(),this._enableClipboardIntegration();}},{key:"_enableAutomaticDecorators",value:function _enableAutomaticDecorators(e){var t=this.editor,i=t.commands.get("link").automaticDecorators;t.config.get("link.addTargetToExternalLinks")&&i.add({id:"linkIsExternal",mode:BT,callback:function callback(e){return!!e&&MT.test(e);},attributes:{target:"_blank",rel:"noopener noreferrer"}}),i.add(e),i.length&&t.conversion["for"]("downcast").add(i.getDispatcher());}},{key:"_enableManualDecorators",value:function _enableManualDecorators(e){if(!e.length)return;var t=this.editor,i=t.commands.get("link").manualDecorators;e.forEach(function(e){t.model.schema.extend("$text",{allowAttributes:e.id});var n=new OT(e);i.add(n),t.conversion["for"]("downcast").attributeToElement({model:n.id,view:function view(e,_ref231,_ref232){var t=_ref231.writer,i=_ref231.schema;var s=_ref232.item;if((s.is("selection")||i.isInline(s))&&e){var _e611=t.createAttributeElement("a",n.attributes,{priority:5});n.classes&&t.addClass(n.classes,_e611);for(var _i463 in n.styles)t.setStyle(_i463,n.styles[_i463],_e611);return t.setCustomProperty("link",!0,_e611),_e611;}}}),t.conversion["for"]("upcast").elementToAttribute({view:_objectSpread({name:"a"},n._createPattern()),model:{key:n.id}});});}},{key:"_enableLinkOpen",value:function _enableLinkOpen(){var e=this.editor,t=e.editing.view.document;this.listenTo(t,"click",function(e,t){if(!(o.isMac?t.domEvent.metaKey:t.domEvent.ctrlKey))return;var i=t.domTarget;if("a"!=i.tagName.toLowerCase()&&(i=i.closest("a")),!i)return;var n=i.getAttribute("href");n&&(e.stop(),t.preventDefault(),ST(n));},{context:"$capture"}),this.listenTo(t,"keydown",function(t,i){var n=e.commands.get("link").value;!!n&&i.keyCode===nr.enter&&i.altKey&&(t.stop(),ST(n));});}},{key:"_enableSelectionAttributesFixer",value:function _enableSelectionAttributesFixer(){var e=this.editor.model,t=e.document.selection;this.listenTo(t,"change:attribute",function(i,_ref233){var n=_ref233.attributeKeys;n.includes("linkHref")&&!t.hasAttribute("linkHref")&&e.change(function(t){var i;!function(e,t){e.removeSelectionAttribute("linkHref");var _iterator633=_createForOfIteratorHelper(t),_step633;try{for(_iterator633.s();!(_step633=_iterator633.n()).done;){var _i464=_step633.value;e.removeSelectionAttribute(_i464);}}catch(err){_iterator633.e(err);}finally{_iterator633.f();}}(t,(i=e.schema,i.getDefinition("$text").allowAttributes.filter(function(e){return e.startsWith("link");})));});});}},{key:"_enableClipboardIntegration",value:function _enableClipboardIntegration(){var e=this.editor,t=e.model,i=this.editor.config.get("link.defaultProtocol");i&&this.listenTo(e.plugins.get("ClipboardPipeline"),"contentInsertion",function(e,n){t.change(function(e){var t=e.createRangeIn(n.content);var _iterator634=_createForOfIteratorHelper(t.getItems()),_step634;try{for(_iterator634.s();!(_step634=_iterator634.n()).done;){var _n248=_step634.value;if(_n248.hasAttribute("linkHref")){var _t417=TT(_n248.getAttribute("linkHref"),i);e.setAttribute("linkHref",_t417,_n248);}}}catch(err){_iterator634.e(err);}finally{_iterator634.f();}});});}}],[{key:"pluginName",get:function get(){return"LinkEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Lw,yw,Jv];}}]);}(Dr);var FT=/*#__PURE__*/function(_lg60){function FT(e,t,i){var _this648;_classCallCheck(this,FT);_this648=_callSuper(this,FT,[e]);_defineProperty(_this648,"focusTracker",new _r());_defineProperty(_this648,"keystrokes",new Cr());_defineProperty(_this648,"urlInputView",void 0);_defineProperty(_this648,"saveButtonView",void 0);_defineProperty(_this648,"cancelButtonView",void 0);_defineProperty(_this648,"_manualDecoratorSwitches",void 0);_defineProperty(_this648,"children",void 0);_defineProperty(_this648,"_validators",void 0);_defineProperty(_this648,"_focusables",new zm());_defineProperty(_this648,"_focusCycler",void 0);var n=e.t;_this648._validators=i,_this648.urlInputView=_this648._createUrlInput(),_this648.saveButtonView=_this648._createButton(n("Save"),vm.check,"ck-button-save"),_this648.saveButtonView.type="submit",_this648.cancelButtonView=_this648._createButton(n("Cancel"),vm.cancel,"ck-button-cancel","cancel"),_this648._manualDecoratorSwitches=_this648._createManualDecoratorSwitches(t),_this648.children=_this648._createFormChildren(t.manualDecorators),_this648._focusCycler=new _g({focusables:_this648._focusables,focusTracker:_this648.focusTracker,keystrokeHandler:_this648.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});var s=["ck","ck-link-form","ck-responsive-form"];t.manualDecorators.length&&s.push("ck-link-form_layout-vertical","ck-vertical-form"),_this648.setTemplate({tag:"form",attributes:{"class":s,tabindex:"-1"},children:_this648.children});return _this648;}_inherits(FT,_lg60);return _createClass(FT,[{key:"getDecoratorSwitchesState",value:function getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce(function(e,t){return e[t.name]=t.isOn,e;},{});}},{key:"render",value:function render(){var _this649=this;_superPropGet(FT,"render",this,3)([]),hg({view:this});[this.urlInputView].concat(_toConsumableArray(this._manualDecoratorSwitches),[this.saveButtonView,this.cancelButtonView]).forEach(function(e){_this649._focusables.add(e),_this649.focusTracker.add(e.element);}),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(FT,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"isValid",value:function isValid(){this.resetFormStatus();var _iterator635=_createForOfIteratorHelper(this._validators),_step635;try{for(_iterator635.s();!(_step635=_iterator635.n()).done;){var _e612=_step635.value;var _t418=_e612(this);if(_t418)return this.urlInputView.errorText=_t418,!1;}}catch(err){_iterator635.e(err);}finally{_iterator635.f();}return!0;}},{key:"resetFormStatus",value:function resetFormStatus(){this.urlInputView.errorText=null;}},{key:"_createUrlInput",value:function _createUrlInput(){var e=this.locale.t,t=new pf(this.locale,cp);return t.fieldView.inputMode="url",t.label=e("Link URL"),t;}},{key:"_createButton",value:function _createButton(e,t,i,n){var s=new pg(this.locale);return s.set({label:e,icon:t,tooltip:!0}),s.extendTemplate({attributes:{"class":i}}),n&&s.delegate("execute").to(this,n),s;}},{key:"_createManualDecoratorSwitches",value:function _createManualDecoratorSwitches(e){var _this650=this;var t=this.createCollection();var _iterator636=_createForOfIteratorHelper(e.manualDecorators),_step636;try{var _loop29=function _loop29(){var i=_step636.value;var n=new Dg(_this650.locale);n.set({name:i.id,label:i.label,withText:!0}),n.bind("isOn").toMany([i,e],"value",function(e,t){return void 0===t&&void 0===e?!!i.defaultValue:!!e;}),n.on("execute",function(){i.set("value",!n.isOn);}),t.add(n);};for(_iterator636.s();!(_step636=_iterator636.n()).done;){_loop29();}}catch(err){_iterator636.e(err);}finally{_iterator636.f();}return t;}},{key:"_createFormChildren",value:function _createFormChildren(e){var t=this.createCollection();if(t.add(this.urlInputView),e.length){var _e613=new lg();_e613.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(function(e){return{tag:"li",children:[e],attributes:{"class":["ck","ck-list__item"]}};}),attributes:{"class":["ck","ck-reset","ck-list"]}}),t.add(_e613);}return t.add(this.saveButtonView),t.add(this.cancelButtonView),t;}},{key:"url",get:function get(){var e=this.urlInputView.fieldView.element;return e?e.value.trim():null;}}]);}(lg);var NT='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';var DT=/*#__PURE__*/function(_lg61){function DT(e){var _this651;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,DT);_this651=_callSuper(this,DT,[e]);_defineProperty(_this651,"focusTracker",new _r());_defineProperty(_this651,"keystrokes",new Cr());_defineProperty(_this651,"previewButtonView",void 0);_defineProperty(_this651,"unlinkButtonView",void 0);_defineProperty(_this651,"editButtonView",void 0);_defineProperty(_this651,"_focusables",new zm());_defineProperty(_this651,"_focusCycler",void 0);_defineProperty(_this651,"_linkConfig",void 0);var i=e.t;_this651.previewButtonView=_this651._createPreviewButton(),_this651.unlinkButtonView=_this651._createButton(i("Unlink"),NT,"unlink"),_this651.editButtonView=_this651._createButton(i("Edit link"),vm.pencil,"edit"),_this651.set("href",void 0),_this651._linkConfig=t,_this651._focusCycler=new _g({focusables:_this651._focusables,focusTracker:_this651.focusTracker,keystrokeHandler:_this651.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this651.setTemplate({tag:"div",attributes:{"class":["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[_this651.previewButtonView,_this651.editButtonView,_this651.unlinkButtonView]});return _this651;}_inherits(DT,_lg61);return _createClass(DT,[{key:"render",value:function render(){var _this652=this;_superPropGet(DT,"render",this,3)([]);[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(function(e){_this652._focusables.add(e),_this652.focusTracker.add(e.element);}),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(DT,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"_createButton",value:function _createButton(e,t,i){var n=new pg(this.locale);return n.set({label:e,icon:t,tooltip:!0}),n.delegate("execute").to(this,i),n;}},{key:"_createPreviewButton",value:function _createPreviewButton(){var _this653=this;var e=new pg(this.locale),t=this.bindTemplate,i=this.t;return e.set({withText:!0,tooltip:i("Open link in new tab")}),e.extendTemplate({attributes:{"class":["ck","ck-link-actions__preview"],href:t.to("href",function(e){return e&&AT(e,_this653._linkConfig.allowedProtocols);}),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",function(e){return e||i("This link has no URL");}),e.bind("isEnabled").to(this,"href",function(e){return!!e;}),e.template.tag="a",e.template.eventListeners={},e;}}]);}(lg);var zT='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';var HT="link-ui";var $T=/*#__PURE__*/function(_Dr171){function $T(){var _this654;_classCallCheck(this,$T);for(var _len85=arguments.length,args=new Array(_len85),_key85=0;_key85<_len85;_key85++){args[_key85]=arguments[_key85];}_this654=_callSuper(this,$T,[].concat(args));_defineProperty(_this654,"actionsView",null);_defineProperty(_this654,"formView",null);_defineProperty(_this654,"_balloon",void 0);return _this654;}_inherits($T,_Dr171);return _createClass($T,[{key:"init",value:function init(){var e=this.editor,t=this.editor.t;e.editing.view.addObserver(Uu),this._balloon=e.plugins.get(Db),this._createToolbarLinkButton(),this._enableBalloonActivators(),e.conversion["for"]("editingDowncast").markerToHighlight({model:HT,view:{classes:["ck-fake-link-selection"]}}),e.conversion["for"]("editingDowncast").markerToElement({model:HT,view:function view(e,_ref234){var t=_ref234.writer;if(!e.markerRange.isCollapsed)return null;var i=t.createUIElement("span");return t.addClass(["ck-fake-link-selection","ck-fake-link-selection_collapsed"],i),i;}}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:t("Create link"),keystroke:CT},{label:t("Move out of a link"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]});}},{key:"destroy",value:function destroy(){_superPropGet($T,"destroy",this,3)([]),this.formView&&this.formView.destroy(),this.actionsView&&this.actionsView.destroy();}},{key:"_createViews",value:function _createViews(){this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._enableUserBalloonInteractions();}},{key:"_createActionsView",value:function _createActionsView(){var _this655=this;var e=this.editor,t=new DT(e.locale,e.config.get("link")),i=e.commands.get("link"),n=e.commands.get("unlink");return t.bind("href").to(i,"value"),t.editButtonView.bind("isEnabled").to(i),t.unlinkButtonView.bind("isEnabled").to(n),this.listenTo(t,"edit",function(){_this655._addFormView();}),this.listenTo(t,"unlink",function(){e.execute("unlink"),_this655._hideUI();}),t.keystrokes.set("Esc",function(e,t){_this655._hideUI(),t();}),t.keystrokes.set(CT,function(e,t){_this655._addFormView(),t();}),t;}},{key:"_createFormView",value:function _createFormView(){var _this656=this;var e=this.editor,t=e.commands.get("link"),i=e.config.get("link.defaultProtocol"),n=new(ug(FT))(e.locale,t,function(e){var t=e.t,i=e.config.get("link.allowCreatingEmptyLinks");return[function(e){if(!i&&!e.url.length)return t("Link URL must not be empty.");}];}(e));return n.urlInputView.fieldView.bind("value").to(t,"value"),n.urlInputView.bind("isEnabled").to(t,"isEnabled"),n.saveButtonView.bind("isEnabled").to(t,"isEnabled"),this.listenTo(n,"submit",function(){if(n.isValid()){var _t419=n.urlInputView.fieldView.element.value,_s173=TT(_t419,i);e.execute("link",_s173,n.getDecoratorSwitchesState()),_this656._closeFormView();}}),this.listenTo(n.urlInputView,"change:errorText",function(){e.ui.update();}),this.listenTo(n,"cancel",function(){_this656._closeFormView();}),n.keystrokes.set("Esc",function(e,t){_this656._closeFormView(),t();}),n;}},{key:"_createToolbarLinkButton",value:function _createToolbarLinkButton(){var _this657=this;var e=this.editor;e.ui.componentFactory.add("link",function(){var e=_this657._createButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:link",function(){var e=_this657._createButton(Rg);return e.set({role:"menuitemcheckbox"}),e;});}},{key:"_createButton",value:function _createButton(e){var _this658=this;var t=this.editor,i=t.locale,n=t.commands.get("link"),s=new e(t.locale),o=i.t;return s.set({label:o("Link"),icon:zT,keystroke:CT,isToggleable:!0}),s.bind("isEnabled").to(n,"isEnabled"),s.bind("isOn").to(n,"value",function(e){return!!e;}),this.listenTo(s,"execute",function(){return _this658._showUI(!0);}),s;}},{key:"_enableBalloonActivators",value:function _enableBalloonActivators(){var _this659=this;var e=this.editor,t=e.editing.view.document;this.listenTo(t,"click",function(){_this659._getSelectedLinkElement()&&_this659._showUI();}),e.keystrokes.set(CT,function(t,i){i(),e.commands.get("link").isEnabled&&_this659._showUI(!0);});}},{key:"_enableUserBalloonInteractions",value:function _enableUserBalloonInteractions(){var _this660=this;this.editor.keystrokes.set("Tab",function(e,t){_this660._areActionsVisible&&!_this660.actionsView.focusTracker.isFocused&&(_this660.actionsView.focus(),t());},{priority:"high"}),this.editor.keystrokes.set("Esc",function(e,t){_this660._isUIVisible&&(_this660._hideUI(),t());}),cg({emitter:this.formView,activator:function activator(){return _this660._isUIInPanel;},contextElements:function contextElements(){return[_this660._balloon.view.element];},callback:function callback(){return _this660._hideUI();}});}},{key:"_addActionsView",value:function _addActionsView(){this.actionsView||this._createViews(),this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()});}},{key:"_addFormView",value:function _addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;var e=this.editor.commands.get("link");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.urlInputView.fieldView.value=e.value||"",this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions();}},{key:"_closeFormView",value:function _closeFormView(){var e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),void 0!==e.value?this._removeFormView():this._hideUI();}},{key:"_removeFormView",value:function _removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this.formView.urlInputView.fieldView.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection());}},{key:"_showUI",value:function _showUI(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;this.formView||this._createViews(),this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI();}},{key:"_hideUI",value:function _hideUI(){if(!this._isUIInPanel)return;var e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection();}},{key:"_startUpdatingUI",value:function _startUpdatingUI(){var _this661=this;var e=this.editor,t=e.editing.view.document;var i=this._getSelectedLinkElement(),n=o();var s=function s(){var e=_this661._getSelectedLinkElement(),t=o();i&&!e||!i&&t!==n?_this661._hideUI():_this661._isUIVisible&&_this661._balloon.updatePosition(_this661._getBalloonPositionData()),i=e,n=t;};function o(){return t.selection.focus.getAncestors().reverse().find(function(e){return e.is("element");});}this.listenTo(e.ui,"update",s),this.listenTo(this._balloon,"change:visibleView",s);}},{key:"_isFormInPanel",get:function get(){return!!this.formView&&this._balloon.hasView(this.formView);}},{key:"_areActionsInPanel",get:function get(){return!!this.actionsView&&this._balloon.hasView(this.actionsView);}},{key:"_areActionsVisible",get:function get(){return!!this.actionsView&&this._balloon.visibleView===this.actionsView;}},{key:"_isUIInPanel",get:function get(){return this._isFormInPanel||this._areActionsInPanel;}},{key:"_isUIVisible",get:function get(){var e=this._balloon.visibleView;return!!this.formView&&e==this.formView||this._areActionsVisible;}},{key:"_getBalloonPositionData",value:function _getBalloonPositionData(){var _this662=this;var e=this.editor.editing.view,t=this.editor.model,i=e.document;var n;if(t.markers.has(HT)){var _t420=Array.from(this.editor.editing.mapper.markerNameToElements(HT)),_i465=e.createRange(e.createPositionBefore(_t420[0]),e.createPositionAfter(_t420[_t420.length-1]));n=e.domConverter.viewRangeToDom(_i465);}else n=function n(){var t=_this662._getSelectedLinkElement();return t?e.domConverter.mapViewToDom(t):e.domConverter.viewRangeToDom(i.selection.getFirstRange());};return{target:n};}},{key:"_getSelectedLinkElement",value:function _getSelectedLinkElement(){var e=this.editor.editing.view,t=e.document.selection,i=t.getSelectedElement();if(t.isCollapsed||i&&sy(i))return UT(t.getFirstPosition());{var _i466=t.getFirstRange().getTrimmed(),_n249=UT(_i466.start),_s174=UT(_i466.end);return _n249&&_n249==_s174&&e.createRangeIn(_n249).getTrimmed().isEqual(_i466)?_n249:null;}}},{key:"_showFakeVisualSelection",value:function _showFakeVisualSelection(){var e=this.editor.model;e.change(function(t){var i=e.document.selection.getFirstRange();if(e.markers.has(HT))t.updateMarker(HT,{range:i});else if(i.start.isAtEnd){var _n250=i.start.getLastMatchingPosition(function(_ref235){var t=_ref235.item;return!e.schema.isContent(t);},{boundaries:i});t.addMarker(HT,{usingOperation:!1,affectsData:!1,range:t.createRange(_n250,i.end)});}else t.addMarker(HT,{usingOperation:!1,affectsData:!1,range:i});});}},{key:"_hideFakeVisualSelection",value:function _hideFakeVisualSelection(){var e=this.editor.model;e.markers.has(HT)&&e.change(function(e){e.removeMarker(HT);});}}],[{key:"requires",get:function get(){return[Db];}},{key:"pluginName",get:function get(){return"LinkUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function UT(e){return e.getAncestors().find(function(e){return(t=e).is("attributeElement")&&!!t.getCustomProperty("link");var t;})||null;}var WT=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i");var jT=/*#__PURE__*/function(_Dr172){function jT(){_classCallCheck(this,jT);return _callSuper(this,jT,arguments);}_inherits(jT,_Dr172);return _createClass(jT,[{key:"init",value:function init(){var _this663=this;var e=this.editor.model.document.selection;e.on("change:range",function(){_this663.isEnabled=!e.anchor.parent.is("element","codeBlock");}),this._enableTypingHandling();}},{key:"afterInit",value:function afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling(),this._enablePasteLinking();}},{key:"_expandLinkRange",value:function _expandLinkRange(e,t){return t.textNode&&t.textNode.hasAttribute("linkHref")?Qw(t,"linkHref",t.textNode.getAttribute("linkHref"),e):null;}},{key:"_selectEntireLinks",value:function _selectEntireLinks(e,t){var i=this.editor.model,n=i.document.selection,s=n.getFirstPosition(),o=n.getLastPosition();var r=t.getJoined(this._expandLinkRange(i,s)||t);r&&(r=r.getJoined(this._expandLinkRange(i,o)||t)),r&&(r.start.isBefore(s)||r.end.isAfter(o))&&e.setSelection(r);}},{key:"_enablePasteLinking",value:function _enablePasteLinking(){var _this664=this;var e=this.editor,t=e.model,i=t.document.selection,n=e.plugins.get("ClipboardPipeline"),s=e.commands.get("link");n.on("inputTransformation",function(e,n){if(!_this664.isEnabled||!s.isEnabled||i.isCollapsed||"paste"!==n.method)return;if(i.rangeCount>1)return;var o=i.getFirstRange(),r=n.dataTransfer.getData("text/plain");if(!r)return;var a=r.match(WT);a&&a[2]===r&&(t.change(function(e){_this664._selectEntireLinks(e,o),s.execute(r);}),e.stop());},{priority:"high"});}},{key:"_enableTypingHandling",value:function _enableTypingHandling(){var _this665=this;var e=this.editor,t=new Mw(e.model,function(e){if(!function(e){return e.length>4&&" "===e[e.length-1]&&" "!==e[e.length-2];}(e))return;var t=qT(e.substr(0,e.length-1));return t?{url:t}:void 0;});t.on("matched:data",function(t,i){var n=i.batch,s=i.range,o=i.url;if(!n.isTyping)return;var r=s.end.getShiftedBy(-1),a=r.getShiftedBy(-o.length),l=e.model.createRange(a,r);_this665._applyAutoLink(o,l);}),t.bind("isEnabled").to(this);}},{key:"_enableEnterHandling",value:function _enableEnterHandling(){var _this666=this;var e=this.editor,t=e.model,i=e.commands.get("enter");i&&i.on("execute",function(){var e=t.document.selection.getFirstPosition();if(!e.parent.previousSibling)return;var i=t.createRangeIn(e.parent.previousSibling);_this666._checkAndApplyAutoLinkOnRange(i);});}},{key:"_enableShiftEnterHandling",value:function _enableShiftEnterHandling(){var _this667=this;var e=this.editor,t=e.model,i=e.commands.get("shiftEnter");i&&i.on("execute",function(){var e=t.document.selection.getFirstPosition(),i=t.createRange(t.createPositionAt(e.parent,0),e.getShiftedBy(-1));_this667._checkAndApplyAutoLinkOnRange(i);});}},{key:"_checkAndApplyAutoLinkOnRange",value:function _checkAndApplyAutoLinkOnRange(e){var t=this.editor.model,_Bw2=Bw(e,t),i=_Bw2.text,n=_Bw2.range,s=qT(i);if(s){var _e614=t.createRange(n.end.getShiftedBy(-s.length),n.end);this._applyAutoLink(s,_e614);}}},{key:"_applyAutoLink",value:function _applyAutoLink(e,t){var i=this.editor.model,n=TT(e,this.editor.config.get("link.defaultProtocol"));this.isEnabled&&function(e,t){return t.schema.checkAttributeInSelection(t.createSelection(e),"linkHref");}(t,i)&&PT(n)&&!function(e){var t=e.start.nodeAfter;return!!t&&t.hasAttribute("linkHref");}(t)&&this._persistAutoLink(n,t);}},{key:"_persistAutoLink",value:function _persistAutoLink(e,t){var i=this.editor.model,n=this.editor.plugins.get("Delete");i.enqueueChange(function(s){s.setAttribute("linkHref",e,t),i.enqueueChange(function(){n.requestUndoOnBackspace();});});}}],[{key:"requires",get:function get(){return[Rw,LT];}},{key:"pluginName",get:function get(){return"AutoLink";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function qT(e){var t=WT.exec(e);return t?t[2]:null;}var GT=/*#__PURE__*/function(_Dr173){function GT(){_classCallCheck(this,GT);return _callSuper(this,GT,arguments);}_inherits(GT,_Dr173);return _createClass(GT,null,[{key:"requires",get:function get(){return[LT,$T,jT];}},{key:"pluginName",get:function get(){return"Link";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var KT=/*#__PURE__*/function(_Dr174){function KT(){_classCallCheck(this,KT);return _callSuper(this,KT,arguments);}_inherits(KT,_Dr174);return _createClass(KT,[{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.model.schema;e.plugins.has("ImageBlockEditing")&&t.extend("imageBlock",{allowAttributes:["linkHref"]}),e.conversion["for"]("upcast").add(function(e){var t=e.plugins.has("ImageInlineEditing"),i=e.plugins.get("ImageUtils");return function(e){e.on("element:a",function(e,n,s){var o=n.viewItem,r=i.findViewImgElement(o);if(!r)return;var a=r.findAncestor(function(e){return i.isBlockImageView(e);});if(t&&!a)return;var l={attributes:["href"]};if(!s.consumable.consume(o,l))return;var c=o.getAttribute("href");if(!c)return;var d=n.modelCursor.parent;if(!d.is("element","imageBlock")){var _e615=s.convertItem(r,n.modelCursor);n.modelRange=_e615.modelRange,n.modelCursor=_e615.modelCursor,d=n.modelCursor.nodeBefore;}d&&d.is("element","imageBlock")&&s.writer.setAttribute("linkHref",c,d);},{priority:"high"});};}(e)),e.conversion["for"]("downcast").add(function(e){var t=e.plugins.get("ImageUtils");return function(e){e.on("attribute:linkHref:imageBlock",function(e,i,n){if(!n.consumable.consume(i.item,e.name))return;var s=n.mapper.toViewElement(i.item),o=n.writer,r=Array.from(s.getChildren()).find(function(e){return e.is("element","a");}),a=t.findViewImgElement(s),l=a.parent.is("element","picture")?a.parent:a;if(r)i.attributeNewValue?o.setAttribute("href",i.attributeNewValue,r):(o.move(o.createRangeOn(l),o.createPositionAt(s,0)),o.remove(r));else{var _e616=o.createContainerElement("a",{href:i.attributeNewValue});o.insert(o.createPositionAt(s,0),_e616),o.move(o.createRangeOn(l),o.createPositionAt(_e616,0));}},{priority:"high"});};}(e)),this._enableAutomaticDecorators(),this._enableManualDecorators();}},{key:"_enableAutomaticDecorators",value:function _enableAutomaticDecorators(){var e=this.editor,t=e.commands.get("link").automaticDecorators;t.length&&e.conversion["for"]("downcast").add(t.getDispatcherForLinkedImage());}},{key:"_enableManualDecorators",value:function _enableManualDecorators(){var e=this.editor,t=e.commands.get("link");var _iterator637=_createForOfIteratorHelper(t.manualDecorators),_step637;try{for(_iterator637.s();!(_step637=_iterator637.n()).done;){var _i467=_step637.value;e.plugins.has("ImageBlockEditing")&&e.model.schema.extend("imageBlock",{allowAttributes:_i467.id}),e.plugins.has("ImageInlineEditing")&&e.model.schema.extend("imageInline",{allowAttributes:_i467.id}),e.conversion["for"]("downcast").add(ZT(_i467)),e.conversion["for"]("upcast").add(JT(e,_i467));}}catch(err){_iterator637.e(err);}finally{_iterator637.f();}}}],[{key:"requires",get:function get(){return["ImageEditing","ImageUtils",LT];}},{key:"pluginName",get:function get(){return"LinkImageEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function ZT(e){return function(t){t.on("attribute:".concat(e.id,":imageBlock"),function(t,i,n){var s=n.mapper.toViewElement(i.item),o=Array.from(s.getChildren()).find(function(e){return e.is("element","a");});if(o){var _iterator638=_createForOfIteratorHelper(xr(e.attributes)),_step638;try{for(_iterator638.s();!(_step638=_iterator638.n()).done;){var _step638$value=_slicedToArray(_step638.value,2),_t422=_step638$value[0],_i468=_step638$value[1];n.writer.setAttribute(_t422,_i468,o);}}catch(err){_iterator638.e(err);}finally{_iterator638.f();}e.classes&&n.writer.addClass(e.classes,o);for(var _t421 in e.styles)n.writer.setStyle(_t421,e.styles[_t421],o);}});};}function JT(e,t){var i=e.plugins.has("ImageInlineEditing"),n=e.plugins.get("ImageUtils");return function(e){e.on("element:a",function(e,s,o){var r=s.viewItem,a=n.findViewImgElement(r);if(!a)return;var l=a.findAncestor(function(e){return n.isBlockImageView(e);});if(i&&!l)return;var c=new aa(t._createPattern()).match(r);if(!c)return;if(!o.consumable.consume(r,c.match))return;var d=s.modelCursor.nodeBefore||s.modelCursor.parent;o.writer.setAttribute(t.id,!0,d);},{priority:"high"});};}var QT=/*#__PURE__*/function(_Dr175){function QT(){_classCallCheck(this,QT);return _callSuper(this,QT,arguments);}_inherits(QT,_Dr175);return _createClass(QT,[{key:"init",value:function init(){var _this668=this;var e=this.editor,t=e.editing.view.document;this.listenTo(t,"click",function(t,i){_this668._isSelectedLinkedImage(e.model.document.selection)&&(i.preventDefault(),t.stop());},{priority:"high"}),this._createToolbarLinkImageButton();}},{key:"_createToolbarLinkImageButton",value:function _createToolbarLinkImageButton(){var _this669=this;var e=this.editor,t=e.t;e.ui.componentFactory.add("linkImage",function(i){var n=new pg(i),s=e.plugins.get("LinkUI"),o=e.commands.get("link");return n.set({isEnabled:!0,label:t("Link image"),icon:zT,keystroke:CT,tooltip:!0,isToggleable:!0}),n.bind("isEnabled").to(o,"isEnabled"),n.bind("isOn").to(o,"value",function(e){return!!e;}),_this669.listenTo(n,"execute",function(){_this669._isSelectedLinkedImage(e.model.document.selection)?s._addActionsView():s._showUI(!0);}),n;});}},{key:"_isSelectedLinkedImage",value:function _isSelectedLinkedImage(e){var t=e.getSelectedElement();return this.editor.plugins.get("ImageUtils").isImage(t)&&t.hasAttribute("linkHref");}}],[{key:"requires",get:function get(){return[LT,$T,"ImageBlockEditing"];}},{key:"pluginName",get:function get(){return"LinkImageUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var YT=/*#__PURE__*/function(_Dr176){function YT(){_classCallCheck(this,YT);return _callSuper(this,YT,arguments);}_inherits(YT,_Dr176);return _createClass(YT,null,[{key:"requires",get:function get(){return[KT,QT];}},{key:"pluginName",get:function get(){return"LinkImage";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var XT=/*#__PURE__*/function(){function XT(e,t){_classCallCheck(this,XT);_defineProperty(this,"_startElement",void 0);_defineProperty(this,"_referenceIndent",void 0);_defineProperty(this,"_isForward",void 0);_defineProperty(this,"_includeSelf",void 0);_defineProperty(this,"_sameAttributes",void 0);_defineProperty(this,"_sameIndent",void 0);_defineProperty(this,"_lowerIndent",void 0);_defineProperty(this,"_higherIndent",void 0);this._startElement=e,this._referenceIndent=e.getAttribute("listIndent"),this._isForward="forward"==t.direction,this._includeSelf=!!t.includeSelf,this._sameAttributes=gr(t.sameAttributes||[]),this._sameIndent=!!t.sameIndent,this._lowerIndent=!!t.lowerIndent,this._higherIndent=!!t.higherIndent;}return _createClass(XT,[{key:Symbol.iterator,value:/*#__PURE__*/_regeneratorRuntime().mark(function value(){var _this670=this;var e,_iterator639,_step639,_loop30,_ret4;return _regeneratorRuntime().wrap(function value$(_context59){while(1)switch(_context59.prev=_context59.next){case 0:e=[];_iterator639=_createForOfIteratorHelper(eP(this._getStartNode(),this._isForward?"forward":"backward"));_context59.prev=2;_loop30=/*#__PURE__*/_regeneratorRuntime().mark(function _loop30(){var t,i;return _regeneratorRuntime().wrap(function _loop30$(_context58){while(1)switch(_context58.prev=_context58.next){case 0:t=_step639.value.node;i=t.getAttribute("listIndent");if(!(i<_this670._referenceIndent)){_context58.next=8;break;}if(_this670._lowerIndent){_context58.next=5;break;}return _context58.abrupt("return",0);case 5:_this670._referenceIndent=i;_context58.next=26;break;case 8:if(!(i>_this670._referenceIndent)){_context58.next=16;break;}if(_this670._higherIndent){_context58.next=11;break;}return _context58.abrupt("return",1);case 11:if(_this670._isForward){_context58.next=14;break;}e.push(t);return _context58.abrupt("return",1);case 14:_context58.next=26;break;case 16:if(_this670._sameIndent){_context58.next=24;break;}if(!_this670._higherIndent){_context58.next=23;break;}_context58.t0=e.length;if(!_context58.t0){_context58.next=22;break;}return _context58.delegateYield(e,"t1",21);case 21:e.length=0;case 22:return _context58.abrupt("return",0);case 23:return _context58.abrupt("return",1);case 24:if(!_this670._sameAttributes.some(function(e){return t.getAttribute(e)!==_this670._startElement.getAttribute(e);})){_context58.next=26;break;}return _context58.abrupt("return",0);case 26:_context58.t2=e.length;if(!_context58.t2){_context58.next=30;break;}return _context58.delegateYield(e,"t3",29);case 29:e.length=0;case 30:_context58.next=32;return t;case 32:case"end":return _context58.stop();}},_loop30);});_iterator639.s();case 5:if((_step639=_iterator639.n()).done){_context59.next=14;break;}return _context59.delegateYield(_loop30(),"t0",7);case 7:_ret4=_context59.t0;if(!(_ret4===0)){_context59.next=10;break;}return _context59.abrupt("break",14);case 10:if(!(_ret4===1)){_context59.next=12;break;}return _context59.abrupt("continue",12);case 12:_context59.next=5;break;case 14:_context59.next=19;break;case 16:_context59.prev=16;_context59.t1=_context59["catch"](2);_iterator639.e(_context59.t1);case 19:_context59.prev=19;_iterator639.f();return _context59.finish(19);case 22:case"end":return _context59.stop();}},value,this,[[2,16,19,22]]);})},{key:"_getStartNode",value:function _getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling;}}],[{key:"first",value:function first(e,t){return wr(new this(e,t)[Symbol.iterator]());}}]);}();function eP(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"forward";return/*#__PURE__*/_regeneratorRuntime().mark(function _callee23(){var i,n,s,_t423,_i469,_o99;return _regeneratorRuntime().wrap(function _callee23$(_context60){while(1)switch(_context60.prev=_context60.next){case 0:i="forward"==t,n=[];s=null;case 2:if(!nP(e)){_context60.next=11;break;}_t423=null;if(s){_i469=e.getAttribute("listIndent"),_o99=s.getAttribute("listIndent");_i469>_o99?n[_o99]=s:_i469<_o99?(_t423=n[_i469],n.length=_i469):_t423=s;}_context60.next=7;return{node:e,previous:s,previousNodeInList:_t423};case 7:s=e;e=i?e.nextSibling:e.previousSibling;case 9:_context60.next=2;break;case 11:case"end":return _context60.stop();}},_callee23);})();}var tP=/*#__PURE__*/function(){function tP(e){_classCallCheck(this,tP);_defineProperty(this,"_listHead",void 0);this._listHead=e;}return _createClass(tP,[{key:Symbol.iterator,value:function value(){return eP(this._listHead,"forward");}}]);}();var iP=/*#__PURE__*/function(){function iP(){_classCallCheck(this,iP);}return _createClass(iP,null,[{key:"next",value:function next(){return k();}}]);}();function nP(e){return!!e&&e.is("element")&&e.hasAttribute("listItemId");}function sP(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return[].concat(_toConsumableArray(oP(e,_objectSpread(_objectSpread({},t),{},{direction:"backward"}))),_toConsumableArray(oP(e,_objectSpread(_objectSpread({},t),{},{direction:"forward"}))));}function oP(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i="forward"==t.direction,n=Array.from(new XT(e,_objectSpread(_objectSpread({},t),{},{includeSelf:i,sameIndent:!0,sameAttributes:"listItemId"})));return i?n:n.reverse();}function rP(e,t){var i=new XT(e,_objectSpread({sameIndent:!0,sameAttributes:"listType"},t)),n=new XT(e,_objectSpread({sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward"},t));return[].concat(_toConsumableArray(Array.from(i).reverse()),_toConsumableArray(n));}function aP(e){return!XT.first(e,{sameIndent:!0,sameAttributes:"listItemId"});}function lP(e){return!XT.first(e,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"});}function cP(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};e=gr(e);var i=!1!==t.withNested,n=new Set();var _iterator640=_createForOfIteratorHelper(e),_step640;try{for(_iterator640.s();!(_step640=_iterator640.n()).done;){var _t424=_step640.value;var _iterator641=_createForOfIteratorHelper(sP(_t424,{higherIndent:i})),_step641;try{for(_iterator641.s();!(_step641=_iterator641.n()).done;){var _e617=_step641.value;n.add(_e617);}}catch(err){_iterator641.e(err);}finally{_iterator641.f();}}}catch(err){_iterator640.e(err);}finally{_iterator640.f();}return pP(n);}function dP(e){e=gr(e);var t=new Set();var _iterator642=_createForOfIteratorHelper(e),_step642;try{for(_iterator642.s();!(_step642=_iterator642.n()).done;){var _i470=_step642.value;var _iterator643=_createForOfIteratorHelper(rP(_i470)),_step643;try{for(_iterator643.s();!(_step643=_iterator643.n()).done;){var _e618=_step643.value;t.add(_e618);}}catch(err){_iterator643.e(err);}finally{_iterator643.f();}}}catch(err){_iterator642.e(err);}finally{_iterator642.f();}return pP(t);}function uP(e,t){var i=oP(e,{direction:"forward"}),n=iP.next();var _iterator644=_createForOfIteratorHelper(i),_step644;try{for(_iterator644.s();!(_step644=_iterator644.n()).done;){var _e619=_step644.value;t.setAttribute("listItemId",n,_e619);}}catch(err){_iterator644.e(err);}finally{_iterator644.f();}return i;}function hP(e,t,i){var n={};var _iterator645=_createForOfIteratorHelper(t.getAttributes()),_step645;try{for(_iterator645.s();!(_step645=_iterator645.n()).done;){var _step645$value=_slicedToArray(_step645.value,2),_e620=_step645$value[0],_i471=_step645$value[1];_e620.startsWith("list")&&(n[_e620]=_i471);}}catch(err){_iterator645.e(err);}finally{_iterator645.f();}var s=oP(e,{direction:"forward"});var _iterator646=_createForOfIteratorHelper(s),_step646;try{for(_iterator646.s();!(_step646=_iterator646.n()).done;){var _e621=_step646.value;i.setAttributes(n,_e621);}}catch(err){_iterator646.e(err);}finally{_iterator646.f();}return s;}function mP(e,t){var _ref236=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},i=_ref236.expand,_ref236$indentBy=_ref236.indentBy,n=_ref236$indentBy===void 0?1:_ref236$indentBy;e=gr(e);var s=i?cP(e):e;var _iterator647=_createForOfIteratorHelper(s),_step647;try{for(_iterator647.s();!(_step647=_iterator647.n()).done;){var _e622=_step647.value;var _i472=_e622.getAttribute("listIndent")+n;_i472<0?gP(_e622,t):t.setAttribute("listIndent",_i472,_e622);}}catch(err){_iterator647.e(err);}finally{_iterator647.f();}return s;}function gP(e,t){e=gr(e);var _iterator648=_createForOfIteratorHelper(e),_step648;try{for(_iterator648.s();!(_step648=_iterator648.n()).done;){var _i473=_step648.value;_i473.is("element","listItem")&&t.rename(_i473,"paragraph");}}catch(err){_iterator648.e(err);}finally{_iterator648.f();}var _iterator649=_createForOfIteratorHelper(e),_step649;try{for(_iterator649.s();!(_step649=_iterator649.n()).done;){var _i474=_step649.value;var _iterator650=_createForOfIteratorHelper(_i474.getAttributeKeys()),_step650;try{for(_iterator650.s();!(_step650=_iterator650.n()).done;){var _e623=_step650.value;_e623.startsWith("list")&&t.removeAttribute(_e623,_i474);}}catch(err){_iterator650.e(err);}finally{_iterator650.f();}}}catch(err){_iterator649.e(err);}finally{_iterator649.f();}return e;}function fP(e){if(!e.length)return!1;var t=e[0].getAttribute("listItemId");return!!t&&!e.some(function(e){return e.getAttribute("listItemId")!=t;});}function pP(e){return Array.from(e).filter(function(e){return"$graveyard"!==e.root.rootName;}).sort(function(e,t){return e.index-t.index;});}function bP(e){var t=e.document.selection.getSelectedElement();return t&&e.schema.isObject(t)&&e.schema.isBlock(t)?t:null;}function wP(e,t){return t.checkChild(e.parent,"listItem")&&t.checkChild(e,"$text")&&!t.isObject(e);}function _P(e){return"numbered"==e||"customNumbered"==e;}function vP(e,t,i){return oP(t,{direction:"forward"}).pop().index>e.index?hP(e,t,i):[];}var yP=/*#__PURE__*/function(_Hr40){function yP(e,t){var _this671;_classCallCheck(this,yP);_this671=_callSuper(this,yP,[e]),_defineProperty(_assertThisInitialized(_this671),"_direction",void 0),_this671._direction=t;return _this671;}_inherits(yP,_Hr40);return _createClass(yP,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this672=this;var e=this.editor.model,t=kP(e.document.selection);e.change(function(e){var i=[];fP(t)&&!aP(t[0])?("forward"==_this672._direction&&i.push.apply(i,_toConsumableArray(mP(t,e))),i.push.apply(i,_toConsumableArray(uP(t[0],e)))):"forward"==_this672._direction?i.push.apply(i,_toConsumableArray(mP(t,e,{expand:!0}))):i.push.apply(i,_toConsumableArray(function(e,t){var i=cP(e=gr(e)),n=new Set(),s=Math.min.apply(Math,_toConsumableArray(i.map(function(e){return e.getAttribute("listIndent");}))),o=new Map();var _iterator651=_createForOfIteratorHelper(i),_step651;try{for(_iterator651.s();!(_step651=_iterator651.n()).done;){var _e624=_step651.value;o.set(_e624,XT.first(_e624,{lowerIndent:!0}));}}catch(err){_iterator651.e(err);}finally{_iterator651.f();}var _iterator652=_createForOfIteratorHelper(i),_step652;try{for(_iterator652.s();!(_step652=_iterator652.n()).done;){var _e625=_step652.value;if(n.has(_e625))continue;n.add(_e625);var _i475=_e625.getAttribute("listIndent")-1;if(_i475<0)gP(_e625,t);else{if(_e625.getAttribute("listIndent")==s){var _i476=vP(_e625,o.get(_e625),t);var _iterator653=_createForOfIteratorHelper(_i476),_step653;try{for(_iterator653.s();!(_step653=_iterator653.n()).done;){var _e626=_step653.value;n.add(_e626);}}catch(err){_iterator653.e(err);}finally{_iterator653.f();}if(_i476.length)continue;}t.setAttribute("listIndent",_i475,_e625);}}}catch(err){_iterator652.e(err);}finally{_iterator652.f();}return pP(n);}(t,e)));for(var _i478=0,_i477=i;_i478<_i477.length;_i478++){var _t425=_i477[_i478];if(!_t425.hasAttribute("listType"))continue;var _i479=XT.first(_t425,{sameIndent:!0});_i479&&e.setAttribute("listType",_i479.getAttribute("listType"),_t425);}_this672._fireAfterExecute(i);});}},{key:"_fireAfterExecute",value:function _fireAfterExecute(e){this.fire("afterExecute",pP(new Set(e)));}},{key:"_checkEnabled",value:function _checkEnabled(){var e=kP(this.editor.model.document.selection),t=e[0];if(!t)return!1;if("backward"==this._direction)return!0;if(fP(e)&&!aP(e[0]))return!0;e=cP(e),t=e[0];var i=XT.first(t,{sameIndent:!0});return!!i&&i.getAttribute("listType")==t.getAttribute("listType");}}]);}(Hr);function kP(e){var t=Array.from(e.getSelectedBlocks()),i=t.findIndex(function(e){return!nP(e);});return-1!=i&&(t.length=i),t;}var CP=/*#__PURE__*/function(_Hr41){function CP(e,t){var _this673;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};_classCallCheck(this,CP);_this673=_callSuper(this,CP,[e]),_defineProperty(_assertThisInitialized(_this673),"type",void 0),_defineProperty(_assertThisInitialized(_this673),"_listWalkerOptions",void 0),_this673.type=t,_this673._listWalkerOptions=i.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0;return _this673;}_inherits(CP,_Hr41);return _createClass(CP,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this674=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document,n=bP(t),s=Array.from(i.selection.getSelectedBlocks()).filter(function(e){return t.schema.checkAttribute(e,"listType")||wP(e,t.schema);}),o=void 0!==e.forceValue?!e.forceValue:this.value;t.change(function(r){if(o){var _e627=s[s.length-1],_t426=oP(_e627,{direction:"forward"}),_i480=[];_t426.length>1&&_i480.push.apply(_i480,_toConsumableArray(uP(_t426[1],r))),_i480.push.apply(_i480,_toConsumableArray(gP(s,r))),_i480.push.apply(_i480,_toConsumableArray(function(e,t){var i=[];var n=Number.POSITIVE_INFINITY;var _iterator654=_createForOfIteratorHelper(eP(e.nextSibling,"forward")),_step654;try{for(_iterator654.s();!(_step654=_iterator654.n()).done;){var _s175=_step654.value.node;var _e628=_s175.getAttribute("listIndent");if(0==_e628)break;_e628<n&&(n=_e628);var _o100=_e628-n;t.setAttribute("listIndent",_o100,_s175),i.push(_s175);}}catch(err){_iterator654.e(err);}finally{_iterator654.f();}return i;}(_e627,r))),_this674._fireAfterExecute(_i480);}else if((n||i.selection.isCollapsed)&&nP(s[0])){var _t427=rP(n||s[0],_this674._listWalkerOptions);var _iterator655=_createForOfIteratorHelper(_t427),_step655;try{for(_iterator655.s();!(_step655=_iterator655.n()).done;){var _i481=_step655.value;r.setAttributes(_objectSpread(_objectSpread({},e.additionalAttributes),{},{listType:_this674.type}),_i481);}}catch(err){_iterator655.e(err);}finally{_iterator655.f();}_this674._fireAfterExecute(_t427);}else{var _i482=[];var _iterator656=_createForOfIteratorHelper(s),_step656;try{for(_iterator656.s();!(_step656=_iterator656.n()).done;){var _n251=_step656.value;if(_n251.hasAttribute("listType")){var _iterator657=_createForOfIteratorHelper(cP(_n251,{withNested:!1})),_step657;try{for(_iterator657.s();!(_step657=_iterator657.n()).done;){var _t428=_step657.value;_t428.getAttribute("listType")!=_this674.type&&(r.setAttributes(_objectSpread(_objectSpread({},e.additionalAttributes),{},{listType:_this674.type}),_t428),_i482.push(_t428));}}catch(err){_iterator657.e(err);}finally{_iterator657.f();}}else!_n251.is("element","listItem")&&wP(_n251,t.schema)&&r.rename(_n251,"listItem"),r.setAttributes(_objectSpread(_objectSpread({},e.additionalAttributes),{},{listIndent:0,listItemId:iP.next(),listType:_this674.type}),_n251),_i482.push(_n251);}}catch(err){_iterator656.e(err);}finally{_iterator656.f();}_this674._fireAfterExecute(_i482);}});}},{key:"_fireAfterExecute",value:function _fireAfterExecute(e){this.fire("afterExecute",pP(new Set(e)));}},{key:"_getValue",value:function _getValue(){var e=this.editor.model.document.selection,t=Array.from(e.getSelectedBlocks());if(!t.length)return!1;for(var _i483=0,_t429=t;_i483<_t429.length;_i483++){var _e629=_t429[_i483];if(_e629.getAttribute("listType")!=this.type)return!1;}return!0;}},{key:"_checkEnabled",value:function _checkEnabled(){var e=this.editor.model,t=e.schema,i=e.document.selection,n=Array.from(i.getSelectedBlocks());if(!n.length)return!1;if(this.value)return!0;for(var _i484=0,_n252=n;_i484<_n252.length;_i484++){var _e630=_n252[_i484];if(t.checkAttribute(_e630,"listType")||wP(_e630,t))return!0;}return!1;}}]);}(Hr);var xP=/*#__PURE__*/function(_Hr42){function xP(e,t){var _this675;_classCallCheck(this,xP);_this675=_callSuper(this,xP,[e]),_defineProperty(_assertThisInitialized(_this675),"_direction",void 0),_this675._direction=t;return _this675;}_inherits(xP,_Hr42);return _createClass(xP,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this676=this;var _ref237=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref237$shouldMergeOn=_ref237.shouldMergeOnBlocksContentLevel,e=_ref237$shouldMergeOn===void 0?!1:_ref237$shouldMergeOn;var t=this.editor.model,i=t.document.selection,n=[];t.change(function(s){var _this676$_getMergeSub=_this676._getMergeSubjectElements(i,e),o=_this676$_getMergeSub.firstElement,r=_this676$_getMergeSub.lastElement,a=o.getAttribute("listIndent")||0,l=r.getAttribute("listIndent"),c=r.getAttribute("listItemId");if(a!=l){var _e631=(d=r,Array.from(new XT(d,{direction:"forward",higherIndent:!0})));n.push.apply(n,_toConsumableArray(mP([r].concat(_e631),s,{indentBy:a-l,expand:a<l})));}var d;if(e){var _e632=i;i.isCollapsed&&(_e632=s.createSelection(s.createRange(s.createPositionAt(o,"end"),s.createPositionAt(r,0)))),t.deleteContent(_e632,{doNotResetEntireContent:i.isCollapsed});var _a29=_e632.getLastPosition().parent,_l19=_a29.nextSibling;n.push(_a29),_l19&&_l19!==r&&_l19.getAttribute("listItemId")==c&&n.push.apply(n,_toConsumableArray(hP(_l19,_a29,s)));}else n.push.apply(n,_toConsumableArray(hP(r,o,s)));_this676._fireAfterExecute(n);});}},{key:"_fireAfterExecute",value:function _fireAfterExecute(e){this.fire("afterExecute",pP(new Set(e)));}},{key:"_checkEnabled",value:function _checkEnabled(){var e=this.editor.model,t=e.document.selection,i=bP(e);if(t.isCollapsed||i){var _e633=i||t.getFirstPosition().parent;if(!nP(_e633))return!1;var _n253="backward"==this._direction?_e633.previousSibling:_e633.nextSibling;if(!_n253)return!1;if(fP([_e633,_n253]))return!1;}else{var _e634=t.getLastPosition(),_i485=t.getFirstPosition();if(_e634.parent===_i485.parent)return!1;if(!nP(_e634.parent))return!1;}return!0;}},{key:"_getMergeSubjectElements",value:function _getMergeSubjectElements(e,t){var i=bP(this.editor.model);var n,s;if(e.isCollapsed||i){var _o101=i||e.getFirstPosition().parent,r=aP(_o101);"backward"==this._direction?(s=_o101,n=r&&!t?XT.first(_o101,{sameIndent:!0,lowerIndent:!0}):_o101.previousSibling):(n=_o101,s=_o101.nextSibling);}else n=e.getFirstPosition().parent,s=e.getLastPosition().parent;return{firstElement:n,lastElement:s};}}]);}(Hr);var AP=/*#__PURE__*/function(_Hr43){function AP(e,t){var _this677;_classCallCheck(this,AP);_this677=_callSuper(this,AP,[e]),_defineProperty(_assertThisInitialized(_this677),"_direction",void 0),_this677._direction=t;return _this677;}_inherits(AP,_Hr43);return _createClass(AP,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this678=this;this.editor.model.change(function(e){var t=uP(_this678._getStartBlock(),e);_this678._fireAfterExecute(t);});}},{key:"_fireAfterExecute",value:function _fireAfterExecute(e){this.fire("afterExecute",pP(new Set(e)));}},{key:"_checkEnabled",value:function _checkEnabled(){var e=this.editor.model.document.selection,t=this._getStartBlock();return e.isCollapsed&&nP(t)&&!aP(t);}},{key:"_getStartBlock",value:function _getStartBlock(){var e=this.editor.model.document.selection.getFirstPosition().parent;return"before"==this._direction?e:e.nextSibling;}}]);}(Hr);var EP=/*#__PURE__*/function(_Dr177){function EP(){_classCallCheck(this,EP);return _callSuper(this,EP,arguments);}_inherits(EP,_Dr177);return _createClass(EP,[{key:"expandListBlocksToCompleteList",value:function expandListBlocksToCompleteList(e){return dP(e);}},{key:"isFirstBlockOfListItem",value:function isFirstBlockOfListItem(e){return aP(e);}},{key:"isListItemBlock",value:function isListItemBlock(e){return nP(e);}},{key:"expandListBlocksToCompleteItems",value:function expandListBlocksToCompleteItems(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return cP(e,t);}},{key:"isNumberedListType",value:function isNumberedListType(e){return _P(e);}}],[{key:"pluginName",get:function get(){return"ListUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function TP(e){return e.is("element","ol")||e.is("element","ul");}function PP(e){return e.is("element","li");}function SP(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:RP(i,t);return e.createAttributeElement(VP(i),null,{priority:2*t/100-100,id:n});}function IP(e,t,i){return e.createAttributeElement("li",null,{priority:(2*t+1)/100-100,id:i});}function VP(e){return"numbered"==e||"customNumbered"==e?"ol":"ul";}function RP(e,t){return"list-".concat(e,"-").concat(t);}function OP(e,t){var i=e.nodeBefore;if(nP(i)){var _e635=i;var _iterator658=_createForOfIteratorHelper(eP(_e635,"backward")),_step658;try{for(_iterator658.s();!(_step658=_iterator658.n()).done;){var _i486=_step658.value.node;if(_e635=_i486,t.has(_e635))return;}}catch(err){_iterator658.e(err);}finally{_iterator658.f();}t.set(i,_e635);}else{var _i487=e.nodeAfter;nP(_i487)&&t.set(_i487,_i487);}}function BP(){return function(e,t,i){var n=i.writer,s=i.schema;if(!t.modelRange)return;var o=Array.from(t.modelRange.getItems({shallow:!0})).filter(function(e){return s.checkAttribute(e,"listItemId");});if(!o.length)return;var r=iP.next(),a=function(e){var t=0,i=e.parent;for(;i;){if(PP(i))t++;else{var _e636=i.previousSibling;_e636&&PP(_e636)&&t++;}i=i.parent;}return t;}(t.viewItem);var l=t.viewItem.parent&&t.viewItem.parent.is("element","ol")?"numbered":"bulleted";var c=o[0].getAttribute("listType");c&&(l=c);var d={listItemId:r,listIndent:a,listType:l};var _iterator659=_createForOfIteratorHelper(o),_step659;try{for(_iterator659.s();!(_step659=_iterator659.n()).done;){var _e637=_step659.value;_e637.hasAttribute("listItemId")||n.setAttributes(d,_e637);}}catch(err){_iterator659.e(err);}finally{_iterator659.f();}o.length>1&&o[1].getAttribute("listItemId")!=d.listItemId&&i.keepEmptyElement(o[0]);};}function MP(e,t,i){var _ref238=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},n=_ref238.dataPipeline;var s=function(e){return function(t,i){var n=[];var _iterator660=_createForOfIteratorHelper(e),_step660;try{for(_iterator660.s();!(_step660=_iterator660.n()).done;){var _i488=_step660.value;t.hasAttribute(_i488)&&n.push("attribute:".concat(_i488));}}catch(err){_iterator660.e(err);}finally{_iterator660.f();}return!!n.every(function(e){return!1!==i.test(t,e);})&&(n.forEach(function(e){return i.consume(t,e);}),!0);};}(e);return function(o,r,a){var l=a.writer,c=a.mapper,d=a.consumable,u=r.item;if(!e.includes(r.attributeKey))return;if(!s(u,d))return;var h=function(e,t,i){var n=i.createRangeOn(e),s=t.toViewRange(n).getTrimmed();return s.end.nodeBefore;}(u,c,i);FP(h,l,c),function(e,t){var i=e.parent;for(;i.is("attributeElement")&&["ul","ol","li"].includes(i.name);){var _n254=i.parent;t.unwrap(t.createRangeOn(e),i),i=_n254;}}(h,l);var m=function(e,t,i,n,_ref239){var s=_ref239.dataPipeline;var o=n.createRangeOn(t);if(!aP(e))return o;var _iterator661=_createForOfIteratorHelper(i),_step661;try{for(_iterator661.s();!(_step661=_iterator661.n()).done;){var _r48=_step661.value;if("itemMarker"!=_r48.scope)continue;var _i489=_r48.createElement(n,e,{dataPipeline:s});if(!_i489)continue;if(n.setCustomProperty("listItemMarker",!0,_i489),_r48.canInjectMarkerIntoElement&&_r48.canInjectMarkerIntoElement(e)?n.insert(n.createPositionAt(t,0),_i489):(n.insert(o.start,_i489),o=n.createRange(n.createPositionBefore(_i489),n.createPositionAfter(t))),!_r48.createWrapperElement||!_r48.canWrapElement)continue;var _a30=_r48.createWrapperElement(n,e,{dataPipeline:s});n.setCustomProperty("listItemWrapper",!0,_a30),_r48.canWrapElement(e)?o=n.wrap(o,_a30):(o=n.wrap(n.createRangeOn(_i489),_a30),o=n.createRange(o.start,n.createPositionAfter(t)));}}catch(err){_iterator661.e(err);}finally{_iterator661.f();}return o;}(u,h,t,l,{dataPipeline:n});!function(e,t,i,n){if(!e.hasAttribute("listIndent"))return;var s=e.getAttribute("listIndent");var o=e;for(var _e638=s;_e638>=0;_e638--){var _s176=IP(n,_e638,o.getAttribute("listItemId")),_r49=SP(n,_e638,o.getAttribute("listType"));var _iterator662=_createForOfIteratorHelper(i),_step662;try{for(_iterator662.s();!(_step662=_iterator662.n()).done;){var _e639=_step662.value;"list"!=_e639.scope&&"item"!=_e639.scope||!o.hasAttribute(_e639.attributeName)||_e639.setAttributeOnDowncast(n,o.getAttribute(_e639.attributeName),"list"==_e639.scope?_r49:_s176);}}catch(err){_iterator662.e(err);}finally{_iterator662.f();}if(t=n.wrap(t,_s176),t=n.wrap(t,_r49),0==_e638)break;if(o=XT.first(o,{lowerIndent:!0}),!o)break;}}(u,m,t,l);};}function LP(e){var _ref240=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{},t=_ref240.dataPipeline;return function(i,_ref241){var n=_ref241.writer;if(!NP(i,e))return null;if(!t)return n.createContainerElement("span",{"class":"ck-list-bogus-paragraph"});var s=n.createContainerElement("p");return n.setCustomProperty("dataPipeline:transparentRendering",!0,s),s;};}function FP(e,t,i){for(;e.parent.is("attributeElement")&&e.parent.getCustomProperty("listItemWrapper");)t.unwrap(t.createRangeOn(e),e.parent);var n=[];s(t.createPositionBefore(e).getWalker({direction:"backward"})),s(t.createRangeIn(e).getWalker());for(var _i490=0,_n255=n;_i490<_n255.length;_i490++){var _e640=_n255[_i490];t.remove(_e640);}function s(e){var _iterator663=_createForOfIteratorHelper(e),_step663;try{for(_iterator663.s();!(_step663=_iterator663.n()).done;){var _t430=_step663.value.item;if(_t430.is("element")&&i.toModelElement(_t430))break;_t430.is("element")&&_t430.getCustomProperty("listItemMarker")&&n.push(_t430);}}catch(err){_iterator663.e(err);}finally{_iterator663.f();}}}function NP(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:sP(e);if(!nP(e))return!1;var _iterator664=_createForOfIteratorHelper(e.getAttributeKeys()),_step664;try{for(_iterator664.s();!(_step664=_iterator664.n()).done;){var _i491=_step664.value;if(!_i491.startsWith("selection:")&&!t.includes(_i491))return!1;}}catch(err){_iterator664.e(err);}finally{_iterator664.f();}return i.length<2;}var DP=["listType","listIndent","listItemId"];var zP=/*#__PURE__*/function(_Dr178){function zP(e){var _this679;_classCallCheck(this,zP);_this679=_callSuper(this,zP,[e]),_defineProperty(_assertThisInitialized(_this679),"_downcastStrategies",[]),e.config.define("list.multiBlock",!0);return _this679;}_inherits(zP,_Dr178);return _createClass(zP,[{key:"init",value:function init(){var e=this.editor,t=e.model,i=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new A("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});t.schema.register("$listItem",{allowAttributes:DP}),i?(t.schema.extend("$container",{allowAttributesOf:"$listItem"}),t.schema.extend("$block",{allowAttributesOf:"$listItem"}),t.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):t.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"});for(var _i492=0,_DP=DP;_i492<_DP.length;_i492++){var _e641=_DP[_i492];t.schema.setAttributeProperties(_e641,{copyOnReplace:!0});}e.commands.add("numberedList",new CP(e,"numbered")),e.commands.add("bulletedList",new CP(e,"bulleted")),e.commands.add("customNumberedList",new CP(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new CP(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new yP(e,"forward")),e.commands.add("outdentList",new yP(e,"backward")),e.commands.add("splitListItemBefore",new AP(e,"before")),e.commands.add("splitListItemAfter",new AP(e,"after")),i&&(e.commands.add("mergeListItemBackward",new xP(e,"backward")),e.commands.add("mergeListItemForward",new xP(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration();}},{key:"afterInit",value:function afterInit(){var e=this.editor.commands,t=e.get("indent"),i=e.get("outdent");t&&t.registerChildCommand(e.get("indentList"),{priority:"high"}),i&&i.registerChildCommand(e.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion();}},{key:"registerDowncastStrategy",value:function registerDowncastStrategy(e){this._downcastStrategies.push(e);}},{key:"getListAttributeNames",value:function getListAttributeNames(){return[].concat(DP,_toConsumableArray(this._downcastStrategies.map(function(e){return e.attributeName;})));}},{key:"_setupDeleteIntegration",value:function _setupDeleteIntegration(){var e=this.editor,t=e.commands.get("mergeListItemBackward"),i=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",function(n,s){var o=e.model.document.selection;bP(e.model)||e.model.change(function(){var r=o.getFirstPosition();if(o.isCollapsed&&"backward"==s.direction){if(!r.isAtStart)return;var _i493=r.parent;if(!nP(_i493))return;if(XT.first(_i493,{sameAttributes:"listType",sameIndent:!0})||0!==_i493.getAttribute("listIndent")){if(!t||!t.isEnabled)return;t.execute({shouldMergeOnBlocksContentLevel:HP(e.model,"backward")});}else lP(_i493)||e.execute("splitListItemAfter"),e.execute("outdentList");s.preventDefault(),n.stop();}else{if(o.isCollapsed&&!o.getLastPosition().isAtEnd)return;if(!i||!i.isEnabled)return;i.execute({shouldMergeOnBlocksContentLevel:HP(e.model,"forward")}),s.preventDefault(),n.stop();}});},{context:"li"});}},{key:"_setupEnterIntegration",value:function _setupEnterIntegration(){var e=this.editor,t=e.model,i=e.commands,n=i.get("enter");this.listenTo(e.editing.view.document,"enter",function(i,n){var s=t.document,o=s.selection.getFirstPosition().parent;if(s.selection.isCollapsed&&nP(o)&&o.isEmpty&&!n.isSoft){var _t431=aP(o),_s177=lP(o);_t431&&_s177?(e.execute("outdentList"),n.preventDefault(),i.stop()):_t431&&!_s177?(e.execute("splitListItemAfter"),n.preventDefault(),i.stop()):_s177&&(e.execute("splitListItemBefore"),n.preventDefault(),i.stop());}},{context:"li"}),this.listenTo(n,"afterExecute",function(){var t=i.get("splitListItemBefore");if(t.refresh(),!t.isEnabled)return;2===sP(e.model.document.selection.getLastPosition().parent).length&&t.execute();});}},{key:"_setupTabIntegration",value:function _setupTabIntegration(){var _this680=this;var e=this.editor;this.listenTo(e.editing.view.document,"tab",function(t,i){var n=i.shiftKey?"outdentList":"indentList";_this680.editor.commands.get(n).isEnabled&&(e.execute(n),i.stopPropagation(),i.preventDefault(),t.stop());},{context:"li"});}},{key:"_setupConversion",value:function _setupConversion(){var _this681=this;var e=this.editor,t=e.model,i=this.getListAttributeNames(),n=e.config.get("list.multiBlock"),s=n?"paragraph":"listItem";e.conversion["for"]("upcast").elementToElement({view:"li",model:function model(e,_ref242){var t=_ref242.writer;return t.createElement(s,{listType:""});}}).elementToElement({view:"p",model:function model(e,_ref243){var t=_ref243.writer;return e.parent&&e.parent.is("element","li")?t.createElement(s,{listType:""}):null;},converterPriority:"high"}).add(function(e){e.on("element:li",BP());}),n||e.conversion["for"]("downcast").elementToElement({model:"listItem",view:"p"}),e.conversion["for"]("editingDowncast").elementToElement({model:s,view:LP(i),converterPriority:"high"}).add(function(e){var n;e.on("attribute",MP(i,_this681._downcastStrategies,t)),e.on("remove",(n=t.schema,function(e,t,i){var s=i.writer,o=i.mapper,r=e.name.split(":")[1];if(!n.checkAttribute(r,"listItemId"))return;var a=o.toViewPosition(t.position),l=t.position.getShiftedBy(t.length),c=o.toViewPosition(l,{isPhantom:!0}),d=s.createRange(a,c).getTrimmed().end.nodeBefore;d&&FP(d,s,o);}));}),e.conversion["for"]("dataDowncast").elementToElement({model:s,view:LP(i,{dataPipeline:!0}),converterPriority:"high"}).add(function(e){e.on("attribute",MP(i,_this681._downcastStrategies,t,{dataPipeline:!0}));});var o=(r=this._downcastStrategies,a=e.editing.view,function(e,t){if(t.modelPosition.offset>0)return;var i=t.modelPosition.parent;if(!nP(i))return;if(!r.some(function(e){return"itemMarker"==e.scope&&e.canInjectMarkerIntoElement&&e.canInjectMarkerIntoElement(i);}))return;var n=t.mapper.toViewElement(i),s=a.createRangeIn(n),o=s.getWalker();var l=s.start;var _iterator665=_createForOfIteratorHelper(o),_step665;try{for(_iterator665.s();!(_step665=_iterator665.n()).done;){var _e642=_step665.value.item;if(_e642.is("element")&&t.mapper.toModelElement(_e642)||_e642.is("$textProxy"))break;_e642.is("element")&&_e642.getCustomProperty("listItemMarker")&&(l=a.createPositionAfter(_e642),o.skip(function(_ref244){var e=_ref244.previousPosition;return!e.isEqual(l);}));}}catch(err){_iterator665.e(err);}finally{_iterator665.f();}t.viewPosition=l;});var r,a;e.editing.mapper.on("modelToViewPosition",o),e.data.mapper.on("modelToViewPosition",o),this.listenTo(t.document,"change:data",function(e,t,i,n){return function(){var n=e.document.differ.getChanges(),r=[],a=new Map(),l=new Set();var _iterator666=_createForOfIteratorHelper(n),_step666;try{for(_iterator666.s();!(_step666=_iterator666.n()).done;){var _e643=_step666.value;if("insert"==_e643.type&&"$text"!=_e643.name)OP(_e643.position,a),_e643.attributes.has("listItemId")?l.add(_e643.position.nodeAfter):OP(_e643.position.getShiftedBy(_e643.length),a);else if("remove"==_e643.type&&_e643.attributes.has("listItemId"))OP(_e643.position,a);else if("attribute"==_e643.type){var _t432=_e643.range.start.nodeAfter;i.includes(_e643.attributeKey)?(OP(_e643.range.start,a),null===_e643.attributeNewValue?(OP(_e643.range.start.getShiftedBy(1),a),o(_t432)&&r.push(_t432)):l.add(_t432)):nP(_t432)&&o(_t432)&&r.push(_t432);}}}catch(err){_iterator666.e(err);}finally{_iterator666.f();}var _iterator667=_createForOfIteratorHelper(a.values()),_step667;try{for(_iterator667.s();!(_step667=_iterator667.n()).done;){var _e644=_step667.value;r.push.apply(r,_toConsumableArray(s(_e644,l)));}}catch(err){_iterator667.e(err);}finally{_iterator667.f();}var _iterator668=_createForOfIteratorHelper(new Set(r)),_step668;try{for(_iterator668.s();!(_step668=_iterator668.n()).done;){var _e645=_step668.value;t.reconvertItem(_e645);}}catch(err){_iterator668.e(err);}finally{_iterator668.f();}};function s(e,t){var n=[],s=new Set(),a=[];var _iterator669=_createForOfIteratorHelper(eP(e,"forward")),_step669;try{for(_iterator669.s();!(_step669=_iterator669.n()).done;){var _step669$value=_step669.value,_l20=_step669$value.node,_c16=_step669$value.previous;if(s.has(_l20))continue;var _e646=_l20.getAttribute("listIndent");_c16&&_e646<_c16.getAttribute("listIndent")&&(a.length=_e646+1),a[_e646]=Object.fromEntries(Array.from(_l20.getAttributes()).filter(function(_ref245){var _ref246=_slicedToArray(_ref245,1),e=_ref246[0];return i.includes(e);}));var _d7=oP(_l20,{direction:"forward"});var _iterator670=_createForOfIteratorHelper(_d7),_step670;try{for(_iterator670.s();!(_step670=_iterator670.n()).done;){var _e647=_step670.value;s.add(_e647),(o(_e647,_d7)||r(_e647,a,t))&&n.push(_e647);}}catch(err){_iterator670.e(err);}finally{_iterator670.f();}}}catch(err){_iterator669.e(err);}finally{_iterator669.f();}return n;}function o(e,s){var o=t.mapper.toViewElement(e);if(!o)return!1;if(n.fire("checkElement",{modelElement:e,viewElement:o}))return!0;if(!e.is("element","paragraph")&&!e.is("element","listItem"))return!1;var r=NP(e,i,s);return!(!r||!o.is("element","p"))||!(r||!o.is("element","span"));}function r(e,i,s){if(s.has(e))return!1;var o=t.mapper.toViewElement(e);var r=i.length-1;for(var _e648=o.parent;!_e648.is("editableElement");_e648=_e648.parent){var _t433=PP(_e648),_s178=TP(_e648);if(!_s178&&!_t433)continue;var _o102="checkAttributes:"+(_t433?"item":"list");if(n.fire(_o102,{viewElement:_e648,modelAttributes:i[r]}))break;if(_s178&&(r--,r<0))return!1;}return!0;}}(t,e.editing,i,this),{priority:"high"}),this.on("checkAttributes:item",function(e,_ref247){var t=_ref247.viewElement,i=_ref247.modelAttributes;t.id!=i.listItemId&&(e["return"]=!0,e.stop());}),this.on("checkAttributes:list",function(e,_ref248){var t=_ref248.viewElement,i=_ref248.modelAttributes;t.name==VP(i.listType)&&t.id==RP(i.listType,i.listIndent)||(e["return"]=!0,e.stop());});}},{key:"_setupModelPostFixing",value:function _setupModelPostFixing(){var _this682=this;var e=this.editor.model,t=this.getListAttributeNames();e.document.registerPostFixer(function(i){return function(e,t,i,n){var s=e.document.differ.getChanges(),o=new Map(),r=n.editor.config.get("list.multiBlock");var a=!1;var _iterator671=_createForOfIteratorHelper(s),_step671;try{for(_iterator671.s();!(_step671=_iterator671.n()).done;){var _n256=_step671.value;if("insert"==_n256.type&&"$text"!=_n256.name){var _s179=_n256.position.nodeAfter;if(!e.schema.checkAttribute(_s179,"listItemId"))for(var _i494=0,_Array$from9=Array.from(_s179.getAttributeKeys());_i494<_Array$from9.length;_i494++){var _e649=_Array$from9[_i494];i.includes(_e649)&&(t.removeAttribute(_e649,_s179),a=!0);}OP(_n256.position,o),_n256.attributes.has("listItemId")||OP(_n256.position.getShiftedBy(_n256.length),o);var _iterator673=_createForOfIteratorHelper(e.createRangeIn(_s179)),_step673;try{for(_iterator673.s();!(_step673=_iterator673.n()).done;){var _step673$value=_step673.value,_t434=_step673$value.item,_i495=_step673$value.previousPosition;nP(_t434)&&OP(_i495,o);}}catch(err){_iterator673.e(err);}finally{_iterator673.f();}}else"remove"==_n256.type?OP(_n256.position,o):"attribute"==_n256.type&&i.includes(_n256.attributeKey)&&(OP(_n256.range.start,o),null===_n256.attributeNewValue&&OP(_n256.range.start.getShiftedBy(1),o));if(!r&&"attribute"==_n256.type&&DP.includes(_n256.attributeKey)){var _e650=_n256.range.start.nodeAfter;null===_n256.attributeNewValue&&_e650&&_e650.is("element","listItem")?(t.rename(_e650,"paragraph"),a=!0):null===_n256.attributeOldValue&&_e650&&_e650.is("element")&&"listItem"!=_e650.name&&(t.rename(_e650,"listItem"),a=!0);}}}catch(err){_iterator671.e(err);}finally{_iterator671.f();}var l=new Set();var _iterator672=_createForOfIteratorHelper(o.values()),_step672;try{for(_iterator672.s();!(_step672=_iterator672.n()).done;){var _e651=_step672.value;a=n.fire("postFixer",{listNodes:new tP(_e651),listHead:_e651,writer:t,seenIds:l})||a;}}catch(err){_iterator672.e(err);}finally{_iterator672.f();}return a;}(e,i,t,_this682);}),this.on("postFixer",function(e,_ref249){var t=_ref249.listNodes,i=_ref249.writer;e["return"]=function(e,t){var i=0,n=-1,s=null,o=!1;var _iterator674=_createForOfIteratorHelper(e),_step674;try{for(_iterator674.s();!(_step674=_iterator674.n()).done;){var r=_step674.value.node;var _e652=r.getAttribute("listIndent");if(_e652>i){var _a31=void 0;null===s?(s=_e652-i,_a31=i):(s>_e652&&(s=_e652),_a31=_e652-s),_a31>n+1&&(_a31=n+1),t.setAttribute("listIndent",_a31,r),o=!0,n=_a31;}else s=null,i=_e652+1,n=_e652;}}catch(err){_iterator674.e(err);}finally{_iterator674.f();}return o;}(t,i)||e["return"];},{priority:"high"}),this.on("postFixer",function(e,_ref250){var t=_ref250.listNodes,i=_ref250.writer,n=_ref250.seenIds;e["return"]=function(e,t,i){var n=new Set();var s=!1;var _iterator675=_createForOfIteratorHelper(e),_step675;try{for(_iterator675.s();!(_step675=_iterator675.n()).done;){var _o103=_step675.value.node;if(n.has(_o103))continue;var _e653=_o103.getAttribute("listType"),r=_o103.getAttribute("listItemId");if(t.has(r)&&(r=iP.next()),t.add(r),_o103.is("element","listItem"))_o103.getAttribute("listItemId")!=r&&(i.setAttribute("listItemId",r,_o103),s=!0);else{var _iterator676=_createForOfIteratorHelper(oP(_o103,{direction:"forward"})),_step676;try{for(_iterator676.s();!(_step676=_iterator676.n()).done;){var _t435=_step676.value;n.add(_t435),_t435.getAttribute("listType")!=_e653&&(r=iP.next(),_e653=_t435.getAttribute("listType")),_t435.getAttribute("listItemId")!=r&&(i.setAttribute("listItemId",r,_t435),s=!0);}}catch(err){_iterator676.e(err);}finally{_iterator676.f();}}}}catch(err){_iterator675.e(err);}finally{_iterator675.f();}return s;}(t,n,i)||e["return"];},{priority:"high"});}},{key:"_setupClipboardIntegration",value:function _setupClipboardIntegration(){var e=this.editor.model,t=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",function(e){return function(t,_ref251){var _ref252=_slicedToArray(_ref251,2),i=_ref252[0],n=_ref252[1];var s=i.is("documentFragment")?Array.from(i.getChildren()):[i];if(!s.length)return;var o=(n?e.createSelection(n):e.document.selection).getFirstPosition();var r;if(nP(o.parent))r=o.parent;else{if(!nP(o.nodeBefore))return;r=o.nodeBefore;}e.change(function(e){var t=r.getAttribute("listType"),i=r.getAttribute("listIndent"),n=s[0].getAttribute("listIndent")||0,o=Math.max(i-n,0);var _iterator677=_createForOfIteratorHelper(s),_step677;try{for(_iterator677.s();!(_step677=_iterator677.n()).done;){var _i496=_step677.value;var _n257=nP(_i496);r.is("element","listItem")&&_i496.is("element","paragraph")&&e.rename(_i496,"listItem"),e.setAttributes({listIndent:(_n257?_i496.getAttribute("listIndent"):0)+o,listItemId:_n257?_i496.getAttribute("listItemId"):iP.next(),listType:t},_i496);}}catch(err){_iterator677.e(err);}finally{_iterator677.f();}});};}(e),{priority:"high"}),this.listenTo(t,"outputTransformation",function(t,i){e.change(function(e){var t=Array.from(i.content.getChildren()),n=t[t.length-1];if(t.length>1&&n.is("element")&&n.isEmpty){t.slice(0,-1).every(nP)&&e.remove(n);}if("copy"==i.method||"cut"==i.method){var _t436=Array.from(i.content.getChildren());fP(_t436)&&gP(_t436,e);}});});}},{key:"_setupAccessibilityIntegration",value:function _setupAccessibilityIntegration(){var e=this.editor,t=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:t("Keystrokes that can be used in a list"),keystrokes:[{label:t("Increase list item indent"),keystroke:"Tab"},{label:t("Decrease list item indent"),keystroke:"Shift+Tab"}]});}}],[{key:"pluginName",get:function get(){return"ListEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[K_,Rw,EP,Jv];}}]);}(Dr);function HP(e,t){var i=e.document.selection;if(!i.isCollapsed)return!bP(e);if("forward"===t)return!0;var n=i.getFirstPosition().parent,s=n.previousSibling;return!e.schema.isObject(s)&&(!!s.isEmpty||fP([n,s]));}function $P(e,t,i,n){e.ui.componentFactory.add(t,function(){var s=UP(pg,e,t,i,n);return s.set({tooltip:!0,isToggleable:!0}),s;}),e.ui.componentFactory.add("menuBar:".concat(t),function(){var s=UP(Rg,e,t,i,n);return s.set({role:"menuitemcheckbox",isToggleable:!0}),s;});}function UP(e,t,i,n,s){var o=t.commands.get(i),r=new e(t.locale);return r.set({label:n,icon:s}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.on("execute",function(){t.execute(i),t.editing.view.focus();}),r;}var WP=/*#__PURE__*/function(_Dr179){function WP(){_classCallCheck(this,WP);return _callSuper(this,WP,arguments);}_inherits(WP,_Dr179);return _createClass(WP,[{key:"init",value:function init(){var e=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||$P(this.editor,"numberedList",e("Numbered List"),vm.numberedList),this.editor.ui.componentFactory.has("bulletedList")||$P(this.editor,"bulletedList",e("Bulleted List"),vm.bulletedList);}}],[{key:"pluginName",get:function get(){return"ListUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var jP=/*#__PURE__*/function(_Dr180){function jP(){_classCallCheck(this,jP);return _callSuper(this,jP,arguments);}_inherits(jP,_Dr180);return _createClass(jP,null,[{key:"requires",get:function get(){return[zP,WP];}},{key:"pluginName",get:function get(){return"List";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var qP=/*#__PURE__*/function(_Hr44){function qP(){_classCallCheck(this,qP);return _callSuper(this,qP,arguments);}_inherits(qP,_Hr44);return _createClass(qP,[{key:"refresh",value:function refresh(){var e=this._getValue();this.value=e,this.isEnabled=null!=e;}},{key:"execute",value:function execute(){var _ref253=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref253$startIndex=_ref253.startIndex,e=_ref253$startIndex===void 0?1:_ref253$startIndex;var t=this.editor.model,i=t.document;var n=Array.from(i.selection.getSelectedBlocks()).filter(function(e){return nP(e)&&_P(e.getAttribute("listType"));});n=dP(n),t.change(function(t){var _iterator678=_createForOfIteratorHelper(n),_step678;try{for(_iterator678.s();!(_step678=_iterator678.n()).done;){var _i497=_step678.value;t.setAttribute("listStart",e>=0?e:1,_i497);}}catch(err){_iterator678.e(err);}finally{_iterator678.f();}});}},{key:"_getValue",value:function _getValue(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());return e&&nP(e)&&_P(e.getAttribute("listType"))?e.getAttribute("listStart"):null;}}]);}(Hr);var GP={},KP={},ZP={},JP=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(var _i498=0,_JP=JP;_i498<_JP.length;_i498++){var _JP$_i=_JP[_i498],_e654=_JP$_i.listStyle,_t437=_JP$_i.typeAttribute,_i499=_JP$_i.listType;GP[_e654]=_i499,KP[_e654]=_t437,_t437&&(ZP[_t437]=_e654);}function QP(){return JP.map(function(e){return e.listStyle;});}function YP(e){return GP[e]||null;}function XP(e){return ZP[e]||null;}function eS(e){return KP[e]||null;}var tS=/*#__PURE__*/function(_Hr45){function tS(e,t,i){var _this683;_classCallCheck(this,tS);_this683=_callSuper(this,tS,[e]),_defineProperty(_assertThisInitialized(_this683),"defaultType",void 0),_defineProperty(_assertThisInitialized(_this683),"_supportedTypes",void 0),_this683.defaultType=t,_this683._supportedTypes=i;return _this683;}_inherits(tS,_Hr45);return _createClass(tS,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this684=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document;t.change(function(t){_this684._tryToConvertItemsToList(e);var n=Array.from(i.selection.getSelectedBlocks()).filter(function(e){return e.hasAttribute("listType");});if(n.length){n=dP(n);var _iterator679=_createForOfIteratorHelper(n),_step679;try{for(_iterator679.s();!(_step679=_iterator679.n()).done;){var _i500=_step679.value;t.setAttribute("listStyle",e.type||_this684.defaultType,_i500);}}catch(err){_iterator679.e(err);}finally{_iterator679.f();}}});}},{key:"isStyleTypeSupported",value:function isStyleTypeSupported(e){return!this._supportedTypes||this._supportedTypes.includes(e);}},{key:"_getValue",value:function _getValue(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());return nP(e)?e.getAttribute("listStyle"):null;}},{key:"_checkEnabled",value:function _checkEnabled(){var e=this.editor,t=e.commands.get("numberedList"),i=e.commands.get("bulletedList");return t.isEnabled||i.isEnabled;}},{key:"_tryToConvertItemsToList",value:function _tryToConvertItemsToList(e){if(!e.type)return;var t=YP(e.type);if(!t)return;var i=this.editor,n="".concat(t,"List");i.commands.get(n).value||i.execute(n);}}]);}(Hr);var iS=/*#__PURE__*/function(_Hr46){function iS(){_classCallCheck(this,iS);return _callSuper(this,iS,arguments);}_inherits(iS,_Hr46);return _createClass(iS,[{key:"refresh",value:function refresh(){var e=this._getValue();this.value=e,this.isEnabled=null!=e;}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document;var n=Array.from(i.selection.getSelectedBlocks()).filter(function(e){return nP(e)&&"numbered"==e.getAttribute("listType");});n=dP(n),t.change(function(t){var _iterator680=_createForOfIteratorHelper(n),_step680;try{for(_iterator680.s();!(_step680=_iterator680.n()).done;){var _i501=_step680.value;t.setAttribute("listReversed",!!e.reversed,_i501);}}catch(err){_iterator680.e(err);}finally{_iterator680.f();}});}},{key:"_getValue",value:function _getValue(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());return nP(e)&&"numbered"==e.getAttribute("listType")?e.getAttribute("listReversed"):null;}}]);}(Hr);function nS(e){return function(t,i,n){var s=n.writer,o=n.schema,r=n.consumable;if(!1===r.test(i.viewItem,e.viewConsumables))return;i.modelRange||Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor));var a=!1;var _iterator681=_createForOfIteratorHelper(i.modelRange.getItems({shallow:!0})),_step681;try{for(_iterator681.s();!(_step681=_iterator681.n()).done;){var _t438=_step681.value;o.checkAttribute(_t438,e.attributeName)&&e.appliesToListItem(_t438)&&(_t438.hasAttribute(e.attributeName)||(s.setAttribute(e.attributeName,e.getAttributeOnUpcast(i.viewItem),_t438),a=!0));}}catch(err){_iterator681.e(err);}finally{_iterator681.f();}a&&r.consume(i.viewItem,e.viewConsumables);};}var sS=/*#__PURE__*/function(_Dr181){function sS(){_classCallCheck(this,sS);return _callSuper(this,sS,arguments);}_inherits(sS,_Dr181);return _createClass(sS,[{key:"getAllSupportedStyleTypes",value:function getAllSupportedStyleTypes(){return QP();}},{key:"getListTypeFromListStyleType",value:function getListTypeFromListStyleType(e){return YP(e);}},{key:"getListStyleTypeFromTypeAttribute",value:function getListStyleTypeFromTypeAttribute(e){return XP(e);}},{key:"getTypeAttributeFromListStyleType",value:function getTypeAttributeFromListStyleType(e){return eS(e);}}],[{key:"pluginName",get:function get(){return"ListPropertiesUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function oS(e){var t=e.startIndex,i=e.reversed,n=e.styles;return{styles:rS(n),startIndex:t||!1,reversed:i||!1};}function rS(e){var t={listTypes:["bulleted","numbered"],useAttribute:!1};return!0===e||(e?Array.isArray(e)||"string"==typeof e?t.listTypes=gr(e):(t.listTypes=e.listTypes?gr(e.listTypes):t.listTypes,t.useAttribute=!!e.useAttribute):t.listTypes=[]),t;}var aS="default";var lS=/*#__PURE__*/function(_Dr182){function lS(e){var _this685;_classCallCheck(this,lS);_this685=_callSuper(this,lS,[e]),e.config.define("list.properties",{styles:!0,startIndex:!1,reversed:!1});return _this685;}_inherits(lS,_Dr182);return _createClass(lS,[{key:"init",value:function init(){var e=this.editor,t=e.model,i=e.plugins.get(zP),n=function(e){var t=[],i=oS(e);if(e.styles){var _e655=i.styles.useAttribute;t.push({attributeName:"listStyle",defaultValue:aS,viewConsumables:{styles:"list-style-type"},addCommand:function addCommand(t){var i=QP();_e655&&(i=i.filter(function(e){return!!eS(e);})),t.commands.add("listStyle",new tS(t,aS,i));},appliesToListItem:function appliesToListItem(e){return"numbered"==e.getAttribute("listType")||"bulleted"==e.getAttribute("listType");},hasValidAttribute:function hasValidAttribute(e){if(!this.appliesToListItem(e))return!e.hasAttribute("listStyle");if(!e.hasAttribute("listStyle"))return!1;var t=e.getAttribute("listStyle");return t==aS||YP(t)==e.getAttribute("listType");},setAttributeOnDowncast:function setAttributeOnDowncast(t,i,n){if(i&&i!==aS){if(!_e655)return void t.setStyle("list-style-type",i,n);{var _e656=eS(i);if(_e656)return void t.setAttribute("type",_e656,n);}}t.removeStyle("list-style-type",n),t.removeAttribute("type",n);},getAttributeOnUpcast:function getAttributeOnUpcast(e){var t=e.getStyle("list-style-type");if(t)return t;var i=e.getAttribute("type");return i?XP(i):aS;}});}e.reversed&&t.push({attributeName:"listReversed",defaultValue:!1,viewConsumables:{attributes:"reversed"},addCommand:function addCommand(e){e.commands.add("listReversed",new iS(e));},appliesToListItem:function appliesToListItem(e){return"numbered"==e.getAttribute("listType");},hasValidAttribute:function hasValidAttribute(e){return this.appliesToListItem(e)==e.hasAttribute("listReversed");},setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){t?e.setAttribute("reversed","reversed",i):e.removeAttribute("reversed",i);},getAttributeOnUpcast:function getAttributeOnUpcast(e){return e.hasAttribute("reversed");}});e.startIndex&&t.push({attributeName:"listStart",defaultValue:1,viewConsumables:{attributes:"start"},addCommand:function addCommand(e){e.commands.add("listStart",new qP(e));},appliesToListItem:function appliesToListItem(e){return _P(e.getAttribute("listType"));},hasValidAttribute:function hasValidAttribute(e){return this.appliesToListItem(e)==e.hasAttribute("listStart");},setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){0==t||t>1?e.setAttribute("start",t,i):e.removeAttribute("start",i);},getAttributeOnUpcast:function getAttributeOnUpcast(e){var t=e.getAttribute("start");return t>=0?t:1;}});return t;}(e.config.get("list.properties"));var _iterator682=_createForOfIteratorHelper(n),_step682;try{var _loop31=function _loop31(){var s=_step682.value;s.addCommand(e),t.schema.extend("$listItem",{allowAttributes:s.attributeName}),i.registerDowncastStrategy({scope:"list",attributeName:s.attributeName,setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){s.setAttributeOnDowncast(e,t,i);}});};for(_iterator682.s();!(_step682=_iterator682.n()).done;){_loop31();}}catch(err){_iterator682.e(err);}finally{_iterator682.f();}e.conversion["for"]("upcast").add(function(e){var _iterator683=_createForOfIteratorHelper(n),_step683;try{for(_iterator683.s();!(_step683=_iterator683.n()).done;){var _t439=_step683.value;e.on("element:ol",nS(_t439)),e.on("element:ul",nS(_t439));}}catch(err){_iterator683.e(err);}finally{_iterator683.f();}}),i.on("checkAttributes:list",function(e,_ref254){var t=_ref254.viewElement,i=_ref254.modelAttributes;var _iterator684=_createForOfIteratorHelper(n),_step684;try{for(_iterator684.s();!(_step684=_iterator684.n()).done;){var _s180=_step684.value;_s180.getAttributeOnUpcast(t)!=i[_s180.attributeName]&&(e["return"]=!0,e.stop());}}catch(err){_iterator684.e(err);}finally{_iterator684.f();}}),this.listenTo(e.commands.get("indentList"),"afterExecute",function(e,i){t.change(function(e){var _iterator685=_createForOfIteratorHelper(i),_step685;try{for(_iterator685.s();!(_step685=_iterator685.n()).done;){var _t440=_step685.value;var _iterator686=_createForOfIteratorHelper(n),_step686;try{for(_iterator686.s();!(_step686=_iterator686.n()).done;){var _i502=_step686.value;_i502.appliesToListItem(_t440)&&e.setAttribute(_i502.attributeName,_i502.defaultValue,_t440);}}catch(err){_iterator686.e(err);}finally{_iterator686.f();}}}catch(err){_iterator685.e(err);}finally{_iterator685.f();}});}),i.on("postFixer",function(e,_ref255){var t=_ref255.listNodes,i=_ref255.writer;var _iterator687=_createForOfIteratorHelper(t),_step687;try{for(_iterator687.s();!(_step687=_iterator687.n()).done;){var _s181=_step687.value.node;var _iterator688=_createForOfIteratorHelper(n),_step688;try{for(_iterator688.s();!(_step688=_iterator688.n()).done;){var _t441=_step688.value;_t441.hasValidAttribute(_s181)||(_t441.appliesToListItem(_s181)?i.setAttribute(_t441.attributeName,_t441.defaultValue,_s181):i.removeAttribute(_t441.attributeName,_s181),e["return"]=!0);}}catch(err){_iterator688.e(err);}finally{_iterator688.f();}}}catch(err){_iterator687.e(err);}finally{_iterator687.f();}}),i.on("postFixer",function(e,_ref256){var t=_ref256.listNodes,i=_ref256.writer;var _iterator689=_createForOfIteratorHelper(t),_step689;try{for(_iterator689.s();!(_step689=_iterator689.n()).done;){var _step689$value=_step689.value,_s182=_step689$value.node,_o104=_step689$value.previousNodeInList;if(_o104&&_o104.getAttribute("listType")==_s182.getAttribute("listType")){var _iterator690=_createForOfIteratorHelper(n),_step690;try{for(_iterator690.s();!(_step690=_iterator690.n()).done;){var _t442=_step690.value;var _n258=_t442.attributeName;if(!_t442.appliesToListItem(_s182))continue;var r=_o104.getAttribute(_n258);_s182.getAttribute(_n258)!=r&&(i.setAttribute(_n258,r,_s182),e["return"]=!0);}}catch(err){_iterator690.e(err);}finally{_iterator690.f();}}}}catch(err){_iterator689.e(err);}finally{_iterator689.f();}});}}],[{key:"requires",get:function get(){return[zP,sS];}},{key:"pluginName",get:function get(){return"ListPropertiesEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var cS=/*#__PURE__*/function(_lg62){function cS(e,_ref257){var _this686;var t=_ref257.enabledProperties,i=_ref257.styleButtonViews,n=_ref257.styleGridAriaLabel;_classCallCheck(this,cS);_this686=_callSuper(this,cS,[e]);_defineProperty(_this686,"children",void 0);_defineProperty(_this686,"stylesView",null);_defineProperty(_this686,"additionalPropertiesCollapsibleView",null);_defineProperty(_this686,"startIndexFieldView",null);_defineProperty(_this686,"reversedSwitchButtonView",null);_defineProperty(_this686,"focusTracker",new _r());_defineProperty(_this686,"keystrokes",new Cr());_defineProperty(_this686,"focusables",new zm());_defineProperty(_this686,"focusCycler",void 0);var s=["ck","ck-list-properties"];_this686.children=_this686.createCollection(),_this686.focusCycler=new _g({focusables:_this686.focusables,focusTracker:_this686.focusTracker,keystrokeHandler:_this686.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),i&&i.length?(_this686.stylesView=_this686._createStylesView(i,n),_this686.children.add(_this686.stylesView)):s.push("ck-list-properties_without-styles"),(t.startIndex||t.reversed)&&(_this686._addNumberedListPropertyViews(t),s.push("ck-list-properties_with-numbered-properties")),_this686.setTemplate({tag:"div",attributes:{"class":s},children:_this686.children});return _this686;}_inherits(cS,_lg62);return _createClass(cS,[{key:"render",value:function render(){var _this687=this;if(_superPropGet(cS,"render",this,3)([]),this.stylesView){this.focusables.add(this.stylesView),this.focusTracker.add(this.stylesView.element),(this.startIndexFieldView||this.reversedSwitchButtonView)&&(this.focusables.add(this.children.last.buttonView),this.focusTracker.add(this.children.last.buttonView.element));var _iterator691=_createForOfIteratorHelper(this.stylesView.children),_step691;try{for(_iterator691.s();!(_step691=_iterator691.n()).done;){var _e657=_step691.value;this.stylesView.focusTracker.add(_e657.element);}}catch(err){_iterator691.e(err);}finally{_iterator691.f();}mg({keystrokeHandler:this.stylesView.keystrokes,focusTracker:this.stylesView.focusTracker,gridItems:this.stylesView.children,numberOfColumns:function numberOfColumns(){return i.window.getComputedStyle(_this687.stylesView.element).getPropertyValue("grid-template-columns").split(" ").length;},uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});}if(this.startIndexFieldView){this.focusables.add(this.startIndexFieldView),this.focusTracker.add(this.startIndexFieldView.element);var _e658=function _e658(e){return e.stopPropagation();};this.keystrokes.set("arrowright",_e658),this.keystrokes.set("arrowleft",_e658),this.keystrokes.set("arrowup",_e658),this.keystrokes.set("arrowdown",_e658);}this.reversedSwitchButtonView&&(this.focusables.add(this.reversedSwitchButtonView),this.focusTracker.add(this.reversedSwitchButtonView.element)),this.keystrokes.listenTo(this.element);}},{key:"focus",value:function focus(){this.focusCycler.focusFirst();}},{key:"focusLast",value:function focusLast(){this.focusCycler.focusLast();}},{key:"destroy",value:function destroy(){_superPropGet(cS,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"_createStylesView",value:function _createStylesView(e,t){var i=new lg(this.locale);return i.children=i.createCollection(),i.children.addMany(e),i.setTemplate({tag:"div",attributes:{"aria-label":t,"class":["ck","ck-list-styles-list"]},children:i.children}),i.children.delegate("execute").to(this),i.focus=function(){this.children.first.focus();},i.focusTracker=new _r(),i.keystrokes=new Cr(),i.render(),i.keystrokes.listenTo(i.element),i;}},{key:"_addNumberedListPropertyViews",value:function _addNumberedListPropertyViews(e){var _this688=this;var t=this.locale.t,i=[];e.startIndex&&(this.startIndexFieldView=this._createStartIndexField(),i.push(this.startIndexFieldView)),e.reversed&&(this.reversedSwitchButtonView=this._createReversedSwitchButton(),i.push(this.reversedSwitchButtonView)),this.stylesView?(this.additionalPropertiesCollapsibleView=new jg(this.locale,i),this.additionalPropertiesCollapsibleView.set({label:t("List properties"),isCollapsed:!0}),this.additionalPropertiesCollapsibleView.buttonView.bind("isEnabled").toMany(i,"isEnabled",function(){for(var _len86=arguments.length,e=new Array(_len86),_key86=0;_key86<_len86;_key86++){e[_key86]=arguments[_key86];}return e.some(function(e){return e;});}),this.additionalPropertiesCollapsibleView.buttonView.on("change:isEnabled",function(e,t,i){i||(_this688.additionalPropertiesCollapsibleView.isCollapsed=!0);}),this.children.add(this.additionalPropertiesCollapsibleView)):this.children.addMany(i);}},{key:"_createStartIndexField",value:function _createStartIndexField(){var _this689=this;var e=this.locale.t,t=new pf(this.locale,dp);return t.set({label:e("Start at"),"class":"ck-numbered-list-properties__start-index"}),t.fieldView.set({min:0,step:1,value:1,inputMode:"numeric"}),t.fieldView.on("input",function(){var i=t.fieldView.element,n=i.valueAsNumber;Number.isNaN(n)?t.errorText=e("Invalid start index value."):i.checkValidity()?_this689.fire("listStart",{startIndex:n}):t.errorText=e("Start index must be greater than 0.");}),t;}},{key:"_createReversedSwitchButton",value:function _createReversedSwitchButton(){var e=this.locale.t,t=new Dg(this.locale);return t.set({withText:!0,label:e("Reversed order"),"class":"ck-numbered-list-properties__reversed-order"}),t.delegate("execute").to(this,"listReversed"),t;}}]);}(lg);var dS=/*#__PURE__*/function(_Dr183){function dS(){_classCallCheck(this,dS);return _callSuper(this,dS,arguments);}_inherits(dS,_Dr183);return _createClass(dS,[{key:"init",value:function init(){var e=this.editor,t=e.locale.t,i=e.config.get("list.properties"),n=oS(i),s=n.styles.listTypes;if(s.includes("bulleted")){var _i503=[{label:t("Toggle the disc list style"),tooltip:t("Disc"),type:"disc",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>'},{label:t("Toggle the circle list style"),tooltip:t("Circle"),type:"circle",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>'},{label:t("Toggle the square list style"),tooltip:t("Square"),type:"square",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M14 27v6H8v-6h6zm0-9v6H8v-6h6zm0-9v6H8V9h6z"/></svg>'}],_s183=t("Bulleted List"),_o105=t("Bulleted list styles toolbar"),r="bulletedList";e.ui.componentFactory.add(r,uS({editor:e,normalizedConfig:n,parentCommandName:r,buttonLabel:_s183,buttonIcon:vm.bulletedList,styleGridAriaLabel:_o105,styleDefinitions:_i503})),e.ui.componentFactory.add("menuBar:".concat(r),mS({editor:e,normalizedConfig:n,parentCommandName:r,buttonLabel:_s183,styleGridAriaLabel:_o105,styleDefinitions:_i503}));}if(s.includes("numbered")||i.startIndex||i.reversed){var _i504=[{label:t("Toggle the decimal list style"),tooltip:t("Decimal"),type:"decimal",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M10.29 15V8.531H9.286c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.343 0v-1.235h-1.235V15h1.235zM11.3 24v-1.147H8.848c.064-.111.148-.226.252-.343.104-.117.351-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.494-.824.104-.263.156-.539.156-.829 0-.51-.182-.936-.545-1.279-.363-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.153-.155.358-.233.616-.233.26 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.468.536-1.024 1.055-.692.641-1.155 1.156-1.389 1.544-.234.389-.375.8-.422 1.233H11.3zm2.333 0v-1.235h-1.235V24h1.235zM9.204 34.11c.615 0 1.129-.2 1.542-.598.413-.398.62-.88.62-1.446 0-.39-.11-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.619-.337.928-.788.928-1.353 0-.399-.151-.756-.453-1.073-.366-.386-.852-.58-1.459-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.668.55c-.16.232-.28.544-.358.933l1.138.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.215 0 .386.065.515.194s.193.302.193.518c0 .255-.087.46-.263.613-.176.154-.43.227-.765.218l-.136 1.006c.22-.061.409-.092.567-.092.24 0 .444.09.61.272.168.182.251.428.251.739 0 .328-.087.589-.261.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.307-.698l-1.196.145c.062.542.285.98.668 1.316.384.335.868.503 1.45.503zm4.43-.11v-1.235h-1.236V34h1.235z"/></svg>'},{label:t("Toggle the decimal with leading zero list style"),tooltip:t("Decimal with leading zero"),type:"decimal-leading-zero",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M5.714 15.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm6.078.914V8.531H10.79c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.344 0v-1.235h-1.235V15h1.235zm-9.422 9.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm7.088.914v-1.147H10.35c.065-.111.149-.226.253-.343.104-.117.35-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.493-.824.104-.263.156-.539.156-.829 0-.51-.181-.936-.544-1.279-.364-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.152-.155.357-.233.615-.233.261 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.467.536-1.024 1.055-.691.641-1.154 1.156-1.388 1.544-.235.389-.375.8-.422 1.233h4.328zm2.334 0v-1.235h-1.235V24h1.235zM5.714 34.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm4.992 1.024c.616 0 1.13-.2 1.543-.598.413-.398.62-.88.62-1.446 0-.39-.111-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.618-.337.927-.788.927-1.353 0-.399-.15-.756-.452-1.073-.366-.386-.853-.58-1.46-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.667.55c-.16.232-.28.544-.359.933l1.139.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.214 0 .386.065.515.194s.193.302.193.518c0 .255-.088.46-.264.613-.175.154-.43.227-.764.218l-.136 1.006c.22-.061.408-.092.566-.092.24 0 .444.09.611.272.167.182.25.428.25.739 0 .328-.086.589-.26.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.308-.698l-1.195.145c.062.542.284.98.668 1.316.384.335.867.503 1.45.503zm4.43-.11v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the lower–roman list style"),tooltip:t("Lower–roman"),type:"lower-roman",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.88 8.7V7.558h-1.234V8.7h1.234zm0 5.3V9.333h-1.234V14h1.234zm2.5 0v-1.235h-1.234V14h1.235zm-4.75 4.7v-1.142H8.395V18.7H9.63zm0 5.3v-4.667H8.395V24H9.63zm2.5-5.3v-1.142h-1.234V18.7h1.235zm0 5.3v-4.667h-1.234V24h1.235zm2.501 0v-1.235h-1.235V24h1.235zM7.38 28.7v-1.142H6.145V28.7H7.38zm0 5.3v-4.667H6.145V34H7.38zm2.5-5.3v-1.142H8.646V28.7H9.88zm0 5.3v-4.667H8.646V34H9.88zm2.5-5.3v-1.142h-1.234V28.7h1.235zm0 5.3v-4.667h-1.234V34h1.235zm2.501 0v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the upper–roman list style"),tooltip:t("Upper-roman"),type:"upper-roman",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.916 15V8.558h-1.301V15h1.3zm2.465 0v-1.235h-1.235V15h1.235zM9.665 25v-6.442h-1.3V25h1.3zm2.5 0v-6.442h-1.3V25h1.3zm2.466 0v-1.235h-1.235V25h1.235zm-7.216 9v-6.442h-1.3V34h1.3zm2.5 0v-6.442h-1.3V34h1.3zm2.501 0v-6.442h-1.3V34h1.3zm2.465 0v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the lower–latin list style"),tooltip:t("Lower-latin"),type:"lower-latin",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M9.62 14.105c.272 0 .528-.05.768-.153s.466-.257.677-.462c.009.024.023.072.044.145.047.161.086.283.119.365h1.221a2.649 2.649 0 0 1-.222-.626c-.04-.195-.059-.498-.059-.908l.013-1.441c0-.536-.055-.905-.165-1.105-.11-.201-.3-.367-.569-.497-.27-.13-.68-.195-1.23-.195-.607 0-1.064.108-1.371.325-.308.217-.525.55-.65 1.002l1.12.202c.076-.217.176-.369.299-.455.123-.086.294-.13.514-.13.325 0 .546.05.663.152.118.101.176.27.176.508v.123c-.222.093-.622.194-1.2.303-.427.082-.755.178-.982.288-.227.11-.403.268-.53.474a1.327 1.327 0 0 0-.188.706c0 .398.138.728.415.988.277.261.656.391 1.136.391zm.368-.87a.675.675 0 0 1-.492-.189.606.606 0 0 1-.193-.448c0-.176.08-.32.241-.435.106-.07.33-.142.673-.215a7.19 7.19 0 0 0 .751-.19v.247c0 .296-.016.496-.048.602a.773.773 0 0 1-.295.409 1.07 1.07 0 0 1-.637.22zm4.645.765v-1.235h-1.235V14h1.235zM10.2 25.105c.542 0 1.003-.215 1.382-.646.38-.43.57-1.044.57-1.84 0-.771-.187-1.362-.559-1.774a1.82 1.82 0 0 0-1.41-.617c-.522 0-.973.216-1.354.65v-2.32H7.594V25h1.147v-.686a1.9 1.9 0 0 0 .67.592c.26.133.523.2.79.2zm-.299-.975c-.354 0-.638-.164-.852-.492-.153-.232-.229-.59-.229-1.073 0-.468.098-.818.295-1.048a.93.93 0 0 1 .738-.345c.302 0 .55.118.743.354.193.236.29.62.29 1.154 0 .5-.096.868-.288 1.1-.192.233-.424.35-.697.35zm4.478.87v-1.235h-1.234V25h1.234zm-4.017 9.105c.6 0 1.08-.142 1.437-.426.357-.284.599-.704.725-1.261l-1.213-.207c-.061.326-.167.555-.316.688a.832.832 0 0 1-.576.2.916.916 0 0 1-.75-.343c-.185-.228-.278-.62-.278-1.173 0-.498.091-.853.274-1.066.183-.212.429-.318.736-.318.232 0 .42.061.565.184.145.123.238.306.28.55l1.216-.22c-.146-.501-.387-.874-.722-1.119-.336-.244-.788-.366-1.356-.366-.695 0-1.245.214-1.653.643-.407.43-.61 1.03-.61 1.8 0 .762.202 1.358.608 1.788.406.431.95.646 1.633.646zM14.633 34v-1.235h-1.235V34h1.235z"/></svg>'},{label:t("Toggle the upper–latin list style"),tooltip:t("Upper-latin"),type:"upper-latin",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="m7.88 15 .532-1.463h2.575L11.549 15h1.415l-2.58-6.442H9.01L6.5 15h1.38zm2.69-2.549H8.811l.87-2.39.887 2.39zM14.88 15v-1.235h-1.234V15h1.234zM9.352 25c.83-.006 1.352-.02 1.569-.044.346-.038.636-.14.872-.305.236-.166.422-.387.558-.664.137-.277.205-.562.205-.855 0-.372-.106-.695-.317-.97-.21-.276-.512-.471-.905-.585a1.51 1.51 0 0 0 .661-.567 1.5 1.5 0 0 0 .244-.83c0-.28-.066-.53-.197-.754a1.654 1.654 0 0 0-.495-.539 1.676 1.676 0 0 0-.672-.266c-.25-.042-.63-.063-1.14-.063H7.158V25h2.193zm.142-3.88H8.46v-1.49h.747c.612 0 .983.007 1.112.022.217.026.38.102.49.226.11.125.165.287.165.486a.68.68 0 0 1-.192.503.86.86 0 0 1-.525.23 11.47 11.47 0 0 1-.944.023h.18zm.17 2.795H8.46v-1.723h1.05c.592 0 .977.03 1.154.092.177.062.313.16.406.295a.84.84 0 0 1 .14.492c0 .228-.06.41-.181.547a.806.806 0 0 1-.473.257c-.126.026-.423.04-.892.04zM14.88 25v-1.235h-1.234V25h1.234zm-5.018 9.11c.691 0 1.262-.17 1.711-.512.45-.341.772-.864.965-1.567l-1.261-.4c-.109.472-.287.818-.536 1.037-.25.22-.547.33-.892.33-.47 0-.85-.173-1.143-.519-.293-.345-.44-.925-.44-1.74 0-.767.15-1.322.447-1.665.297-.343.684-.514 1.162-.514.346 0 .64.096.881.29.242.193.4.457.477.79l1.288-.307c-.147-.516-.367-.911-.66-1.187-.492-.465-1.132-.698-1.92-.698-.902 0-1.63.296-2.184.89-.554.593-.83 1.426-.83 2.498 0 1.014.275 1.813.825 2.397.551.585 1.254.877 2.11.877zM14.88 34v-1.235h-1.234V34h1.234z"/></svg>'}],_o106=t("Numbered List"),_r50=t("Numbered list styles toolbar"),_a32="numberedList";e.ui.componentFactory.add(_a32,uS({editor:e,normalizedConfig:n,parentCommandName:_a32,buttonLabel:_o106,buttonIcon:vm.numberedList,styleGridAriaLabel:_r50,styleDefinitions:_i504})),s.includes("numbered")&&e.ui.componentFactory.add("menuBar:".concat(_a32),mS({editor:e,normalizedConfig:n,parentCommandName:_a32,buttonLabel:_o106,styleGridAriaLabel:_r50,styleDefinitions:_i504}));}}}],[{key:"pluginName",get:function get(){return"ListPropertiesUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function uS(_ref258){var e=_ref258.editor,t=_ref258.normalizedConfig,i=_ref258.parentCommandName,n=_ref258.buttonLabel,s=_ref258.buttonIcon,o=_ref258.styleGridAriaLabel,r=_ref258.styleDefinitions;var a=e.commands.get(i);return function(l){var c=Xf(l,Yf),d=c.buttonView;return c.bind("isEnabled").to(a),c["class"]="ck-list-styles-dropdown",d.on("execute",function(){e.execute(i),e.editing.view.focus();}),d.set({label:n,icon:s,tooltip:!0,isToggleable:!0}),d.bind("isOn").to(a,"value",function(e){return!!e;}),c.once("change:isOpen",function(){var n=function(_ref259){var e=_ref259.editor,t=_ref259.normalizedConfig,i=_ref259.dropdownView,n=_ref259.parentCommandName,s=_ref259.styleDefinitions,o=_ref259.styleGridAriaLabel;var r=e.locale,a=_objectSpread(_objectSpread({},t),"numberedList"!=n?{startIndex:!1,reversed:!1}:null),l=n.replace("List","");var c=null;if(t.styles.listTypes.includes(l)){var _t443=e.commands.get("listStyle"),_i505=hS({editor:e,parentCommandName:n,listStyleCommand:_t443}),_o107=gS(_t443);c=s.filter(_o107).map(_i505);}var d=new cS(r,{styleGridAriaLabel:o,enabledProperties:a,styleButtonViews:c});t.styles.listTypes.includes(l)&&rp(i,function(){return d.stylesView.children.find(function(e){return e.isOn;});});if(a.startIndex){var _t444=e.commands.get("listStart");d.startIndexFieldView.bind("isEnabled").to(_t444),d.startIndexFieldView.fieldView.bind("value").to(_t444),d.on("listStart",function(t,i){return e.execute("listStart",i);});}if(a.reversed){var _t445=e.commands.get("listReversed");d.reversedSwitchButtonView.bind("isEnabled").to(_t445),d.reversedSwitchButtonView.bind("isOn").to(_t445,"value",function(e){return!!e;}),d.on("listReversed",function(){var i=_t445.value;e.execute("listReversed",{reversed:!i});});}return d.delegate("execute").to(i),d;}({editor:e,normalizedConfig:t,dropdownView:c,parentCommandName:i,styleGridAriaLabel:o,styleDefinitions:r});c.panelView.children.add(n);}),c.on("execute",function(){e.editing.view.focus();}),c;};}function hS(_ref260){var e=_ref260.editor,t=_ref260.listStyleCommand,i=_ref260.parentCommandName;var n=e.locale,s=e.commands.get(i);return function(_ref261){var o=_ref261.label,r=_ref261.type,a=_ref261.icon,l=_ref261.tooltip;var c=new pg(n);return c.set({label:o,icon:a,tooltip:l}),t.on("change:value",function(){c.isOn=t.value===r;}),c.on("execute",function(){s.value?t.value===r?e.execute(i):t.value!==r&&e.execute("listStyle",{type:r}):e.model.change(function(){e.execute("listStyle",{type:r});});}),c;};}function mS(_ref262){var e=_ref262.editor,t=_ref262.normalizedConfig,i=_ref262.parentCommandName,n=_ref262.buttonLabel,s=_ref262.styleGridAriaLabel,o=_ref262.styleDefinitions;return function(r){var a=new aw(r),l=e.commands.get(i),c=e.commands.get("listStyle"),d=gS(c),u=hS({editor:e,parentCommandName:i,listStyleCommand:c}),h=o.filter(d).map(u),m=new cS(r,{styleGridAriaLabel:s,enabledProperties:_objectSpread(_objectSpread({},t),{},{startIndex:!1,reversed:!1}),styleButtonViews:h});return m.delegate("execute").to(a),a.buttonView.set({label:n,icon:vm[i]}),a.panelView.children.add(m),a.bind("isEnabled").to(l,"isEnabled"),a.on("execute",function(){e.editing.view.focus();}),a;};}function gS(e){return"function"==typeof e.isStyleTypeSupported?function(t){return e.isStyleTypeSupported(t.type);}:function(){return!0;};}var fS=/*#__PURE__*/function(_Dr184){function fS(){_classCallCheck(this,fS);return _callSuper(this,fS,arguments);}_inherits(fS,_Dr184);return _createClass(fS,null,[{key:"requires",get:function get(){return[lS,dS];}},{key:"pluginName",get:function get(){return"ListProperties";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pS=/*#__PURE__*/function(_Hr47){function pS(e){var _this690;_classCallCheck(this,pS);_this690=_callSuper(this,pS,[e]),_this690.on("execute",function(){_this690.refresh();},{priority:"highest"});return _this690;}_inherits(pS,_Hr47);return _createClass(pS,[{key:"refresh",value:function refresh(){var e=this._getSelectedItems();this.value=this._getValue(e),this.isEnabled=!!e.length;}},{key:"execute",value:function execute(){var _this691=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.editor.model.change(function(t){var i=_this691._getSelectedItems(),n=void 0===e.forceValue?!_this691._getValue(i):e.forceValue;var _iterator692=_createForOfIteratorHelper(i),_step692;try{for(_iterator692.s();!(_step692=_iterator692.n()).done;){var _e659=_step692.value;n?t.setAttribute("todoListChecked",!0,_e659):t.removeAttribute("todoListChecked",_e659);}}catch(err){_iterator692.e(err);}finally{_iterator692.f();}});}},{key:"_getValue",value:function _getValue(e){return e.every(function(e){return e.getAttribute("todoListChecked");});}},{key:"_getSelectedItems",value:function _getSelectedItems(){var e=this.editor.model,t=e.schema,i=e.document.selection.getFirstRange(),n=i.start.parent,s=[];t.checkAttribute(n,"todoListChecked")&&s.push.apply(s,_toConsumableArray(sP(n)));var _iterator693=_createForOfIteratorHelper(i.getItems({shallow:!0})),_step693;try{for(_iterator693.s();!(_step693=_iterator693.n()).done;){var _e660=_step693.value;t.checkAttribute(_e660,"todoListChecked")&&!s.includes(_e660)&&s.push.apply(s,_toConsumableArray(sP(_e660)));}}catch(err){_iterator693.e(err);}finally{_iterator693.f();}return s;}}]);}(Hr);var bS=/*#__PURE__*/function(_Tl9){function bS(){var _this692;_classCallCheck(this,bS);for(var _len87=arguments.length,args=new Array(_len87),_key87=0;_key87<_len87;_key87++){args[_key87]=arguments[_key87];}_this692=_callSuper(this,bS,[].concat(args));_defineProperty(_this692,"domEventType",["change"]);return _this692;}_inherits(bS,_Tl9);return _createClass(bS,[{key:"onDomEvent",value:function onDomEvent(e){if(e.target){var _t446=this.view.domConverter.mapDomToView(e.target);_t446&&_t446.is("element","input")&&"checkbox"==_t446.getAttribute("type")&&_t446.findAncestor({classes:"todo-list__label"})&&this.fire("todoCheckboxChange",e);}}}]);}(Tl);var wS=rr("Ctrl+Enter");var _S=/*#__PURE__*/function(_Dr185){function _S(){_classCallCheck(this,_S);return _callSuper(this,_S,arguments);}_inherits(_S,_Dr185);return _createClass(_S,[{key:"init",value:function init(){var _this693=this;var e=this.editor,t=e.model,i=e.editing,n=e.plugins.get(zP),s=e.config.get("list.multiBlock")?"paragraph":"listItem";e.commands.add("todoList",new CP(e,"todo")),e.commands.add("checkTodoList",new pS(e)),i.view.addObserver(bS),t.schema.extend("$listItem",{allowAttributes:"todoListChecked"}),t.schema.addAttributeCheck(function(e){var t=e.last;if(!t.getAttribute("listItemId")||"todo"!=t.getAttribute("listType"))return!1;},"todoListChecked"),e.conversion["for"]("upcast").add(function(e){e.on("element:input",function(e,t,i){var n=t.modelCursor,s=n.parent,o=t.viewItem;if(!i.consumable.test(o,{name:!0}))return;if("checkbox"!=o.getAttribute("type")||!n.isAtStart||!s.hasAttribute("listType"))return;i.consumable.consume(o,{name:!0});var r=i.writer;r.setAttribute("listType","todo",s),t.viewItem.hasAttribute("checked")&&r.setAttribute("todoListChecked",!0,s),t.modelRange=r.createRange(n);}),e.on("element:li",function(e,t,i){var n=i.writer,s=i.schema;if(!t.modelRange)return;var o=Array.from(t.modelRange.getItems({shallow:!0})).filter(function(e){return"todo"===e.getAttribute("listType")&&s.checkAttribute(e,"listItemId");}).reduce(function(e,t){var i=t.getAttribute("listItemId");return e.has(i)||e.set(i,sP(t)),e;},new Map());var _iterator694=_createForOfIteratorHelper(o.entries()),_step694;try{for(_iterator694.s();!(_step694=_iterator694.n()).done;){var _step694$value=_slicedToArray(_step694.value,2),_e661=_step694$value[1];if(_e661.some(function(e){return e.getAttribute("todoListChecked");})){var _iterator695=_createForOfIteratorHelper(_e661),_step695;try{for(_iterator695.s();!(_step695=_iterator695.n()).done;){var _t447=_step695.value;n.setAttribute("todoListChecked",!0,_t447);}}catch(err){_iterator695.e(err);}finally{_iterator695.f();}}}}catch(err){_iterator694.e(err);}finally{_iterator694.f();}},{priority:"low"}),e.on("element:label",vS({name:"label",classes:"todo-list__label"})),e.on("element:label",vS({name:"label",classes:["todo-list__label","todo-list__label_without-description"]})),e.on("element:span",vS({name:"span",classes:"todo-list__label__description"})),e.on("element:ul",function(e){var t=new aa(e);return function(e,i,n){var s=t.match(i.viewItem);if(!s)return;var o=s.match;o.name=!1,n.consumable.consume(i.viewItem,o);};}({name:"ul",classes:"todo-list"}));}),e.conversion["for"]("downcast").elementToElement({model:s,view:function view(e,_ref263){var t=_ref263.writer;if(yS(e,n.getListAttributeNames()))return t.createContainerElement("span",{"class":"todo-list__label__description"});},converterPriority:"highest"}),n.registerDowncastStrategy({scope:"list",attributeName:"listType",setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){"todo"==t?e.addClass("todo-list",i):e.removeClass("todo-list",i);}}),n.registerDowncastStrategy({scope:"itemMarker",attributeName:"todoListChecked",createElement:function createElement(e,t,_ref264){var i=_ref264.dataPipeline;if("todo"!=t.getAttribute("listType"))return null;var n=e.createUIElement("input",_objectSpread(_objectSpread({type:"checkbox"},t.getAttribute("todoListChecked")?{checked:"checked"}:null),i?{disabled:"disabled"}:{tabindex:"-1"}));if(i)return n;var s=e.createContainerElement("span",{contenteditable:"false"},n);return s.getFillerOffset=function(){return null;},s;},canWrapElement:function canWrapElement(e){return yS(e,n.getListAttributeNames());},createWrapperElement:function createWrapperElement(e,t,_ref265){var i=_ref265.dataPipeline;var s=["todo-list__label"];return yS(t,n.getListAttributeNames())||s.push("todo-list__label_without-description"),e.createAttributeElement(i?"label":"span",{"class":s.join(" ")});}}),n.on("checkElement",function(e,_ref266){var t=_ref266.modelElement,i=_ref266.viewElement;var s=yS(t,n.getListAttributeNames());i.hasClass("todo-list__label__description")!=s&&(e["return"]=!0,e.stop());}),n.on("checkElement",function(t,_ref267){var i=_ref267.modelElement,n=_ref267.viewElement;var s="todo"==i.getAttribute("listType")&&aP(i);var o=!1;var r=e.editing.view.createPositionBefore(n).getWalker({direction:"backward"});var _iterator696=_createForOfIteratorHelper(r),_step696;try{for(_iterator696.s();!(_step696=_iterator696.n()).done;){var _t448=_step696.value.item;if(_t448.is("element")&&e.editing.mapper.toModelElement(_t448))break;_t448.is("element","input")&&"checkbox"==_t448.getAttribute("type")&&(o=!0);}}catch(err){_iterator696.e(err);}finally{_iterator696.f();}o!=s&&(t["return"]=!0,t.stop());}),n.on("postFixer",function(e,_ref268){var t=_ref268.listNodes,i=_ref268.writer;var _iterator697=_createForOfIteratorHelper(t),_step697;try{for(_iterator697.s();!(_step697=_iterator697.n()).done;){var _step697$value=_step697.value,_n259=_step697$value.node,_s184=_step697$value.previousNodeInList;if(!_s184)continue;if(_s184.getAttribute("listItemId")!=_n259.getAttribute("listItemId"))continue;var _t449=_s184.hasAttribute("todoListChecked"),_o108=_n259.hasAttribute("todoListChecked");_o108&&!_t449?(i.removeAttribute("todoListChecked",_n259),e["return"]=!0):!_o108&&_t449&&(i.setAttribute("todoListChecked",!0,_n259),e["return"]=!0);}}catch(err){_iterator697.e(err);}finally{_iterator697.f();}}),t.document.registerPostFixer(function(e){var i=t.document.differ.getChanges();var n=!1;var _iterator698=_createForOfIteratorHelper(i),_step698;try{for(_iterator698.s();!(_step698=_iterator698.n()).done;){var _t450=_step698.value;if("attribute"==_t450.type&&"listType"==_t450.attributeKey){var _i506=_t450.range.start.nodeAfter;"todo"==_t450.attributeOldValue&&_i506.hasAttribute("todoListChecked")&&(e.removeAttribute("todoListChecked",_i506),n=!0);}else if("insert"==_t450.type&&"$text"!=_t450.name){var _iterator699=_createForOfIteratorHelper(e.createRangeOn(_t450.position.nodeAfter)),_step699;try{for(_iterator699.s();!(_step699=_iterator699.n()).done;){var _i507=_step699.value.item;_i507.is("element")&&"todo"!=_i507.getAttribute("listType")&&_i507.hasAttribute("todoListChecked")&&(e.removeAttribute("todoListChecked",_i507),n=!0);}}catch(err){_iterator699.e(err);}finally{_iterator699.f();}}}}catch(err){_iterator698.e(err);}finally{_iterator698.f();}return n;}),this.listenTo(i.view.document,"keydown",function(t,i){or(i)===wS&&(e.execute("checkTodoList"),t.stop());},{priority:"high"}),this.listenTo(i.view.document,"todoCheckboxChange",function(e,t){var n=t.target;if(!n||!n.is("element","input"))return;var s=i.view.createPositionAfter(n),o=i.mapper.toModelPosition(s).parent;o&&nP(o)&&"todo"==o.getAttribute("listType")&&_this693._handleCheckmarkChange(o);}),this.listenTo(i.view.document,"arrowKey",function(e,t){return function(i,n){var s=cr(n.keyCode,t.contentLanguageDirection),o=e.schema,r=e.document.selection;if(!r.isCollapsed)return;var a=r.getFirstPosition(),l=a.parent;if("right"==s&&a.isAtEnd){var _t451=o.getNearestSelectionRange(e.createPositionAfter(l),"forward");if(!_t451)return;var _s185=_t451.start.parent;_s185&&nP(_s185)&&"todo"==_s185.getAttribute("listType")&&(e.change(function(e){return e.setSelection(_t451);}),n.preventDefault(),n.stopPropagation(),i.stop());}else if("left"==s&&a.isAtStart&&nP(l)&&"todo"==l.getAttribute("listType")){var _t452=o.getNearestSelectionRange(e.createPositionBefore(l),"backward");if(!_t452)return;e.change(function(e){return e.setSelection(_t452);}),n.preventDefault(),n.stopPropagation(),i.stop();}};}(t,e.locale),{context:"$text"}),this.listenTo(i.mapper,"viewToModelPosition",function(e,i){var n=i.viewPosition.parent,s=n.is("attributeElement","li")&&0==i.viewPosition.offset,o=kS(n)&&i.viewPosition.offset<=1,r=n.is("element","span")&&"false"==n.getAttribute("contenteditable")&&kS(n.parent);if(!s&&!o&&!r)return;var a=i.modelPosition.nodeAfter;a&&"todo"==a.getAttribute("listType")&&(i.modelPosition=t.createPositionAt(a,0));},{priority:"low"}),this._initAriaAnnouncements();}},{key:"_handleCheckmarkChange",value:function _handleCheckmarkChange(e){var t=this.editor,i=t.model,n=Array.from(i.document.selection.getRanges());i.change(function(i){i.setSelection(e,"end"),t.execute("checkTodoList"),i.setSelection(n);});}},{key:"_initAriaAnnouncements",value:function _initAriaAnnouncements(){var _this$editor2=this.editor,e=_this$editor2.model,t=_this$editor2.ui,i=_this$editor2.t;var n=null;t&&e.document.selection.on("change:range",function(){var s=e.document.selection.focus.parent,o=CS(n),r=CS(s);o&&!r?t.ariaLiveAnnouncer.announce(i("Leaving a to-do list")):!o&&r&&t.ariaLiveAnnouncer.announce(i("Entering a to-do list")),n=s;});}}],[{key:"pluginName",get:function get(){return"TodoListEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[zP];}}]);}(Dr);function vS(e){var t=new aa(e);return function(e,i,n){var s=t.match(i.viewItem);s&&n.consumable.consume(i.viewItem,s.match)&&Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor));};}function yS(e,t){return(e.is("element","paragraph")||e.is("element","listItem"))&&"todo"==e.getAttribute("listType")&&aP(e)&&function(e,t){var _iterator700=_createForOfIteratorHelper(e.getAttributeKeys()),_step700;try{for(_iterator700.s();!(_step700=_iterator700.n()).done;){var _i508=_step700.value;if(!_i508.startsWith("selection:")&&!t.includes(_i508))return!1;}}catch(err){_iterator700.e(err);}finally{_iterator700.f();}return!0;}(e,t);}function kS(e){return!!e&&e.is("attributeElement")&&e.hasClass("todo-list__label");}function CS(e){return!!e&&!(!e.is("element","paragraph")&&!e.is("element","listItem"))&&"todo"==e.getAttribute("listType");}var xS=/*#__PURE__*/function(_Dr186){function xS(){_classCallCheck(this,xS);return _callSuper(this,xS,arguments);}_inherits(xS,_Dr186);return _createClass(xS,[{key:"init",value:function init(){var e=this.editor.t;$P(this.editor,"todoList",e("To-do List"),vm.todoList);}}],[{key:"pluginName",get:function get(){return"TodoListUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var AS=/*#__PURE__*/function(_Dr187){function AS(){_classCallCheck(this,AS);return _callSuper(this,AS,arguments);}_inherits(AS,_Dr187);return _createClass(AS,null,[{key:"requires",get:function get(){return[_S,xS];}},{key:"pluginName",get:function get(){return"TodoList";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var ES=/*#__PURE__*/function(_Hr48){function ES(e,t){var _this694;_classCallCheck(this,ES);_this694=_callSuper(this,ES,[e]),_defineProperty(_assertThisInitialized(_this694),"type",void 0),_this694.type=t;return _this694;}_inherits(ES,_Hr48);return _createClass(ES,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this695=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document,n=Array.from(i.selection.getSelectedBlocks()).filter(function(e){return PS(e,t.schema);}),s=void 0!==e.forceValue?!e.forceValue:this.value;t.change(function(e){if(s){var _t453=n[n.length-1].nextSibling,_i509=Number.POSITIVE_INFINITY,_s186=[];for(;_t453&&"listItem"==_t453.name&&0!==_t453.getAttribute("listIndent");){var _e662=_t453.getAttribute("listIndent");_e662<_i509&&(_i509=_e662);var _n260=_e662-_i509;_s186.push({element:_t453,listIndent:_n260}),_t453=_t453.nextSibling;}_s186=_s186.reverse();var _iterator701=_createForOfIteratorHelper(_s186),_step701;try{for(_iterator701.s();!(_step701=_iterator701.n()).done;){var _t454=_step701.value;e.setAttribute("listIndent",_t454.listIndent,_t454.element);}}catch(err){_iterator701.e(err);}finally{_iterator701.f();}}if(!s){var _e663=Number.POSITIVE_INFINITY;var _iterator702=_createForOfIteratorHelper(n),_step702;try{for(_iterator702.s();!(_step702=_iterator702.n()).done;){var _t455=_step702.value;_t455.is("element","listItem")&&_t455.getAttribute("listIndent")<_e663&&(_e663=_t455.getAttribute("listIndent"));}}catch(err){_iterator702.e(err);}finally{_iterator702.f();}_e663=0===_e663?1:_e663,TS(n,!0,_e663),TS(n,!1,_e663);}var _iterator703=_createForOfIteratorHelper(n.reverse()),_step703;try{for(_iterator703.s();!(_step703=_iterator703.n()).done;){var _t456=_step703.value;s&&"listItem"==_t456.name?e.rename(_t456,"paragraph"):s||"listItem"==_t456.name?s||"listItem"!=_t456.name||_t456.getAttribute("listType")==_this695.type||e.setAttribute("listType",_this695.type,_t456):(e.setAttributes({listType:_this695.type,listIndent:0},_t456),e.rename(_t456,"listItem"));}}catch(err){_iterator703.e(err);}finally{_iterator703.f();}_this695.fire("_executeCleanup",n);});}},{key:"_getValue",value:function _getValue(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());return!!e&&e.is("element","listItem")&&e.getAttribute("listType")==this.type;}},{key:"_checkEnabled",value:function _checkEnabled(){if(this.value)return!0;var e=this.editor.model.document.selection,t=this.editor.model.schema,i=wr(e.getSelectedBlocks());return!!i&&PS(i,t);}}]);}(Hr);function TS(e,t,i){var n=t?e[0]:e[e.length-1];if(n.is("element","listItem")){var _s187=n[t?"previousSibling":"nextSibling"],_o109=n.getAttribute("listIndent");for(;_s187&&_s187.is("element","listItem")&&_s187.getAttribute("listIndent")>=i;)_o109>_s187.getAttribute("listIndent")&&(_o109=_s187.getAttribute("listIndent")),_s187.getAttribute("listIndent")==_o109&&e[t?"unshift":"push"](_s187),_s187=_s187[t?"previousSibling":"nextSibling"];}}function PS(e,t){return t.checkChild(e.parent,"listItem")&&!t.isObject(e);}var SS=/*#__PURE__*/function(_Hr49){function SS(e,t){var _this696;_classCallCheck(this,SS);_this696=_callSuper(this,SS,[e]),_defineProperty(_assertThisInitialized(_this696),"_indentBy",void 0),_this696._indentBy="forward"==t?1:-1;return _this696;}_inherits(SS,_Hr49);return _createClass(SS,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this697=this;var e=this.editor.model,t=e.document;var i=Array.from(t.selection.getSelectedBlocks());e.change(function(e){var t=i[i.length-1];var n=t.nextSibling;for(;n&&"listItem"==n.name&&n.getAttribute("listIndent")>t.getAttribute("listIndent");)i.push(n),n=n.nextSibling;_this697._indentBy<0&&(i=i.reverse());var _iterator704=_createForOfIteratorHelper(i),_step704;try{for(_iterator704.s();!(_step704=_iterator704.n()).done;){var _t457=_step704.value;var _i510=_t457.getAttribute("listIndent")+_this697._indentBy;_i510<0?e.rename(_t457,"paragraph"):e.setAttribute("listIndent",_i510,_t457);}}catch(err){_iterator704.e(err);}finally{_iterator704.f();}_this697.fire("_executeCleanup",i);});}},{key:"_checkEnabled",value:function _checkEnabled(){var e=wr(this.editor.model.document.selection.getSelectedBlocks());if(!e||!e.is("element","listItem"))return!1;if(this._indentBy>0){var _t458=e.getAttribute("listIndent"),_i511=e.getAttribute("listType");var _n261=e.previousSibling;for(;_n261&&_n261.is("element","listItem")&&_n261.getAttribute("listIndent")>=_t458;){if(_n261.getAttribute("listIndent")==_t458)return _n261.getAttribute("listType")==_i511;_n261=_n261.previousSibling;}return!1;}return!0;}}]);}(Hr);function IS(e,t){var i=t.mapper,n=t.writer,s="numbered"==e.getAttribute("listType")?"ol":"ul",o=function(e){var t=e.createContainerElement("li");return t.getFillerOffset=HS,t;}(n),r=n.createContainerElement(s,null);return n.insert(n.createPositionAt(r,0),o),i.bindElements(e,o),o;}function VS(e,t,i,n){var s=t.parent,o=i.mapper,r=i.writer;var a=o.toViewPosition(n.createPositionBefore(e));var l=BS(e.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:e.getAttribute("listIndent")}),c=e.previousSibling;if(l&&l.getAttribute("listIndent")==e.getAttribute("listIndent")){var _e664=o.toViewElement(l);a=r.breakContainer(r.createPositionAfter(_e664));}else if(c&&"listItem"==c.name){a=o.toViewPosition(n.createPositionAt(c,"end"));var _e665=o.findMappedViewAncestor(a),_t459=MS(_e665);a=_t459?r.createPositionBefore(_t459):r.createPositionAt(_e665,"end");}else a=o.toViewPosition(n.createPositionBefore(e));if(a=OS(a),r.insert(a,s),c&&"listItem"==c.name){var _e666=o.toViewElement(c),_i512=r.createRange(r.createPositionAt(_e666,0),a).getWalker({ignoreElementEnd:!0});var _iterator705=_createForOfIteratorHelper(_i512),_step705;try{for(_iterator705.s();!(_step705=_iterator705.n()).done;){var _e667=_step705.value;if(_e667.item.is("element","li")){var _n262=r.breakContainer(r.createPositionBefore(_e667.item)),_s188=_e667.item.parent,_o110=r.createPositionAt(t,"end");RS(r,_o110.nodeBefore,_o110.nodeAfter),r.move(r.createRangeOn(_s188),_o110),_i512._position=_n262;}}}catch(err){_iterator705.e(err);}finally{_iterator705.f();}}else{var _i513=s.nextSibling;if(_i513&&(_i513.is("element","ul")||_i513.is("element","ol"))){var _n263=null;var _iterator706=_createForOfIteratorHelper(_i513.getChildren()),_step706;try{for(_iterator706.s();!(_step706=_iterator706.n()).done;){var _t460=_step706.value;var _i514=o.toModelElement(_t460);if(!(_i514&&_i514.getAttribute("listIndent")>e.getAttribute("listIndent")))break;_n263=_t460;}}catch(err){_iterator706.e(err);}finally{_iterator706.f();}_n263&&(r.breakContainer(r.createPositionAfter(_n263)),r.move(r.createRangeOn(_n263.parent),r.createPositionAt(t,"end")));}}RS(r,s,s.nextSibling),RS(r,s.previousSibling,s);}function RS(e,t,i){return!t||!i||"ul"!=t.name&&"ol"!=t.name||t.name!=i.name||t.getAttribute("class")!==i.getAttribute("class")?null:e.mergeContainers(e.createPositionAfter(t));}function OS(e){return e.getLastMatchingPosition(function(e){return e.item.is("uiElement");});}function BS(e,t){var i=!!t.sameIndent,n=!!t.smallerIndent,s=t.listIndent;var o=e;for(;o&&"listItem"==o.name;){var _e668=o.getAttribute("listIndent");if(i&&s==_e668||n&&s>_e668)return o;o="forward"===t.direction?o.nextSibling:o.previousSibling;}return null;}function MS(e){var _iterator707=_createForOfIteratorHelper(e.getChildren()),_step707;try{for(_iterator707.s();!(_step707=_iterator707.n()).done;){var _t461=_step707.value;if("ul"==_t461.name||"ol"==_t461.name)return _t461;}}catch(err){_iterator707.e(err);}finally{_iterator707.f();}return null;}function LS(e,t){var i=[],n=e.parent,s={ignoreElementEnd:!1,startPosition:e,shallow:!0,direction:t},o=n.getAttribute("listIndent"),r=_toConsumableArray(new Gl(s)).filter(function(e){return e.item.is("element");}).map(function(e){return e.item;});var _iterator708=_createForOfIteratorHelper(r),_step708;try{for(_iterator708.s();!(_step708=_iterator708.n()).done;){var _e669=_step708.value;if(!_e669.is("element","listItem"))break;if(_e669.getAttribute("listIndent")<o)break;if(!(_e669.getAttribute("listIndent")>o)){if(_e669.getAttribute("listType")!==n.getAttribute("listType"))break;if(_e669.getAttribute("listStyle")!==n.getAttribute("listStyle"))break;if(_e669.getAttribute("listReversed")!==n.getAttribute("listReversed"))break;if(_e669.getAttribute("listStart")!==n.getAttribute("listStart"))break;"backward"===t?i.unshift(_e669):i.push(_e669);}}}catch(err){_iterator708.e(err);}finally{_iterator708.f();}return i;}function FS(e){var t=_toConsumableArray(e.document.selection.getSelectedBlocks()).filter(function(e){return e.is("element","listItem");}).map(function(t){var i=e.change(function(e){return e.createPositionAt(t,0);});return[].concat(_toConsumableArray(LS(i,"backward")),_toConsumableArray(LS(i,"forward")));}).flat();return t=_toConsumableArray(new Set(t)),t;}var NS=["disc","circle","square"],DS=["decimal","decimal-leading-zero","lower-roman","upper-roman","lower-latin","upper-latin"];function zS(e){return NS.includes(e)?"bulleted":DS.includes(e)?"numbered":null;}function HS(){var e=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||e?0:ba.call(this);}var $S=/*#__PURE__*/function(_Dr188){function $S(){_classCallCheck(this,$S);return _callSuper(this,$S,arguments);}_inherits($S,_Dr188);return _createClass($S,[{key:"getListTypeFromListStyleType",value:function getListTypeFromListStyleType(e){return zS(e);}},{key:"getSelectedListItems",value:function getSelectedListItems(e){return FS(e);}},{key:"getSiblingNodes",value:function getSiblingNodes(e,t){return LS(e,t);}}],[{key:"pluginName",get:function get(){return"LegacyListUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function US(e){return function(t,i,n){var s=n.consumable;if(!s.test(i.item,"insert")||!s.test(i.item,"attribute:listType")||!s.test(i.item,"attribute:listIndent"))return;s.consume(i.item,"insert"),s.consume(i.item,"attribute:listType"),s.consume(i.item,"attribute:listIndent");var o=i.item;VS(o,IS(o,n),n,e);};}var WS=function WS(e,t,i){if(!i.consumable.test(t.item,e.name))return;var n=i.mapper.toViewElement(t.item),s=i.writer;s.breakContainer(s.createPositionBefore(n)),s.breakContainer(s.createPositionAfter(n));var o=n.parent,r="numbered"==t.attributeNewValue?"ol":"ul";s.rename(r,o);},jS=function jS(e,t,i){i.consumable.consume(t.item,e.name);var n=i.mapper.toViewElement(t.item).parent,s=i.writer;RS(s,n,n.nextSibling),RS(s,n.previousSibling,n);};var qS=function qS(e,t,i){if(i.consumable.test(t.item,e.name)&&"listItem"!=t.item.name){var _e670=i.mapper.toViewPosition(t.range.start);var _n264=i.writer,_s189=[];for(;("ul"==_e670.parent.name||"ol"==_e670.parent.name)&&(_e670=_n264.breakContainer(_e670),"li"==_e670.parent.name);){var _t462=_e670,_i515=_n264.createPositionAt(_e670.parent,"end");if(!_t462.isEqual(_i515)){var _e671=_n264.remove(_n264.createRange(_t462,_i515));_s189.push(_e671);}_e670=_n264.createPositionAfter(_e670.parent);}if(_s189.length>0){for(var _t463=0;_t463<_s189.length;_t463++){var _i516=_e670.nodeBefore;if(_e670=_n264.insert(_e670,_s189[_t463]).end,_t463>0){var _t464=RS(_n264,_i516,_i516.nextSibling);_t464&&_t464.parent==_i516&&_e670.offset--;}}RS(_n264,_e670.nodeBefore,_e670.nodeAfter);}}},GS=function GS(e,t,i){var n=i.mapper.toViewPosition(t.position),s=n.nodeBefore,o=n.nodeAfter;RS(i.writer,s,o);},KS=function KS(e,t,i){if(i.consumable.consume(t.viewItem,{name:!0})){var _e672=i.writer,_n265=_e672.createElement("listItem"),_s190=function(e){var t=0,i=e.parent;for(;i;){if(i.is("element","li"))t++;else{var _e673=i.previousSibling;_e673&&_e673.is("element","li")&&t++;}i=i.parent;}return t;}(t.viewItem);_e672.setAttribute("listIndent",_s190,_n265);var _o111=t.viewItem.parent&&"ol"==t.viewItem.parent.name?"numbered":"bulleted";if(_e672.setAttribute("listType",_o111,_n265),!i.safeInsert(_n265,t.modelCursor))return;var r=function(e,t,i){var n=i.writer,s=i.schema;var o=n.createPositionAfter(e);var _iterator709=_createForOfIteratorHelper(t),_step709;try{for(_iterator709.s();!(_step709=_iterator709.n()).done;){var _r51=_step709.value;if("ul"==_r51.name||"ol"==_r51.name)o=i.convertItem(_r51,o).modelCursor;else{var _t465=i.convertItem(_r51,n.createPositionAt(e,"end")),_a33=_t465.modelRange.start.nodeAfter;_a33&&_a33.is("element")&&!s.checkChild(e,_a33.name)&&(e=_t465.modelCursor.parent.is("element","listItem")?_t465.modelCursor.parent:XS(_t465.modelCursor),o=n.createPositionAfter(e));}}}catch(err){_iterator709.e(err);}finally{_iterator709.f();}return o;}(_n265,t.viewItem.getChildren(),i);t.modelRange=_e672.createRange(t.modelCursor,r),i.updateConversionResult(_n265,t);}},ZS=function ZS(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){var _e674=Array.from(t.viewItem.getChildren());for(var _i517=0,_e675=_e674;_i517<_e675.length;_i517++){var _t466=_e675[_i517];!(_t466.is("element","li")||tI(_t466))&&_t466._remove();}}},JS=function JS(e,t,i){if(i.consumable.test(t.viewItem,{name:!0})){if(0===t.viewItem.childCount)return;var _e676=_toConsumableArray(t.viewItem.getChildren());var _i518=!1;var _iterator710=_createForOfIteratorHelper(_e676),_step710;try{for(_iterator710.s();!(_step710=_iterator710.n()).done;){var _t467=_step710.value;_i518&&!tI(_t467)&&_t467._remove(),tI(_t467)&&(_i518=!0);}}catch(err){_iterator710.e(err);}finally{_iterator710.f();}}};function QS(e){return function(t,i){if(i.isPhantom)return;var n=i.modelPosition.nodeBefore;if(n&&n.is("element","listItem")){var _t468=i.mapper.toViewElement(n),_s191=_t468.getAncestors().find(tI),_o112=e.createPositionAt(_t468,0).getWalker();var _iterator711=_createForOfIteratorHelper(_o112),_step711;try{for(_iterator711.s();!(_step711=_iterator711.n()).done;){var _e677=_step711.value;if("elementStart"==_e677.type&&_e677.item.is("element","li")){i.viewPosition=_e677.previousPosition;break;}if("elementEnd"==_e677.type&&_e677.item==_s191){i.viewPosition=_e677.nextPosition;break;}}}catch(err){_iterator711.e(err);}finally{_iterator711.f();}}};}var YS=function YS(e,_ref269){var _ref270=_slicedToArray(_ref269,2),t=_ref270[0],i=_ref270[1];var n=this;var s,o=t.is("documentFragment")?t.getChild(0):t;if(s=i?n.createSelection(i):n.document.selection,o&&o.is("element","listItem")){var _e678=s.getFirstPosition();var _t469=null;if(_e678.parent.is("element","listItem")?_t469=_e678.parent:_e678.nodeBefore&&_e678.nodeBefore.is("element","listItem")&&(_t469=_e678.nodeBefore),_t469){var _e679=_t469.getAttribute("listIndent");if(_e679>0)for(;o&&o.is("element","listItem");)o._setAttribute("listIndent",o.getAttribute("listIndent")+_e679),o=o.nextSibling;}}};function XS(e){var t=new Gl({startPosition:e});var i;do{i=t.next();}while(!i.value.item.is("element","listItem"));return i.value.item;}function eI(e,t,i,n,s,o){var r=BS(t.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:e}),a=s.mapper,l=s.writer,c=r?r.getAttribute("listIndent"):null;var d;if(r){if(c==e){var _e680=a.toViewElement(r).parent;d=l.createPositionAfter(_e680);}else{var _e681=o.createPositionAt(r,"end");d=a.toViewPosition(_e681);}}else d=i;d=OS(d);for(var _i519=0,_arr6=_toConsumableArray(n.getChildren());_i519<_arr6.length;_i519++){var _e682=_arr6[_i519];tI(_e682)&&(d=l.move(l.createRangeOn(_e682),d).end,RS(l,_e682,_e682.nextSibling),RS(l,_e682.previousSibling,_e682));}}function tI(e){return e.is("element","ol")||e.is("element","ul");}var iI=/*#__PURE__*/function(_Dr189){function iI(){_classCallCheck(this,iI);return _callSuper(this,iI,arguments);}_inherits(iI,_Dr189);return _createClass(iI,[{key:"init",value:function init(){var _this698=this;var e=this.editor;e.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});var t=e.data,i=e.editing;var n;e.model.document.registerPostFixer(function(t){return function(e,t){var i=e.document.differ.getChanges(),n=new Map();var s=!1;var _iterator712=_createForOfIteratorHelper(i),_step712;try{for(_iterator712.s();!(_step712=_iterator712.n()).done;){var _n267=_step712.value;if("insert"==_n267.type&&"listItem"==_n267.name)o(_n267.position);else if("insert"==_n267.type&&"listItem"!=_n267.name){if("$text"!=_n267.name){var _i520=_n267.position.nodeAfter;_i520.hasAttribute("listIndent")&&(t.removeAttribute("listIndent",_i520),s=!0),_i520.hasAttribute("listType")&&(t.removeAttribute("listType",_i520),s=!0),_i520.hasAttribute("listStyle")&&(t.removeAttribute("listStyle",_i520),s=!0),_i520.hasAttribute("listReversed")&&(t.removeAttribute("listReversed",_i520),s=!0),_i520.hasAttribute("listStart")&&(t.removeAttribute("listStart",_i520),s=!0);var _iterator714=_createForOfIteratorHelper(Array.from(e.createRangeIn(_i520)).filter(function(e){return e.item.is("element","listItem");})),_step714;try{for(_iterator714.s();!(_step714=_iterator714.n()).done;){var _t472=_step714.value;o(_t472.previousPosition);}}catch(err){_iterator714.e(err);}finally{_iterator714.f();}}o(_n267.position.getShiftedBy(_n267.length));}else"remove"==_n267.type&&"listItem"==_n267.name?o(_n267.position):("attribute"==_n267.type&&"listIndent"==_n267.attributeKey||"attribute"==_n267.type&&"listType"==_n267.attributeKey)&&o(_n267.range.start);}}catch(err){_iterator712.e(err);}finally{_iterator712.f();}var _iterator713=_createForOfIteratorHelper(n.values()),_step713;try{for(_iterator713.s();!(_step713=_iterator713.n()).done;){var _e684=_step713.value;r(_e684),a(_e684);}}catch(err){_iterator713.e(err);}finally{_iterator713.f();}return s;function o(e){var t=e.nodeBefore;if(t&&t.is("element","listItem")){var _e683=t;if(n.has(_e683))return;for(var _t470=_e683.previousSibling;_t470&&_t470.is("element","listItem");_t470=_e683.previousSibling)if(_e683=_t470,n.has(_e683))return;n.set(t,_e683);}else{var _t471=e.nodeAfter;_t471&&_t471.is("element","listItem")&&n.set(_t471,_t471);}}function r(e){var i=0,n=null;for(;e&&e.is("element","listItem");){var _o113=e.getAttribute("listIndent");if(_o113>i){var _r52=void 0;null===n?(n=_o113-i,_r52=i):(n>_o113&&(n=_o113),_r52=_o113-n),t.setAttribute("listIndent",_r52,e),s=!0;}else n=null,i=e.getAttribute("listIndent")+1;e=e.nextSibling;}}function a(e){var i=[],n=null;for(;e&&e.is("element","listItem");){var _o114=e.getAttribute("listIndent");if(n&&n.getAttribute("listIndent")>_o114&&(i=i.slice(0,_o114+1)),0!=_o114)if(i[_o114]){var _n266=i[_o114];e.getAttribute("listType")!=_n266&&(t.setAttribute("listType",_n266,e),s=!0);}else i[_o114]=e.getAttribute("listType");n=e,e=e.nextSibling;}}}(e.model,t);}),i.mapper.registerViewToModelLength("li",nI),t.mapper.registerViewToModelLength("li",nI),i.mapper.on("modelToViewPosition",QS(i.view)),i.mapper.on("viewToModelPosition",(n=e.model,function(e,t){var i=t.viewPosition,s=i.parent,o=t.mapper;if("ul"==s.name||"ol"==s.name){if(i.isAtEnd){var _e685=o.toModelElement(i.nodeBefore),_s192=o.getModelLength(i.nodeBefore);t.modelPosition=n.createPositionBefore(_e685).getShiftedBy(_s192);}else{var _e686=o.toModelElement(i.nodeAfter);t.modelPosition=n.createPositionBefore(_e686);}e.stop();}else if("li"==s.name&&i.nodeBefore&&("ul"==i.nodeBefore.name||"ol"==i.nodeBefore.name)){var r=o.toModelElement(s);var _a34=1,_l21=i.nodeBefore;for(;_l21&&tI(_l21);)_a34+=o.getModelLength(_l21),_l21=_l21.previousSibling;t.modelPosition=n.createPositionBefore(r).getShiftedBy(_a34),e.stop();}})),t.mapper.on("modelToViewPosition",QS(i.view)),e.conversion["for"]("editingDowncast").add(function(t){t.on("insert",qS,{priority:"high"}),t.on("insert:listItem",US(e.model)),t.on("attribute:listType:listItem",WS,{priority:"high"}),t.on("attribute:listType:listItem",jS,{priority:"low"}),t.on("attribute:listIndent:listItem",function(e){return function(t,i,n){if(!n.consumable.consume(i.item,"attribute:listIndent"))return;var s=n.mapper.toViewElement(i.item),o=n.writer;o.breakContainer(o.createPositionBefore(s)),o.breakContainer(o.createPositionAfter(s));var r=s.parent,a=r.previousSibling,l=o.createRangeOn(r);o.remove(l),a&&a.nextSibling&&RS(o,a,a.nextSibling),eI(i.attributeOldValue+1,i.range.start,l.start,s,n,e),VS(i.item,s,n,e);var _iterator715=_createForOfIteratorHelper(i.item.getChildren()),_step715;try{for(_iterator715.s();!(_step715=_iterator715.n()).done;){var _e687=_step715.value;n.consumable.consume(_e687,"insert");}}catch(err){_iterator715.e(err);}finally{_iterator715.f();}};}(e.model)),t.on("remove:listItem",function(e){return function(t,i,n){var s=n.mapper.toViewPosition(i.position).getLastMatchingPosition(function(e){return!e.item.is("element","li");}).nodeAfter,o=n.writer;o.breakContainer(o.createPositionBefore(s)),o.breakContainer(o.createPositionAfter(s));var r=s.parent,a=r.previousSibling,l=o.createRangeOn(r),c=o.remove(l);a&&a.nextSibling&&RS(o,a,a.nextSibling),eI(n.mapper.toModelElement(s).getAttribute("listIndent")+1,i.position,l.start,s,n,e);var _iterator716=_createForOfIteratorHelper(o.createRangeIn(c).getItems()),_step716;try{for(_iterator716.s();!(_step716=_iterator716.n()).done;){var _e688=_step716.value;n.mapper.unbindViewElement(_e688);}}catch(err){_iterator716.e(err);}finally{_iterator716.f();}t.stop();};}(e.model)),t.on("remove",GS,{priority:"low"});}),e.conversion["for"]("dataDowncast").add(function(t){t.on("insert",qS,{priority:"high"}),t.on("insert:listItem",US(e.model));}),e.conversion["for"]("upcast").add(function(e){e.on("element:ul",ZS,{priority:"high"}),e.on("element:ol",ZS,{priority:"high"}),e.on("element:li",JS,{priority:"high"}),e.on("element:li",KS);}),e.model.on("insertContent",YS,{priority:"high"}),e.commands.add("numberedList",new ES(e,"numbered")),e.commands.add("bulletedList",new ES(e,"bulleted")),e.commands.add("indentList",new SS(e,"forward")),e.commands.add("outdentList",new SS(e,"backward"));var s=i.view.document;this.listenTo(s,"enter",function(e,t){var i=_this698.editor.model.document,n=i.selection.getLastPosition().parent;i.selection.isCollapsed&&"listItem"==n.name&&n.isEmpty&&(_this698.editor.execute("outdentList"),t.preventDefault(),e.stop());},{context:"li"}),this.listenTo(s,"delete",function(e,t){if("backward"!==t.direction)return;var i=_this698.editor.model.document.selection;if(!i.isCollapsed)return;var n=i.getFirstPosition();if(!n.isAtStart)return;var s=n.parent;if("listItem"!==s.name)return;s.previousSibling&&"listItem"===s.previousSibling.name||(_this698.editor.execute("outdentList"),t.preventDefault(),e.stop());},{context:"li"}),this.listenTo(e.editing.view.document,"tab",function(t,i){var n=i.shiftKey?"outdentList":"indentList";_this698.editor.commands.get(n).isEnabled&&(e.execute(n),i.stopPropagation(),i.preventDefault(),t.stop());},{context:"li"});}},{key:"afterInit",value:function afterInit(){var e=this.editor.commands,t=e.get("indent"),i=e.get("outdent");t&&t.registerChildCommand(e.get("indentList")),i&&i.registerChildCommand(e.get("outdentList"));}}],[{key:"pluginName",get:function get(){return"LegacyListEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[K_,Rw,$S];}}]);}(Dr);function nI(e){var t=1;var _iterator717=_createForOfIteratorHelper(e.getChildren()),_step717;try{for(_iterator717.s();!(_step717=_iterator717.n()).done;){var _i521=_step717.value;if("ul"==_i521.name||"ol"==_i521.name){var _iterator718=_createForOfIteratorHelper(_i521.getChildren()),_step718;try{for(_iterator718.s();!(_step718=_iterator718.n()).done;){var _e689=_step718.value;t+=nI(_e689);}}catch(err){_iterator718.e(err);}finally{_iterator718.f();}}}}catch(err){_iterator717.e(err);}finally{_iterator717.f();}return t;}var sI=/*#__PURE__*/function(_Dr190){function sI(){_classCallCheck(this,sI);return _callSuper(this,sI,arguments);}_inherits(sI,_Dr190);return _createClass(sI,null,[{key:"requires",get:function get(){return[iI,WP];}},{key:"pluginName",get:function get(){return"LegacyList";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var oI=/*#__PURE__*/function(_Hr50){function oI(e,t){var _this699;_classCallCheck(this,oI);_this699=_callSuper(this,oI,[e]),_defineProperty(_assertThisInitialized(_this699),"defaultType",void 0),_this699.defaultType=t;return _this699;}_inherits(oI,_Hr50);return _createClass(oI,[{key:"refresh",value:function refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var _this700=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this._tryToConvertItemsToList(e);var t=this.editor.model,i=FS(t);i.length&&t.change(function(t){var _iterator719=_createForOfIteratorHelper(i),_step719;try{for(_iterator719.s();!(_step719=_iterator719.n()).done;){var _n268=_step719.value;t.setAttribute("listStyle",e.type||_this700.defaultType,_n268);}}catch(err){_iterator719.e(err);}finally{_iterator719.f();}});}},{key:"_getValue",value:function _getValue(){var e=this.editor.model.document.selection.getFirstPosition().parent;return e&&e.is("element","listItem")?e.getAttribute("listStyle"):null;}},{key:"_checkEnabled",value:function _checkEnabled(){var e=this.editor,t=e.commands.get("numberedList"),i=e.commands.get("bulletedList");return t.isEnabled||i.isEnabled;}},{key:"_tryToConvertItemsToList",value:function _tryToConvertItemsToList(e){if(!e.type)return;var t=zS(e.type);if(!t)return;var i=this.editor,n="".concat(t,"List");i.commands.get(n).value||i.execute(n);}}]);}(Hr);var rI=/*#__PURE__*/function(_Hr51){function rI(){_classCallCheck(this,rI);return _callSuper(this,rI,arguments);}_inherits(rI,_Hr51);return _createClass(rI,[{key:"refresh",value:function refresh(){var e=this._getValue();this.value=e,this.isEnabled=null!=e;}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=FS(t).filter(function(e){return"numbered"==e.getAttribute("listType");});t.change(function(t){var _iterator720=_createForOfIteratorHelper(i),_step720;try{for(_iterator720.s();!(_step720=_iterator720.n()).done;){var _n269=_step720.value;t.setAttribute("listReversed",!!e.reversed,_n269);}}catch(err){_iterator720.e(err);}finally{_iterator720.f();}});}},{key:"_getValue",value:function _getValue(){var e=this.editor.model.document.selection.getFirstPosition().parent;return e&&e.is("element","listItem")&&"numbered"==e.getAttribute("listType")?e.getAttribute("listReversed"):null;}}]);}(Hr);var aI=/*#__PURE__*/function(_Hr52){function aI(){_classCallCheck(this,aI);return _callSuper(this,aI,arguments);}_inherits(aI,_Hr52);return _createClass(aI,[{key:"refresh",value:function refresh(){var e=this._getValue();this.value=e,this.isEnabled=null!=e;}},{key:"execute",value:function execute(){var _ref271=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref271$startIndex=_ref271.startIndex,e=_ref271$startIndex===void 0?1:_ref271$startIndex;var t=this.editor.model,i=FS(t).filter(function(e){return"numbered"==e.getAttribute("listType");});t.change(function(t){var _iterator721=_createForOfIteratorHelper(i),_step721;try{for(_iterator721.s();!(_step721=_iterator721.n()).done;){var _n270=_step721.value;t.setAttribute("listStart",e>=0?e:1,_n270);}}catch(err){_iterator721.e(err);}finally{_iterator721.f();}});}},{key:"_getValue",value:function _getValue(){var e=this.editor.model.document.selection.getFirstPosition().parent;return e&&e.is("element","listItem")&&"numbered"==e.getAttribute("listType")?e.getAttribute("listStart"):null;}}]);}(Hr);var lI="default";var cI=/*#__PURE__*/function(_Dr191){function cI(e){var _this701;_classCallCheck(this,cI);_this701=_callSuper(this,cI,[e]),e.config.define("list",{properties:{styles:!0,startIndex:!1,reversed:!1}});return _this701;}_inherits(cI,_Dr191);return _createClass(cI,[{key:"init",value:function init(){var e=this.editor,t=e.model,i=function(e){var t=[];e.styles&&t.push({attributeName:"listStyle",defaultValue:lI,addCommand:function addCommand(e){e.commands.add("listStyle",new oI(e,lI));},appliesToListItem:function appliesToListItem(){return!0;},setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){t&&t!==lI?e.setStyle("list-style-type",t,i):e.removeStyle("list-style-type",i);},getAttributeOnUpcast:function getAttributeOnUpcast(e){return e.getStyle("list-style-type")||lI;}});e.reversed&&t.push({attributeName:"listReversed",defaultValue:!1,addCommand:function addCommand(e){e.commands.add("listReversed",new rI(e));},appliesToListItem:function appliesToListItem(e){return"numbered"==e.getAttribute("listType");},setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){t?e.setAttribute("reversed","reversed",i):e.removeAttribute("reversed",i);},getAttributeOnUpcast:function getAttributeOnUpcast(e){return e.hasAttribute("reversed");}});e.startIndex&&t.push({attributeName:"listStart",defaultValue:1,addCommand:function addCommand(e){e.commands.add("listStart",new aI(e));},appliesToListItem:function appliesToListItem(e){return"numbered"==e.getAttribute("listType");},setAttributeOnDowncast:function setAttributeOnDowncast(e,t,i){0==t||t>1?e.setAttribute("start",t,i):e.removeAttribute("start",i);},getAttributeOnUpcast:function getAttributeOnUpcast(e){var t=e.getAttribute("start");return t>=0?t:1;}});return t;}(e.config.get("list.properties"));t.schema.extend("listItem",{allowAttributes:i.map(function(e){return e.attributeName;})});var _iterator722=_createForOfIteratorHelper(i),_step722;try{for(_iterator722.s();!(_step722=_iterator722.n()).done;){var _t477=_step722.value;_t477.addCommand(e);}}catch(err){_iterator722.e(err);}finally{_iterator722.f();}var n;this.listenTo(e.commands.get("indentList"),"_executeCleanup",function(e,t){return function(i,n){var s=n[0],o=s.getAttribute("listIndent"),r=n.filter(function(e){return e.getAttribute("listIndent")===o;});var a=null;s.previousSibling.getAttribute("listIndent")+1!==o&&(a=BS(s.previousSibling,{sameIndent:!0,direction:"backward",listIndent:o})),e.model.change(function(e){var _iterator723=_createForOfIteratorHelper(r),_step723;try{for(_iterator723.s();!(_step723=_iterator723.n()).done;){var _i522=_step723.value;var _iterator724=_createForOfIteratorHelper(t),_step724;try{for(_iterator724.s();!(_step724=_iterator724.n()).done;){var _n271=_step724.value;if(_n271.appliesToListItem(_i522)){var _t473=null==a?_n271.defaultValue:a.getAttribute(_n271.attributeName);e.setAttribute(_n271.attributeName,_t473,_i522);}}}catch(err){_iterator724.e(err);}finally{_iterator724.f();}}}catch(err){_iterator723.e(err);}finally{_iterator723.f();}});};}(e,i)),this.listenTo(e.commands.get("outdentList"),"_executeCleanup",function(e,t){return function(i,n){if(!(n=n.reverse().filter(function(e){return e.is("element","listItem");})).length)return;var s=n[0].getAttribute("listIndent"),o=n[0].getAttribute("listType");var r=n[0].previousSibling;if(r.is("element","listItem"))for(;r.getAttribute("listIndent")!==s;)r=r.previousSibling;else r=null;r||(r=n[n.length-1].nextSibling),r&&r.is("element","listItem")&&r.getAttribute("listType")===o&&e.model.change(function(e){var i=n.filter(function(e){return e.getAttribute("listIndent")===s;});var _iterator725=_createForOfIteratorHelper(i),_step725;try{for(_iterator725.s();!(_step725=_iterator725.n()).done;){var _n272=_step725.value;var _iterator726=_createForOfIteratorHelper(t),_step726;try{for(_iterator726.s();!(_step726=_iterator726.n()).done;){var _i523=_step726.value;if(_i523.appliesToListItem(_n272)){var _t474=_i523.attributeName,_s193=r.getAttribute(_t474);e.setAttribute(_t474,_s193,_n272);}}}catch(err){_iterator726.e(err);}finally{_iterator726.f();}}}catch(err){_iterator725.e(err);}finally{_iterator725.f();}});};}(e,i)),this.listenTo(e.commands.get("bulletedList"),"_executeCleanup",hI(e)),this.listenTo(e.commands.get("numberedList"),"_executeCleanup",hI(e)),t.document.registerPostFixer(function(e,t){return function(i){var n=!1;var s=mI(e.model.document.differ.getChanges()).filter(function(e){return"todo"!==e.getAttribute("listType");});if(!s.length)return n;var o=s[s.length-1].nextSibling;if((!o||!o.is("element","listItem"))&&(o=s[0].previousSibling,o)){var _e690=s[0].getAttribute("listIndent");for(;o.is("element","listItem")&&o.getAttribute("listIndent")!==_e690&&(o=o.previousSibling,o););}var _iterator727=_createForOfIteratorHelper(t),_step727;try{for(_iterator727.s();!(_step727=_iterator727.n()).done;){var _e691=_step727.value;var _t475=_e691.attributeName;var _iterator728=_createForOfIteratorHelper(s),_step728;try{for(_iterator728.s();!(_step728=_iterator728.n()).done;){var r=_step728.value;if(_e691.appliesToListItem(r)){if(r.hasAttribute(_t475)){var _s194=r.previousSibling;uI(_s194,r,_e691.attributeName)&&(i.setAttribute(_t475,_s194.getAttribute(_t475),r),n=!0);}else dI(o,r,_e691)?i.setAttribute(_t475,o.getAttribute(_t475),r):i.setAttribute(_t475,_e691.defaultValue,r),n=!0;}else i.removeAttribute(_t475,r);}}catch(err){_iterator728.e(err);}finally{_iterator728.f();}}}catch(err){_iterator727.e(err);}finally{_iterator727.f();}return n;};}(e,i)),e.conversion["for"]("upcast").add((n=i,function(e){e.on("element:li",function(e,t,i){if(!t.modelRange)return;var s=t.viewItem.parent,o=t.modelRange.start.nodeAfter||t.modelRange.end.nodeBefore;var _iterator729=_createForOfIteratorHelper(n),_step729;try{for(_iterator729.s();!(_step729=_iterator729.n()).done;){var _e692=_step729.value;if(_e692.appliesToListItem(o)){var _t476=_e692.getAttributeOnUpcast(s);i.writer.setAttribute(_e692.attributeName,_t476,o);}}}catch(err){_iterator729.e(err);}finally{_iterator729.f();}},{priority:"low"});})),e.conversion["for"]("downcast").add(function(e){return function(i){var _iterator730=_createForOfIteratorHelper(e),_step730;try{var _loop32=function _loop32(){var n=_step730.value;i.on("attribute:".concat(n.attributeName,":listItem"),function(e,i,s){var o=s.writer,r=i.item,a=BS(r.previousSibling,{sameIndent:!0,listIndent:r.getAttribute("listIndent"),direction:"backward"}),l=s.mapper.toViewElement(r);t(r,a)||o.breakContainer(o.createPositionBefore(l)),n.setAttributeOnDowncast(o,i.attributeNewValue,l.parent);},{priority:"low"});};for(_iterator730.s();!(_step730=_iterator730.n()).done;){_loop32();}}catch(err){_iterator730.e(err);}finally{_iterator730.f();}};function t(e,t){return t&&e.getAttribute("listType")===t.getAttribute("listType")&&e.getAttribute("listIndent")===t.getAttribute("listIndent")&&e.getAttribute("listStyle")===t.getAttribute("listStyle")&&e.getAttribute("listReversed")===t.getAttribute("listReversed")&&e.getAttribute("listStart")===t.getAttribute("listStart");}}(i)),this._mergeListAttributesWhileMergingLists(i);}},{key:"afterInit",value:function afterInit(){var e=this.editor;e.commands.get("todoList")&&e.model.document.registerPostFixer(function(e){return function(t){var i=mI(e.model.document.differ.getChanges()).filter(function(e){return"todo"===e.getAttribute("listType")&&(e.hasAttribute("listStyle")||e.hasAttribute("listReversed")||e.hasAttribute("listStart"));});if(!i.length)return!1;var _iterator731=_createForOfIteratorHelper(i),_step731;try{for(_iterator731.s();!(_step731=_iterator731.n()).done;){var _e693=_step731.value;t.removeAttribute("listStyle",_e693),t.removeAttribute("listReversed",_e693),t.removeAttribute("listStart",_e693);}}catch(err){_iterator731.e(err);}finally{_iterator731.f();}return!0;};}(e));}},{key:"_mergeListAttributesWhileMergingLists",value:function _mergeListAttributesWhileMergingLists(e){var t=this.editor.model;var i;this.listenTo(t,"deleteContent",function(e,_ref272){var _ref273=_slicedToArray(_ref272,1),t=_ref273[0];var n=t.getFirstPosition(),s=t.getLastPosition();if(n.parent===s.parent)return;if(!n.parent.is("element","listItem"))return;var o=s.parent.nextSibling;if(!o||!o.is("element","listItem"))return;var r=BS(n.parent,{sameIndent:!0,listIndent:o.getAttribute("listIndent")});r&&r.getAttribute("listType")===o.getAttribute("listType")&&(i=r);},{priority:"high"}),this.listenTo(t,"deleteContent",function(){i&&(t.change(function(t){var n=BS(i.nextSibling,{sameIndent:!0,listIndent:i.getAttribute("listIndent"),direction:"forward"});if(!n)return void(i=null);var s=[n].concat(_toConsumableArray(LS(t.createPositionAt(n,0),"forward")));var _iterator732=_createForOfIteratorHelper(s),_step732;try{for(_iterator732.s();!(_step732=_iterator732.n()).done;){var _n273=_step732.value;var _iterator733=_createForOfIteratorHelper(e),_step733;try{for(_iterator733.s();!(_step733=_iterator733.n()).done;){var _s195=_step733.value;if(_s195.appliesToListItem(_n273)){var _e694=_s195.attributeName,_o115=i.getAttribute(_e694);t.setAttribute(_e694,_o115,_n273);}}}catch(err){_iterator733.e(err);}finally{_iterator733.f();}}}catch(err){_iterator732.e(err);}finally{_iterator732.f();}}),i=null);},{priority:"low"});}}],[{key:"requires",get:function get(){return[iI];}},{key:"pluginName",get:function get(){return"LegacyListPropertiesEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function dI(e,t,i){if(!e)return!1;var n=e.getAttribute(i.attributeName);return!!n&&n!=i.defaultValue&&e.getAttribute("listType")===t.getAttribute("listType");}function uI(e,t,i){if(!e||!e.is("element","listItem"))return!1;if(t.getAttribute("listType")!==e.getAttribute("listType"))return!1;var n=e.getAttribute("listIndent");if(n<1||n!==t.getAttribute("listIndent"))return!1;var s=e.getAttribute(i);return!(!s||s===t.getAttribute(i));}function hI(e){return function(t,i){i=i.filter(function(e){return e.is("element","listItem");}),e.model.change(function(e){var _iterator734=_createForOfIteratorHelper(i),_step734;try{for(_iterator734.s();!(_step734=_iterator734.n()).done;){var _t478=_step734.value;e.removeAttribute("listStyle",_t478);}}catch(err){_iterator734.e(err);}finally{_iterator734.f();}});};}function mI(e){var t=[];var _iterator735=_createForOfIteratorHelper(e),_step735;try{for(_iterator735.s();!(_step735=_iterator735.n()).done;){var _i524=_step735.value;var _e695=gI(_i524);_e695&&_e695.is("element","listItem")&&t.push(_e695);}}catch(err){_iterator735.e(err);}finally{_iterator735.f();}return t;}function gI(e){return"attribute"===e.type?e.range.start.nodeAfter:"insert"===e.type?e.position.nodeAfter:null;}var fI=/*#__PURE__*/function(_Dr192){function fI(){_classCallCheck(this,fI);return _callSuper(this,fI,arguments);}_inherits(fI,_Dr192);return _createClass(fI,null,[{key:"requires",get:function get(){return[cI,dS];}},{key:"pluginName",get:function get(){return"LegacyListProperties";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pI="todoListChecked";var bI=/*#__PURE__*/function(_Hr53){function bI(e){var _this702;_classCallCheck(this,bI);_this702=_callSuper(this,bI,[e]),_defineProperty(_assertThisInitialized(_this702),"_selectedElements",void 0),_this702._selectedElements=[],_this702.on("execute",function(){_this702.refresh();},{priority:"highest"});return _this702;}_inherits(bI,_Hr53);return _createClass(bI,[{key:"refresh",value:function refresh(){this._selectedElements=this._getSelectedItems(),this.value=this._selectedElements.every(function(e){return!!e.getAttribute(pI);}),this.isEnabled=!!this._selectedElements.length;}},{key:"_getSelectedItems",value:function _getSelectedItems(){var e=this.editor.model,t=e.schema,i=e.document.selection.getFirstRange(),n=i.start.parent,s=[];t.checkAttribute(n,pI)&&s.push(n);var _iterator736=_createForOfIteratorHelper(i.getItems()),_step736;try{for(_iterator736.s();!(_step736=_iterator736.n()).done;){var _e696=_step736.value;t.checkAttribute(_e696,pI)&&!s.includes(_e696)&&s.push(_e696);}}catch(err){_iterator736.e(err);}finally{_iterator736.f();}return s;}},{key:"execute",value:function execute(){var _this703=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.editor.model.change(function(t){var _iterator737=_createForOfIteratorHelper(_this703._selectedElements),_step737;try{for(_iterator737.s();!(_step737=_iterator737.n()).done;){var _i525=_step737.value;(void 0===e.forceValue?!_this703.value:e.forceValue)?t.setAttribute(pI,!0,_i525):t.removeAttribute(pI,_i525);}}catch(err){_iterator737.e(err);}finally{_iterator737.f();}});}}]);}(Hr);var wI=function wI(e,t,i){var n=t.modelCursor,s=n.parent,o=t.viewItem;if("checkbox"!=o.getAttribute("type")||"listItem"!=s.name||!n.isAtStart)return;if(!i.consumable.consume(o,{name:!0}))return;var r=i.writer;r.setAttribute("listType","todo",s),t.viewItem.hasAttribute("checked")&&r.setAttribute("todoListChecked",!0,s),t.modelRange=r.createRange(n);};function _I(e){return function(t,i){var n=i.modelPosition,s=n.parent;if(!s.is("element","listItem")||"todo"!=s.getAttribute("listType"))return;var o=yI(i.mapper.toViewElement(s),e);o&&(i.viewPosition=i.mapper.findPositionIn(o,n.offset));};}function vI(e,t,i,n){return t.createUIElement("label",{"class":"todo-list__label",contenteditable:!1},function(t){var s=ro(document,"input",{type:"checkbox",tabindex:"-1"});i&&s.setAttribute("checked","checked"),s.addEventListener("change",function(){return n(e);});var o=this.toDomElement(t);return o.appendChild(s),o;});}function yI(e,t){var i=t.createRangeIn(e);var _iterator738=_createForOfIteratorHelper(i),_step738;try{for(_iterator738.s();!(_step738=_iterator738.n()).done;){var _e697=_step738.value;if(_e697.item.is("containerElement","span")&&_e697.item.hasClass("todo-list__label__description"))return _e697.item;}}catch(err){_iterator738.e(err);}finally{_iterator738.f();}}var kI=rr("Ctrl+Enter");var CI=/*#__PURE__*/function(_Dr193){function CI(){_classCallCheck(this,CI);return _callSuper(this,CI,arguments);}_inherits(CI,_Dr193);return _createClass(CI,[{key:"init",value:function init(){var _this704=this;var e=this.editor,t=e.editing,i=e.data,n=e.model;n.schema.extend("listItem",{allowAttributes:["todoListChecked"]}),n.schema.addAttributeCheck(function(e,t){var i=e.last;if("todoListChecked"==t&&"listItem"==i.name&&"todo"!=i.getAttribute("listType"))return!1;}),e.commands.add("todoList",new ES(e,"todo"));var s=new bI(e);var o,r;e.commands.add("checkTodoList",s),e.commands.add("todoListCheck",s),i.downcastDispatcher.on("insert:listItem",function(e){return function(t,i,n){var s=n.consumable;if(!s.test(i.item,"insert")||!s.test(i.item,"attribute:listType")||!s.test(i.item,"attribute:listIndent"))return;if("todo"!=i.item.getAttribute("listType"))return;var o=i.item;s.consume(o,"insert"),s.consume(o,"attribute:listType"),s.consume(o,"attribute:listIndent"),s.consume(o,"attribute:todoListChecked");var r=n.writer,a=IS(o,n);r.addClass("todo-list",a.parent);var l=r.createContainerElement("label",{"class":"todo-list__label"}),c=r.createEmptyElement("input",{type:"checkbox",disabled:"disabled"}),d=r.createContainerElement("span",{"class":"todo-list__label__description"});o.getAttribute("todoListChecked")&&r.setAttribute("checked","checked",c),r.insert(r.createPositionAt(a,0),l),r.insert(r.createPositionAt(l,0),c),r.insert(r.createPositionAfter(c),d),VS(o,a,n,e);};}(n),{priority:"high"}),i.upcastDispatcher.on("element:input",wI,{priority:"high"}),t.downcastDispatcher.on("insert:listItem",function(e,t){return function(i,n,s){var o=s.consumable;if(!o.test(n.item,"insert")||!o.test(n.item,"attribute:listType")||!o.test(n.item,"attribute:listIndent"))return;if("todo"!=n.item.getAttribute("listType"))return;var r=n.item;o.consume(r,"insert"),o.consume(r,"attribute:listType"),o.consume(r,"attribute:listIndent"),o.consume(r,"attribute:todoListChecked");var a=s.writer,l=IS(r,s),c=!!r.getAttribute("todoListChecked"),d=vI(r,a,c,t),u=a.createContainerElement("span",{"class":"todo-list__label__description"});a.addClass("todo-list",l.parent),a.insert(a.createPositionAt(l,0),d),a.insert(a.createPositionAfter(d),u),VS(r,l,s,e);};}(n,function(e){return _this704._handleCheckmarkChange(e);}),{priority:"high"}),t.downcastDispatcher.on("attribute:listType:listItem",(o=function o(e){return _this704._handleCheckmarkChange(e);},r=t.view,function(e,t,i){if(!i.consumable.consume(t.item,e.name))return;var n=i.mapper.toViewElement(t.item),s=i.writer,a=function(e,t){var i=t.createRangeIn(e);var _iterator739=_createForOfIteratorHelper(i),_step739;try{for(_iterator739.s();!(_step739=_iterator739.n()).done;){var _e698=_step739.value;if(_e698.item.is("uiElement","label"))return _e698.item;}}catch(err){_iterator739.e(err);}finally{_iterator739.f();}}(n,r);if("todo"==t.attributeNewValue){var _e699=!!t.item.getAttribute("todoListChecked"),_i526=vI(t.item,s,_e699,o),_r53=s.createContainerElement("span",{"class":"todo-list__label__description"}),_a35=s.createRangeIn(n),_l22=MS(n),_c17=OS(_a35.start),_d8=_l22?s.createPositionBefore(_l22):_a35.end,_u7=s.createRange(_c17,_d8);s.addClass("todo-list",n.parent),s.move(_u7,s.createPositionAt(_r53,0)),s.insert(s.createPositionAt(n,0),_i526),s.insert(s.createPositionAfter(_i526),_r53);}else if("todo"==t.attributeOldValue){var _e700=yI(n,r);s.removeClass("todo-list",n.parent),s.remove(a),s.move(s.createRangeIn(_e700),s.createPositionBefore(_e700)),s.remove(_e700);}})),t.downcastDispatcher.on("attribute:todoListChecked:listItem",function(e){return function(t,i,n){if("todo"!=i.item.getAttribute("listType"))return;if(!n.consumable.consume(i.item,"attribute:todoListChecked"))return;var s=n.mapper,o=n.writer,r=!!i.item.getAttribute("todoListChecked"),a=s.toViewElement(i.item).getChild(0),l=vI(i.item,o,r,e);o.insert(o.createPositionAfter(a),l),o.remove(a);};}(function(e){return _this704._handleCheckmarkChange(e);})),t.mapper.on("modelToViewPosition",_I(t.view)),i.mapper.on("modelToViewPosition",_I(t.view)),this.listenTo(t.view.document,"arrowKey",function(e,t){return function(i,n){if("left"!=cr(n.keyCode,t.contentLanguageDirection))return;var s=e.schema,o=e.document.selection;if(!o.isCollapsed)return;var r=o.getFirstPosition(),a=r.parent;if("listItem"===a.name&&"todo"==a.getAttribute("listType")&&r.isAtStart){var _t479=s.getNearestSelectionRange(e.createPositionBefore(a),"backward");_t479&&e.change(function(e){return e.setSelection(_t479);}),n.preventDefault(),n.stopPropagation(),i.stop();}};}(n,e.locale),{context:"li"}),this.listenTo(t.view.document,"keydown",function(t,i){or(i)===kI&&(e.execute("checkTodoList"),t.stop());},{priority:"high"});var a=new Set();this.listenTo(n,"applyOperation",function(e,t){var i=t[0];if("rename"==i.type&&"listItem"==i.oldName){var _e701=i.position.nodeAfter;_e701.hasAttribute("todoListChecked")&&a.add(_e701);}else if("changeAttribute"==i.type&&"listType"==i.key&&"todo"===i.oldValue){var _iterator740=_createForOfIteratorHelper(i.range.getItems()),_step740;try{for(_iterator740.s();!(_step740=_iterator740.n()).done;){var _e702=_step740.value;_e702.hasAttribute("todoListChecked")&&"todo"!==_e702.getAttribute("listType")&&a.add(_e702);}}catch(err){_iterator740.e(err);}finally{_iterator740.f();}}}),n.document.registerPostFixer(function(e){var t=!1;var _iterator741=_createForOfIteratorHelper(a),_step741;try{for(_iterator741.s();!(_step741=_iterator741.n()).done;){var _i527=_step741.value;e.removeAttribute("todoListChecked",_i527),t=!0;}}catch(err){_iterator741.e(err);}finally{_iterator741.f();}return a.clear(),t;}),this._initAriaAnnouncements();}},{key:"_handleCheckmarkChange",value:function _handleCheckmarkChange(e){var t=this.editor,i=t.model,n=Array.from(i.document.selection.getRanges());i.change(function(i){i.setSelection(e,"end"),t.execute("checkTodoList"),i.setSelection(n);});}},{key:"_initAriaAnnouncements",value:function _initAriaAnnouncements(){var _this$editor3=this.editor,e=_this$editor3.model,t=_this$editor3.ui,i=_this$editor3.t;var n=null;t&&e.document.selection.on("change:range",function(){var s=e.document.selection.focus.parent,o=xI(n),r=xI(s);o&&!r?t.ariaLiveAnnouncer.announce(i("Leaving a to-do list")):!o&&r&&t.ariaLiveAnnouncer.announce(i("Entering a to-do list")),n=s;});}}],[{key:"pluginName",get:function get(){return"LegacyTodoListEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[iI];}}]);}(Dr);function xI(e){return!!e&&e.is("element","listItem")&&"todo"===e.getAttribute("listType");}var AI=/*#__PURE__*/function(_Dr194){function AI(){_classCallCheck(this,AI);return _callSuper(this,AI,arguments);}_inherits(AI,_Dr194);return _createClass(AI,null,[{key:"requires",get:function get(){return[CI,xS];}},{key:"pluginName",get:function get(){return"LegacyTodoList";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var EI=/*#__PURE__*/function(_Dr195){function EI(){_classCallCheck(this,EI);return _callSuper(this,EI,arguments);}_inherits(EI,_Dr195);return _createClass(EI,[{key:"init",value:function init(){var e=this.editor;e.model.schema.register("listSeparator",{allowWhere:"$block",isBlock:!0}),e.conversion["for"]("upcast").add(function(e){e.on("element:ol",TI()),e.on("element:ul",TI());}).elementToElement({model:"listSeparator",view:"ck-list-separator"}),e.conversion["for"]("editingDowncast").elementToElement({model:"listSeparator",view:{name:"div",classes:["ck-list-separator","ck-hidden"]}}),e.conversion["for"]("dataDowncast").elementToElement({model:"listSeparator",view:function view(e,t){var i=t.writer.createContainerElement("ck-list-separator");return t.writer.setCustomProperty("dataPipeline:transparentRendering",!0,i),i.getFillerOffset=function(){return null;},i;}});}}],[{key:"pluginName",get:function get(){return"AdjacentListsSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function TI(){return function(e,t,i){var n=t.viewItem,s=n.nextSibling;if(!s)return;if(n.name!==s.name)return;t.modelRange||Object.assign(t,i.convertChildren(t.viewItem,t.modelCursor));var o=i.writer,r=o.createElement("listSeparator");if(!i.safeInsert(r,t.modelCursor))return;var a=i.getSplitParts(r);t.modelRange=o.createRange(t.modelRange.start,o.createPositionAfter(a[a.length-1])),i.updateConversionResult(r,t);};}var PI=/*#__PURE__*/function(_Dr196){function PI(e){var _this705;_classCallCheck(this,PI);_this705=_callSuper(this,PI,[e]),E("plugin-obsolete-documentlist",{pluginName:"DocumentList"});return _this705;}_inherits(PI,_Dr196);return _createClass(PI,null,[{key:"requires",get:function get(){return[jP];}},{key:"pluginName",get:function get(){return"DocumentList";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var SI=/*#__PURE__*/function(_Dr197){function SI(e){var _this706;_classCallCheck(this,SI);_this706=_callSuper(this,SI,[e]),E("plugin-obsolete-documentlistproperties",{pluginName:"DocumentListProperties"});return _this706;}_inherits(SI,_Dr197);return _createClass(SI,null,[{key:"requires",get:function get(){return[fS];}},{key:"pluginName",get:function get(){return"DocumentListProperties";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var II=/*#__PURE__*/function(_Dr198){function II(e){var _this707;_classCallCheck(this,II);_this707=_callSuper(this,II,[e]),E("plugin-obsolete-tododocumentlist",{pluginName:"TodoDocumentList"});return _this707;}_inherits(II,_Dr198);return _createClass(II,null,[{key:"requires",get:function get(){return[AS];}},{key:"pluginName",get:function get(){return"TodoDocumentList";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function VI(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};}var RI={baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1};var OI=/[&<>"']/,BI=/[&<>"']/g,MI=/[<>"']|&(?!#?\w+;)/,LI=/[<>"']|&(?!#?\w+;)/g,FI={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},NI=function NI(e){return FI[e];};function DI(e,t){if(t){if(OI.test(e))return e.replace(BI,NI);}else if(MI.test(e))return e.replace(LI,NI);return e;}var zI=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function HI(e){return e.replace(zI,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"";});}var $I=/(^|[^\[])\^/g;function UI(e,t){e=e.source||e,t=t||"";var i={replace:function replace(t,n){return n=(n=n.source||n).replace($I,"$1"),e=e.replace(t,n),i;},getRegex:function getRegex(){return new RegExp(e,t);}};return i;}var WI=/[^\w:]/g,jI=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function qI(e,t,i){if(e){var _e703;try{_e703=decodeURIComponent(HI(i)).replace(WI,"").toLowerCase();}catch(e){return null;}if(0===_e703.indexOf("javascript:")||0===_e703.indexOf("vbscript:")||0===_e703.indexOf("data:"))return null;}t&&!jI.test(i)&&(i=function(e,t){GI[" "+e]||(KI.test(e)?GI[" "+e]=e+"/":GI[" "+e]=eV(e,"/",!0));e=GI[" "+e];var i=-1===e.indexOf(":");return"//"===t.substring(0,2)?i?t:e.replace(ZI,"$1")+t:"/"===t.charAt(0)?i?t:e.replace(JI,"$1")+t:e+t;}(t,i));try{i=encodeURI(i).replace(/%25/g,"%");}catch(e){return null;}return i;}var GI={},KI=/^[^:]+:\/*[^/]*$/,ZI=/^([^:]+:)[\s\S]*$/,JI=/^([^:]+:\/*[^/]*)[\s\S]*$/;var QI={exec:function exec(){}};function YI(e){var t,i,n=1;for(;n<arguments.length;n++)for(i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e;}function XI(e,t){var i=e.replace(/\|/g,function(e,t,i){var n=!1,s=t;for(;--s>=0&&"\\"===i[s];)n=!n;return n?"|":" |";}).split(/ \|/);var n=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;n<i.length;n++)i[n]=i[n].trim().replace(/\\\|/g,"|");return i;}function eV(e,t,i){var n=e.length;if(0===n)return"";var s=0;for(;s<n;){var _o116=e.charAt(n-s-1);if(_o116!==t||i){if(_o116===t||!i)break;s++;}else s++;}return e.substr(0,n-s);}function tV(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options");}function iV(e,t){if(t<1)return"";var i="";for(;t>1;)1&t&&(i+=e),t>>=1,e+=e;return i+e;}function nV(e,t,i,n){var s=t.href,o=t.title?DI(t.title):null,r=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){n.state.inLink=!0;var _e704={type:"link",raw:i,href:s,title:o,text:r,tokens:n.inlineTokens(r,[])};return n.state.inLink=!1,_e704;}return{type:"image",raw:i,href:s,title:o,text:DI(r)};}var sV=/*#__PURE__*/function(){function sV(e){_classCallCheck(this,sV);this.options=e||RI;}return _createClass(sV,[{key:"space",value:function space(e){var t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]};}},{key:"code",value:function code(e){var t=this.rules.block.code.exec(e);if(t){var _e705=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?_e705:eV(_e705,"\n")};}}},{key:"fences",value:function fences(e){var t=this.rules.block.fences.exec(e);if(t){var _e706=t[0],_i528=function(e,t){var i=e.match(/^(\s+)(?:```)/);if(null===i)return t;var n=i[1];return t.split("\n").map(function(e){var t=e.match(/^\s+/);if(null===t)return e;var _t480=_slicedToArray(t,1),i=_t480[0];return i.length>=n.length?e.slice(n.length):e;}).join("\n");}(_e706,t[3]||"");return{type:"code",raw:_e706,lang:t[2]?t[2].trim():t[2],text:_i528};}}},{key:"heading",value:function heading(e){var t=this.rules.block.heading.exec(e);if(t){var _e707=t[2].trim();if(/#$/.test(_e707)){var _t481=eV(_e707,"#");this.options.pedantic?_e707=_t481.trim():_t481&&!/ $/.test(_t481)||(_e707=_t481.trim());}var _i529={type:"heading",raw:t[0],depth:t[1].length,text:_e707,tokens:[]};return this.lexer.inline(_i529.text,_i529.tokens),_i529;}}},{key:"hr",value:function hr(e){var t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]};}},{key:"blockquote",value:function blockquote(e){var t=this.rules.block.blockquote.exec(e);if(t){var _e708=t[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(_e708,[]),text:_e708};}}},{key:"list",value:function list(e){var t=this.rules.block.list.exec(e);if(t){var _i530,_n274,_s196,_o117,r,_a36,_l23,_c18,_d9,_u8,_h5,_m4,_g4=t[1].trim();var _f2=_g4.length>1,_p2={type:"list",raw:"",ordered:_f2,start:_f2?+_g4.slice(0,-1):"",loose:!1,items:[]};_g4=_f2?"\\d{1,9}\\".concat(_g4.slice(-1)):"\\".concat(_g4),this.options.pedantic&&(_g4=_f2?_g4:"[*+-]");var _b2=new RegExp("^( {0,3}".concat(_g4,")((?: [^\\n]*)?(?:\\n|$))"));for(;e&&(_m4=!1,t=_b2.exec(e))&&!this.rules.block.hr.test(e);){if(_i530=t[0],e=e.substring(_i530.length),_c18=t[2].split("\n",1)[0],_d9=e.split("\n",1)[0],this.options.pedantic?(_o117=2,_h5=_c18.trimLeft()):(_o117=t[2].search(/[^ ]/),_o117=_o117>4?1:_o117,_h5=_c18.slice(_o117),_o117+=t[1].length),_a36=!1,!_c18&&/^ *$/.test(_d9)&&(_i530+=_d9+"\n",e=e.substring(_d9.length+1),_m4=!0),!_m4){var _t482=new RegExp("^ {0,".concat(Math.min(3,_o117-1),"}(?:[*+-]|\\d{1,9}[.)])"));for(;e&&(_u8=e.split("\n",1)[0],_c18=_u8,this.options.pedantic&&(_c18=_c18.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!_t482.test(_c18));){if(_c18.search(/[^ ]/)>=_o117||!_c18.trim())_h5+="\n"+_c18.slice(_o117);else{if(_a36)break;_h5+="\n"+_c18;}_a36||_c18.trim()||(_a36=!0),_i530+=_u8+"\n",e=e.substring(_u8.length+1);}}_p2.loose||(_l23?_p2.loose=!0:/\n *\n *$/.test(_i530)&&(_l23=!0)),this.options.gfm&&(_n274=/^\[[ xX]\] /.exec(_h5),_n274&&(_s196="[ ] "!==_n274[0],_h5=_h5.replace(/^\[[ xX]\] +/,""))),_p2.items.push({type:"list_item",raw:_i530,task:!!_n274,checked:_s196,loose:!1,text:_h5}),_p2.raw+=_i530;}_p2.items[_p2.items.length-1].raw=_i530.trimRight(),_p2.items[_p2.items.length-1].text=_h5.trimRight(),_p2.raw=_p2.raw.trimRight();var _w2=_p2.items.length;for(r=0;r<_w2;r++){this.lexer.state.top=!1,_p2.items[r].tokens=this.lexer.blockTokens(_p2.items[r].text,[]);var _e709=_p2.items[r].tokens.filter(function(e){return"space"===e.type;}),_t483=_e709.every(function(e){var t=e.raw.split("");var i=0;var _iterator742=_createForOfIteratorHelper(t),_step742;try{for(_iterator742.s();!(_step742=_iterator742.n()).done;){var _e710=_step742.value;if("\n"===_e710&&(i+=1),i>1)return!0;}}catch(err){_iterator742.e(err);}finally{_iterator742.f();}return!1;});!_p2.loose&&_e709.length&&_t483&&(_p2.loose=!0,_p2.items[r].loose=!0);}return _p2;}}},{key:"html",value:function html(e){var t=this.rules.block.html.exec(e);if(t){var _e711={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};return this.options.sanitize&&(_e711.type="paragraph",_e711.text=this.options.sanitizer?this.options.sanitizer(t[0]):DI(t[0]),_e711.tokens=[],this.lexer.inline(_e711.text,_e711.tokens)),_e711;}}},{key:"def",value:function def(e){var t=this.rules.block.def.exec(e);if(t){t[3]&&(t[3]=t[3].substring(1,t[3].length-1));return{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]};}}},{key:"table",value:function table(e){var t=this.rules.block.table.exec(e);if(t){var _e712={type:"table",header:XI(t[1]).map(function(e){return{text:e};}),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(_e712.header.length===_e712.align.length){_e712.raw=t[0];var _i531,_n275,_s197,_o118,r=_e712.align.length;for(_i531=0;_i531<r;_i531++)/^ *-+: *$/.test(_e712.align[_i531])?_e712.align[_i531]="right":/^ *:-+: *$/.test(_e712.align[_i531])?_e712.align[_i531]="center":/^ *:-+ *$/.test(_e712.align[_i531])?_e712.align[_i531]="left":_e712.align[_i531]=null;for(r=_e712.rows.length,_i531=0;_i531<r;_i531++)_e712.rows[_i531]=XI(_e712.rows[_i531],_e712.header.length).map(function(e){return{text:e};});for(r=_e712.header.length,_n275=0;_n275<r;_n275++)_e712.header[_n275].tokens=[],this.lexer.inlineTokens(_e712.header[_n275].text,_e712.header[_n275].tokens);for(r=_e712.rows.length,_n275=0;_n275<r;_n275++)for(_o118=_e712.rows[_n275],_s197=0;_s197<_o118.length;_s197++)_o118[_s197].tokens=[],this.lexer.inlineTokens(_o118[_s197].text,_o118[_s197].tokens);return _e712;}}}},{key:"lheading",value:function lheading(e){var t=this.rules.block.lheading.exec(e);if(t){var _e713={type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:[]};return this.lexer.inline(_e713.text,_e713.tokens),_e713;}}},{key:"paragraph",value:function paragraph(e){var t=this.rules.block.paragraph.exec(e);if(t){var _e714={type:"paragraph",raw:t[0],text:"\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1],tokens:[]};return this.lexer.inline(_e714.text,_e714.tokens),_e714;}}},{key:"text",value:function text(e){var t=this.rules.block.text.exec(e);if(t){var _e715={type:"text",raw:t[0],text:t[0],tokens:[]};return this.lexer.inline(_e715.text,_e715.tokens),_e715;}}},{key:"escape",value:function escape(e){var t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:DI(t[1])};}},{key:"tag",value:function tag(e){var t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):DI(t[0]):t[0]};}},{key:"link",value:function link(e){var t=this.rules.inline.link.exec(e);if(t){var _e716=t[2].trim();if(!this.options.pedantic&&/^</.test(_e716)){if(!/>$/.test(_e716))return;var _t484=eV(_e716.slice(0,-1),"\\");if((_e716.length-_t484.length)%2==0)return;}else{var _e717=function(e,t){if(-1===e.indexOf(t[1]))return-1;var i=e.length;var n=0,s=0;for(;s<i;s++)if("\\"===e[s])s++;else if(e[s]===t[0])n++;else if(e[s]===t[1]&&(n--,n<0))return s;return-1;}(t[2],"()");if(_e717>-1){var _i532=(0===t[0].indexOf("!")?5:4)+t[1].length+_e717;t[2]=t[2].substring(0,_e717),t[0]=t[0].substring(0,_i532).trim(),t[3]="";}}var _i533=t[2],_n276="";if(this.options.pedantic){var _e718=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(_i533);_e718&&(_i533=_e718[1],_n276=_e718[3]);}else _n276=t[3]?t[3].slice(1,-1):"";return _i533=_i533.trim(),/^</.test(_i533)&&(_i533=this.options.pedantic&&!/>$/.test(_e716)?_i533.slice(1):_i533.slice(1,-1)),nV(t,{href:_i533?_i533.replace(this.rules.inline._escapes,"$1"):_i533,title:_n276?_n276.replace(this.rules.inline._escapes,"$1"):_n276},t[0],this.lexer);}}},{key:"reflink",value:function reflink(e,t){var i;if((i=this.rules.inline.reflink.exec(e))||(i=this.rules.inline.nolink.exec(e))){var _e719=(i[2]||i[1]).replace(/\s+/g," ");if(_e719=t[_e719.toLowerCase()],!_e719||!_e719.href){var _e720=i[0].charAt(0);return{type:"text",raw:_e720,text:_e720};}return nV(i,_e719,i[0],this.lexer);}}},{key:"emStrong",value:function emStrong(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var n=this.rules.inline.emStrong.lDelim.exec(e);if(!n)return;if(n[3]&&i.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CD\uA7D0\uA7D1\uA7D3\uA7D5-\uA7DC\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDD40-\uDD65\uDD6F-\uDD85\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC4\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D\uDD30-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDDD0-\uDDED\uDDF0-\uDDFA\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF])/))return;var s=n[1]||n[2]||"";if(!s||s&&(""===i||this.rules.inline.punctuation.exec(i))){var _i534=n[0].length-1;var _s198,_o119,r=_i534,_a37=0;var _l24="*"===n[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(_l24.lastIndex=0,t=t.slice(-1*e.length+_i534);null!=(n=_l24.exec(t));){if(_s198=n[1]||n[2]||n[3]||n[4]||n[5]||n[6],!_s198)continue;if(_o119=_s198.length,n[3]||n[4]){r+=_o119;continue;}if((n[5]||n[6])&&_i534%3&&!((_i534+_o119)%3)){_a37+=_o119;continue;}if(r-=_o119,r>0)continue;if(_o119=Math.min(_o119,_o119+r+_a37),Math.min(_i534,_o119)%2){var _t485=e.slice(1,_i534+n.index+_o119);return{type:"em",raw:e.slice(0,_i534+n.index+_o119+1),text:_t485,tokens:this.lexer.inlineTokens(_t485,[])};}var _t486=e.slice(2,_i534+n.index+_o119-1);return{type:"strong",raw:e.slice(0,_i534+n.index+_o119+1),text:_t486,tokens:this.lexer.inlineTokens(_t486,[])};}}}},{key:"codespan",value:function codespan(e){var t=this.rules.inline.code.exec(e);if(t){var _e721=t[2].replace(/\n/g," ");var _i535=/[^ ]/.test(_e721),_n277=/^ /.test(_e721)&&/ $/.test(_e721);return _i535&&_n277&&(_e721=_e721.substring(1,_e721.length-1)),_e721=DI(_e721,!0),{type:"codespan",raw:t[0],text:_e721};}}},{key:"br",value:function br(e){var t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]};}},{key:"del",value:function del(e){var t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2],[])};}},{key:"autolink",value:function autolink(e,t){var i=this.rules.inline.autolink.exec(e);if(i){var _e722,_n278;return"@"===i[2]?(_e722=DI(this.options.mangle?t(i[1]):i[1]),_n278="mailto:"+_e722):(_e722=DI(i[1]),_n278=_e722),{type:"link",raw:i[0],text:_e722,href:_n278,tokens:[{type:"text",raw:_e722,text:_e722}]};}}},{key:"url",value:function url(e,t){var i;if(i=this.rules.inline.url.exec(e)){var _e723,_n279;if("@"===i[2])_e723=DI(this.options.mangle?t(i[0]):i[0]),_n279="mailto:"+_e723;else{var _t487;do{_t487=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];}while(_t487!==i[0]);_e723=DI(i[0]),_n279="www."===i[1]?"http://"+_e723:_e723;}return{type:"link",raw:i[0],text:_e723,href:_n279,tokens:[{type:"text",raw:_e723,text:_e723}]};}}},{key:"inlineText",value:function inlineText(e,t){var i=this.rules.inline.text.exec(e);if(i){var _e724;return _e724=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):DI(i[0]):i[0]:DI(this.options.smartypants?t(i[0]):i[0]),{type:"text",raw:i[0],text:_e724};}}}]);}();var oV={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:QI,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};oV.def=UI(oV.def).replace("label",oV._label).replace("title",oV._title).getRegex(),oV.bullet=/(?:[*+-]|\d{1,9}[.)])/,oV.listItemStart=UI(/^( *)(bull) */).replace("bull",oV.bullet).getRegex(),oV.list=UI(oV.list).replace(/bull/g,oV.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+oV.def.source+")").getRegex(),oV._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",oV._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,oV.html=UI(oV.html,"i").replace("comment",oV._comment).replace("tag",oV._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),oV.paragraph=UI(oV._paragraph).replace("hr",oV.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",oV._tag).getRegex(),oV.blockquote=UI(oV.blockquote).replace("paragraph",oV.paragraph).getRegex(),oV.normal=YI({},oV),oV.gfm=YI({},oV.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),oV.gfm.table=UI(oV.gfm.table).replace("hr",oV.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",oV._tag).getRegex(),oV.gfm.paragraph=UI(oV._paragraph).replace("hr",oV.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",oV.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",oV._tag).getRegex(),oV.pedantic=YI({},oV.normal,{html:UI("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",oV._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:QI,paragraph:UI(oV.normal._paragraph).replace("hr",oV.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",oV.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var rV={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:QI,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:QI,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function aV(e){return e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…");}function lV(e){var t,i,n="";var s=e.length;for(t=0;t<s;t++)i=e.charCodeAt(t),Math.random()>.5&&(i="x"+i.toString(16)),n+="&#"+i+";";return n;}rV._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",rV.punctuation=UI(rV.punctuation).replace(/punctuation/g,rV._punctuation).getRegex(),rV.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,rV.escapedEmSt=/\\\*|\\_/g,rV._comment=UI(oV._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),rV.emStrong.lDelim=UI(rV.emStrong.lDelim).replace(/punct/g,rV._punctuation).getRegex(),rV.emStrong.rDelimAst=UI(rV.emStrong.rDelimAst,"g").replace(/punct/g,rV._punctuation).getRegex(),rV.emStrong.rDelimUnd=UI(rV.emStrong.rDelimUnd,"g").replace(/punct/g,rV._punctuation).getRegex(),rV._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,rV._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,rV._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,rV.autolink=UI(rV.autolink).replace("scheme",rV._scheme).replace("email",rV._email).getRegex(),rV._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,rV.tag=UI(rV.tag).replace("comment",rV._comment).replace("attribute",rV._attribute).getRegex(),rV._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,rV._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,rV._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,rV.link=UI(rV.link).replace("label",rV._label).replace("href",rV._href).replace("title",rV._title).getRegex(),rV.reflink=UI(rV.reflink).replace("label",rV._label).replace("ref",oV._label).getRegex(),rV.nolink=UI(rV.nolink).replace("ref",oV._label).getRegex(),rV.reflinkSearch=UI(rV.reflinkSearch,"g").replace("reflink",rV.reflink).replace("nolink",rV.nolink).getRegex(),rV.normal=YI({},rV),rV.pedantic=YI({},rV.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:UI(/^!?\[(label)\]\((.*?)\)/).replace("label",rV._label).getRegex(),reflink:UI(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",rV._label).getRegex()}),rV.gfm=YI({},rV.normal,{escape:UI(rV.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),rV.gfm.url=UI(rV.gfm.url,"i").replace("email",rV.gfm._extended_email).getRegex(),rV.breaks=YI({},rV.gfm,{br:UI(rV.br).replace("{2,}","*").getRegex(),text:UI(rV.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var cV=/*#__PURE__*/function(){function cV(e){_classCallCheck(this,cV);this.tokens=[],this.tokens.links=Object.create(null),this.options=e||RI,this.options.tokenizer=this.options.tokenizer||new sV(),this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var t={block:oV.normal,inline:rV.normal};this.options.pedantic?(t.block=oV.pedantic,t.inline=rV.pedantic):this.options.gfm&&(t.block=oV.gfm,this.options.breaks?t.inline=rV.breaks:t.inline=rV.gfm),this.tokenizer.rules=t;}return _createClass(cV,[{key:"lex",value:function lex(e){var t;for(e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    "),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens;}},{key:"blockTokens",value:function blockTokens(e){var _this708=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i,n,s,o;var _loop33=function _loop33(){if(!(_this708.options.extensions&&_this708.options.extensions.block&&_this708.options.extensions.block.some(function(n){return!!(i=n.call({lexer:_this708},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0);})))if(i=_this708.tokenizer.space(e))e=e.substring(i.raw.length),1===i.raw.length&&t.length>0?t[t.length-1].raw+="\n":t.push(i);else if(i=_this708.tokenizer.code(e))e=e.substring(i.raw.length),n=t[t.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?t.push(i):(n.raw+="\n"+i.raw,n.text+="\n"+i.text,_this708.inlineQueue[_this708.inlineQueue.length-1].src=n.text);else if(i=_this708.tokenizer.fences(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.heading(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.hr(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.blockquote(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.list(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.html(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.def(e))e=e.substring(i.raw.length),n=t[t.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?_this708.tokens.links[i.tag]||(_this708.tokens.links[i.tag]={href:i.href,title:i.title}):(n.raw+="\n"+i.raw,n.text+="\n"+i.raw,_this708.inlineQueue[_this708.inlineQueue.length-1].src=n.text);else if(i=_this708.tokenizer.table(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this708.tokenizer.lheading(e))e=e.substring(i.raw.length),t.push(i);else{if(s=e,_this708.options.extensions&&_this708.options.extensions.startBlock){var _t488=1/0;var _i536=e.slice(1);var _n280;_this708.options.extensions.startBlock.forEach(function(e){_n280=e.call({lexer:this},_i536),"number"==typeof _n280&&_n280>=0&&(_t488=Math.min(_t488,_n280));}),_t488<1/0&&_t488>=0&&(s=e.substring(0,_t488+1));}if(_this708.state.top&&(i=_this708.tokenizer.paragraph(s)))n=t[t.length-1],o&&"paragraph"===n.type?(n.raw+="\n"+i.raw,n.text+="\n"+i.text,_this708.inlineQueue.pop(),_this708.inlineQueue[_this708.inlineQueue.length-1].src=n.text):t.push(i),o=s.length!==e.length,e=e.substring(i.raw.length);else if(i=_this708.tokenizer.text(e))e=e.substring(i.raw.length),n=t[t.length-1],n&&"text"===n.type?(n.raw+="\n"+i.raw,n.text+="\n"+i.text,_this708.inlineQueue.pop(),_this708.inlineQueue[_this708.inlineQueue.length-1].src=n.text):t.push(i);else if(e){var _t489="Infinite loop on byte: "+e.charCodeAt(0);if(_this708.options.silent){console.error(_t489);return 1;// break
}throw new Error(_t489);}}};for(this.options.pedantic&&(e=e.replace(/^ +$/gm,""));e;){if(_loop33())break;}return this.state.top=!0,t;}},{key:"inline",value:function inline(e,t){this.inlineQueue.push({src:e,tokens:t});}},{key:"inlineTokens",value:function inlineTokens(e){var _this709=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i,n,s,o,r,a,l=e;if(this.tokens.links){var _e725=Object.keys(this.tokens.links);if(_e725.length>0)for(;null!=(o=this.tokenizer.rules.inline.reflinkSearch.exec(l));)_e725.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,o.index)+"["+iV("a",o[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex));}for(;null!=(o=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,o.index)+"["+iV("a",o[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(o=this.tokenizer.rules.inline.escapedEmSt.exec(l));)l=l.slice(0,o.index)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);var _loop34=function _loop34(){if(r||(a=""),r=!1,!(_this709.options.extensions&&_this709.options.extensions.inline&&_this709.options.extensions.inline.some(function(n){return!!(i=n.call({lexer:_this709},e,t))&&(e=e.substring(i.raw.length),t.push(i),!0);})))if(i=_this709.tokenizer.escape(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this709.tokenizer.tag(e))e=e.substring(i.raw.length),n=t[t.length-1],n&&"text"===i.type&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(i=_this709.tokenizer.link(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this709.tokenizer.reflink(e,_this709.tokens.links))e=e.substring(i.raw.length),n=t[t.length-1],n&&"text"===i.type&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(i=_this709.tokenizer.emStrong(e,l,a))e=e.substring(i.raw.length),t.push(i);else if(i=_this709.tokenizer.codespan(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this709.tokenizer.br(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this709.tokenizer.del(e))e=e.substring(i.raw.length),t.push(i);else if(i=_this709.tokenizer.autolink(e,lV))e=e.substring(i.raw.length),t.push(i);else if(_this709.state.inLink||!(i=_this709.tokenizer.url(e,lV))){if(s=e,_this709.options.extensions&&_this709.options.extensions.startInline){var _t490=1/0;var _i537=e.slice(1);var _n281;_this709.options.extensions.startInline.forEach(function(e){_n281=e.call({lexer:this},_i537),"number"==typeof _n281&&_n281>=0&&(_t490=Math.min(_t490,_n281));}),_t490<1/0&&_t490>=0&&(s=e.substring(0,_t490+1));}if(i=_this709.tokenizer.inlineText(s,aV))e=e.substring(i.raw.length),"_"!==i.raw.slice(-1)&&(a=i.raw.slice(-1)),r=!0,n=t[t.length-1],n&&"text"===n.type?(n.raw+=i.raw,n.text+=i.text):t.push(i);else if(e){var _t491="Infinite loop on byte: "+e.charCodeAt(0);if(_this709.options.silent){console.error(_t491);return 1;// break
}throw new Error(_t491);}}else e=e.substring(i.raw.length),t.push(i);};for(;e;){if(_loop34())break;}return t;}}],[{key:"rules",get:function get(){return{block:oV,inline:rV};}},{key:"lex",value:function lex(e,t){return new cV(t).lex(e);}},{key:"lexInline",value:function lexInline(e,t){return new cV(t).inlineTokens(e);}}]);}();var dV=/*#__PURE__*/function(){function dV(e){_classCallCheck(this,dV);this.options=e||RI;}return _createClass(dV,[{key:"code",value:function code(e,t,i){var n=(t||"").match(/\S*/)[0];if(this.options.highlight){var _t492=this.options.highlight(e,n);null!=_t492&&_t492!==e&&(i=!0,e=_t492);}return e=e.replace(/\n$/,"")+"\n",n?'<pre><code class="'+this.options.langPrefix+DI(n,!0)+'">'+(i?e:DI(e,!0))+"</code></pre>\n":"<pre><code>"+(i?e:DI(e,!0))+"</code></pre>\n";}},{key:"blockquote",value:function blockquote(e){return"<blockquote>\n"+e+"</blockquote>\n";}},{key:"html",value:function html(e){return e;}},{key:"heading",value:function heading(e,t,i,n){return this.options.headerIds?"<h"+t+' id="'+this.options.headerPrefix+n.slug(i)+'">'+e+"</h"+t+">\n":"<h"+t+">"+e+"</h"+t+">\n";}},{key:"hr",value:function hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n";}},{key:"list",value:function list(e,t,i){var n=t?"ol":"ul";return"<"+n+(t&&1!==i?' start="'+i+'"':"")+">\n"+e+"</"+n+">\n";}},{key:"listitem",value:function listitem(e){return"<li>"+e+"</li>\n";}},{key:"checkbox",value:function checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> ";}},{key:"paragraph",value:function paragraph(e){return"<p>"+e+"</p>\n";}},{key:"table",value:function table(e,t){return t&&(t="<tbody>"+t+"</tbody>"),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n";}},{key:"tablerow",value:function tablerow(e){return"<tr>\n"+e+"</tr>\n";}},{key:"tablecell",value:function tablecell(e,t){var i=t.header?"th":"td";return(t.align?"<"+i+' align="'+t.align+'">':"<"+i+">")+e+"</"+i+">\n";}},{key:"strong",value:function strong(e){return"<strong>"+e+"</strong>";}},{key:"em",value:function em(e){return"<em>"+e+"</em>";}},{key:"codespan",value:function codespan(e){return"<code>"+e+"</code>";}},{key:"br",value:function br(){return this.options.xhtml?"<br/>":"<br>";}},{key:"del",value:function del(e){return"<del>"+e+"</del>";}},{key:"link",value:function link(e,t,i){if(null===(e=qI(this.options.sanitize,this.options.baseUrl,e)))return i;var n='<a href="'+DI(e)+'"';return t&&(n+=' title="'+t+'"'),n+=">"+i+"</a>",n;}},{key:"image",value:function image(e,t,i){if(null===(e=qI(this.options.sanitize,this.options.baseUrl,e)))return i;var n='<img src="'+e+'" alt="'+i+'"';return t&&(n+=' title="'+t+'"'),n+=this.options.xhtml?"/>":">",n;}},{key:"text",value:function text(e){return e;}}]);}();var uV=/*#__PURE__*/function(){function uV(){_classCallCheck(this,uV);}return _createClass(uV,[{key:"strong",value:function strong(e){return e;}},{key:"em",value:function em(e){return e;}},{key:"codespan",value:function codespan(e){return e;}},{key:"del",value:function del(e){return e;}},{key:"html",value:function html(e){return e;}},{key:"text",value:function text(e){return e;}},{key:"link",value:function link(e,t,i){return""+i;}},{key:"image",value:function image(e,t,i){return""+i;}},{key:"br",value:function br(){return"";}}]);}();var hV=/*#__PURE__*/function(){function hV(){_classCallCheck(this,hV);this.seen={};}return _createClass(hV,[{key:"serialize",value:function serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-");}},{key:"getNextSafeSlug",value:function getNextSafeSlug(e,t){var i=e,n=0;if(this.seen.hasOwnProperty(i)){n=this.seen[e];do{n++,i=e+"-"+n;}while(this.seen.hasOwnProperty(i));}return t||(this.seen[e]=n,this.seen[i]=0),i;}},{key:"slug",value:function slug(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.serialize(e);return this.getNextSafeSlug(i,t.dryrun);}}]);}();var mV=/*#__PURE__*/function(){function mV(e){_classCallCheck(this,mV);this.options=e||RI,this.options.renderer=this.options.renderer||new dV(),this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new uV(),this.slugger=new hV();}return _createClass(mV,[{key:"parse",value:function parse(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var i,n,s,o,r,a,l,c,d,u,h,m,g,f,p,b,w,_,v,y="";var k=e.length;for(i=0;i<k;i++)if(u=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[u.type]&&(v=this.options.extensions.renderers[u.type].call({parser:this},u),!1!==v||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(u.type)))y+=v||"";else switch(u.type){case"space":continue;case"hr":y+=this.renderer.hr();continue;case"heading":y+=this.renderer.heading(this.parseInline(u.tokens),u.depth,HI(this.parseInline(u.tokens,this.textRenderer)),this.slugger);continue;case"code":y+=this.renderer.code(u.text,u.lang,u.escaped);continue;case"table":for(c="",l="",o=u.header.length,n=0;n<o;n++)l+=this.renderer.tablecell(this.parseInline(u.header[n].tokens),{header:!0,align:u.align[n]});for(c+=this.renderer.tablerow(l),d="",o=u.rows.length,n=0;n<o;n++){for(a=u.rows[n],l="",r=a.length,s=0;s<r;s++)l+=this.renderer.tablecell(this.parseInline(a[s].tokens),{header:!1,align:u.align[s]});d+=this.renderer.tablerow(l);}y+=this.renderer.table(c,d);continue;case"blockquote":d=this.parse(u.tokens),y+=this.renderer.blockquote(d);continue;case"list":for(h=u.ordered,m=u.start,g=u.loose,o=u.items.length,d="",n=0;n<o;n++)p=u.items[n],b=p.checked,w=p.task,f="",p.task&&(_=this.renderer.checkbox(b),g?p.tokens.length>0&&"paragraph"===p.tokens[0].type?(p.tokens[0].text=_+" "+p.tokens[0].text,p.tokens[0].tokens&&p.tokens[0].tokens.length>0&&"text"===p.tokens[0].tokens[0].type&&(p.tokens[0].tokens[0].text=_+" "+p.tokens[0].tokens[0].text)):p.tokens.unshift({type:"text",text:_}):f+=_),f+=this.parse(p.tokens,g),d+=this.renderer.listitem(f,w,b);y+=this.renderer.list(d,h,m);continue;case"html":y+=this.renderer.html(u.text);continue;case"paragraph":y+=this.renderer.paragraph(this.parseInline(u.tokens));continue;case"text":for(d=u.tokens?this.parseInline(u.tokens):u.text;i+1<k&&"text"===e[i+1].type;)u=e[++i],d+="\n"+(u.tokens?this.parseInline(u.tokens):u.text);y+=t?this.renderer.paragraph(d):d;continue;default:{var _e726='Token with "'+u.type+'" type was not found.';if(this.options.silent)return void console.error(_e726);throw new Error(_e726);}}return y;}},{key:"parseInline",value:function parseInline(e,t){t=t||this.renderer;var i,n,s,o="";var r=e.length;for(i=0;i<r;i++)if(n=e[i],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[n.type]&&(s=this.options.extensions.renderers[n.type].call({parser:this},n),!1!==s||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(n.type)))o+=s||"";else switch(n.type){case"escape":case"text":o+=t.text(n.text);break;case"html":o+=t.html(n.text);break;case"link":o+=t.link(n.href,n.title,this.parseInline(n.tokens,t));break;case"image":o+=t.image(n.href,n.title,n.text);break;case"strong":o+=t.strong(this.parseInline(n.tokens,t));break;case"em":o+=t.em(this.parseInline(n.tokens,t));break;case"codespan":o+=t.codespan(n.text);break;case"br":o+=t.br();break;case"del":o+=t.del(this.parseInline(n.tokens,t));break;default:{var _e727='Token with "'+n.type+'" type was not found.';if(this.options.silent)return void console.error(_e727);throw new Error(_e727);}}return o;}}],[{key:"parse",value:function parse(e,t){return new mV(t).parse(e);}},{key:"parseInline",value:function parseInline(e,t){return new mV(t).parseInline(e);}}]);}();function gV(e,t,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(i=t,t=null),tV(t=YI({},gV.defaults,t||{})),i){var _n282=t.highlight;var _s199;try{_s199=cV.lex(e,t);}catch(e){return i(e);}var _o120=function _o120(e){var o;if(!e)try{t.walkTokens&&gV.walkTokens(_s199,t.walkTokens),o=mV.parse(_s199,t);}catch(t){e=t;}return t.highlight=_n282,e?i(e):i(null,o);};if(!_n282||_n282.length<3)return _o120();if(delete t.highlight,!_s199.length)return _o120();var r=0;return gV.walkTokens(_s199,function(e){"code"===e.type&&(r++,setTimeout(function(){_n282(e.text,e.lang,function(t,i){if(t)return _o120(t);null!=i&&i!==e.text&&(e.text=i,e.escaped=!0),r--,0===r&&_o120();});},0));}),void(0===r&&_o120());}try{var _i538=cV.lex(e,t);return t.walkTokens&&gV.walkTokens(_i538,t.walkTokens),mV.parse(_i538,t);}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+DI(e.message+"",!0)+"</pre>";throw e;}}gV.options=gV.setOptions=function(e){var t;return YI(gV.defaults,e),t=gV.defaults,RI=t,gV;},gV.getDefaults=VI,gV.defaults=RI,gV.use=function(){for(var _len88=arguments.length,e=new Array(_len88),_key88=0;_key88<_len88;_key88++){e[_key88]=arguments[_key88];}var t=YI.apply(void 0,[{}].concat(e)),i=gV.defaults.extensions||{renderers:{},childTokens:{}};var n;e.forEach(function(e){if(e.extensions&&(n=!0,e.extensions.forEach(function(e){if(!e.name)throw new Error("extension name required");if(e.renderer){var _t493=i.renderers?i.renderers[e.name]:null;i.renderers[e.name]=_t493?function(){for(var _len89=arguments.length,i=new Array(_len89),_key89=0;_key89<_len89;_key89++){i[_key89]=arguments[_key89];}var n=e.renderer.apply(this,i);return!1===n&&(n=_t493.apply(this,i)),n;}:e.renderer;}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");i[e.level]?i[e.level].unshift(e.tokenizer):i[e.level]=[e.tokenizer],e.start&&("block"===e.level?i.startBlock?i.startBlock.push(e.start):i.startBlock=[e.start]:"inline"===e.level&&(i.startInline?i.startInline.push(e.start):i.startInline=[e.start]));}e.childTokens&&(i.childTokens[e.name]=e.childTokens);})),e.renderer){var _i539=gV.defaults.renderer||new dV();var _loop35=function _loop35(_t494){var n=_i539[_t494];_i539[_t494]=function(){for(var _len90=arguments.length,s=new Array(_len90),_key90=0;_key90<_len90;_key90++){s[_key90]=arguments[_key90];}var o=e.renderer[_t494].apply(_i539,s);return!1===o&&(o=n.apply(_i539,s)),o;};};for(var _t494 in e.renderer){_loop35(_t494);}t.renderer=_i539;}if(e.tokenizer){var _i540=gV.defaults.tokenizer||new sV();var _loop36=function _loop36(_t495){var n=_i540[_t495];_i540[_t495]=function(){for(var _len91=arguments.length,s=new Array(_len91),_key91=0;_key91<_len91;_key91++){s[_key91]=arguments[_key91];}var o=e.tokenizer[_t495].apply(_i540,s);return!1===o&&(o=n.apply(_i540,s)),o;};};for(var _t495 in e.tokenizer){_loop36(_t495);}t.tokenizer=_i540;}if(e.walkTokens){var _i541=gV.defaults.walkTokens;t.walkTokens=function(t){e.walkTokens.call(this,t),_i541&&_i541.call(this,t);};}n&&(t.extensions=i),gV.setOptions(t);});},gV.walkTokens=function(e,t){var _iterator743=_createForOfIteratorHelper(e),_step743;try{var _loop37=function _loop37(){var i=_step743.value;switch(t.call(gV,i),i.type){case"table":var _iterator744=_createForOfIteratorHelper(i.header),_step744;try{for(_iterator744.s();!(_step744=_iterator744.n()).done;){var _e728=_step744.value;gV.walkTokens(_e728.tokens,t);}}catch(err){_iterator744.e(err);}finally{_iterator744.f();}var _iterator745=_createForOfIteratorHelper(i.rows),_step745;try{for(_iterator745.s();!(_step745=_iterator745.n()).done;){var _e729=_step745.value;var _iterator746=_createForOfIteratorHelper(_e729),_step746;try{for(_iterator746.s();!(_step746=_iterator746.n()).done;){var _i542=_step746.value;gV.walkTokens(_i542.tokens,t);}}catch(err){_iterator746.e(err);}finally{_iterator746.f();}}}catch(err){_iterator745.e(err);}finally{_iterator745.f();}break;case"list":gV.walkTokens(i.items,t);break;default:gV.defaults.extensions&&gV.defaults.extensions.childTokens&&gV.defaults.extensions.childTokens[i.type]?gV.defaults.extensions.childTokens[i.type].forEach(function(e){gV.walkTokens(i[e],t);}):i.tokens&&gV.walkTokens(i.tokens,t);}};for(_iterator743.s();!(_step743=_iterator743.n()).done;){_loop37();}}catch(err){_iterator743.e(err);}finally{_iterator743.f();}},gV.parseInline=function(e,t){if(null==e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");tV(t=YI({},gV.defaults,t||{}));try{var _i543=cV.lexInline(e,t);return t.walkTokens&&gV.walkTokens(_i543,t.walkTokens),mV.parseInline(_i543,t);}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+DI(e.message+"",!0)+"</pre>";throw e;}},gV.Parser=mV,gV.parser=mV.parse,gV.Renderer=dV,gV.TextRenderer=uV,gV.Lexer=cV,gV.lexer=cV.lex,gV.Tokenizer=sV,gV.Slugger=hV,gV.parse=gV,gV.options,gV.setOptions,gV.use,gV.walkTokens,gV.parseInline,mV.parse,cV.lex;var fV=/*#__PURE__*/function(){function fV(){_classCallCheck(this,fV);_defineProperty(this,"_parser",void 0);_defineProperty(this,"_options",{gfm:!0,breaks:!0,tables:!0,xhtml:!0,headerIds:!1});gV.use({tokenizer:{autolink:function autolink(){return null;},url:function url(){return null;}},renderer:{checkbox:function checkbox(){var _Object$getPrototypeO;for(var _len92=arguments.length,e=new Array(_len92),_key92=0;_key92<_len92;_key92++){e[_key92]=arguments[_key92];}return(_Object$getPrototypeO=Object.getPrototypeOf(this).checkbox).call.apply(_Object$getPrototypeO,[this].concat(e)).trimRight();},code:function code(){var _Object$getPrototypeO2;for(var _len93=arguments.length,e=new Array(_len93),_key93=0;_key93<_len93;_key93++){e[_key93]=arguments[_key93];}return(_Object$getPrototypeO2=Object.getPrototypeOf(this).code).call.apply(_Object$getPrototypeO2,[this].concat(e)).replace("\n</code>","</code>");}}}),this._parser=gV;}return _createClass(fV,[{key:"parse",value:function parse(e){return this._parser.parse(e,this._options);}}]);}();function pV(e,t){return Array(t+1).join(e);}var bV=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function wV(e){return kV(e,bV);}var _V=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function vV(e){return kV(e,_V);}var yV=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function kV(e,t){return t.indexOf(e.nodeName)>=0;}function CV(e,t){return e.getElementsByTagName&&t.some(function(t){return e.getElementsByTagName(t).length;});}var xV={};function AV(e){return e?e.replace(/(\n+\s*)+/g,"\n"):"";}function EV(e){for(var t in this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[],e.rules)this.array.push(e.rules[t]);}function TV(e,t,i){for(var n=0;n<e.length;n++){var s=e[n];if(PV(s,t,i))return s;}}function PV(e,t,i){var n=e.filter;if("string"==typeof n){if(n===t.nodeName.toLowerCase())return!0;}else if(Array.isArray(n)){if(n.indexOf(t.nodeName.toLowerCase())>-1)return!0;}else{if("function"!=typeof n)throw new TypeError("`filter` needs to be a string, array, or function");if(n.call(e,t,i))return!0;}}function SV(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t;}function IV(e,t,i){return e&&e.parentNode===t||i(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode;}xV.paragraph={filter:"p",replacement:function replacement(e){return"\n\n"+e+"\n\n";}},xV.lineBreak={filter:"br",replacement:function replacement(e,t,i){return i.br+"\n";}},xV.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function replacement(e,t,i){var n=Number(t.nodeName.charAt(1));return"setext"===i.headingStyle&&n<3?"\n\n"+e+"\n"+pV(1===n?"=":"-",e.length)+"\n\n":"\n\n"+pV("#",n)+" "+e+"\n\n";}},xV.blockquote={filter:"blockquote",replacement:function replacement(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n";}},xV.list={filter:["ul","ol"],replacement:function replacement(e,t){var i=t.parentNode;return"LI"===i.nodeName&&i.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n";}},xV.listItem={filter:"li",replacement:function replacement(e,t,i){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");var n=i.bulletListMarker+"   ",s=t.parentNode;if("OL"===s.nodeName){var o=s.getAttribute("start"),r=Array.prototype.indexOf.call(s.children,t);n=(o?Number(o)+r:r+1)+".  ";}return n+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"");}},xV.indentedCodeBlock={filter:function filter(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName;},replacement:function replacement(e,t,i){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n";}},xV.fencedCodeBlock={filter:function filter(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName;},replacement:function replacement(e,t,i){for(var n,s=((t.firstChild.getAttribute("class")||"").match(/language-(\S+)/)||[null,""])[1],o=t.firstChild.textContent,r=i.fence.charAt(0),a=3,l=new RegExp("^"+r+"{3,}","gm");n=l.exec(o);)n[0].length>=a&&(a=n[0].length+1);var c=pV(r,a);return"\n\n"+c+s+"\n"+o.replace(/\n$/,"")+"\n"+c+"\n\n";}},xV.horizontalRule={filter:"hr",replacement:function replacement(e,t,i){return"\n\n"+i.hr+"\n\n";}},xV.inlineLink={filter:function filter(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href");},replacement:function replacement(e,t){var i=t.getAttribute("href");i&&(i=i.replace(/([()])/g,"\\$1"));var n=AV(t.getAttribute("title"));return n&&(n=' "'+n.replace(/"/g,'\\"')+'"'),"["+e+"]("+i+n+")";}},xV.referenceLink={filter:function filter(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href");},replacement:function replacement(e,t,i){var n,s,o=t.getAttribute("href"),r=AV(t.getAttribute("title"));switch(r&&(r=' "'+r+'"'),i.linkReferenceStyle){case"collapsed":n="["+e+"][]",s="["+e+"]: "+o+r;break;case"shortcut":n="["+e+"]",s="["+e+"]: "+o+r;break;default:var a=this.references.length+1;n="["+e+"]["+a+"]",s="["+a+"]: "+o+r;}return this.references.push(s),n;},references:[],append:function append(e){var t="";return this.references.length&&(t="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),t;}},xV.emphasis={filter:["em","i"],replacement:function replacement(e,t,i){return e.trim()?i.emDelimiter+e+i.emDelimiter:"";}},xV.strong={filter:["strong","b"],replacement:function replacement(e,t,i){return e.trim()?i.strongDelimiter+e+i.strongDelimiter:"";}},xV.code={filter:function filter(e){var t=e.previousSibling||e.nextSibling,i="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!i;},replacement:function replacement(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",i="`",n=e.match(/`+/gm)||[];-1!==n.indexOf(i);)i+="`";return i+t+e+t+i;}},xV.image={filter:"img",replacement:function replacement(e,t){var i=AV(t.getAttribute("alt")),n=t.getAttribute("src")||"",s=AV(t.getAttribute("title"));return n?"!["+i+"]("+n+(s?' "'+s+'"':"")+")":"";}},EV.prototype={add:function add(e,t){this.array.unshift(t);},keep:function keep(e){this._keep.unshift({filter:e,replacement:this.keepReplacement});},remove:function remove(e){this._remove.unshift({filter:e,replacement:function replacement(){return"";}});},forNode:function forNode(e){return e.isBlank?this.blankRule:(t=TV(this.array,e,this.options))||(t=TV(this._keep,e,this.options))||(t=TV(this._remove,e,this.options))?t:this.defaultRule;var t;},forEach:function forEach(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t);}};var VV="undefined"!=typeof window?window:{};var RV,OV=function(){var e=VV.DOMParser,t=!1;try{new e().parseFromString("","text/html")&&(t=!0);}catch(e){}return t;}()?VV.DOMParser:function(){var e=function e(){};return!function(){var e=!1;try{document.implementation.createHTMLDocument("").open();}catch(t){VV.ActiveXObject&&(e=!0);}return e;}()?e.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t;}:e.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t;},e;}();function BV(e,t){var i;"string"==typeof e?i=(RV=RV||new OV()).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):i=e.cloneNode(!0);return function(e){var t=e.element,i=e.isBlock,n=e.isVoid,s=e.isPre||function(e){return"PRE"===e.nodeName;};if(t.firstChild&&!s(t)){for(var o=null,r=!1,a=null,l=IV(a,t,s);l!==t;){if(3===l.nodeType||4===l.nodeType){var c=l.data.replace(/[ \r\n\t]+/g," ");if(o&&!/ $/.test(o.data)||r||" "!==c[0]||(c=c.substr(1)),!c){l=SV(l);continue;}l.data=c,o=l;}else{if(1!==l.nodeType){l=SV(l);continue;}i(l)||"BR"===l.nodeName?(o&&(o.data=o.data.replace(/ $/,"")),o=null,r=!1):n(l)||s(l)?(o=null,r=!0):o&&(r=!1);}var d=IV(a,l,s);a=l,l=d;}o&&(o.data=o.data.replace(/ $/,""),o.data||SV(o));}}({element:i,isBlock:wV,isVoid:vV,isPre:t.preformattedCode?MV:null}),i;}function MV(e){return"PRE"===e.nodeName||"CODE"===e.nodeName;}function LV(e,t){return e.isBlock=wV(e),e.isCode="CODE"===e.nodeName||e.parentNode.isCode,e.isBlank=function(e){return!vV(e)&&!function(e){return kV(e,yV);}(e)&&/^\s*$/i.test(e.textContent)&&!function(e){return CV(e,_V);}(e)&&!function(e){return CV(e,yV);}(e);}(e),e.flankingWhitespace=function(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var i=(n=e.textContent,s=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/),{leading:s[1],leadingAscii:s[2],leadingNonAscii:s[3],trailing:s[4],trailingNonAscii:s[5],trailingAscii:s[6]});var n,s;i.leadingAscii&&FV("left",e,t)&&(i.leading=i.leadingNonAscii);i.trailingAscii&&FV("right",e,t)&&(i.trailing=i.trailingNonAscii);return{leading:i.leading,trailing:i.trailing};}(e,t),e;}function FV(e,t,i){var n,s,o;return"left"===e?(n=t.previousSibling,s=/ $/):(n=t.nextSibling,s=/^ /),n&&(3===n.nodeType?o=s.test(n.nodeValue):i.preformattedCode&&"CODE"===n.nodeName?o=!1:1!==n.nodeType||wV(n)||(o=s.test(n.textContent))),o;}var NV=Array.prototype.reduce,DV=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function zV(e){if(!(this instanceof zV))return new zV(e);var t={rules:xV,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function blankReplacement(e,t){return t.isBlock?"\n\n":"";},keepReplacement:function keepReplacement(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML;},defaultReplacement:function defaultReplacement(e,t){return t.isBlock?"\n\n"+e+"\n\n":e;}};this.options=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n]);}return e;}({},t,e),this.rules=new EV(this.options);}function HV(e){var t=this;return NV.call(e.childNodes,function(e,i){var n="";return 3===(i=new LV(i,t.options)).nodeType?n=i.isCode?i.nodeValue:t.escape(i.nodeValue):1===i.nodeType&&(n=UV.call(t,i)),WV(e,n);},"");}function $V(e){var t=this;return this.rules.forEach(function(i){"function"==typeof i.append&&(e=WV(e,i.append(t.options)));}),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"");}function UV(e){var t=this.rules.forNode(e),i=HV.call(this,e),n=e.flankingWhitespace;return(n.leading||n.trailing)&&(i=i.trim()),n.leading+t.replacement(i,e,this.options)+n.trailing;}function WV(e,t){var i=function(e){for(var t=e.length;t>0&&"\n"===e[t-1];)t--;return e.substring(0,t);}(e),n=t.replace(/^\n*/,""),s=Math.max(e.length-i.length,t.length-n.length);return i+"\n\n".substring(0,s)+n;}zV.prototype={turndown:function turndown(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType));}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";var t=HV.call(this,new BV(e,this.options));return $V.call(this,t);},use:function use(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this);}return this;},addRule:function addRule(e,t){return this.rules.add(e,t),this;},keep:function keep(e){return this.rules.keep(e),this;},remove:function remove(e){return this.rules.remove(e),this;},escape:function escape(e){return DV.reduce(function(e,t){return e.replace(t[0],t[1]);},e);}};var jV=/highlight-(?:text|source)-([a-z0-9]+)/;function qV(e){e.addRule("highlightedCodeBlock",{filter:function filter(e){var t=e.firstChild;return"DIV"===e.nodeName&&jV.test(e.className)&&t&&"PRE"===t.nodeName;},replacement:function replacement(e,t,i){var n=((t.className||"").match(jV)||[null,""])[1];return"\n\n"+i.fence+n+"\n"+t.firstChild.textContent+"\n"+i.fence+"\n\n";}});}function GV(e){e.addRule("strikethrough",{filter:["del","s","strike"],replacement:function replacement(e){return"~"+e+"~";}});}var KV=Array.prototype.indexOf,ZV=Array.prototype.every,JV={};function QV(e){var t,i,n=e.parentNode;return"THEAD"===n.nodeName||n.firstChild===e&&("TABLE"===n.nodeName||(i=(t=n).previousSibling,"TBODY"===t.nodeName&&(!i||"THEAD"===i.nodeName&&/^\s*$/i.test(i.textContent))))&&ZV.call(e.childNodes,function(e){return"TH"===e.nodeName;});}function YV(e,t){var i=" ";return 0===KV.call(t.parentNode.childNodes,t)&&(i="| "),i+e+" |";}function XV(e){for(var t in e.keep(function(e){return"TABLE"===e.nodeName&&!QV(e.rows[0]);}),JV)e.addRule(t,JV[t]);}function eR(e){e.addRule("taskListItems",{filter:function filter(e){return"checkbox"===e.type&&"LI"===e.parentNode.nodeName;},replacement:function replacement(e,t){return(t.checked?"[x]":"[ ]")+" ";}});}function tR(e){e.use([qV,GV,XV,eR]);}JV.tableCell={filter:["th","td"],replacement:function replacement(e,t){return YV(e,t);}},JV.tableRow={filter:"tr",replacement:function replacement(e,t){var i="",n={left:":--",right:"--:",center:":-:"};if(QV(t))for(var s=0;s<t.childNodes.length;s++){var o="---",r=(t.childNodes[s].getAttribute("align")||"").toLowerCase();r&&(o=n[r]||o),i+=YV(o,t.childNodes[s]);}return"\n"+e+(i?"\n"+i:"");}},JV.table={filter:function filter(e){return"TABLE"===e.nodeName&&QV(e.rows[0]);},replacement:function replacement(e){return"\n\n"+(e=e.replace("\n\n","\n"))+"\n\n";}},JV.tableSection={filter:["thead","tbody","tfoot"],replacement:function replacement(e){return e;}};var iR=new RegExp(/\b(?:(?:https?|ftp):\/\/|www\.)/.source+/(?![-_])(?:[-_a-z0-9\u00a1-\uffff]{1,63}\.)+(?:[a-z\u00a1-\uffff]{2,63})/.source+/(?:[^\s<>]*)/.source,"gi");var nR=/*#__PURE__*/function(_zV){function nR(){_classCallCheck(this,nR);return _callSuper(this,nR,arguments);}_inherits(nR,_zV);return _createClass(nR,[{key:"escape",value:function escape(e){var t=_superPropGet(nR,"escape",this,1);function i(e){return e=(e=t(e)).replace(/</g,"\\<");}var n="",s=0;var _iterator747=_createForOfIteratorHelper(this._matchAutolink(e)),_step747;try{for(_iterator747.s();!(_step747=_iterator747.n()).done;){var _t496=_step747.value;var _o121=_t496.index;_o121>s&&(n+=i(e.substring(s,_o121)));var r=_t496[0];n+=r,s=_o121+r.length;}}catch(err){_iterator747.e(err);}finally{_iterator747.f();}return s<e.length&&(n+=i(e.substring(s,e.length))),n;}},{key:"_matchAutolink",value:/*#__PURE__*/_regeneratorRuntime().mark(function _matchAutolink(e){var _iterator748,_step748,_t497,_e730,_i544;return _regeneratorRuntime().wrap(function _matchAutolink$(_context61){while(1)switch(_context61.prev=_context61.next){case 0:_iterator748=_createForOfIteratorHelper(e.matchAll(iR));_context61.prev=1;_iterator748.s();case 3:if((_step748=_iterator748.n()).done){_context61.next=10;break;}_t497=_step748.value;_e730=_t497[0],_i544=this._autolinkFindEnd(_e730);_context61.next=8;return Object.assign([_e730.substring(0,_i544)],{index:_t497.index});case 8:_context61.next=3;break;case 10:_context61.next=15;break;case 12:_context61.prev=12;_context61.t0=_context61["catch"](1);_iterator748.e(_context61.t0);case 15:_context61.prev=15;_iterator748.f();return _context61.finish(15);case 18:case"end":return _context61.stop();}},_matchAutolink,this,[[1,12,15,18]]);})},{key:"_autolinkFindEnd",value:function _autolinkFindEnd(e){var t=e.length;for(;t>0;){var _i545=e[t-1];if("?!.,:*_~'\"".includes(_i545))t--;else{if(")"!=_i545)break;{var _i546=0;for(var _n283=0;_n283<t;_n283++)"("==e[_n283]?_i546++:")"==e[_n283]&&_i546--;if(!(_i546<0))break;t--;}}}return t;}}]);}(zV);var sR=/*#__PURE__*/function(){function sR(){_classCallCheck(this,sR);_defineProperty(this,"_parser",void 0);this._parser=this._createParser();}return _createClass(sR,[{key:"parse",value:function parse(e){return this._parser.turndown(e);}},{key:"keep",value:function keep(e){this._parser.keep(e);}},{key:"_createParser",value:function _createParser(){var e=new nR({codeBlockStyle:"fenced",hr:"---",headingStyle:"atx"});return e.use([tR,this._todoList]),e;}},{key:"_todoList",value:function _todoList(e){e.addRule("taskListItems",{filter:function filter(e){return"checkbox"===e.type&&("LI"===e.parentNode.nodeName||"LI"===e.parentNode.parentNode.nodeName);},replacement:function replacement(e,t){return(t.checked?"[x]":"[ ]")+" ";}});}}]);}();var oR=/*#__PURE__*/function(){function oR(e){_classCallCheck(this,oR);_defineProperty(this,"_htmlDP",void 0);_defineProperty(this,"_markdown2html",void 0);_defineProperty(this,"_html2markdown",void 0);this._htmlDP=new vd(e),this._markdown2html=new fV(),this._html2markdown=new sR();}return _createClass(oR,[{key:"keepHtml",value:function keepHtml(e){this._html2markdown.keep([e]);}},{key:"toView",value:function toView(e){var t=this._markdown2html.parse(e);return this._htmlDP.toView(t);}},{key:"toData",value:function toData(e){var t=this._htmlDP.toData(e);return this._html2markdown.parse(t);}},{key:"registerRawContentMatcher",value:function registerRawContentMatcher(e){this._htmlDP.registerRawContentMatcher(e);}},{key:"useFillerType",value:function useFillerType(){}}]);}();var rR=/*#__PURE__*/function(_Dr199){function rR(e){var _this710;_classCallCheck(this,rR);_this710=_callSuper(this,rR,[e]),e.data.processor=new oR(e.data.viewDocument);return _this710;}_inherits(rR,_Dr199);return _createClass(rR,null,[{key:"pluginName",get:function get(){return"Markdown";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var aR=["SPAN","BR","PRE","CODE"];var lR=/*#__PURE__*/function(_Dr200){function lR(e){var _this711;_classCallCheck(this,lR);_this711=_callSuper(this,lR,[e]),_defineProperty(_assertThisInitialized(_this711),"_gfmDataProcessor",void 0),_this711._gfmDataProcessor=new oR(e.data.viewDocument);return _this711;}_inherits(lR,_Dr200);return _createClass(lR,[{key:"init",value:function init(){var _this712=this;var e=this.editor,t=e.editing.view.document,i=e.plugins.get("ClipboardPipeline");var n=!1;this.listenTo(t,"keydown",function(e,t){n=t.shiftKey;}),this.listenTo(i,"inputTransformation",function(e,t){if(n)return;var i=t.dataTransfer.getData("text/html");if(!i){var _e731=t.dataTransfer.getData("text/plain");return void(t.content=_this712._gfmDataProcessor.toView(_e731));}var s=_this712._parseMarkdownFromHtml(i);s&&(t.content=_this712._gfmDataProcessor.toView(s));});}},{key:"_parseMarkdownFromHtml",value:function _parseMarkdownFromHtml(e){var t=this._removeOsSpecificTags(e);if(!this._containsOnlyAllowedFirstLevelTags(t))return null;var i=this._removeFirstLevelWrapperTagsAndBrs(t);return this._containsAnyRemainingHtmlTags(i)?null:this._replaceHtmlReservedEntitiesWithCharacters(i);}},{key:"_removeOsSpecificTags",value:function _removeOsSpecificTags(e){return e.replace(/^<meta\b[^>]*>/,"").trim().replace(/^<html>/,"").replace(/<\/html>$/,"").trim().replace(/^<body>/,"").replace(/<\/body>$/,"").trim().replace(/^<!--StartFragment-->/,"").replace(/<!--EndFragment-->$/,"").trim();}},{key:"_containsOnlyAllowedFirstLevelTags",value:function _containsOnlyAllowedFirstLevelTags(e){var t=new DOMParser(),_t$parseFromString=t.parseFromString(e,"text/html"),i=_t$parseFromString.body;return Array.from(i.children).map(function(e){return e.tagName;}).every(function(e){return aR.includes(e);});}},{key:"_removeFirstLevelWrapperTagsAndBrs",value:function _removeFirstLevelWrapperTagsAndBrs(e){var t=new DOMParser(),_t$parseFromString2=t.parseFromString(e,"text/html"),i=_t$parseFromString2.body,n=i.querySelectorAll("br");var _iterator749=_createForOfIteratorHelper(n),_step749;try{for(_iterator749.s();!(_step749=_iterator749.n()).done;){var _e732=_step749.value;_e732.replaceWith("\n");}}catch(err){_iterator749.e(err);}finally{_iterator749.f();}var s=i.querySelectorAll(":scope > *");var _iterator750=_createForOfIteratorHelper(s),_step750;try{for(_iterator750.s();!(_step750=_iterator750.n()).done;){var _e733=_step750.value;var _t498=_e733.cloneNode(!0);_e733.replaceWith.apply(_e733,_toConsumableArray(_t498.childNodes));}}catch(err){_iterator750.e(err);}finally{_iterator750.f();}return i.innerHTML;}},{key:"_containsAnyRemainingHtmlTags",value:function _containsAnyRemainingHtmlTags(e){return e.includes("<");}},{key:"_replaceHtmlReservedEntitiesWithCharacters",value:function _replaceHtmlReservedEntitiesWithCharacters(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&nbsp;/g," ");}}],[{key:"pluginName",get:function get(){return"PasteFromMarkdownExperimental";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Jv];}}]);}(Dr);function cR(e,t){var i=function i(_i547,n,s){if(!s.consumable.consume(n.item,_i547.name))return;var o=n.attributeNewValue,r=s.writer,a=s.mapper.toViewElement(n.item),l=_toConsumableArray(a.getChildren()).find(function(e){return e.getCustomProperty("media-content");});r.remove(l);var c=e.getMediaViewElement(r,o,t);r.insert(r.createPositionAt(a,0),c);};return function(e){e.on("attribute:url:media",i);};}function dR(e){var t=e.getSelectedElement();return t&&function(e){return!!e.getCustomProperty("media")&&sy(e);}(t)?t:null;}function uR(e,t,i,n){return e.createContainerElement("figure",{"class":"media"},[t.getMediaViewElement(e,i,n),e.createSlot()]);}function hR(e){var t=e.getSelectedElement();return t&&t.is("element","media")?t:null;}function mR(e,t,i,n){e.change(function(s){var o=s.createElement("media",{url:t});e.insertObject(o,i,null,{setSelection:"on",findOptimalPosition:n?"auto":void 0});});}var gR=/*#__PURE__*/function(_Hr54){function gR(){_classCallCheck(this,gR);return _callSuper(this,gR,arguments);}_inherits(gR,_Hr54);return _createClass(gR,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document.selection,i=hR(t);this.value=i?i.getAttribute("url"):void 0,this.isEnabled=function(e){var t=e.getSelectedElement();return!!t&&"media"===t.name;}(t)||function(e,t){var i=hy(e,t);var n=i.start.parent;n.isEmpty&&!t.schema.isLimit(n)&&(n=n.parent);return t.schema.checkChild(n,"media");}(t,e);}},{key:"execute",value:function execute(e){var t=this.editor.model,i=t.document.selection,n=hR(i);n?t.change(function(t){t.setAttribute("url",e,n);}):mR(t,e,i,!0);}}]);}(Hr);var fR=/*#__PURE__*/function(){function fR(e,t){_classCallCheck(this,fR);_defineProperty(this,"locale",void 0);_defineProperty(this,"providerDefinitions",void 0);var i=t.providers,n=t.extraProviders||[],s=new Set(t.removeProviders),o=i.concat(n).filter(function(e){var t=e.name;return t?!s.has(t):(E("media-embed-no-provider-name",{provider:e}),!1);});this.locale=e,this.providerDefinitions=o;}return _createClass(fR,[{key:"hasMedia",value:function hasMedia(e){return!!this._getMedia(e);}},{key:"getMediaViewElement",value:function getMediaViewElement(e,t,i){return this._getMedia(t).getViewElement(e,i);}},{key:"_getMedia",value:function _getMedia(e){if(!e)return new pR(this.locale);e=e.trim();var _iterator751=_createForOfIteratorHelper(this.providerDefinitions),_step751;try{for(_iterator751.s();!(_step751=_iterator751.n()).done;){var _t499=_step751.value;var _i548=_t499.html,_n284=gr(_t499.url);var _iterator752=_createForOfIteratorHelper(_n284),_step752;try{for(_iterator752.s();!(_step752=_iterator752.n()).done;){var _t500=_step752.value;var _n285=this._getUrlMatches(e,_t500);if(_n285)return new pR(this.locale,e,_n285,_i548);}}catch(err){_iterator752.e(err);}finally{_iterator752.f();}}}catch(err){_iterator751.e(err);}finally{_iterator751.f();}return null;}},{key:"_getUrlMatches",value:function _getUrlMatches(e,t){var i=e.match(t);if(i)return i;var n=e.replace(/^https?:\/\//,"");return i=n.match(t),i||(n=n.replace(/^www\./,""),i=n.match(t),i||null);}}]);}();var pR=/*#__PURE__*/function(){function pR(e,t,i,n){_classCallCheck(this,pR);_defineProperty(this,"url",void 0);_defineProperty(this,"_locale",void 0);_defineProperty(this,"_match",void 0);_defineProperty(this,"_previewRenderer",void 0);this.url=this._getValidUrl(t),this._locale=e,this._match=i,this._previewRenderer=n;}return _createClass(pR,[{key:"getViewElement",value:function getViewElement(e,t){var i={};var n;if(t.renderForEditingView||t.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(i["data-oembed-url"]=this.url),t.renderForEditingView&&(i["class"]="ck-media__wrapper");var _s200=this._getPreviewHtml(t);n=e.createRawElement("div",i,function(e,t){t.setContentOf(e,_s200);});}else this.url&&(i.url=this.url),n=e.createEmptyElement(t.elementName,i);return e.setCustomProperty("media-content",!0,n),n;}},{key:"_getPreviewHtml",value:function _getPreviewHtml(e){return this._previewRenderer?this._previewRenderer(this._match):this.url&&e.renderForEditingView?this._getPlaceholderHtml():"";}},{key:"_getPlaceholderHtml",value:function _getPlaceholderHtml(){var e=new gg(),t=this._locale.t;e.content='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>',e.viewBox="0 0 64 42";return new Hm({tag:"div",attributes:{"class":"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{"class":"ck-media__placeholder__icon"},children:[e]},{tag:"a",attributes:{"class":"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url,"data-cke-tooltip-text":t("Open media in new tab")},children:[{tag:"span",attributes:{"class":"ck-media__placeholder__url__text"},children:[this.url]}]}]}).render().outerHTML;}},{key:"_getValidUrl",value:function _getValidUrl(e){return e?e.match(/^https?/)?e:"https://"+e:null;}}]);}();var bR=/*#__PURE__*/function(_Dr201){function bR(e){var _this713;_classCallCheck(this,bR);_this713=_callSuper(this,bR,[e]),_defineProperty(_assertThisInitialized(_this713),"registry",void 0),e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:[/^dailymotion\.com\/video\/(\w+)/,/^dai.ly\/(\w+)/],html:function html(e){return"<div style=\"position: relative; padding-bottom: 100%; height: 0; \"><iframe src=\"https://www.dailymotion.com/embed/video/".concat(e[1],"\" style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" frameborder=\"0\" width=\"480\" height=\"270\" allowfullscreen allow=\"autoplay\"></iframe></div>");}},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:function html(e){return"<div style=\"position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;\"><iframe src=\"https://open.spotify.com/embed/".concat(e[1],"\" style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" frameborder=\"0\" allowtransparency=\"true\" allow=\"encrypted-media\"></iframe></div>");}},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)(?:&t=(\d+))?/,/^(?:m\.)?youtube\.com\/shorts\/([\w-]+)(?:\?t=(\d+))?/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)(?:\?t=(\d+))?/,/^youtube\.com\/embed\/([\w-]+)(?:\?start=(\d+))?/,/^youtu\.be\/([\w-]+)(?:\?t=(\d+))?/],html:function html(e){var t=e[1],i=e[2];return"<div style=\"position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;\"><iframe src=\"https://www.youtube.com/embed/".concat(t).concat(i?"?start=".concat(i):"","\" style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" frameborder=\"0\" allow=\"autoplay; encrypted-media\" allowfullscreen></iframe></div>");}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:function html(e){return"<div style=\"position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;\"><iframe src=\"https://player.vimeo.com/video/".concat(e[1],"\" style=\"position: absolute; width: 100%; height: 100%; top: 0; left: 0;\" frameborder=\"0\" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>");}},{name:"instagram",url:[/^instagram\.com\/p\/(\w+)/,/^instagram\.com\/reel\/(\w+)/]},{name:"twitter",url:[/^twitter\.com/,/^x\.com/]},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),_this713.registry=new fR(e.locale,e.config.get("mediaEmbed"));return _this713;}_inherits(bR,_Dr201);return _createClass(bR,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.t,n=e.conversion,s=e.config.get("mediaEmbed.previewsInData"),o=e.config.get("mediaEmbed.elementName"),r=this.registry;e.commands.add("mediaEmbed",new gR(e)),t.register("media",{inheritAllFrom:"$blockObject",allowAttributes:["url"]}),n["for"]("dataDowncast").elementToStructure({model:"media",view:function view(e,_ref274){var t=_ref274.writer;var i=e.getAttribute("url");return uR(t,r,i,{elementName:o,renderMediaPreview:!!i&&s});}}),n["for"]("dataDowncast").add(cR(r,{elementName:o,renderMediaPreview:s})),n["for"]("editingDowncast").elementToStructure({model:"media",view:function view(e,_ref275){var t=_ref275.writer;var n=e.getAttribute("url");return function(e,t,i){return t.setCustomProperty("media",!0,e),oy(e,t,{label:i});}(uR(t,r,n,{elementName:o,renderForEditingView:!0}),t,i("media widget"));}}),n["for"]("editingDowncast").add(cR(r,{elementName:o,renderForEditingView:!0})),n["for"]("upcast").elementToElement({view:function view(e){return["oembed",o].includes(e.name)&&e.getAttribute("url")?{name:!0}:null;},model:function model(e,_ref276){var t=_ref276.writer;var i=e.getAttribute("url");return r.hasMedia(i)?t.createElement("media",{url:i}):null;}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:function model(e,_ref277){var t=_ref277.writer;var i=e.getAttribute("data-oembed-url");return r.hasMedia(i)?t.createElement("media",{url:i}):null;}}).add(function(e){e.on("element:figure",function(e,t,i){if(!i.consumable.consume(t.viewItem,{name:!0,classes:"media"}))return;var _i$convertChildren3=i.convertChildren(t.viewItem,t.modelCursor),n=_i$convertChildren3.modelRange,s=_i$convertChildren3.modelCursor;t.modelRange=n,t.modelCursor=s;wr(n.getItems())||i.consumable.revert(t.viewItem,{name:!0,classes:"media"});});});}}],[{key:"pluginName",get:function get(){return"MediaEmbedEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var wR=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;var _R=/*#__PURE__*/function(_Dr202){function _R(e){var _this714;_classCallCheck(this,_R);_this714=_callSuper(this,_R,[e]),_defineProperty(_assertThisInitialized(_this714),"_timeoutId",void 0),_defineProperty(_assertThisInitialized(_this714),"_positionToInsert",void 0),_this714._timeoutId=null,_this714._positionToInsert=null;return _this714;}_inherits(_R,_Dr202);return _createClass(_R,[{key:"init",value:function init(){var _this715=this;var e=this.editor,t=e.model.document,n=e.plugins.get("ClipboardPipeline");this.listenTo(n,"inputTransformation",function(){var e=t.selection.getFirstRange(),i=su.fromPosition(e.start);i.stickiness="toPrevious";var n=su.fromPosition(e.end);n.stickiness="toNext",t.once("change:data",function(){_this715._embedMediaBetweenPositions(i,n),i.detach(),n.detach();},{priority:"high"});});e.commands.get("undo").on("execute",function(){_this715._timeoutId&&(i.window.clearTimeout(_this715._timeoutId),_this715._positionToInsert.detach(),_this715._timeoutId=null,_this715._positionToInsert=null);},{priority:"high"});}},{key:"_embedMediaBetweenPositions",value:function _embedMediaBetweenPositions(e,t){var _this716=this;var n=this.editor,s=n.plugins.get(bR).registry,o=new fc(e,t),r=o.getWalker({ignoreElementEnd:!0});var a="";var _iterator753=_createForOfIteratorHelper(r),_step753;try{for(_iterator753.s();!(_step753=_iterator753.n()).done;){var _e734=_step753.value;_e734.item.is("$textProxy")&&(a+=_e734.item.data);}}catch(err){_iterator753.e(err);}finally{_iterator753.f();}if(a=a.trim(),!a.match(wR))return void o.detach();if(!s.hasMedia(a))return void o.detach();n.commands.get("mediaEmbed").isEnabled?(this._positionToInsert=su.fromPosition(e),this._timeoutId=i.window.setTimeout(function(){n.model.change(function(e){_this716._timeoutId=null,e.remove(o),o.detach();var t=null;"$graveyard"!==_this716._positionToInsert.root.rootName&&(t=_this716._positionToInsert),mR(n.model,a,t,!1),_this716._positionToInsert.detach(),_this716._positionToInsert=null;}),n.plugins.get(Rw).requestUndoOnBackspace();},100)):o.detach();}}],[{key:"requires",get:function get(){return[Qy,Rw,lC];}},{key:"pluginName",get:function get(){return"AutoMediaEmbed";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var vR=/*#__PURE__*/function(_lg63){function vR(e,t){var _this717;_classCallCheck(this,vR);_this717=_callSuper(this,vR,[t]),_defineProperty(_assertThisInitialized(_this717),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this717),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this717),"urlInputView",void 0),_defineProperty(_assertThisInitialized(_this717),"_validators",void 0),_defineProperty(_assertThisInitialized(_this717),"_urlInputViewInfoDefault",void 0),_defineProperty(_assertThisInitialized(_this717),"_urlInputViewInfoTip",void 0),_this717.focusTracker=new _r(),_this717.keystrokes=new Cr(),_this717.set("mediaURLInputValue",""),_this717.urlInputView=_this717._createUrlInput(),_this717._validators=e,_this717.setTemplate({tag:"form",attributes:{"class":["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[_this717.urlInputView]});return _this717;}_inherits(vR,_lg63);return _createClass(vR,[{key:"render",value:function render(){_superPropGet(vR,"render",this,3)([]),hg({view:this}),this.focusTracker.add(this.urlInputView.element),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(vR,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this.urlInputView.focus();}},{key:"url",get:function get(){return this.urlInputView.fieldView.element.value.trim();},set:function set(e){this.urlInputView.fieldView.value=e.trim();}},{key:"isValid",value:function isValid(){this.resetFormStatus();var _iterator754=_createForOfIteratorHelper(this._validators),_step754;try{for(_iterator754.s();!(_step754=_iterator754.n()).done;){var _e735=_step754.value;var _t501=_e735(this);if(_t501)return this.urlInputView.errorText=_t501,!1;}}catch(err){_iterator754.e(err);}finally{_iterator754.f();}return!0;}},{key:"resetFormStatus",value:function resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault;}},{key:"_createUrlInput",value:function _createUrlInput(){var _this718=this;var e=this.locale.t,t=new pf(this.locale,cp),i=t.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),t.label=e("Media URL"),t.infoText=this._urlInputViewInfoDefault,i.inputMode="url",i.on("input",function(){t.infoText=i.element.value?_this718._urlInputViewInfoTip:_this718._urlInputViewInfoDefault,_this718.mediaURLInputValue=i.element.value.trim();}),t;}}]);}(lg);var yR=/*#__PURE__*/function(_Dr203){function yR(){var _this719;_classCallCheck(this,yR);for(var _len94=arguments.length,args=new Array(_len94),_key94=0;_key94<_len94;_key94++){args[_key94]=arguments[_key94];}_this719=_callSuper(this,yR,[].concat(args));_defineProperty(_this719,"_formView",void 0);return _this719;}_inherits(yR,_Dr203);return _createClass(yR,[{key:"init",value:function init(){var _this720=this;var e=this.editor;e.ui.componentFactory.add("mediaEmbed",function(){var e=_this720.editor.locale.t,t=_this720._createDialogButton(pg);return t.tooltip=!0,t.label=e("Insert media"),t;}),e.ui.componentFactory.add("menuBar:mediaEmbed",function(){var e=_this720.editor.locale.t,t=_this720._createDialogButton(Rg);return t.label=e("Media"),t;});}},{key:"_createDialogButton",value:function _createDialogButton(e){var _this721=this;var t=this.editor,i=new e(t.locale),n=t.commands.get("mediaEmbed"),s=this.editor.plugins.get("Dialog");return i.icon='<svg viewBox="0 0 22 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.587 1.5c-.612 0-.601-.029-.601.551v14.84c0 .59-.01.559.591.559h18.846c.602 0 .591.03.591-.56V2.052c0-.58.01-.55-.591-.55H1.587Zm.701.971h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-14.24 1h13.008v12H4.467l.029-12Zm-2.208 1h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003l-.029 1h-.974v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h.974v1h-.974v-1Zm16.448 0h1.003v1h-1.003v-1Z"/><path d="M8.374 6.648a.399.399 0 0 1 .395-.4.402.402 0 0 1 .2.049l5.148 2.824a.4.4 0 0 1 0 .7l-5.148 2.824a.403.403 0 0 1-.595-.35V6.648Z"/></svg>',i.bind("isEnabled").to(n,"isEnabled"),i.on("execute",function(){"mediaEmbed"===s.id?s.hide():_this721._showDialog();}),i;}},{key:"_showDialog",value:function _showDialog(){var _this722=this;var e=this.editor,t=e.plugins.get("Dialog"),i=e.commands.get("mediaEmbed"),n=e.locale.t;if(!this._formView){var _t502=e.plugins.get(bR).registry;this._formView=new(ug(vR))(function(e,t){return[function(t){if(!t.url.length)return e("The URL must not be empty.");},function(i){if(!t.hasMedia(i.url))return e("This media URL is not supported.");}];}(e.t,_t502),e.locale),this._formView.on("submit",function(){return _this722._handleSubmitForm();});}t.show({id:"mediaEmbed",title:n("Insert media"),content:this._formView,isModal:!0,onShow:function onShow(){_this722._formView.url=i.value||"",_this722._formView.resetFormStatus(),_this722._formView.urlInputView.fieldView.select();},actionButtons:[{label:n("Cancel"),withText:!0,onExecute:function onExecute(){return t.hide();}},{label:n("Accept"),"class":"ck-button-action",withText:!0,onExecute:function onExecute(){return _this722._handleSubmitForm();}}]});}},{key:"_handleSubmitForm",value:function _handleSubmitForm(){var e=this.editor,t=e.plugins.get("Dialog");this._formView.isValid()&&(e.execute("mediaEmbed",this._formView.url),t.hide(),e.editing.view.focus());}}],[{key:"requires",get:function get(){return[bR,Sg];}},{key:"pluginName",get:function get(){return"MediaEmbedUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var kR=/*#__PURE__*/function(_Dr204){function kR(){_classCallCheck(this,kR);return _callSuper(this,kR,arguments);}_inherits(kR,_Dr204);return _createClass(kR,null,[{key:"requires",get:function get(){return[bR,yR,_R,Ty];}},{key:"pluginName",get:function get(){return"MediaEmbed";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var CR=/*#__PURE__*/function(_Dr205){function CR(){_classCallCheck(this,CR);return _callSuper(this,CR,arguments);}_inherits(CR,_Dr205);return _createClass(CR,[{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.t;e.plugins.get(Sy).register("mediaEmbed",{ariaLabel:t("Media toolbar"),items:e.config.get("mediaEmbed.toolbar")||[],getRelatedElement:dR});}}],[{key:"requires",get:function get(){return[Sy];}},{key:"pluginName",get:function get(){return"MediaEmbedToolbar";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var xR={"(":")","[":"]","{":"}"};var AR=/*#__PURE__*/function(_Hr55){function AR(e){var _this723;_classCallCheck(this,AR);_this723=_callSuper(this,AR,[e]),_this723._isEnabledBasedOnSelection=!1;return _this723;}_inherits(AR,_Hr55);return _createClass(AR,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"mention");}},{key:"execute",value:function execute(e){var t=this.editor.model,i=t.document.selection,n="string"==typeof e.mention?{id:e.mention}:e.mention,s=n.id,o=e.range||i.getFirstRange();if(!t.canEditAt(o))return;var r=e.text||s,a=TR({_text:r,id:s},n);if(1!=e.marker.length)throw new A("mentioncommand-incorrect-marker",this);if(s.charAt(0)!=e.marker)throw new A("mentioncommand-incorrect-id",this);t.change(function(e){var n=xr(i.getAttributes()),s=new Map(n.entries());s.set("mention",a);var l=t.insertContent(e.createText(r,s),o),c=l.start.nodeBefore,d=l.end.nodeAfter,u=d&&d.is("$text")&&d.data.startsWith(" ");var h=!1;if(c&&d&&c.is("$text")&&d.is("$text")){var _e736=c.data.slice(-1),_t503=_e736 in xR,_i549=_t503&&d.data.startsWith(xR[_e736]);h=_t503&&_i549;}h||u||t.insertContent(e.createText(" ",n),o.start.getShiftedBy(r.length));});}}]);}(Hr);var ER=/*#__PURE__*/function(_Dr206){function ER(){_classCallCheck(this,ER);return _callSuper(this,ER,arguments);}_inherits(ER,_Dr206);return _createClass(ER,[{key:"init",value:function init(){var e=this.editor,t=e.model,i=t.document;t.schema.extend("$text",{allowAttributes:"mention"}),e.conversion["for"]("upcast").elementToAttribute({view:{name:"span",key:"data-mention",classes:"mention"},model:{key:"mention",value:function value(e){return PR(e);}}}),e.conversion["for"]("downcast").attributeToElement({model:"mention",view:IR}),e.conversion["for"]("downcast").add(SR),i.registerPostFixer(function(e){return function(e,t,i){var n=t.differ.getChanges();var s=!1;var _iterator755=_createForOfIteratorHelper(n),_step755;try{for(_iterator755.s();!(_step755=_iterator755.n()).done;){var _t504=_step755.value;if("attribute"==_t504.type)continue;var _n286=_t504.position;if("$text"==_t504.name){var _t505=_n286.textNode&&_n286.textNode.nextSibling;s=RR(_n286.textNode,e)||s,s=RR(_t505,e)||s,s=RR(_n286.nodeBefore,e)||s,s=RR(_n286.nodeAfter,e)||s;}if("$text"!=_t504.name&&"insert"==_t504.type){var _t506=_n286.nodeAfter;var _iterator756=_createForOfIteratorHelper(e.createRangeIn(_t506).getItems()),_step756;try{for(_iterator756.s();!(_step756=_iterator756.n()).done;){var _i550=_step756.value;s=RR(_i550,e)||s;}}catch(err){_iterator756.e(err);}finally{_iterator756.f();}}if("insert"==_t504.type&&i.isInline(_t504.name)){var _t507=_n286.nodeAfter&&_n286.nodeAfter.nextSibling;s=RR(_n286.nodeBefore,e)||s,s=RR(_t507,e)||s;}}}catch(err){_iterator755.e(err);}finally{_iterator755.f();}return s;}(e,i,t.schema);}),i.registerPostFixer(function(e){return function(e,t){var i=t.differ.getChanges();var n=!1;var _iterator757=_createForOfIteratorHelper(i),_step757;try{for(_iterator757.s();!(_step757=_iterator757.n()).done;){var _t508=_step757.value;if("attribute"===_t508.type&&"mention"!=_t508.attributeKey){var _i551=_t508.range.start.nodeBefore,_s201=_t508.range.end.nodeAfter;for(var _i552=0,_arr7=[_i551,_s201];_i552<_arr7.length;_i552++){var _o122=_arr7[_i552];VR(_o122)&&_o122.getAttribute(_t508.attributeKey)!=_t508.attributeNewValue&&(e.setAttribute(_t508.attributeKey,_t508.attributeNewValue,_o122),n=!0);}}}}catch(err){_iterator757.e(err);}finally{_iterator757.f();}return n;}(e,i);}),i.registerPostFixer(function(e){return function(e,t){var i=t.selection,n=i.focus;if(i.isCollapsed&&i.hasAttribute("mention")&&function(e){var t=e.isAtStart;return e.nodeBefore&&e.nodeBefore.is("$text")||t;}(n))return e.removeSelectionAttribute("mention"),!0;return!1;}(e,i);}),e.commands.add("mention",new AR(e));}}],[{key:"pluginName",get:function get(){return"MentionEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function TR(e,t){return Object.assign({uid:k()},e,t||{});}function PR(e,t){var i=e.getAttribute("data-mention"),n=e.getChild(0);if(!n)return;return TR({id:i,_text:n.data},t);}function SR(e){e.on("attribute:mention",function(e,t,i){var n=t.attributeNewValue;if(!t.item.is("$textProxy")||!n)return;var s=t.range.start;(s.textNode||s.nodeAfter).data!=n._text&&i.consumable.consume(t.item,e.name);},{priority:"highest"});}function IR(e,_ref278){var t=_ref278.writer;if(!e)return;var i={"class":"mention","data-mention":e.id},n={id:e.uid,priority:20};return t.createAttributeElement("span",i,n);}function VR(e){if(!e||!e.is("$text")&&!e.is("$textProxy")||!e.hasAttribute("mention"))return!1;return e.data!=e.getAttribute("mention")._text;}function RR(e,t){return!!VR(e)&&(t.removeAttribute("mention",e),!0);}var OR=/*#__PURE__*/function(_Vf4){function OR(e){var _this724;_classCallCheck(this,OR);_this724=_callSuper(this,OR,[e]),_defineProperty(_assertThisInitialized(_this724),"selected",void 0),_defineProperty(_assertThisInitialized(_this724),"position",void 0),_this724.extendTemplate({attributes:{"class":["ck-mentions"],tabindex:"-1"}});return _this724;}_inherits(OR,_Vf4);return _createClass(OR,[{key:"selectFirst",value:function selectFirst(){this.select(0);}},{key:"selectNext",value:function selectNext(){var e=this.selected,t=this.items.getIndex(e);this.select(t+1);}},{key:"selectPrevious",value:function selectPrevious(){var e=this.selected,t=this.items.getIndex(e);this.select(t-1);}},{key:"select",value:function select(e){var t=0;e>0&&e<this.items.length?t=e:e<0&&(t=this.items.length-1);var i=this.items.get(t);this.selected!==i&&(this.selected&&this.selected.removeHighlight(),i.highlight(),this.selected=i,this._isItemVisibleInScrolledArea(i)||(this.element.scrollTop=i.element.offsetTop));}},{key:"executeSelected",value:function executeSelected(){this.selected.fire("execute");}},{key:"_isItemVisibleInScrolledArea",value:function _isItemVisibleInScrolledArea(e){return new Eo(this.element).contains(new Eo(e.element));}}]);}(Vf);var BR=/*#__PURE__*/function(_lg64){function BR(e,t){var _this725;_classCallCheck(this,BR);_this725=_callSuper(this,BR,[e]),_defineProperty(_assertThisInitialized(_this725),"domElement",void 0),_this725.template=void 0,_this725.domElement=t,_this725.domElement.classList.add("ck-button"),_this725.set("isOn",!1),_this725.on("change:isOn",function(e,t,i){i?(_this725.domElement.classList.add("ck-on"),_this725.domElement.classList.remove("ck-off")):(_this725.domElement.classList.add("ck-off"),_this725.domElement.classList.remove("ck-on"));}),_this725.listenTo(_this725.domElement,"click",function(){_this725.fire("execute");});return _this725;}_inherits(BR,_lg64);return _createClass(BR,[{key:"render",value:function render(){_superPropGet(BR,"render",this,3)([]),this.element=this.domElement;}},{key:"focus",value:function focus(){this.domElement.focus();}}]);}(lg);var MR=/*#__PURE__*/function(_Pf4){function MR(){var _this726;_classCallCheck(this,MR);for(var _len95=arguments.length,args=new Array(_len95),_key95=0;_key95<_len95;_key95++){args[_key95]=arguments[_key95];}_this726=_callSuper(this,MR,[].concat(args));_defineProperty(_this726,"item",void 0);_defineProperty(_this726,"marker",void 0);return _this726;}_inherits(MR,_Pf4);return _createClass(MR,[{key:"highlight",value:function highlight(){this.children.first.isOn=!0;}},{key:"removeHighlight",value:function removeHighlight(){this.children.first.isOn=!1;}}]);}(Pf);var LR=[nr.arrowup,nr.arrowdown,nr.esc],FR=[nr.enter,nr.tab];var NR=/*#__PURE__*/function(_Dr207){function NR(e){var _this727;_classCallCheck(this,NR);_this727=_callSuper(this,NR,[e]),_defineProperty(_assertThisInitialized(_this727),"_mentionsView",void 0),_defineProperty(_assertThisInitialized(_this727),"_mentionsConfigurations",void 0),_defineProperty(_assertThisInitialized(_this727),"_balloon",void 0),_defineProperty(_assertThisInitialized(_this727),"_items",new br()),_defineProperty(_assertThisInitialized(_this727),"_lastRequested",void 0),_defineProperty(_assertThisInitialized(_this727),"_requestFeedDebounced",void 0),_this727._mentionsView=_this727._createMentionView(),_this727._mentionsConfigurations=new Map(),_this727._requestFeedDebounced=vs(_this727._requestFeed,100),e.config.define("mention",{feeds:[]});return _this727;}_inherits(NR,_Dr207);return _createClass(NR,[{key:"init",value:function init(){var _this728=this;var e=this.editor,t=e.config.get("mention.commitKeys")||FR,i=LR.concat(t);this._balloon=e.plugins.get(Db),e.editing.view.document.on("keydown",function(e,n){var s;s=n.keyCode,i.includes(s)&&_this728._isUIVisible&&(n.preventDefault(),e.stop(),n.keyCode==nr.arrowdown&&_this728._mentionsView.selectNext(),n.keyCode==nr.arrowup&&_this728._mentionsView.selectPrevious(),t.includes(n.keyCode)&&_this728._mentionsView.executeSelected(),n.keyCode==nr.esc&&_this728._hideUIAndRemoveMarker());},{priority:"highest"}),cg({emitter:this._mentionsView,activator:function activator(){return _this728._isUIVisible;},contextElements:function contextElements(){return[_this728._balloon.view.element];},callback:function callback(){return _this728._hideUIAndRemoveMarker();}});var n=e.config.get("mention.feeds");var _iterator758=_createForOfIteratorHelper(n),_step758;try{for(_iterator758.s();!(_step758=_iterator758.n()).done;){var _e737=_step758.value;var _t509=_e737.feed,_i553=_e737.marker,_n287=_e737.dropdownLimit;if(!UR(_i553))throw new A("mentionconfig-incorrect-marker",null,{marker:_i553});var _s202={marker:_i553,feedCallback:"function"==typeof _t509?_t509.bind(this.editor):$R(_t509),itemRenderer:_e737.itemRenderer,dropdownLimit:_n287};this._mentionsConfigurations.set(_i553,_s202);}}catch(err){_iterator758.e(err);}finally{_iterator758.f();}this._setupTextWatcher(n),this.listenTo(e,"change:isReadOnly",function(){_this728._hideUIAndRemoveMarker();}),this.on("requestFeed:response",function(e,t){return _this728._handleFeedResponse(t);}),this.on("requestFeed:error",function(){return _this728._hideUIAndRemoveMarker();});}},{key:"destroy",value:function destroy(){_superPropGet(NR,"destroy",this,3)([]),this._mentionsView.destroy();}},{key:"_isUIVisible",get:function get(){return this._balloon.visibleView===this._mentionsView;}},{key:"_createMentionView",value:function _createMentionView(){var _this729=this;var e=this.editor.locale,t=new OR(e);return t.items.bindTo(this._items).using(function(i){var n=i.item,s=i.marker,_this729$_mentionsCon=_this729._mentionsConfigurations.get(s),o=_this729$_mentionsCon.dropdownLimit,r=o||_this729.editor.config.get("mention.dropdownLimit")||10;if(t.items.length>=r)return null;var a=new MR(e),l=_this729._renderItem(n,s);return l.delegate("execute").to(a),a.children.add(l),a.item=n,a.marker=s,a.on("execute",function(){t.fire("execute",{item:n,marker:s});}),a;}),t.on("execute",function(e,t){var i=_this729.editor,n=i.model,s=t.item,o=t.marker,r=i.model.markers.get("mention"),a=n.createPositionAt(n.document.selection.focus),l=n.createPositionAt(r.getStart()),c=n.createRange(l,a);_this729._hideUIAndRemoveMarker(),i.execute("mention",{mention:s,text:s.text,marker:o,range:c}),i.editing.view.focus();}),t;}},{key:"_getItemRenderer",value:function _getItemRenderer(e){var _this$_mentionsConfig=this._mentionsConfigurations.get(e),t=_this$_mentionsConfig.itemRenderer;return t;}},{key:"_requestFeed",value:function _requestFeed(e,t){var _this730=this;this._lastRequested=t;var _this$_mentionsConfig2=this._mentionsConfigurations.get(e),i=_this$_mentionsConfig2.feedCallback,n=i(t);n instanceof Promise?n.then(function(i){_this730._lastRequested==t?_this730.fire("requestFeed:response",{feed:i,marker:e,feedText:t}):_this730.fire("requestFeed:discarded",{feed:i,marker:e,feedText:t});})["catch"](function(t){_this730.fire("requestFeed:error",{error:t}),E("mention-feed-callback-error",{marker:e});}):this.fire("requestFeed:response",{feed:n,marker:e,feedText:t});}},{key:"_setupTextWatcher",value:function _setupTextWatcher(e){var _this731=this;var t=this.editor,i=e.map(function(e){return _objectSpread(_objectSpread({},e),{},{pattern:HR(e.marker,e.minimumCharacters||0)});}),n=new Mw(t.model,function(e){var t=function t(_t510){var i=zR(e,_t510);if(!i)return!1;var n=0;0!==i.position&&(n=i.position-1);var s=_t510.substring(n);return i.pattern.test(s);};return t;}(i));n.on("matched",function(e,n){var s=zR(i,n.text),o=t.model.document.selection.focus,r=t.model.createPositionAt(o.parent,s.position);if(function(e){var t=e.textNode&&e.textNode.hasAttribute("mention"),i=e.nodeBefore;return t||i&&i.is("$text")&&i.hasAttribute("mention");}(o)||function(e){var t=e.nodeAfter;return t&&t.is("$text")&&t.hasAttribute("mention");}(r))return void _this731._hideUIAndRemoveMarker();var a=function(e,t){var i=0;0!==e.position&&(i=e.position-1);var n=HR(e.marker,0),s=t.substring(i);return s.match(n)[2];}(s,n.text),l=s.marker.length+a.length,c=o.getShiftedBy(-l),d=o.getShiftedBy(-a.length),u=t.model.createRange(c,d);if(WR(t)){var _e738=t.model.markers.get("mention");t.model.change(function(t){t.updateMarker(_e738,{range:u});});}else t.model.change(function(e){e.addMarker("mention",{range:u,usingOperation:!1,affectsData:!1});});_this731._requestFeedDebounced(s.marker,a);}),n.on("unmatched",function(){_this731._hideUIAndRemoveMarker();});var s=t.commands.get("mention");return n.bind("isEnabled").to(s),n;}},{key:"_handleFeedResponse",value:function _handleFeedResponse(e){var t=e.feed,i=e.marker;if(!WR(this.editor))return;this._items.clear();var _iterator759=_createForOfIteratorHelper(t),_step759;try{for(_iterator759.s();!(_step759=_iterator759.n()).done;){var _e739=_step759.value;var _t511="object"!=_typeof(_e739)?{id:_e739,text:_e739}:_e739;this._items.add({item:_t511,marker:i});}}catch(err){_iterator759.e(err);}finally{_iterator759.f();}var n=this.editor.model.markers.get("mention");this._items.length?this._showOrUpdateUI(n):this._hideUIAndRemoveMarker();}},{key:"_showOrUpdateUI",value:function _showOrUpdateUI(e){this._isUIVisible?this._balloon.updatePosition(this._getBalloonPanelPositionData(e,this._mentionsView.position)):this._balloon.add({view:this._mentionsView,position:this._getBalloonPanelPositionData(e,this._mentionsView.position),singleViewMode:!0}),this._mentionsView.position=this._balloon.view.position,this._mentionsView.selectFirst();}},{key:"_hideUIAndRemoveMarker",value:function _hideUIAndRemoveMarker(){this._balloon.hasView(this._mentionsView)&&this._balloon.remove(this._mentionsView),WR(this.editor)&&this.editor.model.change(function(e){return e.removeMarker("mention");}),this._mentionsView.position=void 0;}},{key:"_renderItem",value:function _renderItem(e,t){var i=this.editor;var n,s=e.id;var o=this._getItemRenderer(t);if(o){var _t512=o(e);"string"!=typeof _t512?n=new BR(i.locale,_t512):s=_t512;}if(!n){var _e740=new pg(i.locale);_e740.label=s,_e740.withText=!0,n=_e740;}return n;}},{key:"_getBalloonPanelPositionData",value:function _getBalloonPanelPositionData(e,t){var _this732=this;var i=this.editor,n=i.editing,s=n.view.domConverter,o=n.mapper;return{target:function target(){var t=e.getRange();"$graveyard"==t.start.root.rootName&&(t=i.model.document.selection.getFirstRange());var n=o.toViewRange(t);return Eo.getDomRangeRects(s.viewRangeToDom(n)).pop();},limiter:function limiter(){var e=_this732.editor.editing.view,t=e.document.selection.editableElement;return t?e.domConverter.mapViewToDom(t.root):null;},positions:DR(t,i.locale.uiLanguageDirection)};}}],[{key:"pluginName",get:function get(){return"MentionUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Db];}}]);}(Dr);function DR(e,t){var i={caret_se:function caret_se(e){return{top:e.bottom+3,left:e.right,name:"caret_se",config:{withArrow:!1}};},caret_ne:function caret_ne(e,t){return{top:e.top-t.height-3,left:e.right,name:"caret_ne",config:{withArrow:!1}};},caret_sw:function caret_sw(e,t){return{top:e.bottom+3,left:e.right-t.width,name:"caret_sw",config:{withArrow:!1}};},caret_nw:function caret_nw(e,t){return{top:e.top-t.height-3,left:e.right-t.width,name:"caret_nw",config:{withArrow:!1}};}};return Object.prototype.hasOwnProperty.call(i,e)?[i[e]]:"rtl"!==t?[i.caret_se,i.caret_sw,i.caret_ne,i.caret_nw]:[i.caret_sw,i.caret_se,i.caret_nw,i.caret_ne];}function zR(e,t){var i;var _iterator760=_createForOfIteratorHelper(e),_step760;try{for(_iterator760.s();!(_step760=_iterator760.n()).done;){var _n288=_step760.value;var _e741=t.lastIndexOf(_n288.marker);_e741>0&&!t.substring(_e741-1).match(_n288.pattern)||(!i||_e741>=i.position)&&(i={marker:_n288.marker,position:_e741,minimumCharacters:_n288.minimumCharacters,pattern:_n288.pattern});}}catch(err){_iterator760.e(err);}finally{_iterator760.f();}return i;}function HR(e,t){var i=0==t?"*":"{".concat(t,",}"),n=o.features.isRegExpUnicodePropertySupported?"\\p{Ps}\\p{Pi}\"'":"\\(\\[{\"'";e=e.replace(/[.*+?^${}()\-|[\]\\]/g,"\\$&");return new RegExp("(?:^|[ ".concat(n,"])([").concat(e,"])(.").concat(i,")$"),"u");}function $R(e){return function(t){return e.filter(function(e){return("string"==typeof e?e:String(e.id)).toLowerCase().includes(t.toLowerCase());});};}function UR(e){return e&&1==e.length;}function WR(e){return e.model.markers.has("mention");}var jR=/*#__PURE__*/function(_Dr208){function jR(){_classCallCheck(this,jR);return _callSuper(this,jR,arguments);}_inherits(jR,_Dr208);return _createClass(jR,[{key:"toMentionAttribute",value:function toMentionAttribute(e,t){return PR(e,t);}}],[{key:"pluginName",get:function get(){return"Mention";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[ER,NR];}}]);}(Dr);var qR=Oo("px");var GR=/*#__PURE__*/function(_Bb){function GR(e,t){var _this733;_classCallCheck(this,GR);_this733=_callSuper(this,GR,[e]);_defineProperty(_this733,"_options",void 0);var i=_this733.bindTemplate;_this733.set("top",0),_this733.set("height",0),_this733._options=t,_this733.extendTemplate({attributes:{tabindex:-1,"aria-hidden":"true","class":["ck-minimap__iframe"],style:{top:i.to("top",function(e){return qR(e);}),height:i.to("height",function(e){return qR(e);})}}});return _this733;}_inherits(GR,_Bb);return _createClass(GR,[{key:"render",value:function render(){var _this734=this;return _superPropGet(GR,"render",this,3)([]).then(function(){_this734._prepareDocument();});}},{key:"setHeight",value:function setHeight(e){this.height=e;}},{key:"setTopOffset",value:function setTopOffset(e){this.top=e;}},{key:"_prepareDocument",value:function _prepareDocument(){var e=this.element.contentWindow.document,t=e.adoptNode(this._options.domRootClone),i=this._options.useSimplePreview?"\n\t\t\t.ck.ck-editor__editable_inline img {\n\t\t\t\tfilter: contrast( 0 );\n\t\t\t}\n\n\t\t\tp, li, a, figcaption, span {\n\t\t\t\tbackground: hsl(0, 0%, 80%) !important;\n\t\t\t\tcolor: hsl(0, 0%, 80%) !important;\n\t\t\t}\n\n\t\t\th1, h2, h3, h4 {\n\t\t\t\tbackground: hsl(0, 0%, 60%) !important;\n\t\t\t\tcolor: hsl(0, 0%, 60%) !important;\n\t\t\t}\n\t\t":"",n="<!DOCTYPE html><html lang=\"en\">\n\t\t\t<head>\n\t\t\t\t<meta charset=\"utf-8\">\n\t\t\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\t\t\t\t".concat(this._options.pageStyles.map(function(e){return"string"==typeof e?"<style>".concat(e,"</style>"):"<link rel=\"stylesheet\" type=\"text/css\" href=\"".concat(e.href,"\">");}).join("\n"),"\n\t\t\t\t<style>\n\t\t\t\t\thtml, body {\n\t\t\t\t\t\tmargin: 0 !important;\n\t\t\t\t\t\tpadding: 0 !important;\n\t\t\t\t\t}\n\n\t\t\t\t\thtml {\n\t\t\t\t\t\toverflow: hidden;\n\t\t\t\t\t}\n\n\t\t\t\t\tbody {\n\t\t\t\t\t\ttransform: scale( ").concat(this._options.scaleRatio," );\n\t\t\t\t\t\ttransform-origin: 0 0;\n\t\t\t\t\t\toverflow: visible;\n\t\t\t\t\t}\n\n\t\t\t\t\t.ck.ck-editor__editable_inline {\n\t\t\t\t\t\tmargin: 0 !important;\n\t\t\t\t\t\tborder-color: transparent !important;\n\t\t\t\t\t\toutline-color: transparent !important;\n\t\t\t\t\t\tbox-shadow: none !important;\n\t\t\t\t\t}\n\n\t\t\t\t\t.ck.ck-content {\n\t\t\t\t\t\tbackground: white;\n\t\t\t\t\t}\n\n\t\t\t\t\t").concat(i,"\n\t\t\t\t</style>\n\t\t\t</head>\n\t\t\t<body class=\"").concat(this._options.extraClasses||"","\"></body>\n\t\t</html>");e.open(),e.write(n),e.close(),e.body.appendChild(t);}}]);}(Bb);var KR=Oo("px");var ZR=/*#__PURE__*/function(_lg65){function ZR(e){var _this735;_classCallCheck(this,ZR);_this735=_callSuper(this,ZR,[e]);var t=_this735.bindTemplate;_this735.set("height",0),_this735.set("top",0),_this735.set("scrollProgress",0),_this735.set("_isDragging",!1),_this735.setTemplate({tag:"div",attributes:{"class":["ck","ck-minimap__position-tracker",t["if"]("_isDragging","ck-minimap__position-tracker_dragging")],style:{top:t.to("top",function(e){return KR(e);}),height:t.to("height",function(e){return KR(e);})},"data-progress":t.to("scrollProgress")},on:{mousedown:t.to(function(){_this735._isDragging=!0;})}});return _this735;}_inherits(ZR,_lg65);return _createClass(ZR,[{key:"render",value:function render(){var _this736=this;_superPropGet(ZR,"render",this,3)([]),this.listenTo(i.document,"mousemove",function(e,t){_this736._isDragging&&_this736.fire("drag",t.movementY);},{useCapture:!0}),this.listenTo(i.document,"mouseup",function(){_this736._isDragging=!1;},{useCapture:!0});}},{key:"setHeight",value:function setHeight(e){this.height=e;}},{key:"setTopOffset",value:function setTopOffset(e){this.top=e;}},{key:"setScrollProgress",value:function setScrollProgress(e){this.scrollProgress=e;}}]);}(lg);var JR=/*#__PURE__*/function(_lg66){function JR(_ref279){var _this737;var e=_ref279.locale,t=_ref279.scaleRatio,i=_ref279.pageStyles,n=_ref279.extraClasses,s=_ref279.useSimplePreview,o=_ref279.domRootClone;_classCallCheck(this,JR);_this737=_callSuper(this,JR,[e]);_defineProperty(_this737,"_positionTrackerView",void 0);_defineProperty(_this737,"_scaleRatio",void 0);_defineProperty(_this737,"_minimapIframeView",void 0);var r=_this737.bindTemplate;_this737._positionTrackerView=new ZR(e),_this737._positionTrackerView.delegate("drag").to(_this737),_this737._scaleRatio=t,_this737._minimapIframeView=new GR(e,{useSimplePreview:s,pageStyles:i,extraClasses:n,scaleRatio:t,domRootClone:o}),_this737.setTemplate({tag:"div",attributes:{"class":["ck","ck-minimap"]},children:[_this737._positionTrackerView],on:{click:r.to(_this737._handleMinimapClick.bind(_this737)),wheel:r.to(_this737._handleMinimapMouseWheel.bind(_this737))}});return _this737;}_inherits(JR,_lg66);return _createClass(JR,[{key:"destroy",value:function destroy(){this._minimapIframeView.destroy(),_superPropGet(JR,"destroy",this,3)([]);}},{key:"height",get:function get(){return new Eo(this.element).height;}},{key:"scrollHeight",get:function get(){return Math.max(0,Math.min(this.height,this._minimapIframeView.height)-this._positionTrackerView.height);}},{key:"render",value:function render(){_superPropGet(JR,"render",this,3)([]),this._minimapIframeView.render(),this.element.appendChild(this._minimapIframeView.element);}},{key:"setContentHeight",value:function setContentHeight(e){this._minimapIframeView.setHeight(e*this._scaleRatio);}},{key:"setScrollProgress",value:function setScrollProgress(e){var t=this._minimapIframeView,i=this._positionTrackerView;if(t.height<this.height)t.setTopOffset(0),i.setTopOffset((t.height-i.height)*e);else{var _n289=t.height-this.height;t.setTopOffset(-_n289*e),i.setTopOffset((this.height-i.height)*e);}i.setScrollProgress(Math.round(100*e));}},{key:"setPositionTrackerHeight",value:function setPositionTrackerHeight(e){this._positionTrackerView.setHeight(e*this._scaleRatio);}},{key:"_handleMinimapClick",value:function _handleMinimapClick(e){var t=this._positionTrackerView;if(e.target===t.element)return;var i=new Eo(t.element),n=(e.clientY-i.top-i.height/2)/this._minimapIframeView.height;this.fire("click",n);}},{key:"_handleMinimapMouseWheel",value:function _handleMinimapMouseWheel(e){this.fire("drag",e.deltaY*this._scaleRatio);}}]);}(lg);function QR(e,t){var i=e.editing.view.document,n=i.getRoot(t),s=new yl(i),o=new ul(s,i.selection),r=e.editing.view.getDomRoot().cloneNode();return s.bindElements(r,n),o.markToSync("children",n),o.markToSync("attributes",n),n.on("change:children",function(e,t){return o.markToSync("children",t);}),n.on("change:attributes",function(e,t){return o.markToSync("attributes",t);}),n.on("change:text",function(e,t){return o.markToSync("text",t);}),o.render(),e.editing.view.on("render",function(){return o.render();}),e.on("destroy",function(){s.unbindDomElement(r);}),r;}function YR(e){return new Eo(e===i.document.body?i.window:e);}function XR(e){return e===i.document.body?i.window:e;}var eO=/*#__PURE__*/function(_Dr209){function eO(){var _this738;_classCallCheck(this,eO);for(var _len96=arguments.length,args=new Array(_len96),_key96=0;_key96<_len96;_key96++){args[_key96]=arguments[_key96];}_this738=_callSuper(this,eO,[].concat(args));_defineProperty(_this738,"_minimapView",void 0);_defineProperty(_this738,"_scrollableRootAncestor",void 0);_defineProperty(_this738,"_editingRootElement",void 0);return _this738;}_inherits(eO,_Dr209);return _createClass(eO,[{key:"init",value:function init(){var e=this.editor;this._minimapView=null,this._scrollableRootAncestor=null,this.listenTo(e.ui,"ready",this._onUiReady.bind(this));}},{key:"destroy",value:function destroy(){_superPropGet(eO,"destroy",this,3)([]),this._minimapView.destroy(),this._minimapView.element.remove();}},{key:"_onUiReady",value:function _onUiReady(){var _this739=this;var e=this.editor,t=this._editingRootElement=e.ui.getEditableElement();this._scrollableRootAncestor=bo(t),t.ownerDocument.body.contains(t)?(this._initializeMinimapView(),this.listenTo(e.editing.view,"render",function(){"ready"===e.state&&_this739._syncMinimapToEditingRootScrollPosition();}),this._syncMinimapToEditingRootScrollPosition()):e.ui.once("update",this._onUiReady.bind(this));}},{key:"_initializeMinimapView",value:function _initializeMinimapView(){var _this740=this;var e=this.editor,t=e.locale,n=e.config.get("minimap.useSimplePreview"),s=e.config.get("minimap.container"),o=this._scrollableRootAncestor,r=YR(this._editingRootElement).width,a=YR(s).width/r,l=this._minimapView=new JR({locale:t,scaleRatio:a,pageStyles:Array.from(i.document.styleSheets).map(function(e){return e.href&&!e.href.startsWith(i.window.location.origin)?{href:e.href}:Array.from(e.cssRules).filter(function(e){return!(e instanceof CSSMediaRule);}).map(function(e){return e.cssText;}).join(" \n");}),extraClasses:e.config.get("minimap.extraClasses"),useSimplePreview:n,domRootClone:QR(e)});l.render(),l.listenTo(i.document,"scroll",function(e,t){if(o===i.document.body){if(t.target!==i.document)return;}else if(t.target!==o)return;_this740._syncMinimapToEditingRootScrollPosition();},{useCapture:!0,usePassive:!0}),l.listenTo(i.window,"resize",function(){_this740._syncMinimapToEditingRootScrollPosition();}),l.on("drag",function(e,t){var n;n=0===l.scrollHeight?0:t/l.scrollHeight;var s=n*(o.scrollHeight-((r=o)===i.document.body?i.window.innerHeight:r.clientHeight));var r;XR(o).scrollBy(0,Math.round(s));}),l.on("click",function(e,t){var i=t*o.scrollHeight;XR(o).scrollBy(0,Math.round(i));}),s.appendChild(l.element);}},{key:"_syncMinimapToEditingRootScrollPosition",value:function _syncMinimapToEditingRootScrollPosition(){var e=this._editingRootElement,t=this._minimapView;t.setContentHeight(e.offsetHeight);var i=YR(e),n=YR(this._scrollableRootAncestor);var s;n.contains(i)||i.top>n.top?s=0:(s=(i.top-n.top)/(n.height-i.height),s=Math.max(0,Math.min(s,1))),t.setPositionTrackerHeight(n.getIntersection(i).height),t.setScrollProgress(s);}}],[{key:"pluginName",get:function get(){return"Minimap";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var tO=/*#__PURE__*/function(_Hr56){function tO(){_classCallCheck(this,tO);return _callSuper(this,tO,arguments);}_inherits(tO,_Hr56);return _createClass(tO,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.schema,i=e.document.selection;this.isEnabled=function(e,t,i){var n=function(e,t){var i=hy(e,t),n=i.start.parent;if(n.isEmpty&&!n.is("element","$root"))return n.parent;return n;}(e,i);return t.checkChild(n,"pageBreak");}(i,t,e);}},{key:"execute",value:function execute(){var e=this.editor.model;e.change(function(t){var i=t.createElement("pageBreak");e.insertObject(i,null,null,{setSelection:"after"});});}}]);}(Hr);var iO=/*#__PURE__*/function(_Dr210){function iO(){_classCallCheck(this,iO);return _callSuper(this,iO,arguments);}_inherits(iO,_Dr210);return _createClass(iO,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.t,n=e.conversion;t.register("pageBreak",{inheritAllFrom:"$blockObject"}),n["for"]("dataDowncast").elementToStructure({model:"pageBreak",view:function view(e,_ref280){var t=_ref280.writer;return t.createContainerElement("div",{"class":"page-break",style:"page-break-after: always"},t.createContainerElement("span",{style:"display: none"}));}}),n["for"]("editingDowncast").elementToStructure({model:"pageBreak",view:function view(e,_ref281){var t=_ref281.writer;var n=i("Page break"),s=t.createContainerElement("div"),o=t.createRawElement("span",{"class":"page-break__label"},function(e){e.innerText=i("Page break");});return t.addClass("page-break",s),t.insert(t.createPositionAt(s,0),o),function(e,t,i){return t.setCustomProperty("pageBreak",!0,e),oy(e,t,{label:i});}(s,t,n);}}),n["for"]("upcast").elementToElement({view:function view(e){var t="always"==e.getStyle("page-break-before"),i="always"==e.getStyle("page-break-after");if(!t&&!i)return null;if(1==e.childCount){var _t513=e.getChild(0);if(!_t513.is("element","span")||"none"!=_t513.getStyle("display"))return null;}else if(e.childCount>1)return null;return{name:!0};},model:"pageBreak",converterPriority:"high"}),e.commands.add("pageBreak",new tO(e));}}],[{key:"pluginName",get:function get(){return"PageBreakEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var nO=/*#__PURE__*/function(_Dr211){function nO(){_classCallCheck(this,nO);return _callSuper(this,nO,arguments);}_inherits(nO,_Dr211);return _createClass(nO,[{key:"init",value:function init(){var _this741=this;var e=this.editor;e.ui.componentFactory.add("pageBreak",function(){var e=_this741._createButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:pageBreak",function(){return _this741._createButton(Rg);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get("pageBreak"),s=new e(t.locale),o=i.t;return s.set({label:o("Page break"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.598.687h1.5v5h-1.5zm14.5 0h1.5v5h-1.5z"/><path d="M19.598 4.187v1.5h-16v-1.5zm-16 14.569h1.5v-5h-1.5zm14.5 0h1.5v-5h-1.5z"/><path d="M19.598 15.256v-1.5h-16v1.5zM5.081 9h6v2h-6zm8 0h6v2h-6zm-9.483 1L0 12.5v-5z"/></svg>'}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",function(){t.execute("pageBreak"),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"PageBreakUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var sO=/*#__PURE__*/function(_Dr212){function sO(){_classCallCheck(this,sO);return _callSuper(this,sO,arguments);}_inherits(sO,_Dr212);return _createClass(sO,null,[{key:"requires",get:function get(){return[iO,nO,Ty];}},{key:"pluginName",get:function get(){return"PageBreak";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function oO(e){return void 0!==e&&e.endsWith("px");}function rO(e){return e.toFixed(2).replace(/\.?0+$/,"")+"px";}function aO(e,t,i){if(!e.childCount)return;var n=new ju(e.document),s=function(e,t){var i=t.createRangeIn(e),n=[],s=new Set();var _iterator761=_createForOfIteratorHelper(i.getItems()),_step761;try{for(_iterator761.s();!(_step761=_iterator761.n()).done;){var _e742=_step761.value;if(!_e742.is("element")||!_e742.name.match(/^(p|h\d+|li|div)$/))continue;var _t514=fO(_e742);if(void 0===_t514||0!=parseFloat(_t514)||Array.from(_e742.getClassNames()).find(function(e){return e.startsWith("MsoList");})||(_t514=void 0),_e742.hasStyle("mso-list")||void 0!==_t514&&s.has(_t514)){var _i554=mO(_e742);n.push({element:_e742,id:_i554.id,order:_i554.order,indent:_i554.indent,marginLeft:_t514}),void 0!==_t514&&s.add(_t514);}else s.clear();}}catch(err){_iterator761.e(err);}finally{_iterator761.f();}return n;}(e,n);if(!s.length)return;var o={},r=[];var _iterator762=_createForOfIteratorHelper(s),_step762;try{var _loop38=function _loop38(){var e=_step762.value;if(void 0!==e.indent){lO(e)||(r.length=0);var _s203="".concat(e.id,":").concat(e.indent),_a38=Math.min(e.indent-1,r.length);if(_a38<r.length&&r[_a38].id!==e.id&&(r.length=_a38),_a38<r.length-1)r.length=_a38+1;else{var _l25=dO(e,t);if(_a38>r.length-1||r[_a38].listElement.name!=_l25.type){0==_a38&&"ol"==_l25.type&&void 0!==e.id&&o[_s203]&&(_l25.startIndex=o[_s203]);var _t515=hO(_l25,n,i);if(oO(e.marginLeft)&&(0==_a38||oO(r[_a38-1].marginLeft))){var _i555=e.marginLeft;_a38>0&&(_i555=rO(parseFloat(_i555)-parseFloat(r[_a38-1].marginLeft))),n.setStyle("padding-left",_i555,_t515);}if(0==r.length){var _i556=e.element.parent,_s204=_i556.getChildIndex(e.element)+1;n.insertChild(_s204,_t515,_i556);}else{var _e743=r[_a38-1].listItemElements;n.appendChild(_t515,_e743[_e743.length-1]);}r[_a38]=_objectSpread(_objectSpread({},e),{},{listElement:_t515,listItemElements:[]}),0==_a38&&void 0!==e.id&&(o[_s203]=_l25.startIndex||1);}}var _l26="li"==e.element.name?e.element:n.createElement("li");n.appendChild(_l26,r[_a38].listElement),r[_a38].listItemElements.push(_l26),0==_a38&&void 0!==e.id&&o[_s203]++,e.element!=_l26&&n.appendChild(e.element,_l26),gO(e.element,n),n.removeStyle("text-indent",e.element),n.removeStyle("margin-left",e.element);}else{var _t516=r.find(function(t){return t.marginLeft==e.marginLeft;});if(_t516){var _i557=_t516.listItemElements;n.appendChild(e.element,_i557[_i557.length-1]),n.removeStyle("margin-left",e.element);}else r.length=0;}};for(_iterator762.s();!(_step762=_iterator762.n()).done;){_loop38();}}catch(err){_iterator762.e(err);}finally{_iterator762.f();}}function lO(e){var t=e.element.previousSibling;return cO(t||e.element.parent);}function cO(e){return e.is("element","ol")||e.is("element","ul");}function dO(e,t){var i=new RegExp("@list l".concat(e.id,":level").concat(e.indent,"\\s*({[^}]*)"),"gi"),n=/mso-level-number-format:([^;]{0,100});/gi,s=/mso-level-start-at:\s{0,100}([0-9]{0,10})\s{0,100};/gi,o=new RegExp("@list\\s+l".concat(e.id,":level\\d\\s*{[^{]*mso-level-text:\"%\\d\\\\."),"gi"),r=new RegExp("@list l".concat(e.id,":level\\d\\s*{[^{]*mso-level-number-format:"),"gi"),a=o.exec(t),l=r.exec(t),c=a&&!l,d=i.exec(t);var u="decimal",h="ol",m=null;if(d&&d[1]){var _t517=n.exec(d[1]);if(_t517&&_t517[1]&&(u=_t517[1].trim(),h="bullet"!==u&&"image"!==u?"ol":"ul"),"bullet"===u){var _t518=function(e){if("li"==e.name&&"ul"==e.parent.name&&e.parent.hasAttribute("type"))return e.parent.getAttribute("type");var t=function(e){if(e.getChild(0).is("$text"))return null;var _iterator763=_createForOfIteratorHelper(e.getChildren()),_step763;try{for(_iterator763.s();!(_step763=_iterator763.n()).done;){var _t519=_step763.value;if(!_t519.is("element","span"))continue;var _e744=_t519.getChild(0);if(_e744)return _e744.is("$text")?_e744:_e744.getChild(0);}}catch(err){_iterator763.e(err);}finally{_iterator763.f();}return null;}(e);if(!t)return null;var i=t._data;if("o"===i)return"circle";if("·"===i)return"disc";if("§"===i)return"square";return null;}(e.element);_t518&&(u=_t518);}else{var _e745=s.exec(d[1]);_e745&&_e745[1]&&(m=parseInt(_e745[1]));}c&&(h="ol");}return{type:h,startIndex:m,style:uO(u),isLegalStyleList:c};}function uO(e){if(e.startsWith("arabic-leading-zero"))return"decimal-leading-zero";switch(e){case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return e;default:return null;}}function hO(e,t,i){var n=t.createElement(e.type);return e.style&&t.setStyle("list-style-type",e.style,n),e.startIndex&&e.startIndex>1&&t.setAttribute("start",e.startIndex,n),e.isLegalStyleList&&i&&t.addClass("legal-list",n),n;}function mO(e){var t=e.getStyle("mso-list");if(void 0===t)return{};var i=t.match(/(^|\s{1,100})l(\d+)/i),n=t.match(/\s{0,100}lfo(\d+)/i),s=t.match(/\s{0,100}level(\d+)/i);return i&&n&&s?{id:i[2],order:n[1],indent:parseInt(s[1])}:{indent:1};}function gO(e,t){var i=new aa({name:"span",styles:{"mso-list":"Ignore"}}),n=t.createRangeIn(e);var _iterator764=_createForOfIteratorHelper(n),_step764;try{for(_iterator764.s();!(_step764=_iterator764.n()).done;){var _e746=_step764.value;"elementStart"===_e746.type&&i.match(_e746.item)&&t.remove(_e746.item);}}catch(err){_iterator764.e(err);}finally{_iterator764.f();}}function fO(e){var t=e.getStyle("margin-left");return void 0===t||t.endsWith("px")?t:function(e){var t=parseFloat(e);return e.endsWith("pt")?rO(96*t/72):e.endsWith("pc")?rO(12*t*96/72):e.endsWith("in")?rO(96*t):e.endsWith("cm")?rO(96*t/2.54):e.endsWith("mm")?rO(t/10*96/2.54):e;}(t);}function pO(e,t){if(!e.childCount)return;var i=new ju(e.document),n=function(e,t){var i=t.createRangeIn(e),n=new aa({name:/v:(.+)/}),s=[];var _iterator765=_createForOfIteratorHelper(i),_step765;try{var _loop39=function _loop39(){var e=_step765.value;if("elementStart"!=e.type)return 1;// continue
var t=e.item,i=t.previousSibling,o=i&&i.is("element")?i.name:null,r=["Chart"],a=n.match(t),l=t.getAttribute("o:gfxdata"),c="v:shapetype"===o,d=l&&r.some(function(e){return t.getAttribute("id").includes(e);});a&&l&&!c&&!d&&s.push(e.item.getAttribute("id"));};for(_iterator765.s();!(_step765=_iterator765.n()).done;){if(_loop39())continue;}}catch(err){_iterator765.e(err);}finally{_iterator765.f();}return s;}(e,i);!function(e,t,i){var n=i.createRangeIn(t),s=new aa({name:"img"}),o=[];var _iterator766=_createForOfIteratorHelper(n),_step766;try{for(_iterator766.s();!(_step766=_iterator766.n()).done;){var _t520=_step766.value;if(_t520.item.is("element")&&s.match(_t520.item)){var _i559=_t520.item,_n290=_i559.getAttribute("v:shapes")?_i559.getAttribute("v:shapes").split(" "):[];_n290.length&&_n290.every(function(t){return e.indexOf(t)>-1;})?o.push(_i559):_i559.getAttribute("src")||o.push(_i559);}}}catch(err){_iterator766.e(err);}finally{_iterator766.f();}for(var _i558=0,_o123=o;_i558<_o123.length;_i558++){var _e747=_o123[_i558];i.remove(_e747);}}(n,e,i),function(e,t,i){var n=i.createRangeIn(t),s=[];var _iterator767=_createForOfIteratorHelper(n),_step767;try{for(_iterator767.s();!(_step767=_iterator767.n()).done;){var _t523=_step767.value;if("elementStart"==_t523.type&&_t523.item.is("element","v:shape")){var _i562=_t523.item.getAttribute("id");if(e.includes(_i562))continue;o(_t523.item.parent.getChildren(),_i562)||s.push(_t523.item);}}}catch(err){_iterator767.e(err);}finally{_iterator767.f();}for(var _i560=0,_s205=s;_i560<_s205.length;_i560++){var _e748=_s205[_i560];var _t521={src:r(_e748)};_e748.hasAttribute("alt")&&(_t521.alt=_e748.getAttribute("alt"));var _n291=i.createElement("img",_t521);i.insertChild(_e748.index+1,_n291,_e748.parent);}function o(e,t){var _iterator768=_createForOfIteratorHelper(e),_step768;try{for(_iterator768.s();!(_step768=_iterator768.n()).done;){var _i561=_step768.value;if(_i561.is("element")){if("img"==_i561.name&&_i561.getAttribute("v:shapes")==t)return!0;if(o(_i561.getChildren(),t))return!0;}}}catch(err){_iterator768.e(err);}finally{_iterator768.f();}return!1;}function r(e){var _iterator769=_createForOfIteratorHelper(e.getChildren()),_step769;try{for(_iterator769.s();!(_step769=_iterator769.n()).done;){var _t522=_step769.value;if(_t522.is("element")&&_t522.getAttribute("src"))return _t522.getAttribute("src");}}catch(err){_iterator769.e(err);}finally{_iterator769.f();}}}(n,e,i),function(e,t){var i=t.createRangeIn(e),n=new aa({name:/v:(.+)/}),s=[];var _iterator770=_createForOfIteratorHelper(i),_step770;try{for(_iterator770.s();!(_step770=_iterator770.n()).done;){var _e750=_step770.value;"elementStart"==_e750.type&&n.match(_e750.item)&&s.push(_e750.item);}}catch(err){_iterator770.e(err);}finally{_iterator770.f();}for(var _i563=0,_s206=s;_i563<_s206.length;_i563++){var _e749=_s206[_i563];t.remove(_e749);}}(e,i);var s=function(e,t){var i=t.createRangeIn(e),n=new aa({name:"img"}),s=[];var _iterator771=_createForOfIteratorHelper(i),_step771;try{for(_iterator771.s();!(_step771=_iterator771.n()).done;){var _e751=_step771.value;_e751.item.is("element")&&n.match(_e751.item)&&_e751.item.getAttribute("src").startsWith("file://")&&s.push(_e751.item);}}catch(err){_iterator771.e(err);}finally{_iterator771.f();}return s;}(e,i);s.length&&function(e,t,i){if(e.length===t.length)for(var _n292=0;_n292<e.length;_n292++){var _s207="data:".concat(t[_n292].type,";base64,").concat(bO(t[_n292].hex));i.setAttribute("src",_s207,e[_n292]);}}(s,function(e){if(!e)return[];var t=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,i=new RegExp("(?:("+t.source+"))([\\da-fA-F\\s]+)\\}","g"),n=e.match(i),s=[];if(n){var _iterator772=_createForOfIteratorHelper(n),_step772;try{for(_iterator772.s();!(_step772=_iterator772.n()).done;){var _e752=_step772.value;var _i564=!1;_e752.includes("\\pngblip")?_i564="image/png":_e752.includes("\\jpegblip")&&(_i564="image/jpeg"),_i564&&s.push({hex:_e752.replace(t,"").replace(/[^\da-fA-F]/g,""),type:_i564});}}catch(err){_iterator772.e(err);}finally{_iterator772.f();}}return s;}(t),i);}function bO(e){return btoa(e.match(/\w{2}/g).map(function(e){return String.fromCharCode(parseInt(e,16));}).join(""));}var wO=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,_O=/xmlns:o="urn:schemas-microsoft-com/i;var vO=/*#__PURE__*/function(){function vO(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;_classCallCheck(this,vO);_defineProperty(this,"document",void 0);_defineProperty(this,"hasMultiLevelListPlugin",void 0);this.document=e,this.hasMultiLevelListPlugin=t;}return _createClass(vO,[{key:"isActive",value:function isActive(e){return wO.test(e)||_O.test(e);}},{key:"execute",value:function execute(e){var _e$_parsedData=e._parsedData,t=_e$_parsedData.body,i=_e$_parsedData.stylesString;aO(t,i,this.hasMultiLevelListPlugin),pO(t,e.dataTransfer.getData("text/rtf")),function(e){var t=[],i=new ju(e.document);var _iterator773=_createForOfIteratorHelper(i.createRangeIn(e)),_step773;try{for(_iterator773.s();!(_step773=_iterator773.n()).done;){var _n294=_step773.value.item;if(_n294.is("element")){var _iterator774=_createForOfIteratorHelper(_n294.getClassNames()),_step774;try{for(_iterator774.s();!(_step774=_iterator774.n()).done;){var _e754=_step774.value;/\bmso/gi.exec(_e754)&&i.removeClass(_e754,_n294);}}catch(err){_iterator774.e(err);}finally{_iterator774.f();}var _iterator775=_createForOfIteratorHelper(_n294.getStyleNames()),_step775;try{for(_iterator775.s();!(_step775=_iterator775.n()).done;){var _e755=_step775.value;/\bmso/gi.exec(_e755)&&i.removeStyle(_e755,_n294);}}catch(err){_iterator775.e(err);}finally{_iterator775.f();}(_n294.is("element","w:sdt")||_n294.is("element","w:sdtpr")&&_n294.isEmpty||_n294.is("element","o:p")&&_n294.isEmpty)&&t.push(_n294);}}}catch(err){_iterator773.e(err);}finally{_iterator773.f();}for(var _i565=0,_t524=t;_i565<_t524.length;_i565++){var _e753=_t524[_i565];var _t525=_e753.parent,_n293=_t525.getChildIndex(_e753);i.insertChild(_n293,_e753.getChildren(),_t525),i.remove(_e753);}}(t),e.content=t;}}]);}();function yO(e,t,i,_ref282){var n=_ref282.blockElements,s=_ref282.inlineObjectElements;var o=i.createPositionAt(e,"forward"==t?"after":"before");return o=o.getLastMatchingPosition(function(_ref283){var e=_ref283.item;return e.is("element")&&!n.includes(e.name)&&!s.includes(e.name);},{direction:t}),"forward"==t?o.nodeAfter:o.nodeBefore;}function kO(e,t){return!!e&&e.is("element")&&t.includes(e.name);}var CO=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;var xO=/*#__PURE__*/function(){function xO(e){_classCallCheck(this,xO);_defineProperty(this,"document",void 0);this.document=e;}return _createClass(xO,[{key:"isActive",value:function isActive(e){return CO.test(e);}},{key:"execute",value:function execute(e){var t=new ju(this.document),i=e._parsedData.body;!function(e,t){var _iterator776=_createForOfIteratorHelper(e.getChildren()),_step776;try{for(_iterator776.s();!(_step776=_iterator776.n()).done;){var _i566=_step776.value;if(_i566.is("element","b")&&"normal"===_i566.getStyle("font-weight")){var _n295=e.getChildIndex(_i566);t.remove(_i566),t.insertChild(_n295,_i566.getChildren(),e);}}}catch(err){_iterator776.e(err);}finally{_iterator776.f();}}(i,t),function(e,t){var _iterator777=_createForOfIteratorHelper(t.createRangeIn(e)),_step777;try{for(_iterator777.s();!(_step777=_iterator777.n()).done;){var _i567=_step777.value;var _e756=_i567.item;if(_e756.is("element","li")){var _i568=_e756.getChild(0);_i568&&_i568.is("element","p")&&t.unwrapElement(_i568);}}}catch(err){_iterator777.e(err);}finally{_iterator777.f();}}(i,t),function(e,t){var i=new Ba(t.document.stylesProcessor),n=new yl(i,{renderingMode:"data"}),s=n.blockElements,o=n.inlineObjectElements,r=[];var _iterator778=_createForOfIteratorHelper(t.createRangeIn(e)),_step778;try{for(_iterator778.s();!(_step778=_iterator778.n()).done;){var _i570=_step778.value;var _e758=_i570.item;if(_e758.is("element","br")){var _i571=yO(_e758,"forward",t,{blockElements:s,inlineObjectElements:o}),_n296=yO(_e758,"backward",t,{blockElements:s,inlineObjectElements:o}),_a39=kO(_i571,s);(kO(_n296,s)||_a39)&&r.push(_e758);}}}catch(err){_iterator778.e(err);}finally{_iterator778.f();}for(var _i569=0,_r54=r;_i569<_r54.length;_i569++){var _e757=_r54[_i569];_e757.hasClass("Apple-interchange-newline")?t.remove(_e757):t.replace(_e757,t.createElement("p"));}}(i,t),e.content=i;}}]);}();var AO=/<google-sheets-html-origin/i;var EO=/*#__PURE__*/function(){function EO(e){_classCallCheck(this,EO);_defineProperty(this,"document",void 0);this.document=e;}return _createClass(EO,[{key:"isActive",value:function isActive(e){return AO.test(e);}},{key:"execute",value:function execute(e){var t=new ju(this.document),i=e._parsedData.body;!function(e,t){var _iterator779=_createForOfIteratorHelper(e.getChildren()),_step779;try{for(_iterator779.s();!(_step779=_iterator779.n()).done;){var _i572=_step779.value;if(_i572.is("element","google-sheets-html-origin")){var _n297=e.getChildIndex(_i572);t.remove(_i572),t.insertChild(_n297,_i572.getChildren(),e);}}}catch(err){_iterator779.e(err);}finally{_iterator779.f();}}(i,t),function(e,t){var _iterator780=_createForOfIteratorHelper(e.getChildren()),_step780;try{for(_iterator780.s();!(_step780=_iterator780.n()).done;){var _i573=_step780.value;_i573.is("element","table")&&_i573.hasAttribute("xmlns")&&t.removeAttribute("xmlns",_i573);}}catch(err){_iterator780.e(err);}finally{_iterator780.f();}}(i,t),function(e,t){var _iterator781=_createForOfIteratorHelper(e.getChildren()),_step781;try{for(_iterator781.s();!(_step781=_iterator781.n()).done;){var _i574=_step781.value;_i574.is("element","table")&&"0px"===_i574.getStyle("width")&&t.removeStyle("width",_i574);}}catch(err){_iterator781.e(err);}finally{_iterator781.f();}}(i,t),function(e,t){for(var _i575=0,_Array$from10=Array.from(e.getChildren());_i575<_Array$from10.length;_i575++){var _i576=_Array$from10[_i575];_i576.is("element","style")&&t.remove(_i576);}}(i,t),e.content=i;}}]);}();function TO(e){return e.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,function(e,t){return 1===t.length?" ":Array(t.length+1).join("  ").substr(0,t.length);});}function PO(e,t){var i=new DOMParser(),n=function(e){return TO(TO(e)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/(<span\s+style=['"]letter-spacing:[^'"]+?['"]>)[\r\n]+(<\/span>)/g,"$1 $2").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><");}(function(e){var t="</body>",i="</html>",n=e.indexOf(t);if(n<0)return e;var s=e.indexOf(i,n+t.length);return e.substring(0,n+t.length)+(s>=0?e.substring(s):"");}(e=(e=e.replace(/<!--\[if gte vml 1]>/g,"")).replace(/<o:SmartTagType(?:\s+[^\s>=]+(?:="[^"]*")?)*\s*\/?>/gi,""))),s=i.parseFromString(n,"text/html");!function(e){e.querySelectorAll("span[style*=spacerun]").forEach(function(e){var t=e,i=t.innerText.length||0;t.innerText=Array(i+1).join("  ").substr(0,i);});}(s);var o=s.body.innerHTML,r=function(e,t){var i=new Ba(t),n=new yl(i,{renderingMode:"data"}),s=e.createDocumentFragment(),o=e.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);return n.domToView(s,{skipComments:!0});}(s,t),a=function(e){var t=[],i=[],n=Array.from(e.getElementsByTagName("style"));for(var _i577=0,_n298=n;_i577<_n298.length;_i577++){var _e759=_n298[_i577];_e759.sheet&&_e759.sheet.cssRules&&_e759.sheet.cssRules.length&&(t.push(_e759.sheet),i.push(_e759.innerHTML));}return{styles:t,stylesString:i.join(" ")};}(s);return{body:r,bodyString:o,styles:a.styles,stylesString:a.stylesString};}var SO=/*#__PURE__*/function(_Dr213){function SO(){_classCallCheck(this,SO);return _callSuper(this,SO,arguments);}_inherits(SO,_Dr213);return _createClass(SO,[{key:"init",value:function init(){var e=this.editor,t=e.plugins.get("ClipboardPipeline"),i=e.editing.view.document,n=[],s=this.editor.plugins.has("MultiLevelList");n.push(new vO(i,s)),n.push(new xO(i)),n.push(new EO(i)),t.on("inputTransformation",function(t,s){if(s._isTransformedWithPasteFromOffice)return;if(e.model.document.selection.getFirstPosition().parent.is("element","codeBlock"))return;var o=s.dataTransfer.getData("text/html"),r=n.find(function(e){return e.isActive(o);});r&&(s._parsedData||(s._parsedData=PO(o,i.stylesProcessor)),r.execute(s),s._isTransformedWithPasteFromOffice=!0);},{priority:"high"});}}],[{key:"pluginName",get:function get(){return"PasteFromOffice";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Jv];}}]);}(Dr);var IO="removeFormat";var VO=/*#__PURE__*/function(_Dr214){function VO(){_classCallCheck(this,VO);return _callSuper(this,VO,arguments);}_inherits(VO,_Dr214);return _createClass(VO,[{key:"init",value:function init(){var _this742=this;var e=this.editor;e.ui.componentFactory.add(IO,function(){var e=_this742._createButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:".concat(IO),function(){return _this742._createButton(Rg);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get(IO),s=new e(t.locale),o=i.t;return s.set({label:o("Remove Format"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.69 14.915c.053.052.173.083.36.093a.366.366 0 0 1 .345.485l-.003.01a.738.738 0 0 1-.697.497h-2.67a.374.374 0 0 1-.353-.496l.013-.038a.681.681 0 0 1 .644-.458c.197-.012.325-.043.386-.093a.28.28 0 0 0 .072-.11L9.592 4.5H6.269c-.359-.017-.609.013-.75.09-.142.078-.289.265-.442.563-.192.29-.516.464-.864.464H4.17a.43.43 0 0 1-.407-.569L4.46 3h13.08l-.62 2.043a.81.81 0 0 1-.775.574h-.114a.486.486 0 0 1-.486-.486c.001-.284-.054-.464-.167-.54-.112-.076-.367-.106-.766-.091h-3.28l-2.68 10.257c-.006.074.007.127.038.158zM3 17h8a.5.5 0 1 1 0 1H3a.5.5 0 1 1 0-1zm11.299 1.17a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.06-1.06l1.415 1.414 1.414-1.415a.75.75 0 1 1 1.06 1.06l-1.413 1.415 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414-1.414 1.414z"/></svg>'}),s.bind("isEnabled").to(n,"isEnabled"),this.listenTo(s,"execute",function(){t.execute(IO),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"RemoveFormatUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var RO=/*#__PURE__*/function(_Hr57){function RO(){_classCallCheck(this,RO);return _callSuper(this,RO,arguments);}_inherits(RO,_Hr57);return _createClass(RO,[{key:"refresh",value:function refresh(){var e=this.editor.model;this.isEnabled=!!wr(this._getFormattingItems(e.document.selection,e.schema));}},{key:"execute",value:function execute(){var _this743=this;var e=this.editor.model,t=e.schema;e.change(function(i){var _iterator782=_createForOfIteratorHelper(_this743._getFormattingItems(e.document.selection,t)),_step782;try{for(_iterator782.s();!(_step782=_iterator782.n()).done;){var _n299=_step782.value;if(_n299.is("selection")){var _iterator783=_createForOfIteratorHelper(_this743._getFormattingAttributes(_n299,t)),_step783;try{for(_iterator783.s();!(_step783=_iterator783.n()).done;){var _e760=_step783.value;i.removeSelectionAttribute(_e760);}}catch(err){_iterator783.e(err);}finally{_iterator783.f();}}else{var _e761=i.createRangeOn(_n299);var _iterator784=_createForOfIteratorHelper(_this743._getFormattingAttributes(_n299,t)),_step784;try{for(_iterator784.s();!(_step784=_iterator784.n()).done;){var _s208=_step784.value;i.removeAttribute(_s208,_e761);}}catch(err){_iterator784.e(err);}finally{_iterator784.f();}}}}catch(err){_iterator782.e(err);}finally{_iterator782.f();}});}},{key:"_getFormattingItems",value:/*#__PURE__*/_regeneratorRuntime().mark(function _getFormattingItems(e,t){var _this744=this;var i,_iterator785,_step785,_n300,_iterator787,_step787,_e762,_iterator786,_step786,_t526;return _regeneratorRuntime().wrap(function _getFormattingItems$(_context62){while(1)switch(_context62.prev=_context62.next){case 0:i=function i(e){return!!wr(_this744._getFormattingAttributes(e,t));};_iterator785=_createForOfIteratorHelper(e.getRanges());_context62.prev=2;_iterator785.s();case 4:if((_step785=_iterator785.n()).done){_context62.next=27;break;}_n300=_step785.value;_iterator787=_createForOfIteratorHelper(_n300.getItems());_context62.prev=7;_iterator787.s();case 9:if((_step787=_iterator787.n()).done){_context62.next=17;break;}_e762=_step787.value;_context62.t0=!t.isBlock(_e762)&&i(_e762);if(!_context62.t0){_context62.next=15;break;}_context62.next=15;return _e762;case 15:_context62.next=9;break;case 17:_context62.next=22;break;case 19:_context62.prev=19;_context62.t1=_context62["catch"](7);_iterator787.e(_context62.t1);case 22:_context62.prev=22;_iterator787.f();return _context62.finish(22);case 25:_context62.next=4;break;case 27:_context62.next=32;break;case 29:_context62.prev=29;_context62.t2=_context62["catch"](2);_iterator785.e(_context62.t2);case 32:_context62.prev=32;_iterator785.f();return _context62.finish(32);case 35:_iterator786=_createForOfIteratorHelper(e.getSelectedBlocks());_context62.prev=36;_iterator786.s();case 38:if((_step786=_iterator786.n()).done){_context62.next=46;break;}_t526=_step786.value;_context62.t3=i(_t526);if(!_context62.t3){_context62.next=44;break;}_context62.next=44;return _t526;case 44:_context62.next=38;break;case 46:_context62.next=51;break;case 48:_context62.prev=48;_context62.t4=_context62["catch"](36);_iterator786.e(_context62.t4);case 51:_context62.prev=51;_iterator786.f();return _context62.finish(51);case 54:_context62.t5=i(e);if(!_context62.t5){_context62.next=58;break;}_context62.next=58;return e;case 58:case"end":return _context62.stop();}},_getFormattingItems,null,[[2,29,32,35],[7,19,22,25],[36,48,51,54]]);})},{key:"_getFormattingAttributes",value:/*#__PURE__*/_regeneratorRuntime().mark(function _getFormattingAttributes(e,t){var _iterator788,_step788,_step788$value,_i578,_e763;return _regeneratorRuntime().wrap(function _getFormattingAttributes$(_context63){while(1)switch(_context63.prev=_context63.next){case 0:_iterator788=_createForOfIteratorHelper(e.getAttributes());_context63.prev=1;_iterator788.s();case 3:if((_step788=_iterator788.n()).done){_context63.next=12;break;}_step788$value=_slicedToArray(_step788.value,1),_i578=_step788$value[0];_e763=t.getAttributeProperties(_i578);_context63.t0=_e763&&_e763.isFormatting;if(!_context63.t0){_context63.next=10;break;}_context63.next=10;return _i578;case 10:_context63.next=3;break;case 12:_context63.next=17;break;case 14:_context63.prev=14;_context63.t1=_context63["catch"](1);_iterator788.e(_context63.t1);case 17:_context63.prev=17;_iterator788.f();return _context63.finish(17);case 20:case"end":return _context63.stop();}},_getFormattingAttributes,null,[[1,14,17,20]]);})}]);}(Hr);var OO=/*#__PURE__*/function(_Dr215){function OO(){_classCallCheck(this,OO);return _callSuper(this,OO,arguments);}_inherits(OO,_Dr215);return _createClass(OO,[{key:"init",value:function init(){var e=this.editor;e.commands.add("removeFormat",new RO(e));}}],[{key:"pluginName",get:function get(){return"RemoveFormatEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var BO=/*#__PURE__*/function(_Dr216){function BO(){_classCallCheck(this,BO);return _callSuper(this,BO,arguments);}_inherits(BO,_Dr216);return _createClass(BO,null,[{key:"requires",get:function get(){return[OO,VO];}},{key:"pluginName",get:function get(){return"RemoveFormat";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var MO=/*#__PURE__*/function(_Hr58){function MO(e,t){var _this745;_classCallCheck(this,MO);_this745=_callSuper(this,MO,[e]),_defineProperty(_assertThisInitialized(_this745),"_direction",void 0),_this745.affectsData=!1,_this745._direction=t;return _this745;}_inherits(MO,_Hr58);return _createClass(MO,[{key:"refresh",value:function refresh(){this.isEnabled=this._checkEnabled();}},{key:"execute",value:function execute(){var e=LO(this.editor.model,this._direction);e&&this.editor.model.change(function(t){t.setSelection(e);});}},{key:"_checkEnabled",value:function _checkEnabled(){return!!LO(this.editor.model,this._direction);}}]);}(Hr);function LO(e,t){var i=e.document.selection.getFirstPosition(),n=[];var _iterator789=_createForOfIteratorHelper(e.markers.getMarkersGroup("restrictedEditingException")),_step789;try{for(_iterator789.s();!(_step789=_iterator789.n()).done;){var _s209=_step789.value;var _e764=_s209.getRange(),_o124=i.isTouching(_e764.start)&&i.hasSameParentAs(_e764.start)||i.isTouching(_e764.end)&&i.hasSameParentAs(_e764.end);_e764.containsPosition(i)||_o124||("forward"===t&&_e764.start.isAfter(i)||"backward"===t&&_e764.end.isBefore(i))&&n.push(_e764);}}catch(err){_iterator789.e(err);}finally{_iterator789.f();}if(n.length)return n.sort(function(e,i){return"forward"===t?e.start.isAfter(i.start)?1:-1:e.start.isBefore(i.start)?1:-1;}).shift();}function FO(e,t){var _iterator790=_createForOfIteratorHelper(e.model.markers),_step790;try{for(_iterator790.s();!(_step790=_iterator790.n()).done;){var _i579=_step790.value;if(NO(_i579.getRange(),t)&&_i579.name.startsWith("restrictedEditingException:"))return _i579;}}catch(err){_iterator790.e(err);}finally{_iterator790.f();}}function NO(e,t){return e.containsPosition(t)||e.end.isEqual(t)||e.start.isEqual(t);}var DO="restricted-editing-exception_selected";function zO(e,t,i,n){var s=FO(e,t.getShiftedBy(i));return!(!s||!s.getStart().isEqual(t.getShiftedBy(i)))&&(n.updateMarker(s,{range:n.createRange(s.getStart().getShiftedBy(-i),s.getEnd())}),!0);}function HO(e,t,i,n){var s=FO(e,t);return!(!s||!s.getEnd().isEqual(t))&&(n.updateMarker(s,{range:n.createRange(s.getStart(),s.getEnd().getShiftedBy(i))}),!0);}var $O="RestrictedEditingMode";var UO=/*#__PURE__*/function(_Dr217){function UO(e){var _this746;_classCallCheck(this,UO);_this746=_callSuper(this,UO,[e]),_defineProperty(_assertThisInitialized(_this746),"_alwaysEnabled",void 0),_defineProperty(_assertThisInitialized(_this746),"_allowedInException",void 0),e.config.define("restrictedEditing",{allowedCommands:["bold","italic","link","unlink"],allowedAttributes:["bold","italic","linkHref"]}),_this746._alwaysEnabled=new Set(["undo","redo"]),_this746._allowedInException=new Set(["input","insertText","delete","deleteForward"]);return _this746;}_inherits(UO,_Dr217);return _createClass(UO,[{key:"init",value:function init(){var _this747=this;var e=this.editor,t=e.editing.view;e.config.get("restrictedEditing.allowedCommands").forEach(function(e){return _this747._allowedInException.add(e);}),this._setupConversion(),this._setupCommandsToggling(),this._setupRestrictions(),e.commands.add("goToPreviousRestrictedEditingException",new MO(e,"backward")),e.commands.add("goToNextRestrictedEditingException",new MO(e,"forward")),this.listenTo(t.document,"tab",function(t,i){var n=i.shiftKey?"goToPreviousRestrictedEditingException":"goToNextRestrictedEditingException";e.commands.get(n).isEnabled&&(e.execute(n),i.preventDefault(),i.stopPropagation()),t.stop();},{context:"$capture"}),e.keystrokes.set("Ctrl+A",function(e){return function(t,i){var n=e.model,s=e.model.document.selection,o=FO(e,s.focus);if(!o)return;var r=s.getFirstRange();(o.getRange().containsRange(r,!0)||s.isCollapsed)&&(i(),n.change(function(e){e.setSelection(o.getRange());}));};}(e)),t.change(function(e){var _iterator791=_createForOfIteratorHelper(t.document.roots),_step791;try{for(_iterator791.s();!(_step791=_iterator791.n()).done;){var _i580=_step791.value;e.addClass("ck-restricted-editing_mode_restricted",_i580);}}catch(err){_iterator791.e(err);}finally{_iterator791.f();}});}},{key:"enableCommand",value:function enableCommand(e){this.editor.commands.get(e).clearForceDisabled($O),this._alwaysEnabled.add(e);}},{key:"_setupConversion",value:function _setupConversion(){var e=this.editor,t=e.model.document;var i=0;var n;e.conversion["for"]("upcast").add((n={view:{name:"span",classes:"restricted-editing-exception"},model:function model(){return i++,"restrictedEditingException:".concat(i);}},function(e){return e.on("element:span",function(e,t,i){var s=i.writer,o=new aa(n.view).match(t.viewItem);if(!o)return;var r=o.match;r.name=!0;var _i$convertChildren4=i.convertChildren(t.viewItem,t.modelCursor),a=_i$convertChildren4.modelRange;i.consumable.consume(t.viewItem,r);var l=n.model(),c=s.createElement("$marker",{"data-name":l}),d=s.createElement("$marker",{"data-name":l});s.insert(d,a.end),s.insert(c,a.start),t.modelRange=s.createRange(s.createPositionBefore(c),s.createPositionAfter(d)),t.modelCursor=t.modelRange.end;});})),e.conversion["for"]("downcast").add(function(e){e.on("addMarker:restrictedEditingException",function(e,t,i){if(!t.item)return;if(t.item.is("selection")||!i.schema.isInline(t.item))return;if(!i.consumable.consume(t.item,e.name))return;var n=i.writer,s=n.createAttributeElement("span",{"class":"restricted-editing-exception"},{id:t.markerName,priority:-10}),o=i.mapper.toViewRange(t.range),r=n.wrap(o,s);var _iterator792=_createForOfIteratorHelper(r.getItems()),_step792;try{for(_iterator792.s();!(_step792=_iterator792.n()).done;){var _e765=_step792.value;if(_e765.is("attributeElement")&&_e765.isSimilar(s)){i.mapper.bindElementToMarker(_e765,t.markerName);break;}}}catch(err){_iterator792.e(err);}finally{_iterator792.f();}});}),e.conversion["for"]("downcast").markerToHighlight({model:"restrictedEditingException",view:function view(){return{name:"span",classes:"restricted-editing-exception",priority:-10};}}),e.conversion["for"]("editingDowncast").markerToElement({model:"restrictedEditingException",view:function view(e,_ref284){var t=_ref284.writer;return t.createUIElement("span",{"class":"restricted-editing-exception restricted-editing-exception_collapsed"});}}),e.conversion["for"]("dataDowncast").markerToElement({model:"restrictedEditingException",view:function view(e,_ref285){var t=_ref285.writer;return t.createEmptyElement("span",{"class":"restricted-editing-exception"});}}),t.registerPostFixer(function(e){return function(t){var i=!1;var n=e.model.schema;var _iterator793=_createForOfIteratorHelper(e.model.document.differ.getChanges()),_step793;try{for(_iterator793.s();!(_step793=_iterator793.n()).done;){var _s210=_step793.value;"insert"==_s210.type&&n.checkChild("$block",_s210.name)&&(i=zO(e,_s210.position,_s210.length,t)||i,i=HO(e,_s210.position,_s210.length,t)||i);}}catch(err){_iterator793.e(err);}finally{_iterator793.f();}return i;};}(e)),t.registerPostFixer(function(e){return function(t){var i=!1;var _iterator794=_createForOfIteratorHelper(e.model.document.differ.getChangedMarkers()),_step794;try{for(_iterator794.s();!(_step794=_iterator794.n()).done;){var _step794$value=_step794.value,_n301=_step794$value.name,_s211=_step794$value.data;_n301.startsWith("restrictedEditingException")&&_s211.newRange&&"$graveyard"==_s211.newRange.root.rootName&&(t.updateMarker(_n301,{range:t.createRange(t.createPositionAt(_s211.oldRange.start))}),i=!0);}}catch(err){_iterator794.e(err);}finally{_iterator794.f();}return i;};}(e)),t.registerPostFixer(function(e){return function(t){var i=!1;var n=e.model.document.differ.getChangedMarkers();var _iterator795=_createForOfIteratorHelper(n),_step795;try{for(_iterator795.s();!(_step795=_iterator795.n()).done;){var _step795$value=_step795.value,_e766=_step795$value.data,_s212=_step795$value.name;if(!_s212.startsWith("restrictedEditingException"))continue;var _n302=_e766.newRange;if(!_e766.oldRange&&!_n302.isFlat){var _e767=_n302.start,_o125=_n302.end,r=_e767.path.length>_o125.path.length,_a40=r?_n302.start:t.createPositionAt(_o125.parent,0),_l27=r?t.createPositionAt(_e767.parent,"end"):_n302.end;t.updateMarker(_s212,{range:t.createRange(_a40,_l27)}),i=!0;}}}catch(err){_iterator795.e(err);}finally{_iterator795.f();}return i;};}(e)),function(e){var t=e.editing.view,i=e.model,n=new Set();t.document.registerPostFixer(function(t){var s=i.document.selection,o=FO(e,s.anchor);if(!o)return!1;var _iterator796=_createForOfIteratorHelper(e.editing.mapper.markerNameToElements(o.name)),_step796;try{for(_iterator796.s();!(_step796=_iterator796.n()).done;){var _i581=_step796.value;t.addClass(DO,_i581),n.add(_i581);}}catch(err){_iterator796.e(err);}finally{_iterator796.f();}return!1;}),e.conversion["for"]("editingDowncast").add(function(e){function i(){t.change(function(e){var _iterator797=_createForOfIteratorHelper(n.values()),_step797;try{for(_iterator797.s();!(_step797=_iterator797.n()).done;){var _t527=_step797.value;e.removeClass(DO,_t527),n["delete"](_t527);}}catch(err){_iterator797.e(err);}finally{_iterator797.f();}});}e.on("insert",i,{priority:"highest"}),e.on("remove",i,{priority:"highest"}),e.on("attribute",i,{priority:"highest"}),e.on("cleanSelection",i);});}(e);}},{key:"_setupRestrictions",value:function _setupRestrictions(){var e=this.editor,t=e.model,i=t.document.selection,n=e.editing.view.document,s=e.plugins.get("ClipboardPipeline");this.listenTo(t,"deleteContent",function(e){return function(t,i){var _i582=_slicedToArray(i,1),n=_i582[0],s=FO(e,n.focus)||FO(e,n.anchor);if(!s)return void t.stop();if(n.isCollapsed)return;var o=s.getRange().getIntersection(n.getFirstRange());n.is("documentSelection")?e.model.change(function(e){e.setSelection(o);}):n.setTo(o);};}(e),{priority:"high"});var o=e.commands.get("insertText");o&&this.listenTo(o,"execute",function(e){return function(t,i){var _i583=_slicedToArray(i,1),n=_i583[0],s=n.range;s&&(jO(e,s)||t.stop());};}(e),{priority:"high"}),this.listenTo(s,"contentInsertion",function(t){jO(e,i.getFirstRange())||t.stop();}),this.listenTo(n,"clipboardOutput",function(t,n){"cut"!=n.method||jO(e,i.getFirstRange())||t.stop();},{priority:"high"});var r=e.config.get("restrictedEditing.allowedAttributes");t.schema.addAttributeCheck(function(e){return function(t,i){if(t.startsWith("$clipboardHolder"))return e.includes(i);};}(r)),t.schema.addChildCheck(function(e,t){if(e.startsWith("$clipboardHolder"))return"$text"===t.name;});}},{key:"_setupCommandsToggling",value:function _setupCommandsToggling(){var e=this.editor.model.document;this._disableCommands(),this.listenTo(e.selection,"change",this._checkCommands.bind(this)),this.listenTo(e,"change:data",this._checkCommands.bind(this));}},{key:"_checkCommands",value:function _checkCommands(){var e=this.editor,t=e.model.document.selection;if(t.rangeCount>1)return void this._disableCommands();var i=FO(e,t.focus);this._disableCommands(),function(e,t){if(!t)return!1;var i=t.getRange();return e.isCollapsed?NO(i,e.focus):i.containsRange(e.getFirstRange(),!0);}(t,i)&&this._enableCommands(i);}},{key:"_enableCommands",value:function _enableCommands(e){var t=this.editor;var _iterator798=_createForOfIteratorHelper(t.commands),_step798;try{for(_iterator798.s();!(_step798=_iterator798.n()).done;){var _step798$value=_slicedToArray(_step798.value,2),_i584=_step798$value[0],_n303=_step798$value[1];_n303.affectsData&&!this._alwaysEnabled.has(_i584)&&this._allowedInException.has(_i584)&&(WO(_i584,t.model.document.selection,e.getRange())||_n303.clearForceDisabled($O));}}catch(err){_iterator798.e(err);}finally{_iterator798.f();}}},{key:"_disableCommands",value:function _disableCommands(){var e=this.editor;var _iterator799=_createForOfIteratorHelper(e.commands),_step799;try{for(_iterator799.s();!(_step799=_iterator799.n()).done;){var _step799$value=_slicedToArray(_step799.value,2),_t528=_step799$value[0],_i585=_step799$value[1];_i585.affectsData&&!this._alwaysEnabled.has(_t528)&&_i585.forceDisabled($O);}}catch(err){_iterator799.e(err);}finally{_iterator799.f();}}}],[{key:"pluginName",get:function get(){return"RestrictedEditingModeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function WO(e,t,i){return!("delete"!=e||!i.start.isEqual(t.focus))||!("deleteForward"!=e||!t.isCollapsed||!i.end.isEqual(t.focus));}function jO(e,t){var i=FO(e,t.start),n=FO(e,t.end);return i&&n&&n===i;}var qO='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.5 6.5a3.5 3.5 0 0 1 3.495 3.308L19 10v2a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-5a1 1 0 0 1 1-1v-2l.005-.192A3.5 3.5 0 0 1 15.5 6.5zm0 7.5a.5.5 0 0 0-.492.41L15 14.5v2a.5.5 0 0 0 .992.09L16 16.5v-2a.5.5 0 0 0-.5-.5zm0-6a2 2 0 0 0-2 2v2h4v-2a2 2 0 0 0-2-2zm-9.25 8a.75.75 0 1 1 0 1.5H.75a.75.75 0 1 1 0-1.5h5.5zm0-5a.75.75 0 1 1 0 1.5H.75a.75.75 0 1 1 0-1.5h5.5zm3-5a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1 0-1.5h8.5zm6-5a.75.75 0 1 1 0 1.5H.75a.75.75 0 0 1 0-1.5h14.5z"/></svg>';var GO=/*#__PURE__*/function(_Dr218){function GO(){_classCallCheck(this,GO);return _callSuper(this,GO,arguments);}_inherits(GO,_Dr218);return _createClass(GO,[{key:"init",value:function init(){var _this748=this;var e=this.editor,t=e.t;e.ui.componentFactory.add("restrictedEditing",function(i){var n=Xf(i),s=new br();return _this748._getButtonDefinitions().forEach(function(_ref286){var e=_ref286.commandName,t=_ref286.label,i=_ref286.keystroke;s.add(_this748._getButtonDefinition(e,t,i));}),sp(n,s,{role:"menu"}),n.buttonView.set({label:t("Navigate editable regions"),icon:qO,tooltip:!0,isEnabled:!0,isOn:!1}),_this748.listenTo(n,"execute",function(t){var i=t.source._commandName;e.execute(i),e.editing.view.focus();}),n;}),e.ui.componentFactory.add("menuBar:restrictedEditing",function(e){var i=new aw(e),n=new lw(e);return n.set({ariaLabel:t("Navigate editable regions"),role:"menu"}),i.buttonView.set({label:t("Navigate editable regions"),icon:qO}),i.panelView.children.add(n),_this748._getButtonDefinitions().forEach(function(_ref287){var t=_ref287.commandName,s=_ref287.label,o=_ref287.keystroke;var r=new ub(e,i),a=_this748._createMenuBarButton(s,t,o);a.delegate("execute").to(i),r.children.add(a),n.items.add(r);}),i;});}},{key:"_createMenuBarButton",value:function _createMenuBarButton(e,t,i){var n=this.editor,s=n.commands.get(t),o=new Rg(n.locale);return o.set({label:e,keystroke:i,isEnabled:!0,isOn:!1}),o.bind("isEnabled").to(s),this.listenTo(o,"execute",function(){n.execute(t),n.editing.view.focus();}),o;}},{key:"_getButtonDefinition",value:function _getButtonDefinition(e,t,i){var n=this.editor.commands.get(e),s={type:"button",model:new Fb({label:t,withText:!0,keystroke:i,withKeystroke:!0,role:"menuitem",_commandName:e})};return s.model.bind("isEnabled").to(n,"isEnabled"),s;}},{key:"_getButtonDefinitions",value:function _getButtonDefinitions(){var e=this.editor.locale.t;return[{commandName:"goToPreviousRestrictedEditingException",label:e("Previous editable region"),keystroke:"Shift+Tab"},{commandName:"goToNextRestrictedEditingException",label:e("Next editable region"),keystroke:"Tab"}];}}],[{key:"pluginName",get:function get(){return"RestrictedEditingModeUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var KO=/*#__PURE__*/function(_Dr219){function KO(){_classCallCheck(this,KO);return _callSuper(this,KO,arguments);}_inherits(KO,_Dr219);return _createClass(KO,null,[{key:"pluginName",get:function get(){return"RestrictedEditingMode";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[UO,GO];}}]);}(Dr);var ZO=/*#__PURE__*/function(_Hr59){function ZO(){_classCallCheck(this,ZO);return _callSuper(this,ZO,arguments);}_inherits(ZO,_Hr59);return _createClass(ZO,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document;this.value=!!t.selection.getAttribute("restrictedEditingException"),this.isEnabled=e.schema.checkAttributeInSelection(t.selection,"restrictedEditingException");}},{key:"execute",value:function execute(){var _this749=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document.selection,n=void 0===e.forceValue?!this.value:e.forceValue;t.change(function(e){var s=t.schema.getValidRanges(i.getRanges(),"restrictedEditingException");if(i.isCollapsed){if(n)e.setSelectionAttribute("restrictedEditingException",n);else{var _t529=function _t529(e){return e.item.getAttribute("restrictedEditingException")===_this749.value;},_n304=i.focus,_s213=_n304.getLastMatchingPosition(_t529,{direction:"backward"}),_o126=_n304.getLastMatchingPosition(_t529);e.removeSelectionAttribute("restrictedEditingException"),_n304.isEqual(_s213)||_n304.isEqual(_o126)||e.removeAttribute("restrictedEditingException",e.createRange(_s213,_o126));}}else{var _iterator800=_createForOfIteratorHelper(s),_step800;try{for(_iterator800.s();!(_step800=_iterator800.n()).done;){var _t530=_step800.value;n?e.setAttribute("restrictedEditingException",n,_t530):e.removeAttribute("restrictedEditingException",_t530);}}catch(err){_iterator800.e(err);}finally{_iterator800.f();}}});}}]);}(Hr);var JO=/*#__PURE__*/function(_Dr220){function JO(){_classCallCheck(this,JO);return _callSuper(this,JO,arguments);}_inherits(JO,_Dr220);return _createClass(JO,[{key:"init",value:function init(){var e=this.editor;e.model.schema.extend("$text",{allowAttributes:["restrictedEditingException"]}),e.conversion["for"]("upcast").elementToAttribute({model:"restrictedEditingException",view:{name:"span",classes:"restricted-editing-exception"}}),e.conversion["for"]("downcast").attributeToElement({model:"restrictedEditingException",view:function view(e,_ref288){var t=_ref288.writer;if(e)return t.createAttributeElement("span",{"class":"restricted-editing-exception"},{priority:-10});}}),e.commands.add("restrictedEditingException",new ZO(e)),e.editing.view.change(function(t){var _iterator801=_createForOfIteratorHelper(e.editing.view.document.roots),_step801;try{for(_iterator801.s();!(_step801=_iterator801.n()).done;){var _i586=_step801.value;t.addClass("ck-restricted-editing_mode_standard",_i586);}}catch(err){_iterator801.e(err);}finally{_iterator801.f();}});}}],[{key:"pluginName",get:function get(){return"StandardEditingModeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var QO=/*#__PURE__*/function(_Dr221){function QO(){_classCallCheck(this,QO);return _callSuper(this,QO,arguments);}_inherits(QO,_Dr221);return _createClass(QO,[{key:"init",value:function init(){var _this750=this;var e=this.editor;e.ui.componentFactory.add("restrictedEditingException",function(){var e=_this750._createButton(pg);return e.set({tooltip:!0,isToggleable:!0}),e;}),e.ui.componentFactory.add("menuBar:restrictedEditingException",function(){return _this750._createButton(Rg);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=this.editor.commands.get("restrictedEditingException"),s=new e(i),o=i.t;return s.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.25 16a.75.75 0 1 1 0 1.5H.75a.75.75 0 1 1 0-1.5h5.5zm0-5a.75.75 0 1 1 0 1.5H.75a.75.75 0 1 1 0-1.5h5.5zm3-5a.75.75 0 0 1 0 1.5H.75a.75.75 0 0 1 0-1.5h8.5zm6-5a.75.75 0 1 1 0 1.5H.75a.75.75 0 0 1 0-1.5h14.5zm.25 5.5a3.5 3.5 0 0 1 3.143 1.959.75.75 0 0 1-1.36.636A2 2 0 0 0 13.5 10v2H19a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1h-7a1 1 0 0 1-1-1v-5a1 1 0 0 1 1-1v-2l.005-.192A3.5 3.5 0 0 1 15.5 6.5zm0 7.5a.5.5 0 0 0-.492.41L15 14.5v2a.5.5 0 0 0 .992.09L16 16.5v-2a.5.5 0 0 0-.5-.5z"/></svg>',s.bind("isOn","isEnabled").to(n,"value","isEnabled"),s.bind("label").to(n,"value",function(e){return o(e?"Disable editing":"Enable editing");}),this.listenTo(s,"execute",function(){t.execute("restrictedEditingException"),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"StandardEditingModeUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var YO=/*#__PURE__*/function(_Dr222){function YO(){_classCallCheck(this,YO);return _callSuper(this,YO,arguments);}_inherits(YO,_Dr222);return _createClass(YO,null,[{key:"pluginName",get:function get(){return"StandardEditingMode";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[JO,QO];}}]);}(Dr);var XO=/*#__PURE__*/function(_Hr60){function XO(e){var _this751;_classCallCheck(this,XO);_this751=_callSuper(this,XO,[e]),_this751.affectsData=!1,_this751.value=!1;return _this751;}_inherits(XO,_Hr60);return _createClass(XO,[{key:"execute",value:function execute(){var _this752=this;var e="ck-show-blocks",t=this.editor.editing.view;t.change(function(i){var _iterator802=_createForOfIteratorHelper(t.document.roots),_step802;try{for(_iterator802.s();!(_step802=_iterator802.n()).done;){var _n305=_step802.value;_n305.hasClass(e)?(i.removeClass(e,_n305),_this752.value=!1):(i.addClass(e,_n305),_this752.value=!0);}}catch(err){_iterator802.e(err);}finally{_iterator802.f();}});}}]);}(Hr);var eB=/*#__PURE__*/function(_Dr223){function eB(){_classCallCheck(this,eB);return _callSuper(this,eB,arguments);}_inherits(eB,_Dr223);return _createClass(eB,[{key:"init",value:function init(){var e=this.editor;e.commands.add("showBlocks",new XO(e));}}],[{key:"pluginName",get:function get(){return"ShowBlocksEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var tB=/*#__PURE__*/function(_Dr224){function tB(){_classCallCheck(this,tB);return _callSuper(this,tB,arguments);}_inherits(tB,_Dr224);return _createClass(tB,[{key:"init",value:function init(){var _this753=this;var e=this.editor;e.ui.componentFactory.add("showBlocks",function(){var e=_this753._createButton(pg);return e.set({tooltip:!0,icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m6.395 9.196 2.545-.007V6.498a.598.598 0 0 1 .598-.598h.299a.598.598 0 0 1 .598.598v6.877a.598.598 0 0 1-.598.598h-.299a.598.598 0 0 1-.598-.598v-2.691l-2.545.007v2.691a.598.598 0 0 1-.598.598h-.299a.598.598 0 0 1-.598-.598V6.505a.598.598 0 0 1 .598-.598h.299a.598.598 0 0 1 .598.598v2.691Z"/><path d="M15.094 13.417V6.462a.562.562 0 0 0-.562-.562h-.782a1 1 0 0 0-.39.08l-1.017.43a.562.562 0 0 0-.343.517v.197c0 .4.406.67.775.519l.819-.337v6.111c0 .31.251.562.561.562h.377c.31 0 .562-.251.562-.562Z"/><path d="M0 15.417v1.5h1.5v-1.5H0Z"/><path d="M18.5 15.417v1.5H20v-1.5h-1.5Z"/><path d="M18.5 12.333v1.5H20v-1.5h-1.5Z"/><path d="M18.5 9.25v1.5H20v-1.5h-1.5Z"/><path d="M18.5 6.167v1.5H20v-1.5h-1.5Z"/><path d="M0 18.5v.5a1 1 0 0 0 1 1h.5v-1.5H0Z"/><path d="M3.083 18.5V20h1.5v-1.5h-1.5Z"/><path d="M6.167 18.5V20h1.5v-1.5h-1.5Z"/><path d="M9.25 18.5V20h1.5v-1.5h-1.5Z"/><path d="M12.333 18.5V20h1.5v-1.5h-1.5Z"/><path d="M15.417 18.5V20h1.5v-1.5h-1.5Z"/><path d="M18.5 18.5V20h.5a1 1 0 0 0 1-1v-.5h-1.5Z"/><path clip-rule="evenodd" d="M0 1a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v3.583h-1.5V1.5h-17v12.333H0V1Z"/></svg>'}),e;}),e.ui.componentFactory.add("menuBar:showBlocks",function(){return _this753._createButton(Rg);});}},{key:"_createButton",value:function _createButton(e){var t=this.editor,i=t.locale,n=t.commands.get("showBlocks"),s=new e(i),o=i.t;return s.set({label:o("Show blocks"),isToggleable:!0,role:"menuitemcheckbox"}),s.bind("isEnabled").to(n),s.bind("isOn").to(n,"value",n,"isEnabled",function(e,t){return e&&t;}),this.listenTo(s,"execute",function(){t.execute("showBlocks"),t.editing.view.focus();}),s;}}],[{key:"pluginName",get:function get(){return"ShowBlocksUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var iB=/*#__PURE__*/function(_Dr225){function iB(){_classCallCheck(this,iB);return _callSuper(this,iB,arguments);}_inherits(iB,_Dr225);return _createClass(iB,null,[{key:"pluginName",get:function get(){return"ShowBlocks";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[eB,tB];}}]);}(Dr);function nB(e){var t=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],i=t.map(function(e){return e.name;}).join("|"),n=e.replace(new RegExp("</?(".concat(i,")( .*?)?>"),"g"),"\n$&\n").replace(/<br[^>]*>/g,"$&\n").split("\n");var s=0,o=!1;return n.filter(function(e){return e.length;}).map(function(e){return o=function(e,t){return new RegExp("<pre( .*?)?>").test(e)?"first":new RegExp("</pre>").test(e)?"last":("first"===t||"middle"===t)&&"middle";}(e,o),function(e,t){return t.some(function(t){return!t.isVoid&&!!new RegExp("<".concat(t.name,"( .*?)?>")).test(e);});}(e,t)?sB(e,s++):function(e,t){return t.some(function(t){return new RegExp("</".concat(t.name,">")).test(e);});}(e,t)?sB(e,--s):"middle"===o||"last"===o?e:sB(e,s);}).join("\n");}function sB(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"    ";return"".concat(i.repeat(Math.max(0,t))).concat(e);}var oB="SourceEditingMode";var rB=/*#__PURE__*/function(_Dr226){function rB(e){var _this754;_classCallCheck(this,rB);_this754=_callSuper(this,rB,[e]),_defineProperty(_assertThisInitialized(_this754),"_elementReplacer",void 0),_defineProperty(_assertThisInitialized(_this754),"_replacedRoots",void 0),_defineProperty(_assertThisInitialized(_this754),"_dataFromRoots",void 0),_this754.set("isSourceEditingMode",!1),_this754._elementReplacer=new to(),_this754._replacedRoots=new Map(),_this754._dataFromRoots=new Map(),e.config.define("sourceEditing.allowCollaborationFeatures",!1);return _this754;}_inherits(rB,_Dr226);return _createClass(rB,[{key:"init",value:function init(){var _this755=this;this._checkCompatibility();var e=this.editor,t=e.locale.t;e.ui.componentFactory.add("sourceEditing",function(){var e=_this755._createButton(pg);return e.set({label:t("Source"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>',tooltip:!0,"class":"ck-source-editing-button"}),e;}),e.ui.componentFactory.add("menuBar:sourceEditing",function(){var e=_this755._createButton(Rg);return e.set({label:t("Show source"),role:"menuitemcheckbox"}),e;}),this._isAllowedToHandleSourceEditingMode()&&(this.on("change:isSourceEditingMode",function(e,t,i){i?(_this755._hideVisibleDialog(),_this755._showSourceEditing(),_this755._disableCommands()):(_this755._hideSourceEditing(),_this755._enableCommands());}),this.on("change:isEnabled",function(e,t,i){return _this755._handleReadOnlyMode(!i);}),this.listenTo(e,"change:isReadOnly",function(e,t,i){return _this755._handleReadOnlyMode(i);})),e.data.on("get",function(){_this755.isSourceEditingMode&&_this755.updateEditorData();},{priority:"high"});}},{key:"updateEditorData",value:function updateEditorData(){var e=this.editor,t={};var _iterator803=_createForOfIteratorHelper(this._replacedRoots),_step803;try{for(_iterator803.s();!(_step803=_iterator803.n()).done;){var _step803$value=_slicedToArray(_step803.value,2),_e768=_step803$value[0],_i587=_step803$value[1];var _n306=this._dataFromRoots.get(_e768),_s214=_i587.dataset.value;_n306!==_s214&&(t[_e768]=_s214,this._dataFromRoots.set(_e768,_s214));}}catch(err){_iterator803.e(err);}finally{_iterator803.f();}Object.keys(t).length&&e.data.set(t,{batchType:{isUndoable:!0},suppressErrorInCollaboration:!0});}},{key:"_checkCompatibility",value:function _checkCompatibility(){var e=this.editor,t=e.config.get("sourceEditing.allowCollaborationFeatures");if(!t&&e.plugins.has("RealTimeCollaborativeEditing"))throw new A("source-editing-incompatible-with-real-time-collaboration",null);!t&&["CommentsEditing","TrackChangesEditing","RevisionHistory"].some(function(t){return e.plugins.has(t);})&&console.warn("You initialized the editor with the source editing feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing feature and restricted editing feature. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.");}},{key:"_showSourceEditing",value:function _showSourceEditing(){var _this756=this;var e=this.editor,t=e.editing.view,i=e.model;i.change(function(e){e.setSelection(null),e.removeSelectionAttribute(i.document.selection.getAttributeKeys());});var _iterator804=_createForOfIteratorHelper(t.domRoots),_step804;try{var _loop40=function _loop40(){var _step804$value=_slicedToArray(_step804.value,2),i=_step804$value[0],n=_step804$value[1];var s=aB(e.data.get({rootName:i})),o=ro(n.ownerDocument,"textarea",{rows:"1","aria-label":"Source code editing area"}),r=ro(n.ownerDocument,"div",{"class":"ck-source-editing-area","data-value":s},[o]);o.value=s,o.setSelectionRange(0,0),o.addEventListener("input",function(){r.dataset.value=o.value,e.ui.update();}),t.change(function(e){var n=t.document.getRoot(i);e.addClass("ck-hidden",n);}),e.ui.setEditableElement("sourceEditing:"+i,o),_this756._replacedRoots.set(i,r),_this756._elementReplacer.replace(n,r),_this756._dataFromRoots.set(i,s);};for(_iterator804.s();!(_step804=_iterator804.n()).done;){_loop40();}}catch(err){_iterator804.e(err);}finally{_iterator804.f();}this._focusSourceEditing();}},{key:"_hideSourceEditing",value:function _hideSourceEditing(){var _this757=this;var e=this.editor.editing.view;this.updateEditorData(),e.change(function(t){var _iterator805=_createForOfIteratorHelper(_this757._replacedRoots),_step805;try{for(_iterator805.s();!(_step805=_iterator805.n()).done;){var _step805$value=_slicedToArray(_step805.value,1),_i588=_step805$value[0];t.removeClass("ck-hidden",e.document.getRoot(_i588));}}catch(err){_iterator805.e(err);}finally{_iterator805.f();}}),this._elementReplacer.restore(),this._replacedRoots.clear(),this._dataFromRoots.clear(),e.focus();}},{key:"_focusSourceEditing",value:function _focusSourceEditing(){var e=this.editor,_this$_replacedRoots$=this._replacedRoots.values(),_this$_replacedRoots$2=_slicedToArray(_this$_replacedRoots$,1),t=_this$_replacedRoots$2[0],i=t.querySelector("textarea");e.editing.view.document.isFocused=!1,i.focus();}},{key:"_disableCommands",value:function _disableCommands(){var e=this.editor;var _iterator806=_createForOfIteratorHelper(e.commands.commands()),_step806;try{for(_iterator806.s();!(_step806=_iterator806.n()).done;){var _t531=_step806.value;_t531.forceDisabled(oB);}}catch(err){_iterator806.e(err);}finally{_iterator806.f();}e.plugins.has("CommentsArchiveUI")&&e.plugins.get("CommentsArchiveUI").forceDisabled(oB);}},{key:"_enableCommands",value:function _enableCommands(){var e=this.editor;var _iterator807=_createForOfIteratorHelper(e.commands.commands()),_step807;try{for(_iterator807.s();!(_step807=_iterator807.n()).done;){var _t532=_step807.value;_t532.clearForceDisabled(oB);}}catch(err){_iterator807.e(err);}finally{_iterator807.f();}e.plugins.has("CommentsArchiveUI")&&e.plugins.get("CommentsArchiveUI").clearForceDisabled(oB);}},{key:"_handleReadOnlyMode",value:function _handleReadOnlyMode(e){if(this.isSourceEditingMode){var _iterator808=_createForOfIteratorHelper(this._replacedRoots),_step808;try{for(_iterator808.s();!(_step808=_iterator808.n()).done;){var _step808$value=_slicedToArray(_step808.value,2),_t533=_step808$value[1];_t533.querySelector("textarea").readOnly=e;}}catch(err){_iterator808.e(err);}finally{_iterator808.f();}}}},{key:"_isAllowedToHandleSourceEditingMode",value:function _isAllowedToHandleSourceEditingMode(){var e=this.editor.ui.view.editable;return e&&!e.hasExternalElement;}},{key:"_hideVisibleDialog",value:function _hideVisibleDialog(){if(this.editor.plugins.has("Dialog")){var _e769=this.editor.plugins.get("Dialog");_e769.isOpen&&_e769.hide();}}},{key:"_createButton",value:function _createButton(e){var _this758=this;var t=this.editor,i=new e(t.locale);return i.set({withText:!0,isToggleable:!0}),i.bind("isOn").to(this,"isSourceEditingMode"),i.bind("isEnabled").to(this,"isEnabled",t,"isReadOnly",t.plugins.get(_m),"hasAny",function(e,t,i){return!!e&&!t&&!i;}),this.listenTo(i,"execute",function(){_this758.isSourceEditingMode=!_this758.isSourceEditingMode;}),i;}}],[{key:"pluginName",get:function get(){return"SourceEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[_m];}}]);}(Dr);function aB(e){return function(e){return e.startsWith("<");}(e)?nB(e):e;}var lB=/*#__PURE__*/function(_lg67){function lB(e){var _this759;_classCallCheck(this,lB);_this759=_callSuper(this,lB,[e]),_defineProperty(_assertThisInitialized(_this759),"tiles",void 0),_defineProperty(_assertThisInitialized(_this759),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this759),"keystrokes",void 0),_this759.tiles=_this759.createCollection(),_this759.setTemplate({tag:"div",children:[{tag:"div",attributes:{"class":["ck","ck-character-grid__tiles"]},children:_this759.tiles}],attributes:{"class":["ck","ck-character-grid"]}}),_this759.focusTracker=new _r(),_this759.keystrokes=new Cr(),mg({keystrokeHandler:_this759.keystrokes,focusTracker:_this759.focusTracker,gridItems:_this759.tiles,numberOfColumns:function numberOfColumns(){return i.window.getComputedStyle(_this759.element.firstChild).getPropertyValue("grid-template-columns").split(" ").length;},uiLanguageDirection:_this759.locale&&_this759.locale.uiLanguageDirection});return _this759;}_inherits(lB,_lg67);return _createClass(lB,[{key:"createTile",value:function createTile(e,t){var _this760=this;var i=new pg(this.locale);return i.set({label:e,withText:!0,"class":"ck-character-grid__tile"}),i.extendTemplate({attributes:{title:t},on:{mouseover:i.bindTemplate.to("mouseover"),focus:i.bindTemplate.to("focus")}}),i.on("mouseover",function(){_this760.fire("tileHover",{name:t,character:e});}),i.on("focus",function(){_this760.fire("tileFocus",{name:t,character:e});}),i.on("execute",function(){_this760.fire("execute",{name:t,character:e});}),i;}},{key:"render",value:function render(){var _this761=this;_superPropGet(lB,"render",this,3)([]);var _iterator809=_createForOfIteratorHelper(this.tiles),_step809;try{for(_iterator809.s();!(_step809=_iterator809.n()).done;){var _e772=_step809.value;this.focusTracker.add(_e772.element);}}catch(err){_iterator809.e(err);}finally{_iterator809.f();}this.tiles.on("change",function(e,_ref289){var t=_ref289.added,i=_ref289.removed;if(t.length>0){var _iterator810=_createForOfIteratorHelper(t),_step810;try{for(_iterator810.s();!(_step810=_iterator810.n()).done;){var _e770=_step810.value;_this761.focusTracker.add(_e770.element);}}catch(err){_iterator810.e(err);}finally{_iterator810.f();}}if(i.length>0){var _iterator811=_createForOfIteratorHelper(i),_step811;try{for(_iterator811.s();!(_step811=_iterator811.n()).done;){var _e771=_step811.value;_this761.focusTracker.remove(_e771.element);}}catch(err){_iterator811.e(err);}finally{_iterator811.f();}}}),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(lB,"destroy",this,3)([]),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this.tiles.first.focus();}}]);}(lg);var cB=/*#__PURE__*/function(_lg68){function cB(e){var _this762;_classCallCheck(this,cB);_this762=_callSuper(this,cB,[e]);var t=_this762.bindTemplate;_this762.set("character",null),_this762.set("name",null),_this762.bind("code").to(_this762,"character",dB),_this762.setTemplate({tag:"div",children:[{tag:"span",attributes:{"class":["ck-character-info__name"]},children:[{text:t.to("name",function(e){return e||"​";})}]},{tag:"span",attributes:{"class":["ck-character-info__code"]},children:[{text:t.to("code")}]}],attributes:{"class":["ck","ck-character-info"]}});return _this762;}_inherits(cB,_lg68);return _createClass(cB);}(lg);function dB(e){if(null===e)return"";return"U+"+("0000"+e.codePointAt(0).toString(16)).slice(-4);}var uB=/*#__PURE__*/function(_lg69){function uB(e,t,i,n){var _this763;_classCallCheck(this,uB);_this763=_callSuper(this,uB,[e]),_defineProperty(_assertThisInitialized(_this763),"items",void 0),_defineProperty(_assertThisInitialized(_this763),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this763),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this763),"_focusCycler",void 0),_defineProperty(_assertThisInitialized(_this763),"categoriesView",void 0),_defineProperty(_assertThisInitialized(_this763),"gridView",void 0),_defineProperty(_assertThisInitialized(_this763),"infoView",void 0),_this763.categoriesView=t,_this763.gridView=i,_this763.infoView=n,_this763.items=_this763.createCollection(),_this763.focusTracker=new _r(),_this763.keystrokes=new Cr(),_this763._focusCycler=new _g({focusables:_this763.items,focusTracker:_this763.focusTracker,keystrokeHandler:_this763.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this763.setTemplate({tag:"div",children:[_this763.categoriesView,_this763.gridView,_this763.infoView],attributes:{tabindex:"-1"}}),_this763.items.add(_this763.categoriesView),_this763.items.add(_this763.gridView);return _this763;}_inherits(uB,_lg69);return _createClass(uB,[{key:"render",value:function render(){_superPropGet(uB,"render",this,3)([]),this.focusTracker.add(this.categoriesView.element),this.focusTracker.add(this.gridView.element),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(uB,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}}]);}(lg);var hB=/*#__PURE__*/function(_lg70){function hB(e,t){var _this764;_classCallCheck(this,hB);_this764=_callSuper(this,hB,[e]),_defineProperty(_assertThisInitialized(_this764),"_groupNames",void 0),_defineProperty(_assertThisInitialized(_this764),"_dropdownView",void 0),_this764.set("currentGroupName",Array.from(t.entries())[0][0]),_this764._groupNames=t,_this764._dropdownView=new pf(e,hp),_this764.setTemplate({tag:"div",attributes:{"class":["ck","ck-character-categories"]},children:[_this764._dropdownView]});return _this764;}_inherits(hB,_lg70);return _createClass(hB,[{key:"render",value:function render(){_superPropGet(hB,"render",this,3)([]),this._setupDropdown();}},{key:"focus",value:function focus(){this._dropdownView.focus();}},{key:"_setupDropdown",value:function _setupDropdown(){var _this765=this;var e=new br();var _iterator812=_createForOfIteratorHelper(this._groupNames),_step812;try{var _loop41=function _loop41(){var _step812$value=_slicedToArray(_step812.value,2),t=_step812$value[0],i=_step812$value[1];var n={type:"button",model:new Fb({name:t,label:i,role:"menuitemradio",withText:!0})};n.model.bind("isOn").to(_this765,"currentGroupName",function(e){return e===t;}),e.add(n);};for(_iterator812.s();!(_step812=_iterator812.n()).done;){_loop41();}}catch(err){_iterator812.e(err);}finally{_iterator812.f();}var t=(0,this.locale.t)("Category");this._dropdownView.set({label:t,isEmpty:!1}),this._dropdownView.fieldView.panelPosition="rtl"===this.locale.uiLanguageDirection?"se":"sw",this._dropdownView.fieldView.buttonView.set({withText:!0,tooltip:t,ariaLabel:t,ariaLabelledBy:void 0,isOn:!1}),this._dropdownView.fieldView.buttonView.bind("label").to(this,"currentGroupName",function(e){return _this765._groupNames.get(e);}),this._dropdownView.fieldView.on("execute",function(_ref290){var e=_ref290.source;_this765.currentGroupName=e.name;}),sp(this._dropdownView.fieldView,e,{ariaLabel:t,role:"menu"});}}]);}(lg);var mB="All";var gB=/*#__PURE__*/function(_Dr227){function gB(e){var _this766;_classCallCheck(this,gB);_this766=_callSuper(this,gB,[e]);_defineProperty(_this766,"_characters",void 0);_defineProperty(_this766,"_groups",void 0);_defineProperty(_this766,"_allSpecialCharactersGroupLabel",void 0);var t=e.t;_this766._characters=new Map(),_this766._groups=new Map(),_this766._allSpecialCharactersGroupLabel=t("All");return _this766;}_inherits(gB,_Dr227);return _createClass(gB,[{key:"init",value:function init(){var _this767=this;var e=this.editor;e.ui.componentFactory.add("specialCharacters",function(){var e=_this767._createDialogButton(pg);return e.set({tooltip:!0}),e;}),e.ui.componentFactory.add("menuBar:specialCharacters",function(){return _this767._createDialogButton(Rg);});}},{key:"addItems",value:function addItems(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{label:e};if(e===mB)throw new A("special-character-invalid-group-name",null);var n=this._getGroup(e,i.label);var _iterator813=_createForOfIteratorHelper(t),_step813;try{for(_iterator813.s();!(_step813=_iterator813.n()).done;){var _e773=_step813.value;n.items.add(_e773.title),this._characters.set(_e773.title,_e773.character);}}catch(err){_iterator813.e(err);}finally{_iterator813.f();}}},{key:"getGroups",value:function getGroups(){var e=Array.from(this._groups.keys()),t=this.editor.config.get("specialCharacters.order")||[],i=t.find(function(t){return!e.includes(t);});if(i)throw new A("special-character-invalid-order-group-name",null,{invalidGroup:i});return new Set([].concat(_toConsumableArray(t),e));}},{key:"getCharactersForGroup",value:function getCharactersForGroup(e){if(e===mB)return new Set(this._characters.keys());var t=this._groups.get(e);return t?t.items:void 0;}},{key:"getCharacter",value:function getCharacter(e){return this._characters.get(e);}},{key:"_getGroup",value:function _getGroup(e,t){return this._groups.has(e)||this._groups.set(e,{items:new Set(),label:t}),this._groups.get(e);}},{key:"_updateGrid",value:function _updateGrid(e,t){t.tiles.clear();var i=this.getCharactersForGroup(e);var _iterator814=_createForOfIteratorHelper(i),_step814;try{for(_iterator814.s();!(_step814=_iterator814.n()).done;){var _e774=_step814.value;var _i589=this.getCharacter(_e774);t.tiles.add(t.createTile(_i589,_e774));}}catch(err){_iterator814.e(err);}finally{_iterator814.f();}}},{key:"_createDropdownPanelContent",value:function _createDropdownPanelContent(e){var _this768=this;var t=Array.from(this.getGroups()).map(function(e){return[e,_this768._groups.get(e).label];}),i=new Map([[mB,this._allSpecialCharactersGroupLabel]].concat(_toConsumableArray(t))),n=new hB(e,i),s=new lB(e),o=new cB(e);return s.on("tileHover",function(e,t){o.set(t);}),s.on("tileFocus",function(e,t){o.set(t);}),n.on("change:currentGroupName",function(e,t,i){_this768._updateGrid(i,s);}),this._updateGrid(n.currentGroupName,s),{categoriesView:n,gridView:s,infoView:o};}},{key:"_createDialogButton",value:function _createDialogButton(e){var _this769=this;var t=this.editor,i=t.locale,n=new e(t.locale),s=t.commands.get("insertText"),o=i.t,r=this.editor.plugins.get("Dialog");return n.set({label:o("Special characters"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2.5a7.47 7.47 0 0 1 4.231 1.31 7.268 7.268 0 0 1 2.703 3.454 7.128 7.128 0 0 1 .199 4.353c-.39 1.436-1.475 2.72-2.633 3.677h2.013c0-.226.092-.443.254-.603a.876.876 0 0 1 1.229 0c.163.16.254.377.254.603v.853c0 .209-.078.41-.22.567a.873.873 0 0 1-.547.28l-.101.006h-4.695a.517.517 0 0 1-.516-.518v-1.265c0-.21.128-.398.317-.489a5.601 5.601 0 0 0 2.492-2.371 5.459 5.459 0 0 0 .552-3.693 5.53 5.53 0 0 0-1.955-3.2A5.71 5.71 0 0 0 10 4.206 5.708 5.708 0 0 0 6.419 5.46 5.527 5.527 0 0 0 4.46 8.663a5.457 5.457 0 0 0 .554 3.695 5.6 5.6 0 0 0 2.497 2.37.55.55 0 0 1 .317.49v1.264c0 .286-.23.518-.516.518H2.618a.877.877 0 0 1-.614-.25.845.845 0 0 1-.254-.603v-.853c0-.226.091-.443.254-.603a.876.876 0 0 1 1.228 0c.163.16.255.377.255.603h1.925c-1.158-.958-2.155-2.241-2.545-3.678a7.128 7.128 0 0 1 .199-4.352 7.268 7.268 0 0 1 2.703-3.455A7.475 7.475 0 0 1 10 2.5z"/></svg>',isToggleable:!0}),n.bind("isOn").to(r,"id",function(e){return"specialCharacters"===e;}),n.bind("isEnabled").to(s,"isEnabled"),n.on("execute",function(){"specialCharacters"!==r.id?_this769._showDialog():r.hide();}),n;}},{key:"_showDialog",value:function _showDialog(){var e=this.editor,t=e.plugins.get("Dialog"),i=e.locale,n=i.t,_this$_createDropdown=this._createDropdownPanelContent(i),s=_this$_createDropdown.categoriesView,o=_this$_createDropdown.gridView,r=_this$_createDropdown.infoView,a=new uB(i,s,o,r);o.on("execute",function(t,i){e.execute("insertText",{text:i.character});}),t.show({id:"specialCharacters",title:n("Special characters"),className:"ck-special-characters",content:a,position:Eg.EDITOR_TOP_SIDE});}}],[{key:"requires",get:function get(){return[Ow,Sg];}},{key:"pluginName",get:function get(){return"SpecialCharacters";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var fB=/*#__PURE__*/function(_Dr228){function fB(){_classCallCheck(this,fB);return _callSuper(this,fB,arguments);}_inherits(fB,_Dr228);return _createClass(fB,[{key:"init",value:function init(){var e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Arrows",[{title:t("leftwards simple arrow"),character:"←"},{title:t("rightwards simple arrow"),character:"→"},{title:t("upwards simple arrow"),character:"↑"},{title:t("downwards simple arrow"),character:"↓"},{title:t("leftwards double arrow"),character:"⇐"},{title:t("rightwards double arrow"),character:"⇒"},{title:t("upwards double arrow"),character:"⇑"},{title:t("downwards double arrow"),character:"⇓"},{title:t("leftwards dashed arrow"),character:"⇠"},{title:t("rightwards dashed arrow"),character:"⇢"},{title:t("upwards dashed arrow"),character:"⇡"},{title:t("downwards dashed arrow"),character:"⇣"},{title:t("leftwards arrow to bar"),character:"⇤"},{title:t("rightwards arrow to bar"),character:"⇥"},{title:t("upwards arrow to bar"),character:"⤒"},{title:t("downwards arrow to bar"),character:"⤓"},{title:t("up down arrow with base"),character:"↨"},{title:t("back with leftwards arrow above"),character:"🔙"},{title:t("end with leftwards arrow above"),character:"🔚"},{title:t("on with exclamation mark with left right arrow above"),character:"🔛"},{title:t("soon with rightwards arrow above"),character:"🔜"},{title:t("top with upwards arrow above"),character:"🔝"}],{label:t("Arrows")});}}],[{key:"pluginName",get:function get(){return"SpecialCharactersArrows";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pB=/*#__PURE__*/function(_Dr229){function pB(){_classCallCheck(this,pB);return _callSuper(this,pB,arguments);}_inherits(pB,_Dr229);return _createClass(pB,[{key:"init",value:function init(){var e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Text",[{character:"‹",title:t("Single left-pointing angle quotation mark")},{character:"›",title:t("Single right-pointing angle quotation mark")},{character:"«",title:t("Left-pointing double angle quotation mark")},{character:"»",title:t("Right-pointing double angle quotation mark")},{character:"‘",title:t("Left single quotation mark")},{character:"’",title:t("Right single quotation mark")},{character:"“",title:t("Left double quotation mark")},{character:"”",title:t("Right double quotation mark")},{character:"‚",title:t("Single low-9 quotation mark")},{character:"„",title:t("Double low-9 quotation mark")},{character:"¡",title:t("Inverted exclamation mark")},{character:"¿",title:t("Inverted question mark")},{character:"‥",title:t("Two dot leader")},{character:"…",title:t("Horizontal ellipsis")},{character:"‡",title:t("Double dagger")},{character:"‰",title:t("Per mille sign")},{character:"‱",title:t("Per ten thousand sign")},{character:"‼",title:t("Double exclamation mark")},{character:"⁈",title:t("Question exclamation mark")},{character:"⁉",title:t("Exclamation question mark")},{character:"⁇",title:t("Double question mark")},{character:"©",title:t("Copyright sign")},{character:"®",title:t("Registered sign")},{character:"™",title:t("Trade mark sign")},{character:"§",title:t("Section sign")},{character:"¶",title:t("Paragraph sign")},{character:"⁋",title:t("Reversed paragraph sign")}],{label:t("Text")});}}],[{key:"pluginName",get:function get(){return"SpecialCharactersText";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var bB=/*#__PURE__*/function(_Dr230){function bB(){_classCallCheck(this,bB);return _callSuper(this,bB,arguments);}_inherits(bB,_Dr230);return _createClass(bB,[{key:"init",value:function init(){var e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Mathematical",[{character:"<",title:t("Less-than sign")},{character:">",title:t("Greater-than sign")},{character:"≤",title:t("Less-than or equal to")},{character:"≥",title:t("Greater-than or equal to")},{character:"–",title:t("En dash")},{character:"—",title:t("Em dash")},{character:"¯",title:t("Macron")},{character:"‾",title:t("Overline")},{character:"°",title:t("Degree sign")},{character:"−",title:t("Minus sign")},{character:"±",title:t("Plus-minus sign")},{character:"÷",title:t("Division sign")},{character:"⁄",title:t("Fraction slash")},{character:"×",title:t("Multiplication sign")},{character:"ƒ",title:t("Latin small letter f with hook")},{character:"∫",title:t("Integral")},{character:"∑",title:t("N-ary summation")},{character:"∞",title:t("Infinity")},{character:"√",title:t("Square root")},{character:"∼",title:t("Tilde operator")},{character:"≅",title:t("Approximately equal to")},{character:"≈",title:t("Almost equal to")},{character:"≠",title:t("Not equal to")},{character:"≡",title:t("Identical to")},{character:"∈",title:t("Element of")},{character:"∉",title:t("Not an element of")},{character:"∋",title:t("Contains as member")},{character:"∏",title:t("N-ary product")},{character:"∧",title:t("Logical and")},{character:"∨",title:t("Logical or")},{character:"¬",title:t("Not sign")},{character:"∩",title:t("Intersection")},{character:"∪",title:t("Union")},{character:"∂",title:t("Partial differential")},{character:"∀",title:t("For all")},{character:"∃",title:t("There exists")},{character:"∅",title:t("Empty set")},{character:"∇",title:t("Nabla")},{character:"∗",title:t("Asterisk operator")},{character:"∝",title:t("Proportional to")},{character:"∠",title:t("Angle")},{character:"¼",title:t("Vulgar fraction one quarter")},{character:"½",title:t("Vulgar fraction one half")},{character:"¾",title:t("Vulgar fraction three quarters")}],{label:t("Mathematical")});}}],[{key:"pluginName",get:function get(){return"SpecialCharactersMathematical";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var wB=/*#__PURE__*/function(_Dr231){function wB(){_classCallCheck(this,wB);return _callSuper(this,wB,arguments);}_inherits(wB,_Dr231);return _createClass(wB,[{key:"init",value:function init(){var e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Latin",[{character:"Ā",title:t("Latin capital letter a with macron")},{character:"ā",title:t("Latin small letter a with macron")},{character:"Ă",title:t("Latin capital letter a with breve")},{character:"ă",title:t("Latin small letter a with breve")},{character:"Ą",title:t("Latin capital letter a with ogonek")},{character:"ą",title:t("Latin small letter a with ogonek")},{character:"Ć",title:t("Latin capital letter c with acute")},{character:"ć",title:t("Latin small letter c with acute")},{character:"Ĉ",title:t("Latin capital letter c with circumflex")},{character:"ĉ",title:t("Latin small letter c with circumflex")},{character:"Ċ",title:t("Latin capital letter c with dot above")},{character:"ċ",title:t("Latin small letter c with dot above")},{character:"Č",title:t("Latin capital letter c with caron")},{character:"č",title:t("Latin small letter c with caron")},{character:"Ď",title:t("Latin capital letter d with caron")},{character:"ď",title:t("Latin small letter d with caron")},{character:"Đ",title:t("Latin capital letter d with stroke")},{character:"đ",title:t("Latin small letter d with stroke")},{character:"Ē",title:t("Latin capital letter e with macron")},{character:"ē",title:t("Latin small letter e with macron")},{character:"Ĕ",title:t("Latin capital letter e with breve")},{character:"ĕ",title:t("Latin small letter e with breve")},{character:"Ė",title:t("Latin capital letter e with dot above")},{character:"ė",title:t("Latin small letter e with dot above")},{character:"Ę",title:t("Latin capital letter e with ogonek")},{character:"ę",title:t("Latin small letter e with ogonek")},{character:"Ě",title:t("Latin capital letter e with caron")},{character:"ě",title:t("Latin small letter e with caron")},{character:"Ĝ",title:t("Latin capital letter g with circumflex")},{character:"ĝ",title:t("Latin small letter g with circumflex")},{character:"Ğ",title:t("Latin capital letter g with breve")},{character:"ğ",title:t("Latin small letter g with breve")},{character:"Ġ",title:t("Latin capital letter g with dot above")},{character:"ġ",title:t("Latin small letter g with dot above")},{character:"Ģ",title:t("Latin capital letter g with cedilla")},{character:"ģ",title:t("Latin small letter g with cedilla")},{character:"Ĥ",title:t("Latin capital letter h with circumflex")},{character:"ĥ",title:t("Latin small letter h with circumflex")},{character:"Ħ",title:t("Latin capital letter h with stroke")},{character:"ħ",title:t("Latin small letter h with stroke")},{character:"Ĩ",title:t("Latin capital letter i with tilde")},{character:"ĩ",title:t("Latin small letter i with tilde")},{character:"Ī",title:t("Latin capital letter i with macron")},{character:"ī",title:t("Latin small letter i with macron")},{character:"Ĭ",title:t("Latin capital letter i with breve")},{character:"ĭ",title:t("Latin small letter i with breve")},{character:"Į",title:t("Latin capital letter i with ogonek")},{character:"į",title:t("Latin small letter i with ogonek")},{character:"İ",title:t("Latin capital letter i with dot above")},{character:"ı",title:t("Latin small letter dotless i")},{character:"Ĳ",title:t("Latin capital ligature ij")},{character:"ĳ",title:t("Latin small ligature ij")},{character:"Ĵ",title:t("Latin capital letter j with circumflex")},{character:"ĵ",title:t("Latin small letter j with circumflex")},{character:"Ķ",title:t("Latin capital letter k with cedilla")},{character:"ķ",title:t("Latin small letter k with cedilla")},{character:"ĸ",title:t("Latin small letter kra")},{character:"Ĺ",title:t("Latin capital letter l with acute")},{character:"ĺ",title:t("Latin small letter l with acute")},{character:"Ļ",title:t("Latin capital letter l with cedilla")},{character:"ļ",title:t("Latin small letter l with cedilla")},{character:"Ľ",title:t("Latin capital letter l with caron")},{character:"ľ",title:t("Latin small letter l with caron")},{character:"Ŀ",title:t("Latin capital letter l with middle dot")},{character:"ŀ",title:t("Latin small letter l with middle dot")},{character:"Ł",title:t("Latin capital letter l with stroke")},{character:"ł",title:t("Latin small letter l with stroke")},{character:"Ń",title:t("Latin capital letter n with acute")},{character:"ń",title:t("Latin small letter n with acute")},{character:"Ņ",title:t("Latin capital letter n with cedilla")},{character:"ņ",title:t("Latin small letter n with cedilla")},{character:"Ň",title:t("Latin capital letter n with caron")},{character:"ň",title:t("Latin small letter n with caron")},{character:"ŉ",title:t("Latin small letter n preceded by apostrophe")},{character:"Ŋ",title:t("Latin capital letter eng")},{character:"ŋ",title:t("Latin small letter eng")},{character:"Ō",title:t("Latin capital letter o with macron")},{character:"ō",title:t("Latin small letter o with macron")},{character:"Ŏ",title:t("Latin capital letter o with breve")},{character:"ŏ",title:t("Latin small letter o with breve")},{character:"Ő",title:t("Latin capital letter o with double acute")},{character:"ő",title:t("Latin small letter o with double acute")},{character:"Œ",title:t("Latin capital ligature oe")},{character:"œ",title:t("Latin small ligature oe")},{character:"Ŕ",title:t("Latin capital letter r with acute")},{character:"ŕ",title:t("Latin small letter r with acute")},{character:"Ŗ",title:t("Latin capital letter r with cedilla")},{character:"ŗ",title:t("Latin small letter r with cedilla")},{character:"Ř",title:t("Latin capital letter r with caron")},{character:"ř",title:t("Latin small letter r with caron")},{character:"Ś",title:t("Latin capital letter s with acute")},{character:"ś",title:t("Latin small letter s with acute")},{character:"Ŝ",title:t("Latin capital letter s with circumflex")},{character:"ŝ",title:t("Latin small letter s with circumflex")},{character:"Ş",title:t("Latin capital letter s with cedilla")},{character:"ş",title:t("Latin small letter s with cedilla")},{character:"Š",title:t("Latin capital letter s with caron")},{character:"š",title:t("Latin small letter s with caron")},{character:"Ţ",title:t("Latin capital letter t with cedilla")},{character:"ţ",title:t("Latin small letter t with cedilla")},{character:"Ť",title:t("Latin capital letter t with caron")},{character:"ť",title:t("Latin small letter t with caron")},{character:"Ŧ",title:t("Latin capital letter t with stroke")},{character:"ŧ",title:t("Latin small letter t with stroke")},{character:"Ũ",title:t("Latin capital letter u with tilde")},{character:"ũ",title:t("Latin small letter u with tilde")},{character:"Ū",title:t("Latin capital letter u with macron")},{character:"ū",title:t("Latin small letter u with macron")},{character:"Ŭ",title:t("Latin capital letter u with breve")},{character:"ŭ",title:t("Latin small letter u with breve")},{character:"Ů",title:t("Latin capital letter u with ring above")},{character:"ů",title:t("Latin small letter u with ring above")},{character:"Ű",title:t("Latin capital letter u with double acute")},{character:"ű",title:t("Latin small letter u with double acute")},{character:"Ų",title:t("Latin capital letter u with ogonek")},{character:"ų",title:t("Latin small letter u with ogonek")},{character:"Ŵ",title:t("Latin capital letter w with circumflex")},{character:"ŵ",title:t("Latin small letter w with circumflex")},{character:"Ŷ",title:t("Latin capital letter y with circumflex")},{character:"ŷ",title:t("Latin small letter y with circumflex")},{character:"Ÿ",title:t("Latin capital letter y with diaeresis")},{character:"Ź",title:t("Latin capital letter z with acute")},{character:"ź",title:t("Latin small letter z with acute")},{character:"Ż",title:t("Latin capital letter z with dot above")},{character:"ż",title:t("Latin small letter z with dot above")},{character:"Ž",title:t("Latin capital letter z with caron")},{character:"ž",title:t("Latin small letter z with caron")},{character:"ſ",title:t("Latin small letter long s")}],{label:t("Latin")});}}],[{key:"pluginName",get:function get(){return"SpecialCharactersLatin";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var _B=/*#__PURE__*/function(_Dr232){function _B(){_classCallCheck(this,_B);return _callSuper(this,_B,arguments);}_inherits(_B,_Dr232);return _createClass(_B,[{key:"init",value:function init(){var e=this.editor,t=e.t;e.plugins.get("SpecialCharacters").addItems("Currency",[{character:"$",title:t("Dollar sign")},{character:"€",title:t("Euro sign")},{character:"¥",title:t("Yen sign")},{character:"£",title:t("Pound sign")},{character:"¢",title:t("Cent sign")},{character:"₠",title:t("Euro-currency sign")},{character:"₡",title:t("Colon sign")},{character:"₢",title:t("Cruzeiro sign")},{character:"₣",title:t("French franc sign")},{character:"₤",title:t("Lira sign")},{character:"¤",title:t("Currency sign")},{character:"₿",title:t("Bitcoin sign")},{character:"₥",title:t("Mill sign")},{character:"₦",title:t("Naira sign")},{character:"₧",title:t("Peseta sign")},{character:"₨",title:t("Rupee sign")},{character:"₩",title:t("Won sign")},{character:"₪",title:t("New sheqel sign")},{character:"₫",title:t("Dong sign")},{character:"₭",title:t("Kip sign")},{character:"₮",title:t("Tugrik sign")},{character:"₯",title:t("Drachma sign")},{character:"₰",title:t("German penny sign")},{character:"₱",title:t("Peso sign")},{character:"₲",title:t("Guarani sign")},{character:"₳",title:t("Austral sign")},{character:"₴",title:t("Hryvnia sign")},{character:"₵",title:t("Cedi sign")},{character:"₶",title:t("Livre tournois sign")},{character:"₷",title:t("Spesmilo sign")},{character:"₸",title:t("Tenge sign")},{character:"₹",title:t("Indian rupee sign")},{character:"₺",title:t("Turkish lira sign")},{character:"₻",title:t("Nordic mark sign")},{character:"₼",title:t("Manat sign")},{character:"₽",title:t("Ruble sign")}],{label:t("Currency")});}}],[{key:"pluginName",get:function get(){return"SpecialCharactersCurrency";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var vB=/*#__PURE__*/function(_Dr233){function vB(){_classCallCheck(this,vB);return _callSuper(this,vB,arguments);}_inherits(vB,_Dr233);return _createClass(vB,null,[{key:"pluginName",get:function get(){return"SpecialCharactersEssentials";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[_B,pB,bB,fB,wB];}}]);}(Dr);var yB=/*#__PURE__*/function(_pg8){function yB(e,t){var _this770;_classCallCheck(this,yB);_this770=_callSuper(this,yB,[e]),_defineProperty(_assertThisInitialized(_this770),"styleDefinition",void 0),_defineProperty(_assertThisInitialized(_this770),"previewView",void 0),_this770.styleDefinition=t,_this770.previewView=_this770._createPreview(),_this770.set({label:t.name,"class":"ck-style-grid__button",withText:!0}),_this770.extendTemplate({attributes:{role:"option"}}),_this770.children.add(_this770.previewView,0);return _this770;}_inherits(yB,_pg8);return _createClass(yB,[{key:"_createPreview",value:function _createPreview(){var e=new lg(this.locale);return e.setTemplate({tag:"div",attributes:{"class":["ck","ck-reset_all-excluded","ck-style-grid__button__preview","ck-content"],"aria-hidden":"true"},children:[this.styleDefinition.previewTemplate]}),e;}}]);}(pg);var kB=/*#__PURE__*/function(_lg71){function kB(e,t){var _this771;_classCallCheck(this,kB);_this771=_callSuper(this,kB,[e]),_defineProperty(_assertThisInitialized(_this771),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this771),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this771),"children",void 0),_this771.focusTracker=new _r(),_this771.keystrokes=new Cr(),_this771.set("activeStyles",[]),_this771.set("enabledStyles",[]),_this771.children=_this771.createCollection(),_this771.children.delegate("execute").to(_assertThisInitialized(_this771));var _iterator815=_createForOfIteratorHelper(t),_step815;try{for(_iterator815.s();!(_step815=_iterator815.n()).done;){var _i590=_step815.value;var _t534=new yB(e,_i590);_this771.children.add(_t534);}}catch(err){_iterator815.e(err);}finally{_iterator815.f();}_this771.on("change:activeStyles",function(){var _iterator816=_createForOfIteratorHelper(_this771.children),_step816;try{for(_iterator816.s();!(_step816=_iterator816.n()).done;){var _e775=_step816.value;_e775.isOn=_this771.activeStyles.includes(_e775.styleDefinition.name);}}catch(err){_iterator816.e(err);}finally{_iterator816.f();}}),_this771.on("change:enabledStyles",function(){var _iterator817=_createForOfIteratorHelper(_this771.children),_step817;try{for(_iterator817.s();!(_step817=_iterator817.n()).done;){var _e776=_step817.value;_e776.isEnabled=_this771.enabledStyles.includes(_e776.styleDefinition.name);}}catch(err){_iterator817.e(err);}finally{_iterator817.f();}}),_this771.setTemplate({tag:"div",attributes:{"class":["ck","ck-style-grid"],role:"listbox"},children:_this771.children});return _this771;}_inherits(kB,_lg71);return _createClass(kB,[{key:"render",value:function render(){_superPropGet(kB,"render",this,3)([]);var _iterator818=_createForOfIteratorHelper(this.children),_step818;try{for(_iterator818.s();!(_step818=_iterator818.n()).done;){var _e777=_step818.value;this.focusTracker.add(_e777.element);}}catch(err){_iterator818.e(err);}finally{_iterator818.f();}mg({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.children,numberOfColumns:3,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection}),this.keystrokes.listenTo(this.element);}},{key:"focus",value:function focus(){this.children.first.focus();}},{key:"destroy",value:function destroy(){_superPropGet(kB,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}}]);}(lg);var CB=/*#__PURE__*/function(_lg72){function CB(e,t,i){var _this772;_classCallCheck(this,CB);_this772=_callSuper(this,CB,[e]),_defineProperty(_assertThisInitialized(_this772),"gridView",void 0),_defineProperty(_assertThisInitialized(_this772),"labelView",void 0),_this772.labelView=new Og(e),_this772.labelView.text=t,_this772.gridView=new kB(e,i),_this772.setTemplate({tag:"div",attributes:{"class":["ck","ck-style-panel__style-group"],role:"group","aria-labelledby":_this772.labelView.id},children:[_this772.labelView,_this772.gridView]});return _this772;}_inherits(CB,_lg72);return _createClass(CB);}(lg);var xB=/*#__PURE__*/function(_lg73){function xB(e,t){var _this773;_classCallCheck(this,xB);_this773=_callSuper(this,xB,[e]);_defineProperty(_this773,"focusTracker",void 0);_defineProperty(_this773,"keystrokes",void 0);_defineProperty(_this773,"children",void 0);_defineProperty(_this773,"blockStylesGroupView",void 0);_defineProperty(_this773,"inlineStylesGroupView",void 0);_defineProperty(_this773,"_focusables",void 0);_defineProperty(_this773,"_focusCycler",void 0);var i=e.t;_this773.focusTracker=new _r(),_this773.keystrokes=new Cr(),_this773.children=_this773.createCollection(),_this773.blockStylesGroupView=new CB(e,i("Block styles"),t.block),_this773.inlineStylesGroupView=new CB(e,i("Text styles"),t.inline),_this773.set("activeStyles",[]),_this773.set("enabledStyles",[]),_this773._focusables=new zm(),_this773._focusCycler=new _g({focusables:_this773._focusables,focusTracker:_this773.focusTracker,keystrokeHandler:_this773.keystrokes,actions:{focusPrevious:["shift + tab"],focusNext:["tab"]}}),t.block.length&&_this773.children.add(_this773.blockStylesGroupView),t.inline.length&&_this773.children.add(_this773.inlineStylesGroupView),_this773.blockStylesGroupView.gridView.delegate("execute").to(_this773),_this773.inlineStylesGroupView.gridView.delegate("execute").to(_this773),_this773.blockStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(_this773,"activeStyles","enabledStyles"),_this773.inlineStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(_this773,"activeStyles","enabledStyles"),_this773.setTemplate({tag:"div",attributes:{"class":["ck","ck-style-panel"]},children:_this773.children});return _this773;}_inherits(xB,_lg73);return _createClass(xB,[{key:"render",value:function render(){_superPropGet(xB,"render",this,3)([]),this._focusables.add(this.blockStylesGroupView.gridView),this._focusables.add(this.inlineStylesGroupView.gridView),this.focusTracker.add(this.blockStylesGroupView.gridView.element),this.focusTracker.add(this.inlineStylesGroupView.gridView.element),this.keystrokes.listenTo(this.element);}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"focusLast",value:function focusLast(){this._focusCycler.focusLast();}}]);}(lg);var AB=["caption","colgroup","dd","dt","figcaption","legend","li","optgroup","option","rp","rt","summary","tbody","td","tfoot","th","thead","tr"];var EB=/*#__PURE__*/function(_Dr234){function EB(e){var _this774;_classCallCheck(this,EB);_this774=_callSuper(this,EB,[e]),_defineProperty(_assertThisInitialized(_this774),"_htmlSupport",void 0),_this774.decorate("isStyleEnabledForBlock"),_this774.decorate("isStyleActiveForBlock"),_this774.decorate("getAffectedBlocks"),_this774.decorate("isStyleEnabledForInlineSelection"),_this774.decorate("isStyleActiveForInlineSelection"),_this774.decorate("getAffectedInlineSelectable"),_this774.decorate("getStylePreview"),_this774.decorate("configureGHSDataFilter");return _this774;}_inherits(EB,_Dr234);return _createClass(EB,[{key:"init",value:function init(){this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport");}},{key:"normalizeConfig",value:function normalizeConfig(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var i={block:[],inline:[]};var _iterator819=_createForOfIteratorHelper(t),_step819;try{for(_iterator819.s();!(_step819=_iterator819.n()).done;){var _n307=_step819.value;var _t535=[],_s215=[];var _iterator820=_createForOfIteratorHelper(e.getDefinitionsForView(_n307.element)),_step820;try{for(_iterator820.s();!(_step820=_iterator820.n()).done;){var _i591=_step820.value;var _e778="appliesToBlock"in _i591&&_i591.appliesToBlock;if(_i591.isBlock||_e778){if("string"==typeof _e778)_t535.push(_e778);else if(_i591.isBlock){var _e779=_i591;_t535.push(_i591.model),_e779.paragraphLikeModel&&_t535.push(_e779.paragraphLikeModel);}}else _s215.push(_i591.model);}}catch(err){_iterator820.e(err);}finally{_iterator820.f();}var _o127=this.getStylePreview(_n307,[{text:"AaBbCcDdEeFfGgHhIiJj"}]);_t535.length?i.block.push(_objectSpread(_objectSpread({},_n307),{},{previewTemplate:_o127,modelElements:_t535,isBlock:!0})):i.inline.push(_objectSpread(_objectSpread({},_n307),{},{previewTemplate:_o127,ghsAttributes:_s215}));}}catch(err){_iterator819.e(err);}finally{_iterator819.f();}return i;}},{key:"isStyleEnabledForBlock",value:function isStyleEnabledForBlock(e,t){var i=this.editor.model,n=this._htmlSupport.getGhsAttributeNameForElement(e.element);return!!i.schema.checkAttribute(t,n)&&e.modelElements.includes(t.name);}},{key:"isStyleActiveForBlock",value:function isStyleActiveForBlock(e,t){var i=this._htmlSupport.getGhsAttributeNameForElement(e.element),n=t.getAttribute(i);return this.hasAllClasses(n,e.classes);}},{key:"getAffectedBlocks",value:function getAffectedBlocks(e,t){return e.modelElements.includes(t.name)?[t]:null;}},{key:"isStyleEnabledForInlineSelection",value:function isStyleEnabledForInlineSelection(e,t){var i=this.editor.model;var _iterator821=_createForOfIteratorHelper(e.ghsAttributes),_step821;try{for(_iterator821.s();!(_step821=_iterator821.n()).done;){var _n308=_step821.value;if(i.schema.checkAttributeInSelection(t,_n308))return!0;}}catch(err){_iterator821.e(err);}finally{_iterator821.f();}return!1;}},{key:"isStyleActiveForInlineSelection",value:function isStyleActiveForInlineSelection(e,t){var _iterator822=_createForOfIteratorHelper(e.ghsAttributes),_step822;try{for(_iterator822.s();!(_step822=_iterator822.n()).done;){var _i592=_step822.value;var _n309=this._getValueFromFirstAllowedNode(t,_i592);if(this.hasAllClasses(_n309,e.classes))return!0;}}catch(err){_iterator822.e(err);}finally{_iterator822.f();}return!1;}},{key:"getAffectedInlineSelectable",value:function getAffectedInlineSelectable(e,t){return t;}},{key:"getStylePreview",value:function getStylePreview(e,t){var i=e.element,n=e.classes;return{tag:(s=i,AB.includes(s)?"div":i),attributes:{"class":n},children:t};var s;}},{key:"hasAllClasses",value:function hasAllClasses(e,t){return ue(e)&&(i=e,Boolean(i.classes)&&Array.isArray(i.classes))&&t.every(function(t){return e.classes.includes(t);});var i;}},{key:"configureGHSDataFilter",value:function configureGHSDataFilter(_ref291){var e=_ref291.block,t=_ref291.inline;var i=this.editor.plugins.get("DataFilter");i.loadAllowedConfig(e.map(TB)),i.loadAllowedConfig(t.map(TB));}},{key:"_getValueFromFirstAllowedNode",value:function _getValueFromFirstAllowedNode(e,t){var i=this.editor.model.schema;if(e.isCollapsed)return e.getAttribute(t);var _iterator823=_createForOfIteratorHelper(e.getRanges()),_step823;try{for(_iterator823.s();!(_step823=_iterator823.n()).done;){var _n310=_step823.value;var _iterator824=_createForOfIteratorHelper(_n310.getItems()),_step824;try{for(_iterator824.s();!(_step824=_iterator824.n()).done;){var _e780=_step824.value;if(i.checkAttribute(_e780,t))return _e780.getAttribute(t);}}catch(err){_iterator824.e(err);}finally{_iterator824.f();}}}catch(err){_iterator823.e(err);}finally{_iterator823.f();}return null;}}],[{key:"pluginName",get:function get(){return"StyleUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function TB(_ref292){var e=_ref292.element,t=_ref292.classes;return{name:e,classes:t};}var PB=/*#__PURE__*/function(_Dr235){function PB(){_classCallCheck(this,PB);return _callSuper(this,PB,arguments);}_inherits(PB,_Dr235);return _createClass(PB,[{key:"init",value:function init(){var e=this.editor,t=e.plugins.get("DataSchema"),i=e.plugins.get("StyleUtils"),n=e.config.get("style.definitions"),s=i.normalizeConfig(t,n);e.ui.componentFactory.add("style",function(t){var i=t.t,n=Xf(t),o=e.commands.get("style");return n.once("change:isOpen",function(){var e=new xB(t,s);n.panelView.children.add(e),e.delegate("execute").to(n),e.bind("activeStyles").to(o,"value"),e.bind("enabledStyles").to(o,"enabledStyles");}),n.bind("isEnabled").to(o),n.buttonView.withText=!0,n.buttonView.bind("label").to(o,"value",function(e){return e.length>1?i("Multiple styles"):1===e.length?e[0]:i("Styles");}),n.bind("class").to(o,"value",function(e){var t=["ck-style-dropdown"];return e.length>1&&t.push("ck-style-dropdown_multiple-active"),t.join(" ");}),n.on("execute",function(t){e.execute("style",{styleName:t.source.styleDefinition.name}),e.editing.view.focus();}),n;});}}],[{key:"pluginName",get:function get(){return"StyleUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[EB];}}]);}(Dr);var SB=/*#__PURE__*/function(_Hr61){function SB(e,t){var _this775;_classCallCheck(this,SB);_this775=_callSuper(this,SB,[e]),_defineProperty(_assertThisInitialized(_this775),"_styleDefinitions",void 0),_defineProperty(_assertThisInitialized(_this775),"_styleUtils",void 0),_this775.set("value",[]),_this775.set("enabledStyles",[]),_this775._styleDefinitions=t,_this775._styleUtils=_this775.editor.plugins.get(EB);return _this775;}_inherits(SB,_Hr61);return _createClass(SB,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document.selection,i=new Set(),n=new Set();var _iterator825=_createForOfIteratorHelper(this._styleDefinitions.inline),_step825;try{for(_iterator825.s();!(_step825=_iterator825.n()).done;){var _e782=_step825.value;this._styleUtils.isStyleEnabledForInlineSelection(_e782,t)&&n.add(_e782.name),this._styleUtils.isStyleActiveForInlineSelection(_e782,t)&&i.add(_e782.name);}}catch(err){_iterator825.e(err);}finally{_iterator825.f();}var s=wr(t.getSelectedBlocks())||t.getFirstPosition().parent;if(s){var _t536=s.getAncestors({includeSelf:!0,parentFirst:!0});var _iterator826=_createForOfIteratorHelper(_t536),_step826;try{for(_iterator826.s();!(_step826=_iterator826.n()).done;){var _s216=_step826.value;if(_s216.is("rootElement"))break;var _iterator827=_createForOfIteratorHelper(this._styleDefinitions.block),_step827;try{for(_iterator827.s();!(_step827=_iterator827.n()).done;){var _e781=_step827.value;this._styleUtils.isStyleEnabledForBlock(_e781,_s216)&&(n.add(_e781.name),this._styleUtils.isStyleActiveForBlock(_e781,_s216)&&i.add(_e781.name));}}catch(err){_iterator827.e(err);}finally{_iterator827.f();}if(e.schema.isObject(_s216))break;}}catch(err){_iterator826.e(err);}finally{_iterator826.f();}}this.enabledStyles=Array.from(n).sort(),this.isEnabled=this.enabledStyles.length>0,this.value=this.isEnabled?Array.from(i).sort():[];}},{key:"execute",value:function execute(_ref293){var _this776=this;var e=_ref293.styleName,t=_ref293.forceValue;if(!this.enabledStyles.includes(e))return void E("style-command-executed-with-incorrect-style-name");var i=this.editor.model,n=i.document.selection,s=this.editor.plugins.get("GeneralHtmlSupport"),o=[].concat(_toConsumableArray(this._styleDefinitions.inline),_toConsumableArray(this._styleDefinitions.block)),r=o.filter(function(_ref294){var e=_ref294.name;return _this776.value.includes(e);}),a=o.find(function(_ref295){var t=_ref295.name;return t==e;}),l=void 0===t?!this.value.includes(a.name):t;i.change(function(){var e;e=function(e){return"isBlock"in e;}(a)?_this776._findAffectedBlocks(function(e){var t=Array.from(e.getSelectedBlocks());if(t.length)return t;return[e.getFirstPosition().parent];}(n),a):[_this776._styleUtils.getAffectedInlineSelectable(a,n)];var _iterator828=_createForOfIteratorHelper(e),_step828;try{for(_iterator828.s();!(_step828=_iterator828.n()).done;){var _t537=_step828.value;l?s.addModelHtmlClass(a.element,a.classes,_t537):s.removeModelHtmlClass(a.element,IB(r,a),_t537);}}catch(err){_iterator828.e(err);}finally{_iterator828.f();}});}},{key:"_findAffectedBlocks",value:function _findAffectedBlocks(e,t){var i=new Set();var _iterator829=_createForOfIteratorHelper(e),_step829;try{for(_iterator829.s();!(_step829=_iterator829.n()).done;){var _n311=_step829.value;var _e783=_n311.getAncestors({includeSelf:!0,parentFirst:!0});var _iterator830=_createForOfIteratorHelper(_e783),_step830;try{for(_iterator830.s();!(_step830=_iterator830.n()).done;){var _n312=_step830.value;if(_n312.is("rootElement"))break;var _e784=this._styleUtils.getAffectedBlocks(t,_n312);if(_e784){var _iterator831=_createForOfIteratorHelper(_e784),_step831;try{for(_iterator831.s();!(_step831=_iterator831.n()).done;){var _t538=_step831.value;i.add(_t538);}}catch(err){_iterator831.e(err);}finally{_iterator831.f();}break;}}}catch(err){_iterator830.e(err);}finally{_iterator830.f();}}}catch(err){_iterator829.e(err);}finally{_iterator829.f();}return i;}}]);}(Hr);function IB(e,t){return e.reduce(function(e,i){return i.name===t.name?e:e.filter(function(e){return!i.classes.includes(e);});},t.classes);}var VB=/*#__PURE__*/function(_Dr236){function VB(){var _this777;_classCallCheck(this,VB);for(var _len97=arguments.length,args=new Array(_len97),_key97=0;_key97<_len97;_key97++){args[_key97]=arguments[_key97];}_this777=_callSuper(this,VB,[].concat(args));_defineProperty(_this777,"_listUtils",void 0);_defineProperty(_this777,"_styleUtils",void 0);_defineProperty(_this777,"_htmlSupport",void 0);return _this777;}_inherits(VB,_Dr236);return _createClass(VB,[{key:"init",value:function init(){var _this778=this;var e=this.editor;e.plugins.has("ListEditing")&&(this._styleUtils=e.plugins.get(EB),this._listUtils=this.editor.plugins.get("ListUtils"),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",function(e,_ref296){var _ref297=_slicedToArray(_ref296,2),t=_ref297[0],i=_ref297[1];_this778._isStyleEnabledForBlock(t,i)&&(e["return"]=!0,e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForBlock",function(e,_ref298){var _ref299=_slicedToArray(_ref298,2),t=_ref299[0],i=_ref299[1];_this778._isStyleActiveForBlock(t,i)&&(e["return"]=!0,e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",function(e,_ref300){var _ref301=_slicedToArray(_ref300,2),t=_ref301[0],i=_ref301[1];var n=_this778._getAffectedBlocks(t,i);n&&(e["return"]=n,e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"getStylePreview",function(e,_ref302){var _ref303=_slicedToArray(_ref302,2),t=_ref303[0],i=_ref303[1];var n=_this778._getStylePreview(t,i);n&&(e["return"]=n,e.stop());},{priority:"high"}));}},{key:"_isStyleEnabledForBlock",value:function _isStyleEnabledForBlock(e,t){var i=this.editor.model;if(!["ol","ul","li"].includes(e.element))return!1;if(!this._listUtils.isListItemBlock(t))return!1;var n=this._htmlSupport.getGhsAttributeNameForElement(e.element);if("ol"==e.element||"ul"==e.element){if(!i.schema.checkAttribute(t,n))return!1;var _s217=this._listUtils.isNumberedListType(t.getAttribute("listType"))?"ol":"ul";return e.element==_s217;}return i.schema.checkAttribute(t,n);}},{key:"_isStyleActiveForBlock",value:function _isStyleActiveForBlock(e,t){var i=this._htmlSupport.getGhsAttributeNameForElement(e.element),n=t.getAttribute(i);return this._styleUtils.hasAllClasses(n,e.classes);}},{key:"_getAffectedBlocks",value:function _getAffectedBlocks(e,t){return this._isStyleEnabledForBlock(e,t)?"li"==e.element?this._listUtils.expandListBlocksToCompleteItems(t,{withNested:!1}):this._listUtils.expandListBlocksToCompleteList(t):null;}},{key:"_getStylePreview",value:function _getStylePreview(e,t){var i=e.element,n=e.classes;return"ol"==i||"ul"==i?{tag:i,attributes:{"class":n},children:[{tag:"li",children:t}]}:"li"==i?{tag:"ol",children:[{tag:i,attributes:{"class":n},children:t}]}:null;}}],[{key:"pluginName",get:function get(){return"ListStyleSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[EB,"GeneralHtmlSupport"];}}]);}(Dr);var RB=/*#__PURE__*/function(_Dr237){function RB(){var _this779;_classCallCheck(this,RB);for(var _len98=arguments.length,args=new Array(_len98),_key98=0;_key98<_len98;_key98++){args[_key98]=arguments[_key98];}_this779=_callSuper(this,RB,[].concat(args));_defineProperty(_this779,"_tableUtils",void 0);_defineProperty(_this779,"_styleUtils",void 0);return _this779;}_inherits(RB,_Dr237);return _createClass(RB,[{key:"init",value:function init(){var _this780=this;var e=this.editor;e.plugins.has("TableEditing")&&(this._styleUtils=e.plugins.get(EB),this._tableUtils=this.editor.plugins.get("TableUtils"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",function(e,_ref304){var _ref305=_slicedToArray(_ref304,2),t=_ref305[0],i=_ref305[1];_this780._isApplicable(t,i)&&(e["return"]=_this780._isStyleEnabledForBlock(t,i),e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",function(e,_ref306){var _ref307=_slicedToArray(_ref306,2),t=_ref307[0],i=_ref307[1];_this780._isApplicable(t,i)&&(e["return"]=_this780._getAffectedBlocks(t,i),e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"configureGHSDataFilter",function(e,_ref308){var _ref309=_slicedToArray(_ref308,1),t=_ref309[0].block;_this780.editor.plugins.get("DataFilter").loadAllowedConfig(t.filter(function(e){return"figcaption"==e.element;}).map(function(e){return{name:"caption",classes:e.classes};}));}));}},{key:"_isApplicable",value:function _isApplicable(e,t){return["td","th"].includes(e.element)?"tableCell"==t.name:!!["thead","tbody"].includes(e.element)&&"table"==t.name;}},{key:"_isStyleEnabledForBlock",value:function _isStyleEnabledForBlock(e,t){if(["td","th"].includes(e.element)){var _i593=this._tableUtils.getCellLocation(t),_n313=t.parent.parent,_s218=_n313.getAttribute("headingRows")||0,_o128=_n313.getAttribute("headingColumns")||0,r=_i593.row<_s218||_i593.column<_o128;return"th"==e.element?r:!r;}if(["thead","tbody"].includes(e.element)){var _i594=t.getAttribute("headingRows")||0;return"thead"==e.element?_i594>0:_i594<this._tableUtils.getRows(t);}return!1;}},{key:"_getAffectedBlocks",value:function _getAffectedBlocks(e,t){return this._isStyleEnabledForBlock(e,t)?[t]:null;}}],[{key:"pluginName",get:function get(){return"TableStyleSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[EB];}}]);}(Dr);var OB=/*#__PURE__*/function(_Dr238){function OB(){var _this781;_classCallCheck(this,OB);for(var _len99=arguments.length,args=new Array(_len99),_key99=0;_key99<_len99;_key99++){args[_key99]=arguments[_key99];}_this781=_callSuper(this,OB,[].concat(args));_defineProperty(_this781,"_styleUtils",void 0);_defineProperty(_this781,"_htmlSupport",void 0);return _this781;}_inherits(OB,_Dr238);return _createClass(OB,[{key:"init",value:function init(){var _this782=this;var e=this.editor;e.plugins.has("LinkEditing")&&(this._styleUtils=e.plugins.get(EB),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForInlineSelection",function(e,_ref310){var _ref311=_slicedToArray(_ref310,2),t=_ref311[0],i=_ref311[1];"a"==t.element&&(e["return"]=_this782._isStyleEnabled(t,i),e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForInlineSelection",function(e,_ref312){var _ref313=_slicedToArray(_ref312,2),t=_ref313[0],i=_ref313[1];"a"==t.element&&(e["return"]=_this782._isStyleActive(t,i),e.stop());},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedInlineSelectable",function(e,_ref314){var _ref315=_slicedToArray(_ref314,2),t=_ref315[0],i=_ref315[1];if("a"!=t.element)return;var n=_this782._getAffectedSelectable(t,i);n&&(e["return"]=n,e.stop());},{priority:"high"}));}},{key:"_isStyleEnabled",value:function _isStyleEnabled(e,t){var i=this.editor.model;if(t.isCollapsed)return t.hasAttribute("linkHref");var _iterator832=_createForOfIteratorHelper(t.getRanges()),_step832;try{for(_iterator832.s();!(_step832=_iterator832.n()).done;){var _e785=_step832.value;var _iterator833=_createForOfIteratorHelper(_e785.getItems()),_step833;try{for(_iterator833.s();!(_step833=_iterator833.n()).done;){var _t539=_step833.value;if((_t539.is("$textProxy")||i.schema.isInline(_t539))&&_t539.hasAttribute("linkHref"))return!0;}}catch(err){_iterator833.e(err);}finally{_iterator833.f();}}}catch(err){_iterator832.e(err);}finally{_iterator832.f();}return!1;}},{key:"_isStyleActive",value:function _isStyleActive(e,t){var i=this.editor.model,n=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(t.isCollapsed){if(t.hasAttribute("linkHref")){var _i595=t.getAttribute(n);if(this._styleUtils.hasAllClasses(_i595,e.classes))return!0;}return!1;}var _iterator834=_createForOfIteratorHelper(t.getRanges()),_step834;try{for(_iterator834.s();!(_step834=_iterator834.n()).done;){var _s219=_step834.value;var _iterator835=_createForOfIteratorHelper(_s219.getItems()),_step835;try{for(_iterator835.s();!(_step835=_iterator835.n()).done;){var _t540=_step835.value;if((_t540.is("$textProxy")||i.schema.isInline(_t540))&&_t540.hasAttribute("linkHref")){var _i596=_t540.getAttribute(n);return this._styleUtils.hasAllClasses(_i596,e.classes);}}}catch(err){_iterator835.e(err);}finally{_iterator835.f();}}}catch(err){_iterator834.e(err);}finally{_iterator834.f();}return!1;}},{key:"_getAffectedSelectable",value:function _getAffectedSelectable(e,t){var i=this.editor.model;if(t.isCollapsed){var _e786=t.getAttribute("linkHref");return Qw(t.getFirstPosition(),"linkHref",_e786,i);}var n=[];var _iterator836=_createForOfIteratorHelper(t.getRanges()),_step836;try{for(_iterator836.s();!(_step836=_iterator836.n()).done;){var _e787=_step836.value;var _t542=i.createRange(BB(_e787.start,"linkHref",!0,i),BB(_e787.end,"linkHref",!1,i));var _iterator837=_createForOfIteratorHelper(_t542.getItems()),_step837;try{for(_iterator837.s();!(_step837=_iterator837.n()).done;){var _e788=_step837.value;(_e788.is("$textProxy")||i.schema.isInline(_e788))&&_e788.hasAttribute("linkHref")&&n.push(this.editor.model.createRangeOn(_e788));}}catch(err){_iterator837.e(err);}finally{_iterator837.f();}}}catch(err){_iterator836.e(err);}finally{_iterator836.f();}return function(e){for(var _t541=1;_t541<e.length;_t541++){var _i597=e[_t541-1].getJoined(e[_t541]);_i597&&e.splice(--_t541,2,_i597);}return e;}(n);}}],[{key:"pluginName",get:function get(){return"LinkStyleSupport";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[EB,"GeneralHtmlSupport"];}}]);}(Dr);function BB(e,t,i,n){var s=e.textNode||(i?e.nodeAfter:e.nodeBefore);if(!s||!s.hasAttribute(t))return e;return Yw(e,t,s.getAttribute(t),i,n);}var MB=/*#__PURE__*/function(_Dr239){function MB(){_classCallCheck(this,MB);return _callSuper(this,MB,arguments);}_inherits(MB,_Dr239);return _createClass(MB,[{key:"init",value:function init(){var e=this.editor,t=e.plugins.get("DataSchema"),i=e.plugins.get("StyleUtils"),n=e.config.get("style.definitions"),s=i.normalizeConfig(t,n);e.commands.add("style",new SB(e,s)),i.configureGHSDataFilter(s);}}],[{key:"pluginName",get:function get(){return"StyleEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return["GeneralHtmlSupport",EB,VB,RB,OB];}}]);}(Dr);var LB=/*#__PURE__*/function(_Dr240){function LB(){_classCallCheck(this,LB);return _callSuper(this,LB,arguments);}_inherits(LB,_Dr240);return _createClass(LB,null,[{key:"pluginName",get:function get(){return"Style";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[MB,PB];}}]);}(Dr);function FB(e,t){var i=t.modelAttribute,n=t.styleName,s=t.viewElement,o=t.defaultValue,_t$reduceBoxSides=t.reduceBoxSides,r=_t$reduceBoxSides===void 0?!1:_t$reduceBoxSides,_t$shouldUpcast=t.shouldUpcast,a=_t$shouldUpcast===void 0?function(){return!0;}:_t$shouldUpcast;e["for"]("upcast").attributeToAttribute({view:{name:s,styles:_defineProperty({},n,/[\s\S]+/)},model:{key:i,value:function value(e){if(!a(e))return;var t=e.getNormalizedStyle(n),i=r?HB(t):t;return o!==i?i:void 0;}}});}function NB(e,t,i,n){e["for"]("upcast").add(function(e){return e.on("element:"+t,function(e,t,s){if(!t.modelRange)return;var o=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter(function(e){return t.viewItem.hasStyle(e);});if(!o.length)return;var r={styles:o};if(!s.consumable.test(t.viewItem,r))return;var a=_toConsumableArray(t.modelRange.getItems({shallow:!0})).pop();s.consumable.consume(t.viewItem,r);var l={style:t.viewItem.getNormalizedStyle("border-style"),color:t.viewItem.getNormalizedStyle("border-color"),width:t.viewItem.getNormalizedStyle("border-width")},c={style:HB(l.style),color:HB(l.color),width:HB(l.width)};c.style!==n.style&&s.writer.setAttribute(i.style,c.style,a),c.color!==n.color&&s.writer.setAttribute(i.color,c.color,a),c.width!==n.width&&s.writer.setAttribute(i.width,c.width,a);});});}function DB(e,t){var i=t.modelElement,n=t.modelAttribute,s=t.styleName;e["for"]("downcast").attributeToAttribute({model:{name:i,key:n},view:function view(e){return{key:"style",value:_defineProperty({},s,e)};}});}function zB(e,t){var i=t.modelAttribute,n=t.styleName;e["for"]("downcast").add(function(e){return e.on("attribute:".concat(i,":table"),function(e,t,i){var s=t.item,o=t.attributeNewValue,r=i.mapper,a=i.writer;if(!i.consumable.consume(t.item,e.name))return;var l=_toConsumableArray(r.toViewElement(s).getChildren()).find(function(e){return e.is("element","table");});o?a.setStyle(n,o,l):a.removeStyle(n,l);});});}function HB(e){if(!e)return;var t=["top","right","bottom","left"];if(!t.every(function(t){return e[t];}))return e;var i=e.top;return t.every(function(t){return e[t]===i;})?i:e;}function $B(e,t,i,n){var s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;null!=t&&null!=s&&t>s?n.setAttribute(e,t,i):n.removeAttribute(e,i);}function UB(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};var n=e.createElement("tableCell",i);return e.insertElement("paragraph",n),e.insert(n,t),n;}function WB(e,t){var i=t.parent.parent,n=parseInt(i.getAttribute("headingColumns")||"0"),_e$getCellLocation=e.getCellLocation(t),s=_e$getCellLocation.column;return!!n&&s<n;}function jB(e,t,i){var n=i.modelAttribute;e.extend("tableCell",{allowAttributes:[n]}),FB(t,_objectSpread({viewElement:/^(td|th)$/},i)),DB(t,_objectSpread({modelElement:"tableCell"},i));}function qB(e){var t=e.getSelectedElement();return t&&t.is("element","table")?t:e.getFirstPosition().findAncestor("table");}function GB(){return function(e){e.on("element:table",function(e,t,i){var n=t.viewItem;if(!i.consumable.test(n,{name:!0}))return;var _ref316=function(e){var t,i=0;var n=[],s=[];var o;for(var _i598=0,_Array$from11=Array.from(e.getChildren());_i598<_Array$from11.length;_i598++){var _r55=_Array$from11[_i598];if("tbody"!==_r55.name&&"thead"!==_r55.name&&"tfoot"!==_r55.name)continue;"thead"!==_r55.name||o||(o=_r55);var _e789=Array.from(_r55.getChildren()).filter(function(e){return e.is("element","tr");});var _iterator838=_createForOfIteratorHelper(_e789),_step838;try{for(_iterator838.s();!(_step838=_iterator838.n()).done;){var _a41=_step838.value;if(o&&_r55===o||"tbody"===_r55.name&&Array.from(_a41.getChildren()).length&&Array.from(_a41.getChildren()).every(function(e){return e.is("element","th");}))i++,n.push(_a41);else{s.push(_a41);var _e790=ZB(_a41);(!t||_e790<t)&&(t=_e790);}}}catch(err){_iterator838.e(err);}finally{_iterator838.f();}}return{headingRows:i,headingColumns:t||0,rows:[].concat(n,s)};}(n),s=_ref316.rows,o=_ref316.headingRows,r=_ref316.headingColumns,a={};r&&(a.headingColumns=r),o&&(a.headingRows=o);var l=i.writer.createElement("table",a);if(i.safeInsert(l,t.modelCursor)){if(i.consumable.consume(n,{name:!0}),s.forEach(function(e){return i.convertItem(e,i.writer.createPositionAt(l,"end"));}),i.convertChildren(n,i.writer.createPositionAt(l,"end")),l.isEmpty){var _e791=i.writer.createElement("tableRow");i.writer.insert(_e791,i.writer.createPositionAt(l,"end")),UB(i.writer,i.writer.createPositionAt(_e791,"end"));}i.updateConversionResult(l,t);}});};}function KB(e){return function(t){t.on("element:".concat(e),function(e,t,_ref317){var i=_ref317.writer;if(!t.modelRange)return;var n=t.modelRange.start.nodeAfter,s=i.createPositionAt(n,0);if(t.viewItem.isEmpty)return void i.insertElement("paragraph",s);var o=Array.from(n.getChildren());if(o.every(function(e){return e.is("element","$marker");})){var _e792=i.createElement("paragraph");i.insert(_e792,i.createPositionAt(n,0));var _iterator839=_createForOfIteratorHelper(o),_step839;try{for(_iterator839.s();!(_step839=_iterator839.n()).done;){var _t543=_step839.value;i.move(i.createRangeOn(_t543),i.createPositionAt(_e792,"end"));}}catch(err){_iterator839.e(err);}finally{_iterator839.f();}}},{priority:"low"});};}function ZB(e){var t=0,i=0;var n=Array.from(e.getChildren()).filter(function(e){return"th"===e.name||"td"===e.name;});for(;i<n.length&&"th"===n[i].name;){var _e793=n[i];t+=parseInt(_e793.getAttribute("colspan")||"1"),i++;}return t;}var JB=/*#__PURE__*/function(){function JB(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,JB);_defineProperty(this,"_table",void 0);_defineProperty(this,"_startRow",void 0);_defineProperty(this,"_endRow",void 0);_defineProperty(this,"_startColumn",void 0);_defineProperty(this,"_endColumn",void 0);_defineProperty(this,"_includeAllSlots",void 0);_defineProperty(this,"_skipRows",void 0);_defineProperty(this,"_row",void 0);_defineProperty(this,"_rowIndex",void 0);_defineProperty(this,"_column",void 0);_defineProperty(this,"_cellIndex",void 0);_defineProperty(this,"_spannedCells",void 0);_defineProperty(this,"_nextCellAtColumn",void 0);_defineProperty(this,"_jumpedToStartRow",!1);this._table=e,this._startRow=void 0!==t.row?t.row:t.startRow||0,this._endRow=void 0!==t.row?t.row:t.endRow,this._startColumn=void 0!==t.column?t.column:t.startColumn||0,this._endColumn=void 0!==t.column?t.column:t.endColumn,this._includeAllSlots=!!t.includeAllSlots,this._skipRows=new Set(),this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map(),this._nextCellAtColumn=-1;}return _createClass(JB,[{key:Symbol.iterator,value:function value(){return this;}},{key:"next",value:function next(){this._canJumpToStartRow()&&this._jumpToNonSpannedRowClosestToStartRow();var e=this._table.getChild(this._rowIndex);if(!e||this._isOverEndRow())return{done:!0,value:void 0};if(!e.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();var t=null;var i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(t=this._formatOutValue(i.cell,i.row,i.column));else{var _i599=e.getChild(this._cellIndex);if(!_i599)return this._advanceToNextRow();var _n314=parseInt(_i599.getAttribute("colspan")||"1"),_s220=parseInt(_i599.getAttribute("rowspan")||"1");(_n314>1||_s220>1)&&this._recordSpans(_i599,_s220,_n314),this._shouldSkipSlot()||(t=this._formatOutValue(_i599)),this._nextCellAtColumn=this._column+_n314;}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,t||this.next();}},{key:"skipRow",value:function skipRow(e){this._skipRows.add(e);}},{key:"_advanceToNextRow",value:function _advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next();}},{key:"_isOverEndRow",value:function _isOverEndRow(){return void 0!==this._endRow&&this._row>this._endRow;}},{key:"_isOverEndColumn",value:function _isOverEndColumn(){return void 0!==this._endColumn&&this._column>this._endColumn;}},{key:"_formatOutValue",value:function _formatOutValue(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this._row;var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:this._column;return{done:!1,value:new QB(this,e,t,i)};}},{key:"_shouldSkipSlot",value:function _shouldSkipSlot(){var e=this._skipRows.has(this._row),t=this._row<this._startRow,i=this._column<this._startColumn,n=void 0!==this._endColumn&&this._column>this._endColumn;return e||t||i||n;}},{key:"_getSpanned",value:function _getSpanned(){var e=this._spannedCells.get(this._row);return e&&e.get(this._column)||null;}},{key:"_recordSpans",value:function _recordSpans(e,t,i){var n={cell:e,row:this._row,column:this._column};for(var _e794=this._row;_e794<this._row+t;_e794++)for(var _t544=this._column;_t544<this._column+i;_t544++)_e794==this._row&&_t544==this._column||this._markSpannedCell(_e794,_t544,n);}},{key:"_markSpannedCell",value:function _markSpannedCell(e,t,i){this._spannedCells.has(e)||this._spannedCells.set(e,new Map());this._spannedCells.get(e).set(t,i);}},{key:"_canJumpToStartRow",value:function _canJumpToStartRow(){return!!this._startRow&&this._startRow>0&&!this._jumpedToStartRow;}},{key:"_jumpToNonSpannedRowClosestToStartRow",value:function _jumpToNonSpannedRowClosestToStartRow(){var e=this._getRowLength(0);for(var _t545=this._startRow;!this._jumpedToStartRow;_t545--)e===this._getRowLength(_t545)&&(this._row=_t545,this._rowIndex=_t545,this._jumpedToStartRow=!0);}},{key:"_getRowLength",value:function _getRowLength(e){return _toConsumableArray(this._table.getChild(e).getChildren()).reduce(function(e,t){return e+parseInt(t.getAttribute("colspan")||"1");},0);}}]);}();var QB=/*#__PURE__*/function(){function QB(e,t,i,n){_classCallCheck(this,QB);_defineProperty(this,"cell",void 0);_defineProperty(this,"row",void 0);_defineProperty(this,"column",void 0);_defineProperty(this,"cellAnchorRow",void 0);_defineProperty(this,"cellAnchorColumn",void 0);_defineProperty(this,"_cellIndex",void 0);_defineProperty(this,"_rowIndex",void 0);_defineProperty(this,"_table",void 0);this.cell=t,this.row=e._row,this.column=e._column,this.cellAnchorRow=i,this.cellAnchorColumn=n,this._cellIndex=e._cellIndex,this._rowIndex=e._rowIndex,this._table=e._table;}return _createClass(QB,[{key:"isAnchor",get:function get(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn;}},{key:"cellWidth",get:function get(){return parseInt(this.cell.getAttribute("colspan")||"1");}},{key:"cellHeight",get:function get(){return parseInt(this.cell.getAttribute("rowspan")||"1");}},{key:"rowIndex",get:function get(){return this._rowIndex;}},{key:"getPositionBefore",value:function getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex);}}]);}();function YB(e,t){return function(i,_ref318){var n=_ref318.writer;var s=i.getAttribute("headingRows")||0,o=n.createContainerElement("table",null,[]),r=n.createContainerElement("figure",{"class":"table"},o);s>0&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("thead",null,n.createSlot(function(e){return e.is("element","tableRow")&&e.index<s;}))),s<e.getRows(i)&&n.insert(n.createPositionAt(o,"end"),n.createContainerElement("tbody",null,n.createSlot(function(e){return e.is("element","tableRow")&&e.index>=s;})));var _iterator840=_createForOfIteratorHelper(t.additionalSlots),_step840;try{for(_iterator840.s();!(_step840=_iterator840.n()).done;){var _step840$value=_step840.value,_e795=_step840$value.positionOffset,_i600=_step840$value.filter;n.insert(n.createPositionAt(o,_e795),n.createSlot(_i600));}}catch(err){_iterator840.e(err);}finally{_iterator840.f();}return n.insert(n.createPositionAt(o,"after"),n.createSlot(function(e){return!e.is("element","tableRow")&&!t.additionalSlots.some(function(_ref319){var t=_ref319.filter;return t(e);});})),t.asWidget?function(e,t){return t.setCustomProperty("table",!0,e),oy(e,t,{hasSelectionHandle:!0});}(r,n):r;};}function XB(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return function(t,_ref320){var i=_ref320.writer;var n=t.parent,s=n.parent,o=s.getChildIndex(n),r=new JB(s,{row:o}),a=s.getAttribute("headingRows")||0,l=s.getAttribute("headingColumns")||0;var c=null;var _iterator841=_createForOfIteratorHelper(r),_step841;try{for(_iterator841.s();!(_step841=_iterator841.n()).done;){var _n315=_step841.value;if(_n315.cell==t){var _t546=_n315.row<a||_n315.column<l?"th":"td";c=e.asWidget?uy(i.createEditableElement(_t546),i):i.createContainerElement(_t546);break;}}}catch(err){_iterator841.e(err);}finally{_iterator841.f();}return c;};}function eM(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return function(t,_ref321){var i=_ref321.writer;if(!t.parent.is("element","tableCell"))return null;if(!tM(t))return null;if(e.asWidget)return i.createContainerElement("span",{"class":"ck-table-bogus-paragraph"});{var _e796=i.createContainerElement("p");return i.setCustomProperty("dataPipeline:transparentRendering",!0,_e796),_e796;}};}function tM(e){return 1==e.parent.childCount&&!!e.getAttributeKeys().next().done;}var iM=/*#__PURE__*/function(_Hr62){function iM(){_classCallCheck(this,iM);return _callSuper(this,iM,arguments);}_inherits(iM,_Hr62);return _createClass(iM,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=e.document.selection,i=e.schema;this.isEnabled=function(e,t){var i=e.getFirstPosition().parent,n=i===i.root?i:i.parent;return t.checkChild(n,"table");}(t,i);}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor,i=t.model,n=t.plugins.get("TableUtils"),s=t.config.get("table.defaultHeadings.rows"),o=t.config.get("table.defaultHeadings.columns");void 0===e.headingRows&&s&&(e.headingRows=s),void 0===e.headingColumns&&o&&(e.headingColumns=o),i.change(function(t){var s=n.createTable(t,e);i.insertObject(s,null,null,{findOptimalPosition:"auto"}),t.setSelection(t.createPositionAt(s.getNodeByPath([0,0,0]),0));});}}]);}(Hr);var nM=/*#__PURE__*/function(_Hr63){function nM(e){var _this783;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,nM);_this783=_callSuper(this,nM,[e]),_defineProperty(_assertThisInitialized(_this783),"order",void 0),_this783.order=t.order||"below";return _this783;}_inherits(nM,_Hr63);return _createClass(nM,[{key:"refresh",value:function refresh(){var e=this.editor.model.document.selection,t=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=t;}},{key:"execute",value:function execute(){var e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),n="above"===this.order,s=i.getSelectionAffectedTableCells(t),o=i.getRowIndexes(s),r=n?o.first:o.last,a=s[0].findAncestor("table");i.insertRows(a,{at:n?r:r+1,copyStructureFromAbove:!n});}}]);}(Hr);var sM=/*#__PURE__*/function(_Hr64){function sM(e){var _this784;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,sM);_this784=_callSuper(this,sM,[e]),_defineProperty(_assertThisInitialized(_this784),"order",void 0),_this784.order=t.order||"right";return _this784;}_inherits(sM,_Hr64);return _createClass(sM,[{key:"refresh",value:function refresh(){var e=this.editor.model.document.selection,t=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=t;}},{key:"execute",value:function execute(){var e=this.editor,t=e.model.document.selection,i=e.plugins.get("TableUtils"),n="left"===this.order,s=i.getSelectionAffectedTableCells(t),o=i.getColumnIndexes(s),r=n?o.first:o.last,a=s[0].findAncestor("table");i.insertColumns(a,{columns:1,at:n?r:r+1});}}]);}(Hr);var oM=/*#__PURE__*/function(_Hr65){function oM(e){var _this785;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,oM);_this785=_callSuper(this,oM,[e]),_defineProperty(_assertThisInitialized(_this785),"direction",void 0),_this785.direction=t.direction||"horizontally";return _this785;}_inherits(oM,_Hr65);return _createClass(oM,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=1===e.length;}},{key:"execute",value:function execute(){var e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];"horizontally"===this.direction?e.splitCellHorizontally(t,2):e.splitCellVertically(t,2);}}]);}(Hr);function rM(e,t,i){var n=t.startRow,s=t.startColumn,o=t.endRow,r=t.endColumn,a=i.createElement("table"),l=o-n+1;for(var _e797=0;_e797<l;_e797++)i.insertElement("tableRow",a,"end");var c=_toConsumableArray(new JB(e,{startRow:n,endRow:o,startColumn:s,endColumn:r,includeAllSlots:!0}));var _iterator842=_createForOfIteratorHelper(c),_step842;try{for(_iterator842.s();!(_step842=_iterator842.n()).done;){var _step842$value=_step842.value,_e798=_step842$value.row,_t547=_step842$value.column,_l28=_step842$value.cell,_d10=_step842$value.isAnchor,_u9=_step842$value.cellAnchorRow,_h6=_step842$value.cellAnchorColumn;var _c19=_e798-n,_m5=a.getChild(_c19);if(_d10){var _n316=i.cloneElement(_l28);i.append(_n316,_m5),uM(_n316,_e798,_t547,o,r,i);}else(_u9<n||_h6<s)&&UB(i,i.createPositionAt(_m5,"end"));}}catch(err){_iterator842.e(err);}finally{_iterator842.f();}return function(e,t,i,n,s){var o=parseInt(t.getAttribute("headingRows")||"0");if(o>0){$B("headingRows",o-i,e,s,0);}var r=parseInt(t.getAttribute("headingColumns")||"0");if(r>0){$B("headingColumns",r-n,e,s,0);}}(a,e,n,s,i),a;}function aM(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var n=[],s=new JB(e,{startRow:i,endRow:t-1});var _iterator843=_createForOfIteratorHelper(s),_step843;try{for(_iterator843.s();!(_step843=_iterator843.n()).done;){var _e799=_step843.value;var _i601=_e799.row,_s221=_e799.cellHeight;_i601<t&&t<=_i601+_s221-1&&n.push(_e799);}}catch(err){_iterator843.e(err);}finally{_iterator843.f();}return n;}function lM(e,t,i){var n=e.parent,s=n.parent,o=n.index,r=t-o,a={},l=parseInt(e.getAttribute("rowspan"))-r;l>1&&(a.rowspan=l);var c=parseInt(e.getAttribute("colspan")||"1");c>1&&(a.colspan=c);var d=o+r,u=_toConsumableArray(new JB(s,{startRow:o,endRow:d,includeAllSlots:!0}));var h,m=null;var _iterator844=_createForOfIteratorHelper(u),_step844;try{for(_iterator844.s();!(_step844=_iterator844.n()).done;){var _t548=_step844.value;var _n317=_t548.row,_s222=_t548.column,_o129=_t548.cell;_o129===e&&void 0===h&&(h=_s222),void 0!==h&&h===_s222&&_n317===d&&(m=UB(i,_t548.getPositionBefore(),a));}}catch(err){_iterator844.e(err);}finally{_iterator844.f();}return $B("rowspan",r,e,i),m;}function cM(e,t){var i=[],n=new JB(e);var _iterator845=_createForOfIteratorHelper(n),_step845;try{for(_iterator845.s();!(_step845=_iterator845.n()).done;){var _e800=_step845.value;var _n318=_e800.column,_s223=_e800.cellWidth;_n318<t&&t<=_n318+_s223-1&&i.push(_e800);}}catch(err){_iterator845.e(err);}finally{_iterator845.f();}return i;}function dM(e,t,i,n){var s=i-t,o={},r=parseInt(e.getAttribute("colspan"))-s;r>1&&(o.colspan=r);var a=parseInt(e.getAttribute("rowspan")||"1");a>1&&(o.rowspan=a);var l=UB(n,n.createPositionAfter(e),o);return $B("colspan",s,e,n),l;}function uM(e,t,i,n,s,o){var r=parseInt(e.getAttribute("colspan")||"1"),a=parseInt(e.getAttribute("rowspan")||"1");if(i+r-1>s){$B("colspan",s-i+1,e,o,1);}if(t+a-1>n){$B("rowspan",n-t+1,e,o,1);}}function hM(e,t){var i=t.getColumns(e),n=new Array(i).fill(0);var _iterator846=_createForOfIteratorHelper(new JB(e)),_step846;try{for(_iterator846.s();!(_step846=_iterator846.n()).done;){var _t549=_step846.value.column;n[_t549]++;}}catch(err){_iterator846.e(err);}finally{_iterator846.f();}var s=n.reduce(function(e,t,i){return t?e:[].concat(_toConsumableArray(e),[i]);},[]);if(s.length>0){var _i602=s[s.length-1];return t.removeColumns(e,{at:_i602}),!0;}return!1;}function mM(e,t){var i=[],n=t.getRows(e);for(var _t550=0;_t550<n;_t550++){e.getChild(_t550).isEmpty&&i.push(_t550);}if(i.length>0){var _n319=i[i.length-1];return t.removeRows(e,{at:_n319}),!0;}return!1;}function gM(e,t){hM(e,t)||mM(e,t);}function fM(e,t){var i=Array.from(new JB(e,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow}));if(i.every(function(_ref322){var e=_ref322.cellHeight;return 1===e;}))return t.lastRow;var n=i[0].cellHeight-1;return t.lastRow+n;}function pM(e,t){var i=Array.from(new JB(e,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn}));if(i.every(function(_ref323){var e=_ref323.cellWidth;return 1===e;}))return t.lastColumn;var n=i[0].cellWidth-1;return t.lastColumn+n;}var bM=/*#__PURE__*/function(_Hr66){function bM(e,t){var _this786;_classCallCheck(this,bM);_this786=_callSuper(this,bM,[e]),_defineProperty(_assertThisInitialized(_this786),"direction",void 0),_defineProperty(_assertThisInitialized(_this786),"isHorizontal",void 0),_this786.direction=t.direction,_this786.isHorizontal="right"==_this786.direction||"left"==_this786.direction;return _this786;}_inherits(bM,_Hr66);return _createClass(bM,[{key:"refresh",value:function refresh(){var e=this._getMergeableCell();this.value=e,this.isEnabled=!!e;}},{key:"execute",value:function execute(){var _this787=this;var e=this.editor.model,t=e.document,i=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(t.selection)[0],n=this.value,s=this.direction;e.change(function(e){var t="right"==s||"down"==s,o=t?i:n,r=t?n:i,a=r.parent;!function(e,t,i){wM(e)||(wM(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end")));i.remove(e);}(r,o,e);var l=_this787.isHorizontal?"colspan":"rowspan",c=parseInt(i.getAttribute(l)||"1"),d=parseInt(n.getAttribute(l)||"1");e.setAttribute(l,c+d,o),e.setSelection(e.createRangeIn(o));var u=_this787.editor.plugins.get("TableUtils");gM(a.findAncestor("table"),u);});}},{key:"_getMergeableCell",value:function _getMergeableCell(){var e=this.editor.model.document,t=this.editor.plugins.get("TableUtils"),i=t.getTableCellsContainingSelection(e.selection)[0];if(!i)return;var n=this.isHorizontal?function(e,t,i){var n=e.parent,s=n.parent,o="right"==t?e.nextSibling:e.previousSibling,r=(s.getAttribute("headingColumns")||0)>0;if(!o)return;var a="right"==t?e:o,l="right"==t?o:e,_i$getCellLocation=i.getCellLocation(a),c=_i$getCellLocation.column,_i$getCellLocation2=i.getCellLocation(l),d=_i$getCellLocation2.column,u=parseInt(a.getAttribute("colspan")||"1"),h=WB(i,a),m=WB(i,l);if(r&&h!=m)return;return c+u===d?o:void 0;}(i,this.direction,t):function(e,t,i){var n=e.parent,s=n.parent,o=s.getChildIndex(n);if("down"==t&&o===i.getRows(s)-1||"up"==t&&0===o)return null;var r=parseInt(e.getAttribute("rowspan")||"1"),a=s.getAttribute("headingRows")||0,l="down"==t&&o+r===a,c="up"==t&&o===a;if(a&&(l||c))return null;var d=parseInt(e.getAttribute("rowspan")||"1"),u="down"==t?o+d:o,h=_toConsumableArray(new JB(s,{endRow:u})),m=h.find(function(t){return t.cell===e;}),g=m.column,f=h.find(function(_ref324){var e=_ref324.row,i=_ref324.cellHeight,n=_ref324.column;return n===g&&("down"==t?e===u:u===e+i);});return f&&f.cell?f.cell:null;}(i,this.direction,t);if(!n)return;var s=this.isHorizontal?"rowspan":"colspan",o=parseInt(i.getAttribute(s)||"1");return parseInt(n.getAttribute(s)||"1")===o?n:void 0;}}]);}(Hr);function wM(e){var t=e.getChild(0);return 1==e.childCount&&t.is("element","paragraph")&&t.isEmpty;}var _M=/*#__PURE__*/function(_Hr67){function _M(){_classCallCheck(this,_M);return _callSuper(this,_M,arguments);}_inherits(_M,_Hr67);return _createClass(_M,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),i=t[0];if(i){var _n320=i.findAncestor("table"),_s224=e.getRows(_n320)-1,_o130=e.getRowIndexes(t),r=0===_o130.first&&_o130.last===_s224;this.isEnabled=!r;}else this.isEnabled=!1;}},{key:"execute",value:function execute(){var e=this.editor.model,t=this.editor.plugins.get("TableUtils"),i=t.getSelectionAffectedTableCells(e.document.selection),n=t.getRowIndexes(i),s=i[0],o=s.findAncestor("table"),r=t.getCellLocation(s).column;e.change(function(e){var i=n.last-n.first+1;t.removeRows(o,{at:n.first,rows:i});var s=function(e,t,i,n){var s=e.getChild(Math.min(t,n-1));var o=s.getChild(0),r=0;var _iterator847=_createForOfIteratorHelper(s.getChildren()),_step847;try{for(_iterator847.s();!(_step847=_iterator847.n()).done;){var _e801=_step847.value;if(r>i)return o;o=_e801,r+=parseInt(_e801.getAttribute("colspan")||"1");}}catch(err){_iterator847.e(err);}finally{_iterator847.f();}return o;}(o,n.first,r,t.getRows(o));e.setSelection(e.createPositionAt(s,0));});}}]);}(Hr);var vM=/*#__PURE__*/function(_Hr68){function vM(){_classCallCheck(this,vM);return _callSuper(this,vM,arguments);}_inherits(vM,_Hr68);return _createClass(vM,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("TableUtils"),t=e.getSelectionAffectedTableCells(this.editor.model.document.selection),i=t[0];if(i){var _n321=i.findAncestor("table"),_s225=e.getColumns(_n321),_e$getColumnIndexes=e.getColumnIndexes(t),_o131=_e$getColumnIndexes.first,r=_e$getColumnIndexes.last;this.isEnabled=r-_o131<_s225-1;}else this.isEnabled=!1;}},{key:"execute",value:function execute(){var e=this.editor.plugins.get("TableUtils"),_ref325=function(e,t){var i=t.getSelectionAffectedTableCells(e),n=i[0],s=i.pop(),o=[n,s];return n.isBefore(s)?o:o.reverse();}(this.editor.model.document.selection,e),_ref326=_slicedToArray(_ref325,2),t=_ref326[0],i=_ref326[1],n=t.parent.parent,s=_toConsumableArray(new JB(n)),o={first:s.find(function(e){return e.cell===t;}).column,last:s.find(function(e){return e.cell===i;}).column},r=function(e,t,i,n){var s=parseInt(i.getAttribute("colspan")||"1");return s>1?i:t.previousSibling||i.nextSibling?i.nextSibling||t.previousSibling:n.first?e.reverse().find(function(_ref327){var e=_ref327.column;return e<n.first;}).cell:e.reverse().find(function(_ref328){var e=_ref328.column;return e>n.last;}).cell;}(s,t,i,o);this.editor.model.change(function(t){var i=o.last-o.first+1;e.removeColumns(n,{at:o.first,columns:i}),t.setSelection(t.createPositionAt(r,0));});}}]);}(Hr);var yM=/*#__PURE__*/function(_Hr69){function yM(){_classCallCheck(this,yM);return _callSuper(this,yM,arguments);}_inherits(yM,_Hr69);return _createClass(yM,[{key:"refresh",value:function refresh(){var _this788=this;var e=this.editor.plugins.get("TableUtils"),t=this.editor.model,i=e.getSelectionAffectedTableCells(t.document.selection),n=i.length>0;this.isEnabled=n,this.value=n&&i.every(function(e){return _this788._isInHeading(e,e.parent.parent);});}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(e.forceValue===this.value)return;var t=this.editor.plugins.get("TableUtils"),i=this.editor.model,n=t.getSelectionAffectedTableCells(i.document.selection),s=n[0].findAncestor("table"),_t$getRowIndexes=t.getRowIndexes(n),o=_t$getRowIndexes.first,r=_t$getRowIndexes.last,a=this.value?o:r+1,l=s.getAttribute("headingRows")||0;i.change(function(e){if(a){var _t551=aM(s,a,a>l?l:0);var _iterator848=_createForOfIteratorHelper(_t551),_step848;try{for(_iterator848.s();!(_step848=_iterator848.n()).done;){var _i603=_step848.value.cell;lM(_i603,a,e);}}catch(err){_iterator848.e(err);}finally{_iterator848.f();}}$B("headingRows",a,s,e,0);});}},{key:"_isInHeading",value:function _isInHeading(e,t){var i=parseInt(t.getAttribute("headingRows")||"0");return!!i&&e.parent.index<i;}}]);}(Hr);var kM=/*#__PURE__*/function(_Hr70){function kM(){_classCallCheck(this,kM);return _callSuper(this,kM,arguments);}_inherits(kM,_Hr70);return _createClass(kM,[{key:"refresh",value:function refresh(){var e=this.editor.model,t=this.editor.plugins.get("TableUtils"),i=t.getSelectionAffectedTableCells(e.document.selection),n=i.length>0;this.isEnabled=n,this.value=n&&i.every(function(e){return WB(t,e);});}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};if(e.forceValue===this.value)return;var t=this.editor.plugins.get("TableUtils"),i=this.editor.model,n=t.getSelectionAffectedTableCells(i.document.selection),s=n[0].findAncestor("table"),_t$getColumnIndexes=t.getColumnIndexes(n),o=_t$getColumnIndexes.first,r=_t$getColumnIndexes.last,a=this.value?o:r+1;i.change(function(e){if(a){var _t552=cM(s,a);var _iterator849=_createForOfIteratorHelper(_t552),_step849;try{for(_iterator849.s();!(_step849=_iterator849.n()).done;){var _step849$value=_step849.value,_i604=_step849$value.cell,_n322=_step849$value.column;dM(_i604,_n322,a,e);}}catch(err){_iterator849.e(err);}finally{_iterator849.f();}}$B("headingColumns",a,s,e,0);});}}]);}(Hr);function CM(e,t){return 4e3/xM(e,t);}function xM(e,t){var i=AM(e,"tbody",t)||AM(e,"thead",t);return EM(t.editing.view.domConverter.mapViewToDom(i));}function AM(e,t,i){return _toConsumableArray(_toConsumableArray(i.editing.mapper.toViewElement(e).getChildren()).find(function(e){return e.is("element","table");}).getChildren()).find(function(e){return e.is("element",t);});}function EM(e){var t=i.window.getComputedStyle(e);return"border-box"===t.boxSizing?parseFloat(t.width)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderLeftWidth)-parseFloat(t.borderRightWidth):parseFloat(t.width);}function TM(e){var t=Math.pow(10,2),i="number"==typeof e?e:parseFloat(e);return Math.round(i*t)/t;}function PM(e){return e.map(function(e){return"number"==typeof e?e:parseFloat(e);}).filter(function(e){return!Number.isNaN(e);}).reduce(function(e,t){return e+t;},0);}function SM(e){var t=function(e){var t=e.filter(function(e){return"auto"===e;}).length;if(0===t)return e.map(function(e){return TM(e);});var i=PM(e),n=Math.max((100-i)/t,5);return e.map(function(e){return"auto"===e?n:e;}).map(function(e){return TM(e);});}(e.map(function(e){return"auto"===e?e:parseFloat(e.replace("%",""));}));var i=PM(t);return 100!==i&&(t=t.map(function(e){return TM(100*e/i);}).map(function(e,t,i){if(!(t===i.length-1))return e;return TM(e+100-PM(i));})),t.map(function(e){return e+"%";});}function IM(e){var t=i.window.getComputedStyle(e);return"border-box"===t.boxSizing?parseInt(t.width):parseFloat(t.width)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.borderWidth);}function VM(e,t,i,n){for(var _s226=0;_s226<Math.max(i.length,e.length);_s226++){var _o132=e[_s226],r=i[_s226];r?_o132?n.setAttribute("columnWidth",r,_o132):n.appendElement("tableColumn",{columnWidth:r},t):n.remove(_o132);}}function RM(e){if(e.is("element","tableColumnGroup"))return e;var t=e.getChildren();return Array.from(t).find(function(e){return e.is("element","tableColumnGroup");});}function OM(e){var t=RM(e);return t?Array.from(t.getChildren()):[];}var BM=/*#__PURE__*/function(_Dr241){function BM(){_classCallCheck(this,BM);return _callSuper(this,BM,arguments);}_inherits(BM,_Dr241);return _createClass(BM,[{key:"init",value:function init(){this.decorate("insertColumns"),this.decorate("insertRows");}},{key:"getCellLocation",value:function getCellLocation(e){var t=e.parent,i=t.parent,n=i.getChildIndex(t),s=new JB(i,{row:n});var _iterator850=_createForOfIteratorHelper(s),_step850;try{for(_iterator850.s();!(_step850=_iterator850.n()).done;){var _step850$value=_step850.value,_t553=_step850$value.cell,_i605=_step850$value.row,_n323=_step850$value.column;if(_t553===e)return{row:_i605,column:_n323};}}catch(err){_iterator850.e(err);}finally{_iterator850.f();}}},{key:"createTable",value:function createTable(e,t){var i=e.createElement("table"),n=t.rows||2,s=t.columns||2;return MM(e,i,0,n,s),t.headingRows&&$B("headingRows",Math.min(t.headingRows,n),i,e,0),t.headingColumns&&$B("headingColumns",Math.min(t.headingColumns,s),i,e,0),i;}},{key:"insertRows",value:function insertRows(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.editor.model,n=t.at||0,s=t.rows||1,o=void 0!==t.copyStructureFromAbove,r=t.copyStructureFromAbove?n-1:n,a=this.getRows(e),l=this.getColumns(e);if(n>a)throw new A("tableutils-insertrows-insert-out-of-range",this,{options:t});i.change(function(t){var i=e.getAttribute("headingRows")||0;if(i>n&&$B("headingRows",i+s,e,t,0),!o&&(0===n||n===a))return void MM(t,e,n,s,l);var c=o?Math.max(n,r):n,d=new JB(e,{endRow:c}),u=new Array(l).fill(1);var _iterator851=_createForOfIteratorHelper(d),_step851;try{for(_iterator851.s();!(_step851=_iterator851.n()).done;){var _step851$value=_step851.value,_e803=_step851$value.row,_i608=_step851$value.column,_a42=_step851$value.cellHeight,_l29=_step851$value.cellWidth,_c20=_step851$value.cell;var _d11=_e803+_a42-1,_h7=_e803<=r&&r<=_d11;_e803<n&&n<=_d11?(t.setAttribute("rowspan",_a42+s,_c20),u[_i608]=-_l29):o&&_h7&&(u[_i608]=_l29);}}catch(err){_iterator851.e(err);}finally{_iterator851.f();}for(var _i606=0;_i606<s;_i606++){var _i607=t.createElement("tableRow");t.insert(_i607,e,n);for(var _e802=0;_e802<u.length;_e802++){var _n324=u[_e802],_s227=t.createPositionAt(_i607,"end");_n324>0&&UB(t,_s227,_n324>1?{colspan:_n324}:void 0),_e802+=Math.abs(_n324)-1;}}});}},{key:"insertColumns",value:function insertColumns(e){var _this789=this;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=this.editor.model,n=t.at||0,s=t.columns||1;i.change(function(t){var i=e.getAttribute("headingColumns");n<i&&t.setAttribute("headingColumns",i+s,e);var o=_this789.getColumns(e);if(0===n||o===n){var _iterator852=_createForOfIteratorHelper(e.getChildren()),_step852;try{for(_iterator852.s();!(_step852=_iterator852.n()).done;){var _i609=_step852.value;_i609.is("element","tableRow")&&LM(s,t,t.createPositionAt(_i609,n?"end":0));}}catch(err){_iterator852.e(err);}finally{_iterator852.f();}return;}var r=new JB(e,{column:n,includeAllSlots:!0});var _iterator853=_createForOfIteratorHelper(r),_step853;try{for(_iterator853.s();!(_step853=_iterator853.n()).done;){var _e804=_step853.value;var _i610=_e804.row,_o133=_e804.cell,_a43=_e804.cellAnchorColumn,_l30=_e804.cellAnchorRow,_c21=_e804.cellWidth,_d12=_e804.cellHeight;if(_a43<n){t.setAttribute("colspan",_c21+s,_o133);var _e805=_l30+_d12-1;for(var _t554=_i610;_t554<=_e805;_t554++)r.skipRow(_t554);}else LM(s,t,_e804.getPositionBefore());}}catch(err){_iterator853.e(err);}finally{_iterator853.f();}});}},{key:"removeRows",value:function removeRows(e,t){var _this790=this;var i=this.editor.model,n=t.rows||1,s=this.getRows(e),o=t.at,r=o+n-1;if(r>s-1)throw new A("tableutils-removerows-row-index-out-of-range",this,{table:e,options:t});i.change(function(t){var i={first:o,last:r},_ref329=function(e,_ref330){var t=_ref330.first,i=_ref330.last;var n=new Map(),s=[];var _iterator854=_createForOfIteratorHelper(new JB(e,{endRow:i})),_step854;try{for(_iterator854.s();!(_step854=_iterator854.n()).done;){var _step854$value=_step854.value,_o134=_step854$value.row,_r56=_step854$value.column,_a44=_step854$value.cellHeight,_l31=_step854$value.cell;var _e806=_o134+_a44-1;if(_o134>=t&&_o134<=i&&_e806>i){var _e807=_a44-(i-_o134+1);n.set(_r56,{cell:_l31,rowspan:_e807});}if(_o134<t&&_e806>=t){var _n325=void 0;_n325=_e806>=i?i-t+1:_e806-t+1,s.push({cell:_l31,rowspan:_a44-_n325});}}}catch(err){_iterator854.e(err);}finally{_iterator854.f();}return{cellsToMove:n,cellsToTrim:s};}(e,i),n=_ref329.cellsToMove,s=_ref329.cellsToTrim;if(n.size){!function(e,t,i,n){var s=new JB(e,{includeAllSlots:!0,row:t}),o=_toConsumableArray(s),r=e.getChild(t);var a;var _iterator855=_createForOfIteratorHelper(o),_step855;try{for(_iterator855.s();!(_step855=_iterator855.n()).done;){var _step855$value=_step855.value,_e808=_step855$value.column,_t555=_step855$value.cell,_s228=_step855$value.isAnchor;if(i.has(_e808)){var _i$get=i.get(_e808),_t556=_i$get.cell,_s229=_i$get.rowspan,_o135=a?n.createPositionAfter(a):n.createPositionAt(r,0);n.move(n.createRangeOn(_t556),_o135),$B("rowspan",_s229,_t556,n),a=_t556;}else _s228&&(a=_t555);}}catch(err){_iterator855.e(err);}finally{_iterator855.f();}}(e,r+1,n,t);}for(var _i611=r;_i611>=o;_i611--)t.remove(e.getChild(_i611));var _iterator856=_createForOfIteratorHelper(s),_step856;try{for(_iterator856.s();!(_step856=_iterator856.n()).done;){var _step856$value=_step856.value,_e809=_step856$value.rowspan,_i612=_step856$value.cell;$B("rowspan",_e809,_i612,t);}}catch(err){_iterator856.e(err);}finally{_iterator856.f();}!function(e,_ref331,n){var t=_ref331.first,i=_ref331.last;var s=e.getAttribute("headingRows")||0;if(t<s){$B("headingRows",i<s?s-(i-t+1):t,e,n,0);}}(e,i,t),hM(e,_this790)||mM(e,_this790);});}},{key:"removeColumns",value:function removeColumns(e,t){var _this791=this;var i=this.editor.model,n=t.at,s=t.columns||1,o=t.at+s-1;i.change(function(t){!function(e,t,i){var n=e.getAttribute("headingColumns")||0;if(n&&t.first<n){var _s230=Math.min(n-1,t.last)-t.first+1;i.setAttribute("headingColumns",n-_s230,e);}}(e,{first:n,last:o},t);var i=OM(e);for(var _s231=o;_s231>=n;_s231--){for(var _i613=0,_arr8=_toConsumableArray(new JB(e));_i613<_arr8.length;_i613++){var _arr8$_i=_arr8[_i613],_i614=_arr8$_i.cell,_n326=_arr8$_i.column,_o136=_arr8$_i.cellWidth;_n326<=_s231&&_o136>1&&_n326+_o136>_s231?$B("colspan",_o136-1,_i614,t):_n326===_s231&&t.remove(_i614);}if(i[_s231]){var _e810=0===_s231?i[1]:i[_s231-1],_n327=parseFloat(i[_s231].getAttribute("columnWidth")),_o137=parseFloat(_e810.getAttribute("columnWidth"));t.remove(i[_s231]),t.setAttribute("columnWidth",_n327+_o137+"%",_e810);}}mM(e,_this791)||hM(e,_this791);});}},{key:"splitCellVertically",value:function splitCellVertically(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;var i=this.editor.model,n=e.parent.parent,s=parseInt(e.getAttribute("rowspan")||"1"),o=parseInt(e.getAttribute("colspan")||"1");i.change(function(i){if(o>1){var _FM=FM(o,t),_n328=_FM.newCellsSpan,r=_FM.updatedSpan;$B("colspan",r,e,i);var _a45={};_n328>1&&(_a45.colspan=_n328),s>1&&(_a45.rowspan=s);LM(o>t?t-1:o-1,i,i.createPositionAfter(e),_a45);}if(o<t){var _r57=t-o,_a46=_toConsumableArray(new JB(n)),_a$find=_a46.find(function(_ref332){var t=_ref332.cell;return t===e;}),_l32=_a$find.column,_c22=_a46.filter(function(_ref333){var t=_ref333.cell,i=_ref333.cellWidth,n=_ref333.column;return t!==e&&n===_l32||n<_l32&&n+i>_l32;});var _iterator857=_createForOfIteratorHelper(_c22),_step857;try{for(_iterator857.s();!(_step857=_iterator857.n()).done;){var _step857$value=_step857.value,_e811=_step857$value.cell,_t557=_step857$value.cellWidth;i.setAttribute("colspan",_t557+_r57,_e811);}}catch(err){_iterator857.e(err);}finally{_iterator857.f();}var _d13={};s>1&&(_d13.rowspan=s),LM(_r57,i,i.createPositionAfter(e),_d13);var _u10=n.getAttribute("headingColumns")||0;_u10>_l32&&$B("headingColumns",_u10+_r57,n,i);}});}},{key:"splitCellHorizontally",value:function splitCellHorizontally(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:2;var i=this.editor.model,n=e.parent,s=n.parent,o=s.getChildIndex(n),r=parseInt(e.getAttribute("rowspan")||"1"),a=parseInt(e.getAttribute("colspan")||"1");i.change(function(i){if(r>1){var _n329=_toConsumableArray(new JB(s,{startRow:o,endRow:o+r-1,includeAllSlots:!0})),_FM2=FM(r,t),_l33=_FM2.newCellsSpan,_c23=_FM2.updatedSpan;$B("rowspan",_c23,e,i);var _n329$find=_n329.find(function(_ref334){var t=_ref334.cell;return t===e;}),_d14=_n329$find.column,_u11={};_l33>1&&(_u11.rowspan=_l33),a>1&&(_u11.colspan=a);var _h8=0;var _iterator858=_createForOfIteratorHelper(_n329),_step858;try{for(_iterator858.s();!(_step858=_iterator858.n()).done;){var _e812=_step858.value;var _t558=_e812.column,_n330=_e812.row,_s232=_t558===_d14;_h8>=_l33&&_s232&&(_h8=0),_n330>=o+_c23&&_s232&&(_h8||LM(1,i,_e812.getPositionBefore(),_u11),_h8++);}}catch(err){_iterator858.e(err);}finally{_iterator858.f();}}if(r<t){var _n331=t-r,_l34=_toConsumableArray(new JB(s,{startRow:0,endRow:o}));var _iterator859=_createForOfIteratorHelper(_l34),_step859;try{for(_iterator859.s();!(_step859=_iterator859.n()).done;){var _step859$value=_step859.value,_t559=_step859$value.cell,_s233=_step859$value.cellHeight,_r58=_step859$value.row;if(_t559!==e&&_r58+_s233>o){var _e813=_s233+_n331;i.setAttribute("rowspan",_e813,_t559);}}}catch(err){_iterator859.e(err);}finally{_iterator859.f();}var _c24={};a>1&&(_c24.colspan=a),MM(i,s,o+1,_n331,1,_c24);var _d15=s.getAttribute("headingRows")||0;_d15>o&&$B("headingRows",_d15+_n331,s,i);}});}},{key:"getColumns",value:function getColumns(e){return _toConsumableArray(e.getChild(0).getChildren()).filter(function(e){return e.is("element","tableCell");}).reduce(function(e,t){return e+parseInt(t.getAttribute("colspan")||"1");},0);}},{key:"getRows",value:function getRows(e){return Array.from(e.getChildren()).reduce(function(e,t){return t.is("element","tableRow")?e+1:e;},0);}},{key:"createTableWalker",value:function createTableWalker(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new JB(e,t);}},{key:"getSelectedTableCells",value:function getSelectedTableCells(e){var t=[];var _iterator860=_createForOfIteratorHelper(this.sortRanges(e.getRanges())),_step860;try{for(_iterator860.s();!(_step860=_iterator860.n()).done;){var _i615=_step860.value;var _e814=_i615.getContainedElement();_e814&&_e814.is("element","tableCell")&&t.push(_e814);}}catch(err){_iterator860.e(err);}finally{_iterator860.f();}return t;}},{key:"getTableCellsContainingSelection",value:function getTableCellsContainingSelection(e){var t=[];var _iterator861=_createForOfIteratorHelper(e.getRanges()),_step861;try{for(_iterator861.s();!(_step861=_iterator861.n()).done;){var _i616=_step861.value;var _e815=_i616.start.findAncestor("tableCell");_e815&&t.push(_e815);}}catch(err){_iterator861.e(err);}finally{_iterator861.f();}return t;}},{key:"getSelectionAffectedTableCells",value:function getSelectionAffectedTableCells(e){var t=this.getSelectedTableCells(e);return t.length?t:this.getTableCellsContainingSelection(e);}},{key:"getRowIndexes",value:function getRowIndexes(e){var t=e.map(function(e){return e.parent.index;});return this._getFirstLastIndexesObject(t);}},{key:"getColumnIndexes",value:function getColumnIndexes(e){var t=e[0].findAncestor("table"),i=_toConsumableArray(new JB(t)).filter(function(t){return e.includes(t.cell);}).map(function(e){return e.column;});return this._getFirstLastIndexesObject(i);}},{key:"isSelectionRectangular",value:function isSelectionRectangular(e){if(e.length<2||!this._areCellInTheSameTableSection(e))return!1;var t=new Set(),i=new Set();var n=0;var _iterator862=_createForOfIteratorHelper(e),_step862;try{for(_iterator862.s();!(_step862=_iterator862.n()).done;){var _s234=_step862.value;var _this$getCellLocation=this.getCellLocation(_s234),_e816=_this$getCellLocation.row,_o138=_this$getCellLocation.column,r=parseInt(_s234.getAttribute("rowspan"))||1,_a47=parseInt(_s234.getAttribute("colspan"))||1;t.add(_e816),i.add(_o138),r>1&&t.add(_e816+r-1),_a47>1&&i.add(_o138+_a47-1),n+=r*_a47;}}catch(err){_iterator862.e(err);}finally{_iterator862.f();}var s=function(e,t){var i=Array.from(e.values()),n=Array.from(t.values()),s=Math.max.apply(Math,i),o=Math.min.apply(Math,i),r=Math.max.apply(Math,n),a=Math.min.apply(Math,n);return(s-o+1)*(r-a+1);}(t,i);return s==n;}},{key:"sortRanges",value:function sortRanges(e){return Array.from(e).sort(NM);}},{key:"_getFirstLastIndexesObject",value:function _getFirstLastIndexesObject(e){var t=e.sort(function(e,t){return e-t;});return{first:t[0],last:t[t.length-1]};}},{key:"_areCellInTheSameTableSection",value:function _areCellInTheSameTableSection(e){var t=e[0].findAncestor("table"),i=this.getRowIndexes(e),n=parseInt(t.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(i,n))return!1;var s=this.getColumnIndexes(e),o=parseInt(t.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(s,o);}},{key:"_areIndexesInSameSection",value:function _areIndexesInSameSection(_ref335,i){var e=_ref335.first,t=_ref335.last;return e<i===t<i;}}],[{key:"pluginName",get:function get(){return"TableUtils";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function MM(e,t,i,n,s){var o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{};for(var r=0;r<n;r++){var _n332=e.createElement("tableRow");e.insert(_n332,t,i),LM(s,e,e.createPositionAt(_n332,"end"),o);}}function LM(e,t,i){var n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};for(var _s235=0;_s235<e;_s235++)UB(t,i,n);}function FM(e,t){if(e<t)return{newCellsSpan:1,updatedSpan:1};var i=Math.floor(e/t);return{newCellsSpan:i,updatedSpan:e-i*t+i};}function NM(e,t){var i=e.start,n=t.start;return i.isBefore(n)?-1:1;}var DM=/*#__PURE__*/function(_Hr71){function DM(){_classCallCheck(this,DM);return _callSuper(this,DM,arguments);}_inherits(DM,_Hr71);return _createClass(DM,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get(BM),t=e.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=e.isSelectionRectangular(t);}},{key:"execute",value:function execute(){var e=this.editor.model,t=this.editor.plugins.get(BM);e.change(function(i){var n=t.getSelectedTableCells(e.document.selection),s=n.shift(),_ref336=function(e,t,i){var n=0,s=0;var _iterator863=_createForOfIteratorHelper(t),_step863;try{for(_iterator863.s();!(_step863=_iterator863.n()).done;){var _e817=_step863.value;var _i$getCellLocation4=i.getCellLocation(_e817),_t560=_i$getCellLocation4.row,_o139=_i$getCellLocation4.column;n=$M(_e817,_o139,n,"colspan"),s=$M(_e817,_t560,s,"rowspan");}}catch(err){_iterator863.e(err);}finally{_iterator863.f();}var _i$getCellLocation3=i.getCellLocation(e),o=_i$getCellLocation3.row,r=_i$getCellLocation3.column,a=n-r,l=s-o;return{mergeWidth:a,mergeHeight:l};}(s,n,t),o=_ref336.mergeWidth,r=_ref336.mergeHeight;$B("colspan",o,s,i),$B("rowspan",r,s,i);var _iterator864=_createForOfIteratorHelper(n),_step864;try{for(_iterator864.s();!(_step864=_iterator864.n()).done;){var _e818=_step864.value;zM(_e818,s,i);}}catch(err){_iterator864.e(err);}finally{_iterator864.f();}gM(s.findAncestor("table"),t),i.setSelection(s,"in");});}}]);}(Hr);function zM(e,t,i){HM(e)||(HM(t)&&i.remove(i.createRangeIn(t)),i.move(i.createRangeIn(e),i.createPositionAt(t,"end"))),i.remove(e);}function HM(e){var t=e.getChild(0);return 1==e.childCount&&t.is("element","paragraph")&&t.isEmpty;}function $M(e,t,i,n){var s=parseInt(e.getAttribute(n)||"1");return Math.max(i,t+s);}var UM=/*#__PURE__*/function(_Hr72){function UM(e){var _this792;_classCallCheck(this,UM);_this792=_callSuper(this,UM,[e]),_this792.affectsData=!1;return _this792;}_inherits(UM,_Hr72);return _createClass(UM,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0;}},{key:"execute",value:function execute(){var e=this.editor.model,t=this.editor.plugins.get("TableUtils"),i=t.getSelectionAffectedTableCells(e.document.selection),n=t.getRowIndexes(i),s=i[0].findAncestor("table"),o=[];for(var _t561=n.first;_t561<=n.last;_t561++){var _iterator865=_createForOfIteratorHelper(s.getChild(_t561).getChildren()),_step865;try{for(_iterator865.s();!(_step865=_iterator865.n()).done;){var _i617=_step865.value;o.push(e.createRangeOn(_i617));}}catch(err){_iterator865.e(err);}finally{_iterator865.f();}}e.change(function(e){e.setSelection(o);});}}]);}(Hr);var WM=/*#__PURE__*/function(_Hr73){function WM(e){var _this793;_classCallCheck(this,WM);_this793=_callSuper(this,WM,[e]),_this793.affectsData=!1;return _this793;}_inherits(WM,_Hr73);return _createClass(WM,[{key:"refresh",value:function refresh(){var e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0;}},{key:"execute",value:function execute(){var e=this.editor.plugins.get("TableUtils"),t=this.editor.model,i=e.getSelectionAffectedTableCells(t.document.selection),n=i[0],s=i.pop(),o=n.findAncestor("table"),r=e.getCellLocation(n),a=e.getCellLocation(s),l=Math.min(r.column,a.column),c=Math.max(r.column,a.column),d=[];var _iterator866=_createForOfIteratorHelper(new JB(o,{startColumn:l,endColumn:c})),_step866;try{for(_iterator866.s();!(_step866=_iterator866.n()).done;){var _e819=_step866.value;d.push(t.createRangeOn(_e819.cell));}}catch(err){_iterator866.e(err);}finally{_iterator866.f();}t.change(function(e){e.setSelection(d);});}}]);}(Hr);function jM(e){e.document.registerPostFixer(function(t){return function(e,t){var i=t.document.differ.getChanges();var n=!1;var s=new Set();var _iterator867=_createForOfIteratorHelper(i),_step867;try{for(_iterator867.s();!(_step867=_iterator867.n()).done;){var _t562=_step867.value;var _i618=null;"insert"==_t562.type&&"table"==_t562.name&&(_i618=_t562.position.nodeAfter),"insert"!=_t562.type&&"remove"!=_t562.type||"tableRow"!=_t562.name&&"tableCell"!=_t562.name||(_i618=_t562.position.findAncestor("table")),KM(_t562)&&(_i618=_t562.range.start.findAncestor("table")),_i618&&!s.has(_i618)&&(n=qM(_i618,e)||n,n=GM(_i618,e)||n,s.add(_i618));}}catch(err){_iterator867.e(err);}finally{_iterator867.f();}return n;}(t,e);});}function qM(e,t){var i=!1;var n=function(e){var t=parseInt(e.getAttribute("headingRows")||"0"),i=Array.from(e.getChildren()).reduce(function(e,t){return t.is("element","tableRow")?e+1:e;},0),n=[];var _iterator868=_createForOfIteratorHelper(new JB(e)),_step868;try{for(_iterator868.s();!(_step868=_iterator868.n()).done;){var _step868$value=_step868.value,_s236=_step868$value.row,_o140=_step868$value.cell,r=_step868$value.cellHeight;if(r<2)continue;var _e820=_s236<t?t:i;if(_s236+r>_e820){var _t563=_e820-_s236;n.push({cell:_o140,rowspan:_t563});}}}catch(err){_iterator868.e(err);}finally{_iterator868.f();}return n;}(e);if(n.length){i=!0;var _iterator869=_createForOfIteratorHelper(n),_step869;try{for(_iterator869.s();!(_step869=_iterator869.n()).done;){var _e821=_step869.value;$B("rowspan",_e821.rowspan,_e821.cell,t,1);}}catch(err){_iterator869.e(err);}finally{_iterator869.f();}}return i;}function GM(e,t){var i=!1;var n=function(e){var t=new Array(e.childCount).fill(0);var _iterator870=_createForOfIteratorHelper(new JB(e,{includeAllSlots:!0})),_step870;try{for(_iterator870.s();!(_step870=_iterator870.n()).done;){var _i619=_step870.value.rowIndex;t[_i619]++;}}catch(err){_iterator870.e(err);}finally{_iterator870.f();}return t;}(e),s=[];var _iterator871=_createForOfIteratorHelper(n.entries()),_step871;try{for(_iterator871.s();!(_step871=_iterator871.n()).done;){var _step871$value=_slicedToArray(_step871.value,2),_t564=_step871$value[0],_i622=_step871$value[1];!_i622&&e.getChild(_t564).is("element","tableRow")&&s.push(_t564);}}catch(err){_iterator871.e(err);}finally{_iterator871.f();}if(s.length){i=!0;var _iterator872=_createForOfIteratorHelper(s.reverse()),_step872;try{for(_iterator872.s();!(_step872=_iterator872.n()).done;){var _i620=_step872.value;t.remove(e.getChild(_i620)),n.splice(_i620,1);}}catch(err){_iterator872.e(err);}finally{_iterator872.f();}}var o=n.filter(function(t,i){return e.getChild(i).is("element","tableRow");}),r=o[0];if(!o.every(function(e){return e===r;})){var _n333=o.reduce(function(e,t){return t>e?t:e;},0);var _iterator873=_createForOfIteratorHelper(o.entries()),_step873;try{for(_iterator873.s();!(_step873=_iterator873.n()).done;){var _step873$value=_slicedToArray(_step873.value,2),_s237=_step873$value[0],_r59=_step873$value[1];var _o141=_n333-_r59;if(_o141){for(var _i621=0;_i621<_o141;_i621++)UB(t,t.createPositionAt(e.getChild(_s237),"end"));i=!0;}}}catch(err){_iterator873.e(err);}finally{_iterator873.f();}}return i;}function KM(e){if("attribute"!==e.type)return!1;var t=e.attributeKey;return"headingRows"===t||"colspan"===t||"rowspan"===t;}function ZM(e){e.document.registerPostFixer(function(t){return function(e,t){var i=t.document.differ.getChanges();var n=!1;var _iterator874=_createForOfIteratorHelper(i),_step874;try{for(_iterator874.s();!(_step874=_iterator874.n()).done;){var _t565=_step874.value;"insert"==_t565.type&&"table"==_t565.name&&(n=JM(_t565.position.nodeAfter,e)||n),"insert"==_t565.type&&"tableRow"==_t565.name&&(n=QM(_t565.position.nodeAfter,e)||n),"insert"==_t565.type&&"tableCell"==_t565.name&&(n=YM(_t565.position.nodeAfter,e)||n),"remove"!=_t565.type&&"insert"!=_t565.type||!XM(_t565)||(n=YM(_t565.position.parent,e)||n);}}catch(err){_iterator874.e(err);}finally{_iterator874.f();}return n;}(t,e);});}function JM(e,t){var i=!1;var _iterator875=_createForOfIteratorHelper(e.getChildren()),_step875;try{for(_iterator875.s();!(_step875=_iterator875.n()).done;){var _n334=_step875.value;_n334.is("element","tableRow")&&(i=QM(_n334,t)||i);}}catch(err){_iterator875.e(err);}finally{_iterator875.f();}return i;}function QM(e,t){var i=!1;var _iterator876=_createForOfIteratorHelper(e.getChildren()),_step876;try{for(_iterator876.s();!(_step876=_iterator876.n()).done;){var _n335=_step876.value;i=YM(_n335,t)||i;}}catch(err){_iterator876.e(err);}finally{_iterator876.f();}return i;}function YM(e,t){if(0==e.childCount)return t.insertElement("paragraph",e),!0;var i=Array.from(e.getChildren()).filter(function(e){return e.is("$text");});var _iterator877=_createForOfIteratorHelper(i),_step877;try{for(_iterator877.s();!(_step877=_iterator877.n()).done;){var _e822=_step877.value;t.wrap(t.createRangeOn(_e822),"paragraph");}}catch(err){_iterator877.e(err);}finally{_iterator877.f();}return!!i.length;}function XM(e){return!!e.position.parent.is("element","tableCell")&&("insert"==e.type&&"$text"==e.name||"remove"==e.type);}function eL(e,t){if(!e.is("element","paragraph"))return!1;var i=t.toViewElement(e);return!!i&&tM(e)!==i.is("element","span");}var tL=/*#__PURE__*/function(_Dr242){function tL(e){var _this794;_classCallCheck(this,tL);_this794=_callSuper(this,tL,[e]),_defineProperty(_assertThisInitialized(_this794),"_additionalSlots",void 0),_this794._additionalSlots=[];return _this794;}_inherits(tL,_Dr242);return _createClass(tL,[{key:"init",value:function init(){var e=this.editor,t=e.model,i=t.schema,n=e.conversion,s=e.plugins.get(BM);i.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),i.register("tableRow",{allowIn:"table",isLimit:!0}),i.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),n["for"]("upcast").add(function(e){e.on("element:figure",function(e,t,i){if(!i.consumable.test(t.viewItem,{name:!0,classes:"table"}))return;var n=function(e){var _iterator878=_createForOfIteratorHelper(e.getChildren()),_step878;try{for(_iterator878.s();!(_step878=_iterator878.n()).done;){var _t566=_step878.value;if(_t566.is("element","table"))return _t566;}}catch(err){_iterator878.e(err);}finally{_iterator878.f();}}(t.viewItem);if(!n||!i.consumable.test(n,{name:!0}))return;i.consumable.consume(t.viewItem,{name:!0,classes:"table"});var s=wr(i.convertItem(n,t.modelCursor).modelRange.getItems());s?(i.convertChildren(t.viewItem,i.writer.createPositionAt(s,"end")),i.updateConversionResult(s,t)):i.consumable.revert(t.viewItem,{name:!0,classes:"table"});});}),n["for"]("upcast").add(GB()),n["for"]("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:YB(s,{asWidget:!0,additionalSlots:this._additionalSlots})}),n["for"]("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:YB(s,{additionalSlots:this._additionalSlots})}),n["for"]("upcast").elementToElement({model:"tableRow",view:"tr"}),n["for"]("upcast").add(function(e){e.on("element:tr",function(e,t){t.viewItem.isEmpty&&0==t.modelCursor.index&&e.stop();},{priority:"high"});}),n["for"]("downcast").elementToElement({model:"tableRow",view:function view(e,_ref337){var t=_ref337.writer;return e.isEmpty?t.createEmptyElement("tr"):t.createContainerElement("tr");}}),n["for"]("upcast").elementToElement({model:"tableCell",view:"td"}),n["for"]("upcast").elementToElement({model:"tableCell",view:"th"}),n["for"]("upcast").add(KB("td")),n["for"]("upcast").add(KB("th")),n["for"]("editingDowncast").elementToElement({model:"tableCell",view:XB({asWidget:!0})}),n["for"]("dataDowncast").elementToElement({model:"tableCell",view:XB()}),n["for"]("editingDowncast").elementToElement({model:"paragraph",view:eM({asWidget:!0}),converterPriority:"high"}),n["for"]("dataDowncast").elementToElement({model:"paragraph",view:eM(),converterPriority:"high"}),n["for"]("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),n["for"]("upcast").attributeToAttribute({model:{key:"colspan",value:iL("colspan")},view:"colspan"}),n["for"]("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),n["for"]("upcast").attributeToAttribute({model:{key:"rowspan",value:iL("rowspan")},view:"rowspan"}),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new iM(e)),e.commands.add("insertTableRowAbove",new nM(e,{order:"above"})),e.commands.add("insertTableRowBelow",new nM(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new sM(e,{order:"left"})),e.commands.add("insertTableColumnRight",new sM(e,{order:"right"})),e.commands.add("removeTableRow",new _M(e)),e.commands.add("removeTableColumn",new vM(e)),e.commands.add("splitTableCellVertically",new oM(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new oM(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new DM(e)),e.commands.add("mergeTableCellRight",new bM(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new bM(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new bM(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new bM(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new kM(e)),e.commands.add("setTableRowHeader",new yM(e)),e.commands.add("selectTableRow",new UM(e)),e.commands.add("selectTableColumn",new WM(e)),jM(t),ZM(t),this.listenTo(t.document,"change:data",function(){!function(e,t){var i=e.document.differ;var _iterator879=_createForOfIteratorHelper(i.getChanges()),_step879;try{for(_iterator879.s();!(_step879=_iterator879.n()).done;){var _e823=_step879.value;var _i623=void 0,_n336=!1;if("attribute"==_e823.type){var _t567=_e823.range.start.nodeAfter;if(!_t567||!_t567.is("element","table"))continue;if("headingRows"!=_e823.attributeKey&&"headingColumns"!=_e823.attributeKey)continue;_i623=_t567,_n336="headingRows"==_e823.attributeKey;}else"tableRow"!=_e823.name&&"tableCell"!=_e823.name||(_i623=_e823.position.findAncestor("table"),_n336="tableRow"==_e823.name);if(!_i623)continue;var _s238=_i623.getAttribute("headingRows")||0,_o142=_i623.getAttribute("headingColumns")||0,r=new JB(_i623);var _iterator880=_createForOfIteratorHelper(r),_step880;try{for(_iterator880.s();!(_step880=_iterator880.n()).done;){var _e824=_step880.value;var _i624=_e824.row<_s238||_e824.column<_o142?"th":"td",_r60=t.mapper.toViewElement(_e824.cell);_r60&&_r60.is("element")&&_r60.name!=_i624&&t.reconvertItem(_n336?_e824.cell.parent:_e824.cell);}}catch(err){_iterator880.e(err);}finally{_iterator880.f();}}}catch(err){_iterator879.e(err);}finally{_iterator879.f();}}(t,e.editing),function(e,t){var i=e.document.differ,n=new Set();var _iterator881=_createForOfIteratorHelper(i.getChanges()),_step881;try{for(_iterator881.s();!(_step881=_iterator881.n()).done;){var _e825=_step881.value;var _t568="attribute"==_e825.type?_e825.range.start.parent:_e825.position.parent;_t568.is("element","tableCell")&&n.add(_t568);}}catch(err){_iterator881.e(err);}finally{_iterator881.f();}var _iterator882=_createForOfIteratorHelper(n.values()),_step882;try{for(_iterator882.s();!(_step882=_iterator882.n()).done;){var _e826=_step882.value;var _i625=Array.from(_e826.getChildren()).filter(function(e){return eL(e,t.mapper);});var _iterator883=_createForOfIteratorHelper(_i625),_step883;try{for(_iterator883.s();!(_step883=_iterator883.n()).done;){var _e827=_step883.value;t.reconvertItem(_e827);}}catch(err){_iterator883.e(err);}finally{_iterator883.f();}}}catch(err){_iterator882.e(err);}finally{_iterator882.f();}}(t,e.editing);});}},{key:"registerAdditionalSlot",value:function registerAdditionalSlot(e){this._additionalSlots.push(e);}}],[{key:"pluginName",get:function get(){return"TableEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[BM];}}]);}(Dr);function iL(e){return function(t){var i=parseInt(t.getAttribute(e));return Number.isNaN(i)||i<=0?null:i;};}var nL=/*#__PURE__*/function(_lg74){function nL(e){var _this795;_classCallCheck(this,nL);_this795=_callSuper(this,nL,[e]);_defineProperty(_this795,"items",void 0);_defineProperty(_this795,"keystrokes",void 0);_defineProperty(_this795,"focusTracker",void 0);var t=_this795.bindTemplate;_this795.items=_this795._createGridCollection(),_this795.keystrokes=new Cr(),_this795.focusTracker=new _r(),_this795.set("rows",0),_this795.set("columns",0),_this795.bind("label").to(_this795,"columns",_this795,"rows",function(e,t){return"".concat(t," \xD7 ").concat(e);}),_this795.setTemplate({tag:"div",attributes:{"class":["ck"]},children:[{tag:"div",attributes:{"class":["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":t.to("boxover")},children:_this795.items},{tag:"div",attributes:{"class":["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:t.to("label")}]}],on:{mousedown:t.to(function(e){e.preventDefault();}),click:t.to(function(){_this795.fire("execute");})}}),_this795.on("boxover",function(e,t){var _t$target$dataset=t.target.dataset,i=_t$target$dataset.row,n=_t$target$dataset.column;_this795.items.get(10*(parseInt(i,10)-1)+(parseInt(n,10)-1)).focus();}),_this795.focusTracker.on("change:focusedElement",function(e,t,i){if(!i)return;var _i$dataset=i.dataset,n=_i$dataset.row,s=_i$dataset.column;_this795.set({rows:parseInt(n),columns:parseInt(s)});}),_this795.on("change:columns",function(){return _this795._highlightGridBoxes();}),_this795.on("change:rows",function(){return _this795._highlightGridBoxes();});return _this795;}_inherits(nL,_lg74);return _createClass(nL,[{key:"render",value:function render(){_superPropGet(nL,"render",this,3)([]),mg({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});var _iterator884=_createForOfIteratorHelper(this.items),_step884;try{for(_iterator884.s();!(_step884=_iterator884.n()).done;){var _e828=_step884.value;this.focusTracker.add(_e828.element);}}catch(err){_iterator884.e(err);}finally{_iterator884.f();}this.keystrokes.listenTo(this.element);}},{key:"reset",value:function reset(){this.set({rows:1,columns:1});}},{key:"focus",value:function focus(){this.items.get(0).focus();}},{key:"focusLast",value:function focusLast(){this.items.get(0).focus();}},{key:"_highlightGridBoxes",value:function _highlightGridBoxes(){var e=this.rows,t=this.columns;this.items.map(function(i,n){var s=Math.floor(n/10)<e&&n%10<t;i.set("isOn",s);});}},{key:"_createGridButton",value:function _createGridButton(e,t,i,n){var s=new pg(e);return s.set({label:n,"class":"ck-insert-table-dropdown-grid-box"}),s.extendTemplate({attributes:{"data-row":t,"data-column":i}}),s;}},{key:"_createGridCollection",value:function _createGridCollection(){var e=[];for(var _t569=0;_t569<100;_t569++){var _i626=Math.floor(_t569/10),_n337=_t569%10,_s239="".concat(_i626+1," \xD7 ").concat(_n337+1);e.push(this._createGridButton(this.locale,_i626+1,_n337+1,_s239));}return this.createCollection(e);}}]);}(lg);var sL=/*#__PURE__*/function(_Dr243){function sL(){_classCallCheck(this,sL);return _callSuper(this,sL,arguments);}_inherits(sL,_Dr243);return _createClass(sL,[{key:"init",value:function init(){var _this796=this;var e=this.editor,t=this.editor.t,i="ltr"===e.locale.contentLanguageDirection;e.ui.componentFactory.add("insertTable",function(i){var n=e.commands.get("insertTable"),s=Xf(i);var o;return s.bind("isEnabled").to(n),s.buttonView.set({icon:vm.table,label:t("Insert table"),tooltip:!0}),s.on("change:isOpen",function(){o||(o=new nL(i),s.panelView.children.add(o),o.delegate("execute").to(s),s.on("execute",function(){e.execute("insertTable",{rows:o.rows,columns:o.columns}),e.editing.view.focus();}));}),s;}),e.ui.componentFactory.add("menuBar:insertTable",function(i){var n=e.commands.get("insertTable"),s=new aw(i),o=new nL(i);return o.delegate("execute").to(s),s.on("change:isOpen",function(e,t,i){i||o.reset();}),o.on("execute",function(){e.execute("insertTable",{rows:o.rows,columns:o.columns}),e.editing.view.focus();}),s.buttonView.set({label:t("Table"),icon:vm.table}),s.panelView.children.add(o),s.bind("isEnabled").to(n),s;}),e.ui.componentFactory.add("tableColumn",function(e){var n=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:t("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:i?"insertTableColumnLeft":"insertTableColumnRight",label:t("Insert column left")}},{type:"button",model:{commandName:i?"insertTableColumnRight":"insertTableColumnLeft",label:t("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:t("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:t("Select column")}}];return _this796._prepareDropdown(t("Column"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',n,e);}),e.ui.componentFactory.add("tableRow",function(e){var i=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:t("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:t("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:t("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:t("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:t("Select row")}}];return _this796._prepareDropdown(t("Row"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',i,e);}),e.ui.componentFactory.add("mergeTableCells",function(e){var n=[{type:"button",model:{commandName:"mergeTableCellUp",label:t("Merge cell up")}},{type:"button",model:{commandName:i?"mergeTableCellRight":"mergeTableCellLeft",label:t("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:t("Merge cell down")}},{type:"button",model:{commandName:i?"mergeTableCellLeft":"mergeTableCellRight",label:t("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:t("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:t("Split cell horizontally")}}];return _this796._prepareMergeSplitButtonDropdown(t("Merge cells"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>',n,e);});}},{key:"_prepareDropdown",value:function _prepareDropdown(e,t,i,n){var s=this.editor,o=Xf(n),r=this._fillDropdownWithListOptions(o,i);return o.buttonView.set({label:e,icon:t,tooltip:!0}),o.bind("isEnabled").toMany(r,"isEnabled",function(){for(var _len100=arguments.length,e=new Array(_len100),_key100=0;_key100<_len100;_key100++){e[_key100]=arguments[_key100];}return e.some(function(e){return e;});}),this.listenTo(o,"execute",function(e){s.execute(e.source.commandName),e.source instanceof Dg||s.editing.view.focus();}),o;}},{key:"_prepareMergeSplitButtonDropdown",value:function _prepareMergeSplitButtonDropdown(e,t,i,n){var s=this.editor,o=Xf(n,Yf),r="mergeTableCells",a=s.commands.get(r),l=this._fillDropdownWithListOptions(o,i);return o.buttonView.set({label:e,icon:t,tooltip:!0,isEnabled:!0}),o.bind("isEnabled").toMany([a].concat(_toConsumableArray(l)),"isEnabled",function(){for(var _len101=arguments.length,e=new Array(_len101),_key101=0;_key101<_len101;_key101++){e[_key101]=arguments[_key101];}return e.some(function(e){return e;});}),this.listenTo(o.buttonView,"execute",function(){s.execute(r),s.editing.view.focus();}),this.listenTo(o,"execute",function(e){s.execute(e.source.commandName),s.editing.view.focus();}),o;}},{key:"_fillDropdownWithListOptions",value:function _fillDropdownWithListOptions(e,t){var i=this.editor,n=[],s=new br();var _iterator885=_createForOfIteratorHelper(t),_step885;try{for(_iterator885.s();!(_step885=_iterator885.n()).done;){var _e829=_step885.value;oL(_e829,i,n,s);}}catch(err){_iterator885.e(err);}finally{_iterator885.f();}return sp(e,s),n;}}],[{key:"pluginName",get:function get(){return"TableUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function oL(e,t,i,n){if("button"===e.type||"switchbutton"===e.type){var _n338=e.model=new Fb(e.model),_e$model2=e.model,_s240=_e$model2.commandName,_o143=_e$model2.bindIsOn,r=t.commands.get(_s240);i.push(r),_n338.set({commandName:_s240}),_n338.bind("isEnabled").to(r),_o143&&_n338.bind("isOn").to(r,"value"),_n338.set({withText:!0});}n.add(e);}var rL=/*#__PURE__*/function(_Dr244){function rL(){_classCallCheck(this,rL);return _callSuper(this,rL,arguments);}_inherits(rL,_Dr244);return _createClass(rL,[{key:"init",value:function init(){var _this797=this;var e=this.editor,t=e.model,i=e.editing.view;this.listenTo(t,"deleteContent",function(e,t){return _this797._handleDeleteContent(e,t);},{priority:"high"}),this.listenTo(i.document,"insertText",function(e,t){return _this797._handleInsertTextEvent(e,t);},{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling();}},{key:"getSelectedTableCells",value:function getSelectedTableCells(){var e=this.editor.plugins.get(BM),t=this.editor.model.document.selection,i=e.getSelectedTableCells(t);return 0==i.length?null:i;}},{key:"getSelectionAsFragment",value:function getSelectionAsFragment(){var e=this.editor.plugins.get(BM),t=this.getSelectedTableCells();return t?this.editor.model.change(function(i){var n=i.createDocumentFragment(),_e$getColumnIndexes2=e.getColumnIndexes(t),s=_e$getColumnIndexes2.first,o=_e$getColumnIndexes2.last,_e$getRowIndexes=e.getRowIndexes(t),r=_e$getRowIndexes.first,a=_e$getRowIndexes.last,l=t[0].findAncestor("table");var c=a,d=o;if(e.isSelectionRectangular(t)){var _e830={firstColumn:s,lastColumn:o,firstRow:r,lastRow:a};c=fM(l,_e830),d=pM(l,_e830);}var u=rM(l,{startRow:r,startColumn:s,endRow:c,endColumn:d},i);return i.insert(u,n,0),n;}):null;}},{key:"setCellSelection",value:function setCellSelection(e,t){var i=this._getCellsToSelect(e,t);this.editor.model.change(function(e){e.setSelection(i.cells.map(function(t){return e.createRangeOn(t);}),{backward:i.backward});});}},{key:"getFocusCell",value:function getFocusCell(){var e=_toConsumableArray(this.editor.model.document.selection.getRanges()).pop().getContainedElement();return e&&e.is("element","tableCell")?e:null;}},{key:"getAnchorCell",value:function getAnchorCell(){var e=wr(this.editor.model.document.selection.getRanges()).getContainedElement();return e&&e.is("element","tableCell")?e:null;}},{key:"_defineSelectionConverter",value:function _defineSelectionConverter(){var _this798=this;var e=this.editor,t=new Set();e.conversion["for"]("editingDowncast").add(function(e){return e.on("selection",function(e,i,n){var s=n.writer;!function(e){var _iterator886=_createForOfIteratorHelper(t),_step886;try{for(_iterator886.s();!(_step886=_iterator886.n()).done;){var _i627=_step886.value;e.removeClass("ck-editor__editable_selected",_i627);}}catch(err){_iterator886.e(err);}finally{_iterator886.f();}t.clear();}(s);var o=_this798.getSelectedTableCells();if(!o)return;var _iterator887=_createForOfIteratorHelper(o),_step887;try{for(_iterator887.s();!(_step887=_iterator887.n()).done;){var _e831=_step887.value;var _i628=n.mapper.toViewElement(_e831);s.addClass("ck-editor__editable_selected",_i628),t.add(_i628);}}catch(err){_iterator887.e(err);}finally{_iterator887.f();}var r=n.mapper.toViewElement(o[o.length-1]);s.setSelection(r,0);},{priority:"lowest"});});}},{key:"_enablePluginDisabling",value:function _enablePluginDisabling(){var _this799=this;var e=this.editor;this.on("change:isEnabled",function(){if(!_this799.isEnabled){var _t570=_this799.getSelectedTableCells();if(!_t570)return;e.model.change(function(i){var n=i.createPositionAt(_t570[0],0),s=e.model.schema.getNearestSelectionRange(n);i.setSelection(s);});}});}},{key:"_handleDeleteContent",value:function _handleDeleteContent(e,t){var i=this.editor.plugins.get(BM),n=t[0],s=t[1],o=this.editor.model,r=!s||"backward"==s.direction,a=i.getSelectedTableCells(n);a.length&&(e.stop(),o.change(function(e){var t=a[r?a.length-1:0];o.change(function(e){var _iterator888=_createForOfIteratorHelper(a),_step888;try{for(_iterator888.s();!(_step888=_iterator888.n()).done;){var _t571=_step888.value;o.deleteContent(e.createSelection(_t571,"in"));}}catch(err){_iterator888.e(err);}finally{_iterator888.f();}});var i=o.schema.getNearestSelectionRange(e.createPositionAt(t,0));n.is("documentSelection")?e.setSelection(i):n.setTo(i);}));}},{key:"_handleInsertTextEvent",value:function _handleInsertTextEvent(e,t){var i=this.editor,n=this.getSelectedTableCells();if(!n)return;var s=i.editing.view,o=i.editing.mapper,r=n.map(function(e){return s.createRangeOn(o.toViewElement(e));});t.selection=s.createSelection(r);}},{key:"_getCellsToSelect",value:function _getCellsToSelect(e,t){var i=this.editor.plugins.get("TableUtils"),n=i.getCellLocation(e),s=i.getCellLocation(t),o=Math.min(n.row,s.row),r=Math.max(n.row,s.row),a=Math.min(n.column,s.column),l=Math.max(n.column,s.column),c=new Array(r-o+1).fill(null).map(function(){return[];}),d={startRow:o,endRow:r,startColumn:a,endColumn:l};var _iterator889=_createForOfIteratorHelper(new JB(e.findAncestor("table"),d)),_step889;try{for(_iterator889.s();!(_step889=_iterator889.n()).done;){var _step889$value=_step889.value,_t572=_step889$value.row,_i629=_step889$value.cell;c[_t572-o].push(_i629);}}catch(err){_iterator889.e(err);}finally{_iterator889.f();}var u=s.row<n.row,h=s.column<n.column;return u&&c.reverse(),h&&c.forEach(function(e){return e.reverse();}),{cells:c.flat(),backward:u||h};}}],[{key:"pluginName",get:function get(){return"TableSelection";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[BM,BM];}}]);}(Dr);var aL=/*#__PURE__*/function(_Dr245){function aL(){_classCallCheck(this,aL);return _callSuper(this,aL,arguments);}_inherits(aL,_Dr245);return _createClass(aL,[{key:"init",value:function init(){var _this800=this;var e=this.editor,t=e.editing.view.document;this.listenTo(t,"copy",function(e,t){return _this800._onCopyCut(e,t);}),this.listenTo(t,"cut",function(e,t){return _this800._onCopyCut(e,t);}),this.listenTo(e.model,"insertContent",function(e,_ref338){var _ref339=_slicedToArray(_ref338,2),t=_ref339[0],i=_ref339[1];return _this800._onInsertContent(e,t,i);},{priority:"high"}),this.decorate("_replaceTableSlotCell");}},{key:"_onCopyCut",value:function _onCopyCut(e,t){var _this801=this;var i=this.editor.editing.view,n=this.editor.plugins.get(rL),s=this.editor.plugins.get(Zv);n.getSelectedTableCells()&&("cut"!=e.name||this.editor.model.canEditAt(this.editor.model.document.selection))&&(t.preventDefault(),e.stop(),this.editor.model.enqueueChange({isUndoable:"cut"===e.name},function(){var o=s._copySelectedFragmentWithMarkers(e.name,_this801.editor.model.document.selection,function(){return n.getSelectionAsFragment();});i.document.fire("clipboardOutput",{dataTransfer:t.dataTransfer,content:_this801.editor.data.toView(o),method:e.name});}));}},{key:"_onInsertContent",value:function _onInsertContent(e,t,i){var _this802=this;if(i&&!i.is("documentSelection"))return;var n=this.editor.model,s=this.editor.plugins.get(BM),o=this.editor.plugins.get(Zv),r=this.getTableIfOnlyTableInContent(t,n);if(!r)return;var a=s.getSelectionAffectedTableCells(n.document.selection);a.length?(e.stop(),t.is("documentFragment")?o._pasteMarkersIntoTransformedElement(t.markers,function(e){return _this802._replaceSelectedCells(r,a,e);}):this.editor.model.change(function(e){_this802._replaceSelectedCells(r,a,e);})):gM(r,s);}},{key:"_replaceSelectedCells",value:function _replaceSelectedCells(e,t,i){var n=this.editor.plugins.get(BM),s={width:n.getColumns(e),height:n.getRows(e)},o=function(e,t,i,n){var s=e[0].findAncestor("table"),o=n.getColumnIndexes(e),r=n.getRowIndexes(e),a={firstColumn:o.first,lastColumn:o.last,firstRow:r.first,lastRow:r.last},l=1===e.length;l&&(a.lastRow+=t.height-1,a.lastColumn+=t.width-1,function(e,t,i,n){var s=n.getColumns(e),o=n.getRows(e);i>s&&n.insertColumns(e,{at:s,columns:i-s});t>o&&n.insertRows(e,{at:o,rows:t-o});}(s,a.lastRow+1,a.lastColumn+1,n));l||!n.isSelectionRectangular(e)?function(e,t,i){var n=t.firstRow,s=t.lastRow,o=t.firstColumn,r=t.lastColumn,a={first:n,last:s},l={first:o,last:r};cL(e,o,a,i),cL(e,r+1,a,i),lL(e,n,l,i),lL(e,s+1,l,i,n);}(s,a,i):(a.lastRow=fM(s,a),a.lastColumn=pM(s,a));return a;}(t,s,i,n),r=o.lastRow-o.firstRow+1,a=o.lastColumn-o.firstColumn+1;e=rM(e,{startRow:0,startColumn:0,endRow:Math.min(r,s.height)-1,endColumn:Math.min(a,s.width)-1},i);var l=t[0].findAncestor("table"),c=this._replaceSelectedCellsWithPasted(e,s,l,o,i);if(this.editor.plugins.get("TableSelection").isEnabled){var _e832=n.sortRanges(c.map(function(e){return i.createRangeOn(e);}));i.setSelection(_e832);}else i.setSelection(c[0],0);return l;}},{key:"_replaceSelectedCellsWithPasted",value:function _replaceSelectedCellsWithPasted(e,t,i,n,s){var o=t.width,r=t.height,a=function(e,t,i){var n=new Array(i).fill(null).map(function(){return new Array(t).fill(null);});var _iterator890=_createForOfIteratorHelper(new JB(e)),_step890;try{for(_iterator890.s();!(_step890=_iterator890.n()).done;){var _step890$value=_step890.value,_t573=_step890$value.column,_i630=_step890$value.row,_s241=_step890$value.cell;n[_i630][_t573]=_s241;}}catch(err){_iterator890.e(err);}finally{_iterator890.f();}return n;}(e,o,r),l=_toConsumableArray(new JB(i,{startRow:n.firstRow,endRow:n.lastRow,startColumn:n.firstColumn,endColumn:n.lastColumn,includeAllSlots:!0})),c=[];var d;var _iterator891=_createForOfIteratorHelper(l),_step891;try{for(_iterator891.s();!(_step891=_iterator891.n()).done;){var _e835=_step891.value;var _t574=_e835.row,_i631=_e835.column;_i631===n.firstColumn&&(d=_e835.getPositionBefore());var _l35=_t574-n.firstRow,_u12=_i631-n.firstColumn,_h9=a[_l35%r][_u12%o],_m6=_h9?s.cloneElement(_h9):null,_g5=this._replaceTableSlotCell(_e835,_m6,d,s);_g5&&(uM(_g5,_t574,_i631,n.lastRow,n.lastColumn,s),c.push(_g5),d=s.createPositionAfter(_g5));}}catch(err){_iterator891.e(err);}finally{_iterator891.f();}var u=parseInt(i.getAttribute("headingRows")||"0"),h=parseInt(i.getAttribute("headingColumns")||"0"),m=n.firstRow<u&&u<=n.lastRow,g=n.firstColumn<h&&h<=n.lastColumn;if(m){var _e833=lL(i,u,{first:n.firstColumn,last:n.lastColumn},s,n.firstRow);c.push.apply(c,_toConsumableArray(_e833));}if(g){var _e834=cL(i,h,{first:n.firstRow,last:n.lastRow},s);c.push.apply(c,_toConsumableArray(_e834));}return c;}},{key:"_replaceTableSlotCell",value:function _replaceTableSlotCell(e,t,i,n){var s=e.cell,o=e.isAnchor;return o&&n.remove(s),t?(n.insert(t,i),t):null;}},{key:"getTableIfOnlyTableInContent",value:function getTableIfOnlyTableInContent(e,t){if(!e.is("documentFragment")&&!e.is("element"))return null;if(e.is("element","table"))return e;if(1==e.childCount&&e.getChild(0).is("element","table"))return e.getChild(0);var i=t.createRangeIn(e);var _iterator892=_createForOfIteratorHelper(i.getItems()),_step892;try{for(_iterator892.s();!(_step892=_iterator892.n()).done;){var _e836=_step892.value;if(_e836.is("element","table")){var _n339=t.createRange(i.start,t.createPositionBefore(_e836));if(t.hasContent(_n339,{ignoreWhitespaces:!0}))return null;var _s242=t.createRange(t.createPositionAfter(_e836),i.end);return t.hasContent(_s242,{ignoreWhitespaces:!0})?null:_e836;}}}catch(err){_iterator892.e(err);}finally{_iterator892.f();}return null;}}],[{key:"pluginName",get:function get(){return"TableClipboard";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[Zv,Jv,rL,BM];}}]);}(Dr);function lL(e,t,i,n){var s=arguments.length>4&&arguments[4]!==undefined?arguments[4]:0;if(t<1)return;return aM(e,t,s).filter(function(_ref340){var e=_ref340.column,t=_ref340.cellWidth;return dL(e,t,i);}).map(function(_ref341){var e=_ref341.cell;return lM(e,t,n);});}function cL(e,t,i,n){if(t<1)return;return cM(e,t).filter(function(_ref342){var e=_ref342.row,t=_ref342.cellHeight;return dL(e,t,i);}).map(function(_ref343){var e=_ref343.cell,i=_ref343.column;return dM(e,i,t,n);});}function dL(e,t,i){var n=e+t-1,s=i.first,o=i.last;return e>=s&&e<=o||e<s&&n>=s;}var uL=/*#__PURE__*/function(_Dr246){function uL(){_classCallCheck(this,uL);return _callSuper(this,uL,arguments);}_inherits(uL,_Dr246);return _createClass(uL,[{key:"init",value:function init(){var _this803=this;var e=this.editor,t=e.editing.view.document,i=e.t;this.listenTo(t,"arrowKey",function(){return _this803._onArrowKey.apply(_this803,arguments);},{context:"table"}),this.listenTo(t,"tab",function(){return _this803._handleTabOnSelectedTable.apply(_this803,arguments);},{context:"figure"}),this.listenTo(t,"tab",function(){return _this803._handleTab.apply(_this803,arguments);},{context:["th","td"]}),e.accessibility.addKeystrokeInfoGroup({id:"table",label:i("Keystrokes that can be used in a table cell"),keystrokes:[{label:i("Move the selection to the next cell"),keystroke:"Tab"},{label:i("Move the selection to the previous cell"),keystroke:"Shift+Tab"},{label:i("Insert a new table row (when in the last cell of a table)"),keystroke:"Tab"},{label:i("Navigate through the table"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]}]});}},{key:"_handleTabOnSelectedTable",value:function _handleTabOnSelectedTable(e,t){var i=this.editor,n=i.model.document.selection.getSelectedElement();n&&n.is("element","table")&&(t.preventDefault(),t.stopPropagation(),e.stop(),i.model.change(function(e){e.setSelection(e.createRangeIn(n.getChild(0).getChild(0)));}));}},{key:"_handleTab",value:function _handleTab(e,t){var i=this.editor,n=this.editor.plugins.get(BM),s=this.editor.plugins.get("TableSelection"),o=i.model.document.selection,r=!t.shiftKey;var a=n.getTableCellsContainingSelection(o)[0];if(a||(a=s.getFocusCell()),!a)return;t.preventDefault(),t.stopPropagation(),e.stop();var l=a.parent,c=l.parent,d=c.getChildIndex(l),u=l.getChildIndex(a),h=0===u;if(!r&&h&&0===d)return void i.model.change(function(e){e.setSelection(e.createRangeOn(c));});var m=u===l.childCount-1,g=d===n.getRows(c)-1;if(r&&g&&m&&(i.execute("insertTableRowBelow"),d===n.getRows(c)-1))return void i.model.change(function(e){e.setSelection(e.createRangeOn(c));});var f;if(r&&m){var _e837=c.getChild(d+1);f=_e837.getChild(0);}else if(!r&&h){var _e838=c.getChild(d-1);f=_e838.getChild(_e838.childCount-1);}else f=l.getChild(u+(r?1:-1));i.model.change(function(e){e.setSelection(e.createRangeIn(f));});}},{key:"_onArrowKey",value:function _onArrowKey(e,t){var i=this.editor,n=cr(t.keyCode,i.locale.contentLanguageDirection);this._handleArrowKeys(n,t.shiftKey)&&(t.preventDefault(),t.stopPropagation(),e.stop());}},{key:"_handleArrowKeys",value:function _handleArrowKeys(e,t){var i=this.editor.plugins.get(BM),n=this.editor.plugins.get("TableSelection"),s=this.editor.model,o=s.document.selection,r=["right","down"].includes(e),a=i.getSelectedTableCells(o);if(a.length){var _i632;return _i632=t?n.getFocusCell():r?a[a.length-1]:a[0],this._navigateFromCellInDirection(_i632,e,t),!0;}var l=o.focus.findAncestor("tableCell");if(!l)return!1;if(!o.isCollapsed)if(t){if(o.isBackward==r&&!o.containsEntireContent(l))return!1;}else{var _e839=o.getSelectedElement();if(!_e839||!s.schema.isObject(_e839))return!1;}return!!this._isSelectionAtCellEdge(o,l,r)&&(this._navigateFromCellInDirection(l,e,t),!0);}},{key:"_isSelectionAtCellEdge",value:function _isSelectionAtCellEdge(e,t,i){var n=this.editor.model,s=this.editor.model.schema,o=i?e.getLastPosition():e.getFirstPosition();if(!s.getLimitElement(o).is("element","tableCell")){return n.createPositionAt(t,i?"end":0).isTouching(o);}var r=n.createSelection(o);return n.modifySelection(r,{direction:i?"forward":"backward"}),o.isEqual(r.focus);}},{key:"_navigateFromCellInDirection",value:function _navigateFromCellInDirection(e,t){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var n=this.editor.model,s=e.findAncestor("table"),o=_toConsumableArray(new JB(s,{includeAllSlots:!0})),_o144=o[o.length-1],r=_o144.row,a=_o144.column,l=o.find(function(_ref344){var t=_ref344.cell;return t==e;});var c=l.row,d=l.column;switch(t){case"left":d--;break;case"up":c--;break;case"right":d+=l.cellWidth;break;case"down":c+=l.cellHeight;}if(c<0||c>r||d<0&&c<=0||d>a&&c>=r)return void n.change(function(e){e.setSelection(e.createRangeOn(s));});d<0?(d=i?0:a,c--):d>a&&(d=i?a:0,c++);var u=o.find(function(e){return e.row==c&&e.column==d;}).cell,h=["right","down"].includes(t),m=this.editor.plugins.get("TableSelection");if(i&&m.isEnabled){var _t575=m.getAnchorCell()||e;m.setCellSelection(_t575,u);}else{var _e840=n.createPositionAt(u,h?0:"end");n.change(function(t){t.setSelection(_e840);});}}}],[{key:"pluginName",get:function get(){return"TableKeyboard";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[rL,BM];}}]);}(Dr);var hL=/*#__PURE__*/function(_Tl10){function hL(){var _this804;_classCallCheck(this,hL);for(var _len102=arguments.length,args=new Array(_len102),_key102=0;_key102<_len102;_key102++){args[_key102]=arguments[_key102];}_this804=_callSuper(this,hL,[].concat(args));_defineProperty(_this804,"domEventType",["mousemove","mouseleave"]);return _this804;}_inherits(hL,_Tl10);return _createClass(hL,[{key:"onDomEvent",value:function onDomEvent(e){this.fire(e.type,e);}}]);}(Tl);var mL=/*#__PURE__*/function(_Dr247){function mL(){_classCallCheck(this,mL);return _callSuper(this,mL,arguments);}_inherits(mL,_Dr247);return _createClass(mL,[{key:"init",value:function init(){this.editor.editing.view.addObserver(hL),this._enableShiftClickSelection(),this._enableMouseDragSelection();}},{key:"_enableShiftClickSelection",value:function _enableShiftClickSelection(){var _this805=this;var e=this.editor,t=e.plugins.get(BM);var i=!1;var n=e.plugins.get(rL);this.listenTo(e.editing.view.document,"mousedown",function(s,o){var r=e.model.document.selection;if(!_this805.isEnabled||!n.isEnabled)return;if(!o.domEvent.shiftKey)return;var a=n.getAnchorCell()||t.getTableCellsContainingSelection(r)[0];if(!a)return;var l=_this805._getModelTableCellFromDomEvent(o);l&&gL(a,l)&&(i=!0,n.setCellSelection(a,l),o.preventDefault());}),this.listenTo(e.editing.view.document,"mouseup",function(){i=!1;}),this.listenTo(e.editing.view.document,"selectionChange",function(e){i&&e.stop();},{priority:"highest"});}},{key:"_enableMouseDragSelection",value:function _enableMouseDragSelection(){var _this806=this;var e=this.editor;var t,i,n=!1,s=!1;var o=e.plugins.get(rL);this.listenTo(e.editing.view.document,"mousedown",function(e,i){_this806.isEnabled&&o.isEnabled&&(i.domEvent.shiftKey||i.domEvent.ctrlKey||i.domEvent.altKey||(t=_this806._getModelTableCellFromDomEvent(i)));}),this.listenTo(e.editing.view.document,"mousemove",function(e,r){if(!r.domEvent.buttons)return;if(!t)return;var a=_this806._getModelTableCellFromDomEvent(r);a&&gL(t,a)&&(i=a,n||i==t||(n=!0)),n&&(s=!0,o.setCellSelection(t,i),r.preventDefault());}),this.listenTo(e.editing.view.document,"mouseup",function(){n=!1,s=!1,t=null,i=null;}),this.listenTo(e.editing.view.document,"selectionChange",function(e){s&&e.stop();},{priority:"highest"});}},{key:"_getModelTableCellFromDomEvent",value:function _getModelTableCellFromDomEvent(e){var t=e.target,i=this.editor.editing.view.createPositionAt(t,0);return this.editor.editing.mapper.toModelPosition(i).parent.findAncestor("tableCell",{includeSelf:!0});}}],[{key:"pluginName",get:function get(){return"TableMouse";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[rL,BM];}}]);}(Dr);function gL(e,t){return e.parent.parent==t.parent.parent;}var fL=/*#__PURE__*/function(_Dr248){function fL(){_classCallCheck(this,fL);return _callSuper(this,fL,arguments);}_inherits(fL,_Dr248);return _createClass(fL,null,[{key:"requires",get:function get(){return[tL,sL,rL,mL,uL,aL,Ty];}},{key:"pluginName",get:function get(){return"Table";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var pL=/*#__PURE__*/function(_Dr249){function pL(){_classCallCheck(this,pL);return _callSuper(this,pL,arguments);}_inherits(pL,_Dr249);return _createClass(pL,[{key:"init",value:function init(){var e=this.editor;e.conversion["for"]("dataDowncast").elementToStructure({model:"table",view:bL,converterPriority:"high"}),e.plugins.has("TableCaption")&&e.conversion["for"]("dataDowncast").elementToElement({model:"caption",view:function view(e,_ref345){var t=_ref345.writer;if("table"===e.parent.name)return t.createContainerElement("caption");},converterPriority:"high"}),e.plugins.has("TableProperties")&&function(e){var t={"border-width":"tableBorderWidth","border-color":"tableBorderColor","border-style":"tableBorderStyle","background-color":"tableBackgroundColor"};var _loop42=function _loop42(){var _Object$entries17$_i=_slicedToArray(_Object$entries17[_i633],2),i=_Object$entries17$_i[0],n=_Object$entries17$_i[1];e.conversion["for"]("dataDowncast").add(function(e){return e.on("attribute:".concat(n,":table"),function(e,t,n){var s=t.item,o=t.attributeNewValue,r=n.mapper,a=n.writer;if(!n.consumable.consume(s,e.name))return;var l=r.toViewElement(s);o?a.setStyle(i,o,l):a.removeStyle(i,l);},{priority:"high"});});};for(var _i633=0,_Object$entries17=Object.entries(t);_i633<_Object$entries17.length;_i633++){_loop42();}}(e);}}],[{key:"pluginName",get:function get(){return"PlainTableOutput";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[fL];}}]);}(Dr);function bL(e,_ref346){var t=_ref346.writer;var i=e.getAttribute("headingRows")||0,n=t.createSlot(function(e){return e.is("element","tableRow")&&e.index<i;}),s=t.createSlot(function(e){return e.is("element","tableRow")&&e.index>=i;}),o=t.createSlot(function(e){return!e.is("element","tableRow");}),r=t.createContainerElement("thead",null,n),a=t.createContainerElement("tbody",null,s),l=[];return i&&l.push(r),i<e.childCount&&l.push(a),t.createContainerElement("table",null,[o].concat(l));}function wL(e){var t=_L(e);return t||vL(e);}function _L(e){var t=e.getSelectedElement();return t&&yL(t)?t:null;}function vL(e){var t=e.getFirstPosition();if(!t)return null;var i=t.parent;for(;i;){if(i.is("element")&&yL(i))return i;i=i.parent;}return null;}function yL(e){return!!e.getCustomProperty("table")&&sy(e);}var kL=/*#__PURE__*/function(_Dr250){function kL(){_classCallCheck(this,kL);return _callSuper(this,kL,arguments);}_inherits(kL,_Dr250);return _createClass(kL,[{key:"afterInit",value:function afterInit(){var e=this.editor,t=e.t,i=e.plugins.get(Sy),n=e.config.get("table.contentToolbar"),s=e.config.get("table.tableToolbar");n&&i.register("tableContent",{ariaLabel:t("Table toolbar"),items:n,getRelatedElement:vL}),s&&i.register("table",{ariaLabel:t("Table toolbar"),items:s,getRelatedElement:_L});}}],[{key:"requires",get:function get(){return[Sy];}},{key:"pluginName",get:function get(){return"TableToolbar";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var CL=/*#__PURE__*/function(_lg75){function CL(e,t){var _this807;_classCallCheck(this,CL);_this807=_callSuper(this,CL,[e]),_defineProperty(_assertThisInitialized(_this807),"options",void 0),_defineProperty(_assertThisInitialized(_this807),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this807),"focusCycler",void 0),_defineProperty(_assertThisInitialized(_this807),"_focusables",void 0),_defineProperty(_assertThisInitialized(_this807),"dropdownView",void 0),_defineProperty(_assertThisInitialized(_this807),"inputView",void 0),_defineProperty(_assertThisInitialized(_this807),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this807),"_stillTyping",void 0),_this807.set("value",""),_this807.set("isReadOnly",!1),_this807.set("isFocused",!1),_this807.set("isEmpty",!0),_this807.options=t,_this807.focusTracker=new _r(),_this807._focusables=new zm(),_this807.dropdownView=_this807._createDropdownView(),_this807.inputView=_this807._createInputTextView(),_this807.keystrokes=new Cr(),_this807._stillTyping=!1,_this807.focusCycler=new _g({focusables:_this807._focusables,focusTracker:_this807.focusTracker,keystrokeHandler:_this807.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this807.setTemplate({tag:"div",attributes:{"class":["ck","ck-input-color"]},children:[_this807.dropdownView,_this807.inputView]}),_this807.on("change:value",function(e,t,i){return _this807._setInputValue(i);});return _this807;}_inherits(CL,_lg75);return _createClass(CL,[{key:"render",value:function render(){var _this808=this;_superPropGet(CL,"render",this,3)([]),[this.inputView,this.dropdownView.buttonView].forEach(function(e){_this808.focusTracker.add(e.element),_this808._focusables.add(e);}),this.keystrokes.listenTo(this.element);}},{key:"focus",value:function focus(e){-1===e?this.focusCycler.focusLast():this.focusCycler.focusFirst();}},{key:"destroy",value:function destroy(){_superPropGet(CL,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"_createDropdownView",value:function _createDropdownView(){var e=this.locale,t=e.t,i=this.bindTemplate,n=this._createColorSelector(e),s=Xf(e),o=new lg();return o.setTemplate({tag:"span",attributes:{"class":["ck","ck-input-color__button__preview"],style:{backgroundColor:i.to("value")}},children:[{tag:"span",attributes:{"class":["ck","ck-input-color__button__preview__no-color-indicator",i["if"]("value","ck-hidden",function(e){return""!=e;})]}}]}),s.buttonView.extendTemplate({attributes:{"class":"ck-input-color__button"}}),s.buttonView.children.add(o),s.buttonView.label=t("Color picker"),s.buttonView.tooltip=!0,s.panelPosition="rtl"===e.uiLanguageDirection?"se":"sw",s.panelView.children.add(n),s.bind("isEnabled").to(this,"isReadOnly",function(e){return!e;}),s.on("change:isOpen",function(e,t,i){i&&(n.updateSelectedColors(),n.showColorGridsFragment());}),s;}},{key:"_createInputTextView",value:function _createInputTextView(){var _this809=this;var e=this.locale,t=new _f(e);return t.extendTemplate({on:{blur:t.bindTemplate.to("blur")}}),t.value=this.value,t.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(t),t.on("input",function(){var e=t.element.value,i=_this809.options.colorDefinitions.find(function(t){return e===t.label;});_this809._stillTyping=!0,_this809.value=i&&i.color||e;}),t.on("blur",function(){_this809._stillTyping=!1,_this809._setInputValue(t.element.value);}),t.delegate("input").to(this),t;}},{key:"_createColorSelector",value:function _createColorSelector(e){var _this810=this;var t=e.t,i=this.options.defaultColorValue||"",n=t(i?"Restore default":"Remove color"),s=new Jp(e,{colors:this.options.colorDefinitions,columns:this.options.columns,removeButtonLabel:n,colorPickerLabel:t("Color picker"),colorPickerViewConfig:!1!==this.options.colorPickerConfig&&_objectSpread(_objectSpread({},this.options.colorPickerConfig),{},{hideInput:!0})});s.appendUI(),s.on("execute",function(e,t){"colorPickerSaveButton"!==t.source?(_this810.value=t.value||i,_this810.fire("input"),"colorPicker"!==t.source&&(_this810.dropdownView.isOpen=!1)):_this810.dropdownView.isOpen=!1;});var o=this.value;return s.on("colorPicker:cancel",function(){_this810.value=o,_this810.fire("input"),_this810.dropdownView.isOpen=!1;}),s.colorGridsFragmentView.colorPickerButtonView.on("execute",function(){o=_this810.value;}),s.bind("selectedColor").to(this,"value"),s;}},{key:"_setInputValue",value:function _setInputValue(e){if(!this._stillTyping){var _t576=xL(e),_i634=this.options.colorDefinitions.find(function(e){return _t576===xL(e.color);});this.inputView.value=_i634?_i634.label:e||"";}}}]);}(lg);function xL(e){return e.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ");}var AL=function AL(e){return""===e;};function EL(e){return{none:e("None"),solid:e("Solid"),dotted:e("Dotted"),dashed:e("Dashed"),"double":e("Double"),groove:e("Groove"),ridge:e("Ridge"),inset:e("Inset"),outset:e("Outset")};}function TL(e){return e('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".');}function PL(e){return e('The value is invalid. Try "10px" or "2em" or simply "2".');}function SL(e){return e=e.trim().toLowerCase(),AL(e)||Xu(e);}function IL(e){return e=e.trim(),AL(e)||LL(e)||nh(e)||oh(e);}function VL(e){return e=e.trim(),AL(e)||LL(e)||nh(e);}function RL(e,t){var i=new br(),n=EL(e.t);var _loop43=function _loop43(_s243){var o={type:"button",model:new Fb({_borderStyleValue:_s243,label:n[_s243],role:"menuitemradio",withText:!0})};"none"===_s243?o.model.bind("isOn").to(e,"borderStyle",function(e){return"none"===t?!e:e===_s243;}):o.model.bind("isOn").to(e,"borderStyle",function(e){return e===_s243;}),i.add(o);};for(var _s243 in n){_loop43(_s243);}return i;}function OL(e){var t=e.view,i=e.icons,n=e.toolbar,s=e.labels,o=e.propertyName,r=e.nameToValue,a=e.defaultValue;var _loop44=function _loop44(){var l=new pg(t.locale);l.set({label:s[_e841],icon:i[_e841],tooltip:s[_e841]});var c=r?r(_e841):_e841;l.bind("isOn").to(t,o,function(e){var t=e;return""===e&&a&&(t=a),c===t;}),l.on("execute",function(){t[o]=c;}),n.items.add(l);};for(var _e841 in s){_loop44();}}var BL=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function ML(e){return function(t,i,n){var s=new CL(t.locale,{colorDefinitions:(o=e.colorConfig,o.map(function(e){return{color:e.model,label:e.label,options:{hasBorder:e.hasBorder}};})),columns:e.columns,defaultColorValue:e.defaultColorValue,colorPickerConfig:e.colorPickerConfig});var o;return s.inputView.set({id:i,ariaDescribedById:n}),s.bind("isReadOnly").to(t,"isEnabled",function(e){return!e;}),s.bind("hasError").to(t,"errorText",function(e){return!!e;}),s.on("input",function(){t.errorText=null;}),t.bind("isEmpty","isFocused").to(s),s;};}function LL(e){var t=parseFloat(e);return!Number.isNaN(t)&&e===String(t);}var FL=/*#__PURE__*/function(_lg76){function FL(e){var _this811;var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,FL);_this811=_callSuper(this,FL,[e]);_defineProperty(_this811,"children",void 0);var i=_this811.bindTemplate;_this811.set("class",t["class"]||null),_this811.children=_this811.createCollection(),t.children&&t.children.forEach(function(e){return _this811.children.add(e);}),_this811.set("_role",null),_this811.set("_ariaLabelledBy",null),t.labelView&&_this811.set({_role:"group",_ariaLabelledBy:t.labelView.id}),_this811.setTemplate({tag:"div",attributes:{"class":["ck","ck-form__row",i.to("class")],role:i.to("_role"),"aria-labelledby":i.to("_ariaLabelledBy")},children:_this811.children});return _this811;}_inherits(FL,_lg76);return _createClass(FL);}(lg);var NL=/*#__PURE__*/function(_lg77){function NL(e,t){var _this812;_classCallCheck(this,NL);_this812=_callSuper(this,NL,[e]),_defineProperty(_assertThisInitialized(_this812),"options",void 0),_defineProperty(_assertThisInitialized(_this812),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this812),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this812),"children",void 0),_defineProperty(_assertThisInitialized(_this812),"borderStyleDropdown",void 0),_defineProperty(_assertThisInitialized(_this812),"borderWidthInput",void 0),_defineProperty(_assertThisInitialized(_this812),"borderColorInput",void 0),_defineProperty(_assertThisInitialized(_this812),"backgroundInput",void 0),_defineProperty(_assertThisInitialized(_this812),"paddingInput",void 0),_defineProperty(_assertThisInitialized(_this812),"widthInput",void 0),_defineProperty(_assertThisInitialized(_this812),"heightInput",void 0),_defineProperty(_assertThisInitialized(_this812),"horizontalAlignmentToolbar",void 0),_defineProperty(_assertThisInitialized(_this812),"verticalAlignmentToolbar",void 0),_defineProperty(_assertThisInitialized(_this812),"saveButtonView",void 0),_defineProperty(_assertThisInitialized(_this812),"cancelButtonView",void 0),_defineProperty(_assertThisInitialized(_this812),"_focusables",void 0),_defineProperty(_assertThisInitialized(_this812),"_focusCycler",void 0),_this812.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),_this812.options=t;var _this812$_createBorde=_this812._createBorderFields(),i=_this812$_createBorde.borderStyleDropdown,n=_this812$_createBorde.borderWidthInput,s=_this812$_createBorde.borderColorInput,o=_this812$_createBorde.borderRowLabel,_this812$_createBackg=_this812._createBackgroundFields(),r=_this812$_createBackg.backgroundRowLabel,a=_this812$_createBackg.backgroundInput,_this812$_createDimen=_this812._createDimensionFields(),l=_this812$_createDimen.widthInput,c=_this812$_createDimen.operatorLabel,d=_this812$_createDimen.heightInput,u=_this812$_createDimen.dimensionsLabel,_this812$_createAlign=_this812._createAlignmentFields(),h=_this812$_createAlign.horizontalAlignmentToolbar,m=_this812$_createAlign.verticalAlignmentToolbar,g=_this812$_createAlign.alignmentLabel;_this812.focusTracker=new _r(),_this812.keystrokes=new Cr(),_this812.children=_this812.createCollection(),_this812.borderStyleDropdown=i,_this812.borderWidthInput=n,_this812.borderColorInput=s,_this812.backgroundInput=a,_this812.paddingInput=_this812._createPaddingField(),_this812.widthInput=l,_this812.heightInput=d,_this812.horizontalAlignmentToolbar=h,_this812.verticalAlignmentToolbar=m;var _this812$_createActio=_this812._createActionButtons(),f=_this812$_createActio.saveButtonView,p=_this812$_createActio.cancelButtonView;_this812.saveButtonView=f,_this812.cancelButtonView=p,_this812._focusables=new zm(),_this812._focusCycler=new _g({focusables:_this812._focusables,focusTracker:_this812.focusTracker,keystrokeHandler:_this812.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this812.children.add(new wg(e,{label:_this812.t("Cell properties")})),_this812.children.add(new FL(e,{labelView:o,children:[o,i,s,n],"class":"ck-table-form__border-row"})),_this812.children.add(new FL(e,{labelView:r,children:[r,a],"class":"ck-table-form__background-row"})),_this812.children.add(new FL(e,{children:[new FL(e,{labelView:u,children:[u,l,c,d],"class":"ck-table-form__dimensions-row"}),new FL(e,{children:[_this812.paddingInput],"class":"ck-table-cell-properties-form__padding-row"})]})),_this812.children.add(new FL(e,{labelView:g,children:[g,h,m],"class":"ck-table-cell-properties-form__alignment-row"})),_this812.children.add(new FL(e,{children:[_this812.saveButtonView,_this812.cancelButtonView],"class":"ck-table-form__action-row"})),_this812.setTemplate({tag:"form",attributes:{"class":["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:_this812.children});return _this812;}_inherits(NL,_lg77);return _createClass(NL,[{key:"render",value:function render(){var _this813=this;_superPropGet(NL,"render",this,3)([]),hg({view:this}),[this.borderColorInput,this.backgroundInput].forEach(function(e){_this813._focusCycler.chain(e.fieldView.focusCycler);}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(function(e){_this813._focusables.add(e),_this813.focusTracker.add(e.element);}),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(NL,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"_createBorderFields",value:function _createBorderFields(){var _this814=this;var e=this.options.defaultTableCellProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=ML({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),n=this.locale,s=this.t,o=s("Style"),r=new Og(n);r.text=s("Border");var a=EL(s),l=new pf(n,hp);l.set({label:o,"class":"ck-table-form__border-style"}),l.fieldView.buttonView.set({ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),l.fieldView.buttonView.bind("label").to(this,"borderStyle",function(e){return a[e||"none"];}),l.fieldView.on("execute",function(e){_this814.borderStyle=e.source._borderStyleValue;}),l.bind("isEmpty").to(this,"borderStyle",function(e){return!e;}),sp(l.fieldView,RL(this,t.style),{role:"menu",ariaLabel:o});var c=new pf(n,cp);c.set({label:s("Width"),"class":"ck-table-form__border-width"}),c.fieldView.bind("value").to(this,"borderWidth"),c.bind("isEnabled").to(this,"borderStyle",DL),c.fieldView.on("input",function(){_this814.borderWidth=c.fieldView.element.value;});var d=new pf(n,i);return d.set({label:s("Color"),"class":"ck-table-form__border-color"}),d.fieldView.bind("value").to(this,"borderColor"),d.bind("isEnabled").to(this,"borderStyle",DL),d.fieldView.on("input",function(){_this814.borderColor=d.fieldView.value;}),this.on("change:borderStyle",function(e,i,n,s){DL(n)||(_this814.borderColor="",_this814.borderWidth=""),DL(s)||(_this814.borderColor=t.color,_this814.borderWidth=t.width);}),{borderRowLabel:r,borderStyleDropdown:l,borderColorInput:d,borderWidthInput:c};}},{key:"_createBackgroundFields",value:function _createBackgroundFields(){var _this815=this;var e=this.locale,t=this.t,i=new Og(e);i.text=t("Background");var n=ML({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),s=new pf(e,n);return s.set({label:t("Color"),"class":"ck-table-cell-properties-form__background"}),s.fieldView.bind("value").to(this,"backgroundColor"),s.fieldView.on("input",function(){_this815.backgroundColor=s.fieldView.value;}),{backgroundRowLabel:i,backgroundInput:s};}},{key:"_createDimensionFields",value:function _createDimensionFields(){var _this816=this;var e=this.locale,t=this.t,i=new Og(e);i.text=t("Dimensions");var n=new pf(e,cp);n.set({label:t("Width"),"class":"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",function(){_this816.width=n.fieldView.element.value;});var s=new lg(e);s.setTemplate({tag:"span",attributes:{"class":["ck-table-form__dimension-operator"]},children:[{text:"×"}]});var o=new pf(e,cp);return o.set({label:t("Height"),"class":"ck-table-form__dimensions-row__height"}),o.fieldView.bind("value").to(this,"height"),o.fieldView.on("input",function(){_this816.height=o.fieldView.element.value;}),{dimensionsLabel:i,widthInput:n,operatorLabel:s,heightInput:o};}},{key:"_createPaddingField",value:function _createPaddingField(){var _this817=this;var e=this.locale,t=this.t,i=new pf(e,cp);return i.set({label:t("Padding"),"class":"ck-table-cell-properties-form__padding"}),i.fieldView.bind("value").to(this,"padding"),i.fieldView.on("input",function(){_this817.padding=i.fieldView.element.value;}),i;}},{key:"_createAlignmentFields",value:function _createAlignmentFields(){var e=this.locale,t=this.t,i=new Og(e),n={left:vm.alignLeft,center:vm.alignCenter,right:vm.alignRight,justify:vm.alignJustify,top:vm.alignTop,middle:vm.alignMiddle,bottom:vm.alignBottom};i.text=t("Table cell text alignment");var s=new Kf(e),o="rtl"===e.contentLanguageDirection;s.set({isCompact:!0,ariaLabel:t("Horizontal text alignment toolbar")}),OL({view:this,icons:n,toolbar:s,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:function nameToValue(e){if(o){if("left"===e)return"right";if("right"===e)return"left";}return e;},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});var r=new Kf(e);return r.set({isCompact:!0,ariaLabel:t("Vertical text alignment toolbar")}),OL({view:this,icons:n,toolbar:r,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:s,verticalAlignmentToolbar:r,alignmentLabel:i};}},{key:"_createActionButtons",value:function _createActionButtons(){var e=this.locale,t=this.t,i=new pg(e),n=new pg(e),s=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return i.set({label:t("Save"),icon:vm.check,"class":"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(s,"errorText",function(){for(var _len103=arguments.length,e=new Array(_len103),_key103=0;_key103<_len103;_key103++){e[_key103]=arguments[_key103];}return e.every(function(e){return!e;});}),n.set({label:t("Cancel"),icon:vm.cancel,"class":"ck-button-cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:n};}},{key:"_horizontalAlignmentLabels",get:function get(){var e=this.locale,t=this.t,i=t("Align cell text to the left"),n=t("Align cell text to the center"),s=t("Align cell text to the right"),o=t("Justify cell text");return"rtl"===e.uiLanguageDirection?{right:s,center:n,left:i,justify:o}:{left:i,center:n,right:s,justify:o};}},{key:"_verticalAlignmentLabels",get:function get(){var e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")};}}]);}(lg);function DL(e){return"none"!==e;}var zL=function(){return[Df.defaultPositions.northArrowSouth,Df.defaultPositions.northArrowSouthWest,Df.defaultPositions.northArrowSouthEast,Df.defaultPositions.southArrowNorth,Df.defaultPositions.southArrowNorthWest,Df.defaultPositions.southArrowNorthEast,Df.defaultPositions.viewportStickyNorth];}();function HL(e,t){var i=e.plugins.get("ContextualBalloon"),n=e.editing.view.document.selection;var s;"cell"===t?vL(n)&&(s=UL(e)):wL(n)&&(s=$L(e)),s&&i.updatePosition(s);}function $L(e){var t=qB(e.model.document.selection),i=e.editing.mapper.toViewElement(t);return{target:e.editing.view.domConverter.mapViewToDom(i),positions:zL};}function UL(e){var t=e.editing.mapper,i=e.editing.view.domConverter,n=e.model.document.selection;if(n.rangeCount>1)return{target:function target(){return function(e,t){var i=t.editing.mapper,n=t.editing.view.domConverter,s=Array.from(e).map(function(e){var t=WL(e.start),s=i.toViewElement(t);return new Eo(n.mapViewToDom(s));});return Eo.getBoundingRect(s);}(n.getRanges(),e);},positions:zL};var s=WL(n.getFirstPosition()),o=t.toViewElement(s);return{target:i.mapViewToDom(o),positions:zL};}function WL(e){return e.nodeAfter&&e.nodeAfter.is("element","tableCell")?e.nodeAfter:e.findAncestor("tableCell");}function jL(e){if(!e||!ue(e))return e;var t=e.top,i=e.right,n=e.bottom,s=e.left;return t==i&&i==n&&n==s?t:void 0;}function qL(e,t){var i=parseFloat(e);return Number.isNaN(i)||String(i)!==String(e)?e:"".concat(i).concat(t);}function GL(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=_objectSpread({borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:""},e);return t.includeAlignmentProperty&&!i.alignment&&(i.alignment="center"),t.includePaddingProperty&&!i.padding&&(i.padding=""),t.includeVerticalAlignmentProperty&&!i.verticalAlignment&&(i.verticalAlignment="middle"),t.includeHorizontalAlignmentProperty&&!i.horizontalAlignment&&(i.horizontalAlignment=t.isRightToLeftContent?"right":"left"),i;}function KL(e,t){return GL(_objectSpread({borderStyle:"double",borderColor:"hsl(0, 0%, 70%)",borderWidth:"1px"},e),t);}function ZL(e,t){return GL(_objectSpread({borderStyle:"solid",borderColor:"hsl(0, 0%, 75%)",borderWidth:"1px"},e),t);}var JL={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",height:"tableCellHeight",width:"tableCellWidth",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};var QL=/*#__PURE__*/function(_Dr251){function QL(e){var _this818;_classCallCheck(this,QL);_this818=_callSuper(this,QL,[e]),_defineProperty(_assertThisInitialized(_this818),"_defaultTableCellProperties",void 0),_defineProperty(_assertThisInitialized(_this818),"_balloon",void 0),_defineProperty(_assertThisInitialized(_this818),"view",void 0),_defineProperty(_assertThisInitialized(_this818),"_undoStepBatch",void 0),_defineProperty(_assertThisInitialized(_this818),"_isReady",void 0),e.config.define("table.tableCellProperties",{borderColors:BL,backgroundColors:BL});return _this818;}_inherits(QL,_Dr251);return _createClass(QL,[{key:"init",value:function init(){var _this819=this;var e=this.editor,t=e.t;this._defaultTableCellProperties=ZL(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection}),this._balloon=e.plugins.get(Db),this.view=null,this._isReady=!1,e.ui.componentFactory.add("tableCellProperties",function(i){var n=new pg(i);n.set({label:t("Cell properties"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>',tooltip:!0}),_this819.listenTo(n,"execute",function(){return _this819._showView();});var s=Object.values(JL).map(function(t){return e.commands.get(t);});return n.bind("isEnabled").toMany(s,"isEnabled",function(){for(var _len104=arguments.length,e=new Array(_len104),_key104=0;_key104<_len104;_key104++){e[_key104]=arguments[_key104];}return e.some(function(e){return e;});}),n;});}},{key:"destroy",value:function destroy(){_superPropGet(QL,"destroy",this,3)([]),this.view&&this.view.destroy();}},{key:"_createPropertiesView",value:function _createPropertiesView(){var _this820=this;var e=this.editor,t=e.config.get("table.tableCellProperties"),i=Gg(t.borderColors),n=qg(e.locale,i),s=Gg(t.backgroundColors),o=qg(e.locale,s),r=!1!==t.colorPicker,a=new NL(e.locale,{borderColors:n,backgroundColors:o,defaultTableCellProperties:this._defaultTableCellProperties,colorPickerConfig:!!r&&(t.colorPicker||{})}),l=e.t;a.render(),this.listenTo(a,"submit",function(){_this820._hideView();}),this.listenTo(a,"cancel",function(){_this820._undoStepBatch.operations.length&&e.execute("undo",_this820._undoStepBatch),_this820._hideView();}),a.keystrokes.set("Esc",function(e,t){_this820._hideView(),t();}),cg({emitter:a,activator:function activator(){return _this820._isViewInBalloon;},contextElements:[this._balloon.view.element],callback:function callback(){return _this820._hideView();}});var c=TL(l),d=PL(l);return a.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),a.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:a.borderColorInput,commandName:"tableCellBorderColor",errorText:c,validator:SL})),a.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:a.borderWidthInput,commandName:"tableCellBorderWidth",errorText:d,validator:VL})),a.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:a.paddingInput,commandName:"tableCellPadding",errorText:d,validator:IL})),a.on("change:width",this._getValidatedPropertyChangeCallback({viewField:a.widthInput,commandName:"tableCellWidth",errorText:d,validator:IL})),a.on("change:height",this._getValidatedPropertyChangeCallback({viewField:a.heightInput,commandName:"tableCellHeight",errorText:d,validator:IL})),a.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:a.backgroundInput,commandName:"tableCellBackgroundColor",errorText:c,validator:SL})),a.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),a.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),a;}},{key:"_fillViewFormFromCommandValues",value:function _fillViewFormFromCommandValues(){var _this821=this;var e=this.editor.commands,t=e.get("tableCellBorderStyle");Object.entries(JL).map(function(_ref347){var _ref348=_slicedToArray(_ref347,2),t=_ref348[0],i=_ref348[1];var n=_this821._defaultTableCellProperties[t]||"";return[t,e.get(i).value||n];}).forEach(function(_ref349){var _ref350=_slicedToArray(_ref349,2),e=_ref350[0],i=_ref350[1];("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&_this821.view.set(e,i);}),this._isReady=!0;}},{key:"_showView",value:function _showView(){var _this822=this;var e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",function(){_this822._updateView();}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:UL(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus();}},{key:"_hideView",value:function _hideView(){var e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus();}},{key:"_updateView",value:function _updateView(){var e=this.editor;vL(e.editing.view.document.selection)?this._isViewVisible&&HL(e,"cell"):this._hideView();}},{key:"_isViewVisible",get:function get(){return!!this.view&&this._balloon.visibleView===this.view;}},{key:"_isViewInBalloon",get:function get(){return!!this.view&&this._balloon.hasView(this.view);}},{key:"_getPropertyChangeCallback",value:function _getPropertyChangeCallback(e){var _this823=this;return function(t,i,n){_this823._isReady&&_this823.editor.execute(e,{value:n,batch:_this823._undoStepBatch});};}},{key:"_getValidatedPropertyChangeCallback",value:function _getValidatedPropertyChangeCallback(e){var _this824=this;var t=e.commandName,i=e.viewField,n=e.validator,s=e.errorText,o=vs(function(){i.errorText=s;},500);return function(e,s,r){o.cancel(),_this824._isReady&&(n(r)?(_this824.editor.execute(t,{value:r,batch:_this824._undoStepBatch}),i.errorText=null):o());};}}],[{key:"requires",get:function get(){return[Db];}},{key:"pluginName",get:function get(){return"TableCellPropertiesUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var YL=/*#__PURE__*/function(_Hr74){function YL(e,t,i){var _this825;_classCallCheck(this,YL);_this825=_callSuper(this,YL,[e]),_defineProperty(_assertThisInitialized(_this825),"attributeName",void 0),_defineProperty(_assertThisInitialized(_this825),"_defaultValue",void 0),_this825.attributeName=t,_this825._defaultValue=i;return _this825;}_inherits(YL,_Hr74);return _createClass(YL,[{key:"refresh",value:function refresh(){var e=this.editor,t=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e.model.document.selection);this.isEnabled=!!t.length,this.value=this._getSingleValue(t);}},{key:"execute",value:function execute(){var _this826=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=e.value,i=e.batch,n=this.editor.model,s=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(n.document.selection),o=this._getValueToSet(t);n.enqueueChange(i,function(e){o?s.forEach(function(t){return e.setAttribute(_this826.attributeName,o,t);}):s.forEach(function(t){return e.removeAttribute(_this826.attributeName,t);});});}},{key:"_getAttribute",value:function _getAttribute(e){if(!e)return;var t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0;}},{key:"_getValueToSet",value:function _getValueToSet(e){if(e!==this._defaultValue)return e;}},{key:"_getSingleValue",value:function _getSingleValue(e){var _this827=this;var t=this._getAttribute(e[0]);return e.every(function(e){return _this827._getAttribute(e)===t;})?t:void 0;}}]);}(Hr);var XL=/*#__PURE__*/function(_YL2){function XL(e,t){_classCallCheck(this,XL);return _callSuper(this,XL,[e,"tableCellWidth",t]);}_inherits(XL,_YL2);return _createClass(XL,[{key:"_getValueToSet",value:function _getValueToSet(e){if((e=qL(e,"px"))!==this._defaultValue)return e;}}]);}(YL);var eF=/*#__PURE__*/function(_Dr252){function eF(){_classCallCheck(this,eF);return _callSuper(this,eF,arguments);}_inherits(eF,_Dr252);return _createClass(eF,[{key:"init",value:function init(){var e=this.editor,t=ZL(e.config.get("table.tableCellProperties.defaultProperties"));jB(e.model.schema,e.conversion,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:t.width}),e.commands.add("tableCellWidth",new XL(e,t.width));}}],[{key:"pluginName",get:function get(){return"TableCellWidthEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[tL];}}]);}(Dr);var tF=/*#__PURE__*/function(_YL3){function tF(e,t){_classCallCheck(this,tF);return _callSuper(this,tF,[e,"tableCellPadding",t]);}_inherits(tF,_YL3);return _createClass(tF,[{key:"_getAttribute",value:function _getAttribute(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}},{key:"_getValueToSet",value:function _getValueToSet(e){var t=qL(e,"px");if(t!==this._defaultValue)return t;}}]);}(YL);var iF=/*#__PURE__*/function(_YL4){function iF(e,t){_classCallCheck(this,iF);return _callSuper(this,iF,[e,"tableCellHeight",t]);}_inherits(iF,_YL4);return _createClass(iF,[{key:"_getValueToSet",value:function _getValueToSet(e){var t=qL(e,"px");if(t!==this._defaultValue)return t;}}]);}(YL);var nF=/*#__PURE__*/function(_YL5){function nF(e,t){_classCallCheck(this,nF);return _callSuper(this,nF,[e,"tableCellBackgroundColor",t]);}_inherits(nF,_YL5);return _createClass(nF);}(YL);var sF=/*#__PURE__*/function(_YL6){function sF(e,t){_classCallCheck(this,sF);return _callSuper(this,sF,[e,"tableCellVerticalAlignment",t]);}_inherits(sF,_YL6);return _createClass(sF);}(YL);var oF=/*#__PURE__*/function(_YL7){function oF(e,t){_classCallCheck(this,oF);return _callSuper(this,oF,[e,"tableCellHorizontalAlignment",t]);}_inherits(oF,_YL7);return _createClass(oF);}(YL);var rF=/*#__PURE__*/function(_YL8){function rF(e,t){_classCallCheck(this,rF);return _callSuper(this,rF,[e,"tableCellBorderStyle",t]);}_inherits(rF,_YL8);return _createClass(rF,[{key:"_getAttribute",value:function _getAttribute(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}}]);}(YL);var aF=/*#__PURE__*/function(_YL9){function aF(e,t){_classCallCheck(this,aF);return _callSuper(this,aF,[e,"tableCellBorderColor",t]);}_inherits(aF,_YL9);return _createClass(aF,[{key:"_getAttribute",value:function _getAttribute(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}}]);}(YL);var lF=/*#__PURE__*/function(_YL10){function lF(e,t){_classCallCheck(this,lF);return _callSuper(this,lF,[e,"tableCellBorderWidth",t]);}_inherits(lF,_YL10);return _createClass(lF,[{key:"_getAttribute",value:function _getAttribute(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}},{key:"_getValueToSet",value:function _getValueToSet(e){var t=qL(e,"px");if(t!==this._defaultValue)return t;}}]);}(YL);var cF=/^(top|middle|bottom)$/,dF=/^(left|center|right|justify)$/;var uF=/*#__PURE__*/function(_Dr253){function uF(){_classCallCheck(this,uF);return _callSuper(this,uF,arguments);}_inherits(uF,_Dr253);return _createClass(uF,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableCellProperties.defaultProperties",{});var n=ZL(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:"rtl"===e.locale.contentLanguageDirection});e.data.addStyleProcessorRules(vh),function(e,t,i){var n={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};e.extend("tableCell",{allowAttributes:Object.values(n)}),NB(t,"td",n,i),NB(t,"th",n,i),DB(t,{modelElement:"tableCell",modelAttribute:n.style,styleName:"border-style"}),DB(t,{modelElement:"tableCell",modelAttribute:n.color,styleName:"border-color"}),DB(t,{modelElement:"tableCell",modelAttribute:n.width,styleName:"border-width"});}(t,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),e.commands.add("tableCellBorderStyle",new rF(e,n.borderStyle)),e.commands.add("tableCellBorderColor",new aF(e,n.borderColor)),e.commands.add("tableCellBorderWidth",new lF(e,n.borderWidth)),jB(t,i,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:n.height}),e.commands.add("tableCellHeight",new iF(e,n.height)),e.data.addStyleProcessorRules(Vh),jB(t,i,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:n.padding}),e.commands.add("tableCellPadding",new tF(e,n.padding)),e.data.addStyleProcessorRules(_h),jB(t,i,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),e.commands.add("tableCellBackgroundColor",new nF(e,n.backgroundColor)),function(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),t["for"]("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:function view(e){return{key:"style",value:{"text-align":e}};}}),t["for"]("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":dF}},model:{key:"tableCellHorizontalAlignment",value:function value(e){var t=e.getStyle("text-align");return t===i?null:t;}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:dF}},model:{key:"tableCellHorizontalAlignment",value:function value(e){var t=e.getAttribute("align");return t===i?null:t;}}});}(t,i,n.horizontalAlignment),e.commands.add("tableCellHorizontalAlignment",new oF(e,n.horizontalAlignment)),function(e,t,i){e.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),t["for"]("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:function view(e){return{key:"style",value:{"vertical-align":e}};}}),t["for"]("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":cF}},model:{key:"tableCellVerticalAlignment",value:function value(e){var t=e.getStyle("vertical-align");return t===i?null:t;}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:cF}},model:{key:"tableCellVerticalAlignment",value:function value(e){var t=e.getAttribute("valign");return t===i?null:t;}}});}(t,i,n.verticalAlignment),e.commands.add("tableCellVerticalAlignment",new sF(e,n.verticalAlignment));}}],[{key:"pluginName",get:function get(){return"TableCellPropertiesEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[tL,eF];}}]);}(Dr);var hF=/*#__PURE__*/function(_Dr254){function hF(){_classCallCheck(this,hF);return _callSuper(this,hF,arguments);}_inherits(hF,_Dr254);return _createClass(hF,null,[{key:"pluginName",get:function get(){return"TableCellProperties";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[uF,QL];}}]);}(Dr);var mF=/*#__PURE__*/function(_Hr75){function mF(e,t,i){var _this828;_classCallCheck(this,mF);_this828=_callSuper(this,mF,[e]),_defineProperty(_assertThisInitialized(_this828),"attributeName",void 0),_defineProperty(_assertThisInitialized(_this828),"_defaultValue",void 0),_this828.attributeName=t,_this828._defaultValue=i;return _this828;}_inherits(mF,_Hr75);return _createClass(mF,[{key:"refresh",value:function refresh(){var e=qB(this.editor.model.document.selection);this.isEnabled=!!e,this.value=this._getValue(e);}},{key:"execute",value:function execute(){var _this829=this;var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=this.editor.model,i=t.document.selection,n=e.value,s=e.batch,o=qB(i),r=this._getValueToSet(n);t.enqueueChange(s,function(e){r?e.setAttribute(_this829.attributeName,r,o):e.removeAttribute(_this829.attributeName,o);});}},{key:"_getValue",value:function _getValue(e){if(!e)return;var t=e.getAttribute(this.attributeName);return t!==this._defaultValue?t:void 0;}},{key:"_getValueToSet",value:function _getValueToSet(e){if(e!==this._defaultValue)return e;}}]);}(Hr);var gF=/*#__PURE__*/function(_mF2){function gF(e,t){_classCallCheck(this,gF);return _callSuper(this,gF,[e,"tableBackgroundColor",t]);}_inherits(gF,_mF2);return _createClass(gF);}(mF);var fF=/*#__PURE__*/function(_mF3){function fF(e,t){_classCallCheck(this,fF);return _callSuper(this,fF,[e,"tableBorderColor",t]);}_inherits(fF,_mF3);return _createClass(fF,[{key:"_getValue",value:function _getValue(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}}]);}(mF);var pF=/*#__PURE__*/function(_mF4){function pF(e,t){_classCallCheck(this,pF);return _callSuper(this,pF,[e,"tableBorderStyle",t]);}_inherits(pF,_mF4);return _createClass(pF,[{key:"_getValue",value:function _getValue(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}}]);}(mF);var bF=/*#__PURE__*/function(_mF5){function bF(e,t){_classCallCheck(this,bF);return _callSuper(this,bF,[e,"tableBorderWidth",t]);}_inherits(bF,_mF5);return _createClass(bF,[{key:"_getValue",value:function _getValue(e){if(!e)return;var t=jL(e.getAttribute(this.attributeName));return t!==this._defaultValue?t:void 0;}},{key:"_getValueToSet",value:function _getValueToSet(e){var t=qL(e,"px");if(t!==this._defaultValue)return t;}}]);}(mF);var wF=/*#__PURE__*/function(_mF6){function wF(e,t){_classCallCheck(this,wF);return _callSuper(this,wF,[e,"tableWidth",t]);}_inherits(wF,_mF6);return _createClass(wF,[{key:"_getValueToSet",value:function _getValueToSet(e){if((e=qL(e,"px"))!==this._defaultValue)return e;}}]);}(mF);var _F=/*#__PURE__*/function(_mF7){function _F(e,t){_classCallCheck(this,_F);return _callSuper(this,_F,[e,"tableHeight",t]);}_inherits(_F,_mF7);return _createClass(_F,[{key:"_getValueToSet",value:function _getValueToSet(e){if((e=qL(e,"px"))!==this._defaultValue)return e;}}]);}(mF);var vF=/*#__PURE__*/function(_mF8){function vF(e,t){_classCallCheck(this,vF);return _callSuper(this,vF,[e,"tableAlignment",t]);}_inherits(vF,_mF8);return _createClass(vF);}(mF);var yF=/^(left|center|right)$/,kF=/^(left|none|right)$/;var CF=/*#__PURE__*/function(_Dr255){function CF(){_classCallCheck(this,CF);return _callSuper(this,CF,arguments);}_inherits(CF,_Dr255);return _createClass(CF,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.conversion;e.config.define("table.tableProperties.defaultProperties",{});var n=KL(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});e.data.addStyleProcessorRules(vh),function(e,t,i){var n={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};e.extend("table",{allowAttributes:Object.values(n)}),NB(t,"table",n,i),zB(t,{modelAttribute:n.color,styleName:"border-color"}),zB(t,{modelAttribute:n.style,styleName:"border-style"}),zB(t,{modelAttribute:n.width,styleName:"border-width"});}(t,i,{color:n.borderColor,style:n.borderStyle,width:n.borderWidth}),e.commands.add("tableBorderColor",new fF(e,n.borderColor)),e.commands.add("tableBorderStyle",new pF(e,n.borderStyle)),e.commands.add("tableBorderWidth",new bF(e,n.borderWidth)),function(e,t,i){e.extend("table",{allowAttributes:["tableAlignment"]}),t["for"]("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:function view(e){return{key:"style",value:{"float":"center"===e?"none":e}};},converterPriority:"high"}),t["for"]("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{"float":kF}},model:{key:"tableAlignment",value:function value(e){var t=e.getStyle("float");return"none"===t&&(t="center"),t===i?null:t;}}}).attributeToAttribute({view:{attributes:{align:yF}},model:{name:"table",key:"tableAlignment",value:function value(e){var t=e.getAttribute("align");return t===i?null:t;}}});}(t,i,n.alignment),e.commands.add("tableAlignment",new vF(e,n.alignment)),xF(t,i,{modelAttribute:"tableWidth",styleName:"width",defaultValue:n.width}),e.commands.add("tableWidth",new wF(e,n.width)),xF(t,i,{modelAttribute:"tableHeight",styleName:"height",defaultValue:n.height}),e.commands.add("tableHeight",new _F(e,n.height)),e.data.addStyleProcessorRules(_h),function(e,t,i){var n=i.modelAttribute;e.extend("table",{allowAttributes:[n]}),FB(t,_objectSpread({viewElement:"table"},i)),zB(t,i);}(t,i,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:n.backgroundColor}),e.commands.add("tableBackgroundColor",new gF(e,n.backgroundColor));}}],[{key:"pluginName",get:function get(){return"TablePropertiesEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[tL];}}]);}(Dr);function xF(e,t,i){var n=i.modelAttribute;e.extend("table",{allowAttributes:[n]}),FB(t,_objectSpread({viewElement:/^(table|figure)$/,shouldUpcast:function shouldUpcast(e){return!("table"==e.name&&"figure"==e.parent.name);}},i)),DB(t,_objectSpread({modelElement:"table"},i));}var AF=/*#__PURE__*/function(_lg78){function AF(e,t){var _this830;_classCallCheck(this,AF);_this830=_callSuper(this,AF,[e]),_defineProperty(_assertThisInitialized(_this830),"options",void 0),_defineProperty(_assertThisInitialized(_this830),"focusTracker",void 0),_defineProperty(_assertThisInitialized(_this830),"keystrokes",void 0),_defineProperty(_assertThisInitialized(_this830),"children",void 0),_defineProperty(_assertThisInitialized(_this830),"borderStyleDropdown",void 0),_defineProperty(_assertThisInitialized(_this830),"borderWidthInput",void 0),_defineProperty(_assertThisInitialized(_this830),"borderColorInput",void 0),_defineProperty(_assertThisInitialized(_this830),"backgroundInput",void 0),_defineProperty(_assertThisInitialized(_this830),"widthInput",void 0),_defineProperty(_assertThisInitialized(_this830),"heightInput",void 0),_defineProperty(_assertThisInitialized(_this830),"alignmentToolbar",void 0),_defineProperty(_assertThisInitialized(_this830),"saveButtonView",void 0),_defineProperty(_assertThisInitialized(_this830),"cancelButtonView",void 0),_defineProperty(_assertThisInitialized(_this830),"_focusables",void 0),_defineProperty(_assertThisInitialized(_this830),"_focusCycler",void 0),_this830.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),_this830.options=t;var _this830$_createBorde=_this830._createBorderFields(),i=_this830$_createBorde.borderStyleDropdown,n=_this830$_createBorde.borderWidthInput,s=_this830$_createBorde.borderColorInput,o=_this830$_createBorde.borderRowLabel,_this830$_createBackg=_this830._createBackgroundFields(),r=_this830$_createBackg.backgroundRowLabel,a=_this830$_createBackg.backgroundInput,_this830$_createDimen=_this830._createDimensionFields(),l=_this830$_createDimen.widthInput,c=_this830$_createDimen.operatorLabel,d=_this830$_createDimen.heightInput,u=_this830$_createDimen.dimensionsLabel,_this830$_createAlign=_this830._createAlignmentFields(),h=_this830$_createAlign.alignmentToolbar,m=_this830$_createAlign.alignmentLabel;_this830.focusTracker=new _r(),_this830.keystrokes=new Cr(),_this830.children=_this830.createCollection(),_this830.borderStyleDropdown=i,_this830.borderWidthInput=n,_this830.borderColorInput=s,_this830.backgroundInput=a,_this830.widthInput=l,_this830.heightInput=d,_this830.alignmentToolbar=h;var _this830$_createActio=_this830._createActionButtons(),g=_this830$_createActio.saveButtonView,f=_this830$_createActio.cancelButtonView;_this830.saveButtonView=g,_this830.cancelButtonView=f,_this830._focusables=new zm(),_this830._focusCycler=new _g({focusables:_this830._focusables,focusTracker:_this830.focusTracker,keystrokeHandler:_this830.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),_this830.children.add(new wg(e,{label:_this830.t("Table properties")})),_this830.children.add(new FL(e,{labelView:o,children:[o,i,s,n],"class":"ck-table-form__border-row"})),_this830.children.add(new FL(e,{labelView:r,children:[r,a],"class":"ck-table-form__background-row"})),_this830.children.add(new FL(e,{children:[new FL(e,{labelView:u,children:[u,l,c,d],"class":"ck-table-form__dimensions-row"}),new FL(e,{labelView:m,children:[m,h],"class":"ck-table-properties-form__alignment-row"})]})),_this830.children.add(new FL(e,{children:[_this830.saveButtonView,_this830.cancelButtonView],"class":"ck-table-form__action-row"})),_this830.setTemplate({tag:"form",attributes:{"class":["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:_this830.children});return _this830;}_inherits(AF,_lg78);return _createClass(AF,[{key:"render",value:function render(){var _this831=this;_superPropGet(AF,"render",this,3)([]),hg({view:this}),[this.borderColorInput,this.backgroundInput].forEach(function(e){_this831._focusCycler.chain(e.fieldView.focusCycler);}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(function(e){_this831._focusables.add(e),_this831.focusTracker.add(e.element);}),this.keystrokes.listenTo(this.element);}},{key:"destroy",value:function destroy(){_superPropGet(AF,"destroy",this,3)([]),this.focusTracker.destroy(),this.keystrokes.destroy();}},{key:"focus",value:function focus(){this._focusCycler.focusFirst();}},{key:"_createBorderFields",value:function _createBorderFields(){var _this832=this;var e=this.options.defaultTableProperties,t={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},i=ML({colorConfig:this.options.borderColors,columns:5,defaultColorValue:t.color,colorPickerConfig:this.options.colorPickerConfig}),n=this.locale,s=this.t,o=s("Style"),r=new Og(n);r.text=s("Border");var a=EL(s),l=new pf(n,hp);l.set({label:o,"class":"ck-table-form__border-style"}),l.fieldView.buttonView.set({ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),l.fieldView.buttonView.bind("label").to(this,"borderStyle",function(e){return a[e||"none"];}),l.fieldView.on("execute",function(e){_this832.borderStyle=e.source._borderStyleValue;}),l.bind("isEmpty").to(this,"borderStyle",function(e){return!e;}),sp(l.fieldView,RL(this,t.style),{role:"menu",ariaLabel:o});var c=new pf(n,cp);c.set({label:s("Width"),"class":"ck-table-form__border-width"}),c.fieldView.bind("value").to(this,"borderWidth"),c.bind("isEnabled").to(this,"borderStyle",EF),c.fieldView.on("input",function(){_this832.borderWidth=c.fieldView.element.value;});var d=new pf(n,i);return d.set({label:s("Color"),"class":"ck-table-form__border-color"}),d.fieldView.bind("value").to(this,"borderColor"),d.bind("isEnabled").to(this,"borderStyle",EF),d.fieldView.on("input",function(){_this832.borderColor=d.fieldView.value;}),this.on("change:borderStyle",function(e,i,n,s){EF(n)||(_this832.borderColor="",_this832.borderWidth=""),EF(s)||(_this832.borderColor=t.color,_this832.borderWidth=t.width);}),{borderRowLabel:r,borderStyleDropdown:l,borderColorInput:d,borderWidthInput:c};}},{key:"_createBackgroundFields",value:function _createBackgroundFields(){var _this833=this;var e=this.locale,t=this.t,i=new Og(e);i.text=t("Background");var n=ML({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),s=new pf(e,n);return s.set({label:t("Color"),"class":"ck-table-properties-form__background"}),s.fieldView.bind("value").to(this,"backgroundColor"),s.fieldView.on("input",function(){_this833.backgroundColor=s.fieldView.value;}),{backgroundRowLabel:i,backgroundInput:s};}},{key:"_createDimensionFields",value:function _createDimensionFields(){var _this834=this;var e=this.locale,t=this.t,i=new Og(e);i.text=t("Dimensions");var n=new pf(e,cp);n.set({label:t("Width"),"class":"ck-table-form__dimensions-row__width"}),n.fieldView.bind("value").to(this,"width"),n.fieldView.on("input",function(){_this834.width=n.fieldView.element.value;});var s=new lg(e);s.setTemplate({tag:"span",attributes:{"class":["ck-table-form__dimension-operator"]},children:[{text:"×"}]});var o=new pf(e,cp);return o.set({label:t("Height"),"class":"ck-table-form__dimensions-row__height"}),o.fieldView.bind("value").to(this,"height"),o.fieldView.on("input",function(){_this834.height=o.fieldView.element.value;}),{dimensionsLabel:i,widthInput:n,operatorLabel:s,heightInput:o};}},{key:"_createAlignmentFields",value:function _createAlignmentFields(){var e=this.locale,t=this.t,i=new Og(e);i.text=t("Alignment");var n=new Kf(e);return n.set({isCompact:!0,ariaLabel:t("Table alignment toolbar")}),OL({view:this,icons:{left:vm.objectLeft,center:vm.objectCenter,right:vm.objectRight},toolbar:n,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:i,alignmentToolbar:n};}},{key:"_createActionButtons",value:function _createActionButtons(){var e=this.locale,t=this.t,i=new pg(e),n=new pg(e),s=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return i.set({label:t("Save"),icon:vm.check,"class":"ck-button-save",type:"submit",withText:!0}),i.bind("isEnabled").toMany(s,"errorText",function(){for(var _len105=arguments.length,e=new Array(_len105),_key105=0;_key105<_len105;_key105++){e[_key105]=arguments[_key105];}return e.every(function(e){return!e;});}),n.set({label:t("Cancel"),icon:vm.cancel,"class":"ck-button-cancel",withText:!0}),n.delegate("execute").to(this,"cancel"),{saveButtonView:i,cancelButtonView:n};}},{key:"_alignmentLabels",get:function get(){var e=this.locale,t=this.t,i=t("Align table to the left"),n=t("Center table"),s=t("Align table to the right");return"rtl"===e.uiLanguageDirection?{right:s,center:n,left:i}:{left:i,center:n,right:s};}}]);}(lg);function EF(e){return"none"!==e;}var TF={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};var PF=/*#__PURE__*/function(_Dr256){function PF(e){var _this835;_classCallCheck(this,PF);_this835=_callSuper(this,PF,[e]),_defineProperty(_assertThisInitialized(_this835),"_defaultTableProperties",void 0),_defineProperty(_assertThisInitialized(_this835),"_balloon",void 0),_defineProperty(_assertThisInitialized(_this835),"view",null),_defineProperty(_assertThisInitialized(_this835),"_undoStepBatch",void 0),_defineProperty(_assertThisInitialized(_this835),"_isReady",void 0),e.config.define("table.tableProperties",{borderColors:BL,backgroundColors:BL});return _this835;}_inherits(PF,_Dr256);return _createClass(PF,[{key:"init",value:function init(){var _this836=this;var e=this.editor,t=e.t;this._defaultTableProperties=KL(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(Db),e.ui.componentFactory.add("tableProperties",function(i){var n=new pg(i);n.set({label:t("Table properties"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>',tooltip:!0}),_this836.listenTo(n,"execute",function(){return _this836._showView();});var s=Object.values(TF).map(function(t){return e.commands.get(t);});return n.bind("isEnabled").toMany(s,"isEnabled",function(){for(var _len106=arguments.length,e=new Array(_len106),_key106=0;_key106<_len106;_key106++){e[_key106]=arguments[_key106];}return e.some(function(e){return e;});}),n;});}},{key:"destroy",value:function destroy(){_superPropGet(PF,"destroy",this,3)([]),this.view&&this.view.destroy();}},{key:"_createPropertiesView",value:function _createPropertiesView(){var _this837=this;var e=this.editor,t=e.config.get("table.tableProperties"),i=Gg(t.borderColors),n=qg(e.locale,i),s=Gg(t.backgroundColors),o=qg(e.locale,s),r=!1!==t.colorPicker,a=new AF(e.locale,{borderColors:n,backgroundColors:o,defaultTableProperties:this._defaultTableProperties,colorPickerConfig:!!r&&(t.colorPicker||{})}),l=e.t;a.render(),this.listenTo(a,"submit",function(){_this837._hideView();}),this.listenTo(a,"cancel",function(){_this837._undoStepBatch.operations.length&&e.execute("undo",_this837._undoStepBatch),_this837._hideView();}),a.keystrokes.set("Esc",function(e,t){_this837._hideView(),t();}),cg({emitter:a,activator:function activator(){return _this837._isViewInBalloon;},contextElements:[this._balloon.view.element],callback:function callback(){return _this837._hideView();}});var c=TL(l),d=PL(l);return a.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),a.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:a.borderColorInput,commandName:"tableBorderColor",errorText:c,validator:SL})),a.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:a.borderWidthInput,commandName:"tableBorderWidth",errorText:d,validator:VL})),a.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:a.backgroundInput,commandName:"tableBackgroundColor",errorText:c,validator:SL})),a.on("change:width",this._getValidatedPropertyChangeCallback({viewField:a.widthInput,commandName:"tableWidth",errorText:d,validator:IL})),a.on("change:height",this._getValidatedPropertyChangeCallback({viewField:a.heightInput,commandName:"tableHeight",errorText:d,validator:IL})),a.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),a;}},{key:"_fillViewFormFromCommandValues",value:function _fillViewFormFromCommandValues(){var _this838=this;var e=this.editor.commands,t=e.get("tableBorderStyle");Object.entries(TF).map(function(_ref351){var _ref352=_slicedToArray(_ref351,2),t=_ref352[0],i=_ref352[1];var n=t,s=_this838._defaultTableProperties[n]||"";return[n,e.get(i).value||s];}).forEach(function(_ref353){var _ref354=_slicedToArray(_ref353,2),e=_ref354[0],i=_ref354[1];("borderColor"!==e&&"borderWidth"!==e||"none"!==t.value)&&_this838.view.set(e,i);}),this._isReady=!0;}},{key:"_showView",value:function _showView(){var _this839=this;var e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",function(){_this839._updateView();}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:$L(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus();}},{key:"_hideView",value:function _hideView(){var e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus();}},{key:"_updateView",value:function _updateView(){var e=this.editor;wL(e.editing.view.document.selection)?this._isViewVisible&&HL(e,"table"):this._hideView();}},{key:"_isViewVisible",get:function get(){return!!this.view&&this._balloon.visibleView===this.view;}},{key:"_isViewInBalloon",get:function get(){return!!this.view&&this._balloon.hasView(this.view);}},{key:"_getPropertyChangeCallback",value:function _getPropertyChangeCallback(e){var _this840=this;return function(t,i,n){_this840._isReady&&_this840.editor.execute(e,{value:n,batch:_this840._undoStepBatch});};}},{key:"_getValidatedPropertyChangeCallback",value:function _getValidatedPropertyChangeCallback(e){var _this841=this;var t=e.commandName,i=e.viewField,n=e.validator,s=e.errorText,o=vs(function(){i.errorText=s;},500);return function(e,s,r){o.cancel(),_this841._isReady&&(n(r)?(_this841.editor.execute(t,{value:r,batch:_this841._undoStepBatch}),i.errorText=null):o());};}}],[{key:"requires",get:function get(){return[Db];}},{key:"pluginName",get:function get(){return"TablePropertiesUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var SF=/*#__PURE__*/function(_Dr257){function SF(){_classCallCheck(this,SF);return _callSuper(this,SF,arguments);}_inherits(SF,_Dr257);return _createClass(SF,null,[{key:"pluginName",get:function get(){return"TableProperties";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[CF,PF];}}]);}(Dr);function IF(e){e.document.registerPostFixer(function(t){return function(e,t){var i=t.document.differ.getChanges();var n=!1;var _iterator893=_createForOfIteratorHelper(i),_step893;try{for(_iterator893.s();!(_step893=_iterator893.n()).done;){var _t577=_step893.value;if("insert"!=_t577.type)continue;var _i635=_t577.position.parent;if(_i635.is("element","table")||"table"==_t577.name){var _s244="table"==_t577.name?_t577.position.nodeAfter:_i635,_o145=Array.from(_s244.getChildren()).filter(function(e){return e.is("element","caption");}),r=_o145.shift();if(!r)continue;var _iterator894=_createForOfIteratorHelper(_o145),_step894;try{for(_iterator894.s();!(_step894=_iterator894.n()).done;){var _t578=_step894.value;e.move(e.createRangeIn(_t578),r,"end"),e.remove(_t578);}}catch(err){_iterator894.e(err);}finally{_iterator894.f();}r.nextSibling&&(e.move(e.createRangeOn(r),_s244,"end"),n=!0),n=!!_o145.length||n;}}}catch(err){_iterator893.e(err);}finally{_iterator893.f();}return n;}(t,e);});}function VF(e){return!!e&&e.is("element","table");}function RF(e){var _iterator895=_createForOfIteratorHelper(e.getChildren()),_step895;try{for(_iterator895.s();!(_step895=_iterator895.n()).done;){var _t579=_step895.value;if(_t579.is("element","caption"))return _t579;}}catch(err){_iterator895.e(err);}finally{_iterator895.f();}return null;}function OF(e){var t=e.parent;return"figcaption"==e.name&&t&&t.is("element","figure")&&t.hasClass("table")||"caption"==e.name&&t&&t.is("element","table")?{name:!0}:null;}var BF=/*#__PURE__*/function(_Hr76){function BF(){_classCallCheck(this,BF);return _callSuper(this,BF,arguments);}_inherits(BF,_Hr76);return _createClass(BF,[{key:"refresh",value:function refresh(){var e=qB(this.editor.model.document.selection);this.isEnabled=!!e,this.isEnabled?this.value=!!RF(e):this.value=!1;}},{key:"execute",value:function execute(){var _this842=this;var _ref355=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},_ref355$focusCaptionO=_ref355.focusCaptionOnShow,e=_ref355$focusCaptionO===void 0?!1:_ref355$focusCaptionO;this.editor.model.change(function(t){_this842.value?_this842._hideTableCaption(t):_this842._showTableCaption(t,e);});}},{key:"_showTableCaption",value:function _showTableCaption(e,t){var i=this.editor.model,n=qB(i.document.selection),s=this.editor.plugins.get("TableCaptionEditing")._getSavedCaption(n)||e.createElement("caption");i.insertContent(s,n,"end"),t&&e.setSelection(s,"in");}},{key:"_hideTableCaption",value:function _hideTableCaption(e){var t=this.editor.model,i=qB(t.document.selection),n=this.editor.plugins.get("TableCaptionEditing"),s=RF(i);n._saveCaption(i,s),t.deleteContent(e.createSelection(s,"on"));}}]);}(Hr);var MF=/*#__PURE__*/function(_Dr258){function MF(e){var _this843;_classCallCheck(this,MF);_this843=_callSuper(this,MF,[e]),_defineProperty(_assertThisInitialized(_this843),"_savedCaptionsMap",void 0),_this843._savedCaptionsMap=new WeakMap();return _this843;}_inherits(MF,_Dr258);return _createClass(MF,[{key:"init",value:function init(){var e=this.editor,t=e.model.schema,i=e.editing.view,n=e.t;t.isRegistered("caption")?t.extend("caption",{allowIn:"table"}):t.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new BF(this.editor)),e.conversion["for"]("upcast").elementToElement({view:OF,model:"caption"}),e.conversion["for"]("dataDowncast").elementToElement({model:"caption",view:function view(e,_ref356){var t=_ref356.writer;return VF(e.parent)?t.createContainerElement("figcaption"):null;}}),e.conversion["for"]("editingDowncast").elementToElement({model:"caption",view:function view(e,_ref357){var t=_ref357.writer;if(!VF(e.parent))return null;var s=t.createEditableElement("figcaption");return t.setCustomProperty("tableCaption",!0,s),s.placeholder=n("Enter table caption"),Zr({view:i,element:s,keepOnFocus:!0}),uy(s,t);}}),IF(e.model);}},{key:"_getSavedCaption",value:function _getSavedCaption(e){var t=this._savedCaptionsMap.get(e);return t?ql.fromJSON(t):null;}},{key:"_saveCaption",value:function _saveCaption(e,t){this._savedCaptionsMap.set(e,t.toJSON());}}],[{key:"pluginName",get:function get(){return"TableCaptionEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var LF=/*#__PURE__*/function(_Dr259){function LF(){_classCallCheck(this,LF);return _callSuper(this,LF,arguments);}_inherits(LF,_Dr259);return _createClass(LF,[{key:"init",value:function init(){var _this844=this;var e=this.editor,t=e.editing.view,i=e.t;e.ui.componentFactory.add("toggleTableCaption",function(n){var s=e.commands.get("toggleTableCaption"),o=new pg(n);return o.set({icon:vm.caption,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(s,"value","isEnabled"),o.bind("label").to(s,"value",function(e){return i(e?"Toggle caption off":"Toggle caption on");}),_this844.listenTo(o,"execute",function(){if(e.execute("toggleTableCaption",{focusCaptionOnShow:!0}),s.value){var _i636=function(e){var t=qB(e);return t?RF(t):null;}(e.model.document.selection),_n340=e.editing.mapper.toViewElement(_i636);if(!_n340)return;t.scrollToTheSelection(),t.change(function(e){e.addClass("table__caption_highlighted",_n340);});}e.editing.view.focus();}),o;});}}],[{key:"pluginName",get:function get(){return"TableCaptionUI";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var FF=/*#__PURE__*/function(_Dr260){function FF(){_classCallCheck(this,FF);return _callSuper(this,FF,arguments);}_inherits(FF,_Dr260);return _createClass(FF,null,[{key:"pluginName",get:function get(){return"TableCaption";}},{key:"isOfficialPlugin",get:function get(){return!0;}},{key:"requires",get:function get(){return[MF,LF];}}]);}(Dr);var NF=/*#__PURE__*/function(_Hr77){function NF(){_classCallCheck(this,NF);return _callSuper(this,NF,arguments);}_inherits(NF,_Hr77);return _createClass(NF,[{key:"refresh",value:function refresh(){this.isEnabled=!0;}},{key:"execute",value:function execute(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var _this$editor4=this.editor,t=_this$editor4.model,i=_this$editor4.plugins;var _e$table=e.table,n=_e$table===void 0?t.document.selection.getSelectedElement():_e$table,s=e.columnWidths,o=e.tableWidth;s&&(s=Array.isArray(s)?s:s.split(",")),t.change(function(e){o?e.setAttribute("tableWidth",o,n):e.removeAttribute("tableWidth",n);var t=i.get("TableColumnResizeEditing").getColumnGroupElement(n);if(!s&&!t)return;if(!s)return e.remove(t);var r=SM(s);if(t)Array.from(t.getChildren()).forEach(function(t,i){return e.setAttribute("columnWidth",r[i],t);});else{var _t580=e.createElement("tableColumnGroup");r.forEach(function(i){return e.appendElement("tableColumn",{columnWidth:i},_t580);}),e.append(_t580,n);}});}}]);}(Hr);function DF(e){return function(t){return t.on("element:colgroup",function(t,i,n){var s=i.modelCursor.findAncestor("table"),o=RM(s);if(!o)return;var r=OM(o),a=e.getColumns(s);var l=(c=o,d=n.writer,OM(c).reduce(function(e,t){var i=t.getAttribute("columnWidth"),n=t.getAttribute("colSpan");if(!n)return e.push(i),e;for(var _t581=0;_t581<n;_t581++)e.push(i);return d.removeAttribute("colSpan",t),e;},[]));var c,d;l=Array.from({length:a},function(e,t){return l[t]||"auto";}),(l.length!=r.length||l.includes("auto"))&&VM(r,o,SM(l),n.writer);},{priority:"low"});};}var zF=/*#__PURE__*/function(_Dr261){function zF(e){var _this845;_classCallCheck(this,zF);_this845=_callSuper(this,zF,[e]),_defineProperty(_assertThisInitialized(_this845),"_isResizingActive",void 0),_defineProperty(_assertThisInitialized(_this845),"_resizingData",void 0),_defineProperty(_assertThisInitialized(_this845),"_domEmitter",void 0),_defineProperty(_assertThisInitialized(_this845),"_tableUtilsPlugin",void 0),_this845._isResizingActive=!1,_this845.set("_isResizingAllowed",!0),_this845._resizingData=null,_this845._domEmitter=new(go())(),_this845._tableUtilsPlugin=e.plugins.get("TableUtils"),_this845.on("change:_isResizingAllowed",function(t,i,n){var s=n?"removeClass":"addClass";e.editing.view.change(function(t){var _iterator896=_createForOfIteratorHelper(e.editing.view.document.roots),_step896;try{for(_iterator896.s();!(_step896=_iterator896.n()).done;){var _i637=_step896.value;t[s]("ck-column-resize_disabled",e.editing.view.document.getRoot(_i637.rootName));}}catch(err){_iterator896.e(err);}finally{_iterator896.f();}});});return _this845;}_inherits(zF,_Dr261);return _createClass(zF,[{key:"init",value:function init(){this._extendSchema(),this._registerPostFixer(),this._registerConverters(),this._registerResizingListeners(),this._registerResizerInserter();var e=this.editor,t=e.plugins.get("TableColumnResize");e.plugins.get("TableEditing").registerAdditionalSlot({filter:function filter(e){return e.is("element","tableColumnGroup");},positionOffset:0});var i=new NF(e);e.commands.add("resizeTableWidth",i),e.commands.add("resizeColumnWidths",i),this.bind("_isResizingAllowed").to(e,"isReadOnly",t,"isEnabled",i,"isEnabled",function(e,t,i){return!e&&t&&i;});}},{key:"destroy",value:function destroy(){this._domEmitter.stopListening(),_superPropGet(zF,"destroy",this,3)([]);}},{key:"getColumnGroupElement",value:function getColumnGroupElement(e){return RM(e);}},{key:"getTableColumnElements",value:function getTableColumnElements(e){return OM(e);}},{key:"getTableColumnsWidths",value:function getTableColumnsWidths(e){return function(e){return OM(e).map(function(e){return e.getAttribute("columnWidth");});}(e);}},{key:"_extendSchema",value:function _extendSchema(){this.editor.model.schema.extend("table",{allowAttributes:["tableWidth"]}),this.editor.model.schema.register("tableColumnGroup",{allowIn:"table",isLimit:!0}),this.editor.model.schema.register("tableColumn",{allowIn:"tableColumnGroup",allowAttributes:["columnWidth","colSpan"],isLimit:!0});}},{key:"_registerPostFixer",value:function _registerPostFixer(){var _this846=this;var e=this.editor.model;function t(e,t,i){var n=i._tableUtilsPlugin.getColumns(t);if(0===n-e.length)return e;var s=e.map(function(e){return Number(e.replace("%",""));}),o=function(e,t){var i=new Set();var _iterator897=_createForOfIteratorHelper(e.getChanges()),_step897;try{for(_iterator897.s();!(_step897=_iterator897.n()).done;){var _n341=_step897.value;if("insert"==_n341.type&&_n341.position.nodeAfter&&"tableCell"==_n341.position.nodeAfter.name&&_n341.position.nodeAfter.getAncestors().includes(t))i.add(_n341.position.nodeAfter);else if("remove"==_n341.type){var _e842=_n341.position.nodeBefore||_n341.position.nodeAfter;"tableCell"==_e842.name&&_e842.getAncestors().includes(t)&&i.add(_e842);}}}catch(err){_iterator897.e(err);}finally{_iterator897.f();}return i;}(i.editor.model.document.differ,t);var _iterator898=_createForOfIteratorHelper(o),_step898;try{for(_iterator898.s();!(_step898=_iterator898.n()).done;){var _e843=_step898.value;var _o146=n-s.length;if(0===_o146)continue;var _a48=_o146>0,_l36=i._tableUtilsPlugin.getCellLocation(_e843).column;if(_a48){var _e844=CM(t,i.editor),_n342=(r=_e844,Array(_o146).fill(r));s.splice.apply(s,[_l36,0].concat(_toConsumableArray(_n342)));}else{var _e845=s.splice(_l36,Math.abs(_o146));s[_l36]+=PM(_e845);}}}catch(err){_iterator898.e(err);}finally{_iterator898.f();}var r;return s.map(function(e){return e+"%";});}e.document.registerPostFixer(function(i){var n=!1;var _iterator899=_createForOfIteratorHelper(function(e){var t=new Set();var _iterator900=_createForOfIteratorHelper(e.document.differ.getChanges()),_step900;try{for(_iterator900.s();!(_step900=_iterator900.n()).done;){var _i638=_step900.value;var _n343=null;switch(_i638.type){case"insert":_n343=["table","tableRow","tableCell"].includes(_i638.name)?_i638.position:null;break;case"remove":_n343=["tableRow","tableCell"].includes(_i638.name)?_i638.position:null;break;case"attribute":_i638.range.start.nodeAfter&&(_n343=["table","tableRow","tableCell"].includes(_i638.range.start.nodeAfter.name)?_i638.range.start:null);}if(!_n343)continue;var _s245=_n343.nodeAfter&&_n343.nodeAfter.is("element","table")?_n343.nodeAfter:_n343.findAncestor("table");var _iterator901=_createForOfIteratorHelper(e.createRangeOn(_s245).getItems()),_step901;try{for(_iterator901.s();!(_step901=_iterator901.n()).done;){var _i639=_step901.value;_i639.is("element","table")&&RM(_i639)&&t.add(_i639);}}catch(err){_iterator901.e(err);}finally{_iterator901.f();}}}catch(err){_iterator900.e(err);}finally{_iterator900.f();}return t;}(e)),_step899;try{for(_iterator899.s();!(_step899=_iterator899.n()).done;){var _s246=_step899.value;var _e846=_this846.getColumnGroupElement(_s246),_o147=_this846.getTableColumnElements(_e846),r=_this846.getTableColumnsWidths(_e846);var _a49=SM(r);_a49=t(_a49,_s246,_this846),Ls(r,_a49)||(VM(_o147,_e846,_a49,i),n=!0);}}catch(err){_iterator899.e(err);}finally{_iterator899.f();}return n;});}},{key:"_registerConverters",value:function _registerConverters(){var e=this.editor.conversion;e["for"]("upcast").attributeToAttribute({view:{name:"figure",key:"style",value:{width:/[\s\S]+/}},model:{name:"table",key:"tableWidth",value:function value(e){return e.getStyle("width");}}}),e["for"]("downcast").attributeToAttribute({model:{name:"table",key:"tableWidth"},view:function view(e){return{name:"figure",key:"style",value:{width:e}};}}),e.elementToElement({model:"tableColumnGroup",view:"colgroup"}),e.elementToElement({model:"tableColumn",view:"col"}),e["for"]("downcast").add(function(e){return e.on("insert:table",function(e,t,i){var n=i.writer,s=t.item,o=i.mapper.toViewElement(s),r=o.is("element","table")?o:Array.from(o.getChildren()).find(function(e){return e.is("element","table");});RM(s)?n.addClass("ck-table-resized",r):n.removeClass("ck-table-resized",r);},{priority:"low"});}),e["for"]("upcast").add(DF(this._tableUtilsPlugin)),e["for"]("upcast").attributeToAttribute({view:{name:"col",styles:{width:/.*/}},model:{key:"columnWidth",value:function value(e){var t=e.getStyle("width");return t&&(t.endsWith("%")||t.endsWith("pt"))?t:"auto";}}}),e["for"]("upcast").attributeToAttribute({view:{name:"col",key:"span"},model:"colSpan"}),e["for"]("downcast").attributeToAttribute({model:{name:"tableColumn",key:"columnWidth"},view:function view(e){return{key:"style",value:{width:e}};}});}},{key:"_registerResizingListeners",value:function _registerResizingListeners(){var e=this.editor.editing.view;e.addObserver(hL),e.document.on("mousedown",this._onMouseDownHandler.bind(this),{priority:"high"}),this._domEmitter.listenTo(i.window.document,"mousemove",$s(this._onMouseMoveHandler.bind(this),50)),this._domEmitter.listenTo(i.window.document,"mouseup",this._onMouseUpHandler.bind(this));}},{key:"_onMouseDownHandler",value:function _onMouseDownHandler(e,t){var _this847=this;var i=t.target;if(!i.hasClass("ck-table-column-resizer"))return;if(!this._isResizingAllowed)return;var n=this.editor,s=n.editing.mapper.toModelElement(i.findAncestor("figure"));if(!n.model.canEditAt(s))return;t.preventDefault(),e.stop();var o=function(e,t,i){var n=Array(t.getColumns(e)),s=new JB(e);var _iterator902=_createForOfIteratorHelper(s),_step902;try{for(_iterator902.s();!(_step902=_iterator902.n()).done;){var _e847=_step902.value;var _t582=i.editing.mapper.toViewElement(_e847.cell),_s247=IM(i.editing.view.domConverter.mapViewToDom(_t582));(!n[_e847.column]||_s247<n[_e847.column])&&(n[_e847.column]=TM(_s247));}}catch(err){_iterator902.e(err);}finally{_iterator902.f();}return n;}(s,this._tableUtilsPlugin,n),r=i.findAncestor("table"),a=n.editing.view;Array.from(r.getChildren()).find(function(e){return e.is("element","colgroup");})||a.change(function(e){!function(e,t,i){var n=e.createContainerElement("colgroup");for(var _i640=0;_i640<t.length;_i640++){var _s248=e.createEmptyElement("col"),_o148="".concat(TM(t[_i640]/PM(t)*100),"%");e.setStyle("width",_o148,_s248),e.insert(e.createPositionAt(n,"end"),_s248);}e.insert(e.createPositionAt(i,0),n);}(e,o,r);}),this._isResizingActive=!0,this._resizingData=this._getResizingData(t,o),a.change(function(e){return function(e,t,i){var n=i.widths.viewFigureWidth/i.widths.viewFigureParentWidth;e.addClass("ck-table-resized",t),e.addClass("ck-table-column-resizer__active",i.elements.viewResizer),e.setStyle("width","".concat(TM(100*n),"%"),t.findAncestor("figure"));}(e,r,_this847._resizingData);});}},{key:"_onMouseMoveHandler",value:function _onMouseMoveHandler(e,t){if(!this._isResizingActive)return;if(!this._isResizingAllowed)return void this._onMouseUpHandler();var _this$_resizingData=this._resizingData,i=_this$_resizingData.columnPosition,_this$_resizingData$f=_this$_resizingData.flags,n=_this$_resizingData$f.isRightEdge,s=_this$_resizingData$f.isTableCentered,o=_this$_resizingData$f.isLtrContent,_this$_resizingData$e=_this$_resizingData.elements,r=_this$_resizingData$e.viewFigure,a=_this$_resizingData$e.viewLeftColumn,l=_this$_resizingData$e.viewRightColumn,_this$_resizingData$w=_this$_resizingData.widths,c=_this$_resizingData$w.viewFigureParentWidth,d=_this$_resizingData$w.tableWidth,u=_this$_resizingData$w.leftColumnWidth,h=_this$_resizingData$w.rightColumnWidth,m=40-u,g=n?c-d:h-40,f=(o?1:-1)*(n&&s?2:1),p=(b=(t.clientX-i)*f,w=Math.min(m,0),_=Math.max(g,0),TM(b<=w?w:b>=_?_:b));var b,w,_;0!==p&&this.editor.editing.view.change(function(e){var t=TM(100*(u+p)/d);if(e.setStyle("width","".concat(t,"%"),a),n){var _t583=TM(100*(d+p)/c);e.setStyle("width","".concat(_t583,"%"),r);}else{var _t584=TM(100*(h-p)/d);e.setStyle("width","".concat(_t584,"%"),l);}});}},{key:"_onMouseUpHandler",value:function _onMouseUpHandler(){if(!this._isResizingActive)return;var _this$_resizingData$e2=this._resizingData.elements,e=_this$_resizingData$e2.viewResizer,t=_this$_resizingData$e2.modelTable,i=_this$_resizingData$e2.viewFigure,n=_this$_resizingData$e2.viewColgroup,s=this.editor,o=s.editing.view,r=this.getColumnGroupElement(t),a=Array.from(n.getChildren()).filter(function(e){return e.is("view:element");}),l=r?this.getTableColumnsWidths(r):null,c=a.map(function(e){return e.getStyle("width");}),d=!Ls(l,c),u=t.getAttribute("tableWidth"),h=i.getStyle("width"),m=u!==h;(d||m)&&(this._isResizingAllowed?s.execute("resizeTableWidth",{table:t,tableWidth:"".concat(TM(h),"%"),columnWidths:c}):o.change(function(e){if(l){var _iterator903=_createForOfIteratorHelper(a),_step903;try{for(_iterator903.s();!(_step903=_iterator903.n()).done;){var _t585=_step903.value;e.setStyle("width",l.shift(),_t585);}}catch(err){_iterator903.e(err);}finally{_iterator903.f();}}else e.remove(n);m&&(u?e.setStyle("width",u,i):e.removeStyle("width",i)),l||u||e.removeClass("ck-table-resized",_toConsumableArray(i.getChildren()).find(function(e){return"table"===e.name;}));})),o.change(function(t){t.removeClass("ck-table-column-resizer__active",e);}),this._isResizingActive=!1,this._resizingData=null;}},{key:"_getResizingData",value:function _getResizingData(e,t){var i=this.editor,n=e.domEvent.clientX,s=e.target,o=s.findAncestor("td")||s.findAncestor("th"),r=i.editing.mapper.toModelElement(o),a=r.findAncestor("table"),l=function(e,t){var i=t.getCellLocation(e).column;return{leftEdge:i,rightEdge:i+(e.getAttribute("colspan")||1)-1};}(r,this._tableUtilsPlugin).rightEdge,c=l===this._tableUtilsPlugin.getColumns(a)-1,d=!a.hasAttribute("tableAlignment"),u="rtl"!==i.locale.contentLanguageDirection,h=o.findAncestor("table"),m=h.findAncestor("figure"),g=_toConsumableArray(h.getChildren()).find(function(e){return e.is("element","colgroup");}),f=g.getChild(l),p=c?void 0:g.getChild(l+1);return{columnPosition:n,flags:{isRightEdge:c,isTableCentered:d,isLtrContent:u},elements:{viewResizer:s,modelTable:a,viewFigure:m,viewColgroup:g,viewLeftColumn:f,viewRightColumn:p},widths:{viewFigureParentWidth:EM(i.editing.view.domConverter.mapViewToDom(m.parent)),viewFigureWidth:EM(i.editing.view.domConverter.mapViewToDom(m)),tableWidth:xM(a,i),leftColumnWidth:t[l],rightColumnWidth:c?void 0:t[l+1]}};}},{key:"_registerResizerInserter",value:function _registerResizerInserter(){this.editor.conversion["for"]("editingDowncast").add(function(e){e.on("insert:tableCell",function(e,t,i){var n=t.item,s=i.mapper.toViewElement(n),o=i.writer;o.insert(o.createPositionAt(s,"end"),o.createUIElement("div",{"class":"ck-table-column-resizer"}));},{priority:"lowest"});});}}],[{key:"requires",get:function get(){return[tL,BM];}},{key:"pluginName",get:function get(){return"TableColumnResizeEditing";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);var HF=/*#__PURE__*/function(_Dr262){function HF(){_classCallCheck(this,HF);return _callSuper(this,HF,arguments);}_inherits(HF,_Dr262);return _createClass(HF,null,[{key:"requires",get:function get(){return[zF,eF];}},{key:"pluginName",get:function get(){return"TableColumnResize";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);function $F(e){if(e.is("$text")||e.is("$textProxy"))return e.data;var t=e;var i="",n=null;var _iterator904=_createForOfIteratorHelper(t.getChildren()),_step904;try{for(_iterator904.s();!(_step904=_iterator904.n()).done;){var _e848=_step904.value;var _t586=$F(_e848);n&&n.is("element")&&(i+="\n"),i+=_t586,n=_e848;}}catch(err){_iterator904.e(err);}finally{_iterator904.f();}return i;}var UF=/*#__PURE__*/function(_Dr263){function UF(e){var _this848;_classCallCheck(this,UF);_this848=_callSuper(this,UF,[e]),_defineProperty(_assertThisInitialized(_this848),"_config",void 0),_defineProperty(_assertThisInitialized(_this848),"_outputView",void 0),_defineProperty(_assertThisInitialized(_this848),"_wordsMatchRegExp",void 0),_this848.set("characters",0),_this848.set("words",0),Object.defineProperties(_assertThisInitialized(_this848),{characters:{get:function get(){return this.characters=this._getCharacters(this._getText());}},words:{get:function get(){return this.words=this._getWords(this._getText());}}}),_this848.set("_wordsLabel",void 0),_this848.set("_charactersLabel",void 0),_this848._config=e.config.get("wordCount")||{},_this848._outputView=void 0,_this848._wordsMatchRegExp=o.features.isRegExpUnicodePropertySupported?new RegExp("([\\p{L}\\p{N}]+\\S?)+","gu"):/([0-9A-Za-z\xC0-\u017E]+(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])?)+/g;return _this848;}_inherits(UF,_Dr263);return _createClass(UF,[{key:"init",value:function init(){var _this849=this;this.editor.model.document.on("change:data",$s(this._refreshStats.bind(this),250)),"function"==typeof this._config.onUpdate&&this.on("update",function(e,t){_this849._config.onUpdate(t);}),Ms(this._config.container)&&this._config.container.appendChild(this.wordCountContainer);}},{key:"destroy",value:function destroy(){this._outputView&&(this._outputView.element.remove(),this._outputView.destroy()),_superPropGet(UF,"destroy",this,3)([]);}},{key:"wordCountContainer",get:function get(){var e=this.editor,t=e.t,i=e.config.get("wordCount.displayWords"),n=e.config.get("wordCount.displayCharacters"),s=Hm.bind(this,this),o=[];return this._outputView||(this._outputView=new lg(),(i||void 0===i)&&(this.bind("_wordsLabel").to(this,"words",function(e){return t("Words: %0",e);}),o.push({tag:"div",children:[{text:[s.to("_wordsLabel")]}],attributes:{"class":"ck-word-count__words"}})),(n||void 0===n)&&(this.bind("_charactersLabel").to(this,"characters",function(e){return t("Characters: %0",e);}),o.push({tag:"div",children:[{text:[s.to("_charactersLabel")]}],attributes:{"class":"ck-word-count__characters"}})),this._outputView.setTemplate({tag:"div",attributes:{"class":["ck","ck-word-count"]},children:o}),this._outputView.render()),this._outputView.element;}},{key:"_getText",value:function _getText(){var e="";var _iterator905=_createForOfIteratorHelper(this.editor.model.document.getRoots()),_step905;try{for(_iterator905.s();!(_step905=_iterator905.n()).done;){var _t587=_step905.value;""!==e&&(e+="\n"),e+=$F(_t587);}}catch(err){_iterator905.e(err);}finally{_iterator905.f();}return e;}},{key:"_getCharacters",value:function _getCharacters(e){return e.replace(/\n/g,"").length;}},{key:"_getWords",value:function _getWords(e){return(e.match(this._wordsMatchRegExp)||[]).length;}},{key:"_refreshStats",value:function _refreshStats(){var e=this._getText(),t=this.words=this._getWords(e),i=this.characters=this._getCharacters(e);this.fire("update",{words:t,characters:i});}}],[{key:"pluginName",get:function get(){return"WordCount";}},{key:"isOfficialPlugin",get:function get(){return!0;}}]);}(Dr);exports.AccessibilityHelp=Fg;exports.AdjacentListsSupport=EI;exports.Alignment=fw;exports.AlignmentEditing=Dm;exports.AlignmentUI=gw;exports.AttributeCommand=r_;exports.AttributeElement=Ma;exports.AttributeOperation=Dd;exports.AutoImage=FA;exports.AutoLink=jT;exports.AutoMediaEmbed=_R;exports.AutocompleteView=Kb;exports.Autoformat=n_;exports.Autosave=o_;exports.BalloonEditor=Ik;exports.BalloonPanelView=Df;exports.BalloonToolbar=ew;exports.Base64UploadAdapter=xm;exports.BlockQuote=ov;exports.BlockQuoteEditing=nv;exports.BlockQuoteUI=sv;exports.BlockToolbar=sw;exports.BodyCollection=Ng;exports.Bold=h_;exports.BoldEditing=l_;exports.BoldUI=u_;exports.BoxedEditorUIView=Vb;exports.BubblingEventInfo=Ta;exports.ButtonLabelView=fg;exports.ButtonLabelWithHighlightView=Jb;exports.ButtonView=pg;exports.CKBox=Rv;exports.CKBoxEditing=Tv;exports.CKBoxImageEdit=Fv;exports.CKBoxImageEditEditing=Mv;exports.CKBoxImageEditUI=Lv;exports.CKBoxUI=rv;exports.CKEditorError=A;exports.CKFinder=$v;exports.CKFinderEditing=Hv;exports.CKFinderUI=Nv;exports.CKFinderUploadAdapter=Vm;exports.ClassicEditor=Bk;exports.ClickObserver=Uu;exports.Clipboard=Qy;exports.ClipboardMarkersUtils=Zv;exports.ClipboardPipeline=Jv;exports.CloudServices=ok;exports.CloudServicesCore=sk;exports.CloudServicesUploadAdapter=Ak;exports.Code=b_;exports.CodeBlock=xk;exports.CodeBlockEditing=vk;exports.CodeBlockUI=Ck;exports.CodeEditing=g_;exports.CodeUI=p_;exports.CollapsibleView=jg;exports.Collection=br;exports.ColorGridView=Jg;exports.ColorPickerView=Hp;exports.ColorSelectorView=Jp;exports.ColorTileView=Zg;exports.Command=Hr;exports.ComponentFactory=Qp;exports.Config=ao;exports.Context=jr;exports.ContextPlugin=qr;exports.ContextWatchdog=rm;exports.ContextualBalloon=Db;exports.Conversion=kd;exports.CssTransitionDisablerMixin=ug;exports.DataApiMixin=pm;exports.DataController=yd;exports.DataFilter=sA;exports.DataSchema=nA;exports.DataTransfer=Ml;exports.DecoupledEditor=Nk;exports.DefaultMenuBarItems=fb;exports.Delete=Rw;exports.Dialog=Sg;exports.DialogView=Pg;exports.DialogViewPosition=Eg;exports.DocumentFragment=yu;exports.DocumentList=PI;exports.DocumentListProperties=SI;exports.DocumentSelection=_c;exports.DomConverter=yl;exports.DomEmitterMixin=go;exports.DomEventData=El;exports.DomEventObserver=Tl;exports.DomWrapperView=BR;exports.DowncastWriter=qa;exports.DragDrop=qy;exports.DragDropBlockToolbar=jy;exports.DragDropTarget=Dy;exports.DropdownButtonView=Af;exports.DropdownMenuListItemButtonView=Ef;exports.DropdownMenuListItemView=Bf;exports.DropdownMenuListView=Rf;exports.DropdownMenuNestedMenuView=$f;exports.DropdownMenuPanelPositioningFunctions=Of;exports.DropdownMenuRootListView=Uf;exports.DropdownPanelView=Cf;exports.DropdownView=xf;exports.EasyImage=Tk;exports.EditingController=Xc;exports.EditingView=zl;exports.Editor=gm;exports.EditorUI=Pb;exports.EditorUIView=Ib;exports.EditorWatchdog=nm;exports.Element=ql;exports.ElementApiMixin=bm;exports.ElementReplacer=to;exports.EmitterMixin=L;exports.Enter=K_;exports.Essentials=cC;exports.EventInfo=v;exports.FileDialogButtonView=zg;exports.FileDialogListItemButtonView=Hg;exports.FileRepository=km;exports.FindAndReplace=CC;exports.FindAndReplaceEditing=kC;exports.FindAndReplaceUI=hC;exports.FindAndReplaceUtils=vC;exports.FindCommand=mC;exports.FindNextCommand=bC;exports.FindPreviousCommand=wC;exports.FocusCycler=_g;exports.FocusObserver=Rl;exports.FocusTracker=_r;exports.Font=sx;exports.FontBackgroundColor=nx;exports.FontBackgroundColorEditing=tx;exports.FontBackgroundColorUI=ix;exports.FontColor=XC;exports.FontColorEditing=JC;exports.FontColorUI=YC;exports.FontFamily=DC;exports.FontFamilyEditing=LC;exports.FontFamilyUI=NC;exports.FontSize=KC;exports.FontSizeEditing=jC;exports.FontSizeUI=GC;exports.FormHeaderView=wg;exports.FullPage=TA;exports.GeneralHtmlSupport=CA;exports.Heading=px;exports.HeadingButtonsUI=wx;exports.HeadingEditing=mx;exports.HeadingUI=fx;exports.Highlight=Rx;exports.HighlightEditing=Sx;exports.HighlightUI=Ix;exports.HighlightedTextView=Zb;exports.History=mu;exports.HorizontalLine=Lx;exports.HorizontalLineEditing=Bx;exports.HorizontalLineUI=Mx;exports.HtmlComment=AA;exports.HtmlDataProcessor=vd;exports.HtmlEmbed=$x;exports.HtmlEmbedEditing=Dx;exports.HtmlEmbedUI=Hx;exports.HtmlPageDataProcessor=EA;exports.IconView=gg;exports.IframeView=Bb;exports.Image=oE;exports.ImageBlock=iE;exports.ImageBlockEditing=XA;exports.ImageCaption=dE;exports.ImageCaptionEditing=lE;exports.ImageCaptionUI=cE;exports.ImageCaptionUtils=rE;exports.ImageCustomResizeUI=$E;exports.ImageEditing=ZA;exports.ImageInline=sE;exports.ImageInsert=PE;exports.ImageInsertUI=tE;exports.ImageInsertViaUrl=TE;exports.ImageResize=UE;exports.ImageResizeButtons=RE;exports.ImageResizeEditing=IE;exports.ImageResizeHandles=FE;exports.ImageSizeAttributes=JA;exports.ImageStyle=iT;exports.ImageStyleEditing=QE;exports.ImageStyleUI=YE;exports.ImageTextAlternative=UA;exports.ImageTextAlternativeEditing=DA;exports.ImageTextAlternativeUI=$A;exports.ImageToolbar=nT;exports.ImageUpload=xE;exports.ImageUploadEditing=kE;exports.ImageUploadProgress=fE;exports.ImageUploadUI=gE;exports.ImageUtils=BA;exports.Indent=aT;exports.IndentBlock=hT;exports.IndentEditing=oT;exports.IndentUI=rT;exports.InlineEditableUIView=Ob;exports.InlineEditor=Uk;exports.Input=yw;exports.InputNumberView=vf;exports.InputTextView=_f;exports.InputView=wf;exports.InsertOperation=Md;exports.InsertTextCommand=bw;exports.Italic=k_;exports.ItalicEditing=__;exports.ItalicUI=y_;exports.KeystrokeHandler=Cr;exports.LabelView=Og;exports.LabelWithHighlightView=Qb;exports.LabeledFieldView=pf;exports.LegacyIndentCommand=SS;exports.LegacyList=sI;exports.LegacyListEditing=iI;exports.LegacyListProperties=fI;exports.LegacyListPropertiesEditing=cI;exports.LegacyListUtils=$S;exports.LegacyTodoList=AI;exports.LegacyTodoListEditing=CI;exports.Link=GT;exports.LinkActionsView=DT;exports.LinkCommand=IT;exports.LinkEditing=LT;exports.LinkFormView=FT;exports.LinkImage=YT;exports.LinkImageEditing=KT;exports.LinkImageUI=QT;exports.LinkUI=$T;exports.List=jP;exports.ListCommand=CP;exports.ListEditing=zP;exports.ListIndentCommand=yP;exports.ListItemButtonView=Ig;exports.ListItemGroupView=If;exports.ListItemView=Pf;exports.ListProperties=fS;exports.ListPropertiesEditing=lS;exports.ListPropertiesUI=dS;exports.ListPropertiesUtils=sS;exports.ListSeparatorView=Sf;exports.ListUI=WP;exports.ListUtils=EP;exports.ListView=Vf;exports.LivePosition=su;exports.LiveRange=fc;exports.Locale=pr;exports.MSWordNormalizer=vO;exports.Markdown=rR;exports.MarkerOperation=Nd;exports.Matcher=aa;exports.MediaEmbed=kR;exports.MediaEmbedEditing=bR;exports.MediaEmbedToolbar=CR;exports.MediaEmbedUI=yR;exports.Mention=jR;exports.MentionEditing=ER;exports.MentionListItemView=MR;exports.MentionUI=NR;exports.MentionsView=OR;exports.MenuBarMenuListItemButtonView=Rg;exports.MenuBarMenuListItemFileDialogButtonView=dw;exports.MenuBarMenuListItemView=ub;exports.MenuBarMenuListView=lw;exports.MenuBarMenuView=aw;exports.MenuBarView=hw;exports.MergeOperation=Fd;exports.Minimap=eO;exports.Model=Hu;exports.MouseObserver=Wu;exports.MoveOperation=Bd;exports.MultiCommand=Ur;exports.MultiRootEditor=Gk;exports.NoOperation=zd;exports.Notification=Lb;exports.ObservableMixin=Zs;exports.Observer=Al;exports.OperationFactory=jd;exports.PageBreak=sO;exports.PageBreakEditing=iO;exports.PageBreakUI=nO;exports.Paragraph=lx;exports.ParagraphButtonUI=cx;exports.PasteFromMarkdownExperimental=lR;exports.PasteFromOffice=SO;exports.PastePlainText=Jy;exports.PendingActions=_m;exports.PictureEditing=sT;exports.PlainTableOutput=pL;exports.Plugin=Dr;exports.Position=Zl;exports.Range=tc;exports.Rect=Eo;exports.RemoveFormat=BO;exports.RemoveFormatEditing=OO;exports.RemoveFormatUI=VO;exports.RenameOperation=Hd;exports.Renderer=ul;exports.ReplaceAllCommand=pC;exports.ReplaceCommand=fC;exports.ResizeObserver=Vo;exports.RestrictedEditingMode=KO;exports.RestrictedEditingModeEditing=UO;exports.RestrictedEditingModeUI=GO;exports.RootAttributeOperation=$d;exports.RootOperation=Ud;exports.SearchInfoView=jb;exports.SearchTextView=Gb;exports.SelectAll=eC;exports.SelectAllEditing=Yk;exports.SelectAllUI=Xk;exports.ShiftEnter=Y_;exports.ShowBlocks=iB;exports.ShowBlocksCommand=XO;exports.ShowBlocksEditing=eB;exports.ShowBlocksUI=tB;exports.SimpleUploadAdapter=Em;exports.SourceEditing=rB;exports.SpecialCharacters=gB;exports.SpecialCharactersArrows=fB;exports.SpecialCharactersCurrency=_B;exports.SpecialCharactersEssentials=vB;exports.SpecialCharactersLatin=wB;exports.SpecialCharactersMathematical=bB;exports.SpecialCharactersText=pB;exports.SpinnerView=Yb;exports.SplitButtonView=Yf;exports.SplitOperation=Ld;exports.StandardEditingMode=YO;exports.StandardEditingModeEditing=JO;exports.StandardEditingModeUI=QO;exports.StickyPanelView=Ub;exports.Strikethrough=T_;exports.StrikethroughEditing=x_;exports.StrikethroughUI=E_;exports.Style=LB;exports.StyleEditing=MB;exports.StyleUI=PB;exports.StyleUtils=EB;exports.StylesMap=da;exports.StylesProcessor=ua;exports.Subscript=R_;exports.SubscriptEditing=S_;exports.SubscriptUI=V_;exports.Superscript=F_;exports.SuperscriptEditing=B_;exports.SuperscriptUI=L_;exports.SwitchButtonView=Dg;exports.TabObserver=Dl;exports.Table=fL;exports.TableCaption=FF;exports.TableCaptionEditing=MF;exports.TableCaptionUI=LF;exports.TableCellProperties=hF;exports.TableCellPropertiesEditing=uF;exports.TableCellPropertiesUI=QL;exports.TableCellWidthEditing=eF;exports.TableClipboard=aL;exports.TableColumnResize=HF;exports.TableColumnResizeEditing=zF;exports.TableEditing=tL;exports.TableKeyboard=uL;exports.TableMouse=mL;exports.TableProperties=SF;exports.TablePropertiesEditing=CF;exports.TablePropertiesUI=PF;exports.TableSelection=rL;exports.TableToolbar=kL;exports.TableUI=sL;exports.TableUtils=BM;exports.Template=Hm;exports.Text=Wl;exports.TextPartLanguage=bT;exports.TextPartLanguageEditing=fT;exports.TextPartLanguageUI=pT;exports.TextProxy=jl;exports.TextTransformation=qw;exports.TextWatcher=Mw;exports.TextareaView=yf;exports.Title=vx;exports.TodoDocumentList=II;exports.TodoList=AS;exports.TodoListEditing=_S;exports.TodoListUI=xS;exports.ToolbarLineBreakView=jf;exports.ToolbarSeparatorView=Wf;exports.ToolbarView=Kf;exports.TooltipManager=eb;exports.TreeWalker=Gl;exports.TwoStepCaretMovement=Lw;exports.Typing=Ow;exports.Underline=$_;exports.UnderlineEditing=D_;exports.UnderlineUI=H_;exports.Undo=lC;exports.UndoEditing=rC;exports.UndoUI=aC;exports.UnlinkCommand=RT;exports.UpcastWriter=ju;exports.View=lg;exports.ViewAttributeElement=Ma;exports.ViewCollection=zm;exports.ViewContainerElement=pa;exports.ViewDocument=Ba;exports.ViewDocumentFragment=ja;exports.ViewEditableElement=wa;exports.ViewElement=ga;exports.ViewEmptyElement=Na;exports.ViewModel=Fb;exports.ViewRawElement=Ua;exports.ViewRootEditableElement=va;exports.ViewText=oa;exports.ViewTreeWalker=ya;exports.ViewUIElement=za;exports.WIDGET_CLASS_NAME=iy;exports.WIDGET_SELECTED_CLASS_NAME=ny;exports.Watchdog=Xh;exports.Widget=Ty;exports.WidgetResize=Ly;exports.WidgetToolbarRepository=Sy;exports.WidgetTypeAround=Cy;exports.WordCount=UF;exports.XmlDataProcessor=Ad;exports._getModelData=jh;exports._getViewData=Nh;exports._parseModel=Kh;exports._parseView=Hh;exports._setModelData=qh;exports._setViewData=Dh;exports._stringifyModel=Gh;exports._stringifyView=zh;exports.abortableDebounce=io;exports.addBackgroundRules=_h;exports.addBorderRules=vh;exports.addKeyboardHandlingForGrid=mg;exports.addLinkProtocolIfApplicable=TT;exports.addListToDropdown=sp;exports.addMarginRules=Ih;exports.addMenuToDropdown=ep;exports.addPaddingRules=Vh;exports.addToolbarToDropdown=ip;exports.attachToForm=fm;exports.autoParagraphEmptyRoots=Dc;exports.blockAutoformatEditing=e_;exports.calculateResizeHostAncestorWidth=fy;exports.calculateResizeHostPercentageWidth=py;exports.clickOutsideHandler=cg;exports.compareArrays=so;exports.count=no;exports.createDropdown=Xf;exports.createElement=ro;exports.createImageTypeRegExp=uE;exports.createLabeledDropdown=hp;exports.createLabeledInputNumber=dp;exports.createLabeledInputText=cp;exports.createLabeledTextarea=up;exports.delay=Sr;exports.diff=b;exports.diffToChanges=w;exports.disablePlaceholder=Jr;exports.enablePlaceholder=Zr;exports.env=o;exports.exponentialDelay=Tr;exports.fastDiff=g;exports.filterGroupAndItemNames=Mb;exports.findAttributeRange=Qw;exports.findAttributeRangeBound=Yw;exports.findClosestScrollableAncestor=bo;exports.findOptimalInsertionRange=hy;exports.first=wr;exports.focusChildOnDropdownOpen=rp;exports.getAncestors=wo;exports.getBorderWidths=vo;exports.getBoxSidesShorthandValue=ph;exports.getBoxSidesValueReducer=fh;exports.getBoxSidesValues=gh;exports.getCode=or;exports.getDataFromElement=_o;exports.getEnvKeystrokeText=ar;exports.getFillerOffset=ba;exports.getLabel=dy;exports.getLanguageDirection=mr;exports.getLastTextLine=Bw;exports.getLocalizedArrowKeyCodeDirection=cr;exports.getLocalizedColorOptions=qg;exports.getOptimalPosition=Do;exports.getPositionShorthandNormalizer=bh;exports.getRangeFromMouseEvent=yo;exports.getShorthandValues=wh;exports.global=i;exports.hidePlaceholder=Yr;exports.icons=vm;exports.indexOf=Bo;exports.injectCssTransitionDisabler=dg;exports.inlineAutoformatEditing=t_;exports.inlineHighlight=Xw;exports.insertAt=Mo;exports.insertToPriorityArray=x;exports.isArrowKeyCode=lr;exports.isAttachment=uh;exports.isColor=Xu;exports.isCombiningMark=Vr;exports.isComment=Lo;exports.isFocusable=yg;exports.isForwardArrowKeyCode=dr;exports.isHighSurrogateHalf=Rr;exports.isInsideCombinedSymbol=Mr;exports.isInsideEmojiSequence=Fr;exports.isInsideSurrogatePair=Br;exports.isIterable=oo;exports.isLength=nh;exports.isLineStyle=th;exports.isLinkableElement=ET;exports.isLowSurrogateHalf=Or;exports.isNode=uo;exports.isParagraphable=zc;exports.isPercentage=oh;exports.isPosition=ch;exports.isRange=Co;exports.isRepeat=ah;exports.isText=ko;exports.isURL=mh;exports.isValidAttributeName=Fo;exports.isViewWithFocusCycler=kg;exports.isViewWithFocusTracker=vr;exports.isVisible=No;exports.isWidget=sy;exports.keyCodes=nr;exports.linkIcon=zT;exports.logError=T;exports.logWarning=E;exports.mix=_;exports.needsPlaceholder=Xr;exports.normalizeColorOptions=Gg;exports.normalizeMenuBarConfig=pb;exports.normalizeSingleColorDefinition=Kg;exports.normalizeToolbarConfig=qf;exports.parseHtml=PO;exports.parseKeystroke=rr;exports.plainTextToHtml=Wv;exports.priorities=C;exports.releaseDate=V;exports.remove=$o;exports.retry=Er;exports.scrollAncestorsToShowTarget=Wo;exports.scrollViewportToShowTarget=Uo;exports.secureSourceElement=wm;exports.setDataInElement=Ro;exports.setHighlightHandling=ly;exports.setLabel=cy;exports.showPlaceholder=Qr;exports.spliceArray=Pr;exports.submitHandler=hg;exports.toArray=gr;exports.toMap=xr;exports.toUnit=Oo;exports.toWidget=oy;exports.toWidgetEditable=uy;exports.transformSets=Jd;exports.uid=k;exports.unlinkIcon=NT;exports.verifyLicense=Ir;exports.version=I;exports.viewToModelPositionOutsideModelElement=my;exports.wait=Ar;exports.wrapInParagraph=Hc;});
